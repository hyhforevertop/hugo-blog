


[{"content":"","date":"12 May 2025","externalUrl":null,"permalink":"/tags/hackthebox/","section":"Tags","summary":"","title":"Hackthebox","type":"tags"},{"content":"\rBox Info #\rOS Linux Difficulty Easy As is common in real life pentests, you will start the Planning box with credentials for the following account: admin / 0D5oT70Fq13EvB5r\nNmap #\r[root@kali] /home/kali/Planning ❯ nmap planning.htb -sV -A PORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.11 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 256 62:ff:f6:d4:57:88:05:ad:f4:d3:de:5b:9b:f8:50:f1 (ECDSA)\r|_ 256 4c:ce:7d:5c:fb:2d:a0:9e:9f:bd:f5:5c:5e:61:50:8a (ED25519)\r80/tcp open http nginx 1.24.0 (Ubuntu)\r|_http-server-header: nginx/1.24.0 (Ubuntu)\r|_http-title: Edukate - Online Education Website 80端口没有什么可以利用的东西，尝试爆破子域名\nSubdomain Fuzz #\r[root@kali] /home/kali/Planning ❯ ffuf -u http://planning.htb/ -w /usr/share/fuzzDicts/subdomainDicts/main.txt -H \u0026#34;Host:FUZZ.planning.htb\u0026#34; -fs 178\r/\u0026#39;___\\ /\u0026#39;___\\ /\u0026#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0-dev\r________________________________________________\r:: Method : GET\r:: URL : http://planning.htb/\r:: Wordlist : FUZZ: /usr/share/fuzzDicts/subdomainDicts/main.txt\r:: Header : Host: FUZZ.planning.htb\r:: Follow redirects : false\r:: Calibration : false\r:: Timeout : 10\r:: Threads : 40\r:: Matcher : Response status: 200-299,301,302,307,401,403,405,500\r:: Filter : Response size: 178\r________________________________________________\rgrafana [Status: 302, Size: 29, Words: 2, Lines: 3, Duration: 98ms] 添加grafana.planning.htb到/etc/hosts\nCVE-2024-9264 #\r经过搜索我找到了一个可以拿到shell的cve\nz3k0sec/CVE-2024-9264-RCE-Exploit: Grafana RCE exploit (CVE-2024-9264) 当前应该是在docker环境中，需要逃逸出去\n查看一下env环境变量\nGF_SECURITY_ADMIN_PASSWORD=RioTecRXXXXXXXXXXXXXXX\rGF_SECURITY_ADMIN_USER=enzo 可以直接登录ssh\nRoot #\r找到一个json文件\n❯ cat crontab.db| jq\r{\r\u0026#34;name\u0026#34;: \u0026#34;Grafana backup\u0026#34;,\r\u0026#34;command\u0026#34;: \u0026#34;/usr/bin/docker save root_grafana -o /var/backups/grafana.tar \u0026amp;\u0026amp; /usr/bin/gzip /var/backups/grafana.tar \u0026amp;\u0026amp; zip -P P4ssw0rdS0pRi0T3c /var/backups/grafana.tar.gz.zip /var/backups/grafana.tar.gz \u0026amp;\u0026amp; rm /var/backups/grafana.tar.gz\u0026#34;, \u0026#34;schedule\u0026#34;: \u0026#34;@daily\u0026#34;,\r\u0026#34;stopped\u0026#34;: false,\r\u0026#34;timestamp\u0026#34;: \u0026#34;Fri Feb 28 2025 20:36:23 GMT+0000 (Coordinated Universal Time)\u0026#34;,\r\u0026#34;logging\u0026#34;: \u0026#34;false\u0026#34;,\r\u0026#34;mailing\u0026#34;: {},\r\u0026#34;created\u0026#34;: 1740774983276,\r\u0026#34;saved\u0026#34;: false,\r\u0026#34;_id\u0026#34;: \u0026#34;GTI22PpoJNtRKg0W\u0026#34;\r}\r{\r\u0026#34;name\u0026#34;: \u0026#34;Cleanup\u0026#34;,\r\u0026#34;command\u0026#34;: \u0026#34;/root/scripts/cleanup.sh\u0026#34;,\r\u0026#34;schedule\u0026#34;: \u0026#34;* * * * *\u0026#34;,\r\u0026#34;stopped\u0026#34;: false,\r\u0026#34;timestamp\u0026#34;: \u0026#34;Sat Mar 01 2025 17:15:09 GMT+0000 (Coordinated Universal Time)\u0026#34;,\r\u0026#34;logging\u0026#34;: \u0026#34;false\u0026#34;,\r\u0026#34;mailing\u0026#34;: {},\r\u0026#34;created\u0026#34;: 1740849309992,\r\u0026#34;saved\u0026#34;: false,\r\u0026#34;_id\u0026#34;: \u0026#34;gNIRXh1WIc9K7BYX\u0026#34;\r} 里面有一个密码：P4ssw0rdS0pRi0T3c，但不是root的密码\n没有找到能用的东西，查看一下端口开放情况\nenzo@planning:~$ ss -tuln\rNetid State Recv-Q Send-Q Local Address:Port Peer Address:Port Process udp UNCONN 0 0 127.0.0.54:53 0.0.0.0:* udp UNCONN 0 0 127.0.0.53%lo:53 0.0.0.0:* tcp LISTEN 0 151 127.0.0.1:3306 0.0.0.0:* tcp LISTEN 0 511 0.0.0.0:80 0.0.0.0:* tcp LISTEN 0 4096 127.0.0.1:37121 0.0.0.0:* tcp LISTEN 0 70 127.0.0.1:33060 0.0.0.0:* tcp LISTEN 0 4096 127.0.0.53%lo:53 0.0.0.0:* tcp LISTEN 0 4096 127.0.0.54:53 0.0.0.0:* tcp LISTEN 0 4096 127.0.0.1:3000 0.0.0.0:* tcp LISTEN 0 511 127.0.0.1:8000 0.0.0.0:* tcp LISTEN 0 4096 *:22 *:* 注意到开放了一个8000端口，将其转发出来\n[root@kali] /home/kali/Planning ❯ ssh enzo@planning.htb -L 8000:127.0.0.1:8000 尝试了一下，可以直接这样登录👇\n实际上就是一个定时任务的web控制端\n可以直接写入设置SUID的命令\n运行之后即可看到成功提权\nSummary #\rUser: 子域名爆破，用已知的用户名和密码登录到后台，通过CVE拿到docker容器的shell，在环境变量中拿到enzo的登录密码。\nRoot: 在/opt/crontabs目录下拿到一个密码，内网8000端口转发出去可以用于web登录，设置定时任务设置bash的SUID。\n","date":"12 May 2025","externalUrl":null,"permalink":"/htb-planning/","section":"Blowfish","summary":"","title":"HTB-Planning","type":"page"},{"content":"","date":"12 May 2025","externalUrl":null,"permalink":"/tags/linux/","section":"Tags","summary":"","title":"Linux","type":"tags"},{"content":"","date":"12 May 2025","externalUrl":null,"permalink":"/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/","section":"Categories","summary":"","title":"渗透测试","type":"categories"},{"content":"","externalUrl":null,"permalink":"/en/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/en/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","externalUrl":null,"permalink":"/en/","section":"My New Hugo Site","summary":"","title":"My New Hugo Site","type":"page"},{"content":"","externalUrl":null,"permalink":"/en/series/","section":"Series","summary":"","title":"Series","type":"series"},{"content":"","externalUrl":null,"permalink":"/en/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"}]